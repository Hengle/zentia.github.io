<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[èµ¤å­ä¹‹å¿ƒ]]></title>
    <url>%2F2019%2F05%2F31%2Ffiction-3%2F</url>
    <content type="text"><![CDATA[èµ¤å­ä¹‹å¿ƒï¼Œå°±æ˜¯ä¸€é¢—ç‡ç›´ã€çº¯çœŸã€å–„è‰¯ã€çƒ­çˆ±ç”Ÿå‘½ã€å¥½å¥‡è€Œå¯Œæƒ³è±¡åŠ›ã€ç”Ÿå‘½åŠ›æ—ºç››çš„å¿ƒï¼Œèƒ½å¤Ÿå¸¸å¸¸æ€€ç€èµ¤å­ä¹‹å¿ƒï¼Œæ‰å¯ä»¥å¤§äººã€‚è€å­é“å¾·ç»ï¼šå«å¾·ä¹‹åšï¼Œæ¯”äºèµ¤å­ã€‚è¯´çš„å°±æ˜¯è¿™ä¸ªé“ç†å§ã€‚èŠ¹è¯´ä»–ä¸çŸ¥é“è‡ªå·±ç®—ä¸ç®—æœ‰èµ¤å­ä¹‹å¿ƒï¼Œä½†æ˜¯ç»å†äº†è¿™ä¹ˆå¤šã€‚ä»–è¯´ä»–æƒ³æœ‰èµ¤å­ä¹‹å¿ƒã€‚ä»¥å‰ä»¥ä¸ºï¼ŒåŠŸå¤«ï¼Œä¸¤ä¸ªå­—ï¼Œä¸€æ¨ªä¸€ç«–ï¼Œå¯¹çš„ï¼Œç«™ç€ï¼Œé”™çš„ï¼Œå€’ä¸‹ã€‚åªæœ‰ç«™ç€çš„æ‰æœ‰èµ„æ ¼è¯´è¯ã€‚åæ¥è§è¿‡äº†é«˜å±±ï¼Œæ‰å‘ç°æœ€éš¾è¿‡çš„åŸæ¥æ˜¯ç”Ÿæ´»ã€‚]]></content>
      <tags>
        <tag>æ··æ²Œ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æŠ—é”¯é½¿æŠ€æœ¯]]></title>
    <url>%2F2019%2F05%2F29%2Fsmaa%2F</url>
    <content type="text"><![CDATA[SMAADæŠ€æœ¯çš„å…¨ç§°ä¸ºâ€Enhanced Subpixel Morphological Antialiasingâ€ï¼Œä¸FXAAä¸€æ ·åŒä¸ºåæœŸå¤„ç†æŠ—é”¯é½¿æŠ€æœ¯ï¼Œå¯ä»¥æä¾›åŸºäºè¿‡æ»¤ç®—æ³•çš„é€šç”¨å›¾åƒæŠ—é”¯é½¿è§£å†³æ–¹æ¡ˆã€‚SMAAæŠ€æœ¯ä½¿ç”¨äº†æ›´å¥½çš„å‡ ä½•å½¢ä½“å’Œå¯¹è§’å½¢ä½“æ£€æµ‹å¤„ç†æœºåˆ¶ï¼Œé€šè¿‡å›¾å½¢è¾¹ç¼˜å±€éƒ¨ç‰¹å¾å¯¹æ¯”æ¥è¯†åˆ«å›¾åƒçš„é”¯é½¿ç‰¹å¾ï¼Œå¹¶é€šè¿‡é‡å»ºå­åƒç´ çš„æ–¹å¼å®ç°æŠ—é”¯é½¿åŠŸèƒ½ï¼Œæ•ˆæœä¸ä¼ ç»Ÿçš„4x MSAAç›¸è¿‘è€Œä¸”å¯ä»¥æ ¹æ®æ¸¸æˆçš„éœ€è¦è¿›è¡Œå®šåˆ¶ã€‚ é€šè¿‡â€ä»¥æ¨¡ç³Šæ¢å–ç²¾ç¡®â€œçš„æ‰‹æ®µæ¥æ¶ˆé™¤æ˜¾ç¤ºå±ä¸Šçš„é”¯é½¿ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬ç§°å…¶ä¸ºé‡‡æ ·(Sampling)ï¼Œä¹Ÿå°±æ˜¯é’ˆå¯¹æŸä¸€ç‚¹çš„åƒç´ ï¼Œé€šè¿‡è®©å®ƒå¸¦æœ‰å‘¨å›´åƒç´ çš„ç‰¹æ€§ï¼Œå› æ­¤åœ¨è¶³å¤Ÿçš„åˆ†è¾¨ç‡ä¸‹ï¼Œè¿™ä¸€ç‚¹ä¾¿ä¸å†é¡½å›ºèˆ¬åœ°é”åˆ©ï¼Œä¹Ÿè¾¾åˆ°æ¶ˆé™¤é”¯é½¿çš„ç›®çš„ã€‚ è¶…çº§é‡‡æ ·æŠ—é”¯é½¿(Super Sampling Anti-Aliasing,SSAA)é€šè¿‡åå­—å°±çŸ¥é“ï¼ŒSSAAæœ€å¤§çš„ç‰¹ç‚¹æ¥è‡ªé‡‡æ ·è¿‡ç¨‹ï¼Œä»¥å¸¸è§çš„SSAA4ä¸ºä¾‹ï¼Œåœ¨é¢å¯¹ä¸€å¼ æœ€åéœ€è¦ä»¥19201080åƒç´ æ¸²æŸ“çš„ç”»é¢æ—¶ï¼ŒSSAAä¼šé¦–å…ˆæ¸²æŸ“ä¸€å¼ å°ºå¯¸ä½3840*2160åƒç´ çš„ç¼“å­˜ï¼Œå†åœ¨è¿™ç§é•¿å®½éƒ½ä¹˜ä»¥2çš„ç”»é¢ä¸Šè¿›è¡Œé‡‡æ ·ï¼Œé‡‡æ ·çš„ç²¾åº¦å’Œæ•ˆæœå½“ç„¶æ˜¯æœ€ç†æƒ³çš„ï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥æƒ³è±¡ï¼Œè¿™ç§åªä¸ºè¿½æ±‚ç†æƒ³æƒ…å†µçš„æ‰‹æ®µå¯¹äºç¡¬ä»¶èµ„æºçš„æ¶ˆè€—éå¸¸å¤§ï¼Œæˆæœ¬ä¹Ÿéå¸¸é«˜ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå³ä½¿åœ¨åŸç†ä¸ŠSSAAæ‹¥æœ‰æœ€ç†æƒ³çš„ç²¾åº¦ï¼Œä½†æ˜¯æœ€ç°å®çš„æƒ…å†µä¸‡èˆ¬å˜åŒ–ä¸­çš„æ¸¸æˆä¸–ç•Œï¼ŒSSAAå¹¶ä¸èƒ½æ°¸è¿œä¿è¯é‡‡æ ·æ•ˆæœæ˜¯æœ€è®¨å¥½çœ¼ç›çš„ï¼Œæ¢å¥è¯è¯´æ€§ä»·æ¯”ä¼šéšç€æ–°æŠ€æœ¯çš„ç°èº«è€Œé¢ä¸´è¶Šæ¥è¶Šå¤§çš„æŒ‘æˆ˜ï¼Œè¿™å…¶ä¸­å°±åŒ…æ‹¬SSAAæœ¬èº«çš„ä¸€ç§çµæ´»çš„å˜ä½“ï¼šå¤šé‡é‡‡æ ·æŠ—é”¯é½¿æŠ€æœ¯(Multi-Sampling Anti-Aliasing,MSAA)ã€‚ MSAAçš„åŸç†å’ŒSSAAä¸€è‡´ï¼Œéƒ½æ˜¯é€šè¿‡å°†å›¾å½¢æ‹‰ä¼¸è‡³æ›´é«˜å€ç‡ä¹‹ä¸‹çš„ç¼“å­˜ä¹‹åå†ç²¾ç»†çš„å›¾åƒä¸Šè¿›è¡Œé‡‡æ ·ï¼Œä½†æ˜¯å‰è€…çœŸæ­£èªæ˜çš„åœ°æ–¹åœ¨äºï¼Œå†å¼€å§‹ç‹®å­å¤§å¼€å£ä¹‹å‰MSAAå­˜åœ¨ä¸€ä¸ªåˆ¤æ–­çš„è¿‡ç¨‹ï¼Œæ¢å¥è¯è¯´MSAAä»…ä»…é’ˆå¯¹ç”»é¢ä¸­è¾¹ç¼˜éƒ¨åˆ†è¿›è¡Œæ”¾å¤§å¤„ç†ï¼Œè¿™ä¹ˆä¸€æ¥å¯¹äºç¡¬ä»¶çš„è´Ÿæ‹…ç€å®å¤§å¤§å‡è½»ï¼Œæ­£å¼å› ä¸ºå¦‚æ­¤ï¼ŒMSAAæ—©å·²æ˜¯æœ€æµè¡Œçš„æŠ—é”¯é½¿æ–¹æ¡ˆä¹‹ä¸€ï¼Œå¯¹äºä»»ä½•ä¸€æ¬¾ç°ä»£æ¸¸æˆæ¥è¯´ï¼Œä¸æ”¯æŒMSAAå‡ ä¹æ˜¯ä¸å¯æƒ³è±¡çš„ã€‚ æ— è®ºæ˜¯SSAAè¿˜æ˜¯MSAAï¼Œä»–ä»¬è¿ä½œéƒ½é›†ä¸­åœ¨éå¸¸è€ƒå‰çš„ä½ç½®ï¼Œæ¯”å¦‚å…‰æ …åŒ–é˜¶æ®µï¼Œå› æ­¤å¯¹äºç¡¬ä»¶å¼€é”€æœ‰è¾ƒå¤§çš„å‘¼å£°ï¼Œä½†æ˜¯ä»2012å¹´çš„GeFore 600ç³»åˆ—ä»¥æ¥ï¼ŒNVIDIAå°±å·²ç»å¼€å§‹æ¨å¹¿ä¸€æ¬¾å…¨æ–°çš„æŠ—é”¯é½¿æ–¹æ¡ˆï¼Œå®ƒä»¬æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å‡ºå‘ç‚¹éå¸¸é å‰ï¼Œä½œä¸ºä¸€æ¬¾åå¤„ç†æŠ—é”¯é½¿å®ƒçš„ç¡¬ä»¶éœ€æ±‚éå¸¸ä½ï¼Œ]]></content>
      <categories>
        <category>è®¡ç®—æœºå›¾å½¢å­¦</category>
      </categories>
      <tags>
        <tag>è®¡ç®—æœºå›¾å½¢å­¦</tag>
        <tag>åå¤„ç†</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[GameEngine]]></title>
    <url>%2F2019%2F05%2F29%2Fgameengine%2F</url>
    <content type="text"><![CDATA[python2.7GnuWin32 Tools https://sourceforge.net/projects/getgnuwin32/ æ‰§è¡Œdownload.batå’Œinstall.batå®Œæˆå®‰è£…ã€‚æ·»åŠ ç¯å¢ƒå˜é‡ CLangæ˜¯åŸºäºLLVMã€‚æ‰€è°“LLVMï¼Œå°±æ˜¯ä¸€ä¸ªå°å°çš„è™šæ‹Ÿæœºã€‚è¿™ä¸ªè™šæ‹ŸæœºæŠ½è±¡äº†ä¸åŒçš„ç¡¬ä»¶å¹³å°ï¼Œå¦‚x86/arm/mipsç­‰ã€‚æœ€è¿‘è¿˜æŠ½è±¡äº†GPUã€‚æœ‰ç‚¹åƒJavaçš„VMï¼Œä½†æ˜¯åˆå’ŒJavaçš„VMå¾ˆä¸åŒã€‚Javaçš„VMæ˜¯æ¯”è¾ƒé«˜å±‚çš„ï¼Œå®ƒçš„byte codeåŒ…æ‹¬å¾ˆå¤šç¡¬ä»¶å¹³å°å¹¶ä¸èƒ½ç›´æ¥æ”¯æŒçš„åŠŸèƒ½ã€‚è€ŒLLVMçš„byte codeåˆ™æ˜¯æ›´åŠ æ¥è¿‘ç¡¬ä»¶(CPU/GPU)çš„å®é™…åŠŸèƒ½ï¼Œåªä¸è¿‡å®ƒæ˜¯ç‹¬ç«‹äºä»»ä½•ä¸€ä¸ªå…·ä½“ç¡¬ä»¶å­˜åœ¨çš„ã€‚éå¸¸ç®€å•ç²—ç³™æ¯”å–»çš„è¯ï¼Œå„ç§CPU/GPUå°±å¥½æ¯”å„ä¸ªåœ°æ–¹çš„äººï¼Œè¯´å„ä¸ªåœ°æ–¹çš„æ–¹è¨€ï¼›è€ŒLLVMçš„byte codeåˆ™æœ‰äº›åƒæ™®é€šè¯ï¼Œä¸æ–¹è¨€æœ‰ç€ç±»ä¼¼1å¯¹1çš„å¯¹åº”å…³ç³»ã€‚ æ‰€ä»¥ï¼Œé¦–å…ˆéœ€è¦è¿å‡ºLLVMçš„ä»£ç ï¼Œå¦‚ä¸‹æ“ä½œï¼š svn co http://llvm.org/svn/llvm-project/llvm/trunk llvm Clangæ˜¯ä½œä¸ºLLVMçš„ä¸€ä¸ªå‰ç«¯ï¼Œå³ï¼ŒæŠŠC/C++ç¿»è¯‘æˆLLVMå¯ä»¥æ‡‚çš„byte codeçš„å·¥å…·ã€‚LLVMå†æŠŠbyte codeç¿»è¯‘æˆå…·ä½“çš„æœºå™¨æŒ‡ä»¤ã€‚æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å¯ä»¥è¿å‡ºClangçš„ä»£ç å¹¶æ”¾åœ¨LLVMå¦¥å½“çš„ä½ç½®ã€‚123456cd llvm\toolssvn co http://llvm.org/svn/llvm-project/cfe/trunk clangcd ../..mkdir build&quot;C:\PROGRAM FILES (X86)\MICROSOFT VISUAL STUDIO\2017\COMMUNITY\COMMON7\IDE\COMMONEXTENSIONS\MICROSOFT\CMAKE\CMake\bin\cmake.exe&quot; -G &quot;Visual Studio 15&quot; ../llvmmsbuild LLVMã€‚sln ç¼–è¯‘å®Œæˆä¹‹åï¼Œæˆ‘ä»¬æ¥æµ‹è¯•æˆ‘ä»¬ç¼–è¯‘å‡ºçš„clangæ˜¯å¦æœ‰é—®é¢˜ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦å°†ç”Ÿæˆç‰©çš„ç›®å½•åŠ å…¥ç¯å¢ƒå˜é‡PATHï¼Œä»¥ä¾¿åœ¨å‘½ä»¤è¡Œèƒ½å¤Ÿæ‰¾åˆ°å®ƒé‡å¯å‘½ä»¤è¡Œï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥æ‰¾åˆ°clang12345C:\Users\Administrator&gt;clang -vclang version 9.0.0 (trunk 361927) (llvm/trunk 361929)Target: i686-pc-windows-msvcThread model: posixInstalledDir: D:\build\Debug\bin ç„¶åç¡®ä¿æˆ‘ä»¬ç›®å‰å¤„äºLLVMçš„é¡¶çº§ç›®å½•ï¼Œå°±æ˜¯ä¸‹é¢æœ‰llvmå’Œbuildè¿™ä¸¤ä¸ªç›®å½•çš„é‚£ä¸€é›†ç›®å½•ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š1D:\&gt;python.exe build/Debug/bin/llvm-lit.py -sv --param build_mode=Debug --param clang_site_config=build/tools/clang/test/lit.site.cfg build/tools/clang/test --param=build_config=Debug æˆ‘è¿™é‡Œçš„ç¯å¢ƒæ‰§è¡Œä¼šå¤±è´¥ï¼Œpythonæç¤ºæ‰¾ä¸åˆ°ä¸€äº›æµ‹è¯•ç”¨çš„ç¨‹åºã€‚éœ€è¦ä¿®æ”¹build\tools\clang\test\lit.site.cfgæŠŠæ‰€æœ‰çš„%(build_mode)æ”¹ä¸º%(build_config)å¦‚æœç”¨vimä¿®æ”¹ï¼Œå¯ä»¥ç”¨:%s/build_mode/build_config/gæœ€åclang main.cppç¼–è¯‘æˆ‘ä»¬çš„é¡¹ç›®ã€‚http://clang.llvm.org/get_started.html]]></content>
      <categories>
        <category>GameEngine</category>
      </categories>
      <tags>
        <tag>GameEngine</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vulkan]]></title>
    <url>%2F2019%2F05%2F28%2Fvulkan%2F</url>
    <content type="text"><![CDATA[ä»¥ä¸‹æ˜¯Vulkanä¸­çš„ç‰¹æ€§å’Œæ”¹è¿›ï¼Œç›¸è¾ƒäºOpenGLå…·æœ‰æ›´å¤šçš„ä¼˜åŠ¿ï¼š é™ä½é©±åŠ¨ç¨‹åºçš„å¼€é”€ä»¥åŠCPUä½¿ç”¨ç‡ï¼šVulkanæ—¨åœ¨æ›´æ¥è¿‘åº•å±‚çš„å›¾å½¢ç¡¬ä»¶ã€‚å› æ­¤ï¼Œå®ƒä¸ºä¸Šå±‚çš„åº”ç”¨ç¨‹åºæä¾›äº†å¯¹ä¸»æœºè®¡ç®—èµ„æºçš„ç›´æ¥æ§åˆ¶ï¼Œä»¥ä¾¿GPUå°½å¯èƒ½åœ°è¿›è¡Œæ¸²æŸ“ï¼Œè¿™ç§æ–¹å¼åŒæ—¶ä¹Ÿå…è®¸è½¯ä»¶ç›´æ¥è®¿é—®å›¾å½¢å¤„ç†å™¨ï¼Œä»è€Œè·å¾—æ›´å¥½åœ°æ€§èƒ½ã€‚ å¤šçº¿ç¨‹å¯æ‰©å±•æ€§ï¼šOpenGLä¸­çš„å¤šçº¿ç¨‹æ‰©å±•æ•ˆæœéå¸¸å·®ï¼Œè¦æƒ³åˆ©ç”¨çº¿ç¨‹çš„ç‰¹æ€§ï¼Œä»è€Œæ›´å¥½åœ°åˆ©ç”¨CPUæ˜¯ä¸€ä»¶éå¸¸å›°éš¾åœ°äº‹æƒ…ã€‚ç„¶åï¼ŒVulkanå¯¹æ­¤è¿›è¡Œäº†ä¸“é—¨è®¾è®¡ï¼Œç”¨äºå…è®¸ç»ˆç«¯ç”¨æˆ·ä»¥ä¸€ç§éå¸¸é€æ˜åœ°æ–¹å¼åˆ©ç”¨CPUçš„å¤šçº¿ç¨‹ç‰¹æ€§ï¼Œä¸å­˜åœ¨éšå¼çš„å…¨å±€çŠ¶æ€ã€‚ä»åˆ›å»ºä½œä¸šä»¥åŠæäº¤ä½œä¸šï¼ˆç”¨äºæ‰§è¡Œï¼‰æ—¶å¼€å§‹ï¼Œä¸åŒçº¿ç¨‹ä¸‹çš„ä½œä¸šä¹‹é—´ä¼šä¿æŒåˆ†ç¦»ã€‚ ä¸€å¥—â€œæ˜¾ç¤ºâ€çš„APIï¼šOpenGLæ˜¯ä¸€å¥—â€œéšå¼â€çš„APIï¼Œå…¶ä¸­çš„èµ„æºç®¡ç†æ˜¯é©±åŠ¨ç¨‹åºçš„è´£ä»»ã€‚é©±åŠ¨ç¨‹åºéœ€è¦åº”ç”¨ç¨‹åºçš„æç¤ºå¹¶è·Ÿè¸ªèµ„æºçš„çŠ¶æ€ï¼Œè¿™æ˜¯ä¸€ç§ä¸å¿…è¦çš„å¼€é”€ã€‚Vulkanæ˜¯ä¸€å¥—â€œæ˜¾å¼â€çš„APIï¼›åœ¨è¿™é‡Œï¼Œé©±åŠ¨ç¨‹åºä¸è´Ÿè´£è·Ÿè¸ªèµ„æºä»¥åŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼ŒæŠŠè¿™é¡¹ä»»åŠ¡åˆ†é…ç»™äº†åº”ç”¨ç¨‹åºã€‚è¿™ç§å¹²å‡€çš„æ–¹æ³•æ›´å¯é¢„æµ‹ï¼›é©±åŠ¨ç¨‹åºä¸ä¼šå†å¹•åæ‰§è¡ŒæŸäº›æ“ä½œæ¥ç®¡ç†èµ„æºï¼ˆå°±åƒåœ¨OpenGLä¸­ä¸€æ ·ï¼‰ã€‚å› æ­¤ï¼Œä½œä¸šçš„å¤„ç†ç®€åŒ–ä¸”ç›´æ¥ï¼Œä»è€Œå®ç°æœ€ä½³æ€§èƒ½å’Œå¯é¢„æµ‹çš„è¡Œä¸ºã€‚ é¢„ç¼–è¯‘çš„ä¸­é—´ç€è‰²è¯­è¨€ï¼šä¸éœ€è¦ç€è‰²å™¨shaderä½œä¸ºOpenGL(GLSL)æºä»£ç æä¾›çš„OpenGLä¸åŒï¼ŒSPIR-V(Standard Portable Intermediate Languageï¼šæ ‡å‡†å¯ç§»æ¤ä¸­é—´è¯­è¨€)æ˜¯Vulkanç”¨äºå¹¶è¡Œè®¡ç®—å’Œå›¾å½¢æ“ä½œçš„æ ‡å‡†ä¸­é—´è¯­è¨€ã€‚ æ³¨æ„ï¼šç”¨äºæºè¯­è¨€çš„ç¼–è¯‘å™¨ï¼Œä¾‹å¦‚GLSLï¼ŒHLSLå’ŒLLVMå¿…é¡»ç¬¦åˆSPIR-Vè§„èŒƒï¼Œå¹¶æä¾›å®ç”¨çš„å·¥å…·ç¨‹åºæ¥æä¾›SPIR-Vçš„è¾“å…¥ã€‚Vulkané‡‡ç”¨Vulkanè¿™ç§å³æ—¶æ‰§è¡Œçš„äºŒè¿›åˆ¶ä¸­é—´è¾“å…¥å½¢å¼å¹¶ä¼šåœ¨ç€è‰²å™¨é˜¶æ®µä½¿ç”¨ã€‚ é©±åŠ¨ç¨‹åºå±‚å’Œåº”ç”¨ç¨‹åºå±‚ï¼šåœ¨OpenGLä¸­ï¼Œä¸é©±åŠ¨ç¨‹åºå±‚ç›¸æ¯”ï¼Œåº”ç”¨ç¨‹åºå±‚æ›´è–„ï¼Œå› ä¸ºé©±åŠ¨ç¨‹åºçš„è‡ªåŠ¨åŒ–è€ƒè™‘äº†èµ„æºç®¡ç†å’ŒçŠ¶æ€è·Ÿè¸ªï¼ŒVulkanæ­£å¥½ä¸æ­¤ç›¸åã€‚å®ƒä¼šç¡®ä¿é©±åŠ¨ç¨‹åºæ›´æ¥è¿‘åº•å±‚çš„ç¡¬ä»¶ä¸”å¼€é”€æ›´å°ã€‚ç®¡ç†é€»è¾‘ã€èµ„æºå’ŒçŠ¶æ€æ˜¯åº”ç”¨ç¨‹åºçš„è´£ä»»ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†è¿™ä¸¤ä¸ªAPIçš„é©±åŠ¨ç¨‹åºå’Œåº”ç”¨ç¨‹åºä»£ç åº“çš„åšåº¦ï¼š å†…å­˜æ§åˆ¶ï¼šVulkanèƒ½å¤Ÿåœ¨ç³»ç»Ÿä¸Šæš´éœ²è‹¥å¹²ç§å†…å­˜ç±»å‹ï¼Œå¹¶è¦æ±‚åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ä¸ºæ¯ä¸ªèµ„æºçš„é¢„æœŸç”¨é€”é€‰æ‹©é€‚å½“çš„å†…å­˜ç±»å‹ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒOpenGLé©±åŠ¨ç¨‹åºåˆ™ä¼šæ ¹æ®å†…éƒ¨å¯å‘æ¨¡å¼å†³å®šèµ„æºçš„æ”¾ç½®ä½ç½®ï¼Œä¸åŒä¾›åº”å•†ä¹‹é—´çš„å¯å‘æ¨¡å¼å­˜åœ¨ä¸€å®šçš„å·®å¼‚ï¼Œå¦‚æœç¨åé©±åŠ¨ç¨‹åºç§»åŠ¨äº†èµ„æºï¼ŒOpenGLå¯èƒ½ä¼šäº§ç”Ÿæ¬¡ä¼˜çš„æ”¾ç½®æˆ–å‡ºç°æ„å¤–çš„æ•…éšœã€‚ å¯é¢„æµ‹æ€§ï¼šä¸OpenGLç›¸æ¯”ï¼ŒVulaknå…·æœ‰é«˜åº¦çš„å¯é¢„æµ‹æ€§ï¼›å®ƒåœ¨æ¸²æŸ“æ—¶ä¸ä¼šå¯¼è‡´ä»»ä½•æ»åæˆ–æŒ‚èµ·ã€‚ä¸€æ—¦å°†ä½œä¸šæä¾›ç»™é©±åŠ¨ç¨‹åºï¼Œå°±ä¼šç«‹å³æäº¤ï¼Œè€ŒOpenGLä½œä¸šæäº¤ä¸æ˜¯é¢„å…ˆæä¾›çš„ï¼Œè€Œæ˜¯å—åˆ°é©±åŠ¨è°ƒåº¦ç¨‹åºçš„æ”¯é…ã€‚ ä¸€å¥—APIï¼šOpenGLä¸ºæ¡Œé¢API(OpenGL)å’ŒåµŒå…¥å¼API(OpenGL ES)æä¾›äº†ä¸åŒçš„ç‰ˆæœ¬ã€‚Vulkanå¾ˆå¹²å‡€ï¼Œåªæœ‰ä¸€å¥—é€‚ç”¨æ‰€æœ‰å¹³å°çš„APIã€‚ ç›´æ¥è®¿é—®GPUï¼šVulkané€šè¿‡å…¬å¼€å…¶åŠŸèƒ½å’Œç¡¬ä»¶è®¾æ–½ï¼Œä¸ºåº”ç”¨ç¨‹åºç”¨æˆ·æä¾›äº†å¾ˆå¤šæ§åˆ¶æƒã€‚å®ƒå…¬å¼€äº†å„ç§å¯ç”¨çš„ç‰©ç†è®¾å¤‡ã€å†…å­˜ç±»å‹ã€å‘½ä»¤ç¼“å†²åŒºä»¥åŠæ‰©å±•ã€‚è¿™ç§è¡Œä¸ºå¯ä»¥ç¡®ä¿è½¯ä»¶å±‚æ›´æ¥è¿‘çœŸå®çš„ç¡¬ä»¶ã€‚ é”™è¯¯æ£€æŸ¥å’ŒéªŒè¯ï¼šå½“ä½¿ç”¨OpenGLæ—¶ï¼Œè¿è¡Œè‰¯å¥½çš„åº”ç”¨ç¨‹åºåœ¨æ£€æŸ¥é”™è¯¯ä¼šä»˜å‡ºä¸€äº›ä»£ä»·ï¼Œè€Œé”™è¯¯åœ¨æ‰§è¡Œçš„æ—¶å€™æ ¹æœ¬ä¸ä¼šå‡ºå‘ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒVulkanå°†è¿™äº›æ£€æŸ¥å’ŒéªŒè¯ä½œä¸ºé™„åŠ æœåŠ¡æ¥æä¾›ï¼Œå¯ä»¥åœ¨éœ€è¦æ—¶å¯ç”¨åˆè®¡ç¦ç”¨ã€‚è¿™äº›æ£€æŸ¥æ˜¯å¯é€‰çš„ï¼Œå¯ä»¥é€šè¿‡å¯ç”¨é”™è¯¯æ£€æŸ¥å’Œå…¶ä»–çš„éªŒè¯å±‚æ³¨å…¥åˆ°è¿è¡Œæ—¶ã€‚å› æ­¤ï¼Œé€šè¿‡é¿å…ä¸å¿…è¦çš„æ£€æŸ¥ï¼Œå¯ä»¥å‡å°‘CPUå¼€é”€ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œè¿™äº›é”™è¯¯å’ŒéªŒè¯å±‚å¿…é¡»åœ¨å¼€å‘é˜¶æ®µçš„è°ƒè¯•å™¨æ‰“å¼€ï¼Œå¹¶åœ¨å‘å¸ƒæœŸé—´å…³é—­ã€‚ æ”¯æŒå„ç§GPUç¡¬ä»¶ï¼šVulkanæ”¯æŒç§»åŠ¨è®¾å¤‡å…‰æ …åŒ–å™¨å’Œæ¡Œé¢å…‰æ …åŒ–å™¨ä½œä¸ºå®ç°çš„é›†æˆéƒ¨åˆ†ã€‚å®ƒæ”¯æŒåµŒå…¥å¼å¹³å°çš„åŸºäºç“¦ç‰‡æˆ–å»¶æœŸçš„å…‰æ …åŒ–å™¨ä»¥åŠæœ¬åœ°åŸºäºå¹³é“ºçš„å‰åé¦ˆå…‰æ …åŒ–å™¨ã€‚ åœ¨æ·±å…¥æ¢è®¨åŸºæœ¬ç»†èŠ‚ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹Vulkanä¸­ç”¨åˆ°çš„ä¸€äº›æ¯”è¾ƒé‡è¦æŠ€æœ¯æœ¯è¯­ã€‚éšç€æˆ‘ä»¬çš„è¿›ä¸€æ­¥æ·±å…¥ï¼Œæœ¬ä¹¦è¿˜ä¼šè¦†ç›–æ›´å¤šçš„æŠ€æœ¯æœ¯è¯­ã€‚ ç‰©ç†è®¾å¤‡å’Œè®¾å¤‡ï¼šç³»ç»Ÿå¯èƒ½åŒ…å«å¤šä¸ªå…·æœ‰VulkanåŠŸèƒ½çš„ç‰©ç†ç¡¬ä»¶è®¾å¤‡ã€‚ç‰©ç†è®¾å¤‡è¡¨ç¤ºå”¯ä¸€çš„è®¾å¤‡ï¼Œè€Œè®¾å¤‡deviceåˆ™æ˜¯æŒ‡åº”ç”¨ç¨‹åºä¸­ç‰©ç†è®¾å¤‡çš„é€»è¾‘è¡¨ç¤ºï¼Œå³é€»è¾‘è®¾å¤‡ã€‚ é˜Ÿåˆ—ï¼šé˜Ÿåˆ—è¡¨ç¤ºæ‰§è¡Œå¼•æ“å’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„å£ã€‚ç‰©ç†è®¾å¤‡å§‹ç»ˆåŒ…å«äº†ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ï¼ˆå›¾å½¢é˜Ÿåˆ—ã€è®¡ç®—é˜Ÿåˆ—ã€DMAé˜Ÿåˆ—/ä¼ è¾“é˜Ÿåˆ—ç­‰ï¼‰ã€‚é˜Ÿåˆ—çš„èŒè´£æ˜¯æ”¶é›†ä½œä¸šï¼ˆå‘½ä»¤ç¼“å†²åŒºï¼‰å¹¶å°†å…¶åˆ†æ´¾ç»™ç‰©ç†è®¾å¤‡è¿›è¡Œå¤„ç†ã€‚ å†…å­˜ç±»å‹ï¼šVulkanå…¬å¼€äº†å„ç§å†…å­˜ç±»å‹ã€‚åœ¨æ›´å¹¿æ³›çš„å±‚é¢ä¸Šï¼Œæœ‰ä¸¤ç§ç±»å‹çš„å†…å­˜ï¼šä¸»æœºå†…å­˜å’Œè®¾å¤‡å†…å­˜ã€‚ å‘½ä»¤ï¼šå‘½ä»¤æ˜¯åšæŸç§è¡Œä¸ºçš„æŒ‡ä»¤ã€‚å‘½ä»¤å¯ä»¥å¤§è‡´åˆ†ä¸ºåŠ¨ä½œï¼Œè®¾ç½®çŠ¶æ€æˆ–è€…åŒæ­¥ã€‚ åŠ¨ä½œå‘½ä»¤ï¼šè¿™äº›å‘½ä»¤å¯ç”¨äºç»˜åˆ¶å›¾å…ƒã€æ¸…é™¤è¡¨é¢ã€å¤åˆ¶ç¼“å†²åŒºï¼ŒæŸ¥è¯¢/æ—¶é—´æˆ³æ“ä½œä»¥åŠå¼€å§‹/ç»“æŸå­é€šé“æ“ä½œã€‚è¿™äº›å‘½ä»¤èƒ½å¤Ÿæ›´æ”¹å¸§ç¼“å†²åŒºé™„ä»¶ï¼Œè¯»å–æˆ–å†™å…¥å†…å­˜ï¼ˆç¼“å†²åŒºæˆ–å›¾åƒï¼‰ä»¥åŠç¼–å†™æŸ¥è¯¢æ± ã€‚ åŒæ­¥å‘½ä»¤ï¼šåŒæ­¥æœ‰åŠ©äºæ»¡è¶³ä¸¤ä¸ªæˆ–å¤šä¸ªæ“ä½œå‘½ä»¤çš„è¦æ±‚ï¼Œè¿™äº›æ“ä½œå‘½ä»¤å¯èƒ½ä¼šäº‰å¤ºèµ„æºæˆ–å…·æœ‰ä¸€äº›å†…å­˜ä¾èµ–æ€§ã€‚å…¶ä¸­åŒ…æ‹¬è®¾ç½®äº‹ä»¶ã€ç­‰å¾…æ—¶é—´ï¼Œæ’å…¥ç®¡çº¿å±éšœä»¥åŠæ¸²æŸ“é€šé“æˆ–å­é€šé“çš„ä¾èµ–å…³ç³»ã€‚ å‘½ä»¤ç¼“å†²åŒºï¼šå‘½ä»¤ç¼“å†²åŒºæ˜¯ä¸€ç»„å‘½ä»¤ï¼›å®ƒä¼šè®°å½•è¿™äº›å‘½ä»¤å¹¶å°†å®ƒä»¬æäº¤ç»™é˜Ÿåˆ—ã€‚ Vulkançš„æ‰§è¡Œæ¨¡å‹å…·æœ‰VulkanåŠŸèƒ½çš„ç³»ç»Ÿèƒ½å¤ŸæŸ¥è¯¢å¹¶æ˜¾ç¤ºç³»ç»Ÿä¸Šå¯ç”¨çš„ç‰©ç†è®¾å¤‡çš„æ•°é‡ã€‚æ¯ä¸ªç‰©ç†è®¾å¤‡ä¼šæš´éœ²ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ã€‚è¿™ä¸ªé˜Ÿåˆ—ä¼šåˆ†ä¸ºä¸åŒçš„æ—ï¼Œæ¯ä¸ªæ—éƒ½æœ‰ç‰¹å®šçš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œè¿™äº›åŠŸèƒ½åŒ…æ‹¬å›¾å½¢ï¼Œè®¡ç®—ï¼Œæ•°æ®ä¼ è¾“ä»¥åŠç¨€ç–å†…å­˜ç®¡ç†ã€‚é˜Ÿåˆ—æ—çš„æ¯ä¸ªæˆå‘˜éƒ½å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªç±»ä¼¼çš„é˜Ÿåˆ—ï¼Œä»è€Œä½¿å®ƒä»¬äº’ç›¸å…¼å®¹ã€‚ä¾‹å¦‚ï¼Œç»™å®šçš„å®ç°å¯èƒ½æ”¯æŒåŒä¸€é˜Ÿåˆ—ä¸Šçš„æ•°æ®ä¼ è¾“å’Œå›¾å½¢æ“ä½œã€‚ Vulkanå…è®¸å¼€å‘äººå‘˜é€šè¿‡åº”ç”¨ç¨‹åºå¯¹å†…å­˜æ§åˆ¶è¿›è¡Œæ˜¾å¼çš„ç®¡ç†ï¼Œå®ƒå…¬å¼€äº†è®¾å¤‡ä¸Šå¯ç”¨çš„å„ç§ç±»å‹çš„å †ï¼Œå…¶ä¸­çš„æ¯ä¸ªå †å±äºä¸åŒçš„å†…å­˜åŒºåŸŸã€‚Vulkançš„æ‰§è¡Œæ¨¡å¼éå¸¸ç›´æ¥ï¼Œæ­¤å¤„ï¼Œå‘½ä»¤ç¼“å†²åŒºä¼šè¢«æäº¤åˆ°é˜Ÿåˆ—ä¸­å®ç°çš„ã€‚ç„¶åç”±ç‰©ç†è®¾å¤‡ä½¿ç”¨ï¼Œä»¥ä¾¿è¿›è¡Œå„ç§å¤„ç†ã€‚ Vulkanåº”ç”¨ç¨‹åºè´Ÿè´£æ§åˆ¶å„ç§Vulkanè®¾å¤‡ï¼Œè¿™æ˜¯é€šè¿‡æŠŠå¤§é‡çš„å‘½ä»¤è®°å½•åˆ°å‘½ä»¤ç¼“å†²åŒºå¹¶å°†å®ƒä»¬æäº¤åˆ°é˜Ÿåˆ—ä¸­å®ç°çš„ã€‚è¯¥é˜Ÿåˆ—ç”±é©±åŠ¨ç¨‹åºè¯»å–ï¼Œé©±åŠ¨ç¨‹åºä¼šæŒ‰æäº¤çš„é¡ºåºé¢„å…ˆæ‰§è¡Œä½œä¸šã€‚å‘½ä»¤ç¼“å†²åŒºçš„æ„å»ºéå¸¸æ˜‚è´µï¼Œå› æ­¤ï¼Œä¸€æ—¦æ„å»ºå®Œæˆï¼Œå°±å¯ä»¥å¯¹å®ƒè¿›è¡Œç¼“å­˜ä»¥åŠå°†å…¶æäº¤åˆ°é˜Ÿåˆ—ä¸­ï¼Œä»¥ä¾¿æ ¹æ®å…·ä½“çš„éœ€æ±‚æ‰§è¡Œè‹¥å¹²æ¬¡ã€‚æ­¤å¤–ï¼Œåœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œå¯ä»¥ä½¿ç”¨å¤šçº¿ç¨‹åŒæ—¶å¹¶è¡Œæ„å»ºå¤šä¸ªå‘½ä»¤ç¼“å†²åŒºã€‚ä¸‹å›¾æ˜¾ç¤ºäº†æ‰§è¡Œæ¨¡å‹çš„ç®€åŒ–å›¾ç¤ºï¼š åœ¨è¿™é‡Œï¼Œåº”ç”¨ç¨‹åºè®°å½•äº†ä¸¤ä¸ªåŒ…å«å¤šä¸ªå‘½ä»¤çš„å‘½ä»¤ç¼“å†²åŒºã€‚ç„¶åæ ¹æ®å·¥ä½œæ€§è´¨å°†è¿™äº›å‘½ä»¤æä¾›ç»™ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ã€‚é˜Ÿåˆ—å°†è¿™äº›å‘½ä»¤ç¼“å†²åŒºåšå‘•ä¹Ÿæäº¤åˆ°è®¾å¤‡è¿›è¡Œå¤„ç†ã€‚æœ€åï¼Œè®¾å¤‡å¤„ç†ç»“æ„å¹¶å°†å…¶æ˜¾ç¤ºåœ¨è¾“å‡ºæ˜¾ç¤ºå±ä¸Šï¼Œæˆ–å°†å®ƒä»¬è¿”å›ç»™åº”ç”¨ç¨‹åºè¿›è¡Œä¸€éƒ¨çš„å¤„ç†ã€‚ åœ¨Vulkanä¸­ï¼Œåº”ç”¨ç¨‹åºè´Ÿè´£ä»¥ä¸‹å†…å®¹ï¼š ä¸ºæˆåŠŸæ‰§è¡Œå‘½ä»¤æä¾›æ‰€æœ‰å¿…è¦çš„å…ˆå†³æ¡ä»¶ï¼šè¿™å…¶ä¸­å¯èƒ½åŒ…æ‹¬å‡†å¤‡èµ„æºã€é¢„ç¼–è¯‘çš„ç€è‰²å™¨ä»¥åŠå°†èµ„æºé™„åŠ åˆ°ç€è‰²å™¨ã€æŒ‡å®šæ¸²æŸ“çŠ¶æ€ã€æ„å»ºç®¡çº¿ä»¥åŠç»˜åˆ¶è°ƒç”¨ã€‚ å†…å­˜ç®¡ç† åŒæ­¥ ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´çš„åŒæ­¥ è®¾å¤‡ä¸Šå¯ç”¨çš„ä¸åŒé˜Ÿåˆ—ä¹‹é—´çš„åŒæ­¥ å±å®³ç®¡ç† Vulkançš„é˜Ÿåˆ—é˜Ÿåˆ—æ˜¯Vulkanä¸­çš„åª’ä»‹ï¼Œå°±æ˜¯é€šè¿‡å®ƒå°†å‘½ä»¤ç¼“å†²åŒºé€å…¥è®¾å¤‡çš„ã€‚å‘½ä»¤ç¼“å†²åŒºä¼šè®°å½•ä¸€ä¸ªæˆ–å¤šä¸ªå‘½ä»¤å¹¶å°†å®ƒä»¬æäº¤åˆ°æ‰€éœ€çš„é˜Ÿåˆ—ã€‚è®¾å¤‡ä¹Ÿå¯èƒ½ä¼šå…¬å¼€å¤šç§é˜Ÿåˆ—ï¼Œå› æ­¤ï¼Œåº”ç”¨ç¨‹åºæœ‰è´£ä»»å°†å‘½ä»¤ç¼“å†²åŒºæäº¤ç»™æ­£ç¡®çš„é˜Ÿåˆ—ã€‚ å¯ä»¥å°†å‘½ä»¤ç¼“å†²åŒºæäº¤åˆ°ä»¥ä¸‹å‡ é¡¹ï¼š ä¸€ä¸ªé˜Ÿåˆ—â€”â€”å‘½ä»¤ç¼“å†²åŒºçš„æäº¤é¡ºåºä»¥åŠæ‰§è¡Œã€å›æ”¾éƒ½å°†ä¿æŒä¸å˜ï¼Œå‘½ä»¤ç¼“å†²åŒºä»¥ä¸²è¡Œæ–¹å¼æ‰§è¡Œï¼› å¤šä¸ªé˜Ÿåˆ—â€”â€”å…è®¸åœ¨ä¸¤ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ä¸­å¹¶è¡Œæ‰§è¡Œå‘½ä»¤ç¼“å†²åŒºã€‚é™¤éæ˜ç¡®æŒ‡å®šï¼Œå¦åˆ™æ— æ³•ä¿è¯å‘½ä»¤ç¼“å†²åŒºçš„æäº¤å’Œæ‰§è¡Œé¡ºåºï¼ŒåŒæ­¥å®ƒä»¬çš„é¡ºåºæ˜¯åº”ç”¨ç¨‹åºçš„è´£ä»»ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡ŒåŒæ­¥ï¼Œæ‰§è¡Œçš„é¡ºåºå¯èƒ½ä¼šå®Œå…¨è¶…å‡ºé¢„æœŸã€‚ Vulkanæä¾›äº†å‡ ç§åŒæ­¥æ–¹å¼ï¼Œæ˜¯ç¨‹åºå¯ä»¥åœ¨å•ä¸ªé˜Ÿåˆ—æˆ–è·¨è¶Šå¤šä¸ªé˜Ÿåˆ—å¯¹ä½œä¸šçš„æ‰§è¡Œè¿›è¡Œç›¸å¯¹æ§åˆ¶ã€‚è¿™äº›åŒæ­¥æ–¹å¼æœ‰ï¼š ä¿¡å·é‡(Semaphore)ï¼šè¯¥åŒæ­¥æœºåˆ¶å¯ä»¥è·¨å¤šä¸ªé˜Ÿåˆ—è¿›è¡ŒåŒæ­¥ï¼Œç«ç¾å•ä¸ªé˜Ÿåˆ—ä¸­åŒæ­¥ç²—ç²’åº¦çš„å‘½ä»¤ç¼“å†²åŒºæäº¤ã€‚ äº‹ä»¶(Events)ï¼šäº‹ä»¶ç”¨æ¥æ§åˆ¶ç»†ç²’åº¦çš„åŒæ­¥å¹¶ä¸”è¢«åº”ç”¨äºå•ä¸ªé˜Ÿåˆ—ï¼Œå…è®¸æˆ‘ä»¬å¯¹æäº¤ç»™å•ä¸ªé˜Ÿåˆ—çš„ä¸€ä¸ªå‘½ä»¤ç¼“å†²åŒºæˆ–è‹¥å¹²ä¸ªå‘½ä»¤ç¼“å†²åŒºåºåˆ—ä¹‹é—´è¿›è¡ŒåŒæ­¥å·¥ä½œã€‚å®¿ä¸»æœºä¹Ÿå¯ä»¥å‚ä¸åŸºäºäº‹ä»¶çš„åŒæ­¥ã€‚ æ …æ (Fences)ï¼šè¯¥æ–¹å¼èƒ½å¤Ÿåœ¨ä¸»æœºå’Œè®¾å¤‡ä¹‹é—´è¿›è¡ŒåŒæ­¥æ“ä½œã€‚ ç®¡çº¿å±éšœ(Pipeline barriers)ï¼šç®¡çº¿å±éšœæ˜¯ä¸€ä¸ªæ’å…¥æŒ‡ä»¤ï¼Œç”¨äºç¡®ä¿åœ¨è¯¥å‘½ä»¤ç¼“å†²åŒºä¸­ï¼Œåœ¨ç®¡çº¿å±éšœä¹‹å‰çš„å‘½ä»¤å¿…é¡»åœ¨è¢«æŒ‡å®šçš„ã€ç®¡çº¿å±éšœä¹‹åçš„å‘½ä»¤ä¹‹å‰æ‰§è¡Œã€‚ å¯¹è±¡æ¨¡å‹åœ¨åº”ç”¨ç¨‹åºçº§åˆ«ï¼Œæ‰€æœ‰çš„å®ä½“ï¼ˆåŒ…æ‹¬è®¾å¤‡ã€é˜Ÿåˆ—ã€å‘½ä»¤ç¼“å†²åŒºã€å¸§ç¼“å†²åŒºã€ç®¡çº¿ç­‰ï¼‰éƒ½è¢«ç§°ä¸ºVulkanå¯¹è±¡ã€‚åœ¨å†…éƒ¨ï¼Œåœ¨APIçº§åˆ«ï¼Œè¿™äº›Vulkanå¯¹è±¡ç”¨å¥æŸ„è¿›è¡Œè¯†åˆ«ã€‚è¿™äº›å¥æŸ„æœ‰ä¸¤ç§ç±»å‹ï¼šå¯åˆ†å‘å¥æŸ„å’Œä¸å¯åˆ†å‘å¥æŸ„ã€‚ å¯åˆ†å‘å¥æŸ„(a dispatchable handle)ï¼šè¿™æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘äº†å†…éƒ¨ä¸é€æ˜å½¢çŠ¶çš„å®ä½“(opaque-shaped entity)ã€‚ä¸é€æ˜çš„ç±»å‹ä¸å…è®¸æ‚¨ç›´æ¥è®¿é—®è¿™ç§ç»“æ„çš„å­—æ®µã€‚åªèƒ½ä½¿ç”¨APIä¾‹ç¨‹è®¿é—®è¿™äº›å­—æ®µã€‚æ¯ä¸ªå¯åˆ†å‘å¥æŸ„éƒ½æœ‰ä¸€ä¸ªå…³è”çš„å¯åˆ†å‘ç±»å‹(dispatchable type)ï¼Œç”¨äºåœ¨APIå‘½ä»¤ä¸­ä½œä¸ºå‚æ•°ä¼ é€’ã€‚ä¸‹é¢æ˜¯ä¸€äº›ç¤ºä¾‹ï¼šVKInstance|VkCommandBuffer|VkPhysicalDevice|VkDevice|VkQueue ä¸å¯åˆ†å‘å¥æŸ„(Non-dispatchable handles)ï¼šè¿™äº›æ˜¯64ä½æ•´å‹ç±»å‹çš„å¥æŸ„ï¼Œå¯ä»¥åŒ…å«å¯¹è±¡ä¿¡æ¯æœ¬èº«ï¼Œè€Œä¸æ˜¯æŒ‡å‘ç»“æ„çš„æŒ‡é’ˆã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼šVKSemaphore|VkFence|VkQueryPool|VkBufferViewVkDeviceMemory|VkBuffer|VkImage|VkPipelineVkShaderModule|VkSampler|VkRenderPass|VkDescriptorPool å¯¹è±¡ç”Ÿå‘½å‘¨æœŸå’Œå‘½ä»¤è¯­æ³•åœ¨Vulkanä¸­ï¼Œæ ¹æ®æ¯ä¸ªåº”ç”¨ç¨‹åºçš„é€»è¾‘ï¼Œéƒ½è¦æ˜¾ç¤ºåˆ›å»ºå’Œé”€æ¯å¯¹è±¡ï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åºè¦è´Ÿè´£ç®¡ç†è¿™äº›å¯¹è±¡ã€‚Vulkanä¸­çš„å¯¹è±¡ä½¿ç”¨Createåˆ›å»ºå¹¶ä½¿ç”¨Destroyå‘½ä»¤é”€æ¯ï¼š åˆ›å»ºè¯­æ³•ï¼šå¯¹è±¡ä½¿ç”¨vkCreate *å½¢å¼çš„å‘½ä»¤åˆ›å»ºçš„ï¼›è¿™ç±»å‘½ä»¤æ¥å—ä¸€ä¸ªVk *CreateInfoç»“æ„ä½œä¸ºè¾“å…¥å‚æ•°ã€‚ é”€æ¯è¯­æ³•ï¼šå¯¹åº”çš„ï¼Œä½¿ç”¨vkCreateå‘½ä»¤ç”Ÿæˆçš„å¯¹è±¡è¦ä½¿ç”¨vkDestroyè¿›è¡Œé”€æ¯ã€‚ä½œä¸ºç°æœ‰å¯¹è±¡æ± æˆ–å †çš„ä¸€éƒ¨åˆ†è€Œåˆ›å»ºçš„å¯¹è±¡è¦ä½¿ç”¨Allocateå‘½ä»¤åˆ›å»ºå¹¶ä½¿ç”¨Freeå‘½ä»¤ä»æ± æˆ–è€…å †ä¸­è¿›è¡Œé‡Šæ”¾ã€‚ åˆ†é…è¯­æ³•ï¼šä½œä¸ºå¯¹è±¡æ± çš„ä¸€éƒ¨åˆ†åˆ›å»ºçš„å¯¹è±¡ä½¿ç”¨vkAllocate *å½¢å¼çš„å‘½ä»¤ï¼Œå¹¶ä¸”ä½¿ç”¨Vk* AllocateInfoä½œä¸ºè¾“å…¥å‚æ•°ã€‚ é”€æ¯è¯­æ³•ï¼šç›¸åº”çš„ï¼Œä½¿ç”¨vkFree*å‘½ä»¤æŠŠå¯¹è±¡é‡Šæ”¾å›æ± æˆ–è€…å†…å­˜ä¸­ã€‚ ä½¿ç”¨vkGetå‘½ä»¤å¯ä»¥è½»æ¾è®¿é—®ä»»ä½•ç»™å®šçš„å®ç°ä¿¡æ¯ã€‚vkCmdå½¢å¼çš„APIå®ç°ç”¨äºåœ¨å‘½ä»¤ç¼“å†²åŒºä¸­è®°å½•å‘½ä»¤ã€‚ é”™è¯¯æ£€æŸ¥å’ŒéªŒè¯Vulkanä¸“é—¨æä¾›é«˜æ€§èƒ½è€Œè®¾è®¡ï¼Œè¿™æ˜¯é€šè¿‡ä¿æŒé”™è¯¯æ£€æŸ¥å’ŒéªŒè¯åŠŸèƒ½ä½œä¸ºä¸€ç§å¯é€‰é¡¹çš„å½¢å¼å®ç°çš„ã€‚åœ¨è¿è¡Œæ—¶ï¼Œé”™è¯¯æ£€æŸ¥å’ŒéªŒè¯çš„éƒ¨åˆ†å°‘ä¹‹åˆå°‘ï¼Œä»è€Œä½¿å¾—æ„å»ºå‘½ä»¤ç¼“å†²åŒºå’Œæäº¤å˜å¾—æ›´åŠ é«˜æ•ˆã€‚è¿™äº›å¯é€‰åŠŸèƒ½å¯ä»¥é€šè¿‡Vulkançš„åˆ†å±‚ä½“ç³»ç»“æ„æ¥å®ç°ï¼Œè¯¥åˆ†å±‚ä½“ç³»ç»“æ„å…è®¸æŠŠå„ç§å±‚ï¼ˆè°ƒè¯•å±‚å’ŒéªŒè¯å±‚ï¼‰åŠ¨æ€æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„ç³»ç»Ÿä¸­ã€‚ äº†è§£ Vulkanåº”ç”¨ä»¥ä¸‹æ¡†å›¾æ˜¾ç¤ºäº†ç³»ç»Ÿä¸­ä¸åŒç»„ä»¶æ¨¡å—ä»¥åŠå¯¹åº”çš„è”ç³»ï¼š é©±åŠ¨ç¨‹åºå…·æœ‰VulkanåŠŸèƒ½çš„ç³»ç»Ÿè‡³å°‘åŒ…å«ä¸€ä¸ªCPUå’ŒGPUã€‚IHVçš„ä¾›åº”å•†ä¸ºå…¶ä¸“ç”¨GPUæ¶æ„æä¾›äº†æŒ‡å®šVulkanè§„èŒƒå®ç°çš„é©±åŠ¨ç¨‹åºã€‚é©±åŠ¨ç¨‹åºå……å½“åº”ç”¨ç¨‹åºè®¾å¤‡æœ¬èº«ä¹‹é—´çš„æ¥å£ã€‚å®ƒä¸ºåº”ç”¨ç¨‹åºæä¾›äº†ä¸€äº›é«˜çº§è®¾æ–½ï¼Œä»¥ä¾¿èƒ½å¤Ÿä¸è®¾å¤‡è¿›è¡Œé€šä¿¡ã€‚ä¾‹å¦‚ï¼Œé©±åŠ¨ç¨‹åºé€šçŸ¥äº†ç³»ç»Ÿä¸Šå¯ç”¨çš„è®¾å¤‡æ•°é‡ã€å®ƒä»¬çš„é˜Ÿåˆ—å’Œé˜Ÿåˆ—åŠŸèƒ½ã€å¯ç”¨çš„å †åŠå…¶ç›¸å…³å±æ€§ç­‰ã€‚ åº”ç”¨ç¨‹åºåº”ç”¨ç¨‹åºæ˜¯æŒ‡ç”¨æˆ·ç¼–å†™çš„ç¨‹åºï¼Œæ—¨åœ¨åˆ©ç”¨Vulkan APIæ¥æ‰§è¡Œå›¾å½¢æˆ–è®¡ç®—ä»»åŠ¡ã€‚åº”ç”¨ç¨‹åºä»ç¡¬ä»¶å’Œè½¯ä»¶çš„åˆå§‹åŒ–å¼€å§‹ï¼Œå®ƒä¼šæ£€æµ‹é©±åŠ¨ç¨‹åºå¹¶åŠ è½½æ‰€æœ‰çš„Vulkan APIã€‚å±•ç¤ºå±‚(presentation layer)ä½¿ç”¨Vulkançš„çª—å£ç³»ç»Ÿé›†æˆâ€”â€”Window System Integrationâ€”â€”(WSI)APIè¿›è¡Œåˆå§‹åŒ–ï¼›WSIå°†ç”¨äºæ¸²æŸ“æœŸé—´åœ¨æ˜¾ç¤ºè¡¨é¢(display surface)ä¸Šç»˜åˆ¶å›¾å½¢å›¾åƒã€‚åº”ç”¨ç¨‹åºåˆ›å»ºèµ„æºå¹¶ä½¿ç”¨æè¿°ç¬¦(descripors)å°†å®ƒä»¬ç»‘å®šåˆ°ç€è‰²å™¨é˜¶æ®µ(shader stage)ã€‚æè¿°ç¬¦é›†å¸ƒå±€(descriptor set layout)ç”¨äºæŠŠåˆ›å»ºçš„èµ„æºç»‘å®šåˆ°åˆ›å»ºçš„åº•å±‚ç®¡çº¿å¯¹è±¡pipeline object(å›¾å½¢æˆ–è®¡ç®—ç±»å‹graphics or compute type)ã€‚æœ€åï¼Œè®°å½•å‘½ä»¤ç¼“å†²åŒºå¹¶å°†å…¶æäº¤åˆ°é˜Ÿåˆ—è¿›è¡Œå¤„ç†ã€‚ WSIçª—å£ç³»ç»Ÿé›†æˆWSI(Windows System Integration)æ˜¯æ¥è‡ªKhronosçš„ä¸€ç»„æ‰©å±•ï¼Œç”¨äºè·¨å¹³å°(å¦‚Linux,Windowså’ŒAndroid)ã€‚ SPIR-VSPIR-Væä¾›äº†ä¸€ç§é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œç”¨äºæŒ‡å®šVulkanç€è‰²å™¨ã€‚ç¼–è¯‘å™¨å¯ç”¨äºå„ç§ç€è‰²å™¨è¯­è¨€ï¼Œå…¶ä¸­åŒ…æ‹¬èƒ½å¤Ÿç”ŸæˆSPIR-Vçš„GLSLå’ŒHLSLå˜ç§ã€‚ LunarG SDKLunarGçš„Vulkan SDKåŒ…å«äº†å„ç§å·¥å…·å’Œèµ„æºï¼Œç”¨ä»¥è¾…åŠ©Vulkanåº”ç”¨ç¨‹åºçš„å¼€å‘ã€‚è¿™äº›å·¥å…·å’Œèµ„æºåŒ…æ‹¬VulkanåŠ è½½ç¨‹åºã€éªŒè¯å±‚ã€è·Ÿè¸ªå’Œå›æ”¾å·¥å…·ã€SPIR-Vå·¥å…·ã€Vulkanè¿è¡Œæ—¶å®‰è£…ç¨‹åºã€æ–‡æ¡£ï¼Œç¤ºä¾‹ä»¥åŠæ¼”ç¤ºã€‚ Vulkanç¼–ç¨‹æ¨¡å‹å…¥é—¨ä¸‹å›¾æ˜¾ç¤ºäº†Vulkanåº”ç”¨ç¨‹åºç¼–ç¨‹æ¨¡å‹è‡ªé¡¶å‘ä¸‹çš„æ–¹æ³•ï¼› ç¡¬ä»¶åˆå§‹åŒ–å½“Vulkanåº”ç”¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå·¥ä½œå°±æ˜¯ç¡¬ä»¶çš„åˆå§‹åŒ–ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œåº”ç”¨ç¨‹åºé€šè¿‡ä¸åŠ è½½å™¨è¿›è¡Œé€šä¿¡æ¥æ¿€æ´»Vulkané©±åŠ¨ç¨‹åºã€‚ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªåŠ è½½å™¨LoaderåŠå…¶å­ç»„ä»¶çš„æ¡†å›¾ï¼š Loaderï¼šåŠ è½½ç¨‹åºæ˜¯åº”ç”¨å¯åŠ¨æ—¶ä½¿ç”¨çš„ä¸€æ®µä»£ç ï¼Œå¯ä»¥è·¨å¹³å°ã€ä»¥ä¸€ç§ç»Ÿä¸€çš„æ–¹å¼åœ¨ç³»ç»Ÿä¸­å®šä½Vulkané©±åŠ¨ç¨‹åºã€‚ä»¥ä¸‹æ˜¯åŠ è½½Loaderçš„èŒè´£ï¼š å®šä½é©±åŠ¨ç¨‹åº(Locating dirvers)ï¼šä½œä¸ºå…¶ä¸»è¦çš„ä»»åŠ¡ï¼ŒåŠ è½½ç¨‹åºçŸ¥é“åœ¨ç»™å®šç³»ç»Ÿä¸­åˆ°å“ªé‡Œæœç´¢é©±åŠ¨ç¨‹åºã€‚å®ƒä¼šæ‰¾åˆ°æ­£ç¡®çš„é©±åŠ¨ç¨‹åºå¹¶åŠ è½½ã€‚ ä¸ä¾èµ–å¹³å°(Platform-independent)ï¼šåˆå§‹åŒ–Vulkanåœ¨æ‰€æœ‰å¹³å°ä¸Šéƒ½æ˜¯ä¸€è‡´çš„ã€‚è¿™ä¸OpenGLä¸åŒï¼ŒOpenGLåˆ›å»ºä¸Šä¸‹æ–‡éœ€è¦é’ˆå¯¹æ¯ä¸ªç¯å¢ƒ(EGL,GLX,WGL)ä½¿ç”¨ä¸åŒçš„çª—å£ç³»ç»ŸAPIã€‚Vulkanä¸­çš„å¹³å°å·®å¼‚ä»¥æ‰©å±•åè¡¨ç¤ºã€‚ å¯æ³¨å…¥çš„å±‚(Injectable layers)ï¼šåŠ è½½å™¨æ”¯æŒå±‚æ¬¡åŒ–çš„ä½“ç³»ç»“æ„å¹¶æä¾›åœ¨è¿è¡Œæ—¶æ³¨å…¥å„å±‚çš„èƒ½åŠ›ã€‚æœ€å¤§çš„æ”¹è¿›å°±æ˜¯é©±åŠ¨ç¨‹åºåœ¨ç¡®å®šåº”ç”¨ç¨‹åºå †APIçš„ä½¿ç”¨æ˜¯å¦æœ‰æ•ˆæ—¶ä¸éœ€è¦æ‰§è¡Œä»»ä½•å·¥ä½œï¼Œä¹Ÿä¸ä¼šä¿ç•™æ‰§è¡Œè¯¥å·¥ä½œæ‰€éœ€çš„ä»»ä½•çŠ¶æ€ã€‚å› æ­¤ï¼Œå»ºè®®åœ¨å¼€å‘é˜¶æ®µæ ¹æ®åº”ç”¨è¦æ±‚æ‰“å¼€é€‰å®šçš„å¯æ³¨å…¥å±‚ï¼Œå¹¶åœ¨éƒ¨ç½²é˜¶æ®µå°†å…¶å…³é—­ã€‚ä¾‹å¦‚ï¼Œå¯æ³¨å…¥å±‚å¯ä»¥ä»¥ä¸‹å†…å®¹ï¼š è·Ÿè¸ªVulkan APIå‘½ä»¤ æ•è·è¦æ¸²æŸ“çš„åœºæ™¯å¹¶åœ¨ç¨åæ‰§è¡Œåœºæ™¯çš„æ¸²æŸ“ ç”¨äºè°ƒè¯•ç›®çš„çš„é”™è¯¯æ£€æŸ¥å’ŒéªŒè¯ Vulkanåº”ç”¨ç¨‹åºé¦–å…ˆæ‰§è¡Œä¸åŠ è½½ç¨‹åºåº“çš„æ¡æ‰‹å¹¶åˆå§‹åŒ–Vulkanå…·ä½“å®ç°çš„é©±åŠ¨ç¨‹åºã€‚åŠ è½½ç¨‹åºåº“ä¼šåŠ¨æ€åŠ è½½Vulkan APIã€‚åŠ è½½ç¨‹åºè¿˜æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå…è®¸å°†ç‰¹å®šçš„å±‚è‡ªåŠ¨åŠ è½½åˆ°æ‰€æœ‰Vulkanåº”ç”¨ç¨‹åºä¸­ï¼›è¿™è¢«ç§°ä¸ºéšå¼å¯ç”¨å±‚ã€‚ ä¸€æ—¦åŠ è½½ç¨‹åºæ‰¾åˆ°é©±åŠ¨ç¨‹åºå¹¶æˆåŠŸé“¾æ¥åˆ°APIï¼Œåº”ç”¨ç¨‹åºå°±è¦å¤æ‚ä»¥ä¸‹æ“ä½œï¼š åˆ›å»ºä¸€ä¸ªVulkanå®ä¾‹ æŸ¥è¯¢ç‰©ç†è®¾å¤‡çš„å¯ç”¨é˜Ÿåˆ— æŸ¥è¯¢æ‰©å±•å¹¶å°†å®ƒä»¬å­˜å‚¨ä½å‡½æ•°æŒ‡é’ˆï¼Œå¦‚WSIæˆ–ç‰¹æ®ŠåŠŸèƒ½çš„API å¯ç”¨å¯æ³¨å…¥æ›¾ï¼Œè¿›è¡Œé”™è¯¯æ£€æŸ¥ã€è°ƒè¯•æˆ–éªŒè¯æ“ä½œ çª—å£å±•ç¤ºè¡¨é¢(Window presentation surfaces)ä¸€æ—¦åŠ è½½å™¨æ‰¾åˆ°Vulkanå…·ä½“å®ç°çš„é©±åŠ¨ç¨‹åºï¼Œ]]></content>
      <categories>
        <category>Vulkan</category>
      </categories>
      <tags>
        <tag>è®¡ç®—æœºå›¾å½¢å­¦</tag>
        <tag>Vulkan</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¡«å……ä¸‰è§’å½¢]]></title>
    <url>%2F2019%2F05%2F27%2Ffilltriangle%2F</url>
    <content type="text"><![CDATA[å¡«å……ä¸‰è§’å½¢çº¿æ€§æ’å€¼æ¥å¤ä¹ ä¸€ä¸‹ç”»çº¿,æˆ‘ä»¬çŸ¥é“ç”»çº¿çš„æ—¶å€™æˆ‘ä»¬åšçš„å®é™…ä¸Šæ˜¯è¿™æ ·çš„äº‹æƒ…ï¼šå¯¹äºè¦ç”»çš„çº¿ABï¼Œåœ¨æ»¡è¶³æˆ‘ä»¬è®¾å®šçš„æ¡ä»¶ï¼ˆæ–œç‡ â‰¤ 1, A &lt; Bï¼‰ä¹‹åï¼Œå› ä¸ºæˆ‘ä»¬è¦ç”»çš„æ˜¯æ•´æ•°çš„åƒç´ ç‚¹ï¼Œå¯¹äºxæ¯å¢åŠ 1ï¼Œæˆ‘ä»¬ç®—å‡ºå¯¹åº”çš„yï¼Œç„¶åæ¥ç”»ç‚¹ï¼ˆxï¼Œyï¼‰ï¼Œè¿™æ ·é‡å¤ç›´åˆ°xå¢åŠ åˆ°Bç‚¹ï¼š å¯¹äº AB ä¸Šçš„ä»»æ„ä¸€ç‚¹ P æ»¡è¶³ï¼š P = A + t(B - A), 0 \le t \le 1ä¹Ÿå¯ä»¥å†™æˆï¼š P = (1 - t)A + tB , 0 \le t \le 1è¿™ä¸ªå…¬å¼æ˜¯è‘—åçš„çº¿æ€§æ’å€¼ï¼Œå®é™…ä¸Šä¹Ÿæ˜¯æˆ‘ä»¬ç”»çº¿çš„åŸºç¡€ã€‚å› ä¸ºåœ¨ç”»çº¿éƒ¨åˆ†æ ¸å¿ƒä»£ç é•¿è¿™æ ·ï¼š 12345for (int x=x0; x&lt;=x1; x++) &#123; float t = (x-x0)/(float)(x1-x0); int y = y0 + (y1 - y0)*t; ...&#125; å¯¹äºPç‚¹ï¼Œæˆ‘ä»¬æ ¹æ®å¢åŠ åçš„xç®—å‡ºtå€¼ï¼Œç„¶åç®—å‡ºyï¼Œå¾—åˆ°åº”è¯¥ç”»çš„ç‚¹ã€‚ å…¶å®åœ¨ç”»æ¡†æ¶çš„æ—¶å€™æˆ‘ä»¬å·²ç»ç”»è¿‡ä¸‰è§’å½¢äº†ï¼Œå°±ç”»ä¸‰æ¡çº¿å°±OKã€‚ç°åœ¨æˆ‘ä»¬è¦åšçš„æ˜¯æ¥å¡«å……ä¸‰è§’å½¢ã€‚ æ‰«ææ³•è‹¥è¦å¡«å……ä¸€ä¸ªä¸‰è§’å½¢ï¼Œæœ€ç®€å•çš„èƒ½æƒ³åˆ°çš„åŠæ³•æ˜¯å¯¹äºä¸‰è§’å½¢çš„æ¯ä¸€ä¸ªyï¼Œæˆ‘ä»¬æ‰¾åˆ°å¯¹åº”çš„å·¦ä¾§å’Œå³ä¾§ï¼Œx_leftå’Œx_rightï¼Œæˆ‘ä»¬ç”»ä¸Šx_leftåˆ°x_rightçš„çº¿ï¼Œé‚£ä¹ˆä»ä¸‰è§’å½¢æœ€ä¸Šé¢çš„ç‚¹æŒ‰yå¢åŠ æ‰«åˆ°æœ€ä¸‹é¢çš„ç‚¹æ—¢å¯ã€‚ ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å…ˆæŠŠä¸‰è§’å½¢æ‹†æˆä¸Šä¸‹ä¸¤éƒ¨åˆ†ï¼š é‚£ä¹ˆå¯¹äºä¸€ä¸ªç‰¹å®šçš„yï¼Œæˆ‘ä»¬æƒ³è¦æ‰¾åˆ°å®ƒçš„å·¦è¾¹å’Œå³è¾¹ A B ä¸¤ç‚¹ï¼Œæ€è·¯æ˜¯è¿™æ ·ï¼š é¦–å…ˆæ’åºï¼Œä¿è¯ t0 â‰¤ t1 â‰¤ t2 æ•´ä¸ªä¸‰è§’å½¢çš„é«˜åº¦å¿…ä¸º t2.y - t0.y é‚£ä¹ˆå¯¹äºä¸ŠåŠéƒ¨åˆ†ï¼Œyæ¯å¢åŠ 1ï¼ˆæ³¨æ„æœ‰å¯èƒ½t0 == t1),æˆ‘ä»¬ç”¨æ’å€¼æ³•ç®—å‡ºå¯¹åº”çš„ä¸¤ç‚¹Aå’ŒB è¿™æ ·å°±èƒ½ç®—å‡ºå¯¹åº”çš„ A å’Œ B 12345678910111213141516void triangle(Vec2i t0, Vec2i t1, Vec2i t2, TGAImage &amp;image, TGAColor color) &#123; // sort the vertices, t0, t1, t2 lowerâˆ’toâˆ’upper (bubblesort yay!) if (t0.y&gt;t1.y) std::swap(t0, t1); if (t0.y&gt;t2.y) std::swap(t0, t2); if (t1.y&gt;t2.y) std::swap(t1, t2); int total_height = t2.y-t0.y; for (int y=t0.y; y&lt;=t1.y; y++) &#123; int segment_height = t1.y-t0.y+1; float alpha = (float)(y-t0.y)/total_height; float beta = (float)(y-t0.y)/segment_height; // be careful with divisions by zero Vec2i A = t0 + (t2-t0)*alpha; Vec2i B = t0 + (t1-t0)*beta; image.set(A.x, y, red); image.set(B.x, y, green); &#125; &#125; é‚£ä¹ˆæœ‰äº† A å’Œ B ä¹‹åï¼Œæˆ‘ä»¬åœ¨ABä¹‹é—´è°ƒç”¨æˆ‘ä»¬çš„ç”»çº¿å‡½æ•°ï¼Œå†ç”¨åŒæ ·çš„æ–¹æ³•ç»™ä¸‹åŠéƒ¨åˆ†å¡«æ»¡ï¼Œé—®é¢˜æ—¢è§£å†³ã€‚ 1234567891011121314151617181920212223242526272829void triangle(Vec2i t0, Vec2i t1, Vec2i t2, TGAImage &amp;image, TGAColor color) &#123; // sort the vertices, t0, t1, t2 lowerâˆ’toâˆ’upper (bubblesort yay!) if (t0.y&gt;t1.y) std::swap(t0, t1); if (t0.y&gt;t2.y) std::swap(t0, t2); if (t1.y&gt;t2.y) std::swap(t1, t2); int total_height = t2.y-t0.y; for (int y=t0.y; y&lt;=t1.y; y++) &#123; int segment_height = t1.y-t0.y+1; float alpha = (float)(y-t0.y)/total_height; float beta = (float)(y-t0.y)/segment_height; // be careful with divisions by zero Vec2i A = t0 + (t2-t0)*alpha; Vec2i B = t0 + (t1-t0)*beta; if (A.x&gt;B.x) std::swap(A, B); for (int j=A.x; j&lt;=B.x; j++) &#123; image.set(j, y, color); // attention, due to int casts t0.y+i != A.y &#125; &#125; for (int y=t1.y; y&lt;=t2.y; y++) &#123; int segment_height = t2.y-t1.y+1; float alpha = (float)(y-t0.y)/total_height; float beta = (float)(y-t1.y)/segment_height; // be careful with divisions by zero Vec2i A = t0 + (t2-t0)*alpha; Vec2i B = t1 + (t2-t1)*beta; if (A.x&gt;B.x) std::swap(A, B); for (int j=A.x; j&lt;=B.x; j++) &#123; image.set(j, y, color); // attention, due to int casts t0.y+i != A.y &#125; &#125; &#125; è¿™æ ·ä¸‰è§’å½¢å¡«å……å°±è§£å†³ã€‚ä»£ç é‡Œæœ‰å¾ˆå¤šé‡å¤çš„éƒ¨åˆ†ï¼Œç„¶åè¿™é‡Œå†³å®šè®©ä»£ç çŸ­ä¸€ç‚¹ï¼Œä»£ä»·æ˜¯è¯»èµ·æ¥æ²¡é‚£ä¹ˆæ¸…æ¥šäº†ï¼š 1234567891011121314151617181920void triangle(Vec2i t0, Vec2i t1, Vec2i t2, TGAImage &amp;image, TGAColor color) &#123; if (t0.y==t1.y &amp;&amp; t0.y==t2.y) return; // I dont care about degenerate triangles // sort the vertices, t0, t1, t2 lowerâˆ’toâˆ’upper (bubblesort yay!) if (t0.y&gt;t1.y) std::swap(t0, t1); if (t0.y&gt;t2.y) std::swap(t0, t2); if (t1.y&gt;t2.y) std::swap(t1, t2); int total_height = t2.y-t0.y; for (int i=0; i&lt;total_height; i++) &#123; bool second_half = i&gt;t1.y-t0.y || t1.y==t0.y; int segment_height = second_half ? t2.y-t1.y : t1.y-t0.y; float alpha = (float)i/total_height; float beta = (float)(i-(second_half ? t1.y-t0.y : 0))/segment_height; // be careful: with above conditions no division by zero here Vec2i A = t0 + (t2-t0)*alpha; Vec2i B = second_half ? t1 + (t2-t1)*beta : t0 + (t1-t0)*beta; if (A.x&gt;B.x) std::swap(A, B); for (int j=A.x; j&lt;=B.x; j++) &#123; image.set(j, t0.y+i, color); // attention, due to int casts t0.y+i != A.y &#125; &#125; &#125; wavefront objä¸Šä¸€ç« æˆ‘ä»¬ç”»äº†æ¡†æ¶ï¼Œè¿™ä¸‹æˆ‘ä»¬æ¥å¡«ä¸Šä¸‰è§’å½¢ï¼š å¥½å§ï¼Œå¹¶ä¸æ˜¯å¾ˆåŠ¨äºº=ã€‚=ä¹‹æ‰€ä»¥ä¸åŠ¨äººæ˜¯å› ä¸ºå…‰å½±å…‰å½±ï¼Œæˆ‘ä»¬åªæœ‰é¢œè‰²ï¼Œæ²¡æœ‰è€ƒè™‘å…‰ï¼Œ ä»£ç  é‡å¿ƒåæ ‡æ³•é™¤äº†ä¸Šé¢æåˆ°çš„æ‰«ææ³•ä¹‹å¤–ï¼Œå¦å¤–ä¸€ä¸ªå¯ä»¥æƒ³åˆ°çš„åŠæ³•æ˜¯ï¼Œå› ä¸ºæˆ‘ä»¬ç»ˆç©¶æ˜¯ç”»åˆ°äºŒç»´å¹³é¢ä¸Šçš„åƒç´ ï¼Œä¸€ä¸ªä¸€ä¸ªçš„ç‚¹ï¼Œé‚£ä¹ˆå¯¹äºæˆ‘ä»¬è¦ç”»çš„åŒºåŸŸå†…çš„æ¯ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥æ£€æµ‹çœ‹å®ƒæ˜¯å¦åœ¨ä¸‰è§’å½¢ä¹‹å†…ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œç”»å®ƒï¼Œå¦åˆ™ä¸ç†ä¹‹ã€‚è¿™æ ·çš„æ€è·¯æ˜¯å¯è¡Œçš„ï¼Œå¯¹äºä¸‰è§’å½¢å†…åŠå…¶è¾¹ä¸Šçš„ä»»æ„ä¸€ç‚¹ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç”¨é‡å¿ƒåæ ‡ç³»æ¥è¡¨ç¤ºï¼š P = (1 - u - v)A + uB + vC, 0 \le u,v \le 1è¿™ä¸ªé•¿å¾—ä¹Ÿå¾ˆåƒçº¿æ€§æ’å€¼ã€‚ è¿ç®—: P = A + u\overrightarrow{AB} + v\overrightarrow{AC}ç»§ç»­ï¼š u\overrightarrow{AB} + v\overrightarrow{AC} + \overrightarrow{PA} = 0PAæ˜¯ABå’ŒACçš„çº¿æ€§ç»„åˆã€‚ æ‹†ä¸€æ‹†ï¼š u\overrightarrow{AB}_x + v\overrightarrow{AC}_x + \overrightarrow{PA}_x = 0 u\overrightarrow{AB}_y + v\overrightarrow{AC}_y + \overrightarrow{PA}_y = 0å®é™…ä¸Šæˆ‘ä»¬éƒ½å¯ä»¥çœ‹åšæ˜¯æˆ‘ä»¬åœ¨å¯»æ‰¾å‘é‡ $(u, v, 1)$ åŒæ—¶å‚ç›´äºå‘é‡ $(\overrightarrow{AB}_x, \overrightarrow{AC}_x,\overrightarrow{PA}_x)$ å’Œå‘é‡ $(\overrightarrow{AB}_y, \overrightarrow{AC}_y,\overrightarrow{PA}_y)$ã€‚ è¿™å°±æ˜¯å‰ä¹˜ã€‚ 12345xvector = (B_x - A_x, C_x - A_x, A_x - P_x)yvector = (B_y - A_y, C_y - A_y, A_y - P_y)u = xvector x yvector# å¦‚æœ u çš„ z åˆ†é‡ä¸ç­‰äº1åˆ™è¯´æ˜Pç‚¹ä¸åœ¨ä¸‰è§’å½¢å†… å› ä¸ºæˆ‘ä»¬çš„è®¡ç®—æœ‰æµ®ç‚¹æ•°ï¼Œå¯èƒ½uçš„zåˆ†é‡ä¸ä¼šä¸€å®šç­‰äº1,ä»¤ u çš„ä¸‰ä¸ªåˆ†é‡æ˜¯ (a, b, c),æˆ‘ä»¬ä»£å…¥åŸå¼å­ï¼š a\overrightarrow{AB} + b\overrightarrow{AC} + c\overrightarrow{PA} = 0 P = (1 - a/c - b/c)A + a/cB + b/cC, c \ne 0ä»£ç æˆ‘ä»¬è¿™æ ·å†™ï¼š 123456789101112Vec3f barycentric(Vec2f A, Vec2f B, Vec2f C, Vec2f P) &#123; Vec3f s[2]; for (int i=2; i--; ) &#123; s[i][0] = C[i]-A[i]; s[i][1] = B[i]-A[i]; s[i][2] = A[i]-P[i]; &#125; Vec3f u = cross(s[0], s[1]); if (std::abs(u[2])&gt;1e-2) // dont forget that u[2] is integer. If it is zero then triangle ABC is degenerate return Vec3f(1.f-(u.x+u.y)/u.z, u.y/u.z, u.x/u.z); return Vec3f(-1,1,1); // in this case generate negative coordinates, it will be thrown away by the rasterizator&#125; æˆ‘ä»¬å½“ç„¶ä¹Ÿä¸ç”¨æŠŠå¹³é¢åŒºåŸŸçš„æ¯ä¸ªç‚¹ä»£å…¥På»åšæ£€æŸ¥ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä¸‰è§’å½¢çš„ bounding_box,ç„¶åçœ‹å…¶ä¸­çš„æ¯ä¸€ä¸ªæ•´æ•°ç‚¹ï¼Œå¦‚æœåœ¨å…¶ä¸­ï¼Œé‚£å°±ç”»ä¹‹ã€‚ ç”¨åŒæ ·çš„æ–¹æ³•æ¥ç»™æ¨¡å‹å¡«è‰²ï¼Œæ•ˆæœä¸€æ ·ã€‚ ä»£ç  æ•ˆæœè·Ÿä¹‹å‰ä¾æ—§ä¸€è‡´ï¼Œæˆ‘ä»¬ç»™æ¯ä¸ªä¸‰è§’å½¢éšæœºå¡«ä¸Šè‰²ï¼š éšæœºå¡«è‰²è¿™ä¸ªæˆ‘ä»¬çœ‹èµ·æ¥å€’æ˜¯æœ‰ç‚¹cool.]]></content>
      <categories>
        <category>OpenGL</category>
      </categories>
      <tags>
        <tag>è®¡ç®—æœºå›¾å½¢å­¦</tag>
        <tag>å…‰æ …</tag>
        <tag>OpenGL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python]]></title>
    <url>%2F2019%2F05%2F27%2Fpython%2F</url>
    <content type="text"><![CDATA[python3 æ€ä¹ˆå®‰è£… PILå…³äºPillowä¸PIL PIL(Python Imaging Library)æ˜¯Pythonä¸€ä¸ªå¼ºå¤§æ–¹ä¾¿çš„å›¾åƒå¤„ç†åº“ï¼Œåæ°”ä¹Ÿæ¯”è¾ƒå¤§ã€‚ä¸è¿‡åªæ”¯æŒåˆ°Python 2.7ã€‚ PILå®˜æ–¹ç½‘ç«™ï¼šhttp://www.pythonware.com/products/pil/ Pillowæ˜¯PILçš„ä¸€ä¸ªæ´¾ç”Ÿåˆ†æ”¯ï¼Œä½†å¦‚ä»Šå·²ç»å‘å±•æˆä¸ºæ¯”PILæœ¬èº«æ›´å…·æ´»åŠ›çš„å›¾åƒå¤„ç†åº“ã€‚ç›®å‰æœ€æ–°ç‰ˆæœ¬æ˜¯3.0.0ã€‚ Pillowçš„Githubä¸»é¡µï¼šhttps://github.com/python-pillow/PillowPillowçš„æ–‡æ¡£(å¯¹åº”ç‰ˆæœ¬v3.0.0)ï¼šhttps://pillow.readthedocs.org/en/latest/handbook/index.htmlPillowçš„æ–‡æ¡£ä¸­æ–‡ç¿»è¯‘(å¯¹åº”ç‰ˆæœ¬v2.4.0)ï¼šhttp://pillow-cn.readthedocs.org/en/latest/ Python 3.x å®‰è£…Pillow ç»™Pythonå®‰è£…Pillowéå¸¸ç®€å•ï¼Œä½¿ç”¨pipæˆ–easy_installåªè¦ä¸€è¡Œä»£ç å³å¯ã€‚ åœ¨å‘½ä»¤è¡Œä½¿ç”¨PIPå®‰è£…ï¼špip install Pillow æˆ–åœ¨å‘½ä»¤è¡Œä½¿ç”¨easy_installå®‰è£…ï¼šeasy_install Pillow å®‰è£…å®Œæˆåï¼Œä½¿ç”¨from PIL import Imageå°±å¼•ç”¨ä½¿ç”¨åº“äº†ã€‚æ¯”å¦‚ï¼šfrom PIL import Imageim = Image.open(â€œbride.jpgâ€)im.rotate(45).show()]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DrawLine]]></title>
    <url>%2F2019%2F05%2F27%2FDrawLine%2F</url>
    <content type="text"><![CDATA[ç”»çº¿æˆ‘ä»¬å…ˆä»å±å¹•ç”»çº¿å¼€å§‹ã€‚ é¦–å…ˆï¼Œy = ax + b è¿™ä¸ªå¹¶ä¸èƒ½ç”»å‡ºæ‰€æœ‰çš„çº¿ï¼Œå¹¶ä¸”æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š å¦‚æœaå¾ˆå¤§ï¼Œé‚£ä¹ˆxç”± $x_0$ å¢åŠ åˆ° $x_0+1$ é‚£ä¹ˆyå¢åŠ aï¼Œå¦‚æœ a å¾ˆå¤§ï¼Œé‚£ä¹ˆä¼šæœ‰åˆ†è£‚çš„æ ·å¼ æ— æ³•ç”»å‡ºå¹³è¡Œäº y çš„ç«–çº¿ é’ˆå¯¹è¿™ç§çŠ¶å†µï¼Œæˆ‘ä»¬é‡‡ç”¨çš„ç”»å›¾æ–¹å¼æ˜¯åˆ©ç”¨å¦‚ä¸‹çš„ä»£ç ï¼š 12345678910111213Interpolate (i0, d0, i1, d1)&#123; if i0 == i1 &#123; return [d0] &#125; values = [] a = (d1 - d0) / (i1 - i0) d = d0 for i = i0 to i1&#123; values.append(d) d = d + a &#125; return values&#125; é¦–å…ˆæ˜¯æˆ‘ä»¬åˆ©ç”¨çš„æ˜¯è¦ä¹ˆ y = ax + b , è¦ä¹ˆ x = ay + b, æ„æ€æ˜¯è¦ä¹ˆæˆ‘ä»¬è®© y éšç€ x å˜åŒ–ï¼Œè¦ä¹ˆè®© x éšç€ y å˜åŒ–. åœ¨ä¸Šè¿°çš„ä¼ªç ä¸­ï¼Œæˆ‘ä»¬çš„ d æ˜¯ dependent valueï¼Œ i æ˜¯ independent valueï¼Œæˆ‘ä»¬è®© d éšç€ i å˜åŒ–ã€‚ å…¶æ¬¡æ˜¯æˆ‘ä»¬åˆ†æƒ…å†µï¼Œçœ‹çº¿æ˜¯æ›´åŠ æ°´å¹³æˆ–è€…æ˜¯æ›´åŠ ç«–ç›´ï¼Œå¦‚æœçº¿æ›´åŠ æ°´å¹³ï¼Œé‚£ä¹ˆ y éšç€xå˜åŒ–ï¼Œå¦‚æœæ›´ç«–ç›´ï¼Œé‚£ä¹ˆx éšç€yå˜åŒ–ï¼Œè¿™æ ·æ¥ä½œå›¾ã€‚ 1234567891011121314151617181920212223DrawLine(P0, P1, color) &#123; if abs(x1 - x0) &gt; abs(y1 -y0)&#123; # Line is horizontal-ish # Make sure x0 &lt; x1 if x0 &gt; x1 &#123; swap(P0, P1) &#125; ys = Interpolate(x0, y0, x1, y1) for x = x0 to x1&#123; canvas.PutPixel(x, ys[x-x0], color) &#125; &#125; else &#123; # Line is vertical-ish # Make sure y0 &lt; y1 if y0 &gt; y1 &#123; swap(P0,P1) &#125; xs = Interpolate(y0, x0, y1, x1) for y = y0 to y1&#123; canvas.PutPixel(xs[y-y0], y, color) &#125; &#125;&#125; ç”»å‡ºæ¥ ä»£ç ]]></content>
      <categories>
        <category>è®¡ç®—æœºå›¾å½¢å­¦</category>
      </categories>
      <tags>
        <tag>è®¡ç®—æœºå›¾å½¢å­¦</tag>
        <tag>å…‰æ …</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å…‰çº¿è·Ÿè¸ª]]></title>
    <url>%2F2019%2F05%2F27%2FRayTracying%2F</url>
    <content type="text"><![CDATA[RayTracyingRayTracyingæœ€å…³é”®çš„ç‚¹æ˜¯ï¼š ğŸ‘çœ‹å‡ºå»çš„ä¸–ç•Œ è€Œéä¸–ç•Œå¦‚ä½•è¾¾åˆ°ğŸ‘ è¿™ä¹Ÿæ˜¯è¿™ä¸ªç®—æ³•å«åšray tracying - å…‰çº¿è·Ÿè¸ªçš„åŸå› ã€‚ ä¾‹å­1.é¢„å¤‡çŸ¥è¯†1.1 å±å¹•åæ ‡ vs ç”»å¸ƒåæ ‡ä¸€èˆ¬æ¥è¯´å±å¹•åæ ‡éƒ½æ˜¯å§‹äºå·¦ä¸Šè§’ï¼Œç„¶åæœå³å’Œä¸‹å»¶ä¼¸ã€‚ ä¸è¿‡è¿™é‡Œä¸ºäº†ä½œå›¾æ–¹ä¾¿ï¼Œæˆ‘ä»¬æŠŠåæ ‡ç³»æŒ‰ç…§æ•°å­¦ä¸­æ›´å¸¸è§çš„æ–¹å¼æŠŠåŸç‚¹æ”¾äºå±å¹•ä¸­å¤®ï¼Œxå’Œyçš„å»¶ä¼¸æ–¹å‘æŒ‰ç…§å¹³æ—¶çš„ä¹ æƒ¯æ¥æ”¾ã€‚ è¿™æ ·å¯ä»¥çŸ¥é“å±å¹•åæ ‡ç³»$S_x$å’Œç”»å¸ƒåæ ‡ç³»$C_x$çš„å˜æ¢: S_x = \frac{C_w}{2} + C_x S_y = \frac{C_h}{2} - C_y1.2 ç”»å¸ƒ vs çª—æˆ·å› ä¸ºæˆ‘ä»¬å±å¹•æ˜¯äºŒç»´çš„ï¼Œæ— è®ºæˆ‘ä»¬æ€æ ·æ¨¡æ‹Ÿï¼Œå®é™…ä¸Šéƒ½æ˜¯è¦æŠŠç‰©ä½“ç”»åœ¨ä¸€ä¸ªäºŒç»´çš„å¹³é¢ï¼ˆç”»å¸ƒï¼‰ä¸Šï¼Œæˆ‘ä»¬è¿™é‡Œå°±å‡è®¾æˆ‘ä»¬æŠŠğŸ‘æ”¾åœ¨åŸç‚¹ä¸Šï¼Œè€Œæœ‰ä¸€æ‰‡çª—æˆ·åœ¨åæ ‡è½´ z = d å¤„ ï¼Œæˆ‘ä»¬çœ¼ç›èƒ½çœ‹åˆ°çš„ä¹Ÿå°±æ˜¯çª—æˆ·å‡ºå»çš„ä¸–ç•Œã€‚ é‚£ä¹ˆå¯¹äºç”»å¸ƒä¸Šçš„ä»»æ„ä¸€ç‚¹ï¼Œåœ¨çª—æˆ·ä¸Šéƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ä½ç½®ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä¸­å¿ƒç›¸åŒå¹³é¢å¹³è¡Œã€‚ æ‰€ä»¥å¯¹ç”»å¸ƒä¸Šçš„æ¯ä¸€ä¸ªç‚¹$C_x, C_y$æˆ‘ä»¬éƒ½èƒ½æ‰¾åˆ°çª—æˆ·ä¸Šçš„å¯¹åº”ç‚¹$V_x, V_y$ï¼ŒåŠ ä¸Šä¸Šä¸€æ®µè¯ä¸­çš„å¯¹åº”å…³ç³»ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªæ¯”ä¾‹çš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç»§ç»­çŸ¥é“ç”»å¸ƒåæ ‡ç³»$C_x, C_y$åœ¨çª—æˆ·ä¸Šçš„å¯¹åº”åæ ‡$V_x, V_y$ä¸ºï¼š V_x = C_x\frac{V_w}{C_w} V_y = C_y\frac{V_h}{C_h}åŒæ—¶å› ä¸ºçª—æˆ·æ”¾åœ¨ z = d å¤„ï¼Œæˆ‘ä»¬çŸ¥é“ï¼š V_z = dè¿™å°±æœ‰äº†å¦‚ä½•å°†ç”»å¸ƒä¸Šçš„æ¯ä¸€ç‚¹è½¬åŒ–ä¸ºçª—æˆ·ä¸Šçš„æ¯ä¸€ç‚¹çš„åæ ‡å˜æ¢ã€‚ 1.3 çª—æˆ· vs ç©ºé—´ä»çœ¼ç›ğŸ‘å°„å‡ºçš„å…‰çº¿ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥çœ‹æˆæ˜¯$\overrightarrow{OP}$ã€‚ åŒæ—¶Pç‚¹ä½ç½®ä¹Ÿå¯ä»¥å†™æˆï¼š $P = O + t(V-O)$, ä»¤$\overrightarrow{D}$ä¸º$V-O$ï¼Œä¹Ÿå°±æ˜¯å…¶æ–¹å‘çš„å‘é‡ï¼Œå¦‚ä¸‹å›¾ï¼š P = O + t\overrightarrow{D} è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯: O,P,Væ˜¯ä½ç½®ï¼Œ$\overrightarrow{OP}ï¼Œ \overrightarrow{D}$æ˜¯å‘é‡ã€‚ åŒæ—¶çŸ¥é“ï¼š t &lt; 0: é€†å‘äºå…‰çº¿ä¸Šçš„ç‚¹ t = 0: åŸç‚¹ t &gt; 0 &amp;&amp; t &lt; 1: åŸç‚¹åˆ°Vç‚¹ä¹‹é—´çš„ç‚¹ï¼Œä¹Ÿå°±æ˜¯åŸç‚¹åˆ°çª—æˆ·ä¹‹é—´çš„ç‚¹ t = 1: Vç‚¹ t &gt; 1: Vç‚¹ä¹‹åï¼Œä¾æ—§åœ¨å°„å‡ºçš„å…‰çº¿ä¹‹ä¸Šï¼Œå½“tå–æŸä¸ªå€¼ä¸ºPç‚¹ 2.ç©ºé—´æ”¾ç‰©ä½“è¿™é‡Œæˆ‘ä»¬åœ¨ç©ºé—´ä¸­æ”¾ç½®ä¸€ä¸ªçƒä½“ çƒå¿ƒä¸ºCï¼Œé‚£ä¹ˆçƒä¸Šç‚¹Péœ€è¦æ»¡è¶³æ–¹ç¨‹ï¼š |P - C| = r3. å¤„ç†äº¤äº’ è·Ÿè¸ªå…‰çº¿å‡è®¾OPå°±æ˜¯æˆ‘ä»¬çœ‹å‡ºå»çš„å…‰çº¿ï¼Œæ¥è¿½è¸ªå®ƒï¼Œå½“çœ‹å‘çƒä½“æ—¶ï¼Œå®ƒä¼šä¸çƒä½“äº§ç”Ÿäº¤äº’ï¼Œå›¾ä¸­è¿™æ¡å…‰çº¿å°±æ˜¯å’Œçƒä½“ç›¸é‡äº†ï¼š çƒä¸Šçš„å±äºè¿™æ¡å…‰çº¿çš„Pç‚¹åº”è¯¥æ»¡è¶³ï¼š P = O + t\overrightarrow{D} |P - C| = rä»£å…¥1å¼è¿›2å¼ï¼š | O + t\overrightarrow{D} - C| = r | t\overrightarrow{D} + \overrightarrow{OC}| = ræ¥è§£æ–¹ç¨‹ï¼š (t\overrightarrow{OD} + \overrightarrow{OC})(t\overrightarrow{OD} +\overrightarrow{OC}) = r^2å±•å¼€ï¼š t^2|\overrightarrow{OD}|^2 + 2 t\overrightarrow{OD}\cdot\overrightarrow{OC} + |\overrightarrow{OC}|^2 -r^2 = 0ä»¤ k_1 = |\overrightarrow{OD}|^2 â€‹ k_2 = 2 \overrightarrow{OD}\cdot\overrightarrow{OC}â€‹ k_3 = |\overrightarrow{OC}|^2 -r^2è¿™å°±å˜æˆè§£å…³äºtçš„ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ï¼š {t_1, t_2} = \begin{equation} \frac{ -k_2 \pm \sqrt{k_2^2 - 4k_1k_3} } {2k_1} \end{equation}ä¼šå‡ºç°ï¼š $k_2^2 - 4k_1k_3 &gt; 0$ ï¼š ä¸¤ä¸ªè§£ $k_2^2 - 4k_1k_3 = 0$ ï¼š ä¸€ä¸ªè§£ $k_2^2 - 4k_1k_3 &lt; 0$ ï¼š æ— è§£ å¯¹åº”çš„å°±æ˜¯ä¸‹å›¾çš„çŠ¶å†µï¼š æ‰€ä»¥é—®é¢˜å°±å˜ç®€å•äº†ï¼Œå¦‚æœæˆ‘ä»¬æœ‰äº¤äº’ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å±•ç¤ºçš„æ˜¯è¿‘çš„ç‚¹$t_1$çš„é¢œè‰²ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰äº¤äº’ï¼Œé‚£ä¹ˆæˆ‘ä»¬å±•ç¤ºçš„å°±æ˜¯èƒŒæ™¯è‰²ã€‚ ä»¥ä¸Šå°±æ˜¯å…‰çº¿è¿½è¸ªçš„æ ¹æœ¬åŸç†ã€‚ è‡³æ­¤ã®ä¼ªç è·Ÿè¸ªå…‰çº¿ä¸çƒç›¸äº¤ IntersectRaySphere1234567891011121314151617IntersectRaySphere(O, D, sphere)&#123; C = sphere.center r = sphere.radius oc = O - C k1 = dot(OD, OD) k2 = 2 * dot(OC, OD) k3 = dot(OC,OC) - r*r discriminant = k2 * k2 - 4 * k1 * k3 if discriminant &lt; 0: return inf, inf t1 = (-k2 + sqrt(discriminant))/(2*k1) t2 = (-k2 - sqrt(discriminant))/(2*k1) return t1, t2&#125; t1 çš„é¢œè‰²TraceRayè¿™é‡Œæˆ‘ä»¬åœ¨ç©ºé—´é‡Œæ”¾å…¥å¥½å‡ ä¸ªçƒä½“ï¼Œç„¶åè®¡ç®—t1å¤„çš„é¢œè‰²ä¼ªç å¦‚ä¸‹ï¼š 123456789101112131415161718TraceRay(O, D, t_min, t_max)&#123; closest_t = inf closest_sphere = NULL for sphere in scene.Spheres &#123; t1, t2 = IntersectRaySphere(O, D, sphere) if t1 in [t_min, t_max] &amp;&amp; t1 &lt; closest_t closest_t = t1 closest_sphere = sphere if t2 in [t_min, t_max] &amp;&amp; t2 &lt; closest_t closest_t = t2 closest_sphere = sphere &#125; if closest_sphere == NULL return BACKGROUND_COLOR return closest_sphere.color &#125; æˆ‘ä»¬åœ¨ç©ºé—´ä¸­æ”¾å…¥ä¸‰ä¸ªå°çƒï¼š ç”»åˆ°ç”»å¸ƒä¸Šåœ¨ä¸Šè¿°ä¸‰ä¸ªä¼ªç å‡½æ•°ä¸­ï¼Œæœ€ç»ˆæ˜¯TraceRayè¿™ä¸ªå‡½æ•°è°ƒç”¨äº†å…¶ä½™ä¸¤ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç°åœ¨éœ€è¦æ¥è®¾å®šå®ƒçš„å‚æ•°ã€‚ DDè¿™ä¸ªå®é™…ä¸Šä¹‹å‰å·²ç»å†™åˆ°ï¼Œå°±æ˜¯ä»Oåˆ°Vçš„å‘é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„Våˆç”±æœ€æ—©çš„ç”»å¸ƒåˆ°çª—æˆ·å¯ä»¥å¾—çŸ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æœ‰å‡½æ•°ï¼š 123CanvasToViewport(x, y)&#123; return (x * Vw/Cw, y * Vh/Ch, d)&#125; t_min, t_maxt = 1 æ˜¯Vï¼Œæ˜¯åœ¨çª—æˆ·ä¸Šï¼Œt &gt; 1 æ˜¯çª—æˆ·ä¹‹åï¼Œæ˜¯åœºæ™¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å–çš„å€¼æ˜¯ t_min = 1,æˆ‘ä»¬å¹¶ä¸éœ€è¦æ‘„åƒå¤´å’Œçª—æˆ·ä¹‹é—´çš„é¢œè‰²ï¼Œå› ä¸ºæˆ‘ä»¬ä¹Ÿæ²¡æœ‰æ”¾ä»»ä½•ä¸œè¥¿åœ¨é‚£é‡Œï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯çª—æˆ·ä¹‹åçš„æ™¯è‰²ï¼Œæ‰€ä»¥ t_min = 1, t_max = inf ç»„è£…æœ€åï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯æ¥åšå¾ªç¯ï¼ŒæŠŠæ‰€æœ‰çš„ä»£ç ç»„è£…åœ¨ä¸€èµ·ï¼Œæ”¾åœ¨å±å¹•ä¸Šï¼Œæ‰€ä»¥ä¼ªç å¦‚ä¸‹ï¼š 123456789O = &lt;0,0,0&gt;for x in [-Cw/2, Cw/2]&#123; for y in [-Ch/2, Ch/2]&#123; D = CanvasToViewport(x, y) color = TraceRay(O, D, t_min, t_max) canvas.putPixel(x, y, color) &#125;&#125; å¯¹åº”çš„çª—æˆ·å¤§å°å’Œè·ç¦»éƒ½å¯ä»¥åœ¨ä»£ç ä¸­çœ‹åˆ°ï¼Œçœ‹ç»“æœï¼š è¿™æ ¹æœ¬çœ‹èµ·æ¥ä¸3dï¼Œå¾ˆç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬å¹¶æ²¡æœ‰è€ƒè™‘å…‰çš„ä½œç”¨ã€‚ ä»£ç é“¾æ¥]]></content>
      <categories>
        <category>è®¡ç®—æœºå›¾å½¢å­¦</category>
      </categories>
      <tags>
        <tag>è®¡ç®—æœºå›¾å½¢å­¦</tag>
        <tag>å…‰æ …</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[500è¡Œä»£ç å­¦æ‡‚OpenGLä¹‹äºŒç”»çº¿]]></title>
    <url>%2F2019%2F05%2F27%2Fopengldrawline%2F</url>
    <content type="text"><![CDATA[ç”»çº¿ç”»å®Œäº†ç‚¹ï¼Œæˆ‘ä»¬æ¥å¼€å§‹ç”»çº¿ã€‚ç”»çº¿çš„åŒæ—¶æˆ‘ä»¬ä¾æ—§è¦è®°å¾—ï¼Œæˆ‘ä»¬æ˜¯ç”»åœ¨ä¸€ä¸ªä¸€ä¸ªæ•´æ•°çš„pixelä¸Šã€‚ å°è¯•ä¸€ï¼š æŒ‰ç…§å‚æ•°ç»˜åˆ¶ç›´çº¿1234567void line(int x0, int y0, int x1, int y1, TGAImage &amp;image, TGAColor color) &#123; for (float t=0.; t&lt;1.; t+=.01) &#123; int x = x0 + (x1-x0)*t; int y = y0 + (y1-y0)*t; image.set(x, y, color); &#125; &#125; è¿™é‡Œçš„é—®é¢˜æœ‰ä¸¤ä¸ªï¼š æ•ˆç‡ä½ tå¦‚ä½•æ§åˆ¶ tå–å¤§äº†ç”»å‡ºæ¥çš„å¹¶ä¸æ˜¯çº¿ï¼Œè€Œæ˜¯ä¸€å †ç‚¹ã€‚tå–å°äº†ä¼šæµªè´¹ï¼Œæœ‰å¾ˆå¤šé‡å¤çš„xå’Œyã€‚ å°è¯•äºŒï¼š æŒ‰xçš„å¢åŠ ç”»çº¿1234567void line(int x0, int y0, int x1, int y1, TGAImage &amp;image, TGAColor color) &#123; for (int x=x0; x&lt;=x1; x++) &#123; float t = (x-x0)/(float)(x1-x0); int y = y0 + (y1 - y0)*t; image.set(x, y, color); &#125; &#125; æˆ‘ä»¬æƒ³ç€è¦èŠ‚çº¦ï¼Œå°±æ¯æ¬¡ x å¢åŠ 1ï¼Œç„¶åæ¥ç”»yã€‚ è¿™æ ·ç”»çº¿æ˜¯å¯¹çš„å› ä¸ºæˆ‘ä»¬å‡è®¾ $y = mx + b $, ç›´çº¿æ–œç‡mï¼Œ æˆªè·b \frac{y_1 - y_0}{x_1 - x_0} = m y_0 = mx_0 + b y = y_0 + \frac{y_1 - y_0}{x_1 - x_0}(x - x_0)æ‰€ä»¥ y = y_0 + mx - mx_0 = mx + (y_0 - mx_0) = mx + båŒæ—¶å®ƒçš„é—®é¢˜æ˜¯æˆ‘ä»¬ä¹Ÿå·²ç»æŒ‡å‡º: å¦‚æœç›´çº¿æ–œç‡å¤ªå¤§ï¼Œæ¯”å¦‚ m = 3, é‚£ä¹ˆxæ¯å¢åŠ 1ä¸ªåƒç´ ï¼Œyå¢åŠ 3ä¸ªåƒç´ ï¼Œè¿™æ ·ç”»å‡ºæ¥å°±æ˜¯åˆ†ç¦»çš„ç‚¹ã€‚ åªèƒ½é€‚ç”¨äº x0 &lt; x1çš„çŠ¶å†µ å°è¯•ä¸‰æ‰€ä»¥æƒ³æ³•æ˜¯ï¼š å¦‚æœ‰å¿…è¦äº¤æ¢ x0 å’Œ x1ï¼Œè¿™æ ·ä½¿å¾— x0 ä¸€å®šå°äº x1 å¦‚æœæ–œç‡æ¯”è¾ƒå¤§ï¼Œåˆ™äº¤æ¢ x å’Œ y çœ‹ä»£ç ï¼š 123456789101112131415161718192021void line(int x0, int y0, int x1, int y1, TGAImage &amp;image, TGAColor color) &#123; bool steep = false; if (std::abs(x0-x1)&lt;std::abs(y0-y1)) &#123; // if the line is steep, we transpose the image std::swap(x0, y0); std::swap(x1, y1); steep = true; &#125; if (x0&gt;x1) &#123; // make it leftâˆ’toâˆ’right std::swap(x0, x1); std::swap(y0, y1); &#125; for (int x=x0; x&lt;=x1; x++) &#123; float t = (x-x0)/(float)(x1-x0); int y = y0 + (y1 - y0)*t; if (steep) &#123; image.set(y, x, color); // if transposed, deâˆ’transpose &#125; else &#123; image.set(x, y, color); &#125; &#125; &#125; è¿™æ ·å°±å¯ä»¥å®Œå–„ä¸Šè¿°å‡ºç°çš„é—®é¢˜æ¥ç”»çº¿äº†ã€‚ è¿™é‡Œå…¶å®è¿˜æ˜¯æœ‰ä¸€äº›å¯ä»¥è¿›æ­¥çš„ç©ºé—´ï¼Œæ¯”å¦‚å‡ºç°äº†æµ®ç‚¹æ•°tï¼ŒåŒæ—¶ä¹Ÿä¾æ—§æˆ‘ä»¬ä¹‹å‰è¯´çš„æˆ‘ä»¬åªéœ€è¦ç”»åœ¨æ•´æ•°ä¸Šã€‚å¯ä»¥å‚è§ï¼š å†è°ˆç»˜åˆ¶ç›´çº¿ä¸­çš„ä¼˜åŒ–éƒ¨åˆ†ã€‚ ä¸è¿‡æˆ‘ä»¬ç”»çº¿å°±æš‚æ—¶åœåœ¨è¿™é‡Œã€‚æˆ‘ä»¬å°±ç”¨è¿™ä¸ªå‡½æ•°æ¥ç”»äº†ï¼Œå› ä¸ºcompilerçš„ä¼˜åŒ–å·²ç»è¶³å¤Ÿå¥½äº†ã€‚ wavefront objä¹‹å‰æˆ‘ä»¬å·²ç»ç”¨è¿‡è¿™ä¸ªæ–‡ä»¶ï¼Œä¸Šæ¬¡æˆ‘ä»¬è®¤è¯†äº†v ä»£è¡¨é¡¶ç‚¹ï¼ˆvertex),è¿™æ¬¡æˆ‘ä»¬æ¥å¤šè®¤è¯†ä¸€ä¸ªf ä»£è¡¨é¢ï¼ˆface)ï¼Œå®é™…ä¸Šæ˜¯ä¸‰è§’å½¢é¢ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æˆ‘ä»¬çš„ä¸€è¡Œfæœ‰ï¼š 1f 1193/1240/1193 1180/1227/1180 1179/1226/1179 æˆ‘ä»¬ç°åœ¨åªéœ€è¦çŸ¥é“æ¯ç»„çš„ç¬¬ä¸€ä¸ªæ•°å­—ï¼š 1193,1180,1179 æ˜¯ä»£è¡¨vertex listä¸­çš„ä¸‰ä¸ªé¡¶ç‚¹çš„ç´¢å¼•ï¼ˆindexï¼‰ï¼Œè¿™ä¸‰ä¸ªé¡¶ç‚¹æ„æˆä¸€ä¸ªä¸‰è§’å½¢ã€‚ æ‰€ä»¥è¿›ä¸€æ­¥ä¿®æ”¹model parserï¼Œæˆ‘ä»¬æ¥ç”¨è¿™ä¸ªç”»å‡ºçº¿æ¡†ï¼Œæ ¸å¿ƒä»£ç é•¿è¿™æ ·ï¼š 1234567891011121314for (int i = 0; i &lt; model-&gt;nfaces(); i++) &#123; std::vector&lt;int&gt; face = model-&gt;face(i); // face: i0,i1,i2 of triangle for (int j = 0; j &lt; 3; j++) &#123; Vec3f v0 = model-&gt;vert(face[j]); // this % used for when j = 2 to get i2, i0 Vec3f v1 = model-&gt;vert(face[(j+1)%3]); int x0 = (v0.x+1.)*width/2.; int y0 = (v0.y+1.)*height/2.; int x1 = (v1.x+1.)*width/2.; int y1 = (v1.y+1.)*height/2.; line(x0, y0, x1, y1, image, white); &#125;&#125; ä»£ç ]]></content>
      <categories>
        <category>OpenGL</category>
      </categories>
      <tags>
        <tag>è®¡ç®—æœºå›¾å½¢å­¦</tag>
        <tag>å…‰æ …</tag>
        <tag>OpenGL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CMakeLists]]></title>
    <url>%2F2019%2F05%2F26%2Fcmakefile%2F</url>
    <content type="text"><![CDATA[123456789101112131415#1.cmake verson,æŒ‡å®šcmakeç‰ˆæœ¬cmake_minimum_required (VERSION 2.6)#2.æŒ‡å®šé¡¹ç›®åç§°ï¼Œä¸€èˆ¬å’Œé¡¹ç›®çš„æ–‡ä»¶å¤¹åå¯¹åº”project (Tutorial)#3.å¤´æ–‡ä»¶ç›®å½•INCLUDE_DIRECTORIES( ./)#4.æºæ–‡ä»¶ç›®å½•SET(SOURCE_FILES ./main.cpp./tgaimage.cpp)SET(EXECUTABLE_OUTPUT_PATH $&#123;PROJECT_SOURCE_DIR&#125;/../bin) #è®¾ç½®å¯æ‰§è¡Œæ–‡ä»¶çš„è¾“å‡ºç›®å½•ADD_EXECUTABLE("Prepare" $&#123;SOURCE_FILES&#125;)]]></content>
      <categories>
        <category>CMakeFile</category>
      </categories>
      <tags>
        <tag>CMakeFile</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[500è¡Œä»£ç å­¦æ‡‚OpenGLä¹‹ä¸€ç”»ç‚¹]]></title>
    <url>%2F2019%2F05%2F26%2Fopengldrawpoint%2F</url>
    <content type="text"><![CDATA[é¡¹ç›®æ¥è‡ªhttps://github.com/ssloy/tinyrendererï¼Œä½œè€…å°è¯•ç”¨500è¡Œä»£ç æ¥å†™ä¸€ä¸ªtiny renderï¼Œè®©æˆ‘ä»¬æ˜ç™½OpenGLæ˜¯æ€æ ·å·¥ä½œçš„ã€‚ ä»ç”»ç‚¹å¼€å§‹TGAImageç”Ÿæˆå›¾åƒæˆ‘ä»¬ä½¿ç”¨TGAImageï¼Œè¿™ä¸ªä½¿ç”¨èµ·æ¥å¾ˆç®€å•ï¼š12345678910111213#include "tgaimage.h"const TGAColor white = TGAColor(255,255,255,255);const TGAColor red = TGAColor(255,0,0,255);int main(int argc, char ** argv)&#123; TGAImage image(100,100,TGAImage::RGB); image.set(52,41,red); image.filp_vertically(); image.write_tga_file("output.tga"); return 0;&#125; é¡¹ç›®:https://github.com/zentia/tinyrender.git wavefront objç„¶åæˆ‘ä»¬æ¥å­¦ä¹ ä¸€ç§3dæ ¼å¼æ–‡ä»¶ï¼Œwavefront obj file:12345678910111213141516171819202122232425# List of geometric vertices, with (x, y, z [,w]) coordinates, w is optional and defaults to 1.0. v 0.123 0.234 0.345 1.0 v ... ... # List of texture coordinates, in (u, [v ,w]) coordinates, these will vary between 0 and 1, v and w are optional and default to 0. vt 0.500 1 [0] vt ... ... # List of vertex normals in (x,y,z) form; normals might not be unit vectors. vn 0.707 0.000 0.707 vn ... ... # Parameter space vertices in ( u [,v] [,w] ) form; free form geometry statement ( see below ) vp 0.310000 3.210000 2.100000 vp ... ... # Polygonal face element (see below) f 1 2 3 f 3/1 4/2 5/3 f 6/4/1 3/5/3 7/6/5 f 7//1 8//2 9//3 f ... ... # Line element (see below) l 5 8 1 2 4 9 æˆ‘ä»¬ç°åœ¨åªéœ€è¦çŸ¥é“é¡¶ç‚¹æ˜¯vï¼Œç°åœ¨æˆ‘ä»¬æƒ³æŠŠä¸€ä¸ªæ–‡ä»¶ä¸­çš„3dæ¨¡å‹çš„é¡¶ç‚¹v(x,y,z)ç»™ç”»å‡ºæ¥ï¼Œ(å› ä¸ºæˆ‘ä»¬å·²ç»çŸ¥é“æ€ä¹ˆåœ¨å›¾ä¸Šç›¸åº”çš„ä½ç½®æ”¾åƒç´ )è¿™ä¸ªæ–‡ä»¶æ‰€æœ‰çš„x,y,zâˆˆ[-1,1]ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠå®ƒä»¬æ˜ å°„åˆ°åˆé€‚èŒƒå›´ï¼Œç„¶åæ³¨æ„æˆ‘ä»¬ç”»çš„ç‚¹ image.set(52,41,red); ï¼Œè¿™é‡Œçš„æ˜¯52å’Œ41æ˜¯intï¼Œæ˜ å°„ä¹‹åéœ€è¦è½¬æˆintï¼Œå› ä¸ºæˆ‘ä»¬æ€»æ˜¯ç”»åœ¨ä¸€ä¸ªä¸€ä¸ªåƒç´ ç‚¹ä¸Šã€‚å†™ä¸€ä¸ªç®€å•çš„parserè¯»å…¥æ–‡ä»¶å»ºç«‹æ¨¡å‹ã€‚æ ¸å¿ƒéƒ¨åˆ†é•¿è¿™æ ·ï¼š123456for (int i = 0; i != model-&gt;nverts();i++)&#123; Vec3f v = model-&gt;vert(i); Vec2i p = world2screen(v); image.set(p.x,p.y,white);&#125;]]></content>
      <categories>
        <category>OpenGL</category>
      </categories>
      <tags>
        <tag>è®¡ç®—æœºå›¾å½¢å­¦</tag>
        <tag>å…‰æ …</tag>
        <tag>OpenGL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[C#è¿ç®—ç¬¦ä¼˜å…ˆçº§]]></title>
    <url>%2F2019%2F05%2F24%2Fcsharp-precedence-of-operator%2F</url>
    <content type="text"><![CDATA[ä¼˜å…ˆçº§è¿ç®—ç¬¦ä½¿ç”¨å½¢å¼ç»“åˆæ–¹å‘ 1[]æ•°ç»„å[æ•´å½¢è¡¨è¾¾å¼]å·¦åˆ°å³ () . -> 2--è¡¨è¾¾å¼å³åˆ°å·¦ (ç±»å‹) ++ -- **æŒ‡é’ˆè¡¨è¾¾å¼ 6--è¡¨è¾¾å¼å·¦åˆ°å³ > >=]]></content>
      <categories>
        <category>CSharp</category>
      </categories>
      <tags>
        <tag>CSharp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Luaå‚è€ƒæ‰‹å†Œä¸‹åŠéƒ¨åˆ†]]></title>
    <url>%2F2019%2F05%2F24%2Fluarefermanual%2F</url>
    <content type="text"><![CDATA[å½“å‰å¤§éƒ¨åˆ†æ¥æºæ˜¯5.1çš„æ ‡å‡† lua_Readertypedef const char * (*lua_Reader) (lua_State *L, void *data, size_t *size); lua_load ç”¨åˆ°çš„è¯»å–å™¨å‡½æ•°ï¼Œ æ¯æ¬¡å®ƒéœ€è¦ä¸€å—æ–°çš„ chunk çš„æ—¶å€™ï¼Œ lua_load å°±è°ƒç”¨è¯»å–å™¨ï¼Œ æ¯æ¬¡éƒ½ä¼šä¼ å…¥ä¸€ä¸ªå‚æ•° data ã€‚ è¯»å–å™¨éœ€è¦è¿”å›å«æœ‰æ–°çš„ chunk çš„ä¸€å—å†…å­˜çš„æŒ‡é’ˆï¼Œ å¹¶æŠŠ size è®¾ä¸ºè¿™å—å†…å­˜çš„å¤§å°ã€‚ å†…å­˜å—å¿…é¡»åœ¨ä¸‹ä¸€æ¬¡å‡½æ•°è¢«è°ƒç”¨ä¹‹å‰ä¸€ç›´å­˜åœ¨ã€‚ è¯»å–å™¨å¯ä»¥é€šè¿‡è¿”å›ä¸€ä¸ª NULL æ¥æŒ‡ç¤º chunk ç»“æŸã€‚ è¯»å–å™¨å¯èƒ½è¿”å›å¤šä¸ªå—ï¼Œæ¯ä¸ªå—å¯ä»¥æœ‰ä»»æ„çš„å¤§äºé›¶çš„å°ºå¯¸ã€‚ lua_registervoid lua_register (lua_State *L, const char *name, lua_CFunction f); æŠŠ C å‡½æ•° f è®¾åˆ°å…¨å±€å˜é‡ name ä¸­ã€‚ å®ƒé€šè¿‡ä¸€ä¸ªå®å®šä¹‰ï¼š #define lua_register(L,n,f) \ (lua_pushcfunction(L, f), lua_setglobal(L, n)) lua_removevoid lua_remove (lua_State *L, int index); ä»ç»™å®šæœ‰æ•ˆç´¢å¼•å¤„ç§»é™¤ä¸€ä¸ªå…ƒç´ ï¼Œ æŠŠè¿™ä¸ªç´¢å¼•ä¹‹ä¸Šçš„æ‰€æœ‰å…ƒç´ ç§»ä¸‹æ¥å¡«è¡¥ä¸Šè¿™ä¸ªç©ºéš™ã€‚ ä¸èƒ½ç”¨ä¼ªç´¢å¼•æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œ å› ä¸ºä¼ªç´¢å¼•å¹¶ä¸æŒ‡å‘çœŸå®çš„æ ˆä¸Šçš„ä½ç½®ã€‚ lua_replacevoid lua_replace (lua_State *L, int index); æŠŠæ ˆé¡¶å…ƒç´ ç§»åŠ¨åˆ°ç»™å®šä½ç½®ï¼ˆå¹¶ä¸”æŠŠè¿™ä¸ªæ ˆé¡¶å…ƒç´ å¼¹å‡ºï¼‰ï¼Œ ä¸ç§»åŠ¨ä»»ä½•å…ƒç´ ï¼ˆå› æ­¤åœ¨é‚£ä¸ªä½ç½®å¤„çš„å€¼è¢«è¦†ç›–æ‰ï¼‰ã€‚ lua_resumeint lua_resume (lua_State *L, int narg); åœ¨ç»™å®šçº¿ç¨‹ä¸­å¯åŠ¨æˆ–ç»§ç»­ä¸€ä¸ª coroutine ã€‚è¦å¯åŠ¨ä¸€ä¸ª coroutine çš„è¯ï¼Œé¦–å…ˆä½ è¦åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹ ï¼ˆå‚è§ lua_newthread ï¼‰ï¼› ç„¶åæŠŠä¸»å‡½æ•°å’Œè‹¥å¹²å‚æ•°å‹åˆ°æ–°çº¿ç¨‹çš„å †æ ˆä¸Šï¼› æœ€åè°ƒç”¨ lua_resume ï¼Œ æŠŠ narg è®¾ä¸ºå‚æ•°çš„ä¸ªæ•°ã€‚ è¿™æ¬¡è°ƒç”¨ä¼šåœ¨ coroutine æŒ‚èµ·æ—¶æˆ–æ˜¯ç»“æŸè¿è¡Œåè¿”å›ã€‚ å½“å‡½æ•°è¿”å›æ—¶ï¼Œå †æ ˆä¸­ä¼šæœ‰ä¼ ç»™ lua_yield çš„æ‰€æœ‰å€¼ï¼Œ æˆ–æ˜¯ä¸»å‡½æ•°çš„æ‰€æœ‰è¿”å›å€¼ã€‚ å¦‚æœ coroutine åˆ‡æ¢æ—¶ï¼Œlua_resume è¿”å› LUA_YIELD ï¼Œ è€Œå½“ coroutine ç»“æŸè¿è¡Œä¸”æ²¡æœ‰ä»»ä½•é”™è¯¯æ—¶ï¼Œè¿”å› 0 ã€‚ å¦‚æœæœ‰é”™åˆ™è¿”å›é”™è¯¯ä»£ç ï¼ˆå‚è§ lua_pcallï¼‰ã€‚ åœ¨å‘ç”Ÿé”™è¯¯çš„æƒ…å†µä¸‹ï¼Œ å †æ ˆæ²¡æœ‰å±•å¼€ï¼Œ å› æ­¤ä½ å¯ä»¥ä½¿ç”¨ debug API æ¥å¤„ç†å®ƒã€‚ å‡ºé”™ä¿¡æ¯æ”¾åœ¨æ ˆé¡¶ã€‚ è¦ç»§ç»­è¿è¡Œä¸€ä¸ª coroutine çš„è¯ï¼Œä½ æŠŠéœ€è¦ä¼ ç»™ yield ä½œç»“æœçš„è¿”å›å€¼å‹å…¥å †æ ˆï¼Œç„¶åè°ƒç”¨ lua_resume ã€‚ lua_setallocfvoid lua_setallocf (lua_State *L, lua_Alloc f, void *ud); æŠŠæŒ‡å®šçŠ¶æ€æœºçš„åˆ†é…å™¨å‡½æ•°æ¢æˆå¸¦ä¸ŠæŒ‡é’ˆ ud çš„ f ã€‚ lua_setfenvint lua_setfenv (lua_State *L, int index); ä»å †æ ˆä¸Šå¼¹å‡ºä¸€ä¸ª table å¹¶æŠŠå®ƒè®¾ä¸ºæŒ‡å®šç´¢å¼•å¤„å€¼çš„æ–°ç¯å¢ƒã€‚ å¦‚æœæŒ‡å®šç´¢å¼•å¤„çš„å€¼å³ä¸æ˜¯å‡½æ•°åˆä¸æ˜¯çº¿ç¨‹æˆ–æ˜¯ userdata ï¼Œ lua_setfenv ä¼šè¿”å› 0 ï¼Œ å¦åˆ™è¿”å› 1 ã€‚ lua_setfieldvoid lua_setfield(lua_State *L, int index, const char *k); ç­‰ä»·äºt[k] = vçš„æ“ä½œï¼Œè¿™é‡Œtæ˜¯ç»™å‡ºçš„æœ‰æ•ˆç´¢å¼•indexå¤„çš„å€¼ï¼Œè€Œvæ˜¯æ ˆé¡¶çš„é‚£ä¸ªå€¼ã€‚è¿™ä¸ªå‡½æ•°å°†æŠŠè¿™ä¸ªå€¼å¼¹å‡ºå †æ ˆã€‚ è·Ÿåœ¨Luaä¸­ä¸€æ ·ï¼Œè¿™ä¸ªå‡½æ•°å¯èƒ½è§¦å‘ä¸€ä¸ªnewindexäº‹ä»¶çš„å…ƒæ–¹æ³•ã€‚ lua_setglobalvoid lua_setglobal (lua_State *L, const char *name); ä»å †æ ˆä¸Šå¼¹å‡ºä¸€ä¸ªå€¼ï¼Œå¹¶å°†å…¶è®¾åˆ°å…¨å±€å˜é‡ name ä¸­ã€‚ å®ƒç”±ä¸€ä¸ªå®å®šä¹‰å‡ºæ¥ï¼š #define lua_setglobal(L,s) lua_setfield(L, LUA_GLOBALSINDEX, s) lua_setmetatableint lua_setmetatable (lua_State *L, int index); æŠŠä¸€ä¸ª table å¼¹å‡ºå †æ ˆï¼Œå¹¶å°†å…¶è®¾ä¸ºç»™å®šç´¢å¼•å¤„çš„å€¼çš„ metatable ã€‚ lua_settablevoid lua_settable(lua_State *L, int index); ä½œä¸€ä¸ªç­‰ä»·äº t[k] = vçš„æ“ä½œï¼Œè¿™é‡Œtæ˜¯ä¸€ä¸ªç»™å®šæœ‰æ•ˆç´¢å¼• index å¤„çš„å€¼ï¼Œ v æŒ‡æ ˆé¡¶çš„å€¼ï¼Œ è€Œ k æ˜¯æ ˆé¡¶ä¹‹ä¸‹çš„é‚£ä¸ªå€¼ã€‚è¿™ä¸ªå‡½æ•°ä¼šæŠŠé”®å’Œå€¼éƒ½ä»å †æ ˆä¸­å¼¹å‡ºã€‚ å’Œåœ¨ Lua ä¸­ä¸€æ ·ï¼Œè¿™ä¸ªå‡½æ•°å¯èƒ½è§¦å‘ â€œnewindexâ€ äº‹ä»¶çš„å…ƒæ–¹æ³•ã€‚ lua_settopvoid lua_settop(lua_State *L, int index); å‚æ•°å…è®¸ä¼ å…¥ä»»ä½•å¯æ¥å—çš„ç´¢å¼•ä»¥åŠ0ã€‚å®ƒå°†æŠŠå †æ ˆçš„æ ˆé¡¶è®¾ä¸ºè¿™ä¸ªç´¢å¼•ã€‚å¦‚æœæ–°çš„æ ˆé¡¶æ¯”åŸæ¥çš„å¤§ï¼Œè¶…å‡ºéƒ¨åˆ†çš„æ–°å…ƒç´ å°†è¢«å¡«ä¸ºnilã€‚å¦‚æœindexä¸º0ï¼ŒæŠŠæ ˆä¸Šæ‰€æœ‰å…ƒç´ ç§»é™¤ã€‚ lua_Statetypedef struct lua_State lua_State;ä¸€ä¸ªä¸é€æ˜çš„ç»“æ„ï¼Œå®ƒä¿å­˜äº†æ•´ä¸ª Lua è§£é‡Šå™¨çš„çŠ¶æ€ã€‚ Lua åº“æ˜¯å®Œå…¨å¯é‡å…¥çš„ï¼š å®ƒæ²¡æœ‰ä»»ä½•å…¨å±€å˜é‡ã€‚ ï¼ˆè¯‘æ³¨ï¼šä» C è¯­æ³•ä¸Šæ¥è¯´ï¼Œä¹Ÿä¸å°½ç„¶ã€‚ä¾‹å¦‚ï¼Œåœ¨ table çš„å®ç°ä¸­ ç”¨äº†ä¸€ä¸ªé™æ€å…¨å±€å˜é‡ dummynode_ ï¼Œä½†è¿™åœ¨æ­£ç¡®ä½¿ç”¨æ—¶å¹¶ä¸å½±å“å¯é‡å…¥æ€§ã€‚ åªæ˜¯ä¸‡ä¸€ä½ é”™è¯¯é“¾æ¥äº† lua åº“ï¼Œä¸å°å¿ƒåœ¨åŒä¸€è¿›ç¨‹ç©ºé—´ä¸­å­˜åœ¨ä¸¤ä»½ lua åº“å®ç°çš„ä»£ç çš„è¯ï¼Œ å¤šä»½ dummynode_ ä¸åŒçš„åœ°å€ä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ã€‚ï¼‰ æ‰€æœ‰çš„ä¿¡æ¯éƒ½ä¿å­˜åœ¨è¿™ä¸ªç»“æ„ä¸­ã€‚ è¿™ä¸ªçŠ¶æ€æœºçš„æŒ‡é’ˆå¿…é¡»ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™æ¯ä¸€ä¸ªåº“å‡½æ•°ã€‚ lua_newstate æ˜¯ä¸€ä¸ªä¾‹å¤–ï¼Œ è¿™ä¸ªå‡½æ•°ä¼šä»å¤´åˆ›å»ºä¸€ä¸ª Lua çŠ¶æ€æœºã€‚ lua_statusint lua_status (lua_State *L); è¿”å›çº¿ç¨‹ L çš„çŠ¶æ€ã€‚æ­£å¸¸çš„çº¿ç¨‹çŠ¶æ€æ˜¯ 0 ã€‚ å½“çº¿ç¨‹æ‰§è¡Œå®Œæ¯•æˆ–å‘ç”Ÿä¸€ä¸ªé”™è¯¯æ—¶ï¼ŒçŠ¶æ€å€¼æ˜¯é”™è¯¯ç ã€‚ å¦‚æœçº¿ç¨‹è¢«æŒ‚èµ·ï¼ŒçŠ¶æ€ä¸º LUA_YIELD ã€‚ lua_tobooleanint lua_toboolean (lua_State *L, int index); æŠŠæŒ‡å®šçš„ç´¢å¼•å¤„çš„çš„Luaå€¼è½¬æ¢ä¸ºä¸€ä¸ªCä¸­çš„booleanå€¼ï¼ˆ0æˆ–æ˜¯1ï¼‰ã€‚å’ŒLuaä¸­åšçš„æ‰€æœ‰æµ‹è¯•ä¸€æ ·ï¼Œlua_tobooleanä¼šæŠŠä»»ä½•ä¸åŒäºfalseå’Œnilçš„å€¼å½“ä½œ1è¿”å›ï¼› å¦åˆ™å°±è¿”å›0ã€‚ å¦‚æœç”¨ä¸€ä¸ªæ— æ•ˆç´¢å¼•å»è°ƒç”¨ä¹Ÿä¼šè¿”å›0ã€‚ ï¼ˆå¦‚æœä½ æƒ³åªæ¥æ”¶çœŸæ­£çš„booleanå€¼ï¼Œå°±éœ€è¦ä½¿ç”¨lua_isbooleanæ¥æµ‹è¯•å€¼çš„ç±»å‹ã€‚ï¼‰ lua_tocfunctionlua_CFunction lua_tocfunction (lua_State *L, int index); æŠŠç»™å®šç´¢å¼•å¤„çš„ Lua å€¼è½¬æ¢ä¸ºä¸€ä¸ª C å‡½æ•°ã€‚ è¿™ä¸ªå€¼å¿…é¡»æ˜¯ä¸€ä¸ª C å‡½æ•°ï¼›å¦‚æœä¸æ˜¯å°±è¿”å› NULL ã€‚ lua_tointegerlua_Integer lua_tointeger (lua_State *L, int idx); æŠŠç»™å®šç´¢å¼•å¤„çš„ Lua å€¼è½¬æ¢ä¸º lua_Integer è¿™æ ·ä¸€ä¸ªæœ‰ç¬¦å·æ•´æ•°ç±»å‹ã€‚ è¿™ä¸ª Lua å€¼å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—æˆ–æ˜¯ä¸€ä¸ªå¯ä»¥è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸² ï¼ˆå‚è§ Â§2.2.1ï¼‰ï¼› å¦åˆ™ï¼Œlua_tointeger è¿”å› 0 ã€‚å¦‚æœæ•°å­—ä¸æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œ æˆªæ–­å°æ•°éƒ¨åˆ†çš„æ–¹å¼æ²¡æœ‰è¢«æ˜ç¡®å®šä¹‰ã€‚ lua_tolstringconst char *lua_tolstring (lua_State *L, int index, size_t *len); æŠŠç»™å®šç´¢å¼•å¤„çš„ Lua å€¼è½¬æ¢ä¸ºä¸€ä¸ª C å­—ç¬¦ä¸²ã€‚ å¦‚æœ len ä¸ä¸º NULL ï¼Œ å®ƒè¿˜æŠŠå­—ç¬¦ä¸²é•¿åº¦è®¾åˆ° *len ä¸­ã€‚ è¿™ä¸ª Lua å€¼å¿…é¡»æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–æ˜¯ä¸€ä¸ªæ•°å­—ï¼› å¦åˆ™è¿”å›è¿”å› NULL ã€‚ å¦‚æœå€¼æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œlua_tolstring è¿˜ä¼šæŠŠå †æ ˆä¸­çš„é‚£ä¸ªå€¼çš„å®é™…ç±»å‹è½¬æ¢ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ ï¼ˆå½“éå†ä¸€ä¸ªè¡¨çš„æ—¶å€™ï¼ŒæŠŠ lua_tolstring ä½œç”¨åœ¨é”®ä¸Šï¼Œè¿™ä¸ªè½¬æ¢æœ‰å¯èƒ½å¯¼è‡´ lua_next å¼„é”™ã€‚ï¼‰ lua_tolstring è¿”å› Lua çŠ¶æ€æœºä¸­ å­—ç¬¦ä¸²çš„ä»¥å¯¹é½æŒ‡é’ˆã€‚ è¿™ä¸ªå­—ç¬¦ä¸²æ€»èƒ½ä¿è¯ ï¼ˆ C è¦æ±‚çš„ï¼‰æœ€åä¸€ä¸ªå­—ç¬¦ä¸ºé›¶ (â€˜\0â€™) ï¼Œ è€Œä¸”å®ƒå…è®¸åœ¨å­—ç¬¦ä¸²å†…åŒ…å«å¤šä¸ªè¿™æ ·çš„é›¶ã€‚ å› ä¸º Lua ä¸­å¯èƒ½å‘ç”Ÿåƒåœ¾æ”¶é›†ï¼Œ æ‰€ä»¥ä¸ä¿è¯ lua_tolstring è¿”å›çš„æŒ‡é’ˆï¼Œ åœ¨å¯¹åº”çš„å€¼ä»å †æ ˆä¸­ç§»é™¤åä¾ç„¶æœ‰æ•ˆã€‚ lua_tonumberlua_Number lua_tonumber (lua_State *L, int index); æŠŠç»™å®šç´¢å¼•å¤„çš„ Lua å€¼è½¬æ¢ä¸º lua_Number è¿™æ ·ä¸€ä¸ª C ç±»å‹ï¼ˆå‚è§ lua_Number ï¼‰ã€‚ è¿™ä¸ª Lua å€¼å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—æˆ–æ˜¯ä¸€ä¸ªå¯è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸² ï¼ˆå‚è§ Â§2.2.1 ï¼‰ï¼› å¦åˆ™ï¼Œlua_tonumber è¿”å› 0 ã€‚ lua_topointerconst void *lua_topointer (lua_State *L, int index); æŠŠç»™å®šç´¢å¼•å¤„çš„å€¼è½¬æ¢ä¸ºä¸€èˆ¬çš„ C æŒ‡é’ˆ (void*) ã€‚ è¿™ä¸ªå€¼å¯ä»¥æ˜¯ä¸€ä¸ª userdata ï¼Œtable ï¼Œthread æˆ–æ˜¯ä¸€ä¸ª function ï¼› å¦åˆ™ï¼Œlua_topointer è¿”å› NULL ã€‚ ä¸åŒçš„å¯¹è±¡æœ‰ä¸åŒçš„æŒ‡é’ˆã€‚ ä¸å­˜åœ¨æŠŠæŒ‡é’ˆå†è½¬å›åŸæœ‰ç±»å‹çš„æ–¹æ³•ã€‚è¿™ä¸ªå‡½æ•°é€šå¸¸åªä¸ºäº§ç”Ÿ debug ä¿¡æ¯ç”¨ã€‚ lua_tostringconst char *lua_tostring (lua_State *L, int index); ç­‰ä»·äº lua_tolstring ï¼Œè€Œå‚æ•° len è®¾ä¸º NULL ã€‚ lua_tothreadlua_State *lua_tothread (lua_State *L, int index); æŠŠç»™å®šç´¢å¼•å¤„çš„å€¼è½¬æ¢ä¸ºä¸€ä¸ª Lua çº¿ç¨‹ï¼ˆç”± lua_State* ä»£è¡¨ï¼‰ã€‚ è¿™ä¸ªå€¼å¿…é¡»æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼›å¦åˆ™å‡½æ•°è¿”å› NULL ã€‚ lua_touserdatavoid *lua_touserdata (lua_State *L, int index); å¦‚æœç»™å®šç´¢å¼•å¤„çš„å€¼æ˜¯ä¸€ä¸ªå®Œæ•´çš„userdata ï¼Œå‡½æ•°è¿”å›å†…å­˜å—çš„åœ°å€ã€‚ å¦‚æœå€¼æ˜¯ä¸€ä¸ª light userdata ï¼Œé‚£ä¹ˆå°±è¿”å›å®ƒè¡¨ç¤ºçš„æŒ‡é’ˆã€‚ å¦åˆ™ï¼Œè¿”å› NULL ã€‚ lua_typeint lua_type (lua_State *L, int index); è¿”å›ç»™å®šç´¢å¼•å¤„çš„å€¼çš„ç±»å‹ï¼Œ å½“ç´¢å¼•æ— æ•ˆæ—¶åˆ™è¿”å› LUA_TNONE ï¼ˆé‚£æ˜¯æŒ‡ä¸€ä¸ªæŒ‡å‘å †æ ˆä¸Šçš„ç©ºä½ç½®çš„ç´¢å¼•ï¼‰ã€‚ lua_type è¿”å›çš„ç±»å‹æ˜¯ä¸€äº›ä¸ªåœ¨ lua.h ä¸­å®šä¹‰çš„å¸¸é‡ï¼š LUA_TNIL ï¼Œ LUA_TNUMBER ï¼Œ LUA_TBOOLEAN ï¼Œ LUA_TSTRING ï¼Œ LUA_TTABLE ï¼Œ LUA_TFUNCTION ï¼Œ LUA_TUSERDATA ï¼Œ LUA_TTHREAD ï¼Œ LUA_TLIGHTUSERDATA ã€‚ lua_typenameconst char *lua_typename (lua_State *L, int tp); è¿”å› tp è¡¨ç¤ºçš„ç±»å‹åï¼Œ è¿™ä¸ª tp å¿…é¡»æ˜¯ lua_type å¯èƒ½è¿”å›çš„å€¼ä¸­ä¹‹ä¸€ã€‚ lua_Writertypedef int (lua_Writer) (lua_State L, const void p, size_t sz, void ud); ç”± lua_dump ç”¨åˆ°çš„å†™å…¥å™¨å‡½æ•°ã€‚ æ¯æ¬¡ lua_dump äº§ç”Ÿäº†ä¸€å—æ–°çš„ chunk ï¼Œå®ƒéƒ½ä¼šè°ƒç”¨å†™å…¥å™¨ã€‚ ä¼ å…¥è¦å†™å…¥çš„ç¼“å­˜ (p) å’Œå®ƒçš„å°ºå¯¸ (sz) ï¼Œ è¿˜æœ‰ lua_dump çš„å‚æ•° data ã€‚å†™å…¥å™¨ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯ç ï¼š 0 è¡¨ç¤ºæ²¡æœ‰é”™è¯¯ï¼› åˆ«çš„å€¼å‡è¡¨ç¤ºä¸€ä¸ªé”™è¯¯ï¼Œå¹¶ä¸”ä¼šè®© lua_dump åœæ­¢å†æ¬¡è°ƒç”¨å†™å…¥å™¨ã€‚ lua_xmovevoid lua_xmove (lua_State *from, lua_State *to, int n); ä¼ é€’ åŒä¸€ä¸ª å…¨å±€çŠ¶æ€æœºä¸‹ä¸åŒçº¿ç¨‹ä¸­çš„å€¼ã€‚è¿™ä¸ªå‡½æ•°ä¼šä» from çš„å †æ ˆä¸­å¼¹å‡º n ä¸ªå€¼ï¼Œ ç„¶åæŠŠå®ƒä»¬å‹å…¥ to çš„å †æ ˆä¸­ã€‚ lua_yieldint lua_yield (lua_State *L, int nresults); åˆ‡å‡ºä¸€ä¸ª coroutine ã€‚è¿™ä¸ªå‡½æ•°åªèƒ½åœ¨ä¸€ä¸ª C å‡½æ•°çš„è¿”å›è¡¨è¾¾å¼ä¸­è°ƒç”¨ã€‚å¦‚ä¸‹ï¼š return lua_yield (L, nresults); å½“ä¸€ä¸ª C å‡½æ•°è¿™æ ·è°ƒç”¨ lua_yield ï¼Œ æ­£åœ¨è¿è¡Œä¸­çš„ coroutine å°†ä»è¿è¡Œä¸­æŒ‚èµ·ï¼Œ ç„¶åå¯åŠ¨è¿™ä¸ª coroutine ç”¨çš„é‚£æ¬¡å¯¹ lua_resume çš„è°ƒç”¨å°±è¿”å›äº†ã€‚ å‚æ•° nresults æŒ‡çš„æ˜¯å †æ ˆä¸­éœ€è¦è¿”å›çš„ç»“æœä¸ªæ•°ï¼Œè¿™äº›è¿”å›å€¼å°†è¢«ä¼ é€’ç»™ lua_resume ã€‚ 3.8 - è°ƒè¯•æ¥å£Lua æ²¡æœ‰å†…å»ºçš„è°ƒè¯•è®¾æ–½ã€‚ å–è€Œä»£ä¹‹çš„æ˜¯æä¾›äº†ä¸€äº›å‡½æ•°æ¥å£å’Œé’©å­ã€‚ åˆ©ç”¨è¿™äº›æ¥å£ï¼Œå¯ä»¥åšå‡ºä¸€äº›ä¸åŒç±»å‹çš„è°ƒè¯•å™¨ï¼Œ æ€§èƒ½åˆ†æå™¨ï¼Œæˆ–æ˜¯å…¶å®ƒä¸€äº›éœ€è¦ä»è§£é‡Šå™¨ä¸­å–åˆ°â€œå†…éƒ¨ä¿¡æ¯â€çš„å·¥å…·ã€‚ lua_Debugtypedef struct lua_Debug { int event; const char *name; /* (n) */ const char *namewhat; /* (n) */ const char *what; /* (S) */ const char *source; /* (S) */ int currentline; /* (l) */ int nups; /* (u) upvalue ä¸ªæ•° */ int linedefined; /* (S) */ int lastlinedefined; /* (S) */ char short_src[LUA_IDSIZE]; /* (S) */ /* ç§æœ‰éƒ¨åˆ† */ å…¶å®ƒåŸŸ } lua_Debug; ä¸€ä¸ªç”¨æ¥æºå¸¦æ´»åŠ¨ä¸­å‡½æ•°çš„å„ç§ä¿¡æ¯çš„ç»“æ„ã€‚ lua_getstack ä»…å¡«å†™è¿™ä¸ªç»“æ„ä¸­çš„ç§æœ‰éƒ¨åˆ†ï¼Œ è¿™äº›éƒ¨åˆ†ä»¥åä¼šç”¨åˆ°ã€‚ è°ƒç”¨ lua_getinfo åˆ™å¯ä»¥å¡«ä¸Š lua_Debug ä¸­æœ‰ç”¨ä¿¡æ¯çš„é‚£äº›åŸŸã€‚ lua_Debug ä¸­çš„å„ä¸ªåŸŸæœ‰ä¸‹åˆ—å«ä¹‰ï¼š source: å¦‚æœå‡½æ•°æ˜¯å®šä¹‰åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œsource å°±æ˜¯è¿™ä¸ªå­—ç¬¦ä¸²ã€‚ å¦‚æœå‡½æ•°å®šä¹‰åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œ source æ˜¯ä¸€ä¸ªä»¥ â€˜@â€™ å¼€å¤´çš„æ–‡ä»¶åã€‚short_src: ä¸€ä¸ªâ€œå¯æ‰“å°ç‰ˆæœ¬â€çš„ sourceï¼Œç”¨äºå‡ºé”™ä¿¡æ¯ã€‚linedefined: å‡½æ•°å®šä¹‰å¼€å§‹å¤„çš„è¡Œå·ã€‚lastlinedefined: å‡½æ•°å®šä¹‰ç»“æŸå¤„çš„è¡Œå·ã€‚what: å¦‚æœå‡½æ•°æ˜¯ä¸€ä¸ª Lua å‡½æ•°ï¼Œåˆ™ä¸ºä¸€ä¸ªå­—ç¬¦ä¸² â€œLuaâ€ ï¼› å¦‚æœæ˜¯ä¸€ä¸ª C å‡½æ•°ï¼Œåˆ™ä¸º â€œCâ€ï¼› å¦‚æœå®ƒæ˜¯ä¸€ä¸ª chunk çš„ä¸»ä½“éƒ¨åˆ†ï¼Œåˆ™ä¸º â€œmainâ€ï¼› å¦‚æœæ˜¯ä¸€ä¸ªä½œäº†å°¾è°ƒç”¨çš„å‡½æ•°ï¼Œåˆ™ä¸º â€œtailâ€ ã€‚ åˆ«çš„æƒ…å†µä¸‹ï¼ŒLua æ²¡æœ‰å…³äºå‡½æ•°çš„åˆ«çš„ä¿¡æ¯ã€‚currentline: ç»™å®šå‡½æ•°æ­£åœ¨æ‰§è¡Œçš„é‚£ä¸€è¡Œã€‚ å½“æä¾›ä¸äº†è¡Œå·ä¿¡æ¯çš„æ—¶å€™ï¼Œcurrentline è¢«è®¾ä¸º -1 ã€‚name: ç»™å®šå‡½æ•°çš„ä¸€ä¸ªåˆç†çš„åå­—ã€‚ å› ä¸º Lua ä¸­çš„å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå€¼ï¼Œ æ‰€ä»¥å®ƒä»¬æ²¡æœ‰å›ºå®šçš„åå­—ï¼š ä¸€äº›å‡½æ•°å¯èƒ½æ˜¯å…¨å±€å¤åˆå˜é‡çš„å€¼ï¼Œ å¦ä¸€äº›å¯èƒ½ä»…ä»…åªæ˜¯è¢«ä¿å­˜åœ¨ä¸€ä¸ª table ä¸­ã€‚ lua_getinfo å‡½æ•°ä¼šæ£€æŸ¥å‡½æ•°æ˜¯è¿™æ ·è¢«è°ƒç”¨çš„ï¼Œä»¥æ­¤æ¥æ‰¾åˆ°ä¸€ä¸ªé€‚åˆçš„åå­—ã€‚ å¦‚æœå®ƒæ‰¾ä¸åˆ°åå­—ï¼Œname å°±è¢«è®¾ç½®ä¸º NULL ã€‚namewhat: ç»“å® name åŸŸã€‚ namewhat çš„å€¼å¯ä»¥æ˜¯ â€œglobalâ€, â€œlocalâ€, â€œmethodâ€, â€œfieldâ€, â€œupvalueâ€, æˆ–æ˜¯ â€œâ€ ï¼ˆç©ºä¸²ï¼‰ã€‚ è¿™å–å†³äºå‡½æ•°æ€æ ·è¢«è°ƒç”¨ã€‚ ï¼ˆLua ç”¨ç©ºä¸²è¡¨ç¤ºå…¶å®ƒé€‰é¡¹éƒ½ä¸ç¬¦åˆï¼‰nups: å‡½æ•°çš„ upvalue çš„ä¸ªæ•°ã€‚ lua_gethooklua_Hook lua_gethook (lua_State *L); è¿”å›å½“å‰çš„é’©å­å‡½æ•°ã€‚ lua_gethookcountint lua_gethookcount (lua_State *L); è¿”å›å½“å‰é’©å­è®°æ•°ã€‚ lua_gethookmaskint lua_gethookmask (lua_State *L); è¿”å›å½“å‰çš„é’©å­æ©ç  (mask) ã€‚ lua_getinfoint lua_getinfo (lua_State *L, const char *what, lua_Debug *ar); è¿”å›ä¸€ä¸ªæŒ‡å®šçš„å‡½æ•°æˆ–å‡½æ•°è°ƒç”¨çš„ä¿¡æ¯ã€‚å½“ç”¨äºå–å¾—ä¸€æ¬¡å‡½æ•°è°ƒç”¨çš„ä¿¡æ¯æ—¶ï¼Œ å‚æ•° ar å¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ´»åŠ¨çš„è®°å½•ã€‚ è¿™æ¡è®°å½•å¯ä»¥æ˜¯å‰ä¸€æ¬¡è°ƒç”¨ lua_getstack å¾—åˆ°çš„ï¼Œ æˆ–æ˜¯ä¸€ä¸ªé’©å­ ï¼ˆå‚è§ lua_Hookï¼‰å¾—åˆ°çš„å‚æ•°ã€‚ç”¨äºè·å–ä¸€ä¸ªå‡½æ•°çš„ä¿¡æ¯æ—¶ï¼Œå¯ä»¥æŠŠè¿™ä¸ªå‡½æ•°å‹å…¥å †æ ˆï¼Œ ç„¶åæŠŠ what å­—ç¬¦ä¸²ä»¥å­—ç¬¦ â€˜&gt;â€™ èµ·å¤´ã€‚ ï¼ˆè¿™ä¸ªæƒ…å†µä¸‹ï¼Œlua_getinfo ä»æ ˆé¡¶ä¸Šå¼¹å‡ºå‡½æ•°ã€‚ï¼‰ ä¾‹å¦‚ï¼Œæƒ³çŸ¥é“å‡½æ•° f åœ¨å“ªä¸€è¡Œå®šä¹‰çš„ï¼Œ ä½ å¯ä»¥ä¸‹ä¸‹åˆ—ä»£ç ï¼š lua_Debug ar; lua_getfield(L, LUA_GLOBALSINDEX, &quot;f&quot;); /* å–åˆ°å…¨å±€å˜é‡ &#39;f&#39; */ lua_getinfo(L, &quot;&gt;S&quot;, &amp;ar); printf(&quot;%d\n&quot;, ar.linedefined); what å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦éƒ½ç­›é€‰å‡ºç»“æ„ ar ç»“æ„ä¸­ä¸€äº›åŸŸç”¨äºå¡«å……ï¼Œæˆ–æ˜¯æŠŠä¸€ä¸ªå€¼å‹å…¥å †æ ˆï¼š â€˜nâ€™: å¡«å…… name åŠ namewhat åŸŸï¼›â€˜Sâ€™: å¡«å…… sourceï¼Œ short_srcï¼Œ linedefinedï¼Œ lastlinedefinedï¼Œä»¥åŠ what åŸŸï¼›â€˜lâ€™: å¡«å…… currentline åŸŸï¼›â€˜uâ€™: å¡«å…… nups åŸŸï¼›â€˜fâ€™: æŠŠæ­£åœ¨è¿è¡Œä¸­æŒ‡å®šçº§åˆ«å¤„å‡½æ•°å‹å…¥å †æ ˆï¼› ï¼ˆè¯‘æ³¨ï¼šä¸€èˆ¬ç”¨äºè·å–å‡½æ•°è°ƒç”¨ä¸­çš„ä¿¡æ¯ï¼Œ çº§åˆ«æ˜¯ç”± ar ä¸­çš„ç§æœ‰éƒ¨åˆ†æ¥æä¾›ã€‚ å¦‚æœç”¨äºè·å–é™æ€å‡½æ•°ï¼Œé‚£ä¹ˆå°±ç›´æ¥æŠŠæŒ‡å®šå‡½æ•°é‡æ–°å‹å›å †æ ˆï¼Œ ä½†è¿™æ ·åšé€šå¸¸æ— ç”šæ„ä¹‰ã€‚ï¼‰â€˜Lâ€™: å‹ä¸€ä¸ª table å…¥æ ˆï¼Œè¿™ä¸ª table ä¸­çš„æ•´æ•°ç´¢å¼•ç”¨äºæè¿°å‡½æ•°ä¸­å“ªäº›è¡Œæ˜¯æœ‰æ•ˆè¡Œã€‚ ï¼ˆæœ‰æ•ˆè¡ŒæŒ‡æœ‰å®é™…ä»£ç çš„è¡Œï¼Œ å³ä½ å¯ä»¥ç½®å…¥æ–­ç‚¹çš„è¡Œã€‚ æ— æ•ˆè¡ŒåŒ…æ‹¬ç©ºè¡Œå’Œåªæœ‰æ³¨é‡Šçš„è¡Œã€‚ï¼‰è¿™ä¸ªå‡½æ•°å‡ºé”™ä¼šè¿”å› 0 ï¼ˆä¾‹å¦‚ï¼Œwhat ä¸­æœ‰ä¸€ä¸ªæ— æ•ˆé€‰é¡¹ï¼‰ã€‚ lua_getlocalconst char *lua_getlocal (lua_State *L, lua_Debug *ar, int n); ä»ç»™å®šæ´»åŠ¨è®°å½•ä¸­è·å–ä¸€ä¸ªå±€éƒ¨å˜é‡çš„ä¿¡æ¯ã€‚ å‚æ•° ar å¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ´»åŠ¨çš„è®°å½•ã€‚ è¿™æ¡è®°å½•å¯ä»¥æ˜¯å‰ä¸€æ¬¡è°ƒç”¨ lua_getstack å¾—åˆ°çš„ï¼Œ æˆ–æ˜¯ä¸€ä¸ªé’©å­ ï¼ˆå‚è§ lua_Hookï¼‰å¾—åˆ°çš„å‚æ•°ã€‚ ç´¢å¼• n ç”¨äºé€‰æ‹©è¦æ£€é˜…å“ªä¸ªå±€éƒ¨å˜é‡ ï¼ˆ 1 è¡¨ç¤ºç¬¬ä¸€ä¸ªå‚æ•°æˆ–æ˜¯æ¿€æ´»çš„ç¬¬ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æœ€åä¸€ä¸ªå±€éƒ¨å˜é‡ï¼‰ã€‚ lua_getlocal æŠŠå˜é‡çš„å€¼å‹å…¥å †æ ˆå¹¶è¿”å›å®ƒçš„åå­—ã€‚ä»¥ â€˜(â€˜ ï¼ˆæ­£å°æ‹¬å·ï¼‰å¼€å§‹çš„å˜é‡æŒ‡å†…éƒ¨å˜é‡ ï¼ˆå¾ªç¯æ§åˆ¶å˜é‡ï¼Œä¸´æ—¶å˜é‡ï¼ŒC å‡½æ•°å±€éƒ¨å˜é‡ï¼‰ã€‚å½“ç´¢å¼•å¤§äºå±€éƒ¨å˜é‡çš„ä¸ªæ•°æ—¶ï¼Œè¿”å› NULL ï¼ˆä»€ä¹ˆä¹Ÿä¸å‹å…¥ï¼‰ã€‚ lua_getstackint lua_getstack (lua_State *L, int level, lua_Debug *ar); è·å–è§£é‡Šå™¨çš„è¿è¡Œæ—¶æ ˆçš„ä¿¡æ¯ã€‚è¿™ä¸ªå‡½æ•°ç”¨æ­£åœ¨è¿è¡Œä¸­çš„ç»™å®šçº§åˆ«å¤„çš„å‡½æ•°çš„æ´»åŠ¨è®°å½•æ¥å¡«å†™ lua_Debug ç»“æ„çš„ä¸€éƒ¨åˆ†ã€‚ 0 çº§è¡¨ç¤ºå½“å‰è¿è¡Œçš„å‡½æ•°ï¼Œ è€Œ n+1 çº§å¤„çš„å‡½æ•°å°±æ˜¯è°ƒç”¨ç¬¬ n çº§å‡½æ•°çš„é‚£ä¸€ä¸ªã€‚ å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œlua_getstack è¿”å› 1 ï¼› å½“è°ƒç”¨ä¼ å…¥çš„çº§åˆ«å¤§äºå †æ ˆæ·±åº¦çš„æ—¶å€™ï¼Œè¿”å› 0 ã€‚ lua_getupvalueconst char *lua_getupvalue (lua_State *L, int funcindex, int n); è·å–ä¸€ä¸ª closure çš„ upvalue ä¿¡æ¯ã€‚ ï¼ˆå¯¹äº Lua å‡½æ•°ï¼Œupvalue æ˜¯å‡½æ•°éœ€è¦ä½¿ç”¨çš„å¤–éƒ¨å±€éƒ¨å˜é‡ï¼Œ å› æ­¤è¿™äº›å˜é‡è¢«åŒ…å«åœ¨ closure ä¸­ã€‚ï¼‰ lua_getupvalue è·å–ç¬¬ n ä¸ª upvalue ï¼Œ æŠŠè¿™ä¸ª upvalue çš„å€¼å‹å…¥å †æ ˆï¼Œå¹¶ä¸”è¿”å›å®ƒçš„åå­—ã€‚ funcindex æŒ‡å‘å †æ ˆä¸Š closure çš„ä½ç½®ã€‚ ï¼ˆ å› ä¸º upvalue åœ¨æ•´ä¸ªå‡½æ•°ä¸­éƒ½æœ‰æ•ˆï¼Œæ‰€ä»¥å®ƒä»¬æ²¡æœ‰ç‰¹åˆ«çš„æ¬¡åºã€‚ å› æ­¤ï¼Œå®ƒä»¬ä»¥å­—æ¯æ¬¡åºæ¥ç¼–å·ã€‚ï¼‰ å½“ç´¢å¼•å·æ¯” upvalue æ•°é‡å¤§çš„æ—¶å€™ï¼Œè¿”å› NULL ï¼ˆè€Œä¸”ä¸ä¼šå‹å…¥ä»»ä½•ä¸œè¥¿ï¼‰ å¯¹äº C å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ç”¨ç©ºä¸² â€œâ€ è¡¨ç¤ºæ‰€æœ‰ upvalue çš„åå­—ã€‚ lua_Hooktypedef void (*lua_Hook) (lua_State *L, lua_Debug *ar); ç”¨äºè°ƒè¯•çš„é’©å­å‡½æ•°ç±»å‹ã€‚æ— è®ºä½•æ—¶é’©å­è¢«è°ƒç”¨ï¼Œå®ƒçš„å‚æ•° ar ä¸­çš„ event åŸŸ éƒ½è¢«è®¾ä¸ºè§¦å‘é’©å­çš„äº‹ä»¶ã€‚ Lua æŠŠè¿™äº›äº‹ä»¶å®šä¹‰ä¸ºä»¥ä¸‹å¸¸é‡ï¼š LUA_HOOKCALLï¼Œ LUA_HOOKRET, LUA_HOOKTAILRETï¼Œ LUA_HOOKLINEï¼Œ and LUA_HOOKCOUNTã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œå¯¹äº line äº‹ä»¶ï¼Œcurrentline åŸŸä¹Ÿè¢«è®¾ç½®ã€‚ è¦æƒ³è·å¾— ar ä¸­çš„å…¶ä»–åŸŸï¼Œ é’©å­å¿…é¡»è°ƒç”¨ lua_getinfoã€‚ å¯¹äºè¿”å›äº‹ä»¶ï¼Œevent çš„æ­£å¸¸å€¼å¯èƒ½æ˜¯ LUA_HOOKRETï¼Œ æˆ–è€…æ˜¯ LUA_HOOKTAILRET ã€‚ å¯¹äºåä¸€ç§æƒ…å†µï¼ŒLua ä¼šå¯¹ä¸€ä¸ªå‡½æ•°åšçš„å°¾è°ƒç”¨ä¹Ÿæ¨¡æ‹Ÿå‡ºä¸€ä¸ªè¿”å›äº‹ä»¶å‡ºæ¥ï¼› å¯¹äºè¿™ä¸ªæ¨¡æ‹Ÿçš„è¿”å›äº‹ä»¶ï¼Œè°ƒç”¨ lua_getinfo æ²¡æœ‰ä»€ä¹ˆä½œç”¨ã€‚å½“ Lua è¿è¡Œåœ¨ä¸€ä¸ªé’©å­å†…éƒ¨æ—¶ï¼Œå®ƒå°†å±è”½æ‰å…¶å®ƒå¯¹é’©å­çš„è°ƒç”¨ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªé’©å­å‡½æ•°å†…å†è°ƒå› Lua æ¥æ‰§è¡Œä¸€ä¸ªå‡½æ•°æˆ–æ˜¯ä¸€ä¸ª chunk ï¼Œ è¿™ä¸ªæ‰§è¡Œæ“ä½œä¸ä¼šè§¦å‘ä»»ä½•çš„é’©å­ã€‚ lua_sethookint lua_sethook (lua_State *L, lua_Hook f, int mask, int count); è®¾ç½®ä¸€ä¸ªè°ƒè¯•ç”¨é’©å­å‡½æ•°ã€‚ å‚æ•° f æ˜¯é’©å­å‡½æ•°ã€‚ mask æŒ‡å®šåœ¨å“ªäº›äº‹ä»¶æ—¶ä¼šè°ƒç”¨ï¼š å®ƒç”±ä¸‹åˆ—ä¸€ç»„ä½å¸¸é‡æ„æˆ LUA_MASKCALLï¼Œ LUA_MASKRETï¼Œ LUA_MASKLINEï¼Œ ä»¥åŠ LUA_MASKCOUNTã€‚ å‚æ•° count åªåœ¨ mask ä¸­åŒ…å«æœ‰ LUA_MASKCOUNT æ‰æœ‰æ„ä¹‰ã€‚ å¯¹äºæ¯ä¸ªäº‹ä»¶ï¼Œé’©å­è¢«è°ƒç”¨çš„æƒ…å†µè§£é‡Šå¦‚ä¸‹ï¼šcall hook: åœ¨è§£é‡Šå™¨è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶è¢«è°ƒç”¨ã€‚ é’©å­å°†äº Lua è¿›å…¥ä¸€ä¸ªæ–°å‡½æ•°åï¼Œå‡½æ•°è·å–å‚æ•°å‰è¢«è°ƒç”¨ã€‚return hook: åœ¨è§£é‡Šå™¨ä»ä¸€ä¸ªå‡½æ•°ä¸­è¿”å›æ—¶è°ƒç”¨ã€‚ é’©å­å°†äº Lua ç¦»å¼€å‡½æ•°ä¹‹å‰çš„é‚£ä¸€åˆ»è¢«è°ƒç”¨ã€‚ ä½ æ— æƒè®¿é—®è¢«å‡½æ•°è¿”å›å‡ºå»çš„é‚£äº›å€¼ã€‚ ï¼ˆè¯‘æ³¨ï¼šåŸæ–‡ (You have no access to the values to be returned by the function) å¦‚æ­¤ã€‚ ä½†â€œæ— æƒè®¿é—®â€ä¸€è¯å€¼å¾—å•†æ¦·ã€‚ æŸäº›æƒ…å†µä¸‹ä½ å¯ä»¥è®¿é—®åˆ°ä¸€äº›è¢«å‘½åä¸º (*temporary) çš„å±€éƒ¨å˜é‡ï¼Œ é‚£äº›ç´¢å¼•è¢«æ’åœ¨æœ€åçš„ (temporary) å˜é‡æŒ‡çš„å°±æ˜¯è¿”å›å€¼ã€‚ ä½†æ˜¯ç”±äº Lua å¯¹ç‰¹æ®Šæƒ…å†µåšäº†ä¸€äº›ä¼˜åŒ–ï¼Œæ¯”å¦‚ç›´æ¥è¿”å›ä¸€ä¸ªè¢«å‘½åçš„å±€éƒ¨å˜é‡ï¼Œ é‚£ä¹ˆå°±æ‰¾ä¸åˆ°å¯¹åº”çš„ (temporary) å˜é‡äº†ã€‚æœ¬è´¨ä¸Šï¼Œè¿”å›å€¼ä¸€å®šå­˜åœ¨äºæ­¤åˆ»çš„å±€éƒ¨å˜é‡ä¸­ï¼Œ å¹¶ä¸”å¯ä»¥è®¿é—®å®ƒï¼Œåªæ˜¯æ— æ³•ç¡®å®šæ˜¯å“ªäº›ç½¢äº†ã€‚è‡³äºè¿™ä¸ªæ—¶å€™å‡½æ•°ä½“å†…çš„å…¶å®ƒå±€éƒ¨å˜é‡ï¼Œ æ˜¯ä¸ä¿è¯æœ‰æ•ˆçš„ã€‚è¿›å…¥ return hook çš„é‚£ä¸€åˆ»èµ·ï¼Œå®é™…å·²ç»é€€å‡ºå‡½æ•°å†…éƒ¨çš„è¿è¡Œç¯èŠ‚ï¼Œ è¿”å›å€¼å ç”¨çš„å±€éƒ¨å˜é‡ç©ºé—´ä»¥åçš„éƒ¨åˆ†ï¼Œéƒ½æœ‰å¯èƒ½å›  hook æœ¬èº«å¤ç”¨å®ƒä»¬è€Œæ”¹å˜ã€‚ï¼‰line hook: åœ¨è§£é‡Šå™¨å‡†å¤‡å¼€å§‹æ‰§è¡Œæ–°çš„ä¸€è¡Œä»£ç æ—¶ï¼Œ æˆ–æ˜¯è·³è½¬åˆ°è¿™è¡Œä»£ç ä¸­æ—¶ï¼ˆå³ä½¿åœ¨åŒä¸€è¡Œå†…è·³è½¬ï¼‰è¢«è°ƒç”¨ã€‚ ï¼ˆè¿™ä¸ªäº‹ä»¶ä»…ä»…åœ¨ Lua æ‰§è¡Œä¸€ä¸ª Lua å‡½æ•°æ—¶å‘ç”Ÿã€‚ï¼‰count hook: åœ¨è§£é‡Šå™¨æ¯æ‰§è¡Œ count æ¡æŒ‡ä»¤åè¢«è°ƒç”¨ã€‚ ï¼ˆè¿™ä¸ªäº‹ä»¶ä»…ä»…åœ¨ Lua æ‰§è¡Œä¸€ä¸ª Lua å‡½æ•°æ—¶å‘ç”Ÿã€‚ï¼‰é’©å­å¯ä»¥é€šè¿‡è®¾ç½® mask ä¸ºé›¶å±è”½ã€‚ lua_setlocalconst char *lua_setlocal (lua_State *L, lua_Debug *ar, int n); è®¾ç½®ç»™å®šæ´»åŠ¨è®°å½•ä¸­çš„å±€éƒ¨å˜é‡çš„å€¼ã€‚ å‚æ•° ar ä¸ n å’Œ lua_getlocal ä¸­çš„ä¸€æ · ï¼ˆå‚è§ lua_getlocalï¼‰ã€‚ lua_setlocal æŠŠæ ˆé¡¶çš„å€¼èµ‹ç»™å˜é‡ç„¶åè¿”å›å˜é‡çš„åå­—ã€‚ å®ƒä¼šå°†å€¼ä»æ ˆé¡¶å¼¹å‡ºã€‚å½“ç´¢å¼•å¤§äºå±€éƒ¨å˜é‡çš„ä¸ªæ•°æ—¶ï¼Œè¿”å› NULL ï¼ˆä»€ä¹ˆä¹Ÿä¸å¼¹å‡ºï¼‰ã€‚ lua_setupvalueconst char *lua_setupvalue (lua_State *L, int funcindex, int n); è®¾ç½® closure çš„ upvalue çš„å€¼ã€‚ å®ƒæŠŠæ ˆé¡¶çš„å€¼å¼¹å‡ºå¹¶èµ‹äº upvalue å¹¶è¿”å› upvalue çš„åå­—ã€‚ å‚æ•° funcindex ä¸ n å’Œ lua_getupvalue ä¸­çš„ä¸€æ · ï¼ˆå‚è§ lua_getupvalueï¼‰ã€‚å½“ç´¢å¼•å¤§äº upvalue çš„ä¸ªæ•°æ—¶ï¼Œè¿”å› NULL ï¼ˆä»€ä¹ˆä¹Ÿä¸å¼¹å‡ºï¼‰ã€‚ 4 - The Auxiliary LibraryThe auxiliary library provides several convenient functions to interface C with Lua. While the basic API provides the primitive functions for all interactions between C and Lua, the auxiliary library provides higher-level functions for some common tasks. All functions from the auxiliary library are defined in header file lauxlib.h and have a prefix luaL_. All functions in the auxiliary library are built on top of the basic API, and so they provide nothing that cannot be done with this API. Several functions in the auxiliary library are used to check C function arguments. Their names are always luaL_check or luaL_opt\. All of these functions raise an error if the check is not satisfied. Because the error message is formatted for arguments (e.g., â€œbad argument #1â€), you should not use these functions for other stack values. 4.1 - Functions and TypesHere we list all functions and types from the auxiliary library in alphabetical order. luaL_addcharvoid luaL_addchar (luaL_Buffer *B, char c); Adds the character c to the buffer B (see luaL_Buffer). luaL_addlstringvoid luaL_addlstring (luaL_Buffer *B, const char *s, size_t l); Adds the string pointed to by s with length l to the buffer B (see luaL_Buffer). The string may contain embedded zeros. luaL_addsizevoid luaL_addsize (luaL_Buffer *B, size_t n); Adds to the buffer B (see luaL_Buffer) a string of length n previously copied to the buffer area (see luaL_prepbuffer). luaL_addstringvoid luaL_addstring (luaL_Buffer *B, const char *s); Adds the zero-terminated string pointed to by s to the buffer B (see luaL_Buffer). The string may not contain embedded zeros. luaL_addvaluevoid luaL_addvalue (luaL_Buffer *B); Adds the value at the top of the stack to the buffer B (see luaL_Buffer). Pops the value.This is the only function on string buffers that can (and must) be called with an extra element on the stack, which is the value to be added to the buffer. luaL_argcheckvoid luaL_argcheck (lua_State *L, int cond, int narg, const char *extramsg); Checks whether cond is true. If not, raises an error with the following message, where func is retrieved from the call stack: bad argument #&lt;narg&gt; to &lt;func&gt; (&lt;extramsg&gt;) luaL_argerrorint luaL_argerror (lua_State *L, int narg, const char *extramsg); Raises an error with the following message, where func is retrieved from the call stack: bad argument #&lt;narg&gt; to &lt;func&gt; (&lt;extramsg&gt;) This function never returns, but it is an idiom to use it in C functions as return luaL_argerror(args). luaL_Buffertypedef struct luaL_Buffer luaL_Buffer;Type for a string buffer.A string buffer allows C code to build Lua strings piecemeal. Its pattern of use is as follows:First you declare a variable b of type luaL_Buffer.Then you initialize it with a call luaL_buffinit(L, &amp;b).Then you add string pieces to the buffer calling any of the luaL_add* functions.You finish by calling luaL_pushresult(&amp;b). This call leaves the final string on the top of the stack.During its normal operation, a string buffer uses a variable number of stack slots. So, while using a buffer, you cannot assume that you know where the top of the stack is. You can use the stack between successive calls to buffer operations as long as that use is balanced; that is, when you call a buffer operation, the stack is at the same level it was immediately after the previous buffer operation. (The only exception to this rule is luaL_addvalue.) After calling luaL_pushresult the stack is back to its level when the buffer was initialized, plus the final string on its top. luaL_buffinitvoid luaL_buffinit (lua_State *L, luaL_Buffer *B); Initializes a buffer B. This function does not allocate any space; the buffer must be declared as a variable (see luaL_Buffer). luaL_callmetaint luaL_callmeta (lua_State *L, int obj, const char *e); Calls a metamethod.If the object at index obj has a metatable and this metatable has a field e, this function calls this field and passes the object as its only argument. In this case this function returns 1 and pushes onto the stack the value returned by the call. If there is no metatable or no metamethod, this function returns 0 (without pushing any value on the stack). luaL_checkanyvoid luaL_checkany (lua_State *L, int narg); Checks whether the function has an argument of any type (including nil) at position narg. luaL_checkintint luaL_checkint (lua_State *L, int narg); Checks whether the function argument narg is a number and returns this number cast to an int. luaL_checkintegerlua_Integer luaL_checkinteger (lua_State *L, int narg); Checks whether the function argument narg is a number and returns this number cast to a lua_Integer. luaL_checklonglong luaL_checklong (lua_State *L, int narg); Checks whether the function argument narg is a number and returns this number cast to a long. luaL_checklstringconst char *luaL_checklstring (lua_State *L, int narg, size_t *l); Checks whether the function argument narg is a string and returns this string; if l is not NULL fills *l with the stringâ€™s length. luaL_checknumberlua_Number luaL_checknumber (lua_State *L, int narg);Checks whether the function argument narg is a number and returns this number. luaL_checkoptionint luaL_checkoption (lua_State *L, int narg, const char *def, const char *const lst[]); Checks whether the function argument narg is a string and searches for this string in the array lst (which must be NULL-terminated). Returns the index in the array where the string was found. Raises an error if the argument is not a string or if the string cannot be found.If def is not NULL, the function uses def as a default value when there is no argument narg or if this argument is nil.This is a useful function for mapping strings to C enums. (The usual convention in Lua libraries is to use strings instead of numbers to select options.) luaL_checkstackvoid luaL_checkstack (lua_State L, int sz, const char msg);Grows the stack size to top + sz elements, raising an error if the stack cannot grow to that size. msg is an additional text to go into the error message. luaL_checkstringconst char luaL_checkstring (lua_State L, int narg);Checks whether the function argument narg is a string and returns this string. luaL_checktypevoid luaL_checktype (lua_State *L, int narg, int t);Checks whether the function argument narg has type t. luaL_checkudatavoid luaL_checkudata (lua_State L, int narg, const char *tname);Checks whether the function argument narg is a userdata of the type tname (see luaL_newmetatable). luaL_dofileint luaL_dofile (lua_State L, const char filename);Loads and runs the given file. It is defined as the following macro: (luaL_loadfile(L, filename) || lua_pcall(L, 0, LUA_MULTRET, 0)) It returns 0 if there are no errors or 1 in case of errors. luaL_dostringint luaL_dostring (lua_State L, const char str);Loads and runs the given string. It is defined as the following macro: (luaL_loadstring(L, str) || lua_pcall(L, 0, LUA_MULTRET, 0)) It returns 0 if there are no errors or 1 in case of errors. luaL_errorint luaL_error (lua_State *L, const char *fmt, ...); Raises an error. The error message format is given by fmt plus any extra arguments, following the same rules of lua_pushfstring. It also adds at the beginning of the message the file name and the line number where the error occurred, if this information is available.This function never returns, but it is an idiom to use it in C functions as return luaL_error(args). luaL_getmetafieldint luaL_getmetafield (lua_State *L, int obj, const char *e); Pushes onto the stack the field e from the metatable of the object at index obj. If the object does not have a metatable, or if the metatable does not have this field, returns 0 and pushes nothing. luaL_getmetatablevoid luaL_getmetatable (lua_State *L, const char *tname); Pushes onto the stack the metatable associated with name tname in the registry (see luaL_newmetatable). luaL_gsubconst char *luaL_gsub (lua_State *L, const char *s, const char *p, const char *r); Creates a copy of string s by replacing any occurrence of the string p with the string r. Pushes the resulting string on the stack and returns it. luaL_loadbufferint luaL_loadbuffer (lua_State *L, const char *buff, size_t sz, const char *name); Loads a buffer as a Lua chunk. This function uses lua_load to load the chunk in the buffer pointed to by buff with size sz.This function returns the same results as lua_load. name is the chunk name, used for debug information and error messages. luaL_loadfileint luaL_loadfile (lua_State *L, const char *filename); Loads a file as a Lua chunk. This function uses lua_load to load the chunk in the file named filename. If filename is NULL, then it loads from the standard input. The first line in the file is ignored if it starts with a #.This function returns the same results as lua_load, but it has an extra error code LUA_ERRFILE if it cannot open/read the file.As lua_load, this function only loads the chunk; it does not run it. luaL_loadstringint luaL_loadstring (lua_State *L, const char *s); Loads a string as a Lua chunk. This function uses lua_load to load the chunk in the zero-terminated string s.This function returns the same results as lua_load.Also as lua_load, this function only loads the chunk; it does not run it. luaL_newmetatableint luaL_newmetatable (lua_State *L, const char *tname); If the registry already has the key tname, returns 0. Otherwise, creates a new table to be used as a metatable for userdata, adds it to the registry with key tname, and returns 1.In both cases pushes onto the stack the final value associated with tname in the registry. luaL_newstatelua_State *luaL_newstate (void); Creates a new Lua state. It calls lua_newstate with an allocator based on the standard C realloc function and then sets a panic function (see lua_atpanic) that prints an error message to the standard error output in case of fatal errors.Returns the new state, or NULL if there is a memory allocation error. luaL_openlibsvoid luaL_openlibs (lua_State *L); Opens all standard Lua libraries into the given state. luaL_optintint luaL_optint (lua_State *L, int narg, int d);If the function argument narg is a number, returns this number cast to an int. If this argument is absent or is nil, returns d. Otherwise, raises an error. luaL_optintegerlua_Integer luaL_optinteger (lua_State *L, int narg, lua_Integer d); If the function argument narg is a number, returns this number cast to a lua_Integer. If this argument is absent or is nil, returns d. Otherwise, raises an error. luaL_optlonglong luaL_optlong (lua_State *L, int narg, long d); If the function argument narg is a number, returns this number cast to a long. If this argument is absent or is nil, returns d. Otherwise, raises an error. luaL_optlstringconst char *luaL_optlstring (lua_State *L, int narg, const char *d, size_t *l); If the function argument narg is a string, returns this string. If this argument is absent or is nil, returns d. Otherwise, raises an error.If l is not NULL, fills the position *l with the resultsâ€™s length. luaL_optnumberlua_Number luaL_optnumber (lua_State *L, int narg, lua_Number d); If the function argument narg is a number, returns this number. If this argument is absent or is nil, returns d. Otherwise, raises an error. luaL_optstringconst char *luaL_optstring (lua_State *L, int narg, const char *d); If the function argument narg is a string, returns this string. If this argument is absent or is nil, returns d. Otherwise, raises an error. luaL_prepbufferchar *luaL_prepbuffer (luaL_Buffer *B); Returns an address to a space of size LUAL_BUFFERSIZE where you can copy a string to be added to buffer B (see luaL_Buffer). After copying the string into this space you must call luaL_addsize with the size of the string to actually add it to the buffer. luaL_pushresultvoid luaL_pushresult (luaL_Buffer *B); Finishes the use of buffer B leaving the final string on the top of the stack. luaL_refint luaL_ref (lua_State *L, int t); Creates and returns a reference, in the table at index t, for the object at the top of the stack (and pops the object).A reference is a unique integer key. As long as you do not manually add integer keys into table t, luaL_ref ensures the uniqueness of the key it returns. You can retrieve an object referred by reference r by calling lua_rawgeti(L, t, r). Function luaL_unref frees a reference and its associated object. If the object at the top of the stack is nil, luaL_ref returns the constant LUA_REFNIL. The constant LUA_NOREF is guaranteed to be different from any reference returned by luaL_ref. luaL_Regtypedef struct luaL_Reg { const char *name; lua_CFunction func;} luaL_Reg; Type for arrays of functions to be registered by luaL_register. name is the function name and func is a pointer to the function. Any array of luaL_Reg must end with an sentinel entry in which both name and func are NULL. luaL_registervoid luaL_register (lua_State *L, const char *libname, const luaL_Reg *l); Opens a library. When called with libname equal to NULL, it simply registers all functions in the list l (see luaL_Reg) into the table on the top of the stack.When called with a non-null libname, luaL_register creates a new table t, sets it as the value of the global variable libname, sets it as the value of package.loaded[libname], and registers on it all functions in the list l. If there is a table in package.loaded[libname] or in variable libname, reuses this table instead of creating a new one.In any case the function leaves the table on the top of the stack. 12345678910111213141516static int foo(lua_State *L)&#123; lua_pushnumber(L, 1); return 1;&#125;static const struct lua_Reg modulename[] = &#123; &#123;"foo", foo&#125;, &#123;NULL, NULL&#125;,&#125;;int luaopen_modulename(lua_State *L)&#123; luaL_newlib(L, modulename);// 5.2ä¹‹å‰ä½¿ç”¨çš„Lua_register(L, "modulename", modulename); return 1;&#125; å·¥ç¨‹ç›®å½• https://github.com/metanqy/binary_world.git luaL_typenameconst char luaL_typename (lua_State L, int idx);Returns the name of the type of the value at index idx. luaL_typerrorint luaL_typerror (lua_State L, int narg, const char tname);Generates an error with a message like the following: location: bad argument narg to &#39;func&#39; (tname expected, got rt) where location is produced by luaL_where, func is the name of the current function, and rt is the type name of the actual argument. luaL_unrefvoid luaL_unref (lua_State *L, int t, int ref); Releases reference ref from the table at index t (see luaL_ref). The entry is removed from the table, so that the referred object can be collected. The reference ref is also freed to be used again. If ref is LUA_NOREF or LUA_REFNIL, luaL_unref does nothing. luaL_wherevoid luaL_where (lua_State *L, int lvl); Pushes onto the stack a string identifying the current position of the control at level lvl in the call stack. Typically this string has the following format: chunkname:currentline: Level 0 is the running function, level 1 is the function that called the running function, etc.This function is used to build a prefix for error messages. Standard LibrariesThe standard Lua libraries provide useful functions that are implemented directly through the C API. Some of these functions provide essential services to the language (e.g., type and getmetatable); others provide access to â€œoutsideâ€ services (e.g., I/O); and others could be implemented in Lua itself, but are quite useful or have critical performance requirements that deserve an implementation in C (e.g., sort). All libraries are implemented through the official C API and are provided as separate C modules. Currently, Lua has the following standard libraries: basic library;package library;string manipulation;table manipulation;mathematical functions (sin, log, etc.);input and output;operating system facilities;debug facilities.Except for the basic and package libraries, each library provides all its functions as fields of a global table or as methods of its objects. To have access to these libraries, the C host program should call the luaL_openlibs function, which opens all standard libraries. Alternatively, it can open them individually by calling luaopen_base (for the basic library), luaopen_package (for the package library), luaopen_string (for the string library), luaopen_table (for the table library), luaopen_math (for the mathematical library), luaopen_io (for the I/O and the Operating System libraries), and luaopen_debug (for the debug library). These functions are declared in lualib.h and should not be called directly: you must call them like any other Lua C function, e.g., by using lua_call. The basic library provides some core functions to Lua. If you do not include this library in your application, you should check carefully whether you need to provide implementations for some of its facilities. assert (v [, message])Issues an error when the value of its argument v is false (i.e., nil or false); otherwise, returns all its arguments. message is an error message; when absent, it defaults to â€œassertion failed!â€collectgarbage (opt [, arg])This function is a generic interface to the garbage collector. It performs different functions according to its first argument, opt: â€œstopâ€: stops the garbage collector.â€œrestartâ€: restarts the garbage collector.â€œcollectâ€: performs a full garbage-collection cycle.â€œcountâ€: returns the total memory in use by Lua (in Kbytes).â€œstepâ€: performs a garbage-collection step. The step â€œsizeâ€ is controlled by arg (larger values mean more steps) in a non-specified way. If you want to control the step size you must experimentally tune the value of arg. Returns true if the step finished a collection cycle.â€œsetpauseâ€: sets arg/100 as the new value for the pause of the collector (see Â§2.10).â€œsetstepmulâ€: sets arg/100 as the new value for the step multiplier of the collector (see Â§2.10).dofile (filename)Opens the named file and executes its contents as a Lua chunk. When called without arguments, dofile executes the contents of the standard input (stdin). Returns all values returned by the chunk. In case of errors, dofile propagates the error to its caller (that is, dofile does not run in protected mode).error (message [, level])Terminates the last protected function called and returns message as the error message. Function error never returns.Usually, error adds some information about the error position at the beginning of the message. The level argument specifies how to get the error position. With level 1 (the default), the error position is where the error function was called. Level 2 points the error to where the function that called error was called; and so on. Passing a level 0 avoids the addition of error position information to the message. _GA global variable (not a function) that holds the global environment (that is, _G._G = _G). Lua itself does not use this variable; changing its value does not affect any environment, nor vice-versa. (Use setfenv to change environments.)getfenv (f)Returns the current environment in use by the function. f can be a Lua function or a number that specifies the function at that stack level: Level 1 is the function calling getfenv. If the given function is not a Lua function, or if f is 0, getfenv returns the global environment. The default for f is 1.getmetatable (object)If object does not have a metatable, returns nil. Otherwise, if the objectâ€™s metatable has a â€œ__metatableâ€ field, returns the associated value. Otherwise, returns the metatable of the given object. ipairs (t)Returns three values: an iterator function, the table t, and 0, so that the construction for i,v in ipairs(t) do body end will iterate over the pairs (1,t[1]), (2,t[2]), Â·Â·Â·, up to the first integer key absent from the table. load (func [, chunkname])Loads a chunk using function func to get its pieces. Each call to func must return a string that concatenates with previous results. A return of nil (or no value) signals the end of the chunk. If there are no errors, returns the compiled chunk as a function; otherwise, returns nil plus the error message. The environment of the returned function is the global environment. chunkname is used as the chunk name for error messages and debug information. loadfile ([filename])Similar to load, but gets the chunk from file filename or from the standard input, if no file name is given. loadstring (string [, chunkname])Similar to load, but gets the chunk from the given string. To load and run a given string, use the idiom assert(loadstring(s))() next (table [, index])Allows a program to traverse all fields of a table. Its first argument is a table and its second argument is an index in this table. next returns the next index of the table and its associated value. When called with nil as its second argument, next returns an initial index and its associated value. When called with the last index, or with nil in an empty table, next returns nil. If the second argument is absent, then it is interpreted as nil. In particular, you can use next(t) to check whether a table is empty. The order in which the indices are enumerated is not specified, even for numeric indices. (To traverse a table in numeric order, use a numerical for or the ipairs function.) The behavior of next is undefined if, during the traversal, you assign any value to a non-existent field in the table. You may however modify existing fields. In particular, you may clear existing fields. pairs (t)Returns three values: the next function, the table t, and nil, so that the construction for k,v in pairs(t) do body end will iterate over all keyâ€“value pairs of table t. See function next for the caveats of modifying the table during its traversal. pcall (f, arg1, Â·Â·Â·)Calls function f with the given arguments in protected mode. This means that any error inside f is not propagated; instead, pcall catches the error and returns a status code. Its first result is the status code (a boolean), which is true if the call succeeds without errors. In such case, pcall also returns all results from the call, after this first result. In case of any error, pcall returns false plus the error message. print (Â·Â·Â·)Receives any number of arguments, and prints their values to stdout, using the tostring function to convert them to strings. print is not intended for formatted output, but only as a quick way to show a value, typically for debugging. For formatted output, use string.format.rawequal (v1, v2)Checks whether v1 is equal to v2, without invoking any metamethod. Returns a boolean.rawget (table, index)Gets the real value of table[index], without invoking any metamethod. table must be a table; index may be any value.rawset (table, index, value)Sets the real value of table[index] to value, without invoking any metamethod. table must be a table, index any value different from nil, and value any Lua value.This function returns table. select (index, Â·Â·Â·)If index is a number, returns all arguments after argument number index. Otherwise, index must be the string â€œ#â€, and select returns the total number of extra arguments it received. setfenv (f, table)Sets the environment to be used by the given function. f can be a Lua function or a number that specifies the function at that stack level: Level 1 is the function calling setfenv. setfenv returns the given function. As a special case, when f is 0 setfenv changes the environment of the running thread. In this case, setfenv returns no values. setmetatable (table, metatable)Sets the metatable for the given table. (You cannot change the metatable of other types from Lua, only from C.) If metatable is nil, removes the metatable of the given table. If the original metatable has a â€œ__metatableâ€ field, raises an error. This function returns table. tonumber (e [, base])Tries to convert its argument to a number. If the argument is already a number or a string convertible to a number, then tonumber returns this number; otherwise, it returns nil.An optional argument specifies the base to interpret the numeral. The base may be any integer between 2 and 36, inclusive. In bases above 10, the letter â€˜Aâ€™ (in either upper or lower case) represents 10, â€˜Bâ€™ represents 11, and so forth, with â€˜Zâ€™ representing 35. In base 10 (the default), the number may have a decimal part, as well as an optional exponent part (see Â§2.1). In other bases, only unsigned integers are accepted. tostring (e)Receives an argument of any type and converts it to a string in a reasonable format. For complete control of how numbers are converted, use string.format.If the metatable of e has a â€œ__tostringâ€ field, then tostring calls the corresponding value with e as argument, and uses the result of the call as its result. type (v)Returns the type of its only argument, coded as a string. The possible results of this function are â€œnilâ€ (a string, not the value nil), â€œnumberâ€, â€œstringâ€, â€œbooleanâ€, â€œtableâ€, â€œfunctionâ€, â€œthreadâ€, and â€œuserdataâ€.unpack (list [, i [, j]])Returns the elements from the given table. This function is equivalent to return list[i], list[i+1], Â·Â·Â·, list[j]except that the above code can be written only for a fixed number of elements. By default, i is 1 and j is the length of the list, as defined by the length operator (see Â§2.5.5). _VERSIONA global variable (not a function) that holds a string containing the current interpreter version. The current contents of this variable is â€œLua 5.1â€.xpcall (f, err)This function is similar to pcall, except that you can set a new error handler. xpcall calls function f in protected mode, using err as the error handler. Any error inside f is not propagated; instead, xpcall catches the error, calls the err function with the original error object, and returns a status code. Its first result is the status code (a boolean), which is true if the call succeeds without errors. In this case, xpcall also returns all results from the call, after this first result. In case of any error, xpcall returns false plus the result from err. Coroutine ManipulationThe operations related to coroutines comprise a sub-library of the basic library and come inside the table coroutine. coroutine.create (f)Creates a new coroutine, with body f. f must be a Lua function. Returns this new coroutine, an object with type â€œthreadâ€. coroutine.resume (co [, val1, Â·Â·Â·])Starts or continues the execution of coroutine co. The first time you resume a coroutine, it starts running its body. The values val1, Â·Â·Â· are passed as the arguments to the body function. If the coroutine has yielded, resume restarts it; the values val1, Â·Â·Â· are passed as the results from the yield. If the coroutine runs without any errors, resume returns true plus any values passed to yield (if the coroutine yields) or any values returned by the body function (if the coroutine terminates). If there is any error, resume returns false plus the error message. coroutine.running ()Returns the running coroutine, or nil when called by the main thread. coroutine.status (co)Returns the status of coroutine co, as a string: â€œrunningâ€, if the coroutine is running (that is, it called status); â€œsuspendedâ€, if the coroutine is suspended in a call to yield, or if it has not started running yet; â€œnormalâ€ if the coroutine is active but not running (that is, it has resumed another coroutine); and â€œdeadâ€ if the coroutine has finished its body function, or if it has stopped with an error. coroutine.wrap (f)Creates a new coroutine, with body f. f must be a Lua function. Returns a function that resumes the coroutine each time it is called. Any arguments passed to the function behave as the extra arguments to resume. Returns the same values returned by resume, except the first boolean. In case of error, propagates the error. coroutine.yield (Â·Â·Â·)Suspends the execution of the calling coroutine. The coroutine cannot be running a C function, a metamethod, or an iterator. Any arguments to yield are passed as extra results to resume. ModulesThe package library provides basic facilities for loading and building modules in Lua. It exports two of its functions directly in the global environment: require and module. Everything else is exported in a table package.module (name [, Â·Â·Â·])Creates a module. If there is a table in package.loaded[name], this table is the module. Otherwise, if there is a global table t with the given name, this table is the module. Otherwise creates a new table t and sets it as the value of the global name and the value of package.loaded[name]. This function also initializes t._NAME with the given name, t._M with the module (t itself), and t._PACKAGE with the package name (the full module name minus last component; see below). Finally, module sets t as the new environment of the current function and the new value of package.loaded[name], so that require returns t. If name is a compound name (that is, one with components separated by dots), module creates (or reuses, if they already exist) tables for each component. For instance, if name is a.b.c, then module stores the module table in field c of field b of global a. This function may receive optional options after the module name, where each option is a function to be applied over the module. require (modname)Loads the given module. The function starts by looking into the package.loaded table to determine whether modname is already loaded. If it is, then require returns the value stored at package.loaded[modname]. Otherwise, it tries to find a loader for the module. To find a loader, first require queries package.preload[modname]. If it has a value, this value (which should be a function) is the loader. Otherwise require searches for a Lua loader using the path stored in package.path. If that also fails, it searches for a C loader using the path stored in package.cpath. If that also fails, it tries an all-in-one loader (see below). When loading a C library, require first uses a dynamic link facility to link the application with the library. Then it tries to find a C function inside this library to be used as the loader. The name of this C function is the string â€œluaopen_â€ concatenated with a copy of the module name where each dot is replaced by an underscore. Moreover, if the module name has a hyphen, its prefix up to (and including) the first hyphen is removed. For instance, if the module name is a.v1-b.c, the function name will be luaopen_b_c. If require finds neither a Lua library nor a C library for a module, it calls the all-in-one loader. This loader searches the C path for a library for the root name of the given module. For instance, when requiring a.b.c, it will search for a C library for a. If found, it looks into it for an open function for the submodule; in our example, that would be luaopen_a_b_c. With this facility, a package can pack several C submodules into one single library, with each submodule keeping its original open function. Once a loader is found, require calls the loader with a single argument, modname. If the loader returns any value, require assigns the returned value to package.loaded[modname]. If the loader returns no value and has not assigned any value to package.loaded[modname], then require assigns true to this entry. In any case, require returns the final value of package.loaded[modname]. If there is any error loading or running the module, or if it cannot find any loader for the module, then require signals an error. package.cpathThe path used by require to search for a C loader. Lua initializes the C path package.cpath in the same way it initializes the Lua path package.path, using the environment variable LUA_CPATH (plus another default path defined in luaconf.h). package.loadedA table used by require to control which modules are already loaded. When you require a module modname and package.loaded[modname] is not false, require simply returns the value stored there. package.loadlib (libname, funcname)Dynamically links the host program with the C library libname. Inside this library, looks for a function funcname and returns this function as a C function. (So, funcname must follow the protocol (see lua_CFunction)). This is a low-level function. It completely bypasses the package and module system. Unlike require, it does not perform any path searching and does not automatically adds extensions. libname must be the complete file name of the C library, including if necessary a path and extension. funcname must be the exact name exported by the C library (which may depend on the C compiler and linker used). This function is not supported by ANSI C. As such, it is only available on some platforms (Windows, Linux, Mac OS X, Solaris, BSD, plus other Unix systems that support the dlfcn standard). package.pathThe path used by require to search for a Lua loader. At start-up, Lua initializes this variable with the value of the environment variable LUA_PATH or with a default path defined in luaconf.h, if the environment variable is not defined. Any â€œ;;â€ in the value of the environment variable is replaced by the default path. A path is a sequence of templates separated by semicolons. For each template, require will change each interrogation mark in the template by filename, which is modname with each dot replaced by a â€œdirectory separatorâ€ (such as â€œ/â€œ in Unix); then it will try to load the resulting file name. So, for instance, if the Lua path is &quot;./?.lua;./?.lc;/usr/local/?/init.lua&quot; the search for a Lua loader for module foo will try to load the files ./foo.lua, ./foo.lc, and /usr/local/foo/init.lua, in that order. package.preloadA table to store loaders for specific modules (see require). package.seeall (module)Sets a metatable for module with its __index field referring to the global environment, so that this module inherits values from the global environment. To be used as an option to function module. 5.4 - String ManipulationThis library provides generic functions for string manipulation, such as finding and extracting substrings, and pattern matching. When indexing a string in Lua, the first character is at position 1 (not at 0, as in C). Indices are allowed to be negative and are interpreted as indexing backwards, from the end of the string. Thus, the last character is at position -1, and so on. The string library provides all its functions inside the table string. It also sets a metatable for strings where the __index field points to the string table. Therefore, you can use the string functions in object-oriented style. For instance, string.byte(s, i) can be written as s:byte(i). string.byte (s [, i [, j]])Returns the internal numerical codes of the characters s[i], s[i+1], Â·Â·Â·, s[j]. The default value for i is 1; the default value for j is i.Note that numerical codes are not necessarily portable across platforms. string.char (Â·Â·Â·)Receives zero or more integers. Returns a string with length equal to the number of arguments, in which each character has the internal numerical code equal to its corresponding argument.Note that numerical codes are not necessarily portable across platforms. string.dump (function)Returns a string containing a binary representation of the given function, so that a later loadstring on this string returns a copy of the function. function must be a Lua function without upvalues. string.find (s, pattern [, init [, plain]])Looks for the first match of pattern in the string s. If it finds a match, then find returns the indices of s where this occurrence starts and ends; otherwise, it returns nil. A third, optional numerical argument init specifies where to start the search; its default value is 1 and may be negative. A value of true as a fourth, optional argument plain turns off the pattern matching facilities, so the function does a plain â€œfind substringâ€ operation, with no characters in pattern being considered â€œmagicâ€. Note that if plain is given, then init must be given as well.If the pattern has captures, then in a successful match the captured values are also returned, after the two indices. string.format (formatstring, Â·Â·Â·)Returns a formatted version of its variable number of arguments following the description given in its first argument (which must be a string). The format string follows the same rules as the printf family of standard C functions. The only differences are that the options/modifiers *, l, L, n, p, and h are not supported and that there is an extra option, q. The q option formats a string in a form suitable to be safely read back by the Lua interpreter: the string is written between double quotes, and all double quotes, newlines, embedded zeros, and backslashes in the string are correctly escaped when written. For instance, the call string.format(â€˜%qâ€™, â€˜a string with â€œquotesâ€ and \n new lineâ€™)will produce the string: &quot;a string with \&quot;quotes\&quot; and \ new line&quot; The options c, d, E, e, f, g, G, i, o, u, X, and x all expect a number as argument, whereas q and s expect a string. This function does not accept string values containing embedded zeros. string.gmatch (s, pattern)Returns an iterator function that, each time it is called, returns the next captures from pattern over string s.If pattern specifies no captures, then the whole match is produced in each call. As an example, the following loop s = &quot;hello world from Lua&quot; for w in string.gmatch(s, &quot;%a+&quot;) do print(w) end will iterate over all the words from string s, printing one per line. The next example collects all pairs key=value from the given string into a table: t = {} s = &quot;from=world, to=Lua&quot; for k, v in string.gmatch(s, &quot;(%w+)=(%w+)&quot;) do t[k] = v end string.gsub (s, pattern, repl [, n])Returns a copy of s in which all occurrences of the pattern have been replaced by a replacement string specified by repl, which may be a string, a table, or a function. gsub also returns, as its second value, the total number of substitutions made.If repl is a string, then its value is used for replacement. The character % works as an escape character: any sequence in repl of the form %n, with n between 1 and 9, stands for the value of the n-th captured substring (see below). The sequence %0 stands for the whole match. The sequence %% stands for a single %. If repl is a table, then the table is queried for every match, using the first capture as the key; if the pattern specifies no captures, then the whole match is used as the key. If repl is a function, then this function is called every time a match occurs, with all captured substrings passed as arguments, in order; if the pattern specifies no captures, then the whole match is passed as a sole argument. If the value returned by the table query or by the function call is a string or a number, then it is used as the replacement string; otherwise, if it is false or nil, then there is no replacement (that is, the original match is kept in the string). The optional last parameter n limits the maximum number of substitutions to occur. For instance, when n is 1 only the first occurrence of pattern is replaced. Here are some examples: x = string.gsub(&quot;hello world&quot;, &quot;(%w+)&quot;, &quot;%1 %1&quot;) --&gt; x=&quot;hello hello world world&quot; x = string.gsub(&quot;hello world&quot;, &quot;%w+&quot;, &quot;%0 %0&quot;, 1) --&gt; x=&quot;hello hello world&quot; x = string.gsub(&quot;hello world from Lua&quot;, &quot;(%w+)%s*(%w+)&quot;, &quot;%2 %1&quot;) --&gt; x=&quot;world hello Lua from&quot; x = string.gsub(&quot;home = $HOME, user = $USER&quot;, &quot;%$(%w+)&quot;, os.getenv) --&gt; x=&quot;home = /home/roberto, user = roberto&quot; x = string.gsub(&quot;4+5 = $return 4+5$&quot;, &quot;%$(.-)%$&quot;, function (s) return loadstring(s)() end) --&gt; x=&quot;4+5 = 9&quot; local t = {name=&quot;lua&quot;, version=&quot;5.1&quot;} x = string.gsub(&quot;$name%-$version.tar.gz&quot;, &quot;%$(%w+)&quot;, t) --&gt; x=&quot;lua-5.1.tar.gz&quot; string.len (s)Receives a string and returns its length. The empty string â€œâ€ has length 0. Embedded zeros are counted, so â€œa\000bc\000â€ has length 5.string.lower (s)Receives a string and returns a copy of this string with all uppercase letters changed to lowercase. All other characters are left unchanged. The definition of what an uppercase letter is depends on the current locale.string.match (s, pattern [, init])Looks for the first match of pattern in the string s. If it finds one, then match returns the captures from the pattern; otherwise it returns nil. If pattern specifies no captures, then the whole match is returned. A third, optional numerical argument init specifies where to start the search; its default value is 1 and may be negative.string.rep (s, n)Returns a string that is the concatenation of n copies of the string s.string.reverse (s)Returns a string that is the string s reversed.string.sub (s, i [, j])Returns the substring of s that starts at i and continues until j; i and j may be negative. If j is absent, then it is assumed to be equal to -1 (which is the same as the string length). In particular, the call string.sub(s,1,j) returns a prefix of s with length j, and string.sub(s, -i) returns a suffix of s with length i.string.upper (s)Receives a string and returns a copy of this string with all lowercase letters changed to uppercase. All other characters are left unchanged. The definition of what a lowercase letter is depends on the current locale.5.4.1 - PatternsCharacter Class:A character class is used to represent a set of characters. The following combinations are allowed in describing a character class: x: (where x is not one of the magic characters ^$()%.[]*+-?) represents the character x itself..: (a dot) represents all characters.%a: represents all letters.%c: represents all control characters.%d: represents all digits.%l: represents all lowercase letters.%p: represents all punctuation characters.%s: represents all space characters.%u: represents all uppercase letters.%w: represents all alphanumeric characters.%x: represents all hexadecimal digits.%z: represents the character with representation 0.%x: (where x is any non-alphanumeric character) represents the character x. This is the standard way to escape the magic characters. Any punctuation character (even the non magic) can be preceded by a â€˜%â€™ when used to represent itself in a pattern.[set]: represents the class which is the union of all characters in set. A range of characters may be specified by separating the end characters of the range with a â€˜-â€˜. All classes %x described above may also be used as components in set. All other characters in set represent themselves. For example, [%w_] (or [_%w]) represents all alphanumeric characters plus the underscore, [0-7] represents the octal digits, and [0-7%l%-] represents the octal digits plus the lowercase letters plus the â€˜-â€˜ character.The interaction between ranges and classes is not defined. Therefore, patterns like [%a-z] or [a-%%] have no meaning. set. represents the complement of set, where set is interpreted as above. &#8617; For all classes represented by single letters (%a, %c, etc.), the corresponding uppercase letter represents the complement of the class. For instance, %S represents all non-space characters. The definitions of letter, space, and other character groups depend on the current locale. In particular, the class [a-z] may not be equivalent to %l. Pattern Item:A pattern item may be a single character class, which matches any single character in the class;a single character class followed by â€˜â€˜, which matches 0 or more repetitions of characters in the class. These repetition items will always match the longest possible sequence;a single character class followed by â€˜+â€™, which matches 1 or more repetitions of characters in the class. These repetition items will always match the longest possible sequence;a single character class followed by â€˜-â€˜, which also matches 0 or more repetitions of characters in the class. Unlike â€˜â€˜, these repetition items will always match the shortest possible sequence;a single character class followed by â€˜?â€™, which matches 0 or 1 occurrence of a character in the class;%n, for n between 1 and 9; such item matches a substring equal to the n-th captured string (see below);%bxy, where x and y are two distinct characters; such item matches strings that start with x, end with y, and where the x and y are balanced. This means that, if one reads the string from left to right, counting +1 for an x and -1 for a y, the ending y is the first y where the count reaches 0. For instance, the item %b() matches expressions with balanced parentheses.Pattern:A pattern is a sequence of pattern items. A â€˜^â€™ at the beginning of a pattern anchors the match at the beginning of the subject string. A â€˜$â€™ at the end of a pattern anchors the match at the end of the subject string. At other positions, â€˜^â€™ and â€˜$â€™ have no special meaning and represent themselves. Captures:A pattern may contain sub-patterns enclosed in parentheses; they describe captures. When a match succeeds, the substrings of the subject string that match captures are stored (captured) for future use. Captures are numbered according to their left parentheses. For instance, in the pattern â€œ(a(.)%w(%s))â€, the part of the string matching â€œa(.)%w(%s)â€ is stored as the first capture (and therefore has number 1); the character matching â€œ.â€ is captured with number 2, and the part matching â€œ%s*â€ has number 3. As a special case, the empty capture () captures the current string position (a number). For instance, if we apply the pattern â€œ()aa()â€ on the string â€œflaaapâ€, there will be two captures: 3 and 5. A pattern cannot contain embedded zeros. Use %z instead. 5.5 - Table ManipulationThis library provides generic functions for table manipulation. It provides all its functions inside the table table. Most functions in the table library assume that the table represents an array or a list. For these functions, when we talk about the â€œlengthâ€ of a table we mean the result of the length operator. table.concat (table [, sep [, i [, j]]])Given an array where all elements are strings or numbers, returns table[i]..sep..table[i+1] Â·Â·Â· sep..table[j]. The default value for sep is the empty string, the default for i is 1, and the default for j is the length of the table. If i is greater than j, returns the empty string.table.insert (table, [pos,] value)Inserts element value at position pos in table, shifting up other elements to open space, if necessary. The default value for pos is n+1, where n is the length of the table (see Â§2.5.5), so that a call table.insert(t,x) inserts x at the end of table t. table.maxn (table)Returns the largest positive numerical index of the given table, or zero if the table has no positive numerical indices. (To do its job this function does a linear traversal of the whole table.) table.remove (table [, pos])Removes from table the element at position pos, shifting down other elements to close the space, if necessary. Returns the value of the removed element. The default value for pos is n, where n is the length of the table, so that a call table.remove(t) removes the last element of table t. table.sort (table [, comp])Sorts table elements in a given order, in-place, from table[1] to table[n], where n is the length of the table. If comp is given, then it must be a function that receives two table elements, and returns true when the first is less than the second (so that not comp(a[i+1],a[i]) will be true after the sort). If comp is not given, then the standard Lua operator &lt; is used instead.The sort algorithm is not stable; that is, elements considered equal by the given order may have their relative positions changed by the sort. 5.6 - Mathematical FunctionsThis library is an interface to the standard C math library. It provides all its functions inside the table math. math.abs (x)Returns the absolute value of x. math.acos (x)Returns the arc cosine of x (in radians). math.asin (x)Returns the arc sine of x (in radians). math.atan (x)Returns the arc tangent of x (in radians). math.atan2 (x, y)Returns the arc tangent of x/y (in radians), but uses the signs of both parameters to find the quadrant of the result. (It also handles correctly the case of y being zero.) math.ceil (x)Returns the smallest integer larger than or equal to x. math.cos (x)Returns the cosine of x (assumed to be in radians). math.cosh (x)Returns the hyperbolic cosine of x. math.deg (x)Returns the angle x (given in radians) in degrees. math.exp (x)Returns the the value ex. math.floor (x)Returns the largest integer smaller than or equal to x. math.fmod (x, y)Returns the remainder of the division of x by y. math.frexp (x)Returns m and e such that x = m2e, e is an integer and the absolute value of m is in the range [0.5, 1) (or zero when x is zero). math.hugeThe value HUGE_VAL, a value larger than or equal to any other numerical value. math.ldexp (m, e)Returns m2e (e should be an integer). math.log (x)Returns the natural logarithm of x. math.log10 (x)Returns the base-10 logarithm of x. math.max (x, Â·Â·Â·)Returns the maximum value among its arguments. math.min (x, Â·Â·Â·)Returns the minimum value among its arguments. math.modf (x)Returns two numbers, the integral part of x and the fractional part of x. math.piThe value of pi. math.pow (x, y)Returns xy. (You can also use the expression x^y to compute this value.) math.rad (x)Returns the angle x (given in degrees) in radians. math.random ([m [, n]])This function is an interface to the simple pseudo-random generator function rand provided by ANSI C. (No guarantees can be given for its statistical properties.) When called without arguments, returns a pseudo-random real number in the range [0,1). When called with a number m, math.random returns a pseudo-random integer in the range [1, m]. When called with two numbers m and n, math.random returns a pseudo-random integer in the range [m, n]. math.randomseed (x)Sets x as the â€œseedâ€ for the pseudo-random generator: equal seeds produce equal sequences of numbers. math.sin (x)Returns the sine of x (assumed to be in radians). math.sinh (x)Returns the hyperbolic sine of x. math.sqrt (x)Returns the square root of x. (You can also use the expression x^0.5 to compute this value.) math.tan (x)Returns the tangent of x (assumed to be in radians). math.tanh (x)Returns the hyperbolic tangent of x. 5.7 - Input and Output FacilitiesThe I/O library provides two different styles for file manipulation. The first one uses implicit file descriptors; that is, there are operations to set a default input file and a default output file, and all input/output operations are over these default files. The second style uses explicit file descriptors. When using implicit file descriptors, all operations are supplied by table io. When using explicit file descriptors, the operation io.open returns a file descriptor and then all operations are supplied as methods of the file descriptor. The table io also provides three predefined file descriptors with their usual meanings from C: io.stdin, io.stdout, and io.stderr. Unless otherwise stated, all I/O functions return nil on failure (plus an error message as a second result) and some value different from nil on success. io.close ([file])Equivalent to file:close(). Without a file, closes the default output file. io.flush ()Equivalent to file:flush over the default output file. io.input ([file])When called with a file name, it opens the named file (in text mode), and sets its handle as the default input file. When called with a file handle, it simply sets this file handle as the default input file. When called without parameters, it returns the current default input file. In case of errors this function raises the error, instead of returning an error code. io.lines ([filename])Opens the given file name in read mode and returns an iterator function that, each time it is called, returns a new line from the file. Therefore, the construction for line in io.lines(filename) do body end will iterate over all lines of the file. When the iterator function detects the end of file, it returns nil (to finish the loop) and automatically closes the file. The call io.lines() (with no file name) is equivalent to io.input():lines(); that is, it iterates over the lines of the default input file. In this case it does not close the file when the loop ends. io.open (filename [, mode])This function opens a file, in the mode specified in the string mode. It returns a new file handle, or, in case of errors, nil plus an error message. The mode string can be any of the following: â€œrâ€: read mode (the default);â€œwâ€: write mode;â€œaâ€: append mode;â€œr+â€: update mode, all previous data is preserved;â€œw+â€: update mode, all previous data is erased;â€œa+â€: append update mode, previous data is preserved, writing is only allowed at the end of file.The mode string may also have a â€˜bâ€™ at the end, which is needed in some systems to open the file in binary mode. This string is exactly what is used in the standard C function fopen. io.output ([file])Similar to io.input, but operates over the default output file. io.popen (prog [, mode])Starts program prog in a separated process and returns a file handle that you can use to read data from this program (if mode is â€œrâ€, the default) or to write data to this program (if mode is â€œwâ€). This function is system dependent and is not available on all platforms. io.read (Â·Â·Â·)Equivalent to io.input():read. io.tmpfile ()Returns a handle for a temporary file. This file is opened in update mode and it is automatically removed when the program ends. io.type (obj)Checks whether obj is a valid file handle. Returns the string â€œfileâ€ if obj is an open file handle, â€œclosed fileâ€ if obj is a closed file handle, or nil if obj is not a file handle. io.write (Â·Â·Â·)Equivalent to io.output():write. file:close ()Closes file. Note that files are automatically closed when their handles are garbage collected, but that takes an unpredictable amount of time to happen. file:flush ()Saves any written data to file. file:lines ()Returns an iterator function that, each time it is called, returns a new line from the file. Therefore, the construction for line in file:lines() do body end will iterate over all lines of the file. (Unlike io.lines, this function does not close the file when the loop ends.) file:read (Â·Â·Â·)Reads the file file, according to the given formats, which specify what to read. For each format, the function returns a string (or a number) with the characters read, or nil if it cannot read data with the specified format. When called without formats, it uses a default format that reads the entire next line (see below). The available formats are â€œnâ€: reads a number; this is the only format that returns a number instead of a string.â€œaâ€: reads the whole file, starting at the current position. On end of file, it returns the empty string.â€œ*lâ€: reads the next line (skipping the end of line), returning nil on end of file. This is the default format.number: reads a string with up to this number of characters, returning nil on end of file. If number is zero, it reads nothing and returns an empty string, or nil on end of file.file:seek ([whence] [, offset])Sets and gets the file position, measured from the beginning of the file, to the position given by offset plus a base specified by the string whence, as follows: â€œsetâ€: base is position 0 (beginning of the file);â€œcurâ€: base is current position;â€œendâ€: base is end of file;In case of success, function seek returns the final file position, measured in bytes from the beginning of the file. If this function fails, it returns nil, plus a string describing the error. The default value for whence is â€œcurâ€, and for offset is 0. Therefore, the call file:seek() returns the current file position, without changing it; the call file:seek(â€œsetâ€) sets the position to the beginning of the file (and returns 0); and the call file:seek(â€œendâ€) sets the position to the end of the file, and returns its size. file:setvbuf (mode [, size])Sets the buffering mode for an output file. There are three available modes: â€œnoâ€: no buffering; the result of any output operation appears immediately.â€œfullâ€: full buffering; output operation is performed only when the buffer is full (or when you explicitly flush the file (see io.flush)).â€œlineâ€: line buffering; output is buffered until a newline is output or there is any input from some special files (such as a terminal device).For the last two cases, sizes specifies the size of the buffer, in bytes. The default is an appropriate size. file:write (Â·Â·Â·)Writes the value of each of its arguments to the file. The arguments must be strings or numbers. To write other values, use tostring or string.format before write. 5.8 - Operating System FacilitiesThis library is implemented through table os. os.clock ()Returns an approximation of the amount in seconds of CPU time used by the program. os.date ([format [, time]])Returns a string or a table containing date and time, formatted according to the given string format. If the time argument is present, this is the time to be formatted (see the os.time function for a description of this value). Otherwise, date formats the current time. If format starts with â€˜!â€™, then the date is formatted in Coordinated Universal Time. After this optional character, if format is the string â€œ*tâ€, then date returns a table with the following fields: year (four digits), month (1â€”12), day (1â€”31), hour (0â€”23), min (0â€”59), sec (0â€”61), wday (weekday, Sunday is 1), yday (day of the year), and isdst (daylight saving flag, a boolean). If format is not â€œ*tâ€, then date returns the date as a string, formatted according to the same rules as the C function strftime. When called without arguments, date returns a reasonable date and time representation that depends on the host system and on the current locale (that is, os.date() is equivalent to os.date(â€œ%câ€)). os.difftime (t2, t1)Returns the number of seconds from time t1 to time t2. In POSIX, Windows, and some other systems, this value is exactly t2-t1. os.execute ([command])This function is equivalent to the C function system. It passes command to be executed by an operating system shell. It returns a status code, which is system-dependent. If command is absent, then it returns nonzero if a shell is available and zero otherwise. os.exit ([code])Calls the C function exit, with an optional code, to terminate the host program. The default value for code is the success code. os.getenv (varname)Returns the value of the process environment variable varname, or nil if the variable is not defined. os.remove (filename)Deletes the file or directory with the given name. Directories must be empty to be removed. If this function fails, it returns nil, plus a string describing the error. os.rename (oldname, newname)Renames file or directory named oldname to newname. If this function fails, it returns nil, plus a string describing the error. os.setlocale (locale [, category])Sets the current locale of the program. locale is a string specifying a locale; category is an optional string describing which category to change: â€œallâ€, â€œcollateâ€, â€œctypeâ€, â€œmonetaryâ€, â€œnumericâ€, or â€œtimeâ€; the default category is â€œallâ€. The function returns the name of the new locale, or nil if the request cannot be honored. When called with nil as the first argument, this function only returns the name of the current locale for the given category. os.time ([table])Returns the current time when called without arguments, or a time representing the date and time specified by the given table. This table must have fields year, month, and day, and may have fields hour, min, sec, and isdst (for a description of these fields, see the os.date function). The returned value is a number, whose meaning depends on your system. In POSIX, Windows, and some other systems, this number counts the number of seconds since some given start time (the â€œepochâ€). In other systems, the meaning is not specified, and the number returned by time can be used only as an argument to date and difftime. os.tmpname ()Returns a string with a file name that can be used for a temporary file. The file must be explicitly opened before its use and explicitly removed when no longer needed. 5.9 - The Debug LibraryThis library provides the functionality of the debug interface to Lua programs. You should exert care when using this library. The functions provided here should be used exclusively for debugging and similar tasks, such as profiling. Please resist the temptation to use them as a usual programming tool: they can be very slow. Moreover, several of its functions violate some assumptions about Lua code (e.g., that variables local to a function cannot be accessed from outside or that userdata metatables cannot be changed by Lua code) and therefore can compromise otherwise secure code. All functions in this library are provided inside the debug table. All functions that operate over a thread have an optional first argument which is the thread to operate over. The default is always the current thread. debug.debug ()Enters an interactive mode with the user, running each string that the user enters. Using simple commands and other debug facilities, the user can inspect global and local variables, change their values, evaluate expressions, and so on. A line containing only the word cont finishes this function, so that the caller continues its execution. Note that commands for debug.debug are not lexically nested within any function, and so have no direct access to local variables. debug.getfenv (o)Returns the environment of object o.debug.gethook ([thread])Returns the current hook settings of the thread, as three values: the current hook function, the current hook mask, and the current hook count (as set by the debug.sethook function). debug.getinfo ([thread,] function [, what])Returns a table with information about a function. You can give the function directly, or you can give a number as the value of function, which means the function running at level function of the call stack of the given thread: level 0 is the current function (getinfo itself); level 1 is the function that called getinfo; and so on. If function is a number larger than the number of active functions, then getinfo returns nil. The returned table may contain all the fields returned by lua_getinfo, with the string what describing which fields to fill in. The default for what is to get all information available, except the table of valid lines. If present, the option â€˜fâ€™ adds a field named func with the function itself. If present, the option â€˜Lâ€™ adds a field named activelines with the table of valid lines. For instance, the expression debug.getinfo(1,â€nâ€).name returns a name of the current function, if a reasonable name can be found, and the expression debug.getinfo(print) returns a table with all available information about the print function. debug.getlocal ([thread,] level, local)This function returns the name and the value of the local variable with index local of the function at level level of the stack. (The first parameter or local variable has index 1, and so on, until the last active local variable.) The function returns nil if there is no local variable with the given index, and raises an error when called with a level out of range. (You can call debug.getinfo to check whether the level is valid.) Variable names starting with â€˜(â€˜ (open parentheses) represent internal variables (loop control variables, temporaries, and C function locals). debug.getmetatable (object)Returns the metatable of the given object or nil if it does not have a metatable. debug.getregistry ()Returns the registry table (see Â§3.5). debug.getupvalue (func, up)This function returns the name and the value of the upvalue with index up of the function func. The function returns nil if there is no upvalue with the given index. debug.setfenv (object, table)Sets the environment of the given object to the given table. Returns object. debug.sethook ([thread,] hook, mask [, count])Sets the given function as a hook. The string mask and the number count describe when the hook will be called. The string mask may have the following characters, with the given meaning: â€œcâ€: The hook is called every time Lua calls a function;â€œrâ€: The hook is called every time Lua returns from a function;â€œlâ€: The hook is called every time Lua enters a new line of code.With a count different from zero, the hook is called after every count instructions. When called without arguments, debug.sethook turns off the hook. When the hook is called, its first parameter is a string describing the event that has triggered its call: â€œcallâ€, â€œreturnâ€ (or â€œtail returnâ€), â€œlineâ€, and â€œcountâ€. For line events, the hook also gets the new line number as its second parameter. Inside a hook, you can call getinfo with level 2 to get more information about the running function (level 0 is the getinfo function, and level 1 is the hook function), unless the event is â€œtail returnâ€. In this case, Lua is only simulating the return, and a call to getinfo will return invalid data. debug.setlocal ([thread,] level, local, value)This function assigns the value value to the local variable with index local of the function at level level of the stack. The function returns nil if there is no local variable with the given index, and raises an error when called with a level out of range. (You can call getinfo to check whether the level is valid.) Otherwise, it returns the name of the local variable. debug.setmetatable (object, table)Sets the metatable for the given object to the given table (which can be nil). debug.setupvalue (func, up, value)This function assigns the value value to the upvalue with index up of the function func. The function returns nil if there is no upvalue with the given index. Otherwise, it returns the name of the upvalue. debug.traceback ([thread,] [message] [, level])Returns a string with a traceback of the call stack. An optional message string is appended at the beginning of the traceback. An optional level number tells at which level to start the traceback (default is 1, the function calling traceback). 6 - Lua Stand-aloneAlthough Lua has been designed as an extension language, to be embedded in a host C program, it is also frequently used as a stand-alone language. An interpreter for Lua as a stand-alone language, called simply lua, is provided with the standard distribution. The stand-alone interpreter includes all standard libraries, including the debug library. Its usage is: lua [options] [script [args]] The options are: -e stat: executes string stat;-l mod: â€œrequiresâ€ mod;-i: enters interactive mode after running script;-v: prints version information;â€”: stops handling options;-: executes stdin as a file and stops handling options.After handling its options, lua runs the given script, passing to it the given args as string arguments. When called without arguments, lua behaves as lua -v -i when the standard input (stdin) is a terminal, and as lua - otherwise. Before running any argument, the interpreter checks for an environment variable LUA_INIT. If its format is @filename, then lua executes the file. Otherwise, lua executes the string itself. All options are handled in order, except -i. For instance, an invocation like $ lua -e&#39;a=1&#39; -e &#39;print(a)&#39; script.lua will first set a to 1, then print the value of a (which is â€˜1â€™), and finally run the file script.lua with no arguments. (Here $ is the shell prompt. Your prompt may be different.) Before starting to run the script, lua collects all arguments in the command line in a global table called arg. The script name is stored at index 0, the first argument after the script name goes to index 1, and so on. Any arguments before the script name (that is, the interpreter name plus the options) go to negative indices. For instance, in the call $ lua -la b.lua t1 t2 the interpreter first runs the file a.lua, then creates a table arg = { [-2] = &quot;lua&quot;, [-1] = &quot;-la&quot;, [0] = &quot;b.lua&quot;, [1] = &quot;t1&quot;, [2] = &quot;t2&quot; } and finally runs the file b.lua. The script is called with arg[1], arg[2], Â·Â·Â· as arguments; it can also access these arguments with the vararg expression â€˜â€¦â€™. In interactive mode, if you write an incomplete statement, the interpreter waits for its completion by issuing a different prompt. If the global variable _PROMPT contains a string, then its value is used as the prompt. Similarly, if the global variable _PROMPT2 contains a string, its value is used as the secondary prompt (issued during incomplete statements). Therefore, both prompts can be changed directly on the command line. For instance, $ lua -e&quot;_PROMPT=&#39;myprompt&gt; &#39;&quot; -i (the outer pair of quotes is for the shell, the inner pair is for Lua), or in any Lua programs by assigning to _PROMPT. Note the use of -i to enter interactive mode; otherwise, the program would just end silently right after the assignment to _PROMPT. To allow the use of Lua as a script interpreter in Unix systems, the stand-alone interpreter skips the first line of a chunk if it starts with #. Therefore, Lua scripts can be made into executable programs by using chmod +x and the #! form, as in #!/usr/local/bin/lua (Of course, the location of the Lua interpreter may be different in your machine. If lua is in your PATH, then #!/usr/bin/env lua is a more portable solution.) 7 - Incompatibilities with the Previous VersionHere we list the incompatibilities that you may found when moving a program from Lua 5.0 to Lua 5.1. You can avoid most of the incompatibilities compiling Lua with appropriate options (see file luaconf.h). However, all these compatibility options will be removed in the next version of Lua. 7.1 - Changes in the LanguageThe vararg system changed from the pseudo-argument arg with a table with the extra arguments to the vararg expression. (See compile-time option LUA_COMPAT_VARARG in luaconf.h.)There was a subtle change in the scope of the implicit variables of the for statement and for the repeat statement.The long string/long comment syntax ([[string]]) does not allow nesting. You can use the new syntax ([=[string]=]) in these cases. (See compile-time option LUA_COMPAT_LSTR in luaconf.h.)7.2 - Changes in the LibrariesFunction string.gfind was renamed string.gmatch. (See compile-time option LUA_COMPAT_GFIND in luaconf.h.)When string.gsub is called with a function as its third argument, whenever this function returns nil or false the replacement string is the whole match, instead of the empty string.Function table.setn was deprecated. Function table.getn corresponds to the new length operator (#); use the operator instead of the function. (See compile-time option LUA_COMPAT_GETN in luaconf.h.)Function loadlib was renamed package.loadlib. (See compile-time option LUA_COMPAT_LOADLIB in luaconf.h.)Function math.mod was renamed math.fmod. (See compile-time option LUA_COMPAT_MOD in luaconf.h.)Functions table.foreach and table.foreachi are deprecated. You can use a for loop with pairs or ipairs instead.There were substantial changes in function require due to the new module system. However, the new behavior is mostly compatible with the old, but require gets the path from package.path instead of from LUA_PATH.Function collectgarbage has different arguments. Function gcinfo is deprecated; use collectgarbage(â€œcountâ€) instead.7.3 - Changes in the APIThe luaopen_* functions (to open libraries) cannot be called directly, like a regular C function. They must be called through Lua, like a Lua function.Function lua_open was replaced by lua_newstate to allow the user to set a memory-allocation function. You can use luaL_newstate from the standard library to create a state with a standard allocation function (based on realloc).Functions luaL_getn and luaL_setn (from the auxiliary library) are deprecated. Use lua_objlen instead of luaL_getn and nothing instead of luaL_setn.Function luaL_openlib was replaced by luaL_register.Function luaL_checkudata now throws an error when the given value is not a userdata of the expected type. (In Lua 5.0 it returned NULL.)8 - The Complete Syntax of LuaHere is the complete syntax of Lua in extended BNF. (It does not describe operator precedences.) chunk ::= {stat [`;Â´]} [laststat [`;Â´]] block ::= chunk stat ::= varlist1 `=Â´ explist1 | functioncall | do block end | while exp do block end | repeat block until exp | if exp then block {elseif exp then block} [else block] end | for Name `=Â´ exp `,Â´ exp [`,Â´ exp] do block end | for namelist in explist1 do block end | function funcname funcbody | local function Name funcbody | local namelist [`=Â´ explist1] laststat ::= return [explist1] | break funcname ::= Name {`.Â´ Name} [`:Â´ Name] varlist1 ::= var {`,Â´ var} var ::= Name | prefixexp `[Â´ exp `]Â´ | prefixexp `.Â´ Name namelist ::= Name {`,Â´ Name} explist1 ::= {exp `,Â´} exp exp ::= nil | false | true | Number | String | `...Â´ | function | prefixexp | tableconstructor | exp binop exp | unop exp prefixexp ::= var | functioncall | `(Â´ exp `)Â´ functioncall ::= prefixexp args | prefixexp `:Â´ Name args args ::= `(Â´ [explist1] `)Â´ | tableconstructor | String function ::= function funcbody funcbody ::= `(Â´ [parlist1] `)Â´ block end parlist1 ::= namelist [`,Â´ `...Â´] | `...Â´ tableconstructor ::= `{Â´ [fieldlist] `}Â´ fieldlist ::= field {fieldsep field} [fieldsep] field ::= `[Â´ exp `]Â´ `=Â´ exp | Name `=Â´ exp | exp fieldsep ::= `,Â´ | `;Â´ binop ::= `+Â´ | `-Â´ | `*Â´ | `/Â´ | `^Â´ | `%Â´ | `..Â´ | `&lt;Â´ | `&lt;=Â´ | `&gt;Â´ | `&gt;=Â´ | `==Â´ | `~=Â´ | and | or unop ::= `-Â´ | not | `#Â´]]></content>
      <categories>
        <category>Lua</category>
      </categories>
      <tags>
        <tag>Lua</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰‘ç½‘3å£è¢‹ç‰ˆç¬”è®°]]></title>
    <url>%2F2019%2F05%2F23%2Fjx3m%2F</url>
    <content type="text"><![CDATA[Unityç‰ˆæœ¬2018.32Dåœºæ™¯ï¼Œ3Dæ¨¡å‹ï¼Œç¡®å®æœ‰ç‚¹æƒŠå–œï¼Œåœºæ™¯é‡Œé¢çš„ä¸œè¥¿çœ‹åˆ°çš„åŸºæœ¬éƒ½æ˜¯ç”¨ç‰‡åšçš„ã€‚é‚£ä¹ˆå®šä½å°±åº”è¯¥åå‘æ ¼æ–—äº†ï¼Œå¯èƒ½æ˜¯å¸§åŒæ­¥å§ã€‚ ä»¥ä¸‹åŸºæœ¬æ˜¯é™æ€åˆ†æç»“æœã€‚ å¯åŠ¨æµç¨‹startåœºæ™¯æŒ‚äº†ä¸¤ä¸ªèŠ‚ç‚¹ä¸€ä¸ªæ˜¯Startåœ¨ä¸Šé¢ä¸‹æŒ‚äº†ä¸€ä¸ªGameStartè„šæœ¬ï¼Œä½œä¸ºå¯åŠ¨è„šæœ¬ï¼Œå¦ä¸€ä¸ªæ˜¯Cameraæ²¡ä»€ä¹ˆå¿…è¦ã€‚GameStartåœ¨Startå‡½æ•°è°ƒç”¨RuntimeCoroutineTracker.InvokeStart(this, HelperUtil.Steper(30, Initialize(), Sleep));å°è£…åç¨‹çš„ç›®çš„æ˜¯æŠ“å¸§ç”¨çš„ã€‚HelperUtil.Steperé—´éš”æ‰§è¡Œã€‚åœ¨Initializeä¸­åˆå§‹åŒ–é€»è¾‘ï¼Œå…¶ä¸­yield return Lifecycle.GameModuleMgr.InitCoroutine(0, RefreshProgress);åŠ è½½æ¸¸æˆæ¨¡å—ã€‚åœ¨åˆ°GameModuleçš„InitCoroutineä¸­æ‰§è¡ŒInitã€‚è¯´å®åœ¨çš„OOPè¿™ä¸€å¥—çœ‹ä»£ç çœ‹çš„ç¡®å®å¾ˆçƒ¦ã€‚ç„¶åçœ‹ä¸€ä¸‹GameMoudleæœ‰å“ªäº› AccountModule AchievementManager AngleFilterDataModule AngleFilterManager ArenaModule BarrageManager BattlegroundModule BrokenManager CameraManagerController CameraMotionPathManager ChallengeModule CharacterVoceManager CharManager SceneLoad MidasManager PVEModule Lua å¥½äº†ç”±äºå¤ªå¤šäº†å°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚è™½ç„¶éƒ½æ˜¯Moduleä½†æ˜¯ä¼šæ¶µç›–å…·ä½“ç©æ³•å’Œä¸€äº›å…¬å…±ç»„ä»¶ã€‚è®©äººçœ‹èµ·æ¥å¾ˆè¿·ï¼Œç”šè‡³è®¤ä¸ºæœ‰çš„ä»£ç çœŸçš„ä¼šç”¨åˆ°çš„æ„Ÿè§‰å—ã€‚è¿™é‡Œæˆ‘ä»¬é‡ç‚¹åˆ†æLuaã€‚åœ¨Lua.OnInitä¸­ï¼Œè°ƒç”¨luasvr = new LuaSvr();è¿™é‡Œé¢ä¼šç”Ÿæˆä¸€ä¸ªLuaSvrProxyè¿™ä¸ªGameObjectï¼Œç„¶ååœ¨å®ƒçš„Updateä¸­å¤„ç†timeç­‰çš„tickäº‹ä»¶ã€‚åŠ è½½äº†ä¸€ä¸ªè°ƒç”¨DoFile(UIDef.LuaScriptPath);å…¶ä¸­UIDef.LuaScriptPath = â€œLua/PreLoadList.luaâ€;è¿™å—è¿›è¡Œäº†é¢„åŠ è½½Luaè„šæœ¬ã€‚ Lualuaä½¿ç”¨çš„sluaã€‚é¦–å…ˆæˆ‘ä¸æ˜¯å¼•æˆ˜ï¼Œæˆ‘åªæ˜¯æƒ³å¤§å®¶æœ‰è‡ªå·±æ¸…æ™°çš„è®¤è¯†sluaåˆ°åº•å¥½ä¸å¥½ã€‚å¥½äº†ï¼Œè¿™é‡Œæ˜¯uluaçš„å®˜ç½‘ï¼Œå¤§å®¶å¯ä»¥å»çœ‹ä¸€ä¸‹ã€‚http://www.ulua.org/cstolua.htmlæˆ‘ä»¬çœ‹ä¸€ä¸ªaddMemberå‡½æ•°12345678910111213141516171819202122public static void addMember(IntPtr l, string name, LuaCSFunction get, LuaCSFunction set, bool instance)&#123; checkMethodValid(get); checkMethodValid(set); int t = instance ? -2 : -3; LuaDll.lua_createtable(l, 2, 0); if (get == null) LuaDLL.lua_pushnil(l); else pushValue(l, get); LuaDll.lua_rawseti(l, -2, 1); if (set == null) LuaDLL.lua_pushnil(l); else pushValue(l, set); LuaDLL.lua_rawseti(l, -2, 2); // t[n]=v,næ˜¯2ï¼Œvæ˜¯-2å‡ºçš„å€¼ï¼Œluaæ˜¯æ ˆå­˜å‚¨ç»“æ„ï¼Œæ ˆç´¢å¼•å€¼è¶Šå°ï¼Œè¯´æ˜è¶Šæ—©å‹æ ˆ LuaDll.lua_setfield(l, t, name); // t[name]=v&#125; å…¶ä»–æ³¨å†Œæ–¹å¼ç±»ä¼¼ã€‚ç„¶åsluaå¯¹äºç”¨æˆ·æ„Ÿè§‰æ˜¯é€æ˜çš„ï¼Œç„¶åæ¯ä¸ªæ³¨å†Œä¹‹åéƒ½è¦è¿”å›ä¸¤ä¸ªå‚æ•°ï¼Œå¤§éƒ¨åˆ†æ¥è¯´ã€‚ç”Ÿæˆçš„csæ–‡ä»¶å®Œå…¨æ˜¯è°ƒç”¨å¦ä¸€ä¸ªæ–‡ä»¶çš„å‡½æ•°ã€‚è¿™ç§åŠ ä¸€å±‚çš„åŒ…è£…çœŸå¥½çš„å¥½å—ï¼Œéš¾é“ç”¨æˆ·ä¸éœ€è¦çŸ¥é“é‡Œé¢çš„ä¸œè¥¿å—ï¼Ÿï¼ˆPSï¼šä¸ªäººæ„Ÿå—ï¼Œsluaè¿™ç§warpçš„æ–¹å¼çœŸçš„å¥½éš¾å—ï¼‰ï¼Œå¥½å§ï¼Œè‡ªåŠ¨åŒ–çš„æ³¨å†Œç¡®å®è·Ÿä¸è¦é’±ä¸€æ ·ã€‚ æ¨¡å—è¿™é‡Œçš„æ¨¡å—æ˜¯è‡ªå®šä¹‰çš„ï¼Œè€Œä¸æ˜¯æ ¹æ®é…ç½®è¯»å–çš„ï¼Œå…¶å®ä¹Ÿæ— å¯åšéï¼Œåªä¸è¿‡ä¼šå¢åŠ äº†ä¸€äº›ä»£ç é‡ï¼Œè¿™é‡Œçš„ä»£ç é‡ä»…ä»…æŒ‡æ¨¡å—åç§°ã€‚æ¯”å¦‚UILoadHelper.SpawdPrefabFromPoolï¼Œåœ¨è¿™é‡ŒUILoadHelperè¢«æˆ‘ä»¬ä¹ æƒ¯ç§°ä¸ºæ¨¡å—ã€‚ AssetBundleå¥½å§ï¼Œè¿™å—çœŸçš„æ˜¯å¼‚å¸¸ç—›è‹¦çš„ï¼Œä»¥è‡³äºæˆ‘F12äº†å¥½åŠå¤©ï¼Œæ‰çœ‹åˆ°ä¸€ä¸ªUnityEngine.AssetBundle.LoadFromFile(path);åœ¨ResourcesHook.csä¸­æœ‰ä¸¤ä¸ªæ¥å£1234567891011121314public static UnityEngine.AssetBundle LoadFromFile(string path)&#123; ResourceLoadProfiler.Begin(); UnityEngine.AssetBundle ret = UnityEngine.AssetBundle.LoadFromFile(path); ResourceLoadProfiler.End("AssetBundle.LoadFromFile", path, null); return ret;&#125;public static AssetBundleCreateRequest LoadFromFileAsync(string path)&#123; AssetBundleCreateRequest ret = UnityEngine.AssetBundle.LoadFromFileAsync(path); ResourceLoadProfiler.AddAsyncRequest(ret, "AssetBundle.LoadFromAsync", path, null); return ret;&#125; UIå¼€å‘æ¨¡å¼å±äºMVæ¨¡å¼ã€‚ ç›®å½•ç»“æ„NGUI + sluaUIè„šæœ¬ç›®å½• Assets/StreamingAssets/Luaæ•°æ®æ§åˆ¶é€»è¾‘åœ¨LogicDataç›®å½•ä¸‹ CommonTimer.luaHelperUIHelper.luaAddTimer123456function UIHelper.AddTimer(script, nTime, func) local nid = Timer:Add(nTime, func) script._tbUnscaledTime = script._tbUnscaledTimer or &#123;&#125; script._tbUnscaledTime[nId] = func return nIdend 123456789101112131415161718192021-- æŒ‰é’®æ³¨å†Œäº‹ä»¶function UIHelper.BindUIEvent(go, szEvent, func, tbParam, nIntervals) if not go or not szEvent or not func then return end local listenter = UIEventLister.Get(go.gameObject) if tbParam ~= nil and type(tbParam) == "table" then listener.paramter = tbParam end if nInterval ~= nil then UIClickIntervalsController.Instance:RegisterInterval(go.gameObject, nIntervals) end if szEvent == UI_EVENT.onClick then listener.onClick = func elseif then elseif then elseif then else LOG.ERROR("æœªçŸ¥çš„æŒ‰é’®äº‹ä»¶ç±»å‹&#123;0&#125;", szEvent) endend UILoadHelper.luaLoadPrefabHandleAsync123456789101112131415161718192021222324-- å¼‚æ­¥åŠ è½½é¢„åˆ¶ä½“æ¥å£function UILoadHelper.LoadPrefabHandleAsync(script, nID, parent, szRename, nPostNameID, ...) if not script or not nID or not parent then LOG.ERROR("UILoadHelper.LoadPrefabHandleAsync param exception") return end nPostNameID = nPostNameID or -1 local handle = Lua2CS.LoadPrefabHandleAsync(nID, parent, transform, szRename, nPostNameID, ...) if not handle then LOG.ERROR("UILoadHelper.LoadPrefabHandleAsync Don't Get handle") return end if not script.tbPrefabHandle then script.tbPrefabHandle = &#123;&#125; end script.tbPrefabHandle[handle.nHandleId] = handle return handleend LoadImg(img, nID, bMakePerfect)â€”- åŠ è½½å›¾ç‰‡(UISprite, UITexture)12345function UILoadHelper.LoadImg(img, nID, bMakePerfect) if not img or not nID then LOG.ERROR("UILoadHelper.LoadImg ä¼ å…¥ç©ºå‚æ•°") return end bMakePerfect = bMakePerfect or false Lua2CS.LoadImg(img, nID, UIImgUsageType.MainTexture, true, bMakePerfect)end UINavigateHelper.lua1234567891011121314151617--- æ‰“å¼€æ–°ç•Œé¢ï¼ˆå¼‚æ­¥ï¼‰function UINavigateHelper.NavigateViewAsync(nViewID,...) if UIViewOpenSequenceManager.AddView(nViewID, false, true, ...) then return end local shell = UINavigationManager.Instance:NavigateView(nViewID, false, true, ...) -- æ³¨å†Œå¼‚æ­¥æ¶ˆæ¯ç®¡ç† if shell and not shell.IsViewLoad then local config = UIAsyncMsgTab[nViewID] if config then local msgAsyncHolder = UIAsyncMsgHelper.RegisterMsgAysnc(config) shell.AsyncMsg = msgAsyncHolder end end return shellend è¡¨æ ¼æ–‡ä»¶è¡¨æ ¼è·¯å¾„ï¼šAssets/JX3Game/Source/File/UIè½¬æ¢æˆluaæ–‡ä»¶æ–¹æ³•ï¼š123456789101112131415161718192021[MenuItem("Tools/Excel to Lua/Export")]public static void ExcelToLua()&#123; Lua.ExcelToLua();&#125;public static void ExcelToLua()&#123; try &#123; System.Diagnostics.Process pro = new System.Diagnostics.Process(); pro.StartInfo.WorkingDirectory = Application.dataPath + "/JX3Game/Source/File/ToLuaTool/"; pro.StartInfo.FileName = Application.dataPath + "/JX3Game/Source/File/ToLuaTool/run.bat"; pro.StartInfo.UseShellExecute = true; pro.Start(); pro.WaitForExit(); &#125; catch(System.Exception) &#123; &#125;&#125; æ³¨æ„ï¼šå¦‚æœä½ çœ‹æºç çš„æ—¶å€™å‘ç°ç”Ÿæˆçš„æ–‡ä»¶å·¥ç¨‹ä¸­çš„æ–‡ä»¶ä¸ä¸€è‡´ï¼Œæ¯”å¦‚æˆ‘çœ‹UICardTab.luaçš„æ—¶å€™ï¼Œå°±å‘ç°ç¼ºå°‘ç¬¬ä¸€å¥æ³¨é‡Šï¼Œç„¶åæˆ‘å°è¯•ç”Ÿæˆäº†ä»¥ä¸‹ï¼Œæ³¨é‡Šå°±åŠ ä¸Šäº†ã€‚åŸç†ï¼šå…¶å®æ˜¯æŠŠè¡¨æ ¼æ–‡ä»¶è½¬æˆluaæ–‡ä»¶äº†ï¼Œå¯»ä»™çš„æ—¶å€™åœ¨åœ¨çº¿è½¬çš„ï¼Œè¿™é‡Œæ˜¯ç¦»çº¿è½¬çš„ã€‚å¯¹æ¯”ï¼šæ¯”å¦‚ UIAchieveLabelTab.xlsï¼ˆå…¶å®æ˜¯ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œè¿™å—è®©äººåˆšå¼€å§‹æœ‰ç‚¹é›¾æ°´ï¼‰å¤§å°æ˜¯12KBï¼Œè€Œç”Ÿæˆçš„UIAchieveLabelTab.luaå´å 105KBã€‚ç¼ºç‚¹æ˜¯ä¼šè®©åŒ…ä½“å¢å¤§ï¼Œé‚£ä¹ˆå¸¦æ¥ä¸€ç³»åˆ—çš„åå¤„å°±æ˜¯åŠ è½½è¿™å—çš„é—®é¢˜ã€‚è€Œå¦‚æœåœ¨çº¿è½¬çš„é—®é¢˜æ˜¯åœ¨è½¬çš„è¿™å—è¦åšå¥½ä¼˜åŒ–ã€‚ä¸ªäººæ›´å–œæ¬¢åœ¨çº¿è½¬ã€‚äº‹å®ä¸Šå¸¸è§çš„ä¹Ÿæ˜¯åœ¨çº¿è½¬ã€‚ UIPrefabç»‘å®šLua è¿™ä¸ªä¸œè¥¿å¾ˆå‘çš„ï¼Œä¸€èˆ¬æ¥è¯´æˆ‘ä»¬çš„é€‰æ‹©å™¨éƒ½æ˜¯æŠŠæ‰€æœ‰èŠ‚ç‚¹ç½—åˆ—å‡ºæ¥ï¼Œç„¶åä¾›ä½ é€‰æ‹©ï¼Œè€Œè¿™é‡Œçš„æ˜¯è¦ä½ è¾“å…¥æ–‡ä»¶åç„¶åè¿›è¡ŒåŒ¹é…ã€‚ã€‚ã€‚æ˜¯èŠ‚çœæ€§èƒ½å—ï¼Ÿäº¤äº’åšå¥½çš„UIï¼Œç„¶åæˆ‘ä»¬è¿™è¾¹ç»‘ä¸ŠLuaBindè„šæœ¬ï¼Œå¥½å§ï¼Œè¦æ³¨æ„ï¼Œåºåˆ—åŒ–è¿™ä»¶äº‹æƒ…ï¼Œå³æ²¡æœ‰ç”¨çš„å˜é‡å°±ä¸è¦ç»‘å®šäº†ã€‚Unityåºåˆ—åŒ–ç»™äººæ„Ÿè§‰è¿˜æ˜¯ä¸å¤ªå‹å¥½ï¼Œå°¤å…¶æ˜¯Prefabçš„åºåˆ—åŒ–ã€‚ç»‘å®šå®Œä¹‹åç‚¹å‡»ç”Ÿæˆå¤´éƒ¨æ£€æµ‹å‡½æ•°ï¼Œå¦‚ä¸‹å›¾ï¼š ç‚¹å‡»ç”Ÿæˆå¤´éƒ¨æ£€æµ‹å¯ä»¥å°†ç»‘å®šçš„å˜é‡è¾“å‡ºåˆ°æ§åˆ¶å°ä¸Šï¼Œç„¶åæˆ‘ä»¬å°†è¾“å…¥çš„æ—¥å¿—è‡ªå·±æ‹·è´ç²˜è´´åˆ°luaæ–‡ä»¶ä¸­ã€‚å¥½å§ï¼Œè¿™é‡Œæˆ‘å¯ä»¥è¯´å¥½å‘çš„å—ï¼Œæˆ‘ä»¬åšäº†é‚£ä¹ˆå¤šè‡ªåŠ¨åŒ–çš„å·¥å…·ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œå´æ˜¯è¦è‡ªå·±æŠŠæ—¥å¿—æ‰‹åŠ¨ç²˜è´´åˆ°Luaæ–‡ä»¶ä¸­çš„å‘¢ï¼Ÿç„¶åè¿˜æœ‰åˆ·æ–°æŒ‰é’®ï¼Œå½“æˆ‘ä»¬ç‚¹å‡»åˆ·æ–°çš„æ—¶å€™ï¼Œä¼šé‡æ–°æ£€æµ‹æ–‡ä»¶ä¸­ç»‘å®šæ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™æ‰å¯ä»¥è¿›è¡Œåˆ é™¤æ“ä½œã€‚å¥½å§ï¼Œè¿™æ ·çš„ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢å®‰å…¨ï¼Œä½†æ˜¯è¿™äº›åäººç±»è®¾è®¡çœŸçš„è¦åæ§½ã€‚ç»§ç»­åæ§½ï¼Œç»‘å®šå˜é‡æ•°ç»„ä¸èƒ½åœ¨æ•°ç»„å…ƒç´ ä¸­æ’å…¥å—ï¼Ÿ Luaè„šæœ¬æ˜¯å¦‚ä½•ç”Ÿæˆçš„å‘¢ï¼Ÿ æˆ‘ä»¬æ³¨æ„åˆ°åœ¨Editorç›®å½•ä¸‹æœ‰ä¸€ä¸ªLuaTemplate.luaæ¨¡æ¿æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶é€šè¿‡LuaFileCreator.csä¸­çš„12345[MenuItem("Assets/Create/Lua Script", false, 80)]public static void CreateNewLua()&#123; ProjectWindowUtil.StartNameEditingIfProjectWindowExists(0, ScriptableObject.CreateInstance&lt;CreateScriptAsset&gt;(), GetSelectedPathOrFallback() + "/New Lua.lua", null, "Assets/Editor/LuaTemplate.lua");&#125; è¿™é‡Œå¼€å‘çš„åŒå­¦åº”è¯¥è¦æ³¨æ„ï¼Œç”Ÿæˆçš„æ¨¡æ¿æ–‡ä»¶å¦‚æœæˆ‘ä»¬ä¸éœ€è¦çš„æ—¶å€™ï¼Œéœ€è¦æŠŠå®ƒå¹²æ‰ï¼ç±»ä¼¼çš„åšæ³•åœ¨C#çš„MonoBehaviourè„šæœ¬ä¹Ÿé€‚ç”¨ã€‚ å­—ä½“å­—ä½“ä½¿ç”¨çš„åŠ¨æ€å­—ä½“ã€‚è¡¨ç°æ•ˆæœå¥½ï¼Œä½†æ˜¯CPUï¼Œå†…å­˜å ç”¨å¤§ã€‚ä¸è¿‡è¿™ä¸ªä¹Ÿåœ¨æƒ…ç†ä¹‹ä¸­ï¼Œè€Œä¸”ä¹Ÿæ˜¯å¾ˆå¸¸è§çš„åšæ³•ã€‚ å›¾é›†å›¾é›†å¯èƒ½ä¸æ˜¯ä½¿ç”¨Texturepackerï¼Œä½†æ˜¯éƒ½æ˜¯2çš„å¹‚æ¬¡æ–¹ï¼Œåº”è¯¥æ˜¯è¦æ ¹æ®ä¸åŒè®¾å¤‡è¿›è¡Œå‹ç¼©çš„ã€‚åœ¨ç¼–è¾‘å™¨ä¸‹è§‚å¯Ÿï¼Œåº”è¯¥éƒ½æ˜¯å¸¦alphaé€šé“çš„ï¼Œé‚£ä¹ˆè¿™å—å…¶å®æ˜¯å¯ä»¥ä¼˜åŒ–çš„ã€‚æ¯”å¦‚å°†rgbå’Œré€šé“åˆ†ç¦»ã€‚ä¹‹å‰æ½˜å¤šæ‹‰å°±æ˜¯è¿™æ ·çš„åšæ³•ï¼Œè¿™æ ·å…¶å®å’Œetc2çš„å·®åˆ«ä¸æ˜¯å¾ˆå¤§ï¼Œä½†æ˜¯å’ŒRGB32çš„å·®åˆ«è¿˜æ˜¯è‚‰çœ¼å¯è§çš„ã€‚å¥½å§ï¼Œæµªè´¹è¿˜æ˜¯è›®ä¸¥é‡çš„ã€‚ è‰ºæœ¯å­—çœ‹ç€åƒæ˜¯æŒ‰ç…§é™æ€å­—ä½“çš„æ–¹å¼åˆ¶ä½œçš„ã€‚]]></content>
      <categories>
        <category>å‰‘ç½‘3å£è¢‹ç‰ˆ</category>
      </categories>
      <tags>
        <tag>å‰‘ç½‘3å£è¢‹ç‰ˆ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SpritePacker]]></title>
    <url>%2F2019%2F05%2F22%2Fspritepacker%2F</url>
    <content type="text"><![CDATA[Version:2018.3 NGUIå›¾é›†å’ŒUGUIå›¾é›†çš„åŒºåˆ«NGUIæ˜¯å¿…é¡»å…ˆæ‰“å‡ºå›¾é›†ç„¶åæ‰èƒ½å¼€å§‹åšç•Œé¢ï¼Œè¿™ä¸€ç‚¹å¾ˆçƒ¦ï¼Œå› ä¸ºå§‹ç»ˆéƒ½è¦è€ƒè™‘ä½ çš„UIå›¾é›†ã€‚æ¯”å¦‚å›¾é›†ä¼šä¸ä¼šè¶…è¿‡1024ï¼Œå›¾é›†è¯¥å¦‚ä½•è§„åˆ’ç­‰ã€‚è€ŒUGUIçš„åŸç†åˆ™æ˜¯ï¼Œè®©å¼€å‘è€…ä¸è¦å»å…³å¿ƒè‡ªå·±çš„å›¾é›†ã€‚åšç•Œé¢çš„æ—¶å€™åªç”¨å°å›¾ï¼Œè€Œæœ€ç»ˆæ‰“åŒ…çš„æ—¶å€™Unityæ‰ä¼šæŠŠä½ çš„å°å›¾åˆå¹¶åœ¨ä¸€å¼ å¤§çš„å›¾é›†é‡Œé¢ï¼Œç„¶è€Œè¿™ä¸€åˆ‡éƒ½æ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œå¼€å‘è€…ä¸éœ€è¦å»careå®ƒã€‚ å¯ç”¨åœ¨Edit-&gt;Project Settings-&gt;Editor-&gt;Sprite Packer-&gt;Modeä¸­è¿›è¡Œè®¾ç½® Disabled: ä¸å¯ç”¨ Enabled For Builds(Legacy Sprite Packer):æ‰“åŒ…çš„æ—¶å€™ä½¿ç”¨ï¼Œè¿‡æ—¶çš„ Always Enabled(Legacy Sprite Packer):æ€»æ˜¯å¼€å¯ï¼Œè¿‡æ—¶äº† Enabled For Builds: æ‰“åŒ…çš„æ—¶å€™ä½¿ç”¨ Always Enabled: æ€»æ˜¯ä½¿ç”¨ï¼Œæ¨èæ–¹å¼å¼€å§‹çš„æ—¶å€™æˆ‘ä»¬éœ€è¦æ¸…æ¥šçœ‹åˆ°ç°åœ¨çš„æœ‰å‡ ä¸ªDraw Callï¼Œä»è€Œæ‰èƒ½ä¼˜åŒ–å°å›¾ã€‚åœ¨æœ€ç»ˆæ‰“åŒ…çš„æ—¶å€™Unityä¼šè‡ªåŠ¨æ„å»ºå¤§çš„å›¾é›†ï¼Œå°†åŒä¸€å›¾é›†çš„æ‰€æœ‰å›¾ç‰‡çš„packing tagè®¾ç½®æˆä¸€ä¸ªåå­—å°±å¯ä»¥çœ‹åˆ°è¿™ä¸ªå›¾é›†å å‡ ä¸ªDraw Calläº†ã€‚ å›¾é›†çš„é¢„è§ˆä»…ä»…æ˜¯è®©ä½ çœ‹çœ‹ä½ çš„å›¾é›†å¤§æ¦‚é•¿ä»€ä¹ˆæ ·å­ã€‚å›¾é›†ä¿å­˜åœ¨Libary/AtlasCacheé‡Œé¢ã€‚Window-&gt;2D-&gt;Sprite Packeræ­¤æ—¶åœ¨Hierarchyè¯•å›¾ä¸­åˆ›å»ºä¸¤ä¸ªImageå¯¹è±¡ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å‘ç°æ­¤æ—¶Draw Callså˜æˆäº†1ã€‚æ³¨æ„ä½ çš„å›¾ç‰‡ä¸èƒ½æ”¾åœ¨Resourcesæ–‡ä»¶å¤¹ä¸‹é¢ï¼ŒResourcesæ–‡ä»¶å¤¹ä¸‹çš„èµ„æºå°†ä¸ä¼šè¢«æ‰“å…¥å›¾é›†ã€‚æ­¤æ—¶åœ¨Hierarchyè¯•å›¾ä¸­åˆ›å»ºä¸¤ä¸ªImageå¯¹è±¡ã€‚å¯ä»¥å‘ç°Draw Callå·²ç»è¢«åˆå¹¶æˆ1äº†ã€‚ 1[MenuItem("Build AssetBundle")]]]></content>
      <categories>
        <category>UGUI</category>
      </categories>
      <tags>
        <tag>UGUI</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AssetsStudio]]></title>
    <url>%2F2019%2F05%2F22%2Fassetstudio%2F</url>
    <content type="text"><![CDATA[AssetsStudio url: https://github.com/Perfare/AssetStudio.gitAssetsStudio Release url: https://ci.appveyor.com/project/Perfare/assetstudio/branch/master/artifactsfbx url: https://github.com/arturoc/ofxFBX.git]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç”Ÿæ­»ç•Œ]]></title>
    <url>%2F2019%2F05%2F14%2Ffiction-2-1%2F</url>
    <content type="text"><![CDATA[å½“èŠ©é†’æ¥çš„æ—¶å€™ï¼Œå‘ç°å‘¨å›´çš„ç¯å¢ƒä»–å·²ç»ä¸è®¤è¯†äº†ï¼Œè„‘è¢‹æœ‰ç‚¹æ˜æ˜æ²‰æ²‰çš„ï¼Œåƒæ˜¯ç¡äº†å¥½ä¹…ã€‚å¾ˆå¥‡æ€ªï¼Œæ²¡æœ‰é˜³å…‰ï¼Œå¤©ç©ºæ˜¯é»‘è‰²çš„ï¼Œä»€ä¹ˆä¹Ÿçœ‹ä¸è§ï¼Œä½†æ˜¯å‘¨å›´çš„ç¯å¢ƒå´çœ‹åˆ°ä¸€æ¸…äºŒæ¥šã€‚è¿™æ—¶ï¼Œä»è¿œå¤„èµ°æ¥äº†ä¸€ä¸ªç”·å­ï¼Œèº«ç©¿é»‘è‰²é•¿è¢ï¼Œæ‰‹é‡Œæ‹¿ç€ä¸€æœ¬ä¸çŸ¥é“æ˜¯ä¹¦è¿˜æ˜¯è®°äº‹ç°¿çš„ä¸œè¥¿ï¼Œèµ°è¿‡æ¥å¯¹èŠ©è¯´ï¼Œâ€œèµ°å§ã€‚â€ã€‚â€œå»å“ªé‡Œï¼Ÿâ€ï¼ŒèŠ©é—®é“ã€‚â€œè‡ªç„¶æ˜¯å»ä½ è¯¥å»çš„åœ°æ–¹ã€‚â€ï¼Œé»‘è¡£ç”·å­è¯´é“ã€‚â€œå“ªé‡Œæ˜¯æˆ‘è¯¥å»çš„åœ°æ–¹å‘¢ï¼Ÿâ€ï¼ŒèŠ©ä»ç„¶é—®é“ã€‚â€œå“Ÿï¼Œä½ ä»Šå¤©çš„è¯ä¼¼ä¹æœ‰ç‚¹å¤šã€‚â€ï¼Œé»‘è¡£ç”·å­è°ƒä¾ƒé“ã€‚â€œä½ æ€ä¹ˆçŸ¥é“æˆ‘ä»¥å‰çš„è¯ä¸å¤šï¼Ÿâ€ï¼ŒèŠ©ç–‘æƒ‘çš„é—®é“ã€‚â€œä½ ä¸å–œæ¬¢ä½ ä¹‹å‰çš„ä¸–ç•Œï¼Œæ‰€ä»¥è¯ä¸å¤šï¼Œæˆ‘çŒœçš„ï¼Œä¸€ä¸ªäººä¸ä¼šå¯¹ä»–ä¸å–œæ¬¢çš„ä¸œè¥¿è¿˜è¯´é‚£ä¹ˆå¤šè¯ï¼Œä¸æ˜¯å—ï¼Ÿâ€ï¼Œé»‘è¡£ç”·å­ç¬‘é“ã€‚â€œä¹‹å‰çš„ä¸–ç•Œï¼Œæ‰€ä»¥è¯´ï¼Œæˆ‘æ­»äº†ï¼Ÿé‚£ä¹ˆè¿™é‡Œæ˜¯é˜´æ›¹åœ°åºœå—ï¼Ÿâ€ï¼ŒèŠ©ä»ç„¶ç–‘æƒ‘çš„é—®é“ã€‚â€œå—¯ï¼Œä½ æ­»å•¦ã€‚ä½†æ˜¯è¿™é‡Œä¸æ˜¯é˜´æ›¹åœ°åºœï¼Œä¸è¿‡ä½ å¾…ä¼šå»çš„åœ°æ–¹ç®—æ˜¯é˜´æ›¹åœ°åºœå§ï¼Œåªä¸è¿‡æˆ‘ä»¬ç§°ä¹‹ä¸ºæ­»ç•Œï¼Œä½ ç”Ÿæ´»çš„åœ°æ–¹æ˜¯ç”Ÿç•Œï¼Œæ‰€ä»¥ç°åœ¨è¿™ä¸ªåœ°æ–¹æ˜¯ç”Ÿæ­»ç•Œï¼Œè¿æ¥ç”Ÿç•Œå’Œæ­»ç•Œçš„åœ°æ–¹ï¼Œè€Œæˆ‘æ˜¯è´Ÿè´£å°†ä½ ä»¬é€åˆ°æ­»ç•Œçš„äººï¼Œå§ï¼â€ï¼Œé»‘è¡£ç”·å­å¨“å¨“é“æ¥ã€‚â€œæœç„¶æˆ‘è¿˜æ˜¯æ­»äº†ï¼Œå”‰ï¼Œç®—å•¦ï¼Œæœ¬æ¥ä¹Ÿä¸æ‰“ç®—æŠ±æ´»ç€çš„å¸Œæœ›ï¼Œè€Œä¸”æ²¡ä»€ä¹ˆç‰µæŒ‚ï¼Œæ­»äº†å¥½ï¼Œæ­»äº†å¥½å‘€ã€‚â€ï¼ŒèŠ©å¿ƒé‡Œæƒ³ç€ï¼Œå¹¶éœ²å‡ºäº†å¾®ç¬‘ã€‚â€œå“ˆå“ˆï¼Œä½ æœç„¶æ˜¯ä¸å–œæ¬¢ä¹‹å‰çš„ä¸–ç•Œï¼Œå¯¹å§ï¼Œä¸€èˆ¬å¾ˆå°‘æœ‰äººåƒä½ ä¸€æ ·ï¼Œæ¥äº†è¿™ä¸ªåœ°æ–¹è¿˜æ»¡å¸¦ç¬‘æ„çš„ï¼Œä»–ä»¬éƒ½èˆä¸å¾—é‚£ä¸ªä¸–ç•Œå‘€ã€‚â€ï¼Œé»‘è¡£ç”·å­æ„Ÿå¹é“ã€‚â€œä½ è¯´é”™äº†ï¼Œäººä»¬æ€»å–œæ¬¢å¯¹æ–°å‡ºç”Ÿå©´å„¿çš„å®¶åº­è¯´æ­å–œæ­å–œï¼Œå´å¯¹æ­»å»äººçš„å®¶åº­è¯´å¯æƒœå¯æƒœï¼Œè¿™å¹¶ä¸æ˜¯è¯´ä»–ä»¬å–œæ¬¢æ´»ç€çš„ä¸–ç•Œï¼Œåªæ˜¯ä»–ä»¬ä¸çŸ¥é“æ­»å»çš„ä¸–ç•Œï¼Œæ‰€ä»¥é€‰æ‹©äº†æ´»ç€çš„ä¸–ç•Œï¼Œè€Œæˆ‘å»å“ªé‡Œéƒ½ä¸€æ ·ï¼Œæˆ‘éƒ½å¯ä»¥æ¥å—ã€‚â€ï¼ŒèŠ©æ·¡æ·¡çš„è¯´é“ã€‚]]></content>
      <tags>
        <tag>æ··æ²Œ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸‰è§’å½¢ä¸­å¿ƒåæ ‡]]></title>
    <url>%2F2019%2F05%2F13%2Ftriangle%2F</url>
    <content type="text"><![CDATA[Pç”¨A,B,Cæ¥è¡¨ç¤ºå¯¹äºä¸‰è§’å½¢å†…ä»»æ„ä¸€ç‚¹På…¶å®å­¦è¿‡å‘é‡çš„å°±èƒ½æƒ³åˆ°ï¼Œ$\vec{AP}$ï¼Œ$\vec{AB}$ï¼Œ$\vec{AC}$çº¿æ€§ç›¸å…³ã€‚å¯ä»¥å†™æˆï¼š$\vec{AP}=u\vec{AB}+v\vec{AC}$å±•å¼€ï¼š$A-P=u(A-B)+v(A-C)$å¾—åˆ°ï¼š$P=(1-u-v)A+uB+vC$è¿™ä¹Ÿæ˜¯Pçš„è¡¨ç¤ºï¼Œå…¶ä¸­$0\le{u,v}\le{1}$ï¼Œæ¥å–ç‰¹æ®Šä¸€ç‚¹çš„uï¼Œvå¯ä»¥å¾—åˆ°Aï¼ŒBï¼ŒCã€‚è¿™ä¸ªå…¬å¼é•¿å¾—å¾ˆåƒABä¸Šä»»æ„ä¸€ç‚¹Dçš„è®¡ç®—ï¼š$D=A+t(B-A),0\le{t}\le{1}$ä¹Ÿå°±æ˜¯çº¿æ€§æ’å€¼ï¼š$D=(1-t)A+tB,0\le{t}\le{1}$ è®¡ç®—å½“ç„¶ä¹Ÿå¯ä»¥æŠŠABCçœ‹æˆåæ ‡ç³»ï¼Œå§‹äºAç‚¹ï¼ŒåŸºäºï¼š$\vec{AB}$å’Œ$\vec{AC}$ã€‚æ‰€ä»¥è¿™ä¸ªå«åšé‡æ–°åæ ‡ç³»ï¼ˆbarycentricï¼Œbary-é‡çš„ï¼‰ä¹Ÿèƒ½å¾—åˆ°å…¬å¼ï¼š$\vec{AP}=u\vec{AB}+v\vec{AC}$è½¬æ¢æˆï¼š$u\vec{AB}+v\vec{AC}+\vec{PA}=0$ç”šè‡³æˆ‘ä»¬è¿˜å¯ä»¥æŠŠå®ƒå†™æˆçŸ©é˜µå½¢å¼ï¼š$\begin{bmatrix}{u}&amp;{v}&amp;{1}\\\end{bmatrix}\begin{bmatrix}{\vec{AB_x}}\\{\vec{AC_x}}\\{\vec{PA_x}}\\\end{bmatrix} = 0$$\begin{bmatrix}{u}&amp;{v}&amp;{1}\\\end{bmatrix}\begin{bmatrix}{\vec{AB_y}}\\{\vec{AC_y}}\\{\vec{PA_y}}\\\end{bmatrix} = 0$å®é™…ä¸Šæˆ‘ä»¬éƒ½å¯ä»¥çœ‹åšæ˜¯æˆ‘ä»¬åœ¨å¯»æ‰¾å‘é‡(u,v,1)åŒæ—¶å‚ç›´äºå‘é‡$(\vec{AB_x},\vec{AC_x},\vec{PA_x})$å’Œå‘é‡$(\vec{AB_y},\vec{AC_y},\vec{PA_y})$ã€‚è¿™ä¸å°±æ˜¯å‰ä¹˜å—ï¼ŸåŒæ—¶è¿™ç»™äº†æˆ‘ä»¬ä¸€ä¸ªæœ‰äº†Pç‚¹ï¼Œæ±‚uå’Œvçš„æ€è·¯ã€‚ xvector = (B_x - A_x, C_x - A_x, A_x - P_x) yvector = (B_y - A_y, C_y - A_y, A_y - P_y) u=xvector x yvector # å› ä¸ºæˆ‘ä»¬è®¨è®ºçš„æ˜¯äºŒç»´ä¸‰è§’å½¢ï¼Œå¦‚æœuçš„zåˆ†é‡ä¸ç­‰äº1åˆ™è¯´æ˜Pç‚¹ä¸åœ¨ä¸‰è§’å½¢å†… ç¼–ç ç„¶åæˆ‘ä»¬æ¥ä»£ç é˜¶æ®µï¼Œå› ä¸ºæˆ‘ä»¬çš„è®¡ç®—ä¸­æ¶‰åŠåˆ°æµ®ç‚¹æ•°ï¼Œå¯èƒ½uçš„zåˆ†é‡ä¸ä¼šä¸€å®šç­‰äº1.0ï¼Œä»¤uçš„ä¸‰ä¸ªåˆ†é‡æ˜¯(a, b, c)ï¼Œæˆ‘ä»¬ä»£å…¥åŸå…¬å¼ï¼š$a\vec{AB}+b\vec{AC}+c\vec{PA}=0$$P=(1-a/c-b/c)A+a/cB+b/cC,c\neq{0})$123456789101112Vec3f barycentric(Vec2f A, Vec2f B, Vec2f C, Vec2f P)&#123; Vec3f s[2]; for (int i = 2; i &gt; 0;i--)&#123; s[i][0] = C[i] - A[i]; s[i][1] = B[i] - A[i]; s[i][2] = A[i] - P[i]; &#125; Vec3f u = cross(s[0], s[1]); if (std::abs(u[2])&gt;1e-2) return Vec3f(1.f-(u.x+u.y)/u.z, u.y/u.z,u.x/u.z); return Vec3f(-1,1,1);&#125; 1234567891011def barycentric(A,B,C,P) """ A,B,C,P:Vector3, points return u: Vector3, barycentric coordinate of P """ s1 = Vector3(B.x - A.x, C.x - A.x, A.x - P.x) s2 = Vector3(B.y - A.y, C.y - A.y, A.y - P.y) u = s1.cross(s2) if abs(u.z) &gt; EPSILON return Vector3(1-(u.x+u.y)/u.z,u.x/u.z,u.y/u.z) return Vector3(-1,1,1) åº”ç”¨é‡å¿ƒåæ ‡åœ¨CGä¸­çš„åº”ç”¨å¯ä»¥æœ‰ä»¥ä¸‹ï¼š å¡«å……ä¸‰è§’å½¢ä¹‹å‰æˆ‘ä¹Ÿæƒ³è¿‡è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬ç”Ÿæˆå›¾åƒï¼Œå½’æ ¹ç»“åº•æ˜¯åœ¨äºç”»åƒç´ ç‚¹ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬è¦å¡«å……ä¸€ä¸ªä¸‰è§’å½¢ï¼Œå¯¹äºä¸€ä¸ªä¸€ä¸ªçš„åƒç´ ç‚¹ï¼Œæˆ‘ä»¬åªéœ€è¦æ”¾åˆ°ä¸Šè¿°å‡½æ•°é‡Œé¢å»ï¼Œå°±å¯ä»¥åˆ¤æ–­Pæ˜¯å¦åœ¨ä¸‰è§’å½¢å†…ï¼Œæˆ‘ä»¬å°±å»ç”»å®ƒã€‚è¿™æ ·å¡«ä¸€ä¸ªä¸‰è§’å½¢çš„ç®—æ³•å¯ä»¥å°±æ˜¯O(image.width*image.height)ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥è¿›ä¸€æ­¥é™ä½å¤æ‚åº¦ï¼Œå¯¹äºä¸€ä¸ªä¸‰è§’å½¢æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç”±å®ƒçš„bounding boxï¼Œåªéœ€è¦æ£€æµ‹å®ƒçš„bounding boxé‡Œé¢çš„ç‚¹ï¼Œç„¶åå°±å¯ä»¥ç”¨æ¥å¡«å……ã€‚ z-bufferå…¶å®è¿™é‡Œä¹Ÿä¸æ­¢äºz-bufferï¼Œæˆ‘ä»¬å·²ç»æŠŠPç‚¹è¡¨ç¤ºæˆäº†Aï¼ŒBï¼ŒCçš„çº¿æ€§ç»„åˆå½¢å¼ï¼Œé‚£ä¹ˆå¯¹äºPç‚¹çš„Zï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™æ ·æ¥çœ‹ï¼Œæˆ‘ä»¬æŠŠPç‚¹zå€¼ä¹Ÿå¯ä»¥çœ‹æˆAï¼ŒBï¼ŒCçš„çº¿æ€§ç»„åˆï¼Œå…¶å®ä¸ä»…ä»…æ˜¯Pç‚¹çš„zï¼Œå¯¹äºPç‚¹çš„ä»»æ„æ€§è´¨ï¼Œåªè¦æˆ‘ä»¬è§‰å¾—å¯ä»¥ç”¨çº¿æ€§ç»„åˆæ¥çœ‹çš„ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç”¨è¿™ä¸ªåæ ‡ç³»ç»Ÿã€‚]]></content>
      <categories>
        <category>å›¾å½¢å­¦ç¬”è®°</category>
      </categories>
      <tags>
        <tag>è®¡ç®—æœºå›¾å½¢å­¦</tag>
        <tag>å…‰æ …</tag>
        <tag>ä¸‰è§’å½¢</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Artist]]></title>
    <url>%2F2019%2F05%2F13%2Fartist%2F</url>
    <content type="text"><![CDATA[https://www.artstation.com/ éå¸¸ä¸é”™çš„ç¾æœ¯ä½œå“ç½‘ç«™ã€‚ å¤´å‘åˆ¶ä½œä¸­æœ‰æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„å·¥å…·æˆ–è€…æ˜¯æ’ä»¶ï¼Ÿè¿˜æœ‰æ¯›å‘çš„æ’åºæ˜¯æ€ä¹ˆè§£å†³çš„ï¼Ÿ å¤´å‘çš„å»ºæ¨¡æ–¹é¢ï¼Œç°åœ¨æ˜¯zbrushæ‰‹è°ƒå‘å¡ã€‚å¤´å‘æ’åºæ–¹é¢ï¼Œæˆ‘ä»¬ç”¨çš„æ˜¯æŠ–åŠ¨ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸‹é»‘ä¸€ä¸‹ç™½çš„é‚£ä¸ªæ–¹å¼ï¼Œä¸éœ€è¦è§£å†³æ’åºçš„é—®é¢˜ï¼Œæ‰€ä»¥åœ¨è¡¨ç°æ–¹é¢è¿˜æ˜¯æœ‰ä¸€äº›ä¼˜åŠ¿ã€‚ æœ‰ä¸€ç§è¯´æ³•æ˜¯PBRåœ¨çš®è‚¤è¡¨ç°ä¸Šå¹¶ä¸æ˜¯éå¸¸å¥½çš„æ„Ÿè§‰ï¼Œæœ‰æ²¡æœ‰å•ç‹¬å†™è¿™ä¸ªçš®è‚¤çš„æè´¨ï¼Œæˆ–è€…è¯´æœ‰ä»€ä¹ˆæŠ€å·§ï¼Ÿ PBRå°±æ˜¯ç”¨ç°å®åšå‚è€ƒè€Œåšå‡ºæ¥çš„æè´¨ï¼Œå¤§é‡çš„æè´¨éƒ½å¯ä»¥å½’ä¸ºPBRï¼Œå¾ˆå¤šäººå¯¹PBRçš„äº†è§£å°±æ˜¯GGXåå°„æ¨¡å‹çš„äº†è§£ï¼Œä½†æ˜¯é‚£ä¸ªå®šä¹‰å°±æ¯”è¾ƒå±€é™ã€‚ç°åœ¨æ¸¸æˆç•Œçš„çš®è‚¤æ™®éç”¨çš„æ˜¯ScreenSpaceSubsurfaceã€‚å¤§éƒ¨åˆ†çš„ç°åœ¨å•æœºæ¸¸æˆçš„çš®è‚¤å‡ ä¹å…¨éƒ¨éƒ½æ˜¯ä»–çš„é‚£ä¸ªåŸç†ï¼ŒåŒ…æ‹¬ç¥ç§˜æµ·åŸŸéƒ½æ˜¯ç”¨ä»–çš„è¿™ä¸ªæ¨¡å¼ã€‚]]></content>
      <tags>
        <tag>Art</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸‰å¤§é¢äº”å¤§è°ƒ]]></title>
    <url>%2F2019%2F05%2F13%2Fartist-3-face-5-major%2F</url>
    <content type="text"><![CDATA[ç‰©ä½“è°ƒå­çš„è§„å¾‹å¯å½’çº³ä¸ºâ€œä¸‰å¤§é¢ã€äº”å¤§è°ƒå­â€ ä¸‰å¤§é¢é»‘ç™½ç°ã€‚ äº”å¤§è°ƒ å—å…‰é¢ï¼ˆäº®é¢ï¼‰ï¼šæ˜¯ç‰©ä½“å—å…‰çº¿90Â°ç›´å°„çš„åœ°æ–¹ï¼Œè¿™éƒ¨åˆ†å—å…‰æœ€å¤§ï¼Œè°ƒå­æ·¡ï¼Œä¸¤éƒ¨çš„å—å…‰ç„¦ç‚¹å«â€œé«˜å…‰â€ï¼Œä¸€èˆ¬åªæœ‰å…‰æ»‘çš„ç‰©ä½“æ‰ä¼šå‡ºç°ã€‚ ä¸­é—´è‰²ï¼ˆç°é¢ï¼‰ï¼šæ˜¯ç‰©ä½“å—å…‰æµ‹å°„çš„éƒ¨åˆ†ã€‚ æ˜æš—äº¤ç•Œçº¿ï¼šç”±äºå®ƒæ”¶åˆ°ç¯å¢ƒå…‰çš„å½±å“ï¼Œä½†åˆå—ä¸åˆ°ä¸»è¦å…‰æºçš„ç…§å°„ï¼Œå› æ­¤å¯¹æ¯”å¼ºçƒˆï¼Œç»™äººçš„æ„Ÿè§‰è°ƒå­æœ€æ·±ã€‚ åå…‰ï¼šæš—éƒ¨ç”±äºå—å‘¨å›´ç‰©ä½“çš„åå°„ä½œç”¨ï¼Œä¼šäº§ç”Ÿåå…‰ã€‚åå…‰ä½œä¸ºæš—éƒ¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸€èˆ¬è¦æ¯”äº®éƒ¨æœ€æ·±çš„ä¸­é—´é¢œè‰²è¦æ·±ã€‚ æŠ•å½±ï¼šå°±æ˜¯ç‰©ä½“æœ¬èº«å½±å­çš„éƒ¨åˆ†ã€‚å®ƒä½œä¸ºä¸€ä¸ªå¤§çš„è‰²å—å‡ºç°ã€‚æŠ•å½±çš„è¾¹ç¼˜è¿‘å¤„æ¸…æ¥šï¼Œæ¸è¿œçš„æ¨¡ç³Šã€‚ äº”å¤§è°ƒå­çš„è§„å¾‹æ˜¯å¡‘é€ ç«‹ä½“æ„Ÿçš„ä¸»è¦æ–¹æ³•ã€‚å…¶æ˜¯è¡¨ç°è´¨æ„Ÿã€é‡æ„Ÿã€ç©ºé—´çš„é‡è¦æ‰‹æ®µã€‚ç´ æé€ å‹æ­£ç¡®è¡¨ç°å‡ºè¿™ç§å…³ç³»ï¼Œå°±å¯ä»¥è¾¾åˆ°ååˆ†çœŸå®çš„æ•ˆæœï¼Œæ˜æš—äº¤ç•Œçº¿æ˜¯ç”±äº®éƒ¨ç”±è½¬å‘æš—éƒ¨è½¬æŠ˜çš„éƒ¨åˆ†ã€‚ äº”å¤§æ¡å­çš„è§„å¾‹æ˜¯å¡‘é€ ç«‹ä½“æ„Ÿçš„ä¸»è¦æ³•åˆ™ï¼Œä¹Ÿæ˜¯è¡¨ç°è´¨æ„Ÿï¼Œé‡æ„Ÿï¼Œç©ºé—´æ„Ÿçš„é‡è¦æ‰‹æ®µï¼Œç´ æé€ å‹æ­£ç¡®åœ°è¡¨ç°å‡ºè¿™ç§å…³ç³»ï¼Œå°±å¯ä»¥è¾¾åˆ°ååˆ†çœŸå®çš„æ•ˆæœã€‚äº”å¤§è°ƒçš„æ˜æš—å¯¹æ¯”çš„åŸºæœ¬é¡ºåºæ˜¯ï¼šé«˜å…‰&gt;äº®ç°&gt;åå…‰&gt;æš—ç°&gt;æ˜æš—äº¤ç•Œçº¿ã€‚]]></content>
      <tags>
        <tag>Art</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[unity-computeshader]]></title>
    <url>%2F2019%2F05%2F13%2Funity-computeshader%2F</url>
    <content type="text"><![CDATA[Compute Shaderå¦‚ä½•åˆ›å»ºï¼šProject-&gt;Create-&gt;Compute Shader123#pragma kernel CSMain[numthreads(8,8,1)] #pragma kernel CSMain åˆ¶å®šäº†è¿™ä¸ªç¨‹åºçš„å…¥å£å‡½æ•°ï¼ˆComputeShaderçš„Mainå‡½æ•°ï¼‰ [numthreads(8,8,1)] è¿™ä¸€è¡ŒæŒ‡å®šäº†ComputeShaderåˆ›å»ºçº¿ç¨‹ç»„çš„å¤§å°ã€‚GPUåˆ©ç”¨äº†å¤§é‡çš„å¹¶è¡Œå¤„ç†ä½¿å¾—GPUåˆ›å»ºçš„ä¸€äº›çº¿ç¨‹å¯ä»¥åŒæ—¶è¿è¡Œã€‚ 12345678910111213public ComputeShader shader;void RunShader()&#123; int kernelHandle = shader.FindKernel("CSMain"); RenderTexture tex = new RenderText("256,256,24"); tex.enableRandomWrite = true; tex.Create(); shader.SetTexture(kernelHandler, "Result", tex); shader.Dispatch(kernelHandler, 256/8,256/8);&#125;]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç¨‹ä¼¼é”¦]]></title>
    <url>%2F2019%2F05%2F13%2Ffiction-2%2F</url>
    <content type="text"><![CDATA[æ—¢ç„¶æˆ‘ä»¬ä¸çŸ¥é“æœªæ¥å¦‚ä½•ç›¸é‡æˆ–è€…è¿˜æ˜¯ä¸é‡ï¼Œé‚£æˆ‘å°±ç¥ä½ å‰ç¨‹ä¼¼é”¦å§ã€‚è¿™æ ·æ€»å½’ä¸æ˜¯é”™çš„ã€‚]]></content>
      <tags>
        <tag>æ··æ²Œ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[OpenGL ES 3.0]]></title>
    <url>%2F2019%2F05%2F12%2Fopengles%2F</url>
    <content type="text"><![CDATA[Windowsé…ç½®OpenGLES3å¼€å‘ç¯å¢ƒOpenGL ES 3.0å®ç°äº†å…·æœ‰å¯ç¼–ç¨‹ç€è‰²åŠŸèƒ½çš„å›¾å½¢ç®¡çº¿ï¼Œç”±ä¸¤ä¸ªè§„èŒƒç»„æˆï¼šOpenGL ES 3.0 APIè§„èŒƒå’ŒOpenGL ESç€è‰²è¯­è¨€3.0è§„èŒƒï¼ˆOpenGL ES SLï¼‰ã€‚ä¸‹å›¾å±•ç¤ºäº†OpenGL ES 3.0å›¾å½¢ç®¡çº¿ã€‚å›¾ä¸­å¸¦æœ‰é˜´å½±çš„æ–¹æ¡†è¡¨ç¤ºOpenGL ES 3.0ä¸­ç®¡çº¿çš„å¯ç¼–ç¨‹é˜¶æ®µã€‚ä¸‹é¢æ¦‚è¿°OpenGL ES 3.0 å›¾å½¢ç®¡çº¿çš„å„ä¸ªé˜¶æ®µã€‚ é¡¶ç‚¹ç€è‰²å™¨æœ¬èŠ‚ç®€å•æ¦‚è¿°é¡¶ç‚¹ç€è‰²å™¨ã€‚é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨å°†åœ¨åé¢çš„ç« èŠ‚ä¸­æ·±å…¥ä»‹ç»ã€‚é¡¶ç‚¹ç€è‰²å™¨å®ç°äº†é¡¶ç‚¹æ“ä½œçš„é€šç”¨å¯ç¼–ç¨‹æ–¹æ³•ã€‚é¡¶ç‚¹ç€è‰²å™¨çš„è¾“å…¥åŒ…æ‹¬ï¼š ç€è‰²å™¨ç¨‹åºï¼šæè¿°é¡¶ç‚¹ä¸Šæ‰§è¡Œæ“ä½œçš„é¡¶ç‚¹ç€è‰²å™¨ç¨‹åºæºä»£ç æˆ–è€…å¯æ‰§è¡Œæ–‡ä»¶ã€‚ é¡¶ç‚¹ç€è‰²å™¨è¾“å…¥ï¼ˆæˆ–è€…å±æ€§ï¼‰ï¼šç”¨é¡¶ç‚¹æ•°ç»„æä¾›çš„æ¯ä¸ªé¡¶ç‚¹çš„æ•°æ®ã€‚ ç»Ÿä¸€å˜é‡ï¼ˆuniformï¼‰ï¼šé¡¶ç‚¹ï¼ˆæˆ–è€…ç‰‡æ®µï¼‰ç€è‰²å™¨ä½¿ç”¨çš„ä¸å˜æ•°æ®ã€‚ é‡‡æ ·å™¨ï¼šä»£è¡¨é¡¶ç‚¹ç€è‰²å™¨ä½¿ç”¨çº¹ç†çš„ç»Ÿä¸€å˜é‡ç±»å‹ã€‚ é¡¶ç‚¹ç€è‰²å™¨çš„è¾“å‡ºåœ¨OpenGL ES 2.0ä¸­ç§°ä½œå¯å˜ï¼ˆvaryingï¼‰å˜é‡ï¼Œä½†åœ¨OpenGL ES 3.0ä¸­æ”¹åä¸ºé¡¶ç‚¹ç€è‰²å™¨è¾“å‡ºå˜é‡ã€‚åœ¨å›¾å…ƒå…‰æ …åŒ–é˜¶æ®µï¼Œä¸ºæ¯ä¸ªç”Ÿæˆçš„ç‰‡æ®µè®¡ç®—é¡¶ç‚¹ç€è‰²å™¨è¾“å‡ºå€¼ï¼Œå¹¶ä½œä¸ºè¾“å…¥ä¼ é€’ç»™ç‰‡æ®µç€è‰²å™¨ã€‚ç”¨äºä»åˆ†é…ç»™æ¯ä¸ªå›¾å…ƒé¡¶ç‚¹çš„é¡¶ç‚¹ç€è‰²å™¨è¾“å‡ºç”Ÿæˆæ¯ä¸ªç‰‡æ®µå€¼çš„æœºåˆ¶ç§°ä½œæ’å€¼ï¼ˆInterpolationï¼‰ã€‚æ­¤å¤–ï¼ŒOpenGL ES 3.0å¢åŠ äº†ä¸€ä¸ªæ–°åŠŸèƒ½â€”â€”å˜åŒ–åé¦ˆï¼Œä½¿é¡¶ç‚¹ç€è‰²å™¨è¾“å‡ºå¯ä»¥é€‰æ‹©æ€§åœ°å†™å…¥ä¸€ä¸ªè¾“å‡ºç¼“å†²åŒºï¼ˆé™¤äº†ä¼ é€’ç»™ç‰‡æ®µç€è‰²å™¨ä¹‹å¤–ï¼Œä¹Ÿå¯èƒ½ä»£æ›¿è¿™ç§ä¼ é€’ï¼‰ã€‚ä¾‹å¦‚ï¼Œåœ¨ç¬¬14ç« ä¸­ä»‹ç»çš„å˜æ¢åé¦ˆç¤ºä¾‹ä¸­ï¼Œåœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­å®ç°äº†ä¸€ä¸ªç²’å­ç³»ç»Ÿï¼Œå…¶ä¸­çš„ç²’å­ç”¨å˜æ¢åé¦ˆè¾“å‡ºåˆ°ä¸€ä¸ªç¼“å†²åŒºå¯¹è±¡ã€‚é¡¶ç‚¹ç€è‰²å™¨çš„è¾“å…¥å’Œè¾“å‡ºå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ é¡¶ç‚¹ç€è‰²å™¨å¯ä»¥ç”¨äºé€šè¿‡çŸ©é˜µå˜æ¢ä½ç½®ã€è®¡ç®—ç…§æ˜å…¬å¼æ¥ç”Ÿæˆé€é¡¶ç‚¹é¢œè‰²ä»¥åŠç”Ÿæˆæˆ–è€…å˜æ¢çº¹ç†åæ ‡ç­‰åŸºäºé¡¶ç‚¹çš„ä¼ ç»Ÿæ“ä½œã€‚æ­¤å¤–ï¼Œå› ä¸ºé¡¶ç‚¹ç€è‰²å™¨ç”±åº”ç”¨ç¨‹åºè§„å®šï¼Œæ‰€ä»¥å®ƒå¯ä»¥ç”¨äºæ‰§è¡Œè‡ªå®šä¹‰è®¡ç®—ï¼Œå®æ–½æ–°çš„å˜æ¢ã€ç…§æ˜æˆ–è€…è¾ƒä¼ ç»Ÿçš„å›ºå®šåŠŸèƒ½ç®¡çº¿æ‰€ä¸å…è®¸çš„åŸºäºé¡¶ç‚¹çš„æ•ˆæœã€‚ä¸‹é¢å±•ç¤ºäº†ç”¨OpenGL ESç€è‰²è¯­è¨€ç¼–å†™çš„ä¸€ä¸ªé¡¶ç‚¹ç€è‰²å™¨ã€‚æˆ‘ä»¬å°†åœ¨æœ¬æ–‡åé¢è¯¦ç»†è¯´æ˜é¡¶ç‚¹ç€è‰²å™¨ï¼Œè¿™é‡Œæä¾›çš„ç€è‰²å™¨åªæ˜¯è®©ä½ å¯¹é¡¶ç‚¹ç€è‰²å™¨æœ‰ä¸ªæ¦‚å¿µã€‚ä¸‹é¢ä»£ç ä¸­çš„é¡¶ç‚¹ç€è‰²å™¨å–å¾—ä¸€ä¸ªä½ç½®åŠç›¸å…³çš„é¢œè‰²æ•°æ®ä½œä¸ºè¾“å…¥å±æ€§ï¼Œç”¨ä¸€ä¸ª4x4çŸ©é˜µå˜æ¢ä½ç½®ï¼Œå¹¶è¾“å‡ºå˜æ¢åçš„ä½ç½®å’Œé¢œè‰²ã€‚12345678910111213#version 300 esuniform mat4 u_mvpMatrix; // matrix to convert a_position from model space to normalized device space// attributes input to the vertex shaderin vec4 a_position; // position valuein vec4 a_color; // input vertex color// output of the vertex shader - input to fragment shaderout vec4 v_color; // output vertex colorvoid main()&#123; v_color = a_color; gl_Position = u_mvpMatrix * a_position;&#125; ç¬¬1è¡Œæä¾›äº†ç€è‰²è¯­è¨€çš„ç‰ˆæœ¬-è¿™ä¸€ä¿¡æ¯å¿…é¡»å‡ºç°åœ¨ç€è‰²å™¨çš„ç¬¬1è¡Œï¼ˆ#version 300 esè¡¨ç¤ºOpenGL ESç€è‰²è¯­è¨€v3.00ï¼‰ã€‚ç¬¬2è¡Œæè¿°äº†ç»Ÿä¸€å˜é‡u_mvpMatrixï¼Œå®ƒå­˜å‚¨ç»„åˆçš„æ¨¡å‹è§†å›¾å’ŒæŠ•å½±çŸ©é˜µã€‚ç¬¬4è¡Œå’Œç¬¬8è¡Œæè¿°äº†é¡¶ç‚¹ç€è‰²å™¨çš„è¾“å…¥ï¼Œè¢«ç§°ä½œé¡¶ç‚¹å±æ€§ã€‚a_positionæ˜¯è¾“å…¥é¡¶ç‚¹ä½ç½®å±æ€§ï¼Œa_coloræ˜¯è¾“å…¥é¡¶ç‚¹é¢œè‰²å±æ€§ã€‚ç¬¬8è¡Œå£°æ˜äº†è¾“å‡ºå˜é‡v_colorï¼Œç”¨äºå­˜å‚¨æè¿°æ¯ä¸ªé¡¶ç‚¹é¢œè‰²çš„é¡¶ç‚¹ç€è‰²å™¨è¾“å‡ºã€‚å†…å»ºå˜é‡gl_Positionæ˜¯è‡ªåŠ¨å£°æ˜çš„ï¼Œç€è‰²å™¨å¿…é¡»å°†å˜æ¢åçš„ä½ç½®å†™å…¥è¿™ä¸ªå˜é‡ã€‚ç‰‡æ®µç€è‰²å™¨çš„é¡¶ç‚¹æœ‰ä¸€ä¸ªå•ä¸€å…¥å£ç‚¹ï¼Œç§°ä½œä¸»å‡½æ•°ã€‚ç¬¬9è¡Œ~13è¡Œæè¿°é¡¶ç‚¹ç€è‰²å™¨mainå‡½æ•°ã€‚åœ¨ç¬¬11è¡Œä¸­ï¼Œè¯»å…¥é¡¶ç‚¹å±æ€§è¾“å…¥a_colorï¼Œå¹¶å°†å…¶å†™å…¥é¡¶ç‚¹è¾“å‡ºé¢œè‰²v_colorã€‚ç¬¬12è¡Œä¸­ï¼Œå˜æ¢åçš„é¡¶ç‚¹ä½ç½®å†™å…¥gl_Positionè¾“å‡ºã€‚ å›¾å…ƒè£…é…é¡¶ç‚¹ç€è‰²å™¨ä¹‹åï¼ŒOpenGL ES 3.0å›¾å½¢ç®¡çº¿çš„ä¸‹ä¸€é˜¶æ®µæ˜¯å›¾å…ƒè£…é…ã€‚å›¾å…ƒï¼ˆPrimitiveï¼‰æ˜¯ä¸‰è§’å½¢ã€ç›´çº¿æˆ–è€…ç‚¹ç²¾çµç­‰å‡ ä½•å¯¹è±¡ã€‚å›¾å…ƒçš„æ¯ä¸ªé¡¶ç‚¹è¢«å‘é€åˆ°é¡¶ç‚¹ç€è‰²å™¨çš„ä¸åŒæ‹·è´ã€‚åœ¨å›¾å…ƒè£…é…æœŸé—´ï¼Œè¿™äº›é¡¶ç‚¹è¢«ç»„åˆæˆå›¾å…ƒã€‚å¯¹äºæ¯ä¸ªå›¾å…ƒï¼Œå¿…é¡»ç¡®å®šå›¾å…ƒæ˜¯å¦ä½äºè§†é”¥ä½“ï¼ˆå±å¹•ä¸Šå¯è§çš„3Dç©ºé—´åŒºåŸŸï¼‰å†…ã€‚å¦‚æœå›¾å…ƒæ²¡æœ‰å®Œå…¨åœ¨è§†é”¥ä½“å†…ï¼Œåˆ™å¯èƒ½éœ€è¦è¿›è¡Œè£å‰ªã€‚å¦‚æœå›¾å…ƒå®Œå…¨å¤„äºè¯¥åŒºåŸŸä¹‹å¤–ï¼Œå®ƒå°±ä¼šè¢«æŠ›å¼ƒã€‚è£å‰ªä¹‹åï¼Œé¡¶ç‚¹ä½ç½®æ¯è½¬æ¢ä¸ºå±å¹•åæ ‡ã€‚ä¹Ÿå¯ä»¥æ‰§è¡Œä¸€æ¬¡æ·˜æ±°æ“ä½œï¼Œæ ¹æ®å›¾å…ƒé¢å‘å‰æ–¹æˆ–è€…åæ–¹æŠ›å¼ƒå®ƒä»¬ã€‚è£å‰ªå’Œæ·˜æ±°ä¹‹åï¼Œå›¾å…ƒä¾¿å‡†å¤‡ä¼ é€’ç»™ç®¡çº¿çš„ä¸‹ä¸€é˜¶æ®µâ€”â€”å…‰æ …åŒ–é˜¶æ®µã€‚ å…‰æ …åŒ–ä¸‹ä¸€é˜¶æ®µæ˜¯å…‰æ …åŒ–å¦‚ä¸‹å›¾ï¼Œåœ¨æ­¤é˜¶æ®µç»˜åˆ¶å¯¹åº”çš„å›¾å…ƒï¼ˆç‚¹ç²¾çµã€ç›´çº¿æˆ–è€…ä¸‰è§’å½¢ï¼‰ã€‚å…‰æ …åŒ–æ˜¯å°†å›¾å…ƒè½¬åŒ–ä¸ºä¸€ç»„äºŒç»´ç‰‡æ®µçš„è¿‡ç¨‹ï¼Œç„¶åï¼Œè¿™äº›ç‰‡æ®µç”±ç‰‡æ®µç€è‰²å™¨å¤„ç†ã€‚è¿™äº›äºŒç»´ç‰‡æ®µä»£è¡¨ç€å¯åœ¨å±å¹•ä¸Šç»˜åˆ¶çš„åƒç´ ã€‚ ç‰‡æ®µç€è‰²å™¨ç‰‡æ®µç€è‰²å™¨ä¸ºç‰‡æ®µä¸Šçš„æ“ä½œå®ç°äº†é€šç”¨çš„å¯ç¼–ç¨‹æ–¹æ³•ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯¹å…‰æ …åŒ–é˜¶æ®µç”Ÿæˆçš„æ¯ä¸ªç‰‡æ®µæ‰§è¡Œè¿™ä¸ªç€è‰²å™¨ï¼Œé‡‡ç”¨å¦‚ä¸‹è¾“å…¥ï¼š ç€è‰²å™¨ç¨‹åºâ€”â€”æè¿°ç‰‡æ®µä¸Šæ‰€æ‰§è¡Œæ“ä½œçš„ç‰‡æ®µç€è‰²å™¨ç¨‹åºæºä»£ç æˆ–è€…å¯æ‰§è¡Œæ–‡ä»¶ã€‚ è¾“å…¥å˜é‡â€”â€”å…‰æ …åŒ–å•å…ƒç”¨æ’å€¼ä¸ºæ¯ä¸ªç‰‡æ®µç”Ÿæˆçš„é¡¶ç‚¹ç€è‰²å™¨è¾“å‡ºã€‚ ç»Ÿä¸€å˜é‡â€”â€”ç‰‡æ®µï¼ˆæˆ–è€…é¡¶ç‚¹ï¼‰ç€è‰²å™¨ä½¿ç”¨çš„ä¸å˜æ•°æ®ã€‚ é‡‡æ ·å™¨â€”â€”ä»£è¡¨ç‰‡æ®µç€è‰²å™¨æ‰€ç”¨çº¹ç†çš„ç‰¹æ®Šç»Ÿä¸€å˜é‡ç±»å‹ã€‚ ç‰‡æ®µç€è‰²å™¨å¯ä»¥æŠ›å¼ƒç‰‡æ®µï¼Œä¹Ÿå¯ä»¥ç”Ÿæˆä¸€ä¸ªæˆ–è€…é¢œè‰²å€¼ä½œä¸ºè¾“å‡ºã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé™¤äº†æ¸²æŸ“åˆ°å¤šé‡æ¸²æŸ“ç›®æ ‡ä¹‹å¤–ï¼Œç‰‡æ®µç€è‰²å™¨åªè¾“å‡ºä¸€ä¸ªé¢œè‰²å€¼ï¼›åœ¨å¤šé‡æ¸²æŸ“ç›®æ ‡çš„æƒ…å†µä¸‹ï¼Œä¸ºæ¯ä¸ªæ¸²æŸ“ç›®æ ‡è¾“å‡ºä¸€ä¸ªé¢œè‰²å€¼ã€‚å…‰æ …åŒ–é˜¶æ®µç”Ÿæˆçš„é¢œè‰²ã€æ·±åº¦ã€æ¨¡æ¿å’Œå±å¹•åæ ‡ä½ç½®$(x_w,y_w)$å˜æˆOpenGL ES 3.0ç®¡çº¿é€ç‰‡æ®µæ“ä½œé˜¶æ®µçš„è¾“å…¥ã€‚ é€ç‰‡æ®µæ“ä½œåœ¨ç‰‡æ®µç€è‰²å™¨ä¹‹åï¼Œä¸‹ä¸€ä¸ªé˜¶æ®µæ˜¯é€ç‰‡æ®µæ“ä½œã€‚å…‰æ …åŒ–ç”Ÿæˆçš„å±å¹•åæ ‡ä¸º$(x_w,x_y)$çš„ç‰‡æ®µåªèƒ½ä¿®æ”¹å¸§ç¼“å­˜åŒºä¸­ä½ç½®ä¸º$(x_w,y_w)$çš„åƒç´ ã€‚ä¸‹å›¾æè¿°äº†OpenGL ES 3.0é€ç‰‡æ®µæ“ä½œé˜¶æ®µã€‚ åœ¨é€ç‰‡æ®µæ“ä½œé˜¶æ®µï¼Œåœ¨æ¯ä¸ªç‰‡æ®µä¸Šæ‰§è¡Œå¦‚ä¸‹åŠŸèƒ½ï¼š åƒç´ å½’å±æµ‹è¯•â€”â€”è¿™ä¸ªæµ‹è¯•ç¡®å®šå¸§ç¼“å†²åŒºä¸­ä½ç½®$(x_w,y_w)$çš„åƒç´ ç›®å‰æ˜¯ä¸æ˜¯å½’OpenGL ESæ‰€æœ‰ã€‚è¿™ä¸ªæµ‹è¯•ä½¿çª—å£ç³»ç»Ÿèƒ½å¤Ÿæ§åˆ¶å¸§ç¼“å†²åŒºä¸­çš„å“ªäº›åƒç´ å±äºå½“å‰OpenGL ESä¸Šä¸‹æ–‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªæ˜¾ç¤ºOpenGL ESå¸§ç¼“å†²åŒºçª—å£çš„çª—å£è¢«å¦ä¸€ä¸ªçª—å£æ‰€é®è”½ï¼Œåˆ™çª—å£ç³»ç»Ÿå¯ä»¥ç¡®å®šè¢«é®è”½çš„åƒç´ ä¸å±äºOpenGL ESä¸Šä¸‹æ–‡ï¼Œä»è€Œå®Œå…¨ä¸æ˜¾ç¤ºè¿™äº›åƒç´ ã€‚è™½ç„¶åƒç´ å½’å±æµ‹è¯•OpenGL ESçš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯å®ƒä¸ç”±å¼€å‘äººå‘˜æ§åˆ¶ï¼Œè€Œæ˜¯åœ¨OpenGL ESå†…éƒ¨è¿›è¡Œã€‚ è£å‰ªæµ‹è¯•â€”â€”è£å‰ªæµ‹è¯•ç¡®å®š$(x_w,y_w)$æ˜¯å¦ä½äºä½œä¸ºOpenGL ESçŠ¶æ€çš„ä¸€éƒ¨åˆ†çš„è£å‰ªçŸ©å½¢èŒƒå›´å†…ã€‚å¦‚æœè¯¥ç‰‡æ®µä½äºè£å‰ªåŒºåŸŸä¹‹å¤–ï¼Œåˆ™è¢«æŠ›å¼ƒã€‚ æ¨¡æ¿å’Œæ·±åº¦æµ‹è¯•â€”â€”è¿™äº›æµ‹è¯•åœ¨è¾“å…¥ç‰‡æ®µçš„æ¨¡æ¿å’Œæ·±åº¦å€¼ä¸Šè¿›è¡Œï¼Œä»¥ç¡®å®šç‰‡æ®µæ˜¯å¦åº”è¯¥è¢«æ‹’ç»ã€‚ æ··åˆâ€”â€”æ··åˆå°†ç”Ÿæˆçš„ç‰‡æ®µé¢œè‰²å€¼ä¸ä¿å­˜åœ¨å¸§ç¼“å†²åŒº$(x_w,y_w)$ä½ç½®çš„é¢œè‰²å€¼ç»„åˆèµ·æ¥ã€‚ æŠ–åŠ¨â€”â€”æŠ–åŠ¨å¯ç”¨äºæœ€å°åŒ–å› ä¸ºä½¿ç”¨æœ‰é™ç²¾åº¦åœ¨å¸§ç¼“å†²åŒºä¸­ä¿å­˜é¢œè‰²å€¼è€Œäº§ç”Ÿçš„å‡è±¡ã€‚ åœ¨é€ç‰‡æ®µæ“ä½œé˜¶æ®µçš„æœ€åï¼Œç‰‡æ®µæˆ–è€…è¢«æ‹’ç»ï¼Œæˆ–è€…åœ¨å¸§ç¼“å†²åŒºçš„$(x_w,y_w)$ä½ç½®å†™å…¥ç‰‡æ®µçš„é¢œè‰²ã€æ·±åº¦æˆ–è€…æ¨¡æ¿å€¼ã€‚å†™å…¥ç‰‡æ®µé¢œè‰²ã€æ·±åº¦å’Œæ¨¡æ¿å€¼å–å†³äºå¯ç”¨çš„ç›¸åº”å†™å…¥æ©ç ã€‚å†™å…¥æ©ç å¯ä»¥æ›´ç²¾ç»†åœ°æ§åˆ¶å†™å…¥ç›¸å…³ç¼“å†²åŒºçš„é¢œè‰²ã€æ·±åº¦å’Œæ¨¡æ¿å€¼ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥è®¾ç½®é¢œè‰²ç¼“å†²åŒºçš„å†™å…¥æ©ç ï¼Œä½¿å¾—ä»»ä½•çº¢è‰²å€¼ä¸è¢«å†™å…¥é¢œè‰²ç¼“å†²åŒºã€‚æ­¤å¤–ï¼ŒOpenGL ES 3.0æä¾›ä¸€ä¸ªæ¥å£ï¼Œä»¥ä»å¸§ç¼“å†²åŒºè¯»å›åƒç´ ã€‚ OpenGL ES 3.0æ–°åŠŸèƒ½çº¹ç† sRGBçº¹ç†å’Œå¸§ç¼“å†²åŒºâ€”â€”å…è®¸åº”ç”¨ç¨‹åºæ‰§è¡Œä¼½é©¬çŸ«æ­£æ¸²æŸ“ã€‚çº¹ç†å¯ä»¥ä¿å­˜åœ¨ç»è¿‡ä¼½é©¬çŸ«æ­£çš„sRGBç©ºé—´ï¼Œåœ¨ç€è‰²å™¨ä¸­è¯»å–æ—¶åçŸ«æ­£åˆ°çº¿æ€§ç©ºé—´ï¼Œç„¶ååœ¨è¾“å‡ºåˆ°å¸§ç¼“å†²åŒºæ—¶æ¢å›sRGBä¼½é©¬çŸ«æ­£ç©ºé—´ã€‚é€šè¿‡åœ¨çº¿æ€§ç©ºé—´ä¸­æ­£ç¡®åœ°è¿›è¡Œç…§æ˜å’Œå…¶ä»–è®¡ç®—ï¼Œå¯èƒ½å¾—åˆ°æ›´é«˜çš„è§†è§‰ä¿çœŸåº¦ã€‚ 2Dçº¹ç†æ•°ç»„â€”â€”ä¿å­˜ä¸€ç»„2Dçº¹ç†çš„çº¹ç†ç›®æ ‡ã€‚ä¾‹å¦‚ï¼Œè¿™äº›æ•°ç»„å¯ä»¥ç”¨äºæ‰§è¡Œçº¹ç†åŠ¨ç”»ã€‚åœ¨2Dçº¹ç†æ•°ç»„å‡ºç°ä¹‹å‰ï¼Œè¿™ç§åŠ¨ç”»ä¸€èˆ¬é€šè¿‡åœ¨å•ä¸ª2Dçº¹ç†ä¸­å¹³é“ºåŠ¨ç”»å¸§å¹¶ä¿®æ”¹çº¹ç†åæ ‡æ”¹å˜åŠ¨ç”»å¸§å®ç°ã€‚æœ‰äº†2Dçº¹ç†æ•°ç»„ï¼ŒåŠ¨ç”»çš„æ¯ä¸ªå¸§å¯ä»¥åœ¨æ•°ç»„çš„ä¸€ä¸ª2Dåˆ‡ç‰‡ä¸­æŒ‡å®šã€‚ 3Dçº¹ç†â€”â€”ä¸€äº›OpenGL ES 2.0å®ç°é€šè¿‡æ‰©å±•æ”¯æŒ3Dçº¹ç†ï¼Œè€ŒOpenGL ES 3.0å°†æ­¤ä½œä¸ºå¼ºåˆ¶çš„åŠŸèƒ½ã€‚3Dçº¹ç†å¯¹äºè®¸å¤šåŒ»å­¦æˆåƒåº”ç”¨æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œä¾‹å¦‚æ‰§è¡Œä¸‰ç»´æ•°æ®ï¼ˆå¦‚CTã€MRIæˆ–è€…PETæ•°æ®ï¼‰ç›´æ¥ä½“æ¸²æŸ“çš„ç¨‹åºã€‚ æ·±åº¦çº¹ç†å’Œé˜´å½±æ¯”è¾ƒâ€”â€”å¯ç”¨å­˜å‚¨åœ¨çº¹ç†ä¸­çš„æ·±åº¦ç¼“å†²åŒºã€‚æ·±åº¦çº¹ç†çš„æœ€å¸¸è§ç”¨é€”æ˜¯æ¸²æŸ“é˜´å½±ï¼Œè¿™æ—¶æ·±åº¦ç¼“å†²åŒºä»å…‰æºçš„è§’åº¦æ¸²æŸ“ï¼Œç„¶åç”¨äºåœ¨æ¸²æŸ“åœºæ™¯æ—¶æ¯”è¾ƒï¼Œä»¥ç¡®å®šç‰‡æ®µæ˜¯å¦åœ¨é˜´å½±ä¸­ã€‚é™¤äº†æ·±åº¦çº¹ç†ä¹‹å¤–ï¼ŒOpenGL ES 3.0å¯ä»¥åœ¨è¯»å–æ—¶æ¯”è¾ƒæ·±åº¦çº¹ç†ï¼Œä»è€Œåœ¨æ·±åº¦çº¹ç†ä¸Šå®ŒæˆåŒçº¿æ€§è¿‡æ»¤ï¼ˆä¹Ÿç§°ä½œç™¾åˆ†æ¯”æ¸è¿›è¿‡æ»¤ï¼ˆPCFï¼‰ï¼‰ã€‚ æ— ç¼ç«‹æ–¹å›¾â€”â€”åœ¨OpenGL ES 2.0ä¸­ï¼Œåˆ©ç”¨ç«‹æ–¹å›¾æ¸²æŸ“å¯èƒ½åœ¨ç«‹æ–¹å›¾ä¹‹é—´çš„è¾¹ç•Œäº§ç”Ÿä¼ªåƒã€‚ æµ®ç‚¹çº¹ç†â€”â€”OpenGl ES 3.0å¤§å¤§æ‰©å±•äº†æ‰€æ”¯æŒçš„çº¹ç†æ ¼å¼ï¼Œæ”¯æŒå¹¶å¯ä»¥è¿‡æ»¤æµ®ç‚¹åŠæµ®ç‚¹ï¼ˆ16ä½ï¼‰çº¹ç†ï¼Œä¹Ÿæ”¯æŒå…¨æµ®ç‚¹ï¼ˆ32ä½ï¼‰çº¹ç†ï¼Œä½†æ˜¯ä¸èƒ½è¿‡æ»¤ã€‚è®¿é—®æµ®ç‚¹çº¹ç†æ•°æ®çš„èƒ½åŠ›æœ‰è®¸å¤šåº”ç”¨ï¼ŒåŒ…æ‹¬é«˜åŠ¨æ€èŒƒå›´çº¹ç†å’Œå¤šåŠŸèƒ½è®¡ç®—ã€‚ ETC2/EACçº¹ç†å‹ç¼©â€”â€”å¤šç§OpenGL ES 2.0å®ç°æ”¯æŒä¾›åº”å•†ä¸“ç”¨å‹ç¼©çº¹ç†æ ¼å¼ï¼ˆä¾‹å¦‚é«˜é€šçš„ATCã€Imagination Technologiesçš„PVRTCï¼‰ã€‚åœ¨OpenGl ES 3.0ä¸­å¼ºåˆ¶æ”¯æŒETC2/EACã€‚ETC2/EACçš„æ ¼å¼ä¸ºRGB888ã€RGB8888å’Œå•é€šé“åŠåŒé€šé“æœ‰ç¬¦å·/æ— ç¬¦å·çº¹ç†æ•°æ®ã€‚çº¹ç†å‹ç¼©å…·æœ‰å¾ˆå¤šå¥½å¤„ï¼ŒåŒ…æ‹¬æ›´å¥½çš„æ€§èƒ½ï¼ˆå› ä¸ºæ›´å¥½åœ°åˆ©ç”¨äº†çº¹ç†ç¼“å­˜ï¼‰ä»¥åŠå‡å°‘GPUå†…å­˜å ç”¨ã€‚ æ•´æ•°çº¹ç†â€”â€”OpenGL ES 3.0å¼•å…¥äº†æ¸²æŸ“å’Œè¯»å–ä¿å­˜ä¸ºæœªè§„èŒƒåŒ–æœ‰ç¬¦å·æˆ–è€…æ— ç¬¦å·8ä½ã€16ä½å’Œ32ä½æ•´æ•°çº¹ç†çš„èƒ½åŠ›ã€‚ å…¶ä»–çº¹ç†æ ¼å¼â€”â€”é™¤äº†å‰é¢æåˆ°çš„æ ¼å¼ä¹‹å¤–ï¼ŒOpenGL ES 3.0è¿˜åŒ…å«äº†å¯¹11-11-10RGBæµ®ç‚¹çº¹ç†ã€å…±äº«æŒ‡æ•°RGB 9-9-9-5çº¹ç†ã€10-10-10-2æ•´æ•°çº¹ç†ä»¥åŠ8ä½åˆ†é‡æœ‰ç¬¦å·è§„èŒƒåŒ–çº¹ç†çš„æ”¯æŒã€‚ é2å¹‚æ¬¡çº¹ç†ï¼ˆNPOTï¼‰â€”â€”çº¹ç†ç°åœ¨å¯ä»¥æŒ‡å®šä¸ºä¸ä¸º2çš„å¹‚æ¬¡çš„å°ºå¯¸ã€‚è¿™åœ¨è®¸å¤šæƒ…å†µä¸‹éƒ½å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚æ¥è‡ªè§†é¢‘æˆ–è€…æ‘„åƒå¤´çš„ä»¥ä¸ä¸º2çš„å¹‚æ¬¡å°ºå¯¸æ•æ‰/è®°å½•çš„çº¹ç†ã€‚ çº¹ç†ç»†èŠ‚çº§åˆ«ï¼ˆLODï¼‰åŠŸèƒ½â€”â€”ç°åœ¨ï¼Œå¯ä»¥å¼ºåˆ¶ä½¿ç”¨ç”¨äºç¡®å®šè¯»å–å“ªä¸ªMipmapçš„LODå‚æ•°ã€‚æ­¤å¤–ï¼Œå¯ä»¥å¼ºåˆ¶åŸºæœ¬å’Œæœ€å¤§Mipmapçº§åˆ«ã€‚è¿™ä¸¤ä¸ªåŠŸèƒ½ç»„åˆèµ·æ¥ï¼Œå¯ä»¥æµåŒ–Mipmapã€‚åœ¨æ›´å¤§çš„Mipmapçº§åˆ«å¯ç”¨æ—¶ï¼Œå¯ä»¥æä¾›åŸºæœ¬çº§åˆ«ï¼ŒLODå€¼å¯ä»¥å¹³æ»‘åœ°å¢åŠ ï¼Œä»¥æä¾›å¹³æ»‘çš„æµåŒ–çº¹ç†ã€‚è¿™ä¸€åŠŸèƒ½éå¸¸å®ç”¨ï¼Œä¾‹å¦‚ï¼Œç”¨äºé€šè¿‡ç½‘ç»œè¿æ¥ä¸‹è½½çº¹ç†Mipmapã€‚]]></content>
      <categories>
        <category>OpenGL ES 3.0</category>
      </categories>
      <tags>
        <tag>OpenGL ES 3.0</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è²æ¶…å°”åå°„]]></title>
    <url>%2F2019%2F05%2F12%2Ffresnelreflection%2F</url>
    <content type="text"><![CDATA[åœ¨å®æ—¶æ¸²æŸ“ä¸­ï¼Œç»å¸¸ä¼šä½¿ç”¨è²æ¶…è€³åå°„ï¼ˆFresnel reflectionï¼‰æ¥æ ¹æ®è§†è§’æ–¹å‘æ§åˆ¶åå°„ç¨‹åº¦ã€‚è²æ¶…è€³åå°„æè¿°äº†ä¸€ç§å…‰å­¦ç°è±¡ï¼Œå³å½“å…‰çº¿ç…§å°„åˆ°ç‰©ä½“è¡¨é¢ä¸Šæ—¶ï¼Œä¸€éƒ¨åˆ†å‘ç”Ÿåå°„ï¼Œä¸€éƒ¨åˆ†è¿›å…¥ç‰©ä½“å†…éƒ¨ï¼Œå‘ç”ŸæŠ˜å°„æˆ–æ•£å°„ã€‚è¢«åå°„çš„å…‰å’Œå…¥å°„å…‰ä¹‹é—´å­˜åœ¨ä¸€å®šçš„æ¯”ç‡å…³ç³»ï¼Œè¿™ä¸ªæ¯”ç‡å…³ç³»å¯ä»¥é€šè¿‡è²æ¶…è€³ç­‰å¼è¿›è¡Œè®¡ç®—ã€‚ä¸€ä¸ªç»å¸¸ä½¿ç”¨çš„ä¾‹å­æ˜¯ï¼Œå½“ä½ ç«™åœ¨æ¹–è¾¹ï¼Œç›´æ¥ä½å¤´çœ‹è„šè¾¹çš„æ°´é¢æ—¶ï¼Œä½ ä¼šå‘ç°æ°´å‡ ä¹æ˜¯é€æ˜çš„ï¼Œä½ å¯ä»¥ç›´æ¥çœ‹åˆ°æ°´åº•çš„å°é±¼å’ŒçŸ³å­ï¼›ä½†æ˜¯ï¼Œå½“ä½ æŠ¬å¤´çœ‹è¿œå¤„çš„æ°´é¢æ—¶ï¼Œä¼šå‘ç°å‡ ä¹çœ‹ä¸åˆ°æ°´ä¸‹çš„æƒ…æ™¯ï¼Œè€Œåªèƒ½çœ‹åˆ°æ°´é¢åå°„çš„ç¯å¢ƒã€‚è¿™å°±æ˜¯æ‰€è°“çš„è²æ¶…è€³æ•ˆæœã€‚äº‹å®ä¸Šï¼Œä¸ä»…ä»…æ˜¯æ°´ã€ç»ç’ƒè¿™æ ·çš„åå…‰ç‰©ä½“å…·æœ‰è²æ¶…è€³æ•ˆæœï¼Œå‡ ä¹ä»»ä½•ç‰©ä½“éƒ½æˆ–å¤šæˆ–å°‘åŒ…å«äº†è²æ¶…è€³æ•ˆæœï¼Œè¿™æ˜¯åŸºäºç‰©ç†çš„æ¸²æŸ“ä¸­éå¸¸é‡è¦çš„ä¸€é¡¹é«˜å…‰åå°„è®¡ç®—å› å­ã€‚é‚£ä¹ˆï¼Œå¦‚ä½•è®¡ç®—è²æ¶…è€³åå°„å‘¢ï¼Ÿè¿™å°±éœ€è¦ä½¿ç”¨è²æ¶…è€³ç­‰å¼ã€‚çœŸå®ä¸–ç•Œçš„è²æ¶…è€³ç­‰å¼æ˜¯éå¸¸å¤æ‚çš„ï¼Œä½†åœ¨å®æ—¶æ¸²æŸ“ä¸­ï¼Œé€šå¸¸ä¼šä½¿ç”¨ä¸€äº›è¿‘ä¼¼å…¬å¼æ¥è®¡ç®—ã€‚å…¶ä¸­ä¸€ä¸ªè‘—åçš„è¿‘ä¼¼å…¬å¼å°±æ˜¯Schlick è²æ¶…è€³è¿‘ä¼¼ç­‰å¼ï¼š $F_{Schlick}(v,n) = F_{0}+(1-F_{0})(1-v \cdot n)^5$ å…¶ä¸­ï¼Œ$F_{0}$æ˜¯ä¸€ä¸ªåå°„ç³»æ•°ï¼Œç”¨äºæ§åˆ¶è²æ¶…è€³åå°„çš„å¼ºåº¦ï¼Œ v æ˜¯è§†è§’æ–¹å‘ï¼Œ n æ˜¯è¡¨é¢æ³•çº¿ã€‚å¦ä¸€ä¸ªåº”ç”¨æ¯”è¾ƒå¹¿æ³›çš„ç­‰å¼æ˜¯Empricialè²æ¶…è€³è¿‘ä¼¼ç­‰å¼ï¼š $F_{Empricial}(v,n) = max(0,min(1,bias+scale x (1-v \cdot n)^power))$ å…¶ä¸­ï¼Œbiasã€scaleå’Œpoweræ˜¯æ§åˆ¶é¡¹ã€‚ä½¿ç”¨ä¸Šé¢çš„è²æ¶…å°”è¿‘ä¼¼ç­‰å¼ï¼Œå¯ä»¥åœ¨è¾¹ç•Œå¤„æ¨¡æ‹Ÿåå°„å…‰å¼ºå’ŒæŠ˜å°„å…‰å¼º/æ¼«åå°„å…‰å¼ºä¹‹é—´çš„å˜åŒ–ã€‚åœ¨è®¸å¤šè½¦æ¼†ã€æ°´é¢ç­‰æè´¨çš„æ¸²æŸ“ä¸­ï¼Œä¼šç»å¸¸ç”¨åˆ°è²æ¶…å°”åå°„æ¥æ¨¡æ‹Ÿæ›´åŠ çœŸå®çš„åå°„ã€‚]]></content>
      <categories>
        <category>å›¾å½¢</category>
      </categories>
      <tags>
        <tag>å›¾å½¢</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ–¯æ¶…å°”å®šå¾‹]]></title>
    <url>%2F2019%2F05%2F12%2Fsnell%2F</url>
    <content type="text"><![CDATA[æè¿°å½“å…‰æ³¢ä»ä¸€ç§ä»‹è´¨ä¼ æ’­åˆ°å¦ä¸€ç§å…·æœ‰ä¸åŒæŠ˜å°„ç‡çš„ä»‹è´¨æ—¶ï¼Œä¼šå‘ç”ŸæŠ˜å°„ç°è±¡ï¼Œå…¶å…¥å°„è§’ä¸æŠ˜å°„è§’ä¹‹é—´çš„å…³ç³»ï¼Œå¯ä»¥ç”¨æ–¯æ¶…å°”å®šå¾‹ï¼ˆSnellâ€™s Lawï¼‰æ¥æè¿°ã€‚è§£é‡Šå¦‚ä¸‹ï¼šå…¥å°„å…‰å’ŒæŠ˜å°„å…‰ä½äºåŒä¸€å¹³é¢ä¸Šï¼Œå¹¶ä¸”ä¸ç•Œé¢æ³•çº¿çš„å¤¹è§’æ»¡è¶³å¦‚ä¸‹å…³ç³»ï¼š${n_1}sin\theta_1={n_2}sin\theta_2$ï¼Œå…¶ä¸­ï¼Œ$n_1$å’Œ$n_2$åˆ†åˆ«æ˜¯ä¸¤ä¸ªä»‹è´¨çš„æŠ˜å°„ç‡ï¼Œ$\theta_1$å’Œ$\theta_2$åˆ†åˆ«æ˜¯å…¥å°„å…‰ï¼ˆæˆ–æŠ˜å°„å…‰ï¼‰ä¸ç•Œé¢æ³•çº¿çš„å¤¹è§’ï¼Œå«åšå…¥å°„è§’å’ŒæŠ˜å°„è§’ã€‚ ç‰¹æ®Šæƒ…å†µåœ¨æŠ˜å°„å®šå¾‹ä¸­ï¼Œè‹¥ä»¤$n_1$å’Œ$n_2$ï¼Œåˆ™å¾—åˆ°åå°„å®šå¾‹ï¼Œå› æ­¤ï¼Œå¯ä»¥å°†åå°„å®šå¾‹çœ‹åšæŠ˜å°„å®šå¾‹çš„ä¸€ä¸ªç‰¹ä¾‹ã€‚å½“å…‰ç”±å…‰å¯†ä»‹è´¨ï¼ˆæŠ˜å°„ç‡$n_1$æ¯”è¾ƒå¤§çš„ä»‹è´¨ï¼‰å°„å…¥å…‰ç–ä»‹è´¨ï¼ˆæŠ˜å°„ç‡$n_2$æ¯”è¾ƒå°çš„ä»‹è´¨ï¼‰æ—¶ï¼ˆæ¯”å¦‚ç”±æ°´å…¥å°„åˆ°ç©ºæ°”ä¸­ï¼‰ï¼Œå¦‚æœå…¥å°„è§’$\theta_1$ç­‰äºæŸä¸€ä¸ªè§’$\theta_c$æ—¶ï¼ŒæŠ˜å°„å…‰çº¿ä¼šæ²¿æŠ˜å°„ç•Œé¢çš„åˆ‡çº¿è¿›è¡Œï¼Œå³æŠ˜å°„è§’$\theta_2=90$Â°,æ­¤æ—¶ä¼šæœ‰$sin\theta_2=1$ï¼Œåˆ™å¯æ¨å‡º$sin\theta_ c=sin\theta_1={n2\over n1}$ã€‚ä½†å¦‚æœå…¥å°„è§’$\theta_1$å¤§äº$\theta_c$æ—¶ï¼Œå…¥å°„è§’çš„æ­£å¼¦$sin\theta_1&gt;{n2\over n1}$ï¼Œä¼šæ¨å‡º$sin\theta_2&gt;1$ã€‚è¿™åœ¨ç‰©ç†ä¸Šæ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œæ‰€ä»¥æ­¤æ—¶ï¼Œä¸å­˜åœ¨æŠ˜å°„å…‰ï¼Œè€Œåªå­˜åœ¨åå°„å…‰ï¼Œäºæ˜¯ä¾¿å‘ç”Ÿå…¨åå°„ã€‚è€Œä½¿å¾—å…¨åå°„å‘ç”Ÿçš„æœ€å°å…¥å°„è§’$\theta_c$å«åšä¸´ç•Œè§’ï¼Œå®ƒçš„å€¼å–å†³äºä¸¤ç§ä»‹è´¨çš„æŠ˜å°„ç‡çš„æ¯”å€¼ï¼Œå³ $\theta_c=sin^{-1}{({n_2\over n_1})}$ä¾‹å¦‚ï¼šæ°´çš„æŠ˜å°„ç‡ä¸º1.33ï¼Œç©ºæ°”çš„æŠ˜å°„ç‡è¿‘ä¼¼ç­‰äº1.00001ï¼Œä¸´ç•Œè§’$\theta_c$ç­‰äº48.8Â°ã€‚]]></content>
      <categories>
        <category>å…‰å­¦</category>
      </categories>
      <tags>
        <tag>å…‰å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆ«ç¦»]]></title>
    <url>%2F2019%2F05%2F12%2Ffiction-1%2F</url>
    <content type="text"><![CDATA[èŠ©ç«™åœ¨åºœé—¨å¤–é¢ï¼Œæ­¤æ—¶é—¨å£çš„æŠ¤å«å·²ç»å›å»äº†ï¼Œå‰©ä¸‹é—¨ä¸ŠæŒ‚ç€çš„ä¸¤ç›ä¸ç®—å¾ˆæ˜äº®çš„ç¯ç¬¼ï¼Œè¿˜æœ‰é—¨å£çš„ä¸¤ä¸ªçŸ³ç‹®å­ã€‚è°ä¹Ÿçœ‹ä¸å‡ºä»–æ˜¯æƒ³è¿›å»è¿˜æ˜¯æƒ³åœ¨å¤–é¢ç­‰ä»€ä¹ˆäººï¼Œæ‰‹æ¡ç€æŒ‚åœ¨è…°ä¸Šçš„å‰‘ï¼Œå¤´ä¸Šæˆ´ç€æ–—ç¬ ã€‚å°±è¿™æ ·ç«™åœ¨é—¨å£ï¼Œä¼¼ä¹æ˜¯æœ‰äº›å¥‡æ€ªï¼Œå¹³æ—¥é‡Œï¼Œä»–æ€»æ˜¯åœ¨å‹¤äºç»ƒä¹ ä»–çš„å‰‘æ³•ã€‚è™½ç„¶èŠ©ä¸æ˜¯ç‰¹åˆ«æœ‰å¤©èµ‹çš„äººï¼Œä½†æ˜¯å´ç‰¹åˆ«çš„åŠªåŠ›ã€‚å½“åˆ«äººé—®èµ·ä»–ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå‹¤äºç»ƒä¹ çš„æ—¶å€™ï¼Œä»–å´è¯´ï¼Œâ€œå“¦ï¼Œä¹Ÿå°±æ— èŠçš„æ—¶å€™ç»ƒç»ƒã€‚â€ã€‚ç»™äººä¸€ç§æœ¨è®·çš„æ„Ÿè§‰ã€‚å¤§æ¦‚åœ¨ç­‰äº†æœ‰ä¸€åˆ»é’Ÿçš„æ—¶å€™ï¼Œå¾å¨˜å›æ¥äº†ï¼ŒåŸæ¥ä»Šå¤©æ˜¯å¾å¨˜å»ç‹çˆ·åºœç»™ç‹å¦ƒè¯·å®‰å»äº†ã€‚â€œå“Ÿï¼ŒèŠ©ï¼Œä½ åœ¨è¿™é‡Œå¹²å˜›å‘¢ï¼Ÿâ€ï¼Œå¾å¨˜æœ‰äº›å…´å¥‹çš„è¯´é“ã€‚â€œå¾å¨˜ï¼Œå’Œæ€»ç®¡è¯´ä¸€å£°ï¼Œæˆ‘æ‰“ç®—æ˜å¤©ç¦»å¼€ç§¦æ·®ã€‚â€ï¼ŒèŠ©æ·¡æ·¡çš„è¯´é“ã€‚â€œä¸æ˜¯å§ï¼Ÿè¿™ä¹ˆå¿«å°±è¦èµ°äº†å—ï¼Ÿè¿˜æœ‰ç‚¹èˆä¸å¾—ä½ å‘¢ã€‚ä¸è¿‡ä½ è¿˜æ˜¯è‡ªå·±è¿›å»å’Œæ€»ç®¡å¤§äººè¯´å§ï¼Œæ¥éƒ½æ¥äº†ï¼Œé¡ºä¾¿è¿›å»å’Œæ€»ç®¡å¥½å¥½é“åˆ«ä¸€ä¸‹å§ã€‚â€ï¼Œå¾å¨˜æ¢å¤äº†æ­£å¸¸çš„ç¥æ€ã€‚â€œä¸äº†ï¼Œä»Šæ™šå›å»æ”¶æ‹¾æ”¶æ‹¾ï¼Œæ˜å¤©å¤©ä¸€äº®å°±åŠ¨èº«äº†ã€‚â€ï¼ŒèŠ©è¯´é“ã€‚â€œè¿™ä¹ˆæ€¥ï¼Ÿâ€ï¼Œå¾å¨˜è¯´ã€‚â€œå—¯ã€‚â€ï¼ŒèŠ©è¯´ã€‚â€œå¥½å§ï¼Œé‚£æˆ‘æ›¿ä½ å’Œæ€»ç®¡å¤§äººç¦€æŠ¥ä¸€ä¸‹ï¼Œä¹Ÿç¥ä½ ä¸€è·¯é¡ºé£ã€‚â€ï¼Œå¾å¨˜è¯´ã€‚â€œå—¯ã€‚â€ï¼ŒèŠ©è¯´å®Œè½¬èº«ç¦»å¼€ã€‚åœ¨å›æ¥çš„è·¯ä¸Šï¼ŒèŠ©ç¼“æ…¢çš„èµ°åœ¨è·¯ä¸Šï¼Œå…¶å®ä¹Ÿä¸ç®—æ…¢äº†ï¼Œä½†æ˜¯å’Œä¹‹å‰æ¯”èµ·æ¥ï¼Œç¡®å®æ…¢äº†è®¸å¤šã€‚æœˆäº®æ—©å·²é«˜é«˜æŒ‚åœ¨å¤©ä¸Šäº†ï¼Œç”±äºä»Šå¤©æ˜¯æ»¡æœˆï¼Œå¯ä»¥æ¯”è¾ƒæ¸…æ¥šçš„çœ‹åˆ°å‘¨å›´çš„å»ºç­‘å’Œé“è·¯ï¼Œè™½ç„¶æ™šä¸Šä¸€ä¸ªäººéƒ½æ²¡æœ‰ã€‚èµ°è¿™ä¹ˆæ…¢åœ¨æƒ³ä»€ä¹ˆå‘¢ï¼Ÿæƒ³ç€è‡ªå·±é©¬ä¸Šè¦ç¦»å¼€äº†å—ï¼Ÿè¦å»ä¸€ä¸ªå¯ä»¥è®©è‡ªå·±çš„æ­¦åŠ›å’Œå‰‘æœ¯æ›´ä¸Šä¸€å±‚æ¥¼çš„åœ°æ–¹äº†å—ï¼Ÿæƒ³ä»¥åçš„æ—¥å­ä¼šå˜æˆä»€ä¹ˆæ ·å­çš„å‘¢ï¼Ÿè°ä¹Ÿä¸çŸ¥é“ï¼Œæ€»ä¹‹é€‰æ‹©äº†ï¼Œä¹Ÿåªèƒ½æŒ‰ç…§é€‰æ‹©çš„æ–¹å¼å»ç”Ÿæ´»å§ã€‚]]></content>
      <tags>
        <tag>æ··æ²Œ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‚…é‡Œå¶å˜æ¢]]></title>
    <url>%2F2019%2F05%2F11%2Ffouriertransform%2F</url>
    <content type="text"><![CDATA[ä»€ä¹ˆæ˜¯é¢‘åŸŸä»æˆ‘ä»¬å‡ºç”Ÿï¼Œæˆ‘ä»¬çœ‹åˆ°çš„ä¸–ç•Œéƒ½ä»¥æ—¶é—´è´¯ç©¿ï¼Œè‚¡ç¥¨çš„èµ°åŠ¿ã€äººçš„èº«é«˜ã€æ±½è½¦çš„è½¨è¿¹éƒ½ä¼šéšç€æ—¶é—´å‘ç”Ÿæ”¹å˜ã€‚è¿™ç§ä»¥æ—¶é—´ä½œä¸ºå‚ç…§ç‰©æ¥è§‚å¯ŸåŠ¨æ€ä¸–ç•Œçš„æ–¹æ³•æˆ‘ä»¬ç§°å…¶ä¸ºæ—¶åŸŸåˆ†æã€‚è€Œæˆ‘ä»¬ä¹Ÿæƒ³å½“ç„¶çš„è®¤ä¸ºï¼Œä¸–é—´ä¸‡ç‰©éƒ½åœ¨éšæ—¶é—´ä¸åœçš„æ”¹å˜ï¼Œå¹¶ä¸”æ°¸è¿œä¸ä¼šé™æ­¢ã€‚ä½†å¦‚æœæˆ‘å‘Šè¯‰ä½ ï¼Œç”¨å¦ä¸€ç§æ–¹æ³•æ¥è§‚å¯Ÿä¸–ç•Œçš„è¯ï¼Œä½ ä¼šå‘ç°ä¸–ç•Œæ˜¯æ°¸æ’ä¸å˜çš„ï¼Œè¿™ä¸ªé™æ­¢çš„ä¸–ç•Œå°±å«åšé¢‘åŸŸã€‚ æˆ‘ä»¬çœ¼ä¸­çš„ä¸–ç•Œå°±åƒçš®å½±æˆä¸­çš„å¤§å¹•æ­¥ï¼Œå¹•å¸ƒçš„å€™é¢æœ‰æ— æ•°çš„é½¿è½®ï¼Œå¤§é½¿è½®å¸¦åŠ¨å°é½¿è½®ï¼Œå°é½¿è½®åœ¨å¸¦åŠ¨æ›´å°çš„ã€‚åœ¨æœ€å¤–é¢çš„å°é½¿è½®ä¸Šæœ‰ä¸ªå°äººï¼Œé‚£å°±æ˜¯æˆ‘ä»¬è‡ªå·±ã€‚æˆ‘ä»¬åªçœ‹åˆ°è¿™ä¸ªå°äººæ¯«æ— è§„å¾‹çš„åœ¨å¹•å¸ƒå‰è¡¨æ¼”ï¼Œå´æ— æ³•é¢„æµ‹ä»–ä¸‹ä¸€æ­¥å»å“ªã€‚è€Œå¹•å¸ƒå€™é¢çš„é½¿è½®å´æ°¸è¿œä¸€ç›´é‚£æ ·ä¸åœçš„æ—‹è½¬ï¼Œæ°¸ä¸åœæ­‡ã€‚ ç¦»æ•£å‚…é‡Œå¶å˜æ¢(DFT)å®šä¹‰ç¦»æ•£å‚…é‡Œå¶å˜æ¢ï¼Œæ˜¯å‚…é‡Œå¶å˜æ¢åœ¨æ—¶åŸŸå’Œé¢‘åŸŸä¸Šéƒ½å‘ˆç°ç¦»æ•£çš„å½¢å¼ï¼Œå°†æ—¶åŸŸä¿¡å·çš„é‡‡æ ·å˜æ¢ä¸ºç¦»æ•£æ—¶é—´å‚…é‡Œå¶å˜æ¢(DTFT)é¢‘åŸŸçš„é‡‡æ ·ã€‚åœ¨å½¢å¼ä¸Šï¼Œå˜æ¢ä¸¤ç«¯ï¼ˆæ—¶åŸŸå’Œé¢‘åŸŸä¸Šï¼‰çš„æ—¶åºæ˜¯æœ‰é™é•¿çš„ï¼Œè€Œå®é™…ä¸Šè¿™ä¸¤ç»„åºåˆ—åº”å½“è¢«è®¤ä¸ºç¦»æ•£å‘¨æœŸä¿¡å·çš„ä¸»å€¼åºåˆ—ã€‚å³ä½¿å¯¹æœ‰ç°åœºçš„ç¦»æ•£ä¿¡å·åšDFTï¼Œä¹Ÿåº”å½“å°†å…¶çœ‹ä½œç»è¿‡å‘¨æœŸå»¶æ‹“æˆä¸ºå‘¨æœŸä¿¡å·å†åšå˜æ¢ã€‚åœ¨å®é™…åº”ç”¨ä¸­é€šå¸¸é‡‡ç”¨å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ä»¥é«˜æ•ˆè®¡ç®—DFTã€‚ å¿«é€Ÿå‚…é‡Œå¶å˜æ¢(FFT)]]></content>
      <categories>
        <category>Math</category>
      </categories>
      <tags>
        <tag>Math</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[zbrush]]></title>
    <url>%2F2019%2F05%2F11%2Fzbrush%2F</url>
    <content type="text"><![CDATA[ç©ºæ ¼é”® æ¿€æ´»é¼ æ ‡æŒ‡é’ˆä¸‹çš„èœå•ï¼ˆæŒ‰ä½ä¸æ”¾å†æ‹–æ‹‰é¼ æ ‡æŒ‡é’ˆå¯å®šä½æ–‡æ¡£ï¼‰å·¦é”®åœ¨ç©ºç™½å¤„å•å‡»å¹¶æ‹–åŠ¨ï¼æ—‹è½¬è§†è§’altå»ºï¼‹å·¦é”®åœ¨ç©ºç™½å¤„å•å‡»å¹¶æ‹–åŠ¨ï¼å¹³ç§»è§†è§’alté”®ï¼‹å·¦é”®ç„¶åæ”¾å¼€alté”®åœ¨ç©ºç™½å¤„æ‹–åŠ¨å¹¶å¹³ç§»ï¼ç¼©æ”¾è§†è§’ æ”¾å¤§æ–‡æ¡£ ç¼©å°æ–‡æ¡£0ï¼ˆé›¶ï¼‰ æŸ¥é˜…æ–‡æ¡£çš„å®é™…å¤§å°æ—‹è½¬ä¸­é…åˆ shift ï¼Œæ•æ‰åœ¨æ­£äº¤è§†ç‚¹å¤„æ—‹è½¬ä¸­é…åˆ ALT ï¼Œä»¥ç›¸å¯¹å¹³æ»‘æ–¹å¼æ—‹è½¬è§†å›¾æŒ‰ä¸‹ DEL ï¼Œå¯ä»¥å°†ç‰©ä½“åœ¨ç”»å¸ƒä¸­æœ€å¤§åŒ–æ˜¾ç¤ºCtrl+0 æŸ¥é˜…æ–‡æ¡£å®é™…å¤§å°çš„ä¸€åŠï¼ŒæŠ—é”¯é½¿ï¼ˆè¿˜å½±å“è¾“å‡ºï¼‰ctrl+shift+æ‹–åŠ¨=æœªé€‰ä¸­çš„éƒ¨åˆ†å°†éšè—ã€‚ctrl+shift+ç‚¹å‡»ç©ºç™½å¤„=æ¢å¤æ˜¾ç¤ºctrl+shift+æ‹–åŠ¨+é‡Šæ”¾ï¼ˆctrlã€shiftï¼‰=é€‰ä¸­çš„éƒ¨åˆ†å°†éšè—Ctrl+f ç”¨å½“å‰textureå¡«å……canvaså½“å‰layerCtrl é®ç½©åŠŸèƒ½Ctrl+d ç»†ä»½ä¸€æ¬¡Tab éšè—/æ˜¾ç¤ºæµ®åŠ¨è°ƒæ§æ¿H éšè—/æ˜¾ç¤ºZscriptçª—å£C åœ¨æŒ‡é’ˆä¸‹é¢æ‹¾å–é¢œè‰²S ç»˜å›¾å¤§å°I RGBå¼ºåº¦Shift+I Zå¼ºåº¦Shift+d ç»˜åˆ¶è´´å›¾çš„æ—¶å€™è®©æ¨¡å‹ä¸Šçš„ç½‘æ ¼çº¿éšè—Q ç»˜å›¾æŒ‡ç¤ºå™¨ï¼ˆé»˜è®¤ä¸ºæ‰€æœ‰å·¥å…·ï¼‰W ç§»åŠ¨æ¨¡å¼E ç¼©æ”¾æ¨¡å¼R æ—‹è½¬æ¨¡å¼T ç¼–è¾‘æ¨¡å¼Shift+s å¤‡ä»½ç‰©ä½“M æ ‡è®°ç‰©ä½“ç‚¹ä¸­marker ctrl+M å–æ¶ˆæ ‡è®°Ctrl+Z æ’¤é”€Shift+Ctrl+Z é‡åšAlt/Option å½±å“è½¬æ¢å¤§å¤šæ•°å·¥å…·G æ‰“å¼€Projection MasterAlt+A Alphaè°ƒæ§æ¿Alt+C Coloré¢œè‰²è°ƒæ§æ¿Alt+T toolè°ƒæ§æ¿Alt+T Transformè°ƒæ§æ¿Alt+R Renderè°ƒæ§æ¿Alt+é¼ æ ‡å·¦ ç»˜å›¾æ¨¡å¼ä¸‹å¯ä»¥åˆ é™¤Zæ±‚ç‚¹ Shift+creaseâ€”â€”â€”â€”â€”â€”â€”crease everythingShift_uncreaseâ€”â€”â€”â€”â€”â€”uncrease everythingA â€”â€”â€”â€”â€”â€”â€”â€”â€”zSphere to Z meshctrl+N â€”â€”â€”â€”â€”â€”â€”â€”- clear the layer]]></content>
      <categories>
        <category>ZBrush</category>
      </categories>
      <tags>
        <tag>ZBrush</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[3DMAXå¿«æ·é”®æ“ä½œ]]></title>
    <url>%2F2019%2F05%2F11%2F3dmax%2F</url>
    <content type="text"><![CDATA[å·¥å…·æ ä¸»å·¥å…·æ ï¼ˆMain Toolbarsï¼‰:æŒ‰ALT+6å¯ä»¥è¿›è¡Œéšè—/æ˜¾ç¤ºï¼Œå…¶ä»–å·¥å…·æ å¯ä»¥é€‰æ‹©èœå•Customize\Show UI(è‡ªå®šä¹‰\æ˜¾ç¤ºç”¨æˆ·ç•Œé¢)è¿›è¡Œæ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚ å·¥ä½œè§†å›¾1ã€è§†å›¾åˆ‡æ¢å¯ç›´æ¥æŒ‰å¿«æ·é”®çš„æœ‰ï¼š Tâ€”Topï¼ˆé¡¶è§†å›¾ï¼‰ã€Bâ€”Bottomï¼ˆåº•è§†å›¾ï¼‰ã€Fâ€”Frontï¼ˆå‰è§†å›¾ï¼‰Lâ€”Leftï¼ˆå·¦è§†å›¾ï¼‰ã€Uâ€”Userï¼ˆç”¨æˆ·è§†å›¾ï¼‰ã€Pâ€”Perspectiveï¼ˆé€è§†å›¾ï¼‰Câ€”Camaraï¼ˆæ‘„åƒæœºè§†å›¾ï¼Œåªæœ‰å»ºç«‹æ‘„åƒæœºåæ‰æœ‰ç”¨ï¼‰å…¶ä»–ä¸èƒ½æŒ‰å¿«æ·é”®çš„æ“ä½œå¦‚ä¸‹ï¼ša.æ¿€æ´»è§†å›¾ï¼ŒæŒ‰Vé”®ï¼Œä»å¿«æ·èœå•ä¸­è¿›è¡Œé€‰æ‹©b.åœ¨è§†å›¾åç§°å¤„æŒ‰å³é”®é€‰æ‹©Views(æŸ¥çœ‹)å‘½ä»¤åé¢çš„ç›¸åº”è§†å›¾2ã€è§†å›¾ä¸­çš„ç‰©ä½“æ˜¾ç¤ºæ–¹å¼Wireframeï¼ˆç½‘æ ¼ï¼‰ï¼šä»¥ç‰©ä½“é¢œè‰²æ˜¾ç¤ºç½‘æ ¼ï¼Œæè´¨ä¸æ˜¾ç¤ºSmooth+HighLightsï¼ˆå®ä½“ï¼‰ä»¥ä¸Šä¸¤ç§å¯ä»¥æŒ‰F3è¿›è¡Œåˆ‡æ¢Otheråé¢çš„æœ‰Smoothï¼ˆå…‰æ»‘ï¼‰ï¼šåªè¿›è¡Œå…‰æ»‘æ˜¾ç¤ºï¼Œä¸ä¼šæ˜¾ç¤ºé«˜å…‰Facets+Highlightsï¼šæ˜¾ç¤ºé¢çŠ¶+é«˜å…‰ï¼Œä¸è¿›è¡Œå…‰æ»‘æ˜¾ç¤ºFacets:åªæŒ‰é¢çŠ¶æ˜¾ç¤ºLit Wireframeï¼šä»¥æè´¨æ ‡å‡†æ–¹å¼æ˜¾ç¤ºç½‘æ ¼ï¼Œä¸ç‰©ä½“é¢œè‰²è®¾ç½®æ— å…³Bounding Boxï¼šè¾¹ç•Œç›’å­ï¼ŒæŒ‰ç‰©ä½“æœ€å¤§ä½“ç§¯è¾¹ç•Œæ–¹ç›’æ˜¾ç¤ºï¼Œè¿™ç§æ–¹å¼è§†å›¾åˆ·æ–°æœ€å¿«Facets Edges:æŒ‰ç½‘æ ¼å’Œå®ä½“åŒæ—¶æ˜¾ç¤ºï¼Œå¯æŒ‰F4è¿›è¡Œåˆ‡æ¢Alt+Xâ€”å°†ç‰©ä½“æŒ‰é€æ˜æ–¹å¼æ˜¾ç¤º3ã€æ”¹å˜è§†å›¾å¤§å°å°†é¼ æ ‡ç½®äºè§†å›¾çª—å£äº¤ç•Œå‡ºæ‹–åŠ¨å³å¯ä»»æ„æ”¹å˜è§†å›¾å¤§å°ï¼Œè¿˜åŸæ—¶åœ¨çª—å£è¾¹ç•Œå¤„æŒ‰å³é”®ï¼Œé€‰æ‹©Rest Layoutï¼ˆé‡æ–°æ¢å¤å¸ƒå±€ï¼‰å‘½ä»¤å³å¯ã€‚å•ç‹¬æ”¾å¤§æŸä¸ªè§†å›¾ï¼šæŒ‰Alt+Wé”®ï¼Œå†æ¬¡ä½¿ç”¨è¿˜åŸã€‚4ã€éšè—/æ˜¾ç¤ºè§†å›¾ç½‘æ ¼â€”æŒ‰Gé”®5ã€è§†å›¾å¸ƒå±€é€‰æ‹©èœå•Customize\Viewport Configration(è‡ªå®šä¹‰\è§†å›¾é…ç½®)å‘½ä»¤ï¼Œé€‰æ‹©Layoutï¼ˆå¸ƒå±€ï¼‰é€‰é¡¹6ã€è§†å›¾å¸ƒå±€é£æ ¼é€‰æ‹©èœå•Customize\Lode Custom UI Scheme(è‡ªå®šä¹‰\è£…è½½è‡ªå®šä¹‰ç”¨æˆ·ç•Œé¢æ–¹æ¡ˆ)å‘½ä»¤ é¼ æ ‡æ“ä½œ:ç›´æ¥æŒ‰â€ä¸­é”®â€â€”å¹³ç§»è§†å›¾Alt+â€ä¸­é”®â€â€”æŒ‰ä»»æ„è§’åº¦æ—‹è½¬è§†å›¾Ctrl+Alt+â€ä¸­é”®â€â€”ç¼©æ”¾è§†å›¾Shift+Alt+â€ä¸­é”®â€â€”æ°´å¹³æˆ–å‚ç›´æ—‹è½¬è§†å›¾äº”ã€å‘½ä»¤é¢æ¿ï¼ˆCommand Panalï¼‰æœ€é¡¶ä¸Šä¸€æ’å›¾æ ‡åˆ†åˆ«è¡¨ç¤ºCreate(åˆ›å»º)ã€Modifyï¼ˆä¿®æ”¹ï¼‰ã€Hiaracherï¼ˆå±‚çº§ï¼‰ã€Motionï¼ˆè¿åŠ¨ï¼‰ã€Displayï¼ˆæ˜¾ç¤ºï¼‰ã€Utilitiesï¼ˆå®ç”¨ç¨‹åºï¼‰å…­ã€å…¶ä»–ï¼ˆè½¨è¿¹æ ã€çŠ¶æ€æ ã€æç¤ºæ ã€åŠ¨ç”»æ’­æ”¾åŒºç­‰ï¼‰ç•¥ é€‰æ‹©æ“ä½œ1ã€å¤šé€‰ç‰©ä½“ï¼šA:æŒ‰Ctrlé”®å¢åŠ ç‰©ä½“é€‰æ‹©ï¼ŒæŒ‰Alté”®å‡å°‘ç‰©ä½“é€‰æ‹©Bï¼šæ¡†é€‰ï¼Œæœ‰çŸ©å½¢ã€åœ†å½¢ã€å¤šè¾¹å½¢ã€å¥—ç´¢å››ç§èŒƒå›´2ã€ç¼–è¾‘èœå•ä¸­çš„å‡ ä¸ªé€‰æ‹©å‘½ä»¤ï¼šSelect Invert(åé€‰)ï¼ˆctrl+iï¼‰ã€Select by Color(æŒ‰é¢œè‰²é€‰æ‹©)ã€Select by name(æŒ‰åç§°é€‰æ‹©)3ã€å·¥å…·èœå•ä¸­çš„é€‰æ‹©å‘½ä»¤ï¼šIsolate Selection:å•ç‹¬æ˜¾ç¤ºè¢«é€‰æ‹©çš„ç‰©ä½“ï¼ˆalt+q ï¼‰ï¼Œè‡ªåŠ¨éšè—å…¶ä»–ç‰©ä½“ï¼ˆéé€‰æ‹©ï¼‰å…³é—­Isolate Selectionè­¦å‘Šå¯¹è¯æ¡†è¿›è¡Œè¿˜åŸã€‚4ã€å‘½åé€‰æ‹©é›†åˆå®ä¾‹ï¼šå°çƒæ¡Œç‰©ä½“çš„æ“ä½œ å¤åˆ¶æ“ä½œ ä½¿ç”¨èœå•Edit\Cloneï¼ˆç¼–è¾‘\å…‹éš†ï¼‰å‘½ä»¤ã€‚2ã€ä½¿ç”¨å˜æ¢å·¥å…·è¿›è¡Œå¤åˆ¶ï¼ˆç§»åŠ¨ã€æ—‹è½¬ã€ç¼©æ”¾ï¼‰3ã€ä½¿ç”¨é•œå‘å·¥å…·å¤åˆ¶ä¸‰ã€å˜æ¢æ“ä½œ1ã€ç§»åŠ¨ï¼šç§»åŠ¨æ§åˆ¶è½´ç”±ä¸¤ä¸¤å‚ç›´çš„ä¸‰ä¸ªå•å‘è½´ç»„æˆï¼Œæ˜¾ç¤ºä¸ºçº¢ã€ç»¿ã€ç¯®é¢œè‰²çš„ä¸‰ä¸ªè½´å‘åˆ†åˆ«ä»£è¡¨Xã€Yã€Zæ–¹å‘ï¼Œæ“ä½œæ—¶æ—¢å¯å•ç‹¬é”å®šæ§åˆ¶è½´è¿›è¡Œå•è½´æ–¹å‘ä¸Šçš„ç§»åŠ¨ï¼Œä¹Ÿå¯å°† é¼ æ ‡å®šåœ¨é è¿‘ä¸¤è½´äº¤ç‚¹çš„é»„è‰²å¹³é¢åŒºåŸŸå†…æŒ‰å¹³é¢çš„æ–¹å¼è¿›è¡Œä»»æ„ç§»åŠ¨ã€‚2ã€æ—‹è½¬ï¼šæ—‹è½¬ç‰©ä½“æ—¶ï¼Œå…¶å¤–å›´ä¼šå‡ºç°ä¸‰ä¸ªçƒå½¢æ§åˆ¶è½´ï¼Œæ˜¾ç¤ºä¸ºçº¢ã€ç»¿ã€è“åœ†å¼§çº¿æ¡çš„ä¸ºå•å‘æ—‹è½¬è½´ï¼Œåˆ†åˆ«ä»£è¡¨Xã€Yã€Zä¸‰ä¸ªè½´å‘ï¼Œå½“å‰æ“çºµçš„è½´å‘ä¼šæ˜¾ç¤ºä¸ºé»„è‰²ï¼›å†…åœˆçš„ç°è‰²åœ†å¼§å¯ä»¥è¿›è¡Œç©ºé—´ä¸Šçš„æ—‹è½¬ï¼Œå¯å°†ç‰©ä½“åœ¨ä¸‰ä¸ªè½´å‘ä¸ŠåŒæ—¶è¿›è¡Œæ—‹è½¬ï¼›å¤–åœˆçš„ç°ç™½è‰²åœ†å¼§å¯ä»¥åœ¨å½“å‰è§†å›¾è§’åº¦çš„å¹³é¢ä¸Šè¿›è¡Œæ—‹è½¬ã€‚3ã€ç¼©æ”¾ï¼š5.0ç‰ˆå¯¹ç¼©æ”¾æ§åˆ¶è½´åšäº†å¾ˆå¤§æ”¹è¿›ï¼Œå¯ä»¥ç›´æ¥åœ¨æ§åˆ¶è½´ä¸Šå®ç°ç­‰æ¯”å’Œéç­‰æ¯”æ“ä½œï¼Œå…¶æ§åˆ¶è½´å‘ˆä¸‰è§’å½¢ï¼Œæ˜¾ç¤ºä¸ºçº¢ã€ç»¿ã€è“ç®­å¤´è½´å‘ä¸ºå•å‘ç¼©æ”¾è½´ï¼Œåˆ†åˆ«ä»£è¡¨Xã€Yã€Zä¸‰ä¸ªè½´å‘ã€‚æ“ä½œæ—¶æ‹–åŠ¨å†…éƒ¨ä¸­å¿ƒçš„ä¸‰è§’åŒºåŸŸå¯ä»¥è¿›è¡Œç­‰æ¯”ä¾‹ç¼©æ”¾ï¼›æ‹–åŠ¨å•ä¸ªè½´å‘ï¼Œå¯ä»¥è¿›è¡Œå•æ–¹å‘ä¸Šç¼©æ”¾ï¼›æ‹–åŠ¨å¤–ä¾§çš„ä¸‰è§’å¹³é¢å¯ä»¥è¿›è¡ŒåŒæ–¹å‘ä¸Šçš„åŒæ—¶ç¼©æ”¾ã€‚å››ã€å®ä¾‹ï¼š1ã€ä½¿ç”¨å±€å¸ƒï¼ˆLocalï¼‰åæ ‡ç³»ç»Ÿç§»åŠ¨æ–œæ³¢ç‰©ä½“ã€‚2ã€å¤åˆ¶è¥¿é¤æ¤…å­ï¼ˆå¯ä½¿ç”¨ç§»åŠ¨ã€æ—‹è½¬ã€é•œå‘å·¥å…·å®Œæˆï¼‰3ã€å¤åˆ¶çŸ³å‡³ï¼ˆä½¿ç”¨æ—‹è½¬å·¥å…·ï¼‰è¦ç‚¹ï¼šAï¼šç§»åŠ¨å’Œå¯¹é½è½´å¿ƒç‚¹ï¼›Bï¼šæ•æ‰è§’åº¦ ç¬¬ä¸‰è®²ä¸€ã€å¤ä¹ äºŒã€ç¾¤ç»„æ“ä½œGroupï¼ˆæˆç»„ï¼‰ï¼šå°†å¤šä¸ªé€‰æ‹©çš„ç‰©ä½“ç»„æˆä¸€ä¸ªç»„Ungroupï¼ˆè§£ç»„ï¼‰ï¼šå°†ç¾¤ç»„è§£æ•£ï¼Œä¸€æ¬¡åªèƒ½è§£æ•£ä¸€ä¸ªç»„Openï¼ˆæ‰“å¼€ç»„ï¼‰ï¼šæ‰“å¼€çš„ç»„ä»ç„¶å­˜åœ¨ï¼Œå¯ä»¥å¯¹ç»„ä¸­çš„å•ä¸ªæˆå‘˜è¿›è¡Œç¼–è¾‘Closeï¼ˆå…³é—­ç»„ï¼‰ï¼šå°†æ‰“å¼€çš„ç»„å…³é—­ï¼Œä¿æŒåŸæ¥çš„ç»„åDetachï¼ˆåˆ†ç¦»ç»„ï¼‰ï¼šå°†é€‰æ‹©çš„ç»„ä»å½“å‰çš„ç»„ä¸­åˆ†ç¦»å‡ºå» Attachï¼ˆåˆå¹¶ç»„ï¼‰ï¼šå¯¹ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„ç»„ç»„åˆæˆä¸€ä¸ªæ–°çš„ç»„ã€‚Explodeï¼ˆç‚¸å¼€ç»„ï¼‰ï¼šå¯¹å½“å‰é€‰æ‹©çš„ç»„è¿›è¡Œç‚¸å¼€æ“ä½œï¼Œå¯å°†å¤šä¸ªç»„ä¸€æ¬¡è§£æ•£ã€‚ä¸‰ã€é˜µåˆ—æ“ä½œ1ã€é˜µåˆ—å¯¹è¯æ¡†å‚æ•°è§£é‡ŠIncrementalï¼ˆå¢é‡ï¼‰ï¼šè¡¨ç¤ºæ¯ä¸¤ä¸ªç‰©ä½“ä¹‹é—´çš„å˜æ¢é‡ï¼Œä½¿ç”¨Moveè¡¨ç¤ºä¸ºè·ç¦»ï¼Œä½¿ç”¨Rotateåˆ™è¡¨ç¤ºè§’åº¦ï¼Œä½¿ç”¨Scaleè¡¨ç¤ºç¼©æ”¾å˜æ¯”ã€‚Tatolsï¼ˆæ€»é‡ï¼‰ï¼šè¡¨ç¤ºæ‰€æœ‰ç‰©ä½“ä¹‹å’Œçš„æ€»é‡ï¼Œä½¿ç”¨Moveè¡¨ç¤ºä¸ºè·ç¦»ï¼Œä½¿ç”¨Rotateåˆ™è¡¨ç¤ºè§’åº¦ï¼Œä½¿ç”¨Scaleè¡¨ç¤ºç¼©æ”¾å˜æ¯”ã€‚Uniform:å‹¾é€‰æ­¤é¡¹ï¼Œå°†é”å®šScaleå˜æ¯”è®¾ç½®ï¼Œåªèƒ½ç­‰æ¯”ç¼©æ”¾ã€‚1Dã€2Dã€3Dåˆ†åˆ«è¡¨ç¤ºåœ¨ä¸€ç»´ã€äºŒç»´ã€ä¸‰ç»´ç©ºé—´ä¸Šäº§ç”Ÿé˜µåˆ—ï¼ŒCountè¡¨ç¤ºç‰©ä½“çš„å¤åˆ¶æ•°ç›®ã€‚Incremental Row Offsets:åˆ¶ä½œäºŒç»´ã€ä¸‰ç»´é˜µåˆ—æ—¶ç›¸å¯¹äºä¸€ç»´é˜µåˆ—Xã€Yã€Zè½´ä¸Šçš„åç§»é‡ã€‚Reset all parameterså¯ä»¥æ¢å¤å¯¹è¯æ¡†ä¸­çš„é»˜è®¤å‚æ•°è®¾ç½®2ã€å®ä¾‹ï¼šAï¼šåˆ¶ä½œåœ†å½¢ç¯ç»•çš„çŸ³å‡³ Bï¼šåˆ¶ä½œæ—‹è½¬å°é˜¶ï¼ˆç‰¹åˆ«æ³¨æ„å°é˜¶ç‰©ä½“çš„è½´å¿ƒç‚¹ä½ç½®ï¼‰å››ã€å¯¹é½æ“ä½œå…ˆé€‰æ‹©è¢«å¯¹é½çš„åŸç‰©ä½“ï¼Œå•å‡»å·¥å…·æ ä¸­çš„å¯¹é½æŒ‰é’®ï¼Œåœ¨è§†å›¾ä¸­ç‚¹å‡»ç›®æ ‡å¯¹é½ç‰©ä½“ï¼Œ ä¾æ®å¯¹è¯æ¡†å¯ä»¥å®ç°åŸç‰©ä½“ä¸ç›®æ ‡ç‰©ä½“ä»¥ä¸‹å‡ ç§å¯¹é½æ–¹å¼ï¼šMinimumï¼ˆæœ€å°å¯¹é½ï¼‰:åœ¨æ­£äº¤è§†å›¾ç‰©ä½“çš„æœ€å·¦ç«¯å’Œæœ€ä¸‹ç«¯åˆ†åˆ«å®šä¹‰Xã€Yè½´çš„æœ€å°å€¼ã€‚Center(ä¸­å¿ƒ)ï¼šä»¥ç‰©ä½“çš„é‡å¿ƒä½ç½®è¿›è¡Œå¯¹é½Pivot Pointï¼ˆè½´å¿ƒç‚¹ï¼‰ï¼šä»¥ç‰©ä½“çš„åæ ‡è½´ä½ç½®è¿›è¡Œå¯¹é½Maximumï¼ˆæœ€å¤§å€¼ï¼‰ï¼šåœ¨æ­£äº¤è§†å›¾ç‰©ä½“çš„æœ€å³ç«¯å’Œæœ€ä¸Šç«¯åˆ†åˆ«å®šä¹‰Xã€Yè½´çš„æœ€å¤§å€¼ã€‚ ç¬¬å››è®² Boxï¼ˆæ–¹ä½“ï¼‰Lengthã€Widthå’ŒHeightåˆ†åˆ«å®šä¹‰æ–¹ä½“çš„é•¿åº¦ã€å®½åº¦å’Œé«˜åº¦ï¼ŒLength Segsã€ Width Segså’ŒHeight Segsåˆ†åˆ«å®šä¹‰é•¿åº¦ã€å®½åº¦å’Œé«˜åº¦çš„åˆ†æ®µåˆ’åˆ†ï¼Œå¢åŠ å®ƒä»¬çš„å€¼åˆ™äº§ç”Ÿæ …æ ¼æ–¹ä½“ï¼Œé…åˆä¿®æ”¹å™¨çš„ä½¿ç”¨å¯ä»¥ä½¿æ–¹ä½“æ›´æ˜“äºå˜å½¢ï¼Œä»è€Œäº§ç”Ÿå½¢æ€å„å¼‚çš„å‡ ä½•ç‰©ä½“2.Sphere(çƒä½“ï¼‰Radiusï¼ˆåŠå¾„ï¼‰ï¼šå®šä¹‰çƒä½“çš„å¤§å°ã€‚Segmentsï¼ˆåˆ†æ®µæ•°ï¼‰ï¼šè¯¥å€¼è¶Šå¤§ï¼Œçƒè¶Šåœ†æ»‘ã€‚Smoothï¼ˆå…‰æ»‘ï¼‰ï¼šæ§åˆ¶çƒä½“è¡¨é¢æ˜¯å¦å…‰æ»‘ã€‚Hemisphereï¼ˆåŠçƒï¼‰ï¼šå€¼åŸŸä¸º0-1ï¼Œå€¼ä¸º0æ—¶ï¼Œè¡¨ç¤ºä¸€ä¸ªå®Œæ•´çš„çƒä½“ï¼Œå€¼ä¸º1æ—¶ï¼Œæ•´ä¸ªçƒä½“æ”¶ç¼©æˆä¸€ä¸ªç‚¹ï¼Œå€¼ä»‹äº0-1ä¹‹é—´ï¼Œçƒä½“å˜ä¸ºçƒå† ï¼Œä»…å½“å€¼ä¸º0.5æ—¶ä¸ºåŠçƒã€‚Chopï¼ˆå‰ªåˆ‡ï¼‰ï¼šåœ¨åŠçƒæˆ–çƒå† æ—¶ï¼Œå°†æ•´ä¸ªçƒä½“çš„æ°´å¹³åˆ†æ®µæ•°åˆ‡æ‰ä¸€åŠSquashï¼ˆæŒ¤å‹ï¼‰ï¼šåœ¨åŠçƒæˆ–çƒå† æ—¶ï¼Œå¯å°†ä¸‹åŠçƒè¢«åˆ‡æ‰çš„çƒä½“æ°´å¹³åˆ†æ®µæ•°æŒ¤å‹åˆ°ä¸ŠåŠçƒï¼Œä»ä¿æŒå®Œæ•´çš„åˆ†æ®µæ•°ã€‚Slice Onï¼ˆåˆ‡ç‰‡ï¼‰ï¼šæ‰“å¼€å®ƒå¯ä»¥åœ¨ä¸‹é¢çš„è®¾ç½®ä¸­è°ƒèŠ‚çƒä½“å±€éƒ¨åˆ‡ç‰‡å¤§å°ã€‚Slice From/Slice Toï¼ˆåˆ‡ç‰‡å¼€å§‹/åˆ‡ç‰‡ç»“æŸï¼‰ï¼šåˆ†åˆ«è®¾ç½®åˆ‡ç‰‡ä¸¤ç«¯åˆ‡é™¤çš„å¹…åº¦Base To Pivotï¼šè®¾ç½®çƒä½“çš„è½´å¿ƒç‚¹åœ¨çƒä½“çš„åº•éƒ¨è¿˜æ˜¯åœ¨çƒå¿ƒä½ç½®ã€‚ Generate Mapping Coordinatesï¼ˆäº§ç”Ÿè´´å›¾åæ ‡ï¼‰ï¼šè‡ªåŠ¨äº§ç”Ÿè´´å›¾åæ ‡ã€‚3.Geosphere(å‡ ä½•çƒä½“ï¼‰Tetraï¼ˆå››é¢ä½“ï¼‰/Octaï¼ˆå…«é¢ä½“ï¼‰/Icosaï¼ˆäºŒåé¢ä½“ï¼‰ï¼šè¿™ä¸‰ä¸ªå‚æ•°åˆ†åˆ«æ§åˆ¶è¯¥çƒä½“çš„åŸºæœ¬ç±»å‹ï¼Œå®ƒä»¬ä¸Segmentså‚æ•°å€¼çš„å¹³æ–¹å€¼ç›¸ä¹˜æ­£å¥½æ˜¯å‡ ä½•çƒä½“çš„æ‰€æœ‰ä¸‰è§’é¢çš„ä¸ªæ•°ï¼Œç›´æ¥åœ¨é€‰æ‹©çš„ç‰©ä½“ä¸ŠæŒ‰æ•°å­—é”®7ï¼Œè§†å›¾ä¸­ä¼šæ˜¾ç¤ºç‰©ä½“æ‰€æœ‰é¢çš„æ•°é‡ Cylinder(æŸ±ä½“)Radiusï¼ˆåŠå¾„ï¼‰ï¼šæ§åˆ¶åœ†æŸ±ä½“çš„ç²—ç»†ã€‚Heightï¼ˆé«˜åº¦ï¼‰ï¼šå¯ä»¥æ§åˆ¶åœ†æŸ±ä½“çš„é«˜çŸ®ã€‚Height Segmentsï¼ˆé«˜åº¦åˆ†æ®µæ•°ï¼‰ï¼šåˆ†æ®µè¶Šå¤šï¼Œç‰©ä½“ç²¾åº¦è¶Šé«˜ï¼Œè¡¨é¢åˆ™è¶Šå…‰æ»‘Cap Segmentsï¼ˆç«¯é¢åˆ†æ®µæ•°ï¼‰ï¼šå®šä¹‰åœ†æŸ±ä½“æˆªé¢åœ†å½¢çš„åˆ†æ®µæ•°ï¼Œä»é¡¶ç«¯æˆªé¢çœ‹å°±æ˜¯ä¸€ä¸ªä¸ªåŒå¿ƒåœ†ã€‚Sidesï¼ˆè¾¹æ•°ï¼‰ï¼šå®šä¹‰åœ†æŸ±ä½“ä¾§é¢çš„åˆ†æ®µåˆ’åˆ†ï¼Œå€¼è¶Šå¤§ï¼Œåœ†æŸ±ä½“è¶Šåœ†ã€‚ Cone(é”¥ä½“)Radius 1/Radius 2åˆ†åˆ«æ§åˆ¶é”¥ä½“çš„ä¸Šä¸‹ä¸¤ä¸ªç«¯é¢çš„åŠå¾„å¤§å°ï¼Œå½“å…¶ä¸­çš„ä¸€ä¸ªå€¼ä¸º0æ—¶å³ä¸ºé”¥ä½“ï¼Œå½“ä¸¤ä¸ªåŠå¾„å€¼ä¸ä¸º0ä¸”ä¸ç›¸ç­‰æ—¶ä¸ºåœ†å°ç‰©ä½“ï¼Œå½“ä¸¤ä¸ªåŠå¾„ä¸ä¸º0ä¸”ç›¸ç­‰æ—¶åˆ™å˜ä¸ºæŸ±ä½“ã€‚ Tube(åœ†ç®¡)Radius 1/Radius 2åˆ†åˆ«æ§åˆ¶åœ†ç®¡çš„å†…å¾„å’Œå¤–å¾„çš„å¤§å°ã€‚ Torus(åœ†ç¯)Radius 1ï¼šè¡¨ç¤ºè‡ªåœ†ç¯çš„ä¸­å¿ƒè‡³æˆªé¢æ­£å¤šè¾¹å½¢çš„ä¸­å¿ƒè·ç¦»ã€‚Radius 2ï¼šè¡¨ç¤ºåœ†ç¯æˆªé¢æ­£å¤šè¾¹å½¢çš„å†…å¾„å¤§å°ï¼Œç”¨å®ƒå¯å®šä¹‰åœ†ç¯çš„ç²—ç»†ã€‚Rotationï¼ˆæ—‹è½¬ï¼‰ï¼šè®¾ç½®æ¯ä¸€ç‰‡æ®µæˆªé¢æ²¿åœ†ç¯è½´æ—‹è½¬çš„è§’åº¦Twistï¼ˆæ‰­æ›²ï¼‰ï¼šè®¾ç½®æ¯ä¸ªæˆªé¢æ‰­æ›²çš„è§’åº¦ï¼Œäº§ç”Ÿæ‰­æ›²çš„è¡¨é¢ã€‚Segmentsï¼šæ²¿ç€åœ†ç¯é•¿åº¦ä¸Šçš„åˆ†æ®µæ•°ï¼Œå€¼è¶Šå¤§ï¼Œå¾—åˆ°çš„åœ†å½¢è¶Šå…‰æ»‘ã€‚Sidesï¼šåœ†ç¯æˆªé¢çš„è¾¹æ•°ï¼Œå€¼è¶Šå¤§ï¼Œåœ†ç¯è¶Šåœ†æ»‘ã€‚Smoothï¼šè®¾ç½®åœ†ç¯å…‰æ»‘èŒƒå›´ï¼Œæœ‰Allï¼ˆå…¨éƒ¨å…‰æ»‘ï¼‰ã€Sidesï¼ˆè¾¹å…‰æ»‘ï¼‰ã€Noneï¼ˆæ‰€æœ‰ä¸å…‰æ»‘ï¼‰å’ŒSegmentsï¼ˆæ²¿ç€é•¿åº¦å…‰æ»‘ï¼‰å››ç§ç±»å‹ã€‚ Teaportï¼ˆèŒ¶å£¶ï¼‰Radiusï¼ˆåŠå¾„ï¼‰ï¼šç”¨äºæ§åˆ¶èŒ¶å£¶çš„å¤§å°ã€‚Segmentsï¼ˆåˆ†æ®µæ•°ï¼‰ï¼šå¢åŠ æ­¤å€¼ï¼Œå¯ä½¿èŒ¶å£¶å˜å¾—æ›´åŠ åœ†æ»‘ã€‚Teapot Partsï¼šè¯¥é€‰é¡¹ä¸­çš„å››ä¸ªå‚æ•°åˆ†åˆ«æ§åˆ¶æ˜¯å¦è¦èŒ¶å£¶çš„Bodyï¼ˆå£¶èº«ï¼‰ã€Handleï¼ˆå£¶æŸ„ï¼‰ã€Spoutï¼ˆå£¶å˜´ï¼‰å’ŒLidï¼ˆå£¶ç›–ï¼‰ Pyramidï¼ˆå››æ£±é”¥ï¼‰ äº§ç”Ÿç±»ä¼¼é‡‘å­—å¡”çŠ¶çš„å››æ£±é”¥ä½“ï¼Œè°ƒèŠ‚Widthã€ Depthå’Œ Heightå‚æ•°å¯ä»¥æ”¹å˜å››æ£±é”¥çš„å®½åº¦ã€æ·±åº¦å’Œé«˜åº¦ã€‚ Plane(å¹³é¢)Lengthå’ŒWidthç¡®å®šå¹³é¢çš„å¤§å°ã€‚Scaleï¼ˆæ¯”ä¾‹ï¼‰:æ§åˆ¶å¹³é¢åœ¨æ¸²æŸ“æ—¶å¯ä»¥æŒ‰ä¸€å®šçš„æ¯”ä¾‹å€æ•°è¿›è¡Œæ”¾å¤§æˆ–ç¼©å°ï¼›Densityï¼ˆå¯†åº¦ï¼‰:å‚æ•°å¯ä»¥ä½¿å¹³é¢å¢åŠ æ›´å¤šé¢çš„åˆ’åˆ†ï¼Œå½“åŠ å¤§æ­¤å€¼æ—¶ï¼Œå¯ä»¥ä»Total Facesï¼ˆæ€»é¢ï¼‰å‚æ•°ä¸­è·å¾—ç›¸å…³ä¿¡æ¯ã€‚ ç¬¬äº”è®² Hedraï¼ˆå¼‚é¢ä½“ï¼‰Familyï¼ˆç±»å‹ï¼‰ï¼šå³Tetraï¼ˆå››é¢ä½“ï¼‰ã€Cube/Octaï¼ˆç«‹æ–¹ä½“/å…«é¢ä½“ï¼‰ã€Dodec/Octaï¼ˆåäºŒé¢ä½“/äºŒåé¢ä½“ï¼‰ã€Star1ï¼ˆæ˜Ÿå½¢1ï¼‰å’ŒStar2ï¼ˆæ˜Ÿå½¢2ï¼‰ã€‚Family Parametersï¼ˆç±»å‹å‚æ•°ï¼‰ï¼šå‚æ•°På’ŒQï¼Œå–å€¼èŒƒå›´ä»0.0åˆ°1.0ï¼Œä¿®æ”¹å®ƒä»¬çš„å€¼å¯ä»¥æ§åˆ¶ç»„æˆå¼‚é¢ä½“çš„å¤šè¾¹å½¢çš„å½¢çŠ¶ã€‚Axis Scalingï¼ˆè½´å‘æ¯”ç‡ï¼‰ï¼šPã€Qã€Råˆ†åˆ«è°ƒèŠ‚å„ç§å¤šè¾¹å½¢çš„è½´å‘æ¯”ç‡ã€‚å¦‚æœå¼‚é¢ä½“åªæœ‰ä¸€ç§æˆ–ä¸¤ç§ç±»å‹çš„é¢ï¼Œé‚£ä¹ˆè½´å‘æ¯”ç‡å‚æ•°ä¹Ÿåªæœ‰ä¸€é¡¹æˆ–ä¸¤é¡¹æœ‰æ•ˆæ— æ•ˆçš„æ¯”ç‡ä¸äº§ç”Ÿæ•ˆæœã€‚Resetï¼ˆé‡è®¾ç½®ï¼‰:å•å‡»æ­¤æŒ‰é’®æ¢å¤è½´å‘çš„åˆå§‹è®¾ç½®ã€‚Verticesï¼ˆé¡¶ç‚¹ï¼‰ï¼šç¡®å®šå¼‚é¢ä½“å†…éƒ¨é¡¶ç‚¹çš„åˆ†å¸ƒæƒ…å†µï¼Œä»è€Œå†³å®šå¼‚é¢ä½“çš„å†…éƒ¨ç»“æ„ã€‚å…¶ä¸­Basicè¡¨ç¤ºè¶…è¿‡æœ€å°å€¼çš„é¢ä¸å†è¿›è¡Œç»†åˆ’åˆ†ï¼›Centerè¡¨ç¤ºåœ¨é¢çš„ä¸­å¿ƒä½ç½®æ·»åŠ ä¸€é¡¶ç‚¹ï¼ŒæŒ‰ä¸­å¿ƒç‚¹åˆ°é¢çš„å„ä¸ªé¡¶ç‚¹æ‰€å½¢æˆçš„è¾¹è¿›è¡Œç»†åˆ’åˆ†ï¼›Center &amp; Sidesè¡¨ç¤ºåœ¨é¢çš„ä¸­å¿ƒä½ç½®æ·»åŠ ä¸€æ¯ç‚¹ï¼ŒæŒ‰ä¸­å¿ƒç‚¹åˆ°é¢çš„å„ä¸ªé¡¶ç‚¹å’Œè¾¹ä¸­å¿ƒæ‰€å½¢æˆçš„è¾¹è¿›è¡Œç»†åˆ’åˆ†ï¼Œæ‰€äº§ç”Ÿçš„é¢æ¯”Centeræ–¹å¼å¤šä¸€å€ã€‚ Turus Knotï¼ˆç¯å½¢èŠ‚ï¼‰Base Curveï¼ˆåŸºæœ¬æ›²çº¿ï¼‰ï¼šæä¾›ä¸¤ç§åŸºæœ¬æ›²çº¿ç±»å‹ï¼šKnotï¼ˆèŠ‚ï¼‰å’ŒCircleï¼ˆåœ†å½¢ï¼‰ã€‚å½“é€‰æ‹©Knotç±»å‹æ—¶ï¼Œæ¿€æ´»å…¶ä¸‹çš„På’ŒQå‚æ•°ï¼›å½“é€‰æ‹©Circleç±»å‹æ—¶ï¼Œæ¿€æ´»Warp Countå’ŒWarpHeightå‚æ•°ã€‚Radiusï¼šå®šä¹‰ç¯å½¢èŠ‚ç‰©ä½“çš„åŠå¾„å¤§å°ï¼Œåœ¨Cross Sectionå­é¢æ¿ä¸­ä¹Ÿæœ‰ä¸€ä¸ªRadiusï¼Œå®ƒæ˜¯å®šä¹‰ç¯å½¢èŠ‚ç‰©ä½“çš„æˆªé¢åŠå¾„å¤§å°ã€‚På’ŒQï¼šè¡¨ç¤ºåœ¨æ°´å¹³æ–¹å‘å’Œå‚ç›´æ–¹å‘äº§ç”Ÿæ‰“èŠ‚çš„æ•°ç›®ï¼Œå½“è¿™ä¸¤ä¸ªå€¼ç›¸ç­‰æ—¶ï¼Œå‡ä¸ºä¸€ä¸ªä¸æ‰“èŠ‚çš„åœ†ç¯ï¼Œå½“å…¶ä¸­çš„ä¸€ä¸ªå€¼ä¸ºå°æ•°æ—¶ï¼Œæ˜¯ä¸€ä¸ªæ–­è£‚çš„åœ†ç¯ã€‚Warp Countï¼ˆæ‰­æ›²æ•°ç›®ï¼‰ï¼šè¡¨ç¤ºåœ¨ç¯å½¢ç‰©ä½“ä¸Šçªå‡ºçš„æ‰­æ›²è§’çš„æ•°ç›®ï¼Œæœ€å¤§å€¼ä¸º100ã€‚Warp Heightï¼ˆæ‰­æ›²é«˜åº¦ï¼‰ï¼šè¡¨ç¤ºæ‰­æ›²è§’çªå‡ºçš„ç¨‹åº¦ï¼Œæœ€å¤§å€¼ä¸º4ã€‚Cross Sectionï¼ˆæ¨ªæˆªé¢ï¼‰ï¼šå®šä¹‰ç¯å½¢èŠ‚ç‰©ä½“æ¨ªæˆªé¢çš„å½¢æ€ã€‚Sidesï¼ˆè¾¹ï¼‰ï¼šç¯å½¢èŠ‚æˆªé¢çš„æ®µæ•°ï¼Œå€¼è¶Šå¤§è¶Šåœ†æ»‘ã€‚Eccentricityï¼ˆåå¿ƒç‡ï¼‰ï¼šè®¾ç½®ç¯å½¢èŠ‚å‹æ‰çš„ç¨‹åº¦ï¼Œè¯¥å€¼è¶Šæ¥è¿‘1ï¼Œå…¶æˆªé¢å°±è¶Šæ¥è¿‘åœ†å½¢ã€‚Twistï¼ˆæ‰­æ›²ï¼‰ï¼šè®¾ç½®æˆªé¢æ²¿è·¯å¾„æ‰­æ›²æ—‹è½¬çš„ç¨‹åº¦ï¼Œä¸€èˆ¬å–æ¶ˆSmoothï¼ˆå…‰æ»‘ï¼‰é€‰é¡¹åè§‚å¯Ÿæ¯”è¾ƒæ˜æ˜¾ã€‚Lumpsï¼ˆè‚¿å—ï¼‰ï¼šè®¾ç½®æ­¤å€¼ï¼Œå¯ä»¥ä½¿ç¯å½¢èŠ‚äº§ç”Ÿä¸€å®šæ•°é‡çš„è‚¿å—æ•ˆæœã€‚Lumps Heightï¼šè®¾ç½®è‚¿å—çš„é«˜åº¦ï¼Œæœ€å¤§å€¼ä¸º4ã€‚Lumps Offsetï¼šè®¾ç½®è‚¿å—åœ¨è·¯å¾„ä¸Šç§»åŠ¨çš„åç§»é‡ã€‚Smoothï¼ˆå…‰æ»‘ï¼‰ï¼šè®¾ç½®ç¯å½¢èŠ‚è¡¨é¢æŒ‰å“ªç§æ–¹å¼è¿›è¡Œå…‰æ»‘ï¼ŒAllã€Sideså’ŒNoneåˆ†åˆ«è¡¨ç¤ºå¯¹æ•´ä¸ªé€ å‹è¿›è¡Œå…‰æ»‘ã€æ²¿è·¯å¾„æ–¹å‘çš„é¢è¿›è¡Œå…‰æ»‘å’Œä¸è¿›è¡Œå…‰æ»‘å¤„ç†ã€‚Mapping Coordinatesï¼ˆè´´å›¾åæ ‡ï¼‰ï¼šè®¾ç½®è´´å›¾åæ ‡åŠè´´å›¾å›¾åƒåœ¨å½“å‰ç‰©ä½“Uã€Væ–¹å‘çš„åç§»é‡å’Œå¹³è¾…æ¬¡æ•°ã€‚ ChamferBoxï¼ˆå€’è§’æ–¹ä½“ï¼‰æœ‰ä¸¤ä¸ªå‚æ•°ç”¨äºè®¾ç½®å€’è§’å€¼ï¼ŒFilletè®¾ç½®å€’è§’çš„å¤§å°ï¼Œå½“å€¼ä¸º0æ—¶ï¼Œå°±å˜ä¸ºBoxäº†ï¼›Fillet Segmentsç”¨äºè®¾ç½®å€’è§’çš„åˆ†æ®µæ•°ã€‚è¿™ä¸¤ä¸ªå€¼è¦é…åˆä½¿ç”¨ï¼Œå¦‚æœFillet Segmentså€¼è®¾ç½®è¿‡å°ï¼Œå¾ˆéš¾ä½“ç°å€’è§’çš„åœ†æ»‘åº¦ã€‚ ChamferCylï¼ˆå€’è§’åœ†æŸ±ä½“ï¼‰ä¸æ ‡å‡†å‡ ä½•ä½“ä¸­çš„åœ†æŸ±ä½“ç›¸ä¼¼ï¼Œæ‰€ä¸åŒçš„æ˜¯åœ¨åœ†æŸ±ä½“çš„ä¸¤ä¸ªç«¯é¢ä¸ä¾§é¢ä¹‹é—´å¯ä»¥äº§ç”Ÿåœ†æ»‘çš„å€’è§’æ•ˆæœ,Filletå’ŒFillet Segmentsï¼Œå«ä¹‰ä¸ChamferBoxä¸­çš„å‚æ•°å«ä¹‰ç›¸åŒ OilTankï¼ˆæ²¹ç½ï¼‰ã€Capsuleï¼ˆèƒ¶å›Šä½“ï¼‰ã€Spindleï¼ˆçººé”¤ä½“ï¼‰è¿™ä¸‰ä¸ªæ‰©å±•å‡ ä½•ä½“å·¥å…·å±äºåŒç±»å‹çš„ï¼Œå…±åŒç‚¹æ˜¯ä¸­é—´éƒ½æ˜¯åœ†æŸ±ä½“ï¼Œåªæ˜¯é¡¶ç«¯å½¢çŠ¶ä¸ä¸€æ ·ï¼Œæ§åˆ¶å‚æ•°ä¹Ÿå¤§åŒå°å¼‚ï¼Œå¤§éƒ¨åˆ†å‚æ•°é¡¹ä¸åœ†æŸ±ä½“ç›¸åŒã€‚Blendï¼ˆèåˆï¼‰å‚æ•°è®¾ç½®æ²¹ç½åœ†æŸ±éƒ¨åˆ†ä¸å…¶é¡¶ç›–éƒ¨åˆ†çš„å€’è§’ç¨‹åº¦ï¼Œä½¿å…¶äº’ç›¸äº¤èï¼Œäº§ç”Ÿåœ†æ»‘æ•ˆæœã€‚Overallä¸Centerç”¨æ¥å®šä¹‰æ²¹ç½çš„é«˜åº¦ï¼Œä½¿ç”¨OverallåŒ…æ‹¬ä¸Šä¸‹ä¸¤ä¸ªé¡¶ç›–çš„é«˜åº¦å’Œæ²¹ç½ä¸­é—´åœ†æŸ±çš„é«˜åº¦ï¼Œä½¿ç”¨Centerä»…æŒ‡ä¸­é—´åœ†æŸ±éƒ¨åˆ†çš„é«˜åº¦ã€‚ Gengonï¼ˆå¤šè¾¹å½¢æ£±ä½“ï¼‰ä½¿ç”¨Gengonï¼ˆå¤šè¾¹å½¢æ£±ä½“ï¼‰å‘½ä»¤å¯ä»¥åˆ›å»ºå¤šè¾¹å½¢æŸ±ä½“ï¼Œä¿®æ”¹Filletå‚æ•°å€¼è¿˜å¯ä»¥ä½¿å¤šè¾¹å½¢æŸ±ä½“çš„æ¯ä¸ªä¾§é¢äº¤ç•Œå¤„äº§ç”Ÿå…‰æ»‘çš„å€’è§’ã€‚ L-Extï¼ˆLå‹ç‰©ä½“ï¼‰ä¸C-Extï¼ˆCå‹ç‰©ä½“ï¼‰ä½¿ç”¨L-Extå’ŒC-Extå‘½ä»¤å¯ä»¥åˆ›å»ºè¡¨ç°Lå‹å’ŒCå‹å®ä½“æ¨¡å‹ï¼Œä¸»è¦ç”¨æ¥è¡¨ç°å»ºç­‘ä¸­çš„å¢™ä½“æ•ˆæœ RingWaveï¼ˆç¯å½¢æ³¢ï¼‰Radiusï¼ˆåŠå¾„ï¼‰ï¼šè®¾ç½®ç¯å½¢æ³¢çš„å¤–æ²¿åŠå¾„ã€‚Radius Segsï¼ˆåŠå¾„åˆ†æ®µæ•°ï¼‰ï¼šè®¾ç½®å†…æ²¿åŠå¾„ä¸å¤–æ²¿åŠå¾„ä¹‹é—´çš„åˆ†æ®µæ•°ã€‚Radius Widthï¼ˆç¯å½¢å®½åº¦ï¼‰ï¼šè®¾ç½®ä»å¤–æ²¿åŠå¾„å‘å†…çš„ç¯å½¢å®½åº¦çš„å¹³å‡å€¼ã€‚RingWave Timingï¼ˆç¯å½¢æ³¢å®šæ—¶ï¼‰ï¼šä¸»è¦ç”¨äºè®¾ç½®ç¯å½¢æ³¢çš„è¿åŠ¨å½¢å¼ï¼Œä¸»è¦æœ‰ä¸‰ç§ï¼šNo Growthï¼ˆæ²¡æœ‰å¢é•¿ï¼‰ï¼šç¯å½¢æ³¢åœ¨ç”Ÿæˆè¿‡ç¨‹å§‹ç»ˆä»¥é™æ€æ–¹å¼æ˜¾ç¤ºå‡ºæ¥ï¼Œä¸èƒ½å½¢æˆåŠ¨ç”»ã€‚Grow and Stayï¼ˆå¢é•¿å¹¶ä¿æŒï¼‰ï¼šç¯å½¢æ³¢ç”Ÿé•¿è¿‡ç¨‹ä¸­é€æ¸æ”¾å¤§ï¼Œåˆ°è¾¾æœ€å¤§æ—¶å°±åœæ­¢æ”¾å¤§ï¼Œç›´è‡³è¿åŠ¨åˆ°æœ€åä¸€å¸§ï¼Œå…¶æ”¾å¤§åŠåœç•™çš„æ—¶é—´å¯ä»¥é€šè¿‡Start Timeå’ŒGrow Timeå‚æ•°æ§åˆ¶ã€‚Cyclic Growthï¼ˆå¾ªç¯å¢é•¿ï¼‰ï¼šå°†ä½¿ç¯å½¢æ³¢åœ¨è¿åŠ¨è¿‡ç¨‹ä¸­ä»¥å¾ªç¯æ–¹å¼è¿›è¡Œæ”¾å¤§æ˜¾ç¤ºï¼Œå¾ªç¯çš„æ¬¡æ•°å¯ä»¥é€šè¿‡Start Timeå’ŒGrow Timeå‚æ•°è¿›è¡Œè®¾ç½®ï¼Œä¾‹å¦‚è¦åœ¨100å¸§çš„åŠ¨ç”»ä¸­å¾ªç¯5æ¬¡ï¼Œå¯å°†Start Timeè®¾ç½®ä¸º0ï¼ŒGrow Timeè®¾ç½®ä¸º20ã€‚Outer Edge Breakupä¸Inner Edge Breakupï¼šå®ƒä»¬çš„å‚æ•°é¡¹æ˜¯ä¸€æ ·çš„ï¼Œä¿®æ”¹è¿™äº›å‚æ•°å¯ä»¥è®¾ç½®ç¯å½¢æ³¢å†…éƒ¨å’Œå¤–éƒ¨æ³¢æµªçš„å˜åŒ–å½¢çŠ¶å’Œå¤§å°å¹…åº¦ã€‚åˆ†åˆ«æœ‰ä¸€ä¸ªOnå¤é€‰é¡¹ï¼Œæ§åˆ¶å…¶ä¸‹å‚æ•°è®¾ç½®æ˜¯å¦æœ‰æ•ˆï¼Œç³»ç»Ÿé»˜è®¤æ¿€æ´»Inner Edge Breakupæ§åˆ¶é¡¹ï¼Œå–æ¶ˆè¯¥å¤é€‰é¡¹ï¼Œç¯å½¢æ³¢å†…éƒ¨ä¸ºä¸€åœ†å½¢ï¼Œä¸»è¦å‚æ•°å«ä¹‰å¦‚ä¸‹ã€‚Major Cyclesï¼ˆä¸»åœ†å‘¨æœŸï¼‰ï¼šå®šä¹‰ç¯å½¢æ³¢å†…éƒ¨æˆ–å¤–éƒ¨è¾¹ç¼˜äº§ç”Ÿæ³¢çº¹çš„æ•°ç›®ã€‚Width Fluxï¼ˆå®½åº¦æµæŸï¼‰ï¼šå®šä¹‰æ³¢çº¹ä¼¸å±•çš„å¹…åº¦ï¼Œä»¥ç™¾åˆ†æ¯”çš„å½¢å¼è¡¨ç¤ºã€‚Crawl Timeï¼ˆè¿åŠ¨æ—¶é—´ï¼‰ï¼šè¯¥å€¼ä¸ºæ­£å€¼æ—¶ï¼Œç¯å½¢æ³¢æŒ‰é¡ºæ—¶é’ˆæ–¹å‘è¿åŠ¨ï¼Œä¸ºè´Ÿå€¼æ—¶ï¼ŒæŒ‰é€†æ—¶é’ˆæ–¹å‘è¿åŠ¨ã€‚Minor Cyclesï¼ˆæ¬¡åœ†å‘¨æœŸï¼‰ï¼šè®¾ç½®æ­¤å€¼å¯ä»¥åœ¨ä¸»åœ†çš„å¤–å›´å†äº§ç”Ÿè‹¥å¹²ä¸ªæ¬¡åœ†æ³¢çº¹ã€‚ Hoseï¼ˆè½¯ç®¡ï¼‰Hoseæ˜¯ä¸€ç§å¯ä»¥è¿æ¥ä¸¤ä¸ªç‰©ä½“ä¹‹é—´çš„å¯å˜å½¢ç‰©ä½“ï¼Œå®ƒä¼šéšç€ä¸¤ç«¯ç‰©ä½“çš„è¿åŠ¨è€Œåšå‡ºç›¸åº”çš„ååº”ï¼Œä»å¤–å½¢çœ‹å¾ˆåƒä¸€æ ¹è½¯ç®¡ï¼Œæœ‰åœ†å½¢ã€çŸ©å½¢å’ŒDå½¢ä¸‰ç§å¤–è§‚ã€‚è½¯ç®¡åˆ†è‡ªç”±è½¯ç®¡å’Œç»‘å®šè½¯ç®¡ä¸¤ç§ï¼Œä½œä¸ºæ†ç»‘è½¯ç®¡å¯ä»¥åœ¨å…¶é¡¶éƒ¨å’Œåº•éƒ¨ä¸ä»»ä½•ç‰©ä½“è¿›è¡Œç»‘å®šæ“ä½œï¼Œè¢«ç»‘å®šç‰©ä½“çš„è½´å¿ƒç‚¹å°†æ˜¯è½¯ç®¡æ¨¡å‹ä¸¤ç«¯çš„å®šä½ç‚¹ã€‚ ç¬¬å…­è®² å¤åˆç‰©ä½“(COMPOUND OBJECTSOBJECTS))*æ³¨æ„: 1.è¦æœ‰äºŒä¸ªæˆ–äºŒä¸ªä»¥ä¸Šçš„ç‰©ä½“æ‰èƒ½ç”¨å…¶å‘½ä»¤ä¸€.BOOLEAN(å¸ƒå°”è®¡ç®—)1.PICK OPERAND Bï¼ˆæ‹¾å–æ“ä½œå¯¹è±¡Bï¼‰1)REFERENCE(å°†å¯¹è±¡Bå‚è€ƒå¤åˆ¶ä¸€ä¸ª,æ¥è¿›è¡Œå¸ƒå°”è®¡ç®—)2)COPY (å°†å¯¹è±¡Bå¤åˆ¶ä¸€ä¸ª,æ¥è¿›è¡Œå¸ƒå°”è®¡ç®—)3)MOVE (å°†å¯¹è±¡Bç›´æ¥æ¥è¿›è¡Œå¸ƒå°”è®¡ç®—)4)INSTANCE (å°†å¯¹è±¡Bå…³è”å¤åˆ¶ä¸€ä¸ª,æ¥è¿›è¡Œå¸ƒå°”è®¡ç®—)2.Operationï¼ˆæ“ä½œï¼‰Unionï¼ˆç›¸åŠ ï¼‰Intersectionï¼ˆç›¸äº¤ï¼‰Subtractionï¼ˆA-Bï¼‰/Subtractionï¼ˆB-Aï¼‰:ç›¸å‡Cutï¼ˆå‰ªåˆ‡ï¼‰Refineï¼ˆç»†åŒ–ï¼Œæ’å…¥ä¸€æ¡å¯¹è±¡Bä¸å¯¹è±¡Aç›¸äº¤éƒ¨åˆ†çš„è½®å»“çº¿ï¼‰Splitï¼ˆå‰²è£‚ï¼ŒæŠŠç›¸äº¤éƒ¨åˆ†åˆ†ä¸ºå•ç‹¬çš„ä¸€ä¸ªæ¬¡å…ƒç´ å¯¹è±¡ï¼‰Remove Insideï¼ˆå‡ºé™¤é‡Œé¢ï¼Œåˆ é™¤ç›¸äº¤éƒ¨åˆ†ï¼Œä½¿å¯¹è±¡Aé‡Œé¢æŒ–ç©ºï¼‰Remove Outsideï¼ˆå‡ºé™¤å¤–é¢ï¼Œåˆ é™¤å¯¹è±¡Aä¸å¯¹è±¡Bä¸ç›¸äº¤çš„éƒ¨åˆ†ï¼Œç›¸äº¤éƒ¨åˆ†åªä¿ç•™ä¸€ä¸ªé¢ï¼Œé‡Œé¢æŒ–ç©ºï¼‰3.DISPLAYRESULTï¼ˆæ˜¾ç¤ºç»“æœï¼‰OPERANDï¼ˆæ˜¾ç¤ºæ“ä½œå¯¹è±¡ï¼‰RESULT+HIDDEN OPERANDï¼ˆç»“æœ+éšè—çš„æ“ä½œå¯¹è±¡ï¼‰4.å¦‚ä½•ä¿®æ”¹åŸç‰©ä½“å‚æ•°åœ¨OPERANDä¸­é€‰åŸå§‹ç‰©ä½“Aæˆ–B(MODIFY-OPERANDS Aæˆ–B)5.å‡ ä¸ªç‰©ä½“åŒæ—¶æŒ–è¦æ±‚ï¼šå‡ ä¸ªç‰©ä½“ç”¨ATTACH(åˆå¹¶)å‘½ä»¤ä½¿å®ƒä»¬ä½œä¸ºä¸€ä¸ªç‰©ä½“ç¬¬1ç§ï¼šEDIT MESHï¼ˆç¼–è¾‘ç½‘æ ¼ï¼‰-ATTACH LISTç¬¬2ç§ï¼šæŒ‰å³é”®-CONVERT TO-CONVERT TO EDITABLE MESH-ATTACH LISTï¼‰ä¾‹:çƒŸç°ç¼¸ï¼ŒTWO-17ï¼ŒTWO-7ï¼ŒTWO-8ï¼ŒTWO-10ä¸‰.MORPH(å˜å½¢)å››.SCATTER(ç¦»æ•£)äº”.CONFORM(åŒ…è£¹)å…­.CONNECT(è¿æ¥)ä¸ƒ.SHAPEMERGE(å½¢ä½“åˆå¹¶)å…«.BOOLEAN(å¸ƒå°”è¿ç®—)ä¹.TERRAIN(åœ°å½¢)å.LOFT(æ”¾æ ·)ï¼ˆé’ˆå¯¹äºäºŒç»´å›¾å½¢SHAPESï¼‰åä¸€.MESHER(ç½‘æ ¼åŒ–) ç¬¬ä¸ƒè®² åˆ›å»ºäºŒç»´å›¾å½¢ï¼ˆSHAPESï¼‰ä¸€.äºŒç»´å›¾å½¢1.LINEï¼ˆçº¿ï¼‰1)ç›´çº¿2ï¼‰æ›²çº¿ï¼ˆ1ï¼‰ç‚¹çš„ç±»å‹ï¼ˆCORNERè§’ç‚¹SMOOTHåœ†æ»‘BAZIERè´èµ›å°”BAZIER CORNERè´èµ›å°”è§’ç‚¹ï¼‰3)ç”»ä¸€æ¡ç¬”ç›´çš„çº¿(SHIFT+LINEç”»)4)çº¿çš„è¿æ¥(ç”¨2Dæ•æ‰å‘½ä»¤)2.RECTANGLEï¼ˆçŸ©å½¢ï¼‰3.CIRCLEï¼ˆåœ†ï¼‰äºŒ.äºŒç»´æ¸²æŸ“RENDERING-RENDERABLEï¼ˆå¯æ¸²æŸ“çš„ï¼‰THICHNESSï¼ˆçº¿å˜ç²—å˜ç»†ï¼‰æ¸²æŸ“åœ†æ»‘å¦‚ä½•æé«˜INTERPOLATIONï¼ˆæ’è¡¥å€¼ï¼‰STEPSï¼ˆæ’å…¥å¤šå°‘ä¸ªç‚¹ï¼‰-ç‚¹è¶Šå¤šè¶Šåœ†æ»‘OPTIMIZEï¼ˆä¼˜åŒ–åœ†æ»‘ï¼‰ADAPTIVEï¼ˆé€‚é…åœ†æ»‘ï¼Œè‡ªåŠ¨ç”Ÿæˆåœ†æ»‘ï¼Œä¸éœ€è¦ä½ å¡«æ’å…¥å¤šå°‘ä¸ªç‚¹ï¼‰ä¸‰.äºŒç»´å˜æˆé¢(extrude)ä¾‹å¦‚:æ¥¼æ¢¯,åœ†å½¢å°é˜¶(BEND)å››.ARCï¼ˆå¼§ï¼‰1.PIE SLICE(å°†åœ†å¿ƒä¸å¼§çš„ä¸¤ç«¯ç‚¹è¿æ¥)2.REVERSE(ç«¯ç‚¹å¯¹è°ƒ)äº”.DONUTï¼ˆåŒåœ†ï¼‰(åŒå½¢åœ¨ä¸€èµ·ä¸ºå¤åˆå½¢)1.åŒå½¢åœ¨ä¸€èµ·ä¸ºå¤åˆå½¢,å•å½¢ä¸ºä¸€å½¢2.START NEW SHAPE(å¼€å§‹æ–°å½¢)å…­.STARï¼ˆæ˜Ÿå½¢ï¼‰ä¸ƒ.NGONï¼ˆå¤šè¾¹å½¢ï¼‰å…«.ELLIPSEï¼ˆæ¤­åœ†ï¼‰ä¹.TEXT(æ–‡æœ¬)(å¤šè¡Œæ–‡å­—,æŒ‰å›è½¦é”®)å.HELIXï¼ˆèºæ—‹çº¿ï¼‰(motion-trajectoriesä½¿çƒæ²¿ç€èºæ—‹çº¿è¿åŠ¨)åä¸€.SECTION(å‰–é¢)æˆªå–ä¸€ä¸ªä¸‰ç»´ç‰©ä½“çš„å‰–é¢ ç¬¬å…«è®² äºŒç»´ç¼–è¾‘å‘½ä»¤ï¼ˆEDIT SPLINE(æ ·æ¡æ›²çº¿)EDIT SPLINE(ç¼–è¾‘æ ·æ¡æ›²çº¿)æ³¨ï¼šEDIT SPLINEæ˜¯æ–œä½“â€”é’ˆå¯¹äº†å¤šä¸ªç‰©ä½“EDIT SPLINEæ˜¯æ­£ä½“â€”é’ˆå¯¹å•ä¸ªç‰©ä½“EDIT SPLINEåŒ…æ‹¬VERTEX(ç‚¹)SEGMENT(çº¿æ®µ)SPLINE(æ›²çº¿)ä¸‰ä¸ªæ¬¡å¯¹è±¡(ä¸€)ç‚¹,çº¿æ®µ,æ›²çº¿æ‰€å…±æœ‰çš„å‘½ä»¤1.CREATE LINEï¼ˆåˆ›å»ºçº¿ï¼‰2.ATTACH(åˆå¹¶)æ²¡æœ‰å¯¹è¯æ¡†åˆå¹¶ä½¿äºŒä¸ªæˆ–å¤šä¸ªç‹¬ç«‹çš„äºŒç»´å›¾å½¢å˜æˆå¤åˆå½¢ï¼‰3.ATTACH MULT(åˆå¹¶)æœ‰å¯¹è¯æ¡†åˆå¹¶ä½¿äºŒä¸ªæˆ–å¤šä¸ªç‹¬ç«‹çš„äºŒç»´å›¾å½¢å˜æˆå¤åˆå½¢ï¼‰4.INSERTï¼ˆæ’å…¥ï¼‰(äºŒ)VERTEX(ç‚¹)1.ç‚¹çš„ä¸åŒç±»å‹ï¼ˆCORNERï¼ŒSMOOTHï¼ŒBAZIERï¼ŒBAZIER CORNERï¼‰LOCK HANDLESï¼ˆé”å®šæ§åˆ¶æŸ„ï¼‰ALIKE ï¼ˆé€‰å®šç›¸ä¼¼çš„æ‰‹æŸ„ï¼Œæ‰ç§»åŠ¨ï¼‰ALL ï¼ˆæ‰€æœ‰é€‰å®šäº†çš„æ‰‹æŸ„éƒ½ç§»åŠ¨ï¼‰ä¾‹ï¼šé›¨ä¼ï¼ˆSQUEEZE(æŒ¤å‹)(1.5,-2,50,1)ï¼‰2.ç‚¹çš„ç¼–è¾‘å‘½ä»¤1ï¼‰REFINEï¼ˆç»†åŒ–ï¼Œå¢åŠ ç‚¹ï¼‰ä¸æ”¹å˜åŸçº¿çš„ä½ç½®2ï¼‰INSERTï¼ˆæ’å…¥ç‚¹ï¼‰ä¼šæ”¹å˜åŸçº¿çš„ä½ç½®3ï¼‰BREAKï¼ˆæ–­å¼€ç‚¹ï¼‰4ï¼‰CONNECTï¼ˆå°†æ–­å¼€çš„ç‚¹è¿æ¥èµ·æ¥ï¼‰5ï¼‰WELD(ç„Šæ¥)å…ˆé€‰å®šç‚¹,å†ç‚¹å‡»WELD(ä¸è€ƒè™‘ç‚¹æ˜¯å¦æ–­å¼€)6ï¼‰CROSSINSERT(åœ¨äº¤å‰å¤„æ’å…¥ç‚¹)(æ³¨æ„:CROSSINSERTåªé’ˆå¯¹å¤åˆå½¢)7ï¼‰FILLETï¼ˆå€’åœ†è§’ï¼‰8ï¼‰CHAMFERï¼ˆå€’ç›´è§’ï¼‰9ï¼‰HIDE (éšè—)10ï¼‰UNHIDE ALLï¼ˆå–æ¶ˆéšè—ï¼‰11ï¼‰DELETE ï¼ˆåˆ é™¤ï¼‰12ï¼‰MAKE FIRSTï¼ˆä½¿æŸä¸€ä¸ªåšä¸ºèµ·ç‚¹ï¼‰ï¼ˆ1ï¼‰æ˜¯ä¸€ä¸ªå°é—­å‹çš„äºŒç»´å›¾å½¢ï¼Œä»»ä½•ä¸€ä¸ªéƒ½å¯åšä¸ºèµ·ç‚¹ï¼ˆ2ï¼‰å¦‚æœä¸æ˜¯ä¸€ä¸ªå°é—­å‹çš„äºŒç»´å›¾å½¢åªæœ‰æ–­å¼€çš„ä¸¤ä¸ªç«¯ç‚¹æ‰å¯ä»¥åšä¸ºèµ·ç‚¹(ä¸‰)SEGMENT(çº¿æ®µ)1.REFINE2.BREAK3.DIVIDE(åŒ€åˆ†)ï¼ˆå…ˆé€‰å®šçº¿æ®µï¼Œåå¡«æ•°å­¦ï¼Œç‚¹DIVIDEï¼‰4.DETACH(åˆ†ç¦»)1ï¼‰SAME SHAPES(åŒä¸€å›¾å½¢)ä½¿åˆ†ç¦»å‡ºæ¥çš„éƒ¨åˆ†ä»æ˜¯æºå¯¹è±¡çš„ä¸€éƒ¨åˆ†2ï¼‰REORIENT(é‡å®šå‘)ä½¿åˆ†ç¦»å‡ºæ¥çš„éƒ¨åˆ†ç‹¬ç«‹3ï¼‰COPY(å¤åˆ¶)åˆ›å»ºåˆ†ç¦»æ¬¡å¯¹è±¡çš„ä¸€ä¸ªæ–°çš„å¤åˆ¶å“5.çº¿æ®µ ç„Šæ¥ï¼ˆé’ˆå¯¹å¤åˆå½¢ï¼‰ï¼ˆé€‰å®šä¸€æ®µï¼Œç§»åŠ¨å›æ¥ï¼Œå¦‚æœ‰å¤šæ®µè¦ç§»åŠ¨å¤šæ¬¡ï¼‰6.HIDE7.UNHIDE8.DELETE(å››)SPLINE(æ›²çº¿)1.BOOLEAN(åªé’ˆå¯¹å¤åˆå½¢)ï¼ˆå¦‚æœä¸æ˜¯å¤åˆå½¢ï¼Œè¯·ç”¨ATTACHæˆ–ATTACH MULTåšæˆå¤åˆå½¢ï¼‰2.OUTLINEä¾‹:èŒ¶æ¯ï¼ˆLATHEï¼‰3.TRIM ï¼ˆä¿®å‰ªï¼‰ï¼ˆä¸€èˆ¬æœ€å¥½é’ˆå¯¹å¤åˆå½¢4.MIRROR5.EXTEND6.HIDE7.UNHIDE8.DELETE9.SPLINE ç„Šæ¥ï¼ˆé’ˆå¯¹å¤åˆå½¢ï¼‰ï¼ˆé€‰å®šä¸€æ®µï¼Œç§»åŠ¨å›æ¥ï¼Œå¦‚æœ‰å¤šæ®µåªè¦ç§»åŠ¨ä¸€æ¬¡ï¼‰ ç¬¬ä¹è®² LOFT(æ”¾æ ·)ä¸€.åŸºæœ¬æ¦‚å¿µä¸€ä¸ªæˆªé¢(SHAPE)æ²¿ç€ä¸€æ¡è·¯å¾„(PATH)ä¸æ–­çš„å¤åˆ¶æ³¨æ„:1.è·¯å¾„(PATH)åªèƒ½æ˜¯ä¸€æ¡ï¼ˆå¯ä»¥æ˜¯LINEï¼ŒCIRCLEæˆ–è€…å…¶å®ƒçš„äºŒç»´å›¾å½¢ï¼‰2.æˆªé¢(SHAPE)å¯æ˜¯ä¸€ä¸ª,ä¹Ÿå¯ä»¥æ˜¯å¤šä¸ª(ä½†æ˜¯å¤šä¸ªæˆªé¢éƒ½è¦æ˜¯åŒä¸€ç±»å‹çš„ï¼ˆå•å½¢ï¼Œå¤åˆå½¢ï¼‰) 3.è·¯å¾„(PATH)å’Œæˆªé¢(SHAPE)åªèƒ½æ˜¯äºŒç»´å›¾å½¢ä¾‹:é•œæ¡†,å§å°,æ²™å‘äºŒ.LOFTçš„å‚æ•°1.SURFACE PARAMETERS(è¡¨é¢å‚æ•°)(ä¸»è¦é’ˆå¯¹LENGTH,WIDTHæ˜¯å¦å…‰æ»‘)* 2.PATH PARAMETERS (è·¯å¾„å‚æ•°)(ä¸»è¦é’ˆå¯¹åœ¨è·¯å¾„ä»€ä¹ˆåœ°æ–¹æ”¾ä»€ä¹ˆå½¢)3.SKIN PARAMETERS (è¡¨çš®å‚æ•°)(ä¸»è¦é’ˆå¯¹åŠ ç›–,å¢å‡åˆ†æ ¼æ•°,æ˜¯å¦æ˜¾ç¤ºè¡¨çš®)4.DEFORMATIONS (å˜å½¢)(SCALE,TWIST,TEETER,BEVEL,FIT)ä¸‰.LOFTçš„ä¿®æ”¹1.PATHï¼ˆå¯ä»¥ä½¿è·¯å¾„å˜é•¿æˆ–å˜çŸ­ï¼‰2.SHAPEï¼ˆå¯ä»¥æ”¹å˜å½¢çš„ä½ç½®ï¼Œæ—‹è½¬ï¼Œç¼©æ”¾ï¼‰ä¾‹:ç›†,çª—å¸˜3.SHAPEå¯¹é½COMPARE(1)MODIFIERS-SHAPE-COMPARE-PICK SHAPE(2)è¿›å…¥æ¬¡å¯¹è±¡:SPLINEè¿›è¡Œæ—‹è½¬ä¾‹:ä¸Šé¢æ˜¯ä¸€ä¸ªåœ†,ä¸‹é¢æ˜¯ä¸€ä¸ªçŸ©å½¢çš„æ”¾æ ·æ”¾æ ·å¦‚æœå›¾å½¢æ”¾åäº†æ€ä¹ˆåŠ1.å¦‚æœè·¯å¾„æ˜¯ä¸å°é—­çš„æˆ‘ä»¬ç”¨MAKE FIRSTæ”¹å˜è·¯å¾„èµ·ç‚¹çš„ä½ç½®ç‚¹æ˜¯æ–­å¼€çš„ä¸¤ä¸ªç«¯ç‚¹2.å¦‚æœè·¯å¾„æ˜¯å°é—­çš„æˆ‘ä»¬æ˜¯æ”¹å˜SHAPE(å½¢çŠ¶)çš„ä½ç½®ç”¨ROTATEå‘½ä»¤ç¬¬åè®² LOFT(æ”¾æ ·)çš„ä¿®æ”¹ä¸€.DEFORAMTIONS(å˜å½¢)1.SCALE(ç¼©æ”¾)1ï¼‰æˆªé¢å½¢æ”¾å¤§,ç¼©å°2ï¼‰ç•Œé¢ä»‹ç»ä¾‹:FOUR-8,FOUR-9,è¹‹é™·çš„æ˜“æ‹‰ç½,FOUR-16,SEVEN-22.TWIST(æ‰­æ›²)1ï¼‰æˆªé¢æ‰­æ›²2ï¼‰ç•Œé¢ä»‹ç»ä¾‹:FOUR-113.TEETER(å€¾æ–œ)2ï¼‰ç•Œé¢ä»‹ç»ä¾‹:åœ†ç ç¬”4.BEVEL(å€’è§’)1ï¼‰æˆªé¢å€’è§’2ï¼‰ç•Œé¢ä»‹ç»3ï¼‰ä¼˜ç‚¹:åœ†æ»‘4ï¼‰ç¼ºç‚¹:å€¼ä¸èƒ½å¤§5ï¼‰ä¿®æ”¹å™¨ä¸­çš„BEVEL(1)ä¼˜ç‚¹:èƒ½å¾ˆå¤§(2)ç¼ºç‚¹:ä¸åœ†æ»‘5.FIT(æ‹Ÿåˆ,é€‚é…)1ï¼‰ç•Œé¢ä»‹ç»2ï¼‰ç‰©ä½“çš„åšåº¦æ„Ÿ,æ·±åº¦æ„Ÿ,é«˜åº¦æ„Ÿç”¨Yè½´ï¼ˆLEFTçš„æˆªé¢ï¼‰3ï¼‰ç‰©ä½“çš„å®½åº¦ç”¨Xè½´ ï¼ˆTOPçš„æˆªé¢ï¼‰ä¾‹:FOUR-18,FOUR-17, FOUR-19,FOUR-20äºŒ.æ¨¡å‹ç²¾åº¦ä¸èƒ½å¤ªé«˜(å› ä¸ºä¼šå½±å“æ¸²æŸ“æ—¶é—´) ç¬¬åä¸€è®² CAMERAï¼ˆç…§ç›¸æœºï¼‰ ä¸€.æ”¹å˜ç‰©ä½“å¤§å°1.CAMERAç¦»ç‰©ä½“è¿œ,ç‰©ä½“å°,ç¦»ç‰©ä½“è¿‘,ç‰©ä½“å¤§2.PARAMETERS(å‚æ•°)1)LENS(ç„¦è·)å•ä½ï¼šMMï¼ˆæ¯«ç±³ï¼‰(1)ç„¦è·å€¼å¤§â€”â€”ç¦»ç‰©ä½“è¿‘â€”â€”ç‰©ä½“å¤§â€”-ç‰©ä½“è¶Šæ¸…æ™°ç›¸åº”çš„è§†é‡ä¹Ÿå°±è¶Šå° â€”â€”çœ‹åˆ°çš„ç‰©ä½“ä¹Ÿå°±è¶Šå°‘(2)ç„¦è·å€¼å°â€”â€”ç¦»ç‰©ä½“è¿œâ€”â€”ç‰©ä½“å°â€”-ç‰©ä½“ä¹Ÿä¸å¾ˆæ¸…æ™°ç›¸åº”çš„è§†é‡ä¹Ÿå°±è¶Šå¤§ â€”â€”çœ‹åˆ°çš„ç‰©ä½“ä¹Ÿå°±è¶Šå¤š2)FOV(è§†é‡)ï¼ˆFIELD OF VIEWï¼‰å•ä½ï¼šDEGREEï¼ˆåº¦ï¼‰(1)è§†é‡å¤§â€”â€”ç¦»ç‰©ä½“è¿œâ€”â€”ç‰©ä½“å° â€”â€”çœ‹åˆ°çš„ç‰©ä½“ä¹Ÿå°±è¶Šå¤š(2)è§†é‡å°â€”â€”ç¦»ç‰©ä½“è¿‘â€”â€”ç‰©ä½“å¤§â€”â€”çœ‹åˆ°çš„ç‰©ä½“ä¹Ÿå°±è¶Šå°‘3ï¼‰LENS(ç„¦è·)ä¸FOV(è§†é‡)ä¹‹é—´æ˜¯ç›¸åçš„ã€‚äºŒ.SHOW CONEï¼ˆæ˜¾ç¤ºé”¥å½¢ï¼‰ï¼ˆæ— è®ºæ˜¯å¦é€‰å®šç…§ç›¸æœºï¼Œç…§ç›¸æœºçš„è§†é‡éƒ½ä¼šæ˜¾ç¤ºï¼‰ä¸‰.SHOW HORIZON(æ˜¾ç¤ºæ°´å¹³çº¿)ç…§ç›¸æœºçš„æ°´å¹³çº¿å››.ENVIRONMENT RANGES(ç¯å¢ƒèŒƒå›´)è¦ä»¥ç¯å¢ƒæŒ‚ä¸Šé’©1.RENDERINGâ€”ENVIRONMENTâ€”ATMOSPHERE(å¤§æ°”)â€”FOG(é›¾)1)ACTIVE(æ¿€æ´»é›¾)2) MERGE(åˆå¹¶å¦å¤–ä¸€ä¸ªåœºæ™¯çš„ç‰¹æ•ˆ,å¦‚æ²¡ç‰¹æ•ˆ,åªæ˜¯åˆå¹¶åœºæ™¯)3)TYPE(ç±»å‹)STANDARD(æ ‡å‡†é›¾)(å‡åŒ€åˆ†å¸ƒ,æ²¿æ°´å¹³æ–¹å‘åˆ†å¸ƒ)LAYERED(å±‚é›¾)(æ²¿å‚ç›´æ–¹å‘åˆ†å¸ƒ)2.NEAR RANGE(è¿‘è·ç¦»èŒƒå›´)(å¼±,å¯†åº¦æ²¡æœ‰)3.FAR RANGE(è¿œè·ç¦»èŒƒå›´)(å¼º,å¯†åº¦æœ€å¤§)4.NEAR RANGEåˆ°FAR RANGEä¹‹é—´çš„é›¾è¶Šæ¥è¶Šå¤šäº”.CLIPPING PLANES(å‰ªåˆ‡å¹³é¢)1.CLIPPING MANUALLY(ä»NEARåˆ°FARä¸¤è€…é—´çš„ç‰©ä½“æ˜¾ç¤º,ä¸åœ¨ä¸¤è€…é—´çš„ç‰©ä½“ä¸æ˜¾ç¤º)ç¬¬åäºŒè®² MATERIAL EDITORï¼ˆæè´¨ç¼–è¾‘å™¨ï¼‰ ä¸€.æ¦‚å¿µ1.æè´¨:æ˜¯æŒ‡ç‰©ä½“å¤–è¡¨ä¿¡æ¯çš„è¡¨ç°(åŒ…æ‹¬:é¢œè‰²,é«˜å…‰,å…‰æ³½åº¦,é€æ˜åº¦ç­‰ç­‰)2.è´´å›¾:æ˜¯æŒ‡å¸¦æœ‰å›¾æ¡ˆ,çº¹ç†çš„å›¾åƒä¿¡æ¯,å®ƒé™„äºæè´¨ä¹‹ä¸Šæ³¨æ„:ç‰©ä½“ä¸€å®šæœ‰æè´¨,å¯ä»¥æ²¡æœ‰è´´å›¾3.çƒ­æè´¨ï¼ˆåŒæ­¥æè´¨ï¼‰:èµ‹ç»™äº†ç‰©ä½“çš„æè´¨çƒ(è¾¹æœ‰ç™½æ¡†)4.å†·æè´¨ï¼ˆä¸åŒæ­¥æè´¨ï¼‰:æ²¡æœ‰èµ‹ç»™ç‰©ä½“çš„æè´¨çƒäºŒ.SHADER(é˜´å½±) BASICï¼ˆåŸºç¡€ï¼‰ PARAMETERS1.æ¸²æŸ“æ¨¡å¼2.WIREï¼ˆç½‘æ ¼ï¼‰1)ç½‘æ ¼ä¸ç‰©ä½“çš„åˆ†æ ¼æ•°ï¼ˆSEGMENTSï¼‰æœ‰å…³2)ç”¨ä¸€æ­¥ä¿®æ”¹ç½‘æ ¼(1)åŠ ç²—(EXTENDED PARAMETERS-WIRE-PIXELS(è¿œè¿‘ä¸€æ ·ç²—ç»†)UNITS(è¿œç»†,è¿‘ç²— )3ï¼‰äºŒç»´ç‰©ä½“ç½‘æ ¼â€”æ²¡æœ‰åˆ†æ ¼æ•°æ’å…¥EDIT SPLINE-SEGMENT-DEVIDEï¼ˆæ³¨ï¼šé¡¶ç›–ï¼Œé¡¶åº•æ²¡æœ‰ï¼‰3.2-SIDEDï¼ˆå†…å¤–æ‰€èµ‹çš„æè´¨æ˜¯ä¸€æ ·ï¼‰4.FACE MAP5.FACETEDä¸‰.ä¸åŒæ¸²æŸ“æ¨¡å¼çš„åŸºæœ¬å‚æ•°( XXXXXX BASIC PARAMETERS)1.AMBIENT(èƒŒå…‰åŒº)2.DIFFUSE(ä¸»å…‰åŒº)3.SPECULAR(é«˜å…‰åŒº,é«˜å…‰åœ¨ä»€ä¹ˆåœ°æ–¹ä¸ç¯æœ‰å¿…ç„¶çš„è”ç³»)1)SPECULAR LEVEL (é«˜å…‰çº§åˆ«)2)GLOSSINESS (å…‰æ³½åº¦,æ§åˆ¶é«˜å…‰çš„é¢ç§¯)3)SOFTEN (æŸ”å’Œ0~1,é«˜å…‰ä¸éé«˜å…‰ä¹‹é—´çš„è¿‡æ¸¡)4.SELF-ILLUMINATION (è‡ªå‘å…‰,å¯ä»¥ç”¨æ•°å­—è¡¨ç¤º,ä¹Ÿå¯ä»¥ç”¨é¢œè‰²è¡¨ç¤º)5.OPACITY (ä¸é€æ˜åº¦)1)å€¼è¶Šä½,è¶Šé€æ˜,ç‰©ä½“è¶Šä¸äº®2)å¯ä»¥è¿›ä¸€æ­¥å¯¹é€æ˜è¿›è¡Œä¿®æ”¹EXTENDED PARAMETERS-ADVANCED TRANSPARENCYFALL OFF(è¡°å‡) TYPE(1)FILTER(è¿‡æ»¤,åœ¨ç‰©ä½“ä¸Šç•™ä¸‹ä¸€ç§é¢œè‰²)(2)SUBTRACTIVE(å½“å‰ç‰©ä½“é¢œè‰²å‡å»èƒŒæ™¯è‰²)ä½¿ç‰©ä½“æ›´æš—(3)ADDITIVE(å½“å‰ç‰©ä½“é¢œè‰²åŠ ä¸ŠèƒŒæ™¯è‰²)ä½¿ç‰©ä½“æ›´äº®ä¾‹:æ¯å­,çŸ¿æ³‰æ°´ç“¶æ³¨æ„:ç»ç’ƒä½œé€æ˜ä¸èƒ½å¤ªåš3)INDEX OF REFRACTION(æŠ˜å°„ç‡)æ°´(1.3)ç»ç’ƒ(1.5)é«˜å…‰å›ºä½“(2.0)å››.æ”¹å˜èƒŒæ™¯è‰²çš„é¢œè‰²(RENDERING-ENVIRONMENT)ç¬¬åä¸‰è®² æè´¨(äºŒ) ä¸€.æ¸²æŸ“æ¨¡å¼1.METAL(é‡‘å±)1)SPECULAR(é«˜å…‰åº¦) æœ€ä½³çš„å–å€¼èŒƒå›´ï¼ˆ60~70ï¼‰2)GLOSSINESS(å…‰æ³½åº¦) æœ€ä½³çš„å–å€¼èŒƒå›´ï¼ˆ60~70ï¼‰2.ANISOTROPIC(å„å‘å¼‚å½¢)ä¸»è¦æ§åˆ¶é«˜å…‰çš„å½¢çŠ¶1)ANISOTROPIC(0,åœ†å½¢é«˜å…‰,50,æ¤­åœ†é«˜å…‰,100,çº¿å½¢é«˜å…‰)2)ORIENTATION(æ§åˆ¶é«˜å…‰çš„æ–¹å‘)3.MULTI-LAYER(å¤šå±‚)åœ¨ANISOTROPICåŸºç¡€ä¸Šå†å¢åŠ ä¸€å±‚æ¥æ§åˆ¶é«˜å…‰4.STRAUSS(é‡‘å±åŠ å¼º)(é‡‘å±æ¸²æŸ“æ–¹å¼ä¸€ç§)æ¸²æŸ“ç²—ç³™,ä¸å…‰æ»‘,æœ‰å‡¹å‡¸æ„Ÿ**5.BLINN(åå°„)æŸ”å’Œä¸€ç‚¹,ä½å…‰ç…§å°„çš„æ•ˆæœ6.PHONG(å¤šé¢)ä¸BLINNç›¸ä¼¼7.OREN-NAYER-BLINN(æ˜æš—å¤„ç†å™¨)é€‚åˆäºåˆ¶ä½œè¡¨ç°ç‰©ä½“æ¨¡ç³Šçš„â€æè´¨â€äºŒ.å›¾æ ‡ä»‹ç»1.GET MATERIAL(è·å–æè´¨)(æ³¨:åªèƒ½è·å–æè´¨,ä¸èƒ½è·å–è´´å›¾)1)MTLIBARY (ä»æè´¨åº“ä¸­è·å–æè´¨)(C:\3DMAX4.0\MATLIBS\.MAT)2)MTL EDITOR (ä»æè´¨ç¼–è¾‘å™¨ä¸­è·å–æè´¨)(ä¸€å…±æœ‰24ä¸ª)3)ACTIVE (ä»æ¿€æ´»çš„æ ·æœ¬çƒ(ç™½æ¡†)ä¸­è·å–æè´¨)4)SELECTED (ä»é€‰å®šçš„ç‰©ä½“ä¸­è·å–æè´¨)5)SCENCE (ä»åœºæ™¯ä¸­è·å–æè´¨)6)NEW (è·å–æ–°çš„æè´¨)2.PUT MATERIAL TO SCENE (å°†ä¿®æ”¹äº†çš„æè´¨,é‡æ–°èµ‹ç»™åœºæ™¯)3.ASSIGN MATERIAL TO SELECTION (å°†æŒ‡å®šçš„æè´¨èµ‹ç»™é€‰å®šçš„å¯¹è±¡)4.RESET MAP/MTL TO DEFAULT SETTINGS (æ¢å¤åˆ°é»˜è®¤çš„è®¾ç½®)5.MAKE MATERIAL COPY (å°†çƒ­æè´¨è¿›è¡Œå¤åˆ¶)(æ³¨:1)å½“æ˜¯çƒ­æè´¨æ—¶,æ‰æœ‰ç”¨ 2)çƒ­æè´¨å˜æˆå†·æè´¨,æ²¡æœ‰çƒ­æè´¨æ ‡å¿—)6.PUT TO LIBRARY(å°†ç¼–è¾‘å¥½çš„æè´¨ä¿å­˜åˆ°æè´¨åº“ä¸­,ä»æè´¨åº“ä¸­å¯è·å–æ­¤æè´¨)ç¬¬åå››è®² æè´¨ï¼ˆä¸‰ï¼‰ ä¸€.è´´å›¾ï¼ˆæ˜¯æŒ‡å¸¦æœ‰å›¾æ¡ˆ,çº¹ç†çš„å›¾åƒä¿¡æ¯,å®ƒé™„äºæè´¨ä¹‹ä¸Šï¼‰1.å¦‚ä½•è´´å›¾1)é€šè¿‡é€‰æ‹©MAPS(è´´å›¾)ä¸­çš„é€šé“æ¥è´´å›¾ä¾‹:DIFFUSE COLOR(ä¸»å…‰åŒºé¢œè‰²é€šé“)2.å›¾çš„æ¥æºæ–¹å¼1)è‡ªå¸¦çš„ç¨‹åºå›¾(ä¾‹å¦‚:BRICK,CELLULARç­‰ç­‰)2)æ‹¾å–å¤–é¢çš„å›¾(é€šè¿‡BITMAP)ï¼ˆæ³¨æ„ï¼šå½“ä½ æ‹¾å–å¤–é¢çš„å›¾æ—¶ï¼Œæ³¨æ„å›¾ç‰‡æ ¼å¼å›¾ç‰‡æ ¼å¼æ˜¯PSDçš„è¯æ˜¯èƒ½æ‹¾å–çš„ï¼‰3.å›¾çš„ä¿®æ”¹1)COORDINATES(è´´å›¾æåæ ‡)(åç§»,å¹³é“º,æ—‹è½¬)2)BITMAP PARAMETERS(ä½å›¾å‚æ•°)ï¼ˆåªæœ‰æ‹¾å–å¤–é¢çš„å›¾æ‰æœ‰ï¼‰4.æœ‰äº›å›¾è´´ä¸ä¸Šå»,æ˜¯å› ä¸ºè´´å›¾åæ ‡çš„é—®é¢˜1)åˆ›å»ºä¸€ä¸ªç‰©ä½“éƒ½å¸¦æœ‰GENERATE MAPPING COORDS(è´´å›¾åæ ‡)(1)BOX5.è´´å›¾åæ ‡çš„ä¿®æ”¹å™¨MODIFIERSâ€”UV COORDINATEâ€”UVW MAPï¼ˆé’ˆå¯¹äºè§£å†³MISSING MAP COORDINATESï¼ˆä¸¢å¤±è´´å›¾åæ ‡ï¼‰çš„é—®é¢˜ï¼‰1)PLANAR (å¹³é¢)2)CYLINDRICAL(åœ†æŸ±ä½“)3)SPHERICAL (çƒä½“) 4)SHRINK WRAP(æ”¶ç¼©åŒ…è£¹) 5)BOX (ç›’å­)6)FACE (é¢çŠ¶)ï¼ˆä¸åˆ†æ ¼æ•°æœ‰å…³ï¼‰7)XYZ TO UVW (ç‰©ä½“æœ¬èº«å…·æœ‰çš„åæ ‡ åˆ° å›¾è´´çš„æ–¹å‘)6.å¯¹é½ 1)FIT ï¼ˆé€‚é…ï¼‰ 2)CENTER ï¼ˆä½¿å›¾å±…ä¸­ï¼‰3)BITMAP FIT ï¼ˆæ ¹æ®ä½ æ‰€é€‰çš„ä½å›¾å¯¹é½ï¼‰4)NORMAL ALIGNï¼ˆæ³•çº¿å¯¹é½ï¼Œåªèƒ½åœ¨é€è§†å›¾ä¸­è¿›è¡Œå¯ä»»æ„ç§»åŠ¨å›¾ç‰‡åœ¨ä»»æ„é¢ä¸Š5)VIEW ALIGN ï¼ˆä»¥å½“å‰æ­£äº¤è§†å›¾å¯¹é½ï¼‰ 6)REGION FIT ï¼ˆç”»ä¸€ä¸ªåŒºåŸŸè¿›è¡Œè´´ï¼Œä¼šäº§ç”Ÿé‡å¤è´´ï¼Œ æƒ³ä¸é‡å¤è´´å›åˆ°æè´¨ç¼–è¾‘å™¨ï¼Œå–æ¶ˆTILEé’©ï¼‰7)RESET ï¼ˆæ¢å¤åŸå§‹å€¼ï¼‰8)ACQUIRE ï¼ˆä»å…¶å®ƒç‰©ä½“è·å–ä¸€ä¸ªè´´å›¾åæ ‡ï¼‰ï¼ˆç›¸å¯¹ï¼Œç»å¯¹ï¼‰ï¼ˆ1-Wçš„å€¼ï¼‰/2=Uçš„å€¼ï¼ˆå›¾æ°´å¹³æ”¾åœ¨ä¸­é—´ï¼‰ï¼ˆ1-Hçš„å€¼ï¼‰/2=Vçš„å€¼ï¼ˆå›¾å‚ç›´æ”¾åœ¨ä¸­é—´ï¼‰.jpg .bmp .tif .tga .png .psdï¼ˆåœ¨3DMAX5.0ä¸­æ”¯æŒï¼‰]]></content>
      <categories>
        <category>3DMax</category>
      </categories>
      <tags>
        <tag>3DMax</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vspathmacro]]></title>
    <url>%2F2019%2F05%2F11%2Fvspathmacro%2F</url>
    <content type="text"><![CDATA[$(SolutionDir) è§£å†³æ–¹æ¡ˆçš„ç›®å½•ï¼ˆå®šä¹‰å½¢å¼ï¼šé©±åŠ¨å™¨+è·¯å¾„ï¼‰ï¼›åŒ…æ‹¬å°¾éƒ¨çš„åæ–œæ â€\â€ï¼Œå’ŒslnåŒçº§ç›®å½•]]></content>
      <categories>
        <category>VS</category>
      </categories>
      <tags>
        <tag>C++</tag>
        <tag>VS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[marshal]]></title>
    <url>%2F2019%2F05%2F10%2Fmarshal%2F</url>
    <content type="text"></content>
  </entry>
  <entry>
    <title><![CDATA[C#ç»“æ„ä½“å­—èŠ‚å¯¹é½æ–¹å¼]]></title>
    <url>%2F2019%2F05%2F10%2Fcsharpstructbytealignment%2F</url>
    <content type="text"><![CDATA[12345678[StructLayout(LayoutKind.Sequential, CharSet=CharSet.Ansi)]internal struct DllInvoices&#123; [MarshalAs(UnmanagedType.ByValArray, SizeConst=8)] public byte[] serial; public byte Type; public uint Sum;&#125; è°ƒç”¨Marshal.SizeOf(typeof(DllInvoices))å¾—åˆ°çš„å¤§å°ä¸º16ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯13ï¼Ÿè¿™å…¶å®æ˜¯ä½“ç³»ç»“æ„å’Œæ±‡ç¼–çš„é—®é¢˜ã€‚åœ¨å†…å­˜é‡Œç‰¹å®šç±»å‹æ•°æ®çš„èµ·å§‹åœ°å€é€šå¸¸æœ‰ä¸€å®šçš„å¯¹é½è¦æ±‚ï¼Œæ¯”å¦‚è¯´32ä½æœºå™¨ä¸Šçš„intèµ·å§‹åœ°å€å¿…é¡»æ˜¯4çš„æ•´æ•°å€ï¼Œç»“æ„é€šå¸¸ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¦‚æœä¸€ä¸ªç»“æ„åŒ…å«ä¸€ä¸ªcharå’Œä¸€ä¸ªintï¼Œé‚£ä¹ˆcharä½œä¸ºç»“æ„ä½“çš„ç¬¬ä¸€ä¸ªå­—æ®µï¼Œéœ€è¦åœ¨4çš„æ•´æ•°å€åœ°å€å¼€å§‹ï¼Œè€Œintæœ‰åŒæ ·çš„è¦æ±‚ï¼Œæ‰€ä»¥charä¹‹åå¿…é¡»ç©ºå‡º3ä¸ªå­—èŠ‚æ¥ï¼Œæ‰èƒ½ä½¿intçš„åœ°å€æ»¡è¶³å¯¹é½çš„è¦æ±‚ã€‚.NETçš„CLRæ˜¯åŸºäº32ä½çš„ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯4å­—èŠ‚å¯¹é½çš„ã€‚åœ¨byteä¹‹åï¼Œå¿…é¡»ç©ºå‡º3ä¸ªå­—èŠ‚ã€‚æ‰€ä»¥ç»“æœå°±æ˜¯16å­—èŠ‚äº†ã€‚å¯ä»¥é€šè¿‡StructLayoutçš„Packå±æ€§æ”¹å˜è¿™ç§å¯¹é½è®¾ç½®ã€‚ [StructLayout(LayoutKind.Sequential, CharSet=CharSet.Ansi, Pack=1)] MarshalAså±æ€§æŒ‡ç¤ºå¦‚ä½•åœ¨æ‰˜ç®¡ä»£ç å’Œéæ‰˜ç®¡ä»£ç ä¹‹é—´å°é€æ•°æ®ã€‚ å½“MarshalAsAttribute.Valueè®¾ç½®ä¸ºByValArrayæ—¶ï¼Œå¿…é¡»è®¾ç½®SizeConstä»¥æŒ‡ç¤ºæ•°ç»„ä¸­çš„å…ƒç´ æ•°ã€‚å½“éœ€è¦åŒºåˆ†å­—ç¬¦ä¸²ç±»å‹æ—¶ï¼ŒArraySubTypeå­—æ®µå¯ä»¥é€‰æ‹©åŒ…å«æ•°ç»„å…ƒç´ çš„UnmanagedTypeã€‚æ­¤UnmanagedTypeåªå¯ç”¨äºä½œä¸ºç»“æ„ä¸­çš„å­—æ®µçš„æ•°ç»„ã€‚è€ŒSizeConståˆ™æ˜¯æŒ‡æ•°ç»„çš„å…ƒç´ ä¸ªæ•°ã€‚]]></content>
      <categories>
        <category>CSharp</category>
      </categories>
      <tags>
        <tag>CSharp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[quaternion]]></title>
    <url>%2F2019%2F05%2F10%2Fquaternion%2F</url>
    <content type="text"><![CDATA[ä¸‰ç»´ç©ºé—´ä¸­çš„æ—‹è½¬åœ¨è®¨è®ºå››å…ƒæ•°ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç ”ç©¶ä¸€ä¸‹ä¸‰ç»´ç©ºé—´ä¸­æ—‹è½¬ã€‚è¡¨ç¤ºä¸‰ç»´ç©ºé—´ä¸­æ—‹è½¬çš„æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œä½†æˆ‘ä»¬è¿™é‡Œå…³æ³¨çš„æ˜¯è½´è§’å¼ï¼ˆAxis-angleï¼‰çš„æ—‹è½¬ã€‚è™½ç„¶ä½¿ç”¨æ¬§æ‹‰è§’çš„æ—‹è½¬å¾ˆå¸¸ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“æ¬§æ‹‰è§’çš„è¡¨ç¤ºæ–¹æ³•ä¸ä»…ä¼šå¯¼è‡´Gimbal Lockè€Œä¸”ä¾èµ–äºä¸‰ä¸ªåæ ‡è½´çš„é€‰å®šï¼Œä½¿ç”¨å››å…ƒæ•°æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬è¿™é‡Œæ‰€è¦è®¨è®ºçš„è½´è§’å¼æ—‹è½¬æ˜¯æ—‹è½¬æ›´åŠ æ™®éçš„æƒ…å†µï¼šå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç»è¿‡åŸç‚¹çš„ï¼ˆå¦‚æœæ—‹è½¬è½´ä¸ç»è¿‡åŸç‚¹æˆ‘ä»¬å¯ä»¥å…ˆå°†æ—‹è½¬è½´å¹³ç§»åˆ°åŸç‚¹ï¼Œè¿›è¡Œæ—‹è½¬ï¼Œåœ¨å¹³ç§»å›åŸå¤„ï¼‰æ—‹è½¬è½´$u=(x,y,z)^T$ï¼Œæˆ‘ä»¬å¸Œæœ›å°†ä¸€ä¸ªå‘é‡vï¼Œæ²¿ç€è¿™ä¸ªæ—‹è½¬è½´æ—‹è½¬$\theta$åº¦ï¼Œå˜æ¢åˆ°vâ€™ï¼š æ³¨æ„ï¼Œåœ¨è¿™ç¯‡æ•™ç¨‹ä¸­æˆ‘ä»¬å°†ä½¿ç”¨å³æ‰‹åæ ‡ç³»ç»Ÿï¼Œå¹¶ä¸”æˆ‘ä»¬å°†ä½¿ç”¨å³æ‰‹å®šåˆ™æ¥å®šä¹‰æ—‹è½¬çš„æ­£æ–¹å‘ã€‚ å››å…ƒç´ ç»ˆäºï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹è®¨è®ºå››å…ƒæ•°ä¸æ—‹è½¬ä¹‹é—´çš„å…³ç³»äº†ã€‚å››å…ƒæ•°çš„å®šä¹‰å’Œå¤æ•°éå¸¸ç±»ä¼¼ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å››å…ƒæ•°ä¸€å…±æœ‰ä¸‰ä¸ªè™šéƒ¨ï¼Œè€Œå¤æ•°åªæœ‰ä¸€ä¸ªã€‚æ‰€æœ‰çš„å››å…ƒæ•°éƒ½å¯ä»¥åç¨‹ä¸‹é¢è¿™ç§å½¢å¼ï¼š$q=a+bi+cj+dk (a,b,c,d \in R)$å…¶ä¸­ï¼š$i^2=j^2=k^2=ijk=-1$]]></content>
  </entry>
  <entry>
    <title><![CDATA[jobsystemnativecontainer]]></title>
    <url>%2F2019%2F05%2F10%2Fjobsystemnativecontainer%2F</url>
    <content type="text"><![CDATA[Allocator.Temp has the fastest allocation.It is for allocations with a lefespan(å¯¿å‘½) of one frame or fewer. Allocator.TempJob is a slower allocation than Temp but is faster than Persistent.It is for allocations within a lifespan of four frames and is thread-safe. Allocator.Persistent is the slowest allocation but can last as long as you need it to,]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[EventSource]]></title>
    <url>%2F2019%2F05%2F10%2FEventSource%2F</url>
    <content type="text"><![CDATA[åŸåˆ™ä¸Šä¸ä¼šå‡ºç°æ‰˜ç®¡å †æ•°æ®ï¼Œä¸ä¼šListæ¥å£ï¼Œæ•°æ®ç»Ÿä¸€ç”³è¯·ï¼ŒæŒ‰éœ€é‡Šæ”¾ã€‚ å……åˆ†åˆ©ç”¨CPUï¼Œé˜²æ­¢è®©çº¿ç¨‹ä¹‹é—´åˆ‡æ¢æ—¶é—´ç‰‡çš„å‘ç”Ÿã€‚]]></content>
      <categories>
        <category>GameFramework</category>
      </categories>
      <tags>
        <tag>GameFramework</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSharp Thread]]></title>
    <url>%2F2019%2F05%2F10%2Fcsharp-thread%2F</url>
    <content type="text"><![CDATA[IsBackgroundA thread is either a background thread or a foreground thread.Background threads are identical to foreground threads,except that background threads do not prevent a process from terminating.é€šè¿‡Threadç±»æ–°å»ºçº¿ç¨‹é»˜è®¤ä¸ºå‰å°çº¿ç¨‹ã€‚å½“æ‰€æœ‰å‰å°çº¿ç¨‹å…³é—­æ—¶ï¼Œæ‰€æœ‰çš„åå°çº¿ç¨‹ä¹Ÿä¼šè¢«ç›´æ¥ç»ˆæ­¢ï¼Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ Thread.sleep(0)åœ¨Javaæˆ–è€…C#ä¸­ï¼Œéƒ½ä¼šç”¨åˆ°Thread.Sleep()æ¥ä½¿çº¿ç¨‹æŒ‚èµ·ä¸€æ®µæ—¶é—´ã€‚é‚£ä¹ˆä½ æœ‰æ²¡æœ‰æ­£ç¡®çš„ç†è§£è¿™ä¸ªæ–¹æ³•çš„ç”¨æ³•å‘¢ï¼Ÿæ€è€ƒä¸‹é¢è¿™ä¸¤ä¸ªé—®é¢˜ï¼š å‡è®¾ç°åœ¨2019-5-13 17:00:00.000ï¼Œå¦‚æœæˆ‘è°ƒç”¨ä¸€ä¸‹Thread.Sleep(1000)ï¼Œåœ¨2019-5-13 17:00:01.000çš„æ—¶å€™ï¼Œè¿™ä¸ªçº¿ç¨‹ä¼šä¸ä¼šè¢«å”¤é†’ï¼Ÿ ä»£ç ä¸­æ·»åŠ ï¼šThread.Sleep(0)ã€‚æ—¢ç„¶æ˜¯Sleep 0æ¯«ç§’ï¼Œé‚£ä¹ˆå’Œå»æ‰è¿™å¥ä»£ç ç›¸æ¯”ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ é¦–å…ˆå›é¡¾ä¸€ä¸‹æ“ä½œç³»ç»ŸåŸç†åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼ŒCPUç«äº‰æœ‰å¾ˆå¤šç§ç­–ç•¥ã€‚Unixç³»ç»Ÿä½¿ç”¨çš„æ˜¯æ—¶é—´ç‰‡ç®—æ³•ï¼Œè€ŒWindowsåˆ™å±äºæŠ¢å å¼çš„ã€‚åœ¨æ—¶é—´ç‰‡ç®—æ³•ä¸­ï¼Œæ‰€æœ‰çš„è¿›ç¨‹æ‹æˆä¸€ä¸ªé˜Ÿåˆ—ã€‚æ“ä½œç³»ç»ŸæŒ‰ç…§ä»–ä»¬é¡ºåºï¼Œç»™æ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€æ®µæ—¶é—´ï¼Œå³è¯¥è¿›ç¨‹å…è®¸è¿è¡Œçš„æ—¶é—´ã€‚å¦‚æœåœ¨æ—¶é—´ç‰‡ç»“æŸæ—¶è¿›ç¨‹è¿˜åœ¨è¿è¡Œï¼Œåˆ™CPUå°†è¢«å‰¥å¤ºå¹¶åˆ†é…ç»™å¦ä¸€ä¸ªè¿›ç¨‹ã€‚å¦‚æœè¿›ç¨‹åœ¨æ—¶é—´ç‰‡ç»“æŸå‰é˜»å¡æˆ–ç»“æŸï¼Œåˆ™CPUå½“å³è¿›è¡Œåˆ‡æ¢ã€‚è°ƒåº¦ç¨‹åºæ‰€è¦åšçš„å°±æ˜¯ç»´æŠ¤ä¸€å¼ å°±ç»ªè¿›ç¨‹åˆ—è¡¨ï¼Œå½“è¿›ç¨‹ç”¨å®Œå®ƒçš„æ—¶é—´ç‰‡åï¼Œå®ƒè¢«ç§»åˆ°é˜Ÿåˆ—çš„æœ«å°¾ã€‚æ‰€è°“æŠ¢å å¼æ“ä½œç³»ç»Ÿï¼Œå°±æ˜¯è¯´å¦‚æœä¸€ä¸ªè¿›ç¨‹å¾—åˆ°äº†CPUæ—¶é—´ï¼Œé™¤éå®ƒè‡ªå·±æ”¾å¼ƒä½¿ç”¨CPUï¼Œå¦åˆ™å°†å®Œå…¨éœ¸å CPUã€‚å› æ­¤å¯ä»¥çœ‹å‡ºï¼Œåœ¨æŠ¢å å¼æ“ä½œç³»ç»Ÿä¸­ï¼Œæ“ä½œç³»ç»Ÿå‡è®¾æ‰€æœ‰çš„è¿›ç¨‹éƒ½ä¼šä¸»åŠ¨é€€å‡ºCPUã€‚åœ¨æŠ¢å å¼æ“ä½œç³»ç»Ÿä¸­ï¼Œå‡è®¾æœ‰è‹¥å¹²è¿›ç¨‹ï¼Œæ“ä½œç³»ç»Ÿä¼šæ ¹æ®ä»–ä»¬çš„ä¼˜å…ˆçº§ã€é¥¥é¥¿æ—¶é—´ï¼ˆå·²ç»å¤šé•¿æ—¶é—´æ²¡æœ‰ä½¿ç”¨è¿‡CPUäº†ï¼‰ï¼Œç»™ä»–ä»¬ç®—å‡ºä¸€ä¸ªæ€»çš„ä¼˜å…ˆçº§æ¥ã€‚æ“ä½œç³»ç»Ÿå°±ä¼šæŠŠCPUäº¤ç»™æ€»ä¼˜å…ˆçº§æœ€é«˜çš„è¿™ä¸ªè¿›ç¨‹ã€‚å½“è¿›ç¨‹æ‰§è¡Œå®Œæ¯•æˆ–è€…è‡ªå·±ä¸»åŠ¨æŒ‚èµ·åï¼Œæ“ä½œç³»ç»Ÿå°±ä¼šé‡æ–°è®¡ç®—ä¸€æ¬¡æ‰€æœ‰è¿›ç¨‹çš„æ€»ä¼˜å…ˆçº§ï¼Œç„¶ååœ¨æŒ‘ä¸€ä¸ªä¼˜å…ˆçº§æœ€é«˜çš„æŠŠCPUæ§åˆ¶æƒäº¤ç»™ä»–ã€‚æˆ‘ä»¬ç”¨åˆ†è›‹ç³•çš„åœºæ™¯æ¥æè¿°è¿™ä¸¤ç§ç®—æ³•ã€‚å‡è®¾æœ‰æºæºä¸æ–­çš„è›‹ç³•ï¼ˆæºæºä¸æ–­çš„æ—¶é—´ï¼‰ï¼Œä¸€å‰¯åˆ€å‰ï¼ˆä¸€ä¸ªCPUï¼‰ï¼Œ10ä¸ªç­‰å¾…åƒè›‹ç³•çš„äººï¼ˆ10ä¸ªè¿›ç¨‹ï¼‰ã€‚å¦‚æœæ˜¯Unixæ“ä½œç³»ç»Ÿæ¥è´Ÿè´£åˆ†è›‹ç³•ï¼Œé‚£ä¹ˆä»–ä¼šè¿™æ ·é¡¶è§„å®šï¼šæ¯ä¸ªäººä¸Šæ¥åƒ1åˆ†é’Ÿï¼Œæ—¶é—´åˆ°äº†æ¢ä¸‹ä¸€ä¸ªã€‚æœ€åä¸€ä¸ªäººåƒå®Œäº†å°±å†ä»å¤´å¼€å§‹ã€‚äºæ˜¯ï¼Œä¸ç®¡è¿™10ä¸ªäººæ˜¯ä¸æ˜¯ä¼˜å…ˆçº§ä¸åŒã€é¥¥é¥¿æˆéƒ½ä¸åŒã€é¥­é‡ä¸åŒï¼Œæ¯ä¸ªäººä¸Šæ¥çš„æ—¶å€™éƒ½å¯ä»¥åƒ1åˆ†é’Ÿã€‚å½“ç„¶ï¼Œå¦‚æœæœ‰äººæœ¬æ¥ä¸å¤ªé¥¿ï¼Œæˆ–è€…é¥­é‡å°ï¼Œåƒäº†30ç§’ä¸­ä¹‹åå°±åƒé¥±äº†ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥è·Ÿæ“ä½œç³»ç»Ÿè¯´ï¼šæˆ‘å·²ç»åƒé¥±äº†ï¼ˆæŒ‚èµ·ï¼‰ã€‚äºæ˜¯æ“ä½œç³»ç»Ÿå°±ä¼šè®©ä¸‹ä¸€ä¸ªäººæ¥ç€åƒã€‚å¦‚æœæ˜¯Windowsæ“ä½œç³»ç»Ÿæ¥è´Ÿè´£åˆ†è›‹ç³•çš„ï¼Œé‚£ä¹ˆåœºé¢å°±å¾ˆæœ‰æ„æ€äº†ã€‚ä»–ä¼šè¿™æ ·é¡¶è§„çŸ©ï¼šæˆ‘ä¼šæ ¹æ®ä½ ä»¬çš„ä¼˜å…ˆçº§ã€é¥¥é¥¿ç¨‹åºä¼šç»™ä½ ä»¬æ¯ä¸ªäººè®¡ç®—ä¸€ä¸ªä¼˜å…ˆçº§ã€‚ä¼˜å…ˆçº§æœ€é«˜çš„é‚£ä¸ªäººï¼Œå¯ä»¥ä¸Šæ¥åƒè›‹ç³•ï¼Œåƒåˆ°ä½ ä¸æƒ³åƒä¸ºæ­¢ã€‚ç­‰è¿™ä¸ªäººåƒå®Œäº†ï¼Œæˆ‘å†é‡æ–°æ ¹æ®ä¼˜å…ˆçº§ã€é¥¥é¥¿ç¨‹åºæ¥è®¡ç®—æ¯ä¸ªäººçš„ä¼˜å…ˆçº§ï¼Œç„¶åå†åˆ†ç»™ä¼˜å…ˆçº§æœ€é«˜çš„é‚£ä¸ªäººã€‚è¿™æ ·çœ‹æ¥ï¼Œè¿™ä¸ªåœºé¢å°±å¾ˆæ„æ€äº†ï¼Œå¯èƒ½æœ‰äº›äººæ˜¯MMï¼Œå› æ­¤å…·æœ‰é«˜ä¼˜å…ˆçº§ï¼Œäºæ˜¯å¥¹å°±å¯ä»¥ç»å¸¸æ¥åƒè›‹ç³•ã€‚å¯èƒ½å¦å¤–ä¸€ä¸ªäººä¼˜å…ˆçº§ç‰¹åˆ«ä½ï¼Œäºæ˜¯å¥½åŠå¤©äº†æ‰è½®åˆ°ä»–ä¸€æ¬¡ï¼ˆå› ä¸ºéšç€æ—¶é—´çš„æ¨ç§»ï¼Œä»–ä¼šè¶Šæ¥è¶Šé¥¥é¥¿ï¼Œå› æ­¤ç®—å‡ºæ¥çš„æ€»ä¼˜å…ˆçº§å°±ä¼šè¶Šæ¥è¶Šé«˜ï¼Œå› æ­¤æ€»æœ‰ä¸€å¤©ä¼šè½®åˆ°ä»–ï¼‰ã€‚è€Œä¸”ï¼Œå¦‚æœä¸€ä¸å°å¿ƒè®©ä¸€ä¸ªå¤§èƒ–å­å¾—åˆ°äº†åˆ€å‰ï¼Œå› ä¸ºä»–é¥­é‡å¤§ï¼Œå¯èƒ½ä»–ä¼šéœ¸å ç€è›‹ç³•è¿ç»­åƒå¾ˆä¹…å¾ˆä¹…ã€‚è€Œä¸”ï¼Œè¿˜å¯èƒ½ä¼šæœ‰è¿™ç§æƒ…å†µå‡ºç°ï¼šæ“ä½œç³»ç»Ÿç°åœ¨è®¡ç®—å‡ºæ¥çš„ç»“æœï¼Œ5å·MMæ€»ä¼˜å…ˆçº§æœ€é«˜ï¼Œè€Œä¸”é«˜å‡ºåˆ«äººä¸€å¤§æˆªã€‚å› æ­¤å°±å«5å·æ¥åƒè›‹ç³•ã€‚5å·åƒäº†ä¸€å°ä¼šå„¿ï¼Œè§‰å¾—æ²¡é‚£ä¹ˆé¥¿äº†ï¼Œäºæ˜¯è¯´â€œæˆ‘ä¸åƒäº†â€ï¼ˆæŒ‚æœºï¼‰ã€‚å› æ­¤æ“ä½œç³»ç»Ÿå°±ä¼šé‡æ–°è®¡ç®—æ‰€æœ‰äººçš„ä¼˜å…ˆçº§ã€‚å› ä¸º5å·åˆšåˆšåƒè¿‡ï¼Œå› æ­¤å¥¹çš„é¥¥é¥¿ç¨‹åºå˜å°äº†ï¼Œäºæ˜¯æ€»ä¼˜å…ˆçº§å˜å°äº†ï¼›è€Œå…¶ä»–äººå› ä¸ºå¤šç­‰äº†ä¸€ä¼šå„¿ï¼Œé¥¥é¥¿ç¨‹åº¦éƒ½å˜å¤§äº†ï¼Œæ‰€ä»¥æ€»ä¼˜å…ˆçº§ä¹Ÿå˜å¤§äº†ã€‚ä¸è¿‡è¿™æ—¶å€™ä»ç„¶æœ‰å¯èƒ½5å·çš„ä¼˜å…ˆçº§æ¯”åˆ«çš„éƒ½æï¼Œåªä¸è¿‡ç°åœ¨åªæ¯”å…¶ä»–çš„é«˜ä¸€ç‚¹ç‚¹ï¼Œä½†å¥¹ä»ç„¶æ˜¯æ€»ä¼˜å…ˆçº§æœ€é«˜çš„å‘€ã€‚å› æ­¤æ“ä½œç³»ç»Ÿå°±ä¼šè¯´ï¼š5å·MMä¸Šæ¥åƒè›‹ç³•â€¦.ï¼ˆ5å·MMå¿ƒé‡Œéƒé—·ï¼Œè¿™ä¸åˆšåƒè¿‡å˜›ï¼Œäººå®¶è¦å‡è‚¥ã€‚ã€‚è°å«ä½ é•¿é‚£ä¹ˆæ¼‚äº®ï¼Œè·å¾—äº†é‚£ä¹ˆé«˜çš„ä¼˜å…ˆçº§ï¼‰ã€‚é‚£ä¹ˆï¼ŒThread.Sleep()æ˜¯å¹²å—çš„å‘¢ï¼Ÿè¿˜ç”¨åˆšæ‰çš„åˆ†è›‹ç³•çš„åœºæ™¯æ¥æè¿°ã€‚ä¸Šé¢çš„åœºæ™¯é‡Œé¢ï¼Œ5å·MMå†åƒäº†ä¸€æ¬¡è›‹ç³•ä¹‹åï¼Œè§‰å¾—å·²ç»æœ‰8åˆ†é¥±äº†ï¼Œå¥¹è§‰å¾—å†æœªæ¥åŠä¸ªå°æ—¶ä¹‹å†…ä¸æƒ³å†æ¥åƒè›‹ç³•äº†ï¼Œé‚£ä¹ˆå¥¹å°±ä¼šè·Ÿæ“ä½œç³»ç»Ÿè¯´ï¼šå†æœªæ¥çš„åŠå°æ—¶ä¹‹å†…ä¸è¦å«æˆ‘ä¸Šæ¥åƒè›‹ç³•äº†ã€‚è¿™æ ·ï¼Œæ“ä½œç³»ç»Ÿå†éšåçš„åŠå°æ—¶é‡Œé¢é‡æ–°è®¡ç®—æ‰€æœ‰äººæ€»ä¼˜å…ˆçº§çš„æ—¶å€™ï¼Œå°±ä¼šå¿½ç•¥5å·MMã€‚Sleepå‡½æ•°å°±æ˜¯å¹²è¿™äº‹çš„ï¼Œä»–å‘Šè¯‰æ“ä½œç³»ç»Ÿâ€œåœ¨æœªæ¥çš„å¤šå°‘æ¯«ç§’å†…æˆ‘ä¸å‚ä¸CPUç«äº‰â€ã€‚çœ‹å®Œäº†Thread.Sleep()çš„ä½œç”¨ï¼Œå†æ¥è€ƒè™‘å‰é¢çš„ä¸¤ä¸ªé—®é¢˜ã€‚å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œç­”æ¡ˆæ˜¯ï¼šä¸ä¸€å®šï¼Œå› ä¸ºä½ åªæ˜¯å‘Šè¯‰æ“ä½œç³»ç»Ÿï¼šåœ¨æœªæ¥çš„1000æ¯«ç§’å†…æˆ‘ä¸æƒ³å†å‚ä¸åˆ°PUç«äº‰ã€‚é‚£ä¹ˆ1000æ¯«ç§’è¿‡å»ä¹‹åï¼Œè¿™æ—¶å€™ä¹Ÿè®¸å¦å¤–ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨ä½¿ç”¨CPUã€‚é‚£ä¹ˆè¿™æ—¶å€™æ“ä½œç³»ç»Ÿæ˜¯ä¸ä¼šé‡æ–°åˆ†é…CPUçš„ï¼Œç›´åˆ°é‚£ä¸ªçº¿ç¨‹æŒ‚èµ·æˆ–ç»“æŸï¼›å†µä¸”ï¼Œå³ä½¿è¿™ä¸ªæ—¶å€™æ°å·§è½®åˆ°æ“ä½œç³»ç»Ÿè¿›è¡ŒCPUåˆ†é…ï¼Œé‚£ä¹ˆå½“å‰çº¿ç¨‹ä¹Ÿä¸ä¸€å®šå°±æ˜¯æ€»ä¼˜å…ˆçº§æœ€é«˜çš„é‚£ä¸ªï¼ŒCPUè¿˜æ˜¯å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹æŠ¢å å»ã€‚ä¸æ­¤ç›¸ä¼¼çš„ï¼ŒThreadæœ‰ä¸ªResume()ï¼Œç”¨æ¥å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹ã€‚å½“ç„¶ï¼Œè¿™ä¸ªå‡½æ•°åªæ˜¯â€œå‘Šè¯‰æ“ä½œç³»ç»Ÿæˆ‘ä»ç°åœ¨å¼€å§‹å‚ä¸CPUç«äº‰äº†â€ï¼Œè¿™ä¸ªå‡½æ•°çš„è°ƒç”¨å¹¶ä¸èƒ½é©¬ä¸Šä½¿å¾—è¿™ä¸ªçº¿ç¨‹è·å¾—CPUçš„æ§åˆ¶æƒã€‚ä¸è¿‡ï¼Œå› ä¸ºå…·æœ‰æ­»é”å€¾å‘ï¼ŒJDK1.6ä»¥åå·²ç»ä¸èµæˆæ˜¯ä½¿ç”¨Thread.stopã€Thread.suspendã€Thread.resumeã€‚å¯¹äºç¬¬äºŒä¸ªé—®é¢˜ï¼Œç­”æ¡ˆæ˜¯ï¼šæœ‰ï¼Œè€Œä¸”åŒºåˆ«å¾ˆæ˜æ˜¾ï¼Œå‡å¦‚æˆ‘ä»¬åˆšæ‰çš„åˆ†è›‹ç³•åœºæ™¯é‡Œé¢ï¼Œæœ‰å¦å¤–ä¸€ä¸ªMM7å·ï¼Œè€Œä¸”é¥­é‡ä¹Ÿå¾ˆå¤§ã€‚ä¸è¿‡7å·äººå“å¾ˆå¥½ï¼Œå¥¹å¾ˆå–„è‰¯ï¼Œå¥¹æ²¡åƒå‡ å£å°±ä¼šæƒ³ï¼šå¦‚æœç°åœ¨æœ‰åˆ«äººæ¯”æˆ‘æ›´éœ€è¦åƒè›‹ç³•ï¼Œé‚£ä¹ˆæˆ‘å°±è®©ä»–ã€‚å› æ­¤ï¼Œå¥¹å¯ä»¥æ¯åƒå‡ å£å°±è·Ÿæ“ä½œç³»ç»Ÿè¯´ï¼šæˆ‘ä»¬æ¥é‡æ–°è®¡ç®—ä¸€ä¸‹æ‰€æœ‰äººçš„æ€»ä¼˜å…ˆçº§å§ã€‚ä¸è¿‡ï¼Œæ“ä½œç³»ç»Ÿä¸æ¥å—è¿™ä¸ªå»ºè®®ï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿä¸æä¾›è¿™ä¸ªæ¥å£ã€‚äºæ˜¯7å·å°±æ¢äº†ä¸ªè¯´æ³•ï¼šâ€œå†æœªæ¥0æ¯«ç§’ä¹‹å†…ä¸è¦å†å«æˆ‘ä¸Šæ¥åƒè›‹ç³•äº†â€ã€‚è¿™ä¸ªæŒ‡ä»¤æ—¶æ“ä½œç³»ç»Ÿæ¥å—çš„ï¼Œäºæ˜¯æ­¤æ—¶æ“ä½œç³»ç»Ÿå°±ä¼šé‡æ–°è®¡ç®—å¤§å®¶çš„æ€»ä¼˜å…ˆçº§ï¼Œæ³¨æ„è¿™ä¸ªæ—¶å€™æ˜¯è¿7å·ä¸€èµ·è®¡ç®—çš„ï¼Œå› ä¸ºâ€œ0æ¯«ç§’å·²ç»è¿‡å»äº†â€å˜›ã€‚å› æ­¤å¦‚æœæ²¡æœ‰æ¯”7å·æ›´éœ€è¦åƒè›‹ç³•çš„äººå‡ºç°ï¼Œé‚£ä¹ˆä¸‹ä¸€æ¬¡7å·è¿˜æ˜¯ä¼šè¢«å«ä¸Šæ¥åƒè›‹ç³•ã€‚å› æ­¤ï¼ŒThread.Sleep(0)çš„ä½œç”¨ï¼Œå°±æ˜¯â€œè§¦å‘æ“ä½œç³»ç»Ÿç«‹åˆ»é‡æ–°è¿›è¡Œä¸€æ¬¡CPUç«äº‰â€ã€‚ç«äº‰çš„ç»“æœä¹Ÿè®¸æ˜¯å½“å‰çº¿ç¨‹ä»ç„¶è·å¾—CPUæ§åˆ¶æƒï¼Œä¹Ÿè®¸ä¼šæ¢æˆåˆ«çš„çº¿ç¨‹è·å¾—CPUæ§åˆ¶æƒã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬å†å¤§å¾ªç¯é‡Œé¢ç»å¸¸ä¼šå†™ä¸€å¥Thread.Sleep(0)ï¼Œå› ä¸ºè¿™æ ·å°±ç»™äº†å…¶ä»–çº¿ç¨‹æ¯”å¦‚Paintçº¿ç¨‹è·å¾—CPUæ§åˆ¶çš„æƒåŠ›ï¼Œè¿™æ ·ç•Œé¢å°±ä¼šä¸ä¼šå‡æ­»å†é‚£é‡Œã€‚å¦å¤–ï¼Œè™½ç„¶ä¸Šé¢æåˆ°è¯´â€œé™¤éå®ƒè‡ªå·±æ”¾å¼ƒä½¿ç”¨CPUï¼Œå¦åˆ™å°†å®Œå…¨éœ¸å CPUâ€ä½†è¿™ä¸ªè¡Œä¸ºä»ç„¶æ˜¯æ”¶åˆ°åˆ¶çº¦çš„ï¼Œæ“ä½œç³»ç»Ÿä¼šç›‘æ§ä½ éœ¸å CPUçš„æƒ…å†µï¼Œå¦‚æœå‘ç°æŸä¸ªçº¿ç¨‹é•¿æ—¶é—´éœ¸å CPUï¼Œä¼šå¼ºåˆ¶ä½¿ç”¨è¿™ä¸ªçº¿ç¨‹æŒ‚èµ·ã€‚å› æ­¤å®é™…ä¸Šä¸ä¼šå‡ºç°â€œä¸€ä¸ªçº¿ç¨‹ä¸€ç›´éœ¸å ç€CPUä¸æ”¾â€çš„æƒ…å†µã€‚å…¶å®å†WindwosåŸç†å±‚é¢ï¼ŒCPUç«äº‰éƒ½æ˜¯çº¿ç¨‹çº§çš„ï¼Œæœ¬æ–‡ä¸­æŠŠè¿™é‡Œçš„çº¿ç¨‹ã€è¿›ç¨‹çœ‹æˆä¸€ä¸ªä¸œè¥¿å°±å¯ä»¥äº†ã€‚]]></content>
      <categories>
        <category>CSharp</category>
      </categories>
      <tags>
        <tag>CSharp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[LoadFromFileAsyncå’ŒYieldçš„é—®é¢˜æ¢ç©¶]]></title>
    <url>%2F2019%2F05%2F10%2Floadfromfileasyncandyield%2F</url>
    <content type="text"><![CDATA[é—®é¢˜æå‡ºæ˜¨æ™šä¸´ä¸‹ç­çš„æ—¶å€™åœ¨åŒæ—¶è®¨è®ºåˆ°Unityçš„èµ„æºå¼‚æ­¥åŠ è½½æ¥å£æ˜¯å¦æ˜¯å¤šçº¿ç¨‹çš„æ—¶å€™ï¼Œç„¶åè‡ªå·±å‘äº†ä¸€ä»½æºè‡ªç½‘ä¸Šçš„æµ‹è¯•æ–‡æ¡£ï¼Œåœ°å€ï¼šhttps://github.com/zentia/UnityDemoç„¶åç¾¤é‡Œå¼€å§‹è®¨è®ºè¿™ä¸ªé—®é¢˜ï¼Œæ ¹æ®æ–‡æ¡£å‡ºç°ä¸¤ä¸ªåˆ†æ­§ LoadFormFileAsyncæ˜¯å¦æ˜¯å¤šçº¿ç¨‹å®ç°çš„ï¼Ÿ yield å³åç¨‹æ˜¯å¦æ˜¯å¤šçº¿ç¨‹å®ç°çš„ï¼Ÿ å¸¦ç€ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¼€å§‹åˆ†æå’ŒéªŒè¯ã€‚ éªŒè¯ä¸åˆ†æLoadFormFileAsyncæ˜¯å¦æ˜¯å¤šçº¿ç¨‹ï¼Ÿæµ‹è¯•ç¯å¢ƒï¼šUnity 2018.3æµ‹è¯•å¹³å°ï¼šWindows(ç”±äºæ²¡æœ‰Androidæ‰“åŒ…ç¯å¢ƒå’Œè®¾å¤‡ï¼Œæš‚æ—¶é€‰Windows)æµ‹è¯•å·¥ç¨‹ï¼šhttps://github.com/zentia/UnityDemoå¥½å§ï¼Œæ˜¯å›¾ç‰‡ä¸å…·æœ‰ä»£è¡¨æ€§å—ï¼Ÿé‚£æˆ‘ä»¬æ¢å¤§ç‚¹çš„å›¾ç‰‡ã€‚ ä»ç»“æœæ¥çœ‹ï¼Œæˆ‘è®¤ä¸ºLoadFromFileAsyncå†…éƒ¨æ˜¯å¤šçº¿ç¨‹å®ç°çš„ã€‚åç¨‹ä¸å…·å¤‡å¤šçº¿ç¨‹çš„åŠŸèƒ½ã€‚æˆ‘ä»¬æ¥åˆ†æåç¨‹ï¼Œä¸‹é¢æ˜¯4.7çš„æºç  Coroutine123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379#include "UnityPrefix.h"#include "Coroutine.h"#if ENABLE_SCRIPTING#include "Runtime/Misc/AsyncOperation.h"#include "Runtime/Mono/MonoBehaviour.h"#include "Runtime/Mono/MonoScript.h"#include "Runtime/Mono/MonoIncludes.h"#include "Runtime/Mono/MonoManager.h"#include "Runtime/GameCode/CallDelayed.h"#include "Runtime/Export/WWW.h"#include "Runtime/Scripting/ScriptingUtility.h"#include "Runtime/Scripting/Backend/ScriptingBackendApi.h"#include "Runtime/Scripting/ScriptingObjectWithIntPtrField.h"#if UNITY_IPHONE_API# include "Runtime/Input/OnScreenKeyboard.h"#endif#include "Runtime/Scripting/Backend/ScriptingBackendApi.h"// copied from MonoBehaviour.cpp// if they should be synced - blame the author not me ;-)#define DEBUG_COROUTINE 0#define DEBUG_COROUTINE_LEAK 0Coroutine::Coroutine() : m_DoneRunning(false)&#123; #if DEBUG_COROUTINE static int coroutineCounter = 0; coroutineCounter++; printf_console("Allocating coroutine %d --- %d : 0x%x\n", this, coroutineCounter, &amp;m_RefCount); #endif&#125;Coroutine::~Coroutine()&#123; Assert(m_CoroutineEnumeratorGCHandle == 0); #if DEBUG_COROUTINE printf_console("Deconstructor coroutine %d\n", this); #endif&#125;void Coroutine::SetMoveNextMethod(ScriptingMethodPtr method)&#123; m_MoveNext = method;&#125;void Coroutine::SetCurrentMethod(ScriptingMethodPtr method)&#123; m_Current = method;&#125;void Coroutine::ContinueCoroutine (Object* o, void* userData)&#123; Coroutine* coroutine = (Coroutine*)userData; Assert(coroutine-&gt;m_RefCount &gt; 0 &amp;&amp; coroutine-&gt;m_RefCount &lt; 1000000); if ((Object*)coroutine-&gt;m_Behaviour != o) &#123; ErrorString("Coroutine continue failure"); #if DEBUG_COROUTINE if ((Object*)coroutine-&gt;m_Behaviour != o) &#123; printf_console ("continue Coroutine fuckup %d refcount: %d behaviour: %d \n", coroutine, coroutine-&gt;m_RefCount, coroutine-&gt;m_Behaviour); printf_console ("continue Coroutine fuckup name: %s methodname\n", ((MonoBehaviour*)(o))-&gt;GetScript()-&gt;GetName()); if (coroutine-&gt;m_CoroutineMethod) printf_console ("continue Coroutine methodname: %s\n", scripting_method_get_name(coroutine-&gt;m_CoroutineMethod)); &#125; #endif return; &#125; coroutine-&gt;Run ();&#125;void Coroutine::CleanupCoroutine (void* userData)&#123; Coroutine* coroutine = (Coroutine*)userData; AssertIf(coroutine-&gt;m_RefCount &lt;= 0); AssertIf(coroutine-&gt;m_RefCount &gt; 1000000); coroutine-&gt;m_RefCount--; #if DEBUG_COROUTINE printf_console("decrease refcount %d - active: %d \n", coroutine, coroutine-&gt;m_RefCount); #endif if (coroutine-&gt;m_RefCount &gt; 0) return; coroutine-&gt;m_DoneRunning = true; #if DEBUG_COROUTINE printf_console ("CleanupCoroutine %d\n", coroutine); if (coroutine-&gt;m_Behaviour &amp;&amp; GetDelayedCallManager().HasDelayedCall(coroutine-&gt;m_Behaviour, Coroutine::ContinueCoroutine, CompareCoroutineMethodName, coroutine)) &#123; printf_console ("FUCKUP is still in delayed call manager%d!\n", coroutine-&gt;m_Behaviour); &#125; #endif if (coroutine-&gt;m_ContinueWhenFinished) &#123; CleanupCoroutine (coroutine-&gt;m_ContinueWhenFinished); coroutine-&gt;m_ContinueWhenFinished = NULL; &#125; if (coroutine-&gt;m_WaitingFor) coroutine-&gt;m_WaitingFor-&gt;m_ContinueWhenFinished = NULL; coroutine-&gt;RemoveFromList(); if (coroutine-&gt;m_AsyncOperation) &#123; coroutine-&gt;m_AsyncOperation-&gt;SetCoroutineCallback(NULL, NULL, NULL, NULL); coroutine-&gt;m_AsyncOperation-&gt;Release(); coroutine-&gt;m_AsyncOperation = NULL; &#125; Assert(coroutine-&gt;m_CoroutineEnumeratorGCHandle != 0); scripting_gchandle_free (coroutine-&gt;m_CoroutineEnumeratorGCHandle); coroutine-&gt;m_CoroutineEnumeratorGCHandle = 0; if (!coroutine-&gt;m_IsReferencedByMono) &#123; delete coroutine; #if DEBUG_COROUTINE_LEAK gCoroutineCounter--; #endif &#125;&#125;void Coroutine::CleanupCoroutineGC (void* userData)&#123; Coroutine* coroutine = (Coroutine*)userData; if (!coroutine-&gt;m_IsReferencedByMono) return; if (coroutine-&gt;m_RefCount != 0) &#123; coroutine-&gt;m_IsReferencedByMono = false; return; &#125; ErrorIf(coroutine-&gt;IsInList()); delete coroutine; #if DEBUG_COROUTINE printf_console ("GC free coroutine: %d\n", coroutine); #endif #if DEBUG_COROUTINE_LEAK gCoroutineCounter--; #endif&#125;bool Coroutine::CompareCoroutineMethodName (void* callBackUserData, void* cancelUserdata)&#123; Coroutine* coroutine = (Coroutine*)callBackUserData; if (!coroutine-&gt;m_CoroutineMethod) return false; return strcmp(scripting_method_get_name(coroutine-&gt;m_CoroutineMethod), (const char*)cancelUserdata) == 0;&#125;bool Coroutine::InvokeMoveNext(ScriptingExceptionPtr* exception)&#123; ScriptingInvocation invocation(m_MoveNext); invocation.object = m_CoroutineEnumerator; invocation.classContextForProfiler = m_Behaviour-&gt;GetClass(); invocation.objectInstanceIDContextForException = m_Behaviour-&gt;GetInstanceID(); bool result = invocation.Invoke&lt;bool&gt;(exception); return result &amp;&amp; *exception==NULL;&#125;void Coroutine::Run ()&#123; Assert(m_RefCount != 0); Assert(m_Behaviour != NULL); #if DEBUG_COROUTINE AssertIf(GetDelayedCallManager().HasDelayedCall(m_Behaviour, Coroutine::ContinueCoroutine, CompareCoroutineMethodName, this)); if (m_Behaviour == NULL) &#123; printf_console ("Coroutine fuckup %d refcount: %d behaviour%d\n", this, m_RefCount, m_Behaviour); &#125; #endif // - Call MoveNext (This processes the function until the next yield!) // - Call Current (This returns condition when to continue the coroutine next.) // -&gt; Queue it based on the continue condition // Temporarily increase refcount so the object will not get destroyed during the m_MoveNext call m_RefCount++; ScriptingExceptionPtr exception = NULL; bool keepLooping = InvokeMoveNext(&amp;exception); AssertIf(m_RefCount &lt;= 0 || m_RefCount &gt; 10000000); bool coroutineWasDestroyedDuringMoveNext = m_RefCount == 1; // Decrease temporary refcount so the object will not get destroyed during the m_MoveNext call CleanupCoroutine(this); // The coroutine has been destroyed in the mean time, probably due to a call to StopAllCoroutines, stop executing further if (coroutineWasDestroyedDuringMoveNext) &#123; Assert(m_ContinueWhenFinished == NULL); return; &#125; if (exception != NULL) return; // Are we done with this coroutine? if (!keepLooping) &#123; // If there is a coroutine waiting for this one to finish Run it! if (m_ContinueWhenFinished) &#123; AssertIf (this != m_ContinueWhenFinished-&gt;m_WaitingFor); Coroutine* continueWhenFinished = m_ContinueWhenFinished; m_ContinueWhenFinished-&gt;m_WaitingFor = NULL; m_ContinueWhenFinished = NULL; // The coroutine might have been stopped inside of the last coroutine invokation if (continueWhenFinished-&gt;m_Behaviour) continueWhenFinished-&gt;Run (); CleanupCoroutine (continueWhenFinished); &#125; return; &#125; if (m_Behaviour == NULL) return; ProcessCoroutineCurrent();&#125;void Coroutine::ProcessCoroutineCurrent()&#123; ScriptingExceptionPtr exception = NULL;#if !UNITY_FLASH ScriptingInvocation invocation(m_Current); invocation.object = m_CoroutineEnumerator; invocation.objectInstanceIDContextForException = m_Behaviour-&gt;GetInstanceID(); invocation.classContextForProfiler = m_Behaviour-&gt;GetClass(); ScriptingObjectPtr monoWait = invocation.Invoke(&amp;exception);#else ScriptingObjectPtr monoWait = Ext_Flash_getProperty(m_CoroutineEnumerator,"IEnumerator_Current"); #endif AssertIf(m_RefCount &lt;= 0 || m_RefCount &gt; 10000000); if (exception != NULL) return; if (monoWait == SCRIPTING_NULL) &#123; m_RefCount++; CallDelayed (ContinueCoroutine, m_Behaviour, 0.0F, this, 0.0F, CleanupCoroutine, DelayedCallManager::kRunDynamicFrameRate | DelayedCallManager::kWaitForNextFrame); return; &#125; HandleIEnumerableCurrentReturnValue(monoWait);&#125;void Coroutine::HandleIEnumerableCurrentReturnValue(ScriptingObjectPtr monoWait)&#123; AsyncOperation* async = NULL; ScriptingClassPtr waitClass = scripting_object_get_class (monoWait, GetScriptingTypeRegistry()); const CommonScriptingClasses&amp; classes = GetMonoManager ().GetCommonClasses (); // Continue the coroutine in 'wait' seconds if (scripting_class_is_subclass_of (waitClass, classes.waitForSeconds)) &#123; m_RefCount++; float wait; MarshallManagedStructIntoNative(monoWait,&amp;wait); CallDelayed (ContinueCoroutine, m_Behaviour, wait, this, 0.0F, CleanupCoroutine, DelayedCallManager::kRunDynamicFrameRate | DelayedCallManager::kWaitForNextFrame); return; &#125; // Continue the coroutine on the next fixed update if (scripting_class_is_subclass_of (waitClass, classes.waitForFixedUpdate)) &#123; m_RefCount++; CallDelayed (ContinueCoroutine, m_Behaviour, 0.0F, this, 0.0F, CleanupCoroutine, DelayedCallManager::kRunFixedFrameRate); return; &#125; // Continue the coroutine at the end of frame if (scripting_class_is_subclass_of (waitClass, classes.waitForEndOfFrame)) &#123; m_RefCount++; CallDelayed (ContinueCoroutine, m_Behaviour, 0.0F, this, 0.0F, CleanupCoroutine, DelayedCallManager::kEndOfFrame); return; &#125; // Continue after another coroutine is finished if (scripting_class_is_subclass_of (waitClass, classes.coroutine)) &#123; Coroutine* waitForCoroutine; MarshallManagedStructIntoNative(monoWait,&amp;waitForCoroutine); if (waitForCoroutine-&gt;m_DoneRunning) &#123; // continue executing. ContinueCoroutine(m_Behaviour, this); return; &#125; if (waitForCoroutine-&gt;m_ContinueWhenFinished != NULL) &#123; LogStringObject ("Another coroutine is already waiting for this coroutine!\nCurrently only one coroutine can wait for another coroutine!", m_Behaviour); return; &#125; m_RefCount++; waitForCoroutine-&gt;m_ContinueWhenFinished = this; m_WaitingFor = waitForCoroutine; return; &#125; #if ENABLE_WWW // Continue after fetching an www object is done if (classes.www &amp;&amp; scripting_class_is_subclass_of (waitClass, classes.www )) &#123; WWW* wwwptr; MarshallManagedStructIntoNative(monoWait,&amp;wwwptr); if(wwwptr != NULL) &#123; m_RefCount++; wwwptr-&gt;CallWhenDone (ContinueCoroutine, m_Behaviour, this, CleanupCoroutine); &#125; return; &#125;#endif // Continue after fetching an www object is done if ((scripting_class_is_subclass_of (waitClass, classes.asyncOperation)) &amp;&amp; (async = ScriptingObjectWithIntPtrField&lt;AsyncOperation&gt; (monoWait).GetPtr()) != NULL) &#123; m_RefCount++; if (async-&gt;IsDone()) &#123; CallDelayed (ContinueCoroutine, m_Behaviour, 0.0F, this, 0.0F, CleanupCoroutine, DelayedCallManager::kRunDynamicFrameRate | DelayedCallManager::kRunDynamicFrameRate | DelayedCallManager::kWaitForNextFrame); return; &#125; // Use AysncOperation ContinueCoroutine - default path if (async-&gt;HasCoroutineCallback ()) &#123; ////@TODO: Throw exception? ErrorString("This asynchronous operation is already being yielded from another coroutine. An asynchronous operation can only be yielded once."); CallDelayed (ContinueCoroutine, m_Behaviour, 0.0F, this, 0.0F, CleanupCoroutine, DelayedCallManager::kRunDynamicFrameRate | DelayedCallManager::kRunDynamicFrameRate | DelayedCallManager::kWaitForNextFrame); return; &#125; async-&gt;SetCoroutineCallback(ContinueCoroutine, m_Behaviour, this, CleanupCoroutine); m_AsyncOperation = async; m_AsyncOperation-&gt;Retain(); return; &#125; // Continue the coroutine on the next dynamic frame update m_RefCount++; CallDelayed (ContinueCoroutine, m_Behaviour, 0.0F, this, 0.0F, CleanupCoroutine, DelayedCallManager::kRunDynamicFrameRate | DelayedCallManager::kRunDynamicFrameRate | DelayedCallManager::kWaitForNextFrame); //Ext_MarshalMap_Release_ScriptingObject(monoWait);//RH TODO : RELEASE THE MONOWAIT OBJECTS SOMEWHERE&#125;#endif MonoBehaviour.cpp1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556Coroutine* MonoBehaviour::CreateCoroutine(ScriptingObjectPtr userCoroutine, ScriptingMethodPtr method)&#123; ScriptingMethodPtr moveNext = scripting_object_get_virtual_method(userCoroutine, MONO_COMMON.IEnumerator_MoveNext, GetScriptingMethodRegistry());#if !UNITY_FLASH ScriptingMethodPtr current = scripting_object_get_virtual_method(userCoroutine, MONO_COMMON.IEnumerator_Current, GetScriptingMethodRegistry());#else //todo: make flash use generic path. set a bogus value for flash here right now so it passes current != NULL check, flash path will never use this value for now. ScriptingMethodPtr current = (ScriptingMethodPtr)1;#endif if (current == SCRIPTING_NULL || moveNext == SCRIPTING_NULL) &#123; std::string message = (method != SCRIPTING_NULL) ? Format ("Coroutine '%s' couldn't be started!", scripting_method_get_name(method)) : "Coroutine couldn't be started!"; LogStringObject (message, this); return NULL; &#125; Coroutine* coroutine = new Coroutine (); coroutine-&gt;m_CoroutineEnumeratorGCHandle = scripting_gchandle_new (userCoroutine); coroutine-&gt;m_CoroutineEnumerator = userCoroutine; coroutine-&gt;m_CoroutineMethod = method; coroutine-&gt;SetMoveNextMethod(moveNext); coroutine-&gt;SetCurrentMethod(current); coroutine-&gt;m_Behaviour = this; coroutine-&gt;m_ContinueWhenFinished = NULL; coroutine-&gt;m_WaitingFor = NULL; coroutine-&gt;m_AsyncOperation = NULL; coroutine-&gt;m_RefCount = 1; coroutine-&gt;m_IsReferencedByMono = 0; #if DEBUG_COROUTINE printf_console ("Allocate coroutine %d\n", coroutine); AssertIf(GetDelayedCallManager().HasDelayedCall(coroutine-&gt;m_Behaviour, Coroutine::ContinueCoroutine, CompareCoroutine, coroutine)); #endif #if DEBUG_COROUTINE_LEAK printf_console ("Active coroutines %d\n", gCoroutineCounter); gCoroutineCounter++; #endif m_ActiveCoroutines.push_back (*coroutine); AssertIf(&amp;m_ActiveCoroutines.back() != coroutine); m_ActiveCoroutines.back ().Run (); AssertIf(coroutine-&gt;m_RefCount == 0); if (coroutine-&gt;m_RefCount &lt;= 1) &#123; Coroutine::CleanupCoroutine(coroutine); return NULL; &#125; Coroutine::CleanupCoroutine(coroutine); return coroutine; &#125; å¥½äº†ï¼Œå…¥å£æˆ‘ä»¬æ‰¾åˆ°äº†ï¼Œé‚£ä¹ˆå®ƒæ˜¯è¿è¡Œçš„å‘¢ï¼Ÿæˆ‘ä»¬è·Ÿè¸ªrunçš„æ—¶å€™ä¼šå‘ç°æœ‰ä¸€ä¸ªCallDelayeå‡½æ•°ï¼Œè€Œè¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªå®šæ—¶å™¨å‡½æ•°ï¼Œå†…éƒ¨æœ€ç»ˆåœ¨Updateä¸Šæ‰§è¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç›®æ ‡è½¬è€Œå®ƒçš„Updateåœ¨å“ªé‡Œæ‰§è¡Œçš„å‘¢ï¼Ÿæˆ‘ä»¬ç»§ç»­çœ‹ã€‚æˆ‘ä»¬å‘ç°å®ƒæœ€ç»ˆæ˜¯åœ¨åœºæ™¯çš„ä¸­Tickæ‰§è¡Œçš„ï¼Œä½†æ˜¯æˆ‘ç›®å‰å¹¶æœªå‘ç°Tickæ˜¯å¤šçº¿ç¨‹æ‰§è¡Œçš„ï¼Œè€Œä¸”åœ¨ä¸ªäººçš„ç†è§£ä¸­ï¼ŒTickä¹Ÿä¸å¤ªä¼šæˆ–è€…ä¸æ•¢ç”¨å¤šçº¿ç¨‹ã€‚ ç»“è®ºé€šè¿‡Unity2018ä¸Šæµ‹è¯•å‘ç°LoadFromFileAsyncæ˜¯ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œåç¨‹åœ¨ä¸»çº¿ç¨‹ä¸Šè·‘ï¼Œè¿™çœ‹ä¸Šå»ç¬¦åˆæˆ‘ä»¬çš„å®éªŒç»“æœã€‚è€Œä»Unity4.7æºç å‘ç°åç¨‹æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­è¿è¡Œã€‚]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è¾¹ç¼˜æ£€æµ‹]]></title>
    <url>%2F2019%2F05%2F09%2Fedgedetection%2F</url>
    <content type="text"><![CDATA[è¾¹ç¼˜æ£€æµ‹æ˜¯æè¾¹æ•ˆæœçš„ä¸€ç§å®ç°æ–¹æ³•ï¼Œåœ¨æœ¬èŠ‚ç»“æŸåï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ç±»ä¼¼ä¸‹å›¾ä¸­çš„æ•ˆæœã€‚è¾¹ç¼˜æ£€æµ‹çš„åŸç†æ˜¯åˆ©ç”¨ä¸€äº›è¾¹ç¼˜æ£€æµ‹ç®—å­å¯¹å›¾åƒè¿›è¡Œå·ç§¯ï¼ˆconvolutionï¼‰æ“ä½œï¼Œæˆ‘ä»¬é¦–å…ˆæ¥äº†è§£ä»€ä¹ˆæ˜¯å·ç§¯ã€‚ ä»€ä¹ˆæ˜¯å·ç§¯åœ¨å›¾åƒå¤„ç†ä¸­ï¼Œå·ç§¯æ“ä½œæŒ‡çš„å°±æ˜¯ä½¿ç”¨ä¸€ä¸ªå·ç§¯æ ¸ï¼ˆkernelï¼‰å¯¹ä¸€å¼ å›¾åƒä¸­çš„æ¯ä¸ªåƒç´ è¿›è¡Œä¸€ç³»åˆ—æ“ä½œã€‚å·ç§¯æ ¸é€šå¸¸æ˜¯ä¸€ä¸ªå››æ–¹å½¢ç½‘æ ¼ç»“æœï¼ˆä¾‹å¦‚2x2ã€3x3çš„æ–¹å½¢åŒºåŸŸï¼‰ï¼Œè¯¥åŒºåŸŸå†…æ¯ä¸ªæ–¹æ ¼éƒ½æœ‰ä¸€ä¸ªæƒé‡å€¼ã€‚å½“å¯¹å›¾åƒä¸­çš„æŸä¸ªåƒç´ è¿›è¡Œå·ç§¯æ—¶ï¼Œæˆ‘ä»¬ä¼šæŠŠå·ç§¯æ ¸çš„ä¸­å¿ƒæ”¾ç½®äºè¯¥åƒç´ ä¸Šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç¿»è½¬æ ¸ä¹‹åå†ä¾æ¬¡è®¡ç®—æ ¸ä¸­æ¯ä¸ªå…ƒç´ å’Œå…¶è¦†ç›–çš„å›¾åƒåƒç´ å€¼çš„ä¹˜ç§¯å¹¶æ±‚å’Œï¼Œå¾—åˆ°çš„ç»“æ„å°±æ˜¯è¯¥ä½ç½®çš„æ–°åƒç´ å€¼ã€‚å·ç§¯æ ¸å’Œå·ç§¯ã€‚ä½¿ç”¨ä¸€ä¸ª3x3å¤§å°çš„å·ç§¯æ ¸å¯¹ä¸€å¼ 5x5å¤§å°çš„å›¾åƒè¿›è¡Œå·ç§¯æ“ä½œï¼Œå½“è®¡ç®—å›¾ä¸­çº¢è‰²æ–¹æ³•å¯¹åº”çš„åƒç´ çš„å·ç§¯ç»“æœæ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆæŠŠå·ç§¯æ ¸çš„ä¸­å¿ƒæ”¾ç½®åœ¨è¯¥åƒç´ ä½ç½®ï¼Œç¿»è½¬æ ¸ä¹‹ååœ¨ä¾æ¬¡è®¡ç®—æ ¸ä¸­æ¯ä¸ªå…ƒç´ å’Œå…¶è¦†ç›–çš„å›¾åƒåƒç´ å€¼çš„ä¹˜ç§¯å¹¶æ±‚å’Œï¼Œå¾—åˆ°æ–°çš„åƒç´ å€¼ã€‚è¿™æ ·çš„è®¡ç®—è¿‡ç¨‹è™½ç„¶ç®€å•ï¼Œä½†å¯ä»¥å®ç°å¾ˆå¤šå¸¸è§çš„å›¾åƒå¤„ç†æ•ˆæœï¼Œä¾‹å¦‚å›¾åƒæ¨¡ç³Šã€è¾¹ç¼˜æ£€æµ‹ç­‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦å¯¹å›¾åƒè¿›è¡Œå‡å€¼æ¨¡ç³Šï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ª3x3çš„å·ç§¯æ ¸ï¼Œæ ¸å†…æ¯ä¸ªå…ƒç´ çš„å€¼å‡ä¸º1/9ã€‚ å¸¸è§çš„è¾¹ç¼˜æ£€æµ‹ç®—å­å·ç§¯æ“ä½œçš„ç¥å¥‡ä¹‹å¤„åœ¨äºé€‰æ‹©çš„å·ç§¯æ ¸ã€‚é‚£ä¹ˆï¼Œç”¨äºè¾¹ç¼˜æ£€æµ‹çš„å·ç§¯æ ¸ï¼ˆä¹Ÿè¢«ç§°ä¸ºè¾¹ç¼˜æ£€æµ‹ç®—å­ï¼‰åº”è¯¥é•¿ä»€ä¹ˆæ ·å­å‘¢ï¼Ÿåœ¨å›ç­”è¿™ä¸ªé—®é¢˜å‰ï¼Œæˆ‘ä»¬å¯ä»¥é¦–å…ˆå›æƒ³ä¸€ä¸‹è¾¹åˆ°åº•æ˜¯å¦‚ä½•å½¢æˆçš„ã€‚å¦‚æœç›¸é‚»åƒç´ ä¹‹é—´å­˜åœ¨å·®åˆ«æ˜æ˜¾çš„é¢œè‰²ã€äº®åº¦ã€çº¹ç†ç­‰å±æ€§ï¼Œæˆ‘ä»¬å°±ä¼šè®¤ä¸ºå®ƒä»¬ä¹‹é—´åº”è¯¥æœ‰ä¸€æ¡è¾¹ç•Œã€‚è¿™ç§ç›¸é‚»åƒç´ ä¹‹é—´çš„æ’å€¼å¯ä»¥ç”¨æ¢¯åº¦ï¼ˆgradientï¼‰æ¥è¡¨ç¤ºï¼Œå¯ä»¥æƒ³è±¡å¾—åˆ°ï¼Œè¾¹ç¼˜å¤„çš„æ¢¯åº¦ç»å¯¹å€¼ä¼šæ¯”è¾ƒå¤§ã€‚åŸºäºè¿™æ ·çš„ç†è§£ï¼Œæœ‰å‡ ç§ä¸åŒçš„è¾¹ç¼˜æ£€æµ‹ç®—å­è¢«å…ˆåæå‡ºæ¥ã€‚3ä¸­å¸¸è§çš„è¾¹ç¼˜æ£€æµ‹ç®—å­å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå®ƒä»¬éƒ½åŒ…å«äº†ä¸¤ä¸ªæ–¹å‘çš„å·ç§¯æ ¸ï¼Œåˆ†åˆ«ç”¨äºæ£€æµ‹æ°´å¹³æ–¹å‘å’Œç«–ç›´æ–¹å‘ä¸Šçš„è¾¹ç¼˜ä¿¡æ¯ã€‚åœ¨è¿›è¡Œè¾¹ç¼˜æ£€æµ‹æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªåƒç´ åˆ†åˆ«è¿›è¡Œä¸€æ¬¡å·ç§¯è®¡ç®—ï¼Œå¾—åˆ°è¿™ä¸¤ä¸ªæ–¹å‘ä¸Šçš„æ¢¯åº¦å€¼$G_x$å’Œ$G_y$ï¼Œè€Œæ•´ä½“çš„æ¢¯åº¦å¯æŒ‰ä¸‹é¢çš„å…¬å¼è®¡ç®—è€Œå¾—ï¼š$G={G_x}^2+{G_y}^2$]]></content>
      <categories>
        <category>Unity Shader</category>
      </categories>
      <tags>
        <tag>Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Interlocked]]></title>
    <url>%2F2019%2F05%2F09%2Finterlocked%2F</url>
    <content type="text"><![CDATA[Interlockedå¯ä»¥ä¸ºå¤šä¸ªçº¿ç¨‹å…±äº«çš„å˜é‡æä¾›åŸå­æ“ä½œã€‚ Interlocked.Increment ä»¥åŸå­æ“ä½œçš„å½¢å¼é€’å¢æŒ‡å®šå˜é‡çš„å€¼å¹¶å­˜å‚¨ç»“æœã€‚ Interlocked.Decrement ä»¥åŸå­æ“ä½œçš„å½¢å¼é€’å‡åˆ¶å®šå˜é‡çš„å€¼å¹¶å­˜å‚¨ç»“æœã€‚ Interlocked.Add(ref int src, int val) ä»¥åŸå­æ“ä½œçš„å½¢å¼ï¼Œæ·»åŠ ä¸¤ä¸ªæ•´æ•°å¹¶ç”¨ä¸¤è€…çš„å’Œæ›¿æ¢ç¬¬ä¸€ä¸ªæ•´æ•°ã€‚ Interlocked.CompareExhange(ref target, desiredVal, startVal); å°†targetçš„å€¼å’ŒstartValæ¯”è¾ƒï¼Œç›¸ç­‰åˆ™ç”¨desiredValæ›¿æ¢targetï¼Œå¦åˆ™ä¸æ“ä½œã€‚]]></content>
      <categories>
        <category>CSharp</category>
      </categories>
      <tags>
        <tag>CSharp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AutoResetEvent]]></title>
    <url>%2F2019%2F05%2F09%2Fautoresetevent%2F</url>
    <content type="text"><![CDATA[ManualResetEventå’ŒAutoResetEventä¸»è¦è´Ÿè´£å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„çº¿ç¨‹åŒæ­¥ï¼›é‚£åœ¨è®²è¿™ä¸ªä¹‹å‰æˆ‘ä»¬å…ˆè¯´è¯´çº¿ç¨‹åŒæ­¥ï¼š çº¿ç¨‹åŒæ­¥å…±äº«æ•°æ®é¦–å…ˆï¼Œæ­»è®°ä½ï¼Œåœ¨C#ä¸­è¢«æ ‡è®°staticçš„å˜é‡å°±æ˜¯å…±äº«æ•°æ®ï¼Œç„¶ååœ¨æ¢è®¨ä¸ºä»€ä¹ˆé™æ€å˜é‡æ˜¯å…±äº«æ•°æ®å‘¢ï¼Ÿé¦–å…ˆé™æ€å˜é‡çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä»ç¨‹åºå¼€å§‹åˆ°ç¨‹åºç»“æŸã€‚ä½†æ˜¯staticå˜é‡çš„ä½œç”¨å¹¶ä¸ç­‰åŒäºå®ƒçš„ç”Ÿå‘½å‘¨æœŸï¼Œå®ƒçš„ä½œç”¨åŸŸå†³å®šäºå®ƒè¢«å®šä¹‰çš„ä½ç½®ã€‚å¯ä»¥è®¤ä¸ºstaticå˜é‡çš„ä½œç”¨åŸŸ&lt;=ç”Ÿå­˜å‘¨æœŸã€‚staticçš„æ•°æ®æ˜¯å­˜å‚¨åœ¨é™æ€å­˜å‚¨åŒºçš„ï¼Œè¿™å—æ•°æ®ä¸åŒçº¿ç¨‹ä¹‹é—´æ˜¯å¯ä»¥å…±äº«çš„ã€‚ çº¿ç¨‹åŒæ­¥çš„ç›®çš„å¾ˆç®€å•ï¼Œä¸ºäº†é˜²æ­¢å…±äº«æ•°æ®è¢«ç ´åï¼Œé‚£ä¹ˆå…±äº«æ•°æ®æ˜¯å¦‚ä½•è¢«ç ´åçš„å‘¢ï¼ŸåŒæ—¶è¿›è¡Œå†™æ“ä½œçš„æ—¶å€™ä¼šå‘ç”Ÿå…±äº«æ•°æ®è¢«ç ´åã€‚ AutoResetEventå…è®¸çº¿ç¨‹é€šè¿‡ä¿¡å·äº’ç›¸é€šä¿¡ï¼Œé€šå¸¸ï¼Œæ­¤é€šä¿¡æ¶‰åŠçº¿ç¨‹éœ€è¦ç‹¬å è®¿é—®çš„èµ„æºã€‚ AutoResetEventä¸ManualResetEvnetçš„åŒºåˆ«ä»–ä»¬çš„ç”¨æ³•å£°æ˜éƒ½å¾ˆç±»ä¼¼ï¼ŒSetæ–¹æ³•å°†ä¿¡å·ç½®ä¸ºå‘é€çŠ¶æ€ï¼ŒResetæ–¹æ³•å°†ä¿¡å·è®¾ç½®ä¸ºä¸å‘é€çŠ¶æ€ï¼ŒWaitOneç­‰å¾…ä¿¡å·çš„å‘é€ã€‚å…¶å®ï¼Œä»åå­—å°±å¯ä»¥çœ‹å‡ºä¸€ä¸ªæ‰‹åŠ¨ï¼Œä¸€ä¸ªè‡ªåŠ¨ï¼Œè¿™ä¸ªæ‰‹åŠ¨å’Œè‡ªåŠ¨å®é™…æŒ‡çš„æ˜¯åœ¨Resetæ–¹æ³•çš„å¤„ç†ä¸Šï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­ï¼š12public AutoResetEvent autoEvent = new AutoResetEvent(true);public ManualResetEvent manualEvent = new ManualResetEvent(true); é»˜è®¤ä¿¡å·éƒ½å¤„äºå‘é€çŠ¶æ€autoEvent.WaitOne();manualEvent.WaitOne();å¦‚æœæŸä¸ªçº¿ç¨‹è°ƒç”¨ä¸Šé¢æ–¹æ³•ï¼Œåˆ™å½“ä¿¡å·å¤„äºå‘é€çŠ¶æ€æ—¶ï¼Œè¯¥çº¿ç¨‹ä¼šå¾—åˆ°ä¿¡å·ï¼Œå¾—ä»¥ç»§ç»­æ‰§è¡Œã€‚å·®åˆ«å°±åœ¨è°ƒç”¨åï¼ŒautoEvent.WaitOne()æ¯æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ï¼Œå½“æŸä¸ªçº¿ç¨‹å¾—åˆ°ä¿¡å·ï¼ˆä¹Ÿå°±æ˜¯è¯´æœ‰å…¶ä»–çº¿ç¨‹è°ƒç”¨äº†autoEvnet.Set()æ–¹æ³•åï¼‰ï¼ŒautoEventä¼šè‡ªåŠ¨åˆå°†ä¿¡å·è®¾ç½®ä¸ºä¸å‘é€çŠ¶æ€ï¼Œåˆ™å…¶ä»–è°ƒç”¨WaitOneçš„çº¿ç¨‹åªæœ‰ç»§ç»­ç­‰å¾…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒautoEventä¸€æ¬¡åªå”¤é†’ä¸€ä¸ªçº¿ç¨‹ã€‚è€ŒmanualEventåˆ™å¯ä»¥å”¤é†’å¤šä¸ªçº¿ç¨‹ï¼Œå› ä¸ºå½“æŸä¸ªçº¿ç¨‹è°ƒç”¨äº†setæ–¹æ³•åï¼Œå…¶ä»–è°ƒç”¨waitoneçš„çº¿ç¨‹è·å¾—ä¿¡å·å¾—ä»¥ç»§ç»­æ‰§è¡Œï¼Œè€Œmanualeventä¸ä¼šè‡ªåŠ¨å°†ä¿¡å·ç½®ä¸ºä¸å‘é€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤éæ‰‹åŠ¨è°ƒç”¨äº†manualEvent.Reset()æ–¹æ³•ï¼Œå¦åˆ™manualEventå°†ä¸€ç›´ä¿æŒæœ‰ä¿¡å·çŠ¶æ€ï¼ŒmanualEventä¹Ÿå°±å¯ä»¥åŒæ—¶å”¤é†’å¤šä¸ªçº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚å¦‚æœä¸Šé¢çš„ç¨‹åºæ¢æˆManualResetEventçš„è¯ï¼Œå°±éœ€è¦åœ¨waitoneåé¢åšä¸‹resetã€‚]]></content>
      <categories>
        <category>CSharp</category>
      </categories>
      <tags>
        <tag>CSharp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ManualResetEvent]]></title>
    <url>%2F2019%2F05%2F09%2Fmanualresetevent%2F</url>
    <content type="text"><![CDATA[ManualResetEventç”¨äºçº¿ç¨‹é—´é€šä¿¡ï¼Œå®ç°ä¸€ç§ç±»ä¼¼ä¿¡å·é‡çš„åŠŸèƒ½ã€‚1public ManualResetEvent(bool initalState); initStateä¸ºtrueè¡¨ç¤ºæœ‰ä¿¡å·ï¼Œä¸ºfalseè¡¨ç¤ºæ— ä¿¡å·WaitOneèµ·åˆ°çº¿ç¨‹é˜»å¡çš„ä½œç”¨Setå°†ManualResetEventå¯¹è±¡çš„ä¿¡å·è®¾ä¸ºæœ‰ä¿¡å·çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™WaitOneå¦‚æœæ­£åœ¨é˜»å¡ä¸­çš„è¯ï¼Œå°†ä¼šç«‹å³ç»ˆæ­¢é˜»å¡ï¼Œå‘ä¸‹ç»§ç»­æ‰§è¡Œã€‚è€Œä¸”è¿™ä¸ªçŠ¶æ€ä¸€ç›´ä¸å˜çš„è¯ï¼Œæ¯æ¬¡æ‰§è¡Œåˆ°WaitOneéƒ½å°†äº”ä»»ä½•é˜»å¡ã€‚Resetå°†ManualResetEventå¯¹è±¡çš„ä¿¡å·è®¾ç½®ä¸ºæ— ä¿¡å·çŠ¶æ€ï¼Œå½“ä¸‹æ¬¡æ‰§è¡Œåˆ°WaitOneæ—¶ï¼Œåˆå°†é‡æ–°å¼€å§‹é˜»å¡ã€‚]]></content>
      <categories>
        <category>CSharp</category>
      </categories>
      <tags>
        <tag>CSharp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[äº†è§£.NETä¸­çš„GC(è¯‘æ–‡)]]></title>
    <url>%2F2019%2F05%2F09%2Funderstanding-garbage-colllection%2F</url>
    <content type="text"><![CDATA[åŸæ–‡é“¾æ¥: https://www.red-gate.com/simple-talk/dotnet/.net-framework/understanding-garbage-collection-in-.net/ ä¸€æ—¦ä½ ç†è§£äº†.NETçš„åƒåœ¾æ”¶é›†å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œé‚£ä¹ˆä¸€äº›å¤æ‚çš„.NETåº”ç”¨ç¨‹åºé—®é¢˜çš„åŸå› å°±ä¼šå˜å¾—æ›´åŠ æ¸…æ™°ã€‚.NETå·²æ‰¿è¯ºç»“æŸæ˜¾å¼å†…å­˜ç®¡ç†ï¼Œä½†å¦‚æœæ‚¨å¸Œæœ›é¿å…ä¸å†…å­˜ç›¸å…³çš„é”™è¯¯å’Œä¸€äº›æ€§èƒ½é—®é¢˜ï¼Œåˆ™åœ¨å¼€å‘.NETåº”ç”¨ç¨‹åºæ—¶ä»éœ€è¦åˆ†æå†…å­˜çš„ä½¿ç”¨æƒ…å†µã€‚ åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œ.NETçš„åƒåœ¾æ”¶é›†å™¨è¢«è®¤ä¸ºæ˜¯æ˜¾å¼å†…å­˜ç®¡ç†å’Œå†…å­˜æ³„æ¼çš„ç»“æŸï¼Œåœ¨åå°è¿è¡Œåƒåœ¾æ”¶é›†å™¨æ—¶ï¼Œå¼€å‘äººå‘˜ä¸å†éœ€è¦æ‹…å¿ƒéœ€è¦ç®¡ç†ä»–ä»¬åˆ›å»ºçš„å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸€æ—¦åº”ç”¨ç¨‹åºå®Œæˆå®ƒä»¬ï¼Œåƒåœ¾æ”¶é›†å™¨å°†å¤„ç†å®ƒä»¬ã€‚ ç„¶è€Œï¼Œç°å®æ¯”è¿™æ›´å¤æ‚ã€‚åƒåœ¾æ”¶é›†å™¨è§£å†³äº†éæ‰˜ç®¡ç¨‹åºä¸­æœ€å¸¸è§çš„æ³„æ¼ï¼Œé‚£äº›ç”±å¼€å‘äººå‘˜åœ¨å®Œæˆåå¿˜è®°é‡Šæ”¾å†…å­˜è€Œå¯¼è‡´çš„æ³„æ¼ã€‚å®ƒè¿˜è§£å†³äº†è¿‡æ—©é‡Šæ”¾å†…å­˜çš„ç›¸å…³é—®é¢˜ï¼Œä½†æ˜¯å½“åƒåœ¾æ”¶é›†å™¨å¯¹å¼€å‘äººå‘˜å…³äºå¯¹è±¡æ˜¯å¦ä»ç„¶â€œliveâ€å¹¶ä¸”èƒ½å¤Ÿå…·æœ‰ä¸åŒæ„è§æ—¶ï¼Œè§£å†³æ­¤é—®é¢˜çš„æ–¹å¼ä¼šå¯¼è‡´å†…å­˜æ³„æ¼è¦ä½¿ç”¨çš„ã€‚åœ¨è§£å†³è¿™äº›é—®é¢˜ä¹‹å‰ï¼Œæ‚¨éœ€è¦äº†è§£æ”¶é›†å™¨çš„å·¥ä½œåŸç†ã€‚ GCçš„å·¥ä½œåŸç†é‚£ä¹ˆï¼Œåƒåœ¾æ”¶é›†å™¨å¦‚ä½•å®ç°å‘¢ï¼ŸåŸºæœ¬æ€æƒ³éå¸¸ç®€å•ï¼šå®ƒæ£€æŸ¥å¯¹è±¡å¦‚ä½•åœ¨å†…å­˜ä¸­å¸ƒå±€ï¼Œå¹¶é€šè¿‡éµå¾ªä¸€ç³»åˆ—å¼•ç”¨æ¥è¯†åˆ«æ­£åœ¨è¿è¡Œçš„ç¨‹åºå¯ä»¥å¼•ç”¨çš„æ‰€æœ‰å¯¹è±¡ã€‚ å½“GCå¼€å§‹æ—¶ï¼Œå®ƒä¼šæŸ¥çœ‹ä¸€ç»„ç§°ä¸ºâ€œGC Rootsâ€çš„å¼•ç”¨ã€‚è¿™äº›å†…å­˜ä½ç½®ç”±äºæŸç§åŸå› è¢«æŒ‡å®šä¸ºå§‹ç»ˆå¯è®¿é—®ï¼Œå¹¶ä¸”åŒ…å«å¯¹ç¨‹åºåˆ›å»ºçš„å¯¹è±¡çš„å¼•ç”¨ã€‚å®ƒå°†è¿™äº›å¯¹è±¡æ ‡è®°ä¸ºâ€œliveâ€ï¼Œç„¶åæŸ¥çœ‹å®ƒä»¬å¼•ç”¨çš„ä»»ä½•å¯¹è±¡; å®ƒæ ‡å¿—ç€è¿™äº›ä¹Ÿæ˜¯â€œliveâ€ã€‚å®ƒä»¥è¿™ç§æ–¹å¼ç»§ç»­ï¼Œéå†å®ƒæ‰€çŸ¥é“çš„æ‰€æœ‰â€œliveâ€å¯¹è±¡ã€‚å®ƒæ ‡è®°å®ƒä»¬å¼•ç”¨çš„ä»»ä½•å†…å®¹ï¼Œç›´åˆ°å®ƒæ‰¾ä¸åˆ°å…¶ä»–å¯¹è±¡ä¸ºæ­¢ã€‚ GCå°†å¯¹è±¡æ ‡è¯†ä¸ºå¼•ç”¨å¦ä¸€ä¸ªå¯¹è±¡ï¼ˆå¦‚æœå®ƒæˆ–å…¶ä¸­ä¸€ä¸ªè¶…ç±»å…·æœ‰åŒ…å«å¦ä¸€ä¸ªå¯¹è±¡çš„å­—æ®µï¼‰ã€‚ ä¸€æ—¦çŸ¥é“äº†æ‰€æœ‰è¿™äº›æ´»åŠ¨å¯¹è±¡ï¼Œå°±å¯ä»¥ä¸¢å¼ƒä»»ä½•å‰©ä½™çš„å¯¹è±¡ï¼Œå¹¶å°†ç©ºé—´é‡æ–°ç”¨äºæ–°å¯¹è±¡ã€‚.NETå‹ç¼©å†…å­˜ä½¿å¾—æ²¡æœ‰å†—ä½™ï¼ˆæœ‰æ•ˆåœ°å‹ç¼©ä¸¢å¼ƒçš„å¯¹è±¡ï¼‰ - è¿™æ„å‘³ç€ç©ºé—²å†…å­˜æ€»æ˜¯ä½äºå †çš„æœ«å°¾å¹¶ä¸”éå¸¸å¿«é€Ÿåœ°åˆ†é…æ–°å¯¹è±¡ã€‚ GC roots æœ¬èº«ä¸æ˜¯å¯¹è±¡ï¼Œè€Œæ˜¯å¯¹è±¡çš„å¼•ç”¨ã€‚GC roots å¼•ç”¨çš„ä»»ä½•å¯¹è±¡å°†è‡ªåŠ¨åœ¨ä¸‹ä¸€ä¸ªåƒåœ¾å›æ”¶ä¸­å­˜æ´»ã€‚.NETä¸­æœ‰å››ç§ä¸»è¦çš„rootç”¨æˆ·ï¼š å½“å‰æ­£åœ¨è¿è¡Œçš„æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡è¢«è§†ä¸ºGC rootã€‚è¿™äº›å˜é‡å¼•ç”¨çš„å¯¹è±¡å§‹ç»ˆå¯ä»¥é€šè¿‡å£°æ˜å®ƒä»¬çš„æ–¹æ³•ç«‹å³è®¿é—®ï¼Œå› æ­¤å¿…é¡»ä¿ç•™å®ƒä»¬ã€‚è¿™äº›rootçš„ç”Ÿå‘½å‘¨æœŸå¯èƒ½å–å†³äºç¨‹åºçš„æ„å»ºæ–¹å¼ã€‚åœ¨è°ƒè¯•ç‰ˆæœ¬ä¸­ï¼Œåªè¦æ–¹æ³•åœ¨å †æ ˆä¸Šï¼Œå±€éƒ¨å˜é‡å°±ä¼šæŒç»­ã€‚åœ¨å‘å¸ƒç‰ˆæœ¬ä¸­ï¼ŒJITèƒ½å¤ŸæŸ¥çœ‹ç¨‹åºç»“æ„ï¼Œä»¥è®¡ç®—å‡ºè¯¥æ–¹æ³•å¯ä»¥ä½¿ç”¨å˜é‡çš„æ‰§è¡Œä¸­çš„æœ€åä¸€ç‚¹ï¼Œå¹¶åœ¨ä¸å†éœ€è¦æ—¶å°†å…¶ä¸¢å¼ƒã€‚æ­¤ç­–ç•¥å¹¶ä¸æ€»æ˜¯ä½¿ç”¨ï¼Œå¯ä»¥å…³é—­ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡åœ¨è°ƒè¯•å™¨ä¸­è¿è¡Œç¨‹åºã€‚ é™æ€å˜é‡ä¹Ÿå§‹ç»ˆè¢«è§†ä¸ºGC rootã€‚å®ƒä»¬å¼•ç”¨çš„å¯¹è±¡å¯ä»¥ç”±å£°æ˜å®ƒä»¬çš„ç±»ï¼ˆæˆ–ç¨‹åºçš„å…¶ä½™éƒ¨åˆ†ï¼Œå¦‚æœå®ƒä»¬æ˜¯å…¬å…±çš„ï¼‰éšæ—¶è®¿é—®ï¼Œå› æ­¤.NETå°†å§‹ç»ˆä¿ç•™å®ƒä»¬ã€‚å£°æ˜ä¸ºâ€œthread staticâ€çš„å˜é‡åªä¼šæŒç»­è¯¥çº¿ç¨‹è¿è¡Œçš„æ—¶é—´ã€‚ å¦‚æœé€šè¿‡interopå°†æ‰˜ç®¡å¯¹è±¡ä¼ é€’ç»™éæ‰˜ç®¡COM +libraryï¼Œé‚£ä¹ˆå®ƒä¹Ÿå°†æˆä¸ºå…·æœ‰å¼•ç”¨è®¡æ•°çš„GC rootã€‚è¿™æ˜¯å› ä¸ºCOM +ä¸è¿›è¡Œåƒåœ¾æ”¶é›†ï¼šå®ƒä½¿ç”¨å¼•ç”¨è®¡æ•°ç³»ç»Ÿ; ä¸€æ—¦COM +libraryé€šè¿‡å°†å¼•ç”¨è®¡æ•°è®¾ç½®ä¸º0æ¥å®Œæˆå¯¹è±¡ï¼Œå®ƒå°±ä¸å†æ˜¯GC rootï¼Œå¯ä»¥å†æ¬¡æ”¶é›†ã€‚ å¦‚æœä¸€ä¸ªå¯¹è±¡æœ‰ä¸€ä¸ªfinalizerï¼Œå½“åƒåœ¾æ”¶é›†å™¨å†³å®šå®ƒä¸å†â€œliveâ€æ—¶ï¼Œå®ƒä¸ä¼šè¢«ç«‹å³åˆ é™¤ã€‚ç›¸åï¼Œå®ƒåœ¨.NETè°ƒç”¨ç»ˆç»“å™¨æ–¹æ³•ä¹‹å‰æˆä¸ºä¸€ç§ç‰¹æ®Šçš„rootã€‚è¿™æ„å‘³ç€è¿™äº›å¯¹è±¡é€šå¸¸éœ€è¦ä»å†…å­˜ä¸­åˆ é™¤å¤šä¸ªåƒåœ¾æ”¶é›†ï¼Œå› ä¸ºå®ƒä»¬å°†åœ¨ç¬¬ä¸€æ¬¡è¢«å‘ç°æœªä½¿ç”¨æ—¶å­˜æ´»ã€‚ The Object Graphæ€»çš„æ¥è¯´ï¼Œ.NETä¸­çš„å†…å­˜å½¢æˆäº†ä¸€ä¸ªå¤æ‚çš„ï¼Œæ‰“ç»“çš„å¼•ç”¨å’Œäº¤å‰å¼•ç”¨å›¾ã€‚è¿™å¯èƒ½ä½¿å¾—éš¾ä»¥ç¡®å®šç‰¹å®šå¯¹è±¡ä½¿ç”¨çš„å†…å­˜é‡ã€‚ä¾‹å¦‚ï¼ŒListå¯¹è±¡ä½¿ç”¨çš„å†…å­˜éå¸¸å°ï¼Œå› ä¸ºListç±»åªæœ‰å‡ ä¸ªå­—æ®µã€‚ä½†æ˜¯ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯Listä¸­çš„å¯¹è±¡æ•°ç»„å¦‚æœæœ‰è®¸å¤šèŠ‚ç‚¹ï¼Œè¿™å¯èƒ½ä¼šéå¸¸å¤§ã€‚è¿™å‡ ä¹æ€»æ˜¯ç”±Listæ‰€æ‹¥æœ‰ï¼Œå› æ­¤å…³ç³»éå¸¸ç®€å•ï¼šListçš„æ€»å¤§å°æ˜¯å°çš„åˆå§‹å¯¹è±¡å’Œå®ƒå¼•ç”¨çš„å¤§å‹æ•°ç»„çš„å¤§å°ã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­çš„å¯¹è±¡å¯èƒ½å®Œå…¨æ˜¯å¦ä¸€å›äº‹ï¼šå¯èƒ½å­˜åœ¨ä¸€äº›é€šè¿‡å†…å­˜çš„å…¶ä»–è·¯å¾„ï¼Œé€šè¿‡å®ƒä»¬å¯ä»¥åˆ°è¾¾å®ƒä»¬ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“å¾ªç¯å¼•ç”¨å‘æŒ¥ä½œç”¨æ—¶ï¼Œäº‹æƒ…å˜å¾—æ›´åŠ æ··ä¹±ã€‚ åœ¨å¼€å‘ä»£ç æ—¶ï¼Œé€šå¸¸ä¼šå°†å†…å­˜è§†ä¸ºä¸€ä¸ªæ›´å®¹æ˜“ç†è§£çš„ç»“æ„ï¼šä»å•ä¸ªrootå¼€å§‹çš„treeï¼š äº‹å®ä¸Šï¼Œä»¥è¿™ç§æ–¹å¼æ€è€ƒç¡®å®å¯ä»¥æ›´å®¹æ˜“ï¼ˆæˆ–ç¡®å®å¯èƒ½ï¼‰æ€è€ƒå¦‚ä½•åœ¨å†…å­˜ä¸­å¸ƒç½®å¯¹è±¡ã€‚è¿™ä¹Ÿæ˜¯ç¼–å†™ç¨‹åºæˆ–ä½¿ç”¨è°ƒè¯•å™¨æ—¶æ•°æ®çš„è¡¨ç¤ºæ–¹å¼ï¼Œä½†è¿™æ ·å¯ä»¥å¾ˆå®¹æ˜“åœ°å¿˜è®°å¯¹è±¡å¯ä»¥é™„åŠ åˆ°å¤šä¸ªrootã€‚.NETä¸­çš„å†…å­˜æ³„æ¼é€šå¸¸æ˜¯æ¥è‡ªå¼€å‘äººå‘˜å¿˜è®°æˆ–è€…ä»æœªæ„è¯†åˆ°å¯¹è±¡è¢«é™„åŠ åˆ°å¤šä¸ªrootã€‚è€ƒè™‘è¿™é‡Œæ˜¾ç¤ºçš„æƒ…å†µï¼šå°†GC root 2è®¾ç½®ä¸ºnullï¼ˆçœ‹ä¸‹å›¾ï¼Œä¸è¦çœ‹ä¸Šå›¾ï¼‰å®é™…ä¸Šä¸ä¼šå…è®¸åƒåœ¾æ”¶é›†å™¨åˆ é™¤ä»»ä½•å¯¹è±¡ï¼Œè¿™å¯ä»¥ä»æŸ¥çœ‹å®Œæ•´å›¾å½¢è€Œä¸æ˜¯ä»æ ‘ä¸­çœ‹åˆ°ã€‚ å†…å­˜åˆ†æå™¨ä½¿å¾—å¯ä»¥ä»å¦ä¸€ä¸ªè§’åº¦æŸ¥çœ‹å›¾å½¢ï¼Œä½œä¸ºä»¥å•ä¸ªå¯¹è±¡ä¸ºæ ¹çš„æ ‘å¹¶å‘åè·Ÿéšå¼•ç”¨ä»¥å°†GC rootæ”¾åœ¨å¶å­ä¸Šã€‚å¯¹äºroot 2å¼•ç”¨çš„ClassCå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å‘åè·Ÿéšå¼•ç”¨ä»¥è·å–ä»¥ä¸‹å›¾å½¢ï¼š ä»¥è¿™ç§æ–¹å¼æ€è€ƒè¡¨æ˜ClassCå¯¹è±¡æœ‰ä¸¤ä¸ªæœ€ç»ˆçš„å½’å±è€…ï¼Œä¸¤è€…éƒ½å¿…é¡»åœ¨åƒåœ¾æ”¶é›†å™¨ç§»é™¤å®ƒä¹‹å‰æ”¾å¼ƒå®ƒã€‚GC root 3ä¸å¯¹è±¡ä¹‹é—´çš„ä»»ä½•é“¾æ¥éƒ½å¯ä»¥è¢«ç ´åï¼Œä»¥ä¾¿åœ¨GC root 2è®¾ç½®ä¸ºnullåå°†å…¶åˆ é™¤ã€‚ åœ¨å®é™…çš„.NETåº”ç”¨ç¨‹åºä¸­å¾ˆå®¹æ˜“å‡ºç°è¿™ç§æƒ…å†µã€‚æœ€å¸¸è§çš„ä¸€ä¸ªæ˜¯æ•°æ®å¯¹è±¡ç”±ç”¨æˆ·ç•Œé¢ä¸­çš„å…ƒç´ å¼•ç”¨ï¼Œä½†åœ¨æ•°æ®å®Œæˆåä¸ä¼šè¢«åˆ é™¤ã€‚è¿™ç§æƒ…å†µå¹¶ä¸æ˜¯å¾ˆä¸¥é‡ï¼šä½¿ç”¨æ–°æ•°æ®æ›´æ–°UIæ§ä»¶æ—¶å°†å›æ”¶å†…å­˜ï¼Œä½†è¿™å¯èƒ½æ„å‘³ç€åº”ç”¨ç¨‹åºä½¿ç”¨çš„å†…å­˜æ¯”é¢„æœŸçš„å¤šå¾—å¤šã€‚äº‹ä»¶å¤„ç†ç¨‹åºæ˜¯å¦ä¸€ä¸ªå¸¸è§åŸå› ï¼šå¾ˆå®¹æ˜“å¿˜è®°ä¸€ä¸ªå¯¹è±¡å°†è‡³å°‘ä¸å®ƒæ¥æ”¶äº‹ä»¶çš„å¯¹è±¡ä¸€æ ·é•¿ï¼Œè¿™åœ¨æŸäº›å…¨å±€äº‹ä»¶å¤„ç†ç¨‹åºï¼ˆä¾‹å¦‚Applicationç±»ä¸­çš„é‚£äº›äº‹ä»¶å¤„ç†ç¨‹åºï¼‰çš„æƒ…å†µä¸‹æ°¸è¿œå­˜åœ¨ã€‚ çœŸå®åº”ç”¨ç¨‹åºï¼Œå°¤å…¶æ˜¯é‚£äº›å…·æœ‰ç”¨æˆ·ç•Œé¢ç»„ä»¶çš„åº”ç”¨ç¨‹åºï¼Œå…·æœ‰æ¯”è¿™æ›´å¤æ‚çš„å›¾å½¢ ç”šè‡³åƒå¯¹è¯æ¡†ä¸­çš„æ ‡ç­¾è¿™æ ·ç®€å•çš„ä¸œè¥¿ä¹Ÿå¯ä»¥ä»å¤§é‡ä¸åŒçš„åœ°æ–¹å¼•ç”¨â€¦â€¦ å¾ˆéš¾æŸ¥æ‰¾å¯¹è±¡çš„å¼•ç”¨å…³ç³»ã€‚ åƒåœ¾æ”¶é›†å™¨çš„é™åˆ¶Unused objects.NETä¸­åƒåœ¾æ”¶é›†å™¨çš„æœ€å¤§é™åˆ¶ï¼šè™½ç„¶å®ƒæ‰¾åˆ°äº†æœªå¼•ç”¨çš„å¯¹è±¡ï¼Œä½†æ˜¯å®ƒä»ç„¶å¯èƒ½æ— æ³•åˆ é™¤ã€‚è€Œè¿™ä¸ªå¯¹è±¡æ°¸è¿œä¸ä¼šè¢«ç¨‹åºå†æ¬¡å¼•ç”¨; è™½ç„¶å®ƒæœ‰ä¸€äº›è·¯å¾„å¯¼è‡´å¯èƒ½ä»ç„¶ä½¿ç”¨çš„å¯¹è±¡ï¼Œä½†å®ƒæ°¸è¿œä¸ä¼šä»å†…å­˜ä¸­é‡Šæ”¾å‡ºæ¥ã€‚è¿™ä¼šå¯¼è‡´å†…å­˜æ³„æ¼; åœ¨.NETä¸­ï¼Œå½“ä¸å†ä½¿ç”¨çš„å¯¹è±¡ä»ç„¶è¢«å¼•ç”¨æ—¶ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚ è™½ç„¶å†…å­˜ä½¿ç”¨é‡ä¸Šå‡çš„ç—‡çŠ¶å¾ˆæ˜æ˜¾ï¼Œä½†è¿™äº›æ³„æ¼çš„æ¥æºå¾ˆéš¾è¢«å‘ç°ã€‚æœ‰å¿…è¦ç¡®å®šå“ªäº›æœªä½¿ç”¨çš„å¯¹è±¡ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œç„¶åè·Ÿè¸ªå¼•ç”¨ä»¥æ‰¾å‡ºå®ƒä»¬æœªè¢«æ”¶é›†çš„åŸå› ã€‚å†…å­˜åˆ†æå™¨å¯¹äºæ­¤ä»»åŠ¡è‡³å…³é‡è¦ï¼šé€šè¿‡åœ¨å‘ç”Ÿæ³„æ¼æ—¶æ¯”è¾ƒå†…å­˜çŠ¶æ€ï¼Œå¯ä»¥æ‰¾åˆ°éº»çƒ¦çš„æœªä½¿ç”¨å¯¹è±¡ï¼Œä½†æ˜¯æ— æ³•å‘åè·Ÿè¸ªå¯¹è±¡å¼•ç”¨ã€‚ åƒåœ¾æ”¶é›†å™¨æ—¨åœ¨å¤„ç†ä¸°å¯Œçš„èµ„æºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½•æ—¶é‡Šæ”¾å¯¹è±¡æ— å…³ç´§è¦ã€‚åœ¨ç°ä»£ç³»ç»Ÿä¸­ï¼Œå†…å­˜å±äºè¯¥ç±»åˆ«ï¼ˆåªè¦å®ƒåŠæ—¶å®Œæˆä»¥é˜²æ­¢æ–°åˆ†é…å¤±è´¥ï¼Œå®ƒå°±ä¼šè¢«å›æ”¶ã€‚ä»ç„¶å­˜åœ¨ä¸å±äºæ­¤ç±»åˆ«çš„èµ„æºï¼šä¾‹å¦‚ï¼Œéœ€è¦å¿«é€Ÿå…³é—­æ–‡ä»¶å¥æŸ„ä»¥é¿å…å¯¼è‡´åº”ç”¨ç¨‹åºä¹‹é—´çš„å…±äº«å†²çªã€‚è¿™äº›èµ„æºä¸èƒ½ç”±åƒåœ¾æ”¶é›†å™¨å®Œå…¨ç®¡ç†ï¼Œå› æ­¤.NETä¸ºç®¡ç†è¿™äº›èµ„æºçš„å¯¹è±¡æä¾›äº†Dispose()æ–¹æ³•å’Œusing()æ„é€ ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå¯¹è±¡ä½¿ç”¨çš„ç¨€ç¼ºèµ„æºé€šè¿‡å®ç°å¿«é€Ÿé‡Šæ”¾Dispose æ–¹æ³•ï¼Œè¿™æ¯”åƒåœ¾æ”¶é›†å™¨ç¨åé‡Šæ”¾çš„å…³é”®å†…å­˜è¦å°‘å¾—å¤šã€‚ Disposeå¯¹.NETæ¥è¯´æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ï¼Œå› æ­¤å¿…é¡»ä»ç„¶å–æ¶ˆå¼•ç”¨å·²å¤„ç†çš„å¯¹è±¡ã€‚è¿™ä½¿å¾—å·²ç»å¤„ç†ä½†å°šæœªè¢«å›æ”¶çš„å¯¹è±¡æˆä¸ºå†…å­˜æ³„æ¼æºçš„è‰¯å¥½å€™é€‰è€…ã€‚ å †çš„ç¢ç‰‡GCå †GCå †ç”¨æ¥åˆ†é…å°å¯¹è±¡å®ä¾‹ï¼Œä»–æ˜¯ç”±GCå®Œå…¨æ§åˆ¶å†…å­˜çš„åˆ†é…å’Œå›æ”¶ã€‚ LOHå †LOHå †æ˜¯ä¸ºå¤§å¯¹è±¡å®ä¾‹å‡†å¤‡çš„ï¼Œå®ƒä¸ä¼šè¢«å‹ç¼©ä¸”åªåœ¨GCå®Œå…¨å›æ”¶æ—¶æ‰ä¼šè¢«å›æ”¶ã€‚æˆä¸ºLOHå †çš„ä¸€éƒ¨åˆ†çš„å¯¹è±¡æ°¸è¿œä¸ä¼šè¢«è¿è¡Œæ—¶ç§»åŠ¨ï¼Œè¿™å¯èƒ½å¯¼è‡´ç¨‹åºè¿‡æ—©åœ°è€—å°½å†…å­˜ã€‚å½“æŸäº›å¯¹è±¡æ¯”å…¶ä»–å¯¹è±¡ç”Ÿå‘½å‘¨æœŸæ›´é•¿æ—¶ï¼Œè¿™ä¼šå¯¼è‡´å †åœ¨ä»¥å‰å¯¹è±¡æ‰€åœ¨çš„ä½ç½®ç”Ÿæˆç¢ç‰‡ã€‚å½“ç¨‹åºç”³è¯·å¤§å—å†…å­˜ä½†å †å·²ç»å› ä¸ºç¢ç‰‡ä»¥è‡³äºæ²¡æœ‰è¶³å¤Ÿå¤§çš„å•ä¸ªå†…å­˜åŒºåŸŸæ¥å®¹çº³å®ƒæ—¶ï¼Œå°±ä¼šå‡ºç°é—®é¢˜ã€‚å†…å­˜åˆ†æå™¨å¯ä»¥ä¼°è®¡ç¨‹åºå¯ä»¥åˆ†é…çš„æœ€å¤§å¯¹è±¡ï¼Œå¦‚æœåˆ†é…å¤±è´¥ï¼Œé‚£ä¹ˆè¿™å¾ˆå¯èƒ½æ˜¯å› ä¸ºç¢ç‰‡å¯¼è‡´çš„ã€‚ä¸€ä¸ªOutOfMemoryExceptionå½“ç¨‹åºæ˜¾ç„¶æ‹¥æœ‰å¤§é‡å¯ç”¨å†…å­˜æ—¶ï¼Œé€šå¸¸ä¼šå‘ç”Ÿç¢ç‰‡å¯¼è‡´åœ¨32ä½ç³»ç»Ÿä¸Šï¼Œè¿›ç¨‹åº”è¯¥èƒ½å¤Ÿä½¿ç”¨è‡³å°‘1.5Gbï¼Œä½†ç”±äºç¢ç‰‡å¯¼è‡´çš„æ•…éšœé€šå¸¸ä¼šåœ¨ä½¿ç”¨ä¹‹å‰å¼€å§‹å‘ç”Ÿå¾ˆå¤šè®°å¿†ã€‚åœ¨ILä¸­å¯ä»¥çœ‹åˆ°newobjã€ldstr(åˆ›å»ºstringå¯¹è±¡)ã€newarr(ç”¨äºåˆ†é…æ–°çš„æ•°ç»„å¯¹è±¡)ã€box(è£…ç®±)ç­‰å¸¸è§çš„åˆ›å»ºå¯¹è±¡çš„æŒ‡ä»¤ã€‚å½“ç„¶åœ¨å †ä¸Šä¹Ÿå­˜åœ¨å€¼ç±»å‹ï¼Œæ¯”å¦‚å€¼ç±»å‹ä½œä¸ºç±»çš„å­—æ®µæ—¶ï¼Œä»–å°†å­˜å‚¨åœ¨å †çš„å®ä¾‹å¯¹è±¡ç©ºé—´ï¼Œè¿˜æœ‰è£…ç®±æ—¶ä¹Ÿä¼šè®©å †ä¸Šå­˜åœ¨å€¼ç±»å‹ã€‚ ç¢ç‰‡çš„å¦ä¸€ä¸ªç—‡çŠ¶æ˜¯.NETé€šå¸¸å¿…é¡»ä¿ç•™åˆ†é…ç»™åº”ç”¨ç¨‹åºçš„ç©ºæ´æ‰€ä½¿ç”¨çš„å†…å­˜ã€‚è¿™ä½¿å¾—å®ƒæ˜¾ç„¶ä½¿ç”¨æ¯”åœ¨ä»»åŠ¡ç®¡ç†å™¨ä¸­æŸ¥çœ‹æ—¶æ‰€éœ€çš„å†…å­˜æ›´å¤šçš„å†…å­˜ã€‚è¿™ç§æ•ˆæœé€šå¸¸ç›¸å¯¹æ— å®³ï¼šWindowséå¸¸æ“…é•¿äºæ„è¯†åˆ°æ¼æ´æ‰€å ç”¨çš„å†…å­˜æœªè¢«ä½¿ç”¨å¹¶å°†å…¶åˆ†é¡µï¼Œå¦‚æœç¢ç‰‡æ²¡æœ‰æ¶åŒ–ï¼Œé‚£ä¹ˆç¨‹åºå°†ä¸ä¼šè€—å°½å†…å­˜ã€‚ä½†æ˜¯ï¼Œå¯¹ç”¨æˆ·è€Œè¨€ï¼Œè¿™çœ‹èµ·æ¥å¹¶ä¸å¥½ï¼Œä»–ä»¬å¯èƒ½è®¤ä¸ºè¯¥åº”ç”¨ç¨‹åºæ˜¯æµªè´¹å’Œâ€œè‡ƒè‚¿â€ã€‚è¿™é€šå¸¸æ˜¯å½“åˆ†æå™¨æ˜¾ç¤ºç¨‹åºåˆ†é…çš„å¯¹è±¡ä»…ä½¿ç”¨å°‘é‡å†…å­˜ä½†ä»»åŠ¡ç®¡ç†å™¨æ˜¾ç¤ºè¯¥è¿›ç¨‹å ç”¨å¤§é‡ç©ºé—´æ—¶å‘ç”Ÿçš„æƒ…å†µã€‚ åƒåœ¾æ”¶é›†å™¨çš„æ€§èƒ½åœ¨æ€§èƒ½æ–¹é¢ï¼Œåƒåœ¾æ”¶é›†ç³»ç»Ÿæœ€é‡è¦çš„ç‰¹å¾æ˜¯åƒåœ¾æ”¶é›†å™¨å¯ä»¥éšæ—¶å¼€å§‹æ‰§è¡Œã€‚è¿™ä½¿å¾—å®ƒä»¬ä¸é€‚åˆäºæ—¶åºéå¸¸å…³é”®çš„æƒ…å†µï¼Œå› ä¸ºä»»ä½•æ“ä½œçš„æ—¶åºéƒ½å¯ä»¥é€šè¿‡æ”¶é›†å™¨çš„æ“ä½œè€Œè¢«æŠ›å¼ƒã€‚ .NETæ”¶é›†å™¨æœ‰ä¸¤ç§ä¸»è¦çš„æ“ä½œæ¨¡å¼ï¼šå¹¶å‘å’ŒåŒæ­¥ï¼ˆæœ‰æ—¶ç§°ä¸ºå·¥ä½œç«™å’ŒæœåŠ¡å™¨ï¼‰ã€‚å¹¶å‘åƒåœ¾æ”¶é›†åœ¨æ¡Œé¢åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ï¼Œå¹¶ä¸”é»˜è®¤æƒ…å†µä¸‹åœ¨ASP.NETç­‰æœåŠ¡å™¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨åŒæ­¥ã€‚ åœ¨å¹¶å‘æ¨¡å¼ä¸‹ï¼Œ.NETå°†å°è¯•é¿å…åœ¨é›†åˆæ­£åœ¨è¿›è¡Œæ—¶åœæ­¢æ­£åœ¨è¿è¡Œçš„ç¨‹åºã€‚è¿™æ„å‘³ç€åº”ç”¨ç¨‹åºåœ¨ç»™å®šæ—¶é—´å†…å®Œæˆçš„æ€»é‡è¾ƒå°‘ï¼Œä½†åº”ç”¨ç¨‹åºä¸ä¼šæš‚åœã€‚å¯¹äºäº¤äº’å¼åº”ç”¨ç¨‹åºè€Œè¨€ï¼Œè¿™å¯¹äºå‘ç”¨æˆ·æä¾›åº”ç”¨ç¨‹åºç«‹å³å“åº”çš„å°è±¡éå¸¸é‡è¦ã€‚ åœ¨åŒæ­¥æ¨¡å¼ä¸‹ï¼Œ.NETå°†åœ¨åƒåœ¾æ”¶é›†å™¨è¿è¡Œæ—¶æŒ‚èµ·æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºã€‚è¿™å®é™…ä¸Šæ¯”å¹¶å‘æ¨¡å¼æ›´æœ‰æ•ˆ - åƒåœ¾æ”¶é›†èŠ±è´¹ç›¸åŒçš„æ—¶é—´ï¼Œä½†å®ƒä¸å¿…ä¸ç»§ç»­è¿è¡Œçš„ç¨‹åºç«äº‰ - ä½†æ„å‘³ç€å½“å¿…é¡»å®Œæˆå®Œæ•´é›†åˆæ—¶å¯èƒ½ä¼šæœ‰æ˜æ˜¾çš„æš‚åœã€‚ å¦‚æœé»˜è®¤å€¼ä¸åˆé€‚ï¼Œå¯ä»¥åœ¨åº”ç”¨ç¨‹åºçš„é…ç½®æ–‡ä»¶ä¸­è®¾ç½®åƒåœ¾æ”¶é›†å™¨çš„ç±»å‹ã€‚å½“åº”ç”¨ç¨‹åºå…·æœ‰é«˜ååé‡è€Œä¸æ˜¯æ˜¾ç¤ºå“åº”æ›´é‡è¦æ—¶ï¼Œé€‰æ‹©åŒæ­¥æ”¶é›†å™¨ä¼šå¾ˆæœ‰ç”¨ã€‚ åˆ†ä»£æœºåˆ¶åœ¨å¤§å‹åº”ç”¨ç¨‹åºä¸­ï¼Œåƒåœ¾æ”¶é›†å™¨éœ€è¦å¤„ç†çš„å¯¹è±¡æ•°é‡ä¼šå˜å¾—éå¸¸å¤§ï¼Œè¿™æ„å‘³ç€è®¿é—®å’Œé‡æ–°æ’åˆ—æ‰€æœ‰è¿™äº›å¯¹è±¡å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ.NETä½¿ç”¨â€œä¸–ä»£â€åƒåœ¾æ”¶é›†å™¨ï¼Œå®ƒè¯•å›¾ä¼˜å…ˆè€ƒè™‘è¾ƒå°çš„ä¸€ç»„å¯¹è±¡ã€‚æˆ‘ä»¬çš„æƒ³æ³•æ˜¯ï¼Œæœ€è¿‘åˆ›å»ºçš„å¯¹è±¡æ›´æœ‰å¯èƒ½è¢«å¼ƒç”¨ï¼Œå› æ­¤å½“å°è¯•é‡Šæ”¾å†…å­˜æ—¶ï¼Œåˆ†ä»£åƒåœ¾æ”¶é›†å™¨ä¼šä¼˜å…ˆè€ƒè™‘å®ƒä»¬ï¼Œå› æ­¤æ‰€æœ‰æ–°åˆ›å»ºçš„å¯¹è±¡éƒ½ä¼šæ”¾åœ¨ç¬¬0ä»£å †ä¸Šï¼Œç›´åˆ°å›æ”¶å™¨è¿›è¡Œäº†ä¸€æ¬¡æ¸…ç†åŠ¨ä½œåä»å­˜åœ¨çš„å¯¹è±¡ä¼šè¢«ç§»åŠ¨åˆ°å¦ä¸€ç‰‡è¿ç»­çš„åœ°å€ç©ºé—´ä¸­ï¼Œå³ç¬¬1ä»£å †ä¸Šã€‚è€Œä¹‹å‰ç¬¬1ä»£ä¸Šå‰©ä½™çš„å¯¹è±¡ä¼šè¢«ç§»åŠ¨åˆ°ç¬¬2ä»£å †ä¸Šï¼Œæ­¤æ—¶ç¬¬0ä»£å †ç©ºé—²ï¼Œç­‰å¾…æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚æ¯ä¸€æ¬¡å›æ”¶åŠ¨ä½œéƒ½é‡å¤æ­¤è¿‡ç¨‹ã€‚æ–°çš„å¯¹è±¡è¢«å›æ”¶çš„å‡ ç‡æ›´å¤§ï¼Œå°†è¿™äº›å¯¹è±¡åˆ†é˜¶æ®µå­˜æ”¾ï¼Œå›æ”¶è¿‡ç¨‹é€Ÿåº¦åŠ å¿«ã€‚æ³¨ï¼šåœ¨åˆ›å»ºæ–°å¯¹è±¡æ—¶ï¼Œå¦‚æœæ‰€éœ€ç©ºé—´è¶…å‡ºäº†ç¬¬0ä»£å¯¹åº”çš„ç©ºé—²åŒºåŸŸï¼Œå›æ”¶å™¨ä¼šè¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå°†ç¬¬0ä»£åŒºåŸŸç©ºé—²å‡ºæ¥ã€‚ å¦‚æœ.NETå¯ä»¥é€‰æ‹©æ”¶é›†æ—¶é—´æœ¬èº«ï¼Œå¹¶ä¸”if GC.Collect()è¢«è°ƒç”¨ä¼šä¸­æ–­ï¼Œè¿™ä¸ªç³»ç»Ÿæ•ˆæœæœ€å¥½ï¼Œå› ä¸ºè¿™é€šå¸¸ä¼šå¯¼è‡´æ–°å¯¹è±¡è¿‡æ—©è€åŒ–ï¼Œè¿™å¢åŠ äº†åœ¨ä¸ä¹…çš„å°†æ¥å¦ä¸€ä¸ªæ˜‚è´µçš„å®Œæ•´æ”¶é›†çš„å¯èƒ½æ€§ã€‚ å…·æœ‰ç»ˆç»“å™¨çš„ç±»ä¹Ÿå¯ä»¥ç ´ååƒåœ¾æ”¶é›†å™¨çš„å¹³ç¨³æ“ä½œã€‚è¿™äº›ç±»çš„å¯¹è±¡ä¸èƒ½ç«‹å³åˆ é™¤ï¼šå®ƒä»¬è½¬åˆ°ç»ˆç»“å™¨é˜Ÿåˆ—ï¼Œå¹¶åœ¨ç»ˆç»“å™¨è¿è¡Œåä»å†…å­˜ä¸­åˆ é™¤ã€‚è¿™æ„å‘³ç€å®ƒä»¬å¼•ç”¨çš„ä»»ä½•å¯¹è±¡ï¼ˆä»¥åŠé‚£äº›å¼•ç”¨çš„ä»»ä½•å¯¹è±¡ï¼Œç­‰ç­‰ï¼‰å¿…é¡»è‡³å°‘ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œç›´åˆ°æ­¤æ—¶ä¸ºæ­¢ï¼Œå¹¶ä¸”åœ¨å†…å­˜å†æ¬¡å¯ç”¨ä¹‹å‰éœ€è¦ä¸¤æ¬¡åƒåœ¾æ”¶é›†ã€‚å¦‚æœå›¾å½¢åŒ…å«è®¸å¤šå¸¦æœ‰ç»ˆç»“å™¨çš„å¯¹è±¡ï¼Œè¿™å¯èƒ½æ„å‘³ç€åƒåœ¾æ”¶é›†å™¨éœ€è¦å¤šæ¬¡ä¼ é€’æ‰èƒ½å®Œå…¨é‡Šæ”¾æ‰€æœ‰æœªå¼•ç”¨çš„å¯¹è±¡ã€‚ æœ‰ä¸€ç§ç®€å•çš„æ–¹æ³•å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜ï¼šIDisposableåœ¨å¯finalizableçš„ç±»ä¸Šå®ç°ï¼Œå°†æœ€ç»ˆåŒ–å¯¹è±¡æ‰€éœ€çš„æ“ä½œç§»åŠ¨åˆ°Dispose()æ–¹æ³•ä¸­å¹¶GC.SuppressFinalize()åœ¨æœ€åè°ƒç”¨ã€‚ç„¶åå¯ä»¥ä¿®æ”¹ç»ˆç»“å™¨ä»¥è°ƒç”¨è¯¥Dispose()æ–¹æ³•ã€‚GC.SuppressFinalize()å‘Šè¯‰åƒåœ¾æ”¶é›†å™¨è¯¥å¯¹è±¡ä¸å†éœ€è¦æœ€ç»ˆç¡®å®šï¼Œå¹¶ä¸”å¯ä»¥ç«‹å³è¿›è¡Œåƒåœ¾æ”¶é›†ï¼Œè¿™å¯ä»¥æ›´å¿«åœ°å›æ”¶å†…å­˜ã€‚ ç»“è®ºå¦‚æœæ‚¨èŠ±æ—¶é—´äº†è§£åƒåœ¾æ”¶é›†å™¨çš„å·¥ä½œåŸç†ï¼Œé‚£ä¹ˆç†è§£åº”ç”¨ç¨‹åºä¸­çš„å†…å­˜å’Œæ€§èƒ½é—®é¢˜ä¼šå˜å¾—æ›´å®¹æ˜“ã€‚å®ƒæ­ç¤ºäº†ï¼Œè™½ç„¶.NETä½¿å†…å­˜ç®¡ç†çš„è´Ÿæ‹…æ›´è½»ï¼Œä½†å¹¶ä¸èƒ½å®Œå…¨æ¶ˆé™¤è·Ÿè¸ªå’Œç®¡ç†èµ„æºçš„éœ€è¦ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨å†…å­˜åˆ†æå™¨æ¥è¯Šæ–­å’Œä¿®å¤.NETä¸­çš„é—®é¢˜ä¼šæ›´å®¹æ˜“ã€‚è€ƒè™‘åˆ°.NETåœ¨å¼€å‘æ—©æœŸç®¡ç†å†…å­˜çš„æ–¹å¼å¯ä»¥å¸®åŠ©å‡å°‘é—®é¢˜ï¼Œä½†å³ä½¿è¿™æ ·ï¼Œç”±äºæ¡†æ¶æˆ–ç¬¬ä¸‰æ–¹åº“çš„å¤æ‚æ€§ï¼Œä»ç„¶å¯èƒ½å‡ºç°è¿™æ ·çš„é—®é¢˜ã€‚]]></content>
      <categories>
        <category>CSharp</category>
      </categories>
      <tags>
        <tag>CSharp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RectTransform]]></title>
    <url>%2F2019%2F05%2F09%2Frecttransform%2F</url>
    <content type="text"><![CDATA[123456789// æ”¹å˜RectTransformçš„topå’ŒRightGetComponent&lt;RectTransform&gt;().offsetMax = new Vector2(left, top);// bottom leftrectTransform.offsetMin = new Vector2(right, bottom);// width heightrectTransform.sizeDelta = new Vector2(width, height);// posrectTransform.anchoredPosition3D = new Vector3(posx,posy,posz);rectTransform.anchoredPosition = new Vector2(posx,posy);]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>UGUI</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ParticleSystem]]></title>
    <url>%2F2019%2F05%2F09%2FParticleSystem%2F</url>
    <content type="text"><![CDATA[1234ParticleSystem ps = GetComponent&lt;ParticleSystem&gt;();var main = ps.main;main.startDelay = 5.0f;main.startLifeTime = 2.0f;]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[UnityWebRequest]]></title>
    <url>%2F2019%2F05%2F08%2Funitywebrequests%2F</url>
    <content type="text"><![CDATA[123456789101112131415161718192021222324252627282930public class Network : MonoBehaviour&#123; void Start() &#123; StartCoroutine(Get()); StartCoroutine(Post()); &#125; IEnumerator Get() &#123; UnityWebRequest webRequest = UnityWebRequest.Get("http://www.baidu.com"); yield return webRequest.SendWebRequest(); if (webRequest.isHttpError || webRequest.isNetworkError) Debug.Log(webRequest.error); else Debug.Log(webRequest.downloadHandler.text); &#125; IEnumerator Post() &#123; WWWForm form = new WWWForm(); form.AddField("key", "value"); form.AddField("name", "mafanwei"); form.AddField("blog","qwe25878"); UnityWebRequest webRequest = UnityWebRequest.Post("http://www.baidu.com", form); yield return webRequest.SendWebRequest(); if (webRequest.isHttpError || webRequest.isNetworkError) Debug.Log(webRequest.error); else Debug.Log(webRequest.downloadHandler.text); &#125;&#125;]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[decompiler]]></title>
    <url>%2F2019%2F05%2F08%2Fdecompiler%2F</url>
    <content type="text"><![CDATA[https://github.com/Zhentar/ILSpy/releases/tag/0.1 ä¸€æ¬¾ä¼˜ç§€çš„åç¼–è¯‘äº§å“ï¼Œä½œè€…ä¿®å¤äº†Mono Iteratorçš„é—®é¢˜ã€‚]]></content>
  </entry>
  <entry>
    <title><![CDATA[Unityçš„é˜´å½±]]></title>
    <url>%2F2019%2F04%2F30%2FUnity-Shadow%2F</url>
    <content type="text"><![CDATA[é˜´å½±æ˜¯å¦‚ä½•å®ç°çš„åœ¨å®æ—¶æ¸²æŸ“ä¸­ï¼Œæˆ‘ä»¬æœ€é•¿ç”¨çš„æ˜¯ä¸€ç§åä¸ºShadow MapæŠ€æœ¯ã€‚è¿™ç§æŠ€æœ¯ç†è§£èµ·æ¥éå¸¸ç®€å•ï¼Œå®ƒä¼šé¦–å…ˆæŠŠæ‘„åƒæœºçš„ä½ç½®æ”¾åœ¨ä¸å…‰æºé‡åˆçš„ä½ç½®ä¸Šï¼Œé‚£ä¹ˆåœºæ™¯ä¸­è¯¥å…‰æºçš„é˜´å½±åŒºåŸŸå°±æ˜¯é‚£äº›æ‘„åƒæœºçœ‹ä¸åˆ°çš„åœ°æ–¹ã€‚è€ŒUnityå°±æ˜¯ä½¿ç”¨çš„è¿™ç§æŠ€æœ¯ã€‚åœ¨å‰å‘æ¸²æŸ“è·¯å¾„ä¸­ï¼Œå¦‚æœåœºæ™¯ä¸­æœ€é‡è¦çš„å¹³è¡Œå…‰å¼€å¯äº†é˜´å½±ï¼ŒUnityå°±ä¼šä¸ºè¯¥å…‰æºè®¡ç®—å®ƒçš„é˜´å½±æ˜ å°„çº¹ç†ï¼ˆshadowmapï¼‰ã€‚è¿™å¼ é˜´å½±éšå°„çº¹ç†æœ¬è´¨ä¹Ÿæ˜¯ä¸€å¼ æ·±åº¦å›¾ï¼Œå®ƒè®°å½•äº†ä»è¯¥å…‰æºçš„ä½ç½®è§¦å‘ã€èƒ½çœ‹åˆ°çš„åœºæ™¯ä¸­è·ç¦»å®ƒæœ€è¿‘çš„è¡¨é¢ä½ç½®ï¼ˆæ·±åº¦ä¿¡æ¯ï¼‰ã€‚é‚£ä¹ˆï¼Œåœ¨è®¡ç®—é˜´å½±æ˜ å°„çº¹ç†æ—¶ï¼Œæˆ‘ä»¬å¦‚ä½•åˆ¤å®šè·ç¦»å®ƒæœ€è¿‘çš„è¡¨é¢ä½ç½®å‘¢ï¼Ÿä¸€ç§æ–¹æ³•æ˜¯ï¼Œå…ˆæŠŠæ‘„åƒæœºæ”¾ç½®åˆ°å…‰æºçš„ä½ç½®ä¸Šï¼Œç„¶åæŒ‰æ­£å¸¸çš„æ¸²æŸ“æµç¨‹ï¼Œå³è°ƒç”¨Base Passå’ŒAdditional Passæ¥æ›´æ–°æ·±åº¦ä¿¡æ¯ï¼Œå¾—åˆ°é˜´å½±æ˜ å°„çº¹ç†ã€‚ä½†è¿™ç§æ–¹æ³•ä¼šå¯¹æ€§èƒ½é€ æˆä¸€å®šçš„æµªè´¹ï¼Œå› ä¸ºæˆ‘ä»¬å®é™…ä¸Šä»…ä»…éœ€è¦æ·±åº¦ä¿¡æ¯è€Œå·²ï¼Œè€ŒBase Passå’ŒAdditional Passä¸­å¾€å¾€æ¶‰åŠå¾ˆå¤šå¤æ‚çš„å…‰ç…§æ¨¡å‹è®¡ç®—ã€‚å› æ­¤ï¼ŒUnityé€‰æ‹©ä½¿ç”¨ä¸€ä¸ªé¢å¤–çš„Passæ¥ä¸“é—¨æ›´æ–°å…‰æºçš„é˜´å½±æ˜ å°„çº¹ç†ï¼Œè¿™ä¸ªPasså°±æ˜¯LightModeæ ‡ç­¾è¢«è®¾ç½®ä¸ºShadowCasterçš„Passã€‚è¿™ä¸ªPassçš„æ¸²æŸ“ç›®æ ‡ä¸æ˜¯å¸§ç¼“å­˜ï¼Œè€Œæ˜¯é˜´å½±æ˜ å°„çº¹ç†ï¼ˆæˆ–æ·±åº¦çº¹ç†ï¼‰ã€‚Unityé¦–å…ˆæŠŠæ‘„åƒæœºæ”¾ç½®åˆ°å…‰æºçš„ä½ç½®ä¸Šï¼Œç„¶åè°ƒç”¨è¯¥Passï¼Œé€šè¿‡å¯¹é¡¶ç‚¹å˜æ¢åå¾—åˆ°å…‰æºç©ºé—´ä¸‹çš„ä½ç½®ï¼Œå¹¶æ®æ­¤æ¥è¾“å‡ºæ·±åº¦ä¿¡æ¯åˆ°é˜´å½±æ˜ å°„çº¹ç†ä¸­ã€‚å› æ­¤ï¼Œå½“å¼€å¯äº†å…‰æºçš„é˜´å½±æ•ˆæœåï¼Œåº•å±‚æ¸²æŸ“å¼•æ“é¦–å…ˆä¼šåœ¨å½“å‰æ¸²æŸ“ç‰©ä½“çš„Unity Shaderä¸­æ‰¾åˆ°LightModeä¸ºShadowCasterçš„Passï¼Œå¦‚æœæ²¡æœ‰ï¼Œå®ƒå°±ä¼šåœ¨FallbackæŒ‡å®šçš„Unity Shaderä¸­ç»§ç»­å¯»æ‰¾ï¼Œå¦‚æœä»ç„¶æ²¡æœ‰æ‰¾åˆ°ï¼Œè¯¥ç‰©ä½“å°±æ— æ³•å‘å…¶ä»–ç‰©ä½“æŠ•å°„é˜´å½±ï¼ˆä½†å®ƒä»ç„¶å¯ä»¥æ¥å—æ¥è‡ªå…¶ä»–ç‰©ä½“çš„é˜´å½±ï¼‰ã€‚å½“æ‰¾åˆ°äº†ä¸€ä¸ªLightModeä½ShadowCasterçš„Passåï¼ŒUnityä¼šä½¿ç”¨è¯¥Passæ¥æ›´æ–°å…‰æºçš„é˜´å½±æ˜ å°„çº¹ç†ã€‚åœ¨ä¼ ç»Ÿçš„é˜´å½±æ˜ å°„çº¹ç†çš„å®ç°ä¸­ï¼Œæˆ‘ä»¬ä¼šåœ¨æ­£å¸¸æ¸²æŸ“çš„Passä¸­æŠŠé¡¶ç‚¹ä½ç½®å˜æ¢åˆ°å…‰æºç©ºé—´ä¸‹ï¼Œä»¥å¾—åˆ°å®ƒåœ¨å…‰æºç©ºé—´ä¸­çš„ä¸‰ç»´ä½ç½®ä¿¡æ¯ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨xyåˆ†é‡å¯¹é˜´å½±æ˜ å°„çº¹ç†è¿›è¡Œé‡‡æ ·ï¼Œå¾—åˆ°é˜´å½±æ˜ å°„çº¹ç†ä¸­è¯¥ä½ç½®çš„æ·±åº¦ä¿¡æ¯ã€‚å¦‚æœè¯¥æ·±åº¦å€¼å°äºè¯¥é¡¶ç‚¹çš„æ·±åº¦å€¼ï¼ˆé€šå¸¸ç”±zåˆ†é‡å¾—åˆ°ï¼‰ï¼Œé‚£ä¹ˆè¯´æ˜è¯¥ç‚¹ä½äºé˜´å½±ä¸­ã€‚ä½†åœ¨Unity5ä¸­ï¼ŒUnityä½¿ç”¨äº†ä¸åŒäºè¿™ç§ä¼ ç»Ÿçš„é˜´å½±é‡‡æ ·æŠ€æœ¯ï¼Œå³å±å¹•ç©ºé—´çš„é˜´å½±æ˜ å°„æŠ€æœ¯ï¼ˆScreenspace Shadow Mapï¼‰ã€‚å±å¹•ç©ºé—´çš„é˜´å½±æ˜ å°„åŸæœ¬æ˜¯å»¶è¿Ÿæ¸²æŸ“ä¸­äº§ç”Ÿé˜´å½±çš„æ–¹æ³•ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å¹³å°Unityéƒ½ä¼šä½¿ç”¨è¿™ç§æŠ€æœ¯ã€‚è¿™æ˜¯å› ä¸ºï¼Œå±å¹•ç©ºé—´çš„é˜´å½±æ˜ å°„éœ€è¦æ˜¾å¡æ”¯æŒMRTï¼Œè€Œæœ‰äº›ç§»åŠ¨å¹³å°ä¸æ”¯æŒè¿™ç§ç‰¹æ€§ã€‚å½“ä½¿ç”¨äº†å±å¹•ç©ºé—´çš„é˜´å½±æ˜ å°„æŠ€æœ¯æ—¶ï¼ŒUnityé¦–å…ˆä¼šé€šè¿‡è°ƒç”¨LightModeä¸ºShadowCasterçš„Passæ¥å¾—åˆ°å¯æŠ•å°„é˜´å½±çš„å…‰æºçš„é˜´å½±æ˜ å°„çº¹ç†ä»¥åŠæ‘„åƒæœºçš„æ·±åº¦çº¹ç†ã€‚ç„¶åï¼Œæ ¹æ®å…‰æºçš„é˜´å½±æ˜ å°„çº¹ç†å’Œæ‘„åƒæœºçš„æ·±åº¦çº¹ç†æ¥å¾—åˆ°å±å¹•ç©ºé—´çš„é˜´å½±å›¾ã€‚å¦‚æœæ‘„åƒæœºçš„æ·±åº¦å›¾ä¸­è®°å½•çš„è¡¨é¢æ·±åº¦å¤§äºè½¬æ¢åˆ°é˜´å½±éšå°„çº¹ç†ä¸­çš„æ·±åº¦å€¼ï¼Œå°±è¯´æ˜è¯¥è¡¨é¢è™½ç„¶æ˜¯å¯è§çš„ï¼Œä½†æ˜¯å´å¤„äºè¯¥å…‰æºçš„é˜´å½±ä¸­ã€‚é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œé˜´å½±å›¾å°±åŒ…å«äº†å±å¹•ç©ºé—´ä¸­æ‰€æœ‰é˜´å½±çš„åŒºåŸŸã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªç‰©ä½“æ¥å—æ¥è‡ªå…¶ä»–ç‰©ä½“çš„é˜´å½±ï¼Œåªéœ€è¦åœ¨Shaderä¸­å¯¹é˜´å½±å›¾è¿›è¡Œé‡‡æ ·ã€‚ç”±äºé˜´å½±å›¾æ˜¯å±å¹•ç©ºé—´ä¸‹çš„ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æŠŠè¡¨é¢åæ ‡ä»æ¨¡å‹ç©ºé—´å˜æ¢åˆ°å±å¹•ç©ºé—´ä¸­ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªåæ ‡å¯¹é˜´å½±å›¾è¿›è¡Œé‡‡æ ·å³å¯ã€‚æ€»ç»“ä¸€ä¸‹ï¼Œä¸€ä¸ªç‰©ä½“æ¥å—æ¥è‡ªå…¶ä»–ç‰©ä½“çš„é˜´å½±ï¼Œä»¥åŠå®ƒåƒå…¶ä»–ç‰©ä½“æŠ•å°„é˜´å½±æ˜¯ä¸¤ä¸ªè¿‡ç¨‹ã€‚ å¦‚æœæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªç‰©ä½“æ¥å—æ¥è‡ªå…¶ä»–ç‰©ä½“çš„é˜´å½±ï¼Œå°±å¿…é¡»åœ¨Shaderä¸­å¯¹é˜´å½±æ˜ å°„çº¹ç†ï¼ˆåŒ…æ‹¬å±å¹•ç©ºé—´çš„é˜´å½±å›¾ï¼‰è¿›è¡Œé‡‡æ ·ï¼ŒæŠŠé‡‡æ ·ç»“æœå’Œæœ€åçš„å…‰ç…§ç»“æœç›¸ä¹˜æ¥äº§ç”Ÿé˜´å½±æ•ˆæœã€‚ å¦‚æœæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªç‰©ä½“å‘å…¶ä»–ç‰©ä½“æŠ•å°„é˜´å½±ï¼Œå°±å¿…é¡»æŠŠè¯¥ç‰©ä½“åŠ å…¥åˆ°å…‰æºçš„é˜´å½±æ˜ å°„çº¹ç†çš„è®¡ç®—ä¸­ï¼Œä»è€Œè®©å…¶ä»–ç‰©ä½“åœ¨å¯¹é˜´å½±æ˜ å°„çº¹ç†é‡‡æ ·æ—¶å¯ä»¥å¾—åˆ°è¯¥ç‰©ä½“çš„ç›¸å…³ä¿¡æ¯ã€‚åœ¨Unityä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯é€šè¿‡ä¸ºè¯¥ç‰©ä½“æ‰§è¡ŒLightModeä¸ºShadowCasterçš„Passæ¥å®ç°çš„ã€‚å¦‚æœä½¿ç”¨äº†å±å¹•ç©ºé—´çš„æŠ•å½±æ˜ å°„æŠ€æœ¯ï¼ŒUnityè¿˜ä¼šä½¿ç”¨è¿™ä¸ªPassäº§ç”Ÿä¸€å¼ æ‘„åƒæœºçš„æ·±åº¦çº¹ç†ã€‚ ä¸é€æ˜ç‰©ä½“çš„é˜´å½±]]></content>
      <categories>
        <category>Unity Shader</category>
      </categories>
      <tags>
        <tag>Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ã€spineã€‘å¿«é€Ÿå…¥é—¨]]></title>
    <url>%2F2019%2F04%2F30%2Fspine-base%2F</url>
    <content type="text"><![CDATA[Spine ä¸é™äºè§’è‰²åŠ¨ç”»ï¼Œä½†è§’è‰²åŠ¨ç”»æ˜¯æœ€å¸¸è§ä¹Ÿæ˜¯æœ€å¥½çš„ä¾‹å­ã€‚åœ¨ Spine ä¸­è§’è‰²ä½¿ç”¨ çš„ä¸æ˜¯ä¸€å¼ å®Œæ•´çš„å›¾ç‰‡ï¼Œè€Œæ˜¯å°†å„ä¸ªéƒ¨åˆ†åˆ‡ç‰‡æˆä¸€ç³»åˆ—çš„å°å›¾ã€‚æ¯”å¦‚ï¼šå¤´ã€èº¯å¹²ã€èƒ³è†Šå’Œè…¿ã€‚ è¿™äº›å°å›¾ç‰‡è¢«é™„åŠ åˆ°éª¨éª¼ä¸Šï¼Œç„¶åç”¨éª¨éª¼è‡ªç”±çš„è®¾ç½®è§’è‰²åŠ¨ä½œã€‚è¿™äº›åˆ‡ç‰‡ä¼šéšç€éª¨éª¼è¿åŠ¨è€Œ äº§ç”Ÿæµç•…çš„åŠ¨ç”»ã€‚ è£…é…æ¨¡å¼ Setup Modeä½¿ç”¨ Spine ä»è£…é…æ¨¡å¼å¼€å§‹ï¼Œåœ¨æ­¤æ¨¡å¼ä¸­åˆ›å»ºéª¨éª¼ï¼Œé™„åŠ åˆ‡ç‰‡ã€‚åœ¨ç¼–è¾‘åŒºçš„å·¦ä¸Šè§’æ˜¾ ç¤ºç€ Setupï¼ˆè£…é…ï¼‰æˆ– Animateï¼ˆåŠ¨ç”»ï¼‰æ¥æŒ‡ç¤ºå½“å‰çš„æ¨¡å¼ï¼Œå¯ä»¥é€šè¿‡ç‚¹å‡»è¿›è¡Œåˆ‡æ¢ã€‚ åˆ‡ç‰‡ Imageså±‚çº§æ ‘ä¸­çš„ Images èŠ‚ç‚¹å®šä¹‰äº† Spine ä»å“ªé‡Œä¸ºä½ æ‰¾åˆ°è¿™å‰¯éª¨æ¶è¦ç”¨çš„å›¾ç‰‡ã€‚å›¾ç‰‡çš„è·¯ å¾„ path é»˜è®¤ä½¿ç”¨å½“å‰é¡¹ç›®çš„ç›¸å¯¹è·¯å¾„ã€‚ä¹Ÿæ”¯æŒç»å¯¹è·¯å¾„ã€‚è®¾ç½®å®Œæˆåï¼Œè·¯å¾„ä¸‹çš„å›¾ç‰‡ä¼šè¢«åŠ  è½½åˆ°å›¾ç‰‡ Images èŠ‚ç‚¹ä¸­ã€‚Spine å®æ—¶ç›‘æ§å›¾ç‰‡æ‰€åœ¨è·¯å¾„ï¼Œå¦‚æœå›¾ç‰‡å‘ç”Ÿæ”¹å˜ï¼Œç«‹åˆ»æ›´æ–°åˆ°é¡¹ç›®ä¸­ã€‚ å‚è€ƒå›¾ç‰‡ Template Imageé€šè¿‡å°†ä¸€å¼ å®Œæ•´çš„è§’ç‰‡ä½œä¸ºå‚è€ƒï¼Œèƒ½æ›´ç®€å•å‡†ç¡®çš„åˆ›å»ºéª¨éª¼å’Œæ”¾ç½®å›¾ç‰‡ã€‚æ“ä½œå¦‚ ä¸‹ï¼šæŠŠ template å›¾ç‰‡ä» Images èŠ‚ç‚¹æ‹–åˆ°ç¼–è¾‘åŒºåŸŸï¼Œå®ƒä¼šè¢«é™„åŠ åˆ° root éª¨éª¼ç‚¹ä¸Šã€‚åœ¨å±‚ çº§æ ‘åº•éƒ¨çš„å±æ€§é¢æ¿å‹¾é€‰èƒŒæ™¯ Background ï¼Œè¢«è®¾ç½®æˆèƒŒæ™¯åå®ƒå°†ä¸å¯é€‰ï¼Œä¹Ÿä¸ä¼šè¢«è¾“å‡ºã€‚å¯ä»¥æ”¹å˜å‚è€ƒå›¾ç‰‡çš„é¢œè‰²ï¼Œè¿™æ ·æ›´å®¹æ˜“è¾¨è®¤ã€‚ è§’è‰²åˆ‡ç‰‡ Character Imagesåœ¨ Images èŠ‚ç‚¹ä¸‹ï¼Œç‚¹é€‰åˆ‡ç‰‡ï¼Œç„¶å shift + å·¦é”®æˆ– ctrl+å·¦é”®æŠŠå…¶å®ƒåˆ‡ç‰‡å…¨éƒ¨é€‰ä¸­ã€‚ æŠŠå®ƒä»¬æ‹–æ”¾åˆ°ç¼–è¾‘åŒºï¼ŒSpine ä¼šä¸ºå®ƒä»¬åˆ›å»ºåˆ‡ç‰‡æ’æ§½ slots å¹¶å…¨éƒ¨æ”¾åœ¨ root éª¨éª¼ç‚¹ä¸‹ã€‚å¯¹ç…§å‚è€ƒå›¾ç‰‡æŠŠæ‰€æœ‰è‚¢ä½“åˆ‡ç‰‡å¯¹ä½ã€‚åˆ‡ç‰‡ä¸æ˜¯ç›´æ¥é™„åŠ åˆ°éª¨éª¼ä¸Šçš„ï¼Œè€Œæ˜¯é™„åŠ åˆ°ä¸€ä¸ªåˆ‡ç‰‡æ’æ§½ä¸­ï¼Œæ’æ§½å†é™„åŠ åˆ°éª¨éª¼ä¸Šã€‚ä¸€ ä¸ªåˆ‡ç‰‡æ’æ§½ä¸­å¯ä»¥æ”¾ç½®å¤šä¸ªåˆ‡ç‰‡ï¼Œä½†ä¸€æ¬¡åªèƒ½æ˜¾ç¤ºä¸€ä¸ªã€‚åˆ‡ç‰‡æ’æ§½å¯¹å¤æ‚éª¨éª¼çš„ç»˜åˆ¶é¡ºåºæ ä¾›æ›´å¤šæ§åˆ¶æƒé™ã€‚åœ¨å±‚çº§æ ‘çš„ Draw Order èŠ‚ç‚¹ä¸­æ‹–æ‹½æ”¹å˜ç»˜åˆ¶é¡ºåºã€‚åœ¨åˆ—è¡¨ä¸Šæ–¹çš„åˆ‡ç‰‡æ’æ§½ä¼šæ˜¾ç¤ºåœ¨ å‰é¢ï¼Œè€Œä¸‹æ–¹çš„æ’æ§½ä¼šæ˜¾ç¤ºåœ¨åé¢ã€‚ä½ è¿˜å¯ä»¥ç”¨+æˆ–-å·é”®æ¥è°ƒæ•´é¡ºåºï¼ŒæŒ‰ä½ Shift å¯ä»¥ä¸€æ¬¡ ç§»åŠ¨5ä¸ªå•ä½ã€‚å½“å‚è€ƒå›¾ç”¨å®Œåï¼Œå¯ä»¥ç‚¹å‡»å±‚çº§æ ‘çš„ä¸­çš„æ˜¾ç¤ºç‚¹éšè—å®ƒã€‚ Photoshopå¦‚æœåœ¨ä½¿ç”¨ Photoshopï¼Œé‚£æ¶è®¾éª¨éª¼æ—¶å¯ä»¥ä½¿ç”¨ Spine æä¾›çš„â€œLayersToPNG.jsxâ€ PS è„šæœ¬ã€‚åœ¨ Spine å®‰è£…ç›®å½•ä¸‹çš„ scripts/photoshop/LayersToPNG.jsx èƒ½æ‰¾åˆ°ã€‚æ­¤è„šæœ¬èƒ½ å¯¼å‡ºå›¾å±‚ä¸º PNG æ–‡ä»¶å’Œ Spine çš„ JSON æ–‡ä»¶ã€‚ç‚¹å‡» Spine å·¦ä¸Šè§’çš„ Spine æ ‡å¿—ï¼Œç„¶å Import Data, Skeletonã€‚å¯¼å…¥çš„éª¨æ¶åŒ…å«ä¸€ä¸ªéª¨éª¼ç‚¹å’Œæ‰€æœ‰çš„å›¾ç‰‡ï¼Œè¿™äº›å›¾ç‰‡ä½ç½®å’Œæ˜¾ç¤ºç»˜åˆ¶é¡ºåº éƒ½å’Œ PS ä¸­çš„å›¾å±‚ä¸€è‡³ã€‚ç•™ç»™ä½ çš„å·¥ä½œå°±åªæœ‰åˆ›å»ºéª¨éª¼äº†ã€‚è¿™åœ¨åé¢ä¼šä»‹ç»ã€‚ å¦ä¸€ä¸ªæé«˜å·¥ä½œæ•ˆç‡çš„æ–¹æ¡ˆæ˜¯ä½¿ç”¨ Adobe Generator . å®ƒèƒ½è®© PNG æ–‡ä»¶ä¸ PSD åŒæ­¥ï¼Œ å¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒæˆ‘æ‰‹åŠ¨å¯¼å›¾å‡ ä¸‡å¼ å›¾è€Œå‘é£™äº†ã€‚è€Œ Spine ä¹Ÿæ˜¯å®æ—¶åŒæ­¥æ–‡ä»¶å¤¹ä¸­çš„ PNG çš„ï¼Œè¿™ä¹Ÿå°±ç›¸å½“äº Spine ä¸­çš„åˆ‡ç‰‡ç´ æå¯ä»¥å’Œ PSD ä¿æŒåŒæ­¥äº†ã€‚ åˆ›å»ºéª¨éª¼ Creating Bonesä½¿ç”¨åˆ›å»º Create å·¥å…·ï¼Œåˆ›å»ºæ–°éª¨éª¼æ—¶ï¼Œé¦–å…ˆè¦é€‰ä¸­ä¸€ä¸ªéª¨éª¼ä½œä¸ºå®ƒçš„çˆ¶çº§ï¼Œç„¶åå†æ‹– æ‹½åˆ›å»ºå‡ºæ–°éª¨éª¼ã€‚ å½“åˆ›å»ºæ–°éª¨éª¼æ—¶ï¼ŒæŒ‰ shiftï¼ˆä¸ç”¨æŒ‰ä½ä¸æ”¾ï¼‰é€‰æ‹©å…‰æ ‡ä¸‹çš„å›¾ç‰‡ã€‚å½“æ‹–å‡ºæ–°éª¨éª¼åï¼Œè¢« é€‰ä¸­çš„å›¾ç‰‡å°†ä¼šå˜æˆæ–°éª¨éª¼çš„å­ç‰©ä½“ã€‚ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½æ¥åˆ›å»ºéª¨éª¼èƒ½æ›´é«˜æ•ˆï¼Œå› ä¸ºä½ åŒæ—¶åˆ›å»ºäº†æ–°éª¨éª¼ï¼Œå¹¶æ”¹å˜äº†å›¾ç‰‡çš„çˆ¶çº§ã€‚ æœ€åä½ å¯èƒ½è¦æƒ³æ”¹å˜æŸä¸ªéª¨å¤´ï¼Œæ’æ§½ï¼Œå›¾ç‰‡æˆ–å…¶å®ƒä¸œè¥¿çš„çˆ¶çº§ã€‚æ–¹æ³•å¦‚ä¸‹ï¼šé€‰ä¸­è¦æ”¹å˜ çˆ¶çº§çš„å¯¹è±¡ï¼ŒæŒ‰ P é”®æˆ– Set Parent æŒ‰é’®ï¼Œç„¶ååœ¨å±‚çº§æ ‘ä¸­é€‰æ‹©æ–°çš„çˆ¶çº§ã€‚å¦‚æœç›®å‰æ˜¯éª¨éª¼ çš„è¯ï¼Œæ¯”èµ·åœ¨å±‚çº§æ ‘ä¸­é€‰ï¼Œåœ¨ç¼–è¾‘åŒºåŸŸé€‰å¯èƒ½æ›´æ–¹ä¾¿ã€‚è¦æ”¹å˜éª¨éª¼çš„é•¿åº¦ï¼Œé€‰ä¸­ä»»æ„ä¸€ä¸ªå˜æ¢å·¥å…· Rotate, Translate æˆ– Scaleã€‚ç„¶åæ‹–åŠ¨éª¨ éª¼çš„æœ«ç«¯ã€‚å¦å¤–éª¨éª¼é•¿åº¦ä¹Ÿå¯ä»¥åœ¨å±‚çº§æ ‘ä¸‹æ–¹çš„å±æ€§é¢æ¿ä¸­è°ƒæ•´ã€‚å¦‚æœéª¨éª¼é•¿åº¦ä¸º0ï¼Œåœ¨ç¼– è¾‘åŒºå®ƒå°†æ˜¾ç¤ºä¸ºä¸€ä¸ªç‰¹æ®Šçš„å›¾æ ‡ã€‚è€Œåœ¨åˆ«çš„åœ°æ–¹å’Œå…¶å®ƒéª¨éª¼æ²¡ä»€ä¹ˆä¸åŒã€‚éª¨éª¼å¯ä»¥åœ¨å±‚çº§æ ‘åº•éƒ¨çš„å±æ€§é¢æ¿ä¸­è®¾ç½®é¢œè‰²ã€‚è¿™å°†ä¾¿äºåŒºåˆ†å„ä¸ªä¸åŒçš„éª¨éª¼ã€‚åœ¨ Compensation é¢æ¿ä¸­ Image å’Œ Bone æŒ‰é’®ç”¨äºè°ƒæ•´éª¨éª¼ä½†ä¿æŒå®ƒçš„å­ç‰©ä½“ï¼Œå¦‚é™„ åŠ åœ¨å®ƒä¸‹é¢çš„éª¨éª¼å’Œå›¾ç‰‡ä¸å—å½±å“ã€‚åˆ«ä¸€ä¸ªè°ƒæ•´å·²ç»åˆ›å»ºå¥½çš„éª¨éª¼çš„æ–¹æ³•ï¼Œç”¨ Create å·¥å…·é€‰è¦è°ƒæ•´çš„éª¨éª¼ï¼ŒæŒ‰ä½ Alt é”®ï¼Œ ç„¶åç‚¹å‡»æ‹–æ‹½ã€‚è¿™æ ·å¯ä»¥åœ¨æ–°çš„ä½ç½®é‡ç”»éª¨éª¼ï¼Œè€Œä¸å½±å“å®ƒçš„å­ç‰©ä½“ã€‚ åŠ¨ç”»æ¨¡å¼ Animate Modeç‚¹å‡»ç¼–è¾‘åŒºå·¦ä¸Šè§’çš„ Setup åˆ‡æ¢åˆ°åŠ¨ç”»æ¨¡å¼ã€‚åœ¨åŠ¨ç”»æ¨¡å¼ä¸‹ï¼Œå±‚çº§æ ‘ä¼šæ˜¾ç¤ºåŠ¨ç”» Animations èŠ‚ç‚¹ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰å¯ç¼–è¾‘å’ŒæŸ¥çœ‹çš„ åŠ¨ç”»ã€‚ ç”¨éª¨éª¼æ‘†å‡ºå§¿åŠ¿ï¼Œç„¶åè®¾ç½®å…³é”®å¸§åˆ›å»ºåŠ¨ç”»ã€‚å½“åŠ¨ç”»æ’­æ”¾æ—¶ï¼Œéª¨éª¼ä¼šè‡ªåŠ¨åœ¨å…³é”®å¸§ä¹‹é—´ æ·»åŠ ä¸­é—´å¸§ä»¥å®ç°å¹³æ»‘çš„è¿åŠ¨ã€‚ æ‘„å½±è¡¨ DopesheetDopesheet æŒ‰é’®å¯ä»¥ç‚¹å‡»ä»¥å±•å¼€æ‘„å½±è¡¨ï¼Œå®ƒæä¾›æ›´è¯¦ç»†çš„å…³é”®å¸§è§†å›¾ã€‚å¯ä»¥åœ¨æ‘„å½±è¡¨ ä¸­æ‹–åŠ¨å…³é”®å¸§è°ƒæ•´åŠ¨ç”»ã€‚ è®¾ç½®å…³é”®å¸§ Setting Keyframesé€šå¸¸ç¬¬ä¸€ä¸ªå…³é”®å¸§è®¾ç½®åœ¨0å¸§ä¸Šã€‚é€šè¿‡ç‚¹å‡»ä½ç§»ã€ç¼©æ”¾ã€æ—‹è½¬ï¼ˆTranslate, Scale, and Rotateï¼‰å·¥å…·åçš„å…³é”®å¸§å›¾æ ‡ï¼Œè®¾ç½®å…³é”®å¸§ã€‚ç»¿è‰²è¡¨ç¤ºå½“å‰æ²¡å…³é”®å¸§ï¼Œ*è¡¨ç¤ºå€¼å·²ç»å‘ ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯æ²¡æœ‰å†æ¬¡æ·»åŠ å…³é”®å¸§ï¼Œçº¢è‰²è¡¨ç¤ºå·²ç»æ·»åŠ å…³é”®å¸§ã€‚çƒ­é”® K å¯ä»¥ä¸ºæ‰€æœ‰å‘ç”Ÿæ”¹å˜çš„å€¼è®¾ç½®å…³é”®å¸§ã€‚ çƒ­é”® L å¯ä»¥ä¸ºå½“å‰æ¿€æ´»å·¥å…·è®¾ç½®å…³é”®å¸§ã€‚ å¦‚æœ AutoKey æŒ‰é’®è¢«æŒ‰ä¸‹ï¼Œæ‰€æœ‰å‘ç”Ÿæ”¹å˜çš„å€¼éƒ½ä¼šè‡ªåŠ¨è¢«è®¾ç½®å…³é”®å¸§ã€‚ æ¥ç€ï¼Œåœ¨æ—¶é—´è½´ä¸Šé€‰åˆ°ä¸‹ä¸€ä¸ªä½ç½®ï¼Œè°ƒæ•´éª¨éª¼æ‘†å‡ºå§¿åŠ¿ï¼Œæ·»åŠ å…³é”®å¸§ã€‚ç‚¹å‡»å¹¶æ‹–åŠ¨æ—¶é—´ çº¿å°±èƒ½çœ‹åˆ°æµç•…çš„éª¨éª¼åŠ¨ç”»äº†ã€‚ åŠ¨ç”»å·¥ä½œæµç¨‹ Animation Workflowå¸¸è§çš„åŠ¨ç”»å·¥ä½œæµç¨‹ï¼Œå…ˆ K å‡ºå…³é”® pose ç„¶åå†å›å¤´ç»†åŒ–æ¶¦è‰²åŠ¨ä½œã€‚ç‚¹å‡»æ—¶é—´è½´ä¸Šæ–¹ çš„ Playback æŒ‰é’®ï¼Œåœ¨æ‰“å¼€çš„é¢æ¿ä¸­æ¿€æ´»â€œæ­¥è¿› Steppedâ€æŒ‰é’®æ¥å®ç°å…³é”® pose é¢„è§ˆã€‚å®ƒèƒ½å¤Ÿç¦ç”¨è¡¥é—´å¸§ï¼Œä»è€Œæ›´å®¹æ˜“è§‚å¯Ÿå…³é”® poseã€‚ä¸€æ—¦æ‰€æœ‰å¤§åŠ¨ä½œéƒ½åˆ›å»ºå®Œæˆï¼Œå…³é—­ Steppedï¼Œæ·»åŠ æ›´å¤š key ä¼˜åŒ–è¿‡åº¦çš„æ•ˆæœã€‚ æ›²çº¿ç¼–è¾‘å™¨ Graphæ›²çº¿ Graph æŒ‰é’®å¯ä»¥å±•å¼€æ›²çº¿ç¼–è¾‘å™¨ã€‚åœ¨æ‘„å½±è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªå…³é”®å¸§ï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºå®ƒä¸ ä¸‹ä¸€å¸§ä¹‹é—´çš„è¡¥é—´æ’å€¼æ›²çº¿ã€‚é€šè¿‡ç‚¹å‡»è´å¡å°” Bezier Curve æ›²çº¿å›¾æ ‡ï¼Œå¯åŠ¨éçº¿æ€§æ’å€¼ï¼Œè¦æƒ³ K å‡ºæ ©æ ©å¦‚ç”Ÿçš„åŠ¨ç”» è¿™æ˜¯å…³é”®æ‰€åœ¨ã€‚åœ¨æ›²çº¿ç¼–è¾‘å™¨ä¸­æ‹–åŠ¨ Bezier æ‰‹æŸ„æ”¹å˜æ’å€¼ã€‚X è½´ä»£è¡¨å½“å‰å¸§åˆ°ä¸‹ä¸€å¸§ä¹‹é—´çš„æ—¶é—´ï¼ŒY è½´ä»£è¡¨å€¼ã€‚]]></content>
      <categories>
        <category>Spine</category>
      </categories>
      <tags>
        <tag>Spine</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ã€spineã€‘åå‘åŠ¨åŠ›å­¦ Inverse Kinematics (IK)]]></title>
    <url>%2F2019%2F04%2F30%2Fspine-IK%2F</url>
    <content type="text"><![CDATA[é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨FKå·¥å…·è®¾ç½®åŠ¨ç”»ï¼Œå®ƒæ˜¯æ­£å‘åŠ¨åŠ›å­¦çš„ç¼©å†™ã€‚å½“è®¾ç½®æ‰‹éƒ¨ä½ç½®åŠ¨ç”»æ—¶ï¼ŒFKä»ä¸Šè‡³ä¸‹é©±åŠ¨ï¼Œå…ˆè½¬åŠ¨å¤§è‡‚ï¼Œå†è½¬åŠ¨å°è‡‚æ¥å®ç°ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹å®ƒèƒ½å¾ˆå¥½çš„è¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚ä½†æŸäº›ç‰¹æ®Šæƒ…å†µæ¯”å¦‚ï¼šä¸€ä¸ªåç€çš„è§’è‰²æ‰‹æ‰¶æ¡Œé¢ï¼Œæ…¢æ…¢èµ·èº«ï¼Œè¿™æ—¶FKéœ€è¦ä¸æ®µçš„è°ƒæ•´æ‰‹éƒ¨çš„ä½ç½®ï¼Œä»¥ä½¿å…¶èƒ½ä¿æŒæŒ‰åœ¨æ¡Œé¢ä¸Šã€‚è¿™å°†éœ€è¦åˆ›å»ºå¤§é‡å…³é”®å¸§æ¥å®ç°ã€‚IKå¯¹äºè¿™ç§æƒ…å†µä¼šæ›´åˆé€‚ï¼Œå®ƒæ˜¯åå‘åŠ¨åŠ›å­¦çš„ç¼©å†™ã€‚IKä»ä¸‹è‡³ä¸Šé©±åŠ¨ã€‚è®¾ç½®å¥½æ‰‹éƒ¨çš„ä½ç½®åï¼Œè§’è‰²èµ·èº«æ—¶ï¼Œæ‰‹éƒ¨ä¿æŒä¸åŠ¨ï¼Œå°è‡‚å’Œå¤§è‡‚çš„éª¨éª¼ä¼šè‡ªåŠ¨æ—‹è½¬åˆ°åˆé€‚è§’åº¦ã€‚IKä¹Ÿé€‚åˆäºå®Œæˆå…¶å®ƒä¸€äº›ä»»åŠ¡ï¼Œæ¯”å¦‚è„šéƒ¨ä¼šè¸©è¿›åœ°é¢çš„è¡Œèµ°åŠ¨ç”»ï¼ˆä¾‹å¦‚æ¸¸æˆåœºæ™¯ä¸­æœ‰ä¸€å…³æ²¼æ³½åœ°ï¼‰ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶é€šè¿‡è°ƒæ•´IKç›®æ ‡ï¼ˆIK targetï¼‰å®ç°è§’è‰²åœ¨ä¸å¹³å¦çš„åœ°é¢ä¸Šè¡Œèµ°çš„æ•ˆæœï¼Œç­‰ç­‰ã€‚åœ¨Spineä¸­å¯¹éª¨éª¼çš„æ§åˆ¶å¯ä»¥æ˜¯FKï¼Œå¯ä»¥æ˜¯IKï¼Œå¯ä»¥æ˜¯FK/IKä¸¤è€…æ··åˆçš„æ•ˆæœã€‚å½“ç„¶ä¹Ÿå¯ä»¥åœ¨åŠ¨ç”»ä¸­å®ç°FKå’ŒIKä¹‹é—´çš„å¹³æ»‘è¿‡åº¦ã€‚ï¼ˆä¼ è¯´ä¸­çš„FK/IKæ— ç¼è½¬æ¢ï¼‰ è£…é… Setupè¦ä½¿ç”¨IKï¼ˆIKçº¦æŸï¼‰éœ€è¦ä¸‰ä¸ªéª¨éª¼ï¼šçˆ¶éª¨éª¼ã€å­éª¨éª¼ã€ç›®æ ‡éª¨éª¼ã€‚å­éª¨éª¼å¿…é¡»æ˜¯çˆ¶éª¨éª¼çš„å­çº§ï¼Œä½†å¯ä»¥ä¸æ˜¯ç›´æ¥çš„çˆ¶å­å…³ç³»ã€‚ç›®æ ‡éª¨éª¼ä¸èƒ½æ˜¯çˆ¶éª¨éª¼çš„å­çº§ã€‚å¼€å§‹åˆ›å»ºIKçº¦æŸï¼Œé€‰ä¸­çˆ¶éª¨éª¼ã€å­éª¨éª¼ï¼Œåœ¨å±‚çº§æ ‘ç›®å½•ä¸­ç‚¹å‡»çº¦æŸ(Constraints)ï¼Œç‚¹å‡»åˆ›å»ºæ–°IKçº¦æŸ(New IK Constraint)ï¼Œç„¶åé€‰æ‹©ä¸€ä¸ªå·²ç»å­˜åœ¨çš„éª¨éª¼(çˆ¶éª¨éª¼çš„å­çº§ä¸èƒ½é€‰)ä½œä¸ºç›®æ ‡ï¼Œæˆ–æ˜¯ç‚¹å‡»åœºæ™¯ä¸­ç©ºç™½åŒºåˆ›å»ºä¸€ä¸ªæ–°éª¨éª¼ä½œä¸ºç›®æ ‡ã€‚IKçº¦æŸä¼šä¸æ–­çš„è°ƒæ•´çˆ¶éª¨éª¼ã€å­éª¨éª¼çš„æ—‹è½¬å€¼ï¼Œä»¥ä½¿å­éª¨éª¼çš„æœ«ç«¯é’‰åœ¨ç›®æ ‡éª¨éª¼ä¸Šã€‚çˆ¶éª¨éª¼ä¸å­éª¨éª¼çš„å¼¯æ›²æ–¹å‘å¯ä»¥é€šè¿‡IKçº¦æŸ(IK constraint)çš„å±æ€§æ¥æ”¹å˜ã€‚å½“ä¸€ä¸ªéª¨éª¼çš„æ—‹è½¬å±æ€§è¢«IKçº¦æŸ(IK constraint)æ‰€æ§åˆ¶æ—¶ï¼Œå®ƒå°†æ˜¾ç¤ºä¸ºä¸€ä¸ªä¸­ç©ºçš„éª¨éª¼ï¼Œä»¥è¡¨æ˜æŸäº›å˜æ¢æ“ä½œï¼Œç°åœ¨ä¸èƒ½æ‰‹åŠ¨æ§åˆ¶äº†ã€‚ FK/IKèåˆ Mixing FK/IKIKçš„æ··åˆ(Mix)æ»‘åŠ¨æ¡ï¼Œç”¨äºæ§åˆ¶éª¨éª¼å—å½±å“çš„ç¨‹åº¦ã€‚å½“å€¼ä¸º0è¡¨ç¤ºå½“å‰éª¨éª¼å®Œå…¨å¤„äºFKæ§åˆ¶ï¼Œå½“å€¼ä¸º100è¡¨ç¤ºå½“å‰éª¨éª¼å®Œå…¨å¤„äºIKæ§åˆ¶ã€‚å½“å€¼ä¸º0åˆ°100ä¹‹é—´ï¼Œè¡¨ç¤ºéª¨éª¼åŒæ—¶å—åˆ°FKå’ŒIKçš„æ§åˆ¶ã€‚ä¸¤æ¡è¾…åŠ©çº¿åˆ†åˆ«è¡¨ç¤ºï¼ŒFKçš„ä½ç½®å’ŒIKçš„ä½ç½®ã€‚é€šå¸¸åœ¨ä¸€ä¸ªåŠ¨ç”»ä¸­åªéœ€è¦ä¸ºFK/IKåš0åˆ°100ä¹‹é—´çš„ç®€å•è¿‡æ¸¡ã€‚æ€»ä¹‹åœ¨æŸäº›æƒ…å†µä¸‹ä½¿ç”¨FK/IKæ··åˆåŠŸèƒ½æ¯”ç›´æ¥Kå¸§è¦æ–¹ä¾¿çš„å¤šã€‚ä¾‹å¦‚ï¼šç”¨IKåšäº†ä¸€æ®µæ‰‹è‡‚ä¸Šä¸‹æŒ¥åŠ¨çš„åŠ¨ç”»ï¼Œæ¥ç€è¦ç”¨FKåšå¦ä¸€éƒ¨åˆ†ã€‚è¿™æ—¶å…³æ‰IKçº¦æŸçš„æ˜¾ç¤ºå¼€å…³ï¼ŒIKçš„æ§åˆ¶æ•ˆæœå°±ä¼šè¢«åœç”¨ï¼Œè¿™æ ·æ›´æ–¹ä¾¿å°†FKå¯¹é½åˆ°IKçš„ä½ç½®ã€‚å½“IKçº¦æŸè¢«åœç”¨ï¼Œéª¨éª¼å°†å®Œå…¨å¤„äºFKçŠ¶æ€ï¼Œå¹¶ä¸”å¯ä»¥åƒé€šå¸¸é‚£æ ·è¿›è¡Œå˜æ¢åˆ¶ä½œã€‚æ³¨æ„ï¼šå½“IKçº¦æŸåœç”¨æ—¶ï¼Œæ­¤çº¦æŸå½±å“çš„éª¨éª¼ä¸‹çš„é™„å±èµ„æºå°†å˜ä¸ºä¸å¯ç¼–è¾‘ã€‚ è®¾ç½®åŠ¨ç”» Animatingå½“åœ¨åŠ¨ç”»æ¨¡å¼ä¸‹æ”¹å˜äº†å¼¯æ›²(bend)æˆ–æ··åˆ(mix)å±æ€§çš„å€¼ï¼Œçº¦æŸèŠ‚ç‚¹å‰çš„å°é’¥åŒ™å°±ä¼šå˜æˆ*ã€‚ç‚¹å‡»å°é’¥åŒ™å›¾æ ‡ï¼Œå°†åŒæ—¶ä¸ºå¼¯æ›²(bend)å’Œæ··åˆ(mix)å±æ€§åˆ›å»ºå…³é”®å¸§ï¼Œå®ƒä»¬é»˜è®¤æ˜¯åŒæ—¶åˆ›å»ºçš„æ²¡æ³•åˆ†å¼€ã€‚è®¾ç½®æ··åˆ(mix)å±æ€§çš„å…³é”®å¸§ï¼Œé€šå¸¸ç”¨äºåœ¨åŠ¨ç”»ä¸­æ§åˆ¶IKçš„èµ·æ•ˆå’Œå¤±æ•ˆã€‚åœ¨æ›²çº¿ç¼–è¾‘å™¨ä¸­ï¼Œå¯ä»¥é€šè¿‡ä¸€æ ¹æ›²çº¿æ¥æ§åˆ¶å®ƒï¼Œå› æ­¤æ··åˆ(mix)å±æ€§çš„è¿‡æ¸¡æ•ˆæœæ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ã€‚]]></content>
      <categories>
        <category>Spine</category>
      </categories>
      <tags>
        <tag>Spine</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity Spine æºç è§£æ]]></title>
    <url>%2F2019%2F04%2F28%2Fspine%2F</url>
    <content type="text"><![CDATA[æ¦‚å¿µå…ˆæ¥ä»‹ç»ä¸‹ spine ä¸­çš„ä¸€äº›æœ¯è¯­å’Œæ¦‚å¿µ Bone éª¨éª¼spine æ˜¯éª¨éª¼ç¼–è¾‘å™¨,æ‰€ä»¥éª¨éª¼æ˜¯åŸºç¡€ã€‚æ¯ä¸ªéª¨éª¼éƒ½ä¼šæœ‰æ—‹è½¬ï¼Œç¼©æ”¾ï¼Œä½ç§»çš„å±æ€§ã€‚ç„¶åéª¨éª¼å¯ä»¥æœ‰å­èŠ‚ç‚¹ï¼Œæœ€ç»ˆå½¢æˆäº†ä¸€ä¸ªæ ‘å‹ç»“æ„ã€‚å¯ä»¥å¯¹åº”2dx é‡Œé¢çš„ node Slot æ’æ§½éª¨éª¼ä¸Šçš„ä¸€ä¸ªæŒ‚è½½ç‚¹ã€‚ä¸æ˜¯æ‰€æœ‰çš„éª¨éª¼ä¸Šéƒ½èƒ½æ”¾ç½®ä¸œè¥¿çš„ï¼Œå› ä¸ºå¾ˆå¤šéª¨éª¼å…¶å®åªå‚ä¸è®¡ç®—ï¼ŒçœŸæ­£é‡è¦çš„éª¨éª¼ï¼Œä¹Ÿå°±æ˜¯éœ€è¦æŒ‚è½½å…¶ä»–ä¸œè¥¿çš„éª¨éª¼ä¸Šå¿…é¡»æ”¾ç½®æ’æ§½ã€‚slot åªæ˜¯ç”¨æ¥æ ‡è®°ç‰¹æ®Šçš„éª¨éª¼ä½ç½®ï¼Œæœ¬èº«åªæœ‰ä¸€ä¸ªé¢œè‰²å±æ€§ï¼Œä¹Ÿå¯ä»¥è¯´ï¼Œé‡è¦çš„éª¨éª¼èŠ‚ç‚¹å¯ä»¥ç§°ä¸º slotã€‚ Attachment é™„ä»¶æŒ‚åœ¨æ’æ§½ä¸Šçš„å†…å®¹ï¼Œå¯ä»¥æ˜¯å›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥æ˜¯åˆ¤å®šåŒºåŸŸï¼Œåªè¦æ˜¯ä½ èƒ½æƒ³åˆ°çš„ä¸œè¥¿ï¼Œéƒ½å¯ä»¥å½“æˆé™„ä»¶ã€‚ Draw order æç”»é¡ºåºéª¨æ¶ä¸Šæ’æ§½çš„ä¸€ä¸ªé¡ºåºåˆ—è¡¨ã€‚ç”¨æ¥æ§åˆ¶æç”»çš„å…ˆåé¡ºåºã€‚ Animation åŠ¨ç”»åŸºäºæ—¶é—´è½´çš„ä¸€ä¸ªéª¨éª¼çŠ¶æ€åˆ—è¡¨ã€‚ Skin çš®è‚¤ä¸€å¥—é™„ä»¶çš„é›†åˆï¼Œç±»ä¼¼äºæ¢è£…ã€‚ Bounding Box è¾¹ç•Œæ¡†ç”¨æ¥æŒ‡å®šéª¨éª¼ä¸Šçš„è¾¹ç•Œçš„å¤šè¾¹å½¢çš„åŒºåŸŸã€‚ atlas å›¾é›†è´´å›¾é›†åˆï¼Œå°å›¾ç‰‡åˆå¹¶åœ¨ä¸€èµ·ï¼Œå°±æˆäº†å›¾é›†ã€‚ å®ç°ä¸Šé¢å¤§è‡´ä»‹ç»äº†ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼Œç„¶åæˆ‘ä»¬ä»å®ç°è§’åº¦ä¸Šæ¥è¯´ä¸‹ä¸ºå•¥è¿™ä¹ˆè®¾è®¡ã€‚é¦–å…ˆï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦ä¸€ä¸ªéª¨éª¼ç³»ç»Ÿã€‚äºæ˜¯ï¼Œæˆ‘ä»¬å°±è®¾è®¡äº†ä¸€ä¸ªæ ‘çŠ¶çš„éª¨æ¶ï¼Œæ¯ä¸ªèŠ‚ç‚¹å°±æ˜¯ï¼ˆBoneï¼‰ã€‚å¾ˆç®€å•å•Šï¼Œå†æƒ³ä¸‹ï¼Œéª¨éª¼ä¸Šè¦æ”¾å›¾ç‰‡å•¥çš„ï¼Œäºæ˜¯æˆ‘ä»¬å°±è¦èƒ½è®¿é—®åˆ°ç‰¹å®šçš„éª¨éª¼ï¼Œéå†å¤ªå‚»äº†ï¼Œå¥½å§ï¼Œæˆ‘ä»¬ç»™è¿™äº›éª¨éª¼åŠ ä¸ªåå­—ï¼Œè¿™æ ·å°±èƒ½è®¿é—®åˆ°å…·ä½“ éª¨éª¼äº†ï¼Œé‚£è¿™äº›åå­—å°±å« slotã€‚å¥½å§ï¼Œå¯èƒ½æœ‰äº›äººè§‰å¾—ï¼Œslot å’Œ bone æœ¬è´¨ä¸Šä¸€æ ·ï¼Œä¸ºå•¥éœ€è¦åˆ†å¼€å‘¢ï¼Œæ²¡å¿…è¦çš„ã€‚æˆ‘åªèƒ½è¯´äº‹æƒ…å…¶å®å¹¶ä¸ç®€å•ï¼Œæ¥æƒ³ä¸‹ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªå®Œç¾çš„éª¨æ¶ï¼Œå›¾ç‰‡ä¹Ÿåœ¨åº”è¯¥åœ¨çš„éª¨éª¼ä¸Šäº†ã€‚é‚£æˆ‘ä»¬è¯¥å¦‚ä½•æ˜¾ç¤ºå›¾ç‰‡ä¹ˆï¼Ÿéå†ä¹ˆï¼Œä»æ ¹ç»“ç‚¹å¼€å§‹ï¼Œä¸€ç›´åˆ°æœ€ä¸‹å±‚çš„èŠ‚ç‚¹ï¼Œä¸ç®¡ä½ ç”¨å•¥æ’åºï¼Œè¿™ä¸ªé¡ºåºæ˜¯å›ºå®šçš„ï¼Œä½†æ˜¯ç°å®æ€»æ˜¯å¾ˆæ®‹é…·ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä¸åœè°ƒæ•´å›¾ç‰‡æç”»çš„é¡ºåºï¼Œä¹Ÿå°±æ˜¯è°ƒæ•´æ ‘çš„èŠ‚ç‚¹æ’åºï¼Œå•Šï¼Œå¥½éº»çƒ¦ã€‚é‚£æ€ä¹ˆåŠï¼Œæˆ‘ä»¬æŒ‡å®šä¸‹éª¨éª¼æç”»çš„é¡ºåºå§ï¼ˆDraw orderï¼‰ï¼Œè¿™äº›ç‰¹å®šçš„éª¨éª¼ä¹Ÿå°±æ˜¯ slotã€‚ä½ çœ‹ï¼Œè¿™ä¸‹å®Œç¾äº†ï¼Œä¹Ÿå°±æ˜¯ bone ç”¨æ¥è®¡ç®—ä½ç½®ï¼Œslot ç”¨æ¥æ§åˆ¶æç”»ã€‚å®Œç¾çš„éª¨éª¼ç³»ç»Ÿï¼Œä¸€å®šè¦æœ‰ç¢°æ’åŒºåŸŸï¼ˆbounding boxï¼‰ï¼Œè¿™å’Œå›¾ç‰‡å·®ä¸å¤š,ä¸€ä¸ªç”¨äºæ˜¾ç¤º,ä¸€ä¸ªç”¨äºè¾¹ç•Œåˆ¤æ–­,å¥½å§,é‚£å°±æŠ½è±¡æˆä¸€ä¸ªæ¦‚å¿µå«ï¼ˆp_w_uploadï¼‰ï¼Œäºæ˜¯ï¼Œslot ä¸Šå°±å¯ä»¥é™„åŠ ä¸åŒçš„ p_w_upload äº†ã€‚ç»ˆäºå¯ä»¥æ¢é™„ä»¶äº†ï¼Œä½†æ˜¯ä¸€ä¸ªä¸€ä¸ªæ¢å¥½ç´¯ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬æŠŠä¸€ç»„é™„ä»¶åˆåœ¨ä¸€èµ·ï¼Œç»„æˆäº† skinã€‚è¿™ä¸‹ç®€å•äº†ï¼Œä¸€æ¢ skinï¼Œæ•´ä¸ªä¸–ç•Œå°±å˜æ ·äº†ã€‚å•Šï¼Œåšç€åšç€ï¼Œå°±å‘ç°å›¾ç‰‡å¤ªå¤šäº†ï¼Œè¦ä¼˜åŒ–å•Šã€‚æ€ä¹ˆåŠï¼Œç®€å•ï¼ŒæŠŠå°å›¾ç‰‡åˆåœ¨ä¸€èµ·ï¼Œæ¯ä¸ªå›¾ç‰‡å¯¹åº”äº†ä¸€ä¸ªå¤§å›¾é‡Œé¢çš„ä¸€ä¸ªåŒºåŸŸï¼Œè¿™å°±æ˜¯ atlasã€‚Spine-Unityä½¿ç”¨Unityçš„MeshRendererå’ŒMeshFiterç»„å»ºï¼Œè¿˜æœ‰æè´¨èµ„æºè¿›è¡Œæ¸²æŸ“ã€‚SkeletonRendererç±»ï¼ˆSkeletonAnimationå’ŒSkeletonAnimatorå‡ç»§æ‰¿ä¸å®ƒï¼‰ï¼Œåœ¨å®ƒçš„LateUpdateä¸­æ„å»ºMeshã€‚ç”Ÿæˆé¡¶ç‚¹ï¼Œé¢œè‰²ï¼Œä¸‰è§’å½¢ç´¢å¼•å’ŒUVç„¶åæŠŠè¿™äº›æ”¾å…¥Meshä¸­ã€‚ä»¥ä¸‹è®²è§£ä¸»è¦è¯´æ˜å¦‚ä½•æ„å»ºMeshã€‚Spineä¸€èˆ¬ä½¿ç”¨alphaæ··åˆçš„æ–¹å¼æ¥æ¸²æŸ“æ¨¡å‹ï¼Œåœ¨ä¸€ä¸ªç½‘æ ¼ä¸­ï¼Œå®ƒæ ¹æ®ç½‘æ ¼ä¸­ä¸‰è§’å½¢çš„é¡ºåºå»æ¸²æŸ“ç‰©ä½“ï¼Œç„¶åç»˜åˆ¶ä¸€ä¸ªä¸œè¥¿åœ¨å¦ä¸€ä¸ªä¸œè¥¿ä¸Šé¢ã€‚è¯¥é¡ºåºæ˜¯åœ¨Spineä¸­æ§åˆ¶æ§½çš„ç»˜åˆ¶é¡ºåºæ¥å†³å®šçš„ã€‚ä¸ºäº†è®©å¤§å®¶æ›´å¥½çš„ç†è§£æœ¬æ–‡ï¼Œå…ˆè®²è¿°æ¶‰åŠåˆ°çš„ä¸€äº›æ•°æ®ç»“æ„ï¼š12345678910public class ExposedList&lt;T&gt;: IEnumerable&lt;T&gt;&#123; public void Clear (bool clearArray = true) &#123; if (clearArray) Array.Clear(Items, 0, Items.Length); Count = 0; version++; &#125;&#125; æš´éœ²çš„é“¾è¡¨ï¼ŒåŸç†å’ŒListæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æ‰©å±•äº†ä¸€äº›æ–¹æ³•ï¼Œæ¯”å¦‚Clear(bool clearArray = true)ï¼ŒListåªèƒ½Clear()ï¼Œå°è¯•åœ¨å¤šæ‰¾ä¸€äº›å¯¹æ¯”ï¼Œä½†æ˜¯ä»£ç ä¸­å¤§éƒ¨åˆ†æ˜¯foreach,add,clearç”±äºæ—¶é—´æœ‰é™ï¼Œæš‚æ—¶ä¸å¯¹å…¶è¿›å…¥æ·±å…¥äº†è§£ã€‚ TransformMode123456789// è½¬æ¢æ¨¡å¼public enum TransformMode &#123; //0000 0 Flip Scale Rotation Normal = 0, // 0000 æ­£å¸¸ï¼Œå¹³ç§»ï¼Œæ—‹è½¬ï¼Œç¼©æ”¾ OnlyTranslation = 7, // 0111 åªå¹³ç§» NoRotationOrReflection = 1, // 0001 ä¸æ—‹è½¬æˆ–æ˜ åƒ NoScale = 2, // 0010 ä¸ç¼©æ”¾ NoScaleOrReflection = 6, // 0110 ä¸ç¼©æ”¾æˆ–æ˜ åƒ&#125; BoneData12345678public class BoneData &#123; internal int index; // éª¨éª¼ç´¢å¼•ï¼Œç¬¬å‡ æ ¹éª¨éª¼ internal string name;// éª¨éª¼åï¼Œå…·æœ‰å”¯ä¸€æ€§ internal BoneData parent;//çˆ¶äº²éª¨éª¼ internal float length; // éª¨éª¼é•¿åº¦ï¼Œä¸å¤ªç†è§£ internal float x, y, rotation, scaleX = 1, scaleY = 1, shearX, shearY;// ä½ç§»ï¼Œæ—‹è½¬ï¼Œç¼©æ”¾ï¼Œè£å‰ª internal TransformMode transformMode = TransformMode.Normal;//å˜æ¢æ¨¡å¼&#125; BlendMode1234567// æ··åˆæ¨¡å¼public enum BlendMode &#123; Normal, Additive,// åŠ æ³• Multiply, // ä¹˜æ³• Screen // å±å¹•&#125; SlotData1234567891011// æ§½æ•°æ®class SlotData &#123; internal int index; internal string name; internal BoneData boneData; internal float r = 1, g = 1, b = 1, a = 1; internal float r2 = 0, g2 = 0, b2 = 0; internal bool hasSecondColor = false; internal string attachmentName; // é™„ä»¶å internal BlendMode blendMode;&#125; IKContraintData123456789// IKçº¦æŸ(åŠ¨åŠ›å­¦)class IkConstraintData &#123; internal string name; internal int order; internal List&lt;BoneData&gt; bones = new List&lt;BoneData&gt;(); internal BoneData target; internal int bendDirection = 1; internal float mix = 1;&#125; TransformConstraintData12345678910// å˜æ¢çº¦æŸæ•°æ®class TransformConstraintData &#123; internal string name; internal int order; // å‘½ä»¤ internal ExposedList&lt;BoneData&gt; bones = new ExposedList&lt;BoneData&gt;(); internal BoneData target; internal float rotateMix, translateMix, scaleMix, shearMix; internal float offsetRotation, offsetX, offsetY, offsetScaleX, offsetScaleY, offsetShearY; internal bool relative, local;//åæ ‡ç³»&#125; PathConstraintData123456789101112// è·¯å¾„çº¦æŸclass PathConstraintData &#123; internal string name; internal int order; internal ExposedList&lt;BoneData&gt; bones = new ExposedList&lt;BoneData&gt;(); internal SlotData target; internal PositionMode positionMode; internal SpacingMode spacingMode; internal RotateMode rotateMode; internal float offsetRotation; internal float position, spacing, rotateMix, translateMix;&#125; SkeletonData123456789101112131415// éª¨æ¶æ•°æ®class SkeletonData &#123; internal string name; internal ExposedList&lt;BoneData&gt; bones = new ExposedList&lt;BoneData&gt;(); // Ordered parents first internal ExposedList&lt;SlotData&gt; slots = new ExposedList&lt;SlotData&gt;(); // Sè£…é…ç»˜åˆ¶é¡ºåº internal ExposedList&lt;Skin&gt; skins = new ExposedList&lt;Skin&gt;(); // é™„ä»¶é›†åˆ internal Skin defaultSkin; internal ExposedList&lt;EventData&gt; events = new ExposedList&lt;EventData&gt;(); internal ExposedList&lt;Animation&gt; animations = new ExposedList&lt;Animation&gt;(); // åŠ¨ç”»åˆ—è¡¨ internal ExposedList&lt;IkConstraintData&gt; ikConstraints = new ExposedList&lt;IkConstraintData&gt;(); internal ExposedList&lt;TransformConstraintData&gt; transformConstraints = new ExposedList&lt;TransformConstraintData&gt;(); internal ExposedList&lt;PathConstraintData&gt; pathConstraints = new ExposedList&lt;PathConstraintData&gt;(); internal float width, height; internal string version, hash;&#125; Skeleton(éª¨æ¶)1234567891011121314151617// éª¨æ¶ï¼Œæ€»æ„Ÿè§‰æ•°æ®æœ‰å†—ä½™ï¼Œåœ¨çœ‹çœ‹å§class Skeleton &#123; internal SkeletonData data; internal ExposedList&lt;Bone&gt; bones; internal ExposedList&lt;Slot&gt; slots; internal ExposedList&lt;Slot&gt; drawOrder; // ç”»çš„å‘½ä»¤æ§½ internal ExposedList&lt;IkConstraint&gt; ikConstraints; internal ExposedList&lt;TransformConstraint&gt; transformConstraints; internal ExposedList&lt;PathConstraint&gt; pathConstraints; internal ExposedList&lt;IUpdatable&gt; updateCache = new ExposedList&lt;IUpdatable&gt;(); internal ExposedList&lt;Bone&gt; updateCacheReset = new ExposedList&lt;Bone&gt;(); internal Skin skin; internal float r = 1, g = 1, b = 1, a = 1; internal float time; internal bool flipX, flipY; internal float x, y;&#125; Bone(éª¨å¤´)12345678910111213class Bone : IUpdatable &#123; static public bool yDown; internal BoneData data; internal Skeleton skeleton; internal Bone parent; internal ExposedList&lt;Bone&gt; children = new ExposedList&lt;Bone&gt;(); internal float x, y, rotation, scaleX, scaleY, shearX, shearY; internal float ax, ay, arotation, ascaleX, ascaleY, ashearX, ashearY; internal bool appliedValid; internal float a, b, worldX; // æƒé‡ï¼Œåæ ‡ internal float c, d, worldY; internal bool sorted;&#125; SubmeshInstruction12345678910111213141516171819202122// å­ç½‘æ ¼çº¦æŸstruct SubmeshInstruction &#123; public Skeleton skeleton; public int startSlot; public int endSlot; public Material material; public bool forceSeparate; // å¼ºåˆ¶åˆ†ç¦» public int preActiveClippingSlotSource; #if SPINE_TRIANGLECHECK // ç¼“å­˜çš„å€¼ï¼Œå› ä¸ºå®ƒä»¬æ˜¯åœ¨ç”ŸæˆæŒ‡ä»¤çš„è¿‡ç¨‹ä¸­ç¡®å®šçš„ï¼Œ // but could otherwise be pulled from accessing attachments, checking materials and counting tris and verts. public int rawTriangleCount; public int rawVertexCount; public int rawFirstVertexIndex; public bool hasClipping; #endif /// &lt;summary&gt;The number of slots in this SubmeshInstruction's range. Not necessarily the number of attachments.&lt;/summary&gt; public int SlotCount &#123; get &#123; return endSlot - startSlot; &#125; &#125;&#125; RegionAttachment(æ˜¾ç¤ºçº¹ç†åŒºåŸŸçš„é™„ä»¶)123456789101112131415class RegionAttachment : Attachment, IHasRendererObject &#123; public const int BLX = 0; // bottom left x public const int BLY = 1; // bottom left y public const int ULX = 2; // upper left x public const int ULY = 3; // upper left y public const int URX = 4; // upper right x public const int URY = 5; // upper right y public const int BRX = 6; // bottom right x public const int BRY = 7; // bottom right y internal float x, y, rotation, scaleX = 1, scaleY = 1, width, height; internal float regionOffsetX, regionOffsetY, regionWidth, regionHeight, regionOriginalWidth, regionOriginalHeight; internal float[] offset = new float[8], uvs = new float[8]; internal float r = 1, g = 1, b = 1, a = 1;&#125; MeshAttachment(ä½¿ç”¨ç½‘æ ¼æ˜¾ç¤ºçº¹ç†åŒºåŸŸçš„é™„ä»¶)123456789class MeshAttachment : VertexAttachment, IHasRendererObject &#123; internal float regionOffsetX, regionOffsetY, regionWidth, regionHeight, regionOriginalWidth, regionOriginalHeight; private MeshAttachment parentMesh; internal float[] uvs, regionUVs; internal int[] triangles; internal float r = 1, g = 1, b = 1, a = 1; internal int hulllength; internal bool inheritDeform;&#125; BuildMeshWithArrays(æ„å»ºé¡¶ç‚¹ç­‰æ•°æ®ï¼Œæ¸²æŸ“å¸§ä¸­åªè´Ÿè´£æ¸²æŸ“)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266// å½“ä¸æ¶‰åŠå‰ªåˆ‡æ—¶ï¼Œä½¿ç”¨è¿™ç§æ›´å¿«çš„æ–¹æ³•ã€‚public void BuildMeshWithArrays(SkeletonRendererInstruction instruction, bool updateTriangles)&#123; var settings = this.settings; int totalVertexCount = instruction.rawVertexCount; // æ‰©å®¹ &#123; if (totalVertexCount &gt; vertexBuffer.Items.Length) &#123; // Manual ExposedList.Resize() Array.Resize(ref vertexBuffer.Items, totalVertexCount); Array.Resize(ref uvBuffer.Items, totalVertexCount); Array.Resize(ref colorBuffer.Items, totalVertexCount); &#125; vertexBuffer.Count = uvBuffer.Count = colorBuffer.Count = totalVertexCount; &#125; // Populate Verts Color32 color = default(Color32); int vertexIndex = 0; var tempVerts = this.tempVerts; Vector3 bmin = this.meshBoundsMin; Vector3 bmax = this.meshBoundsMax; var vbi = vertexBuffer.Items; var ubi = uvBuffer.Items; var cbi = colorBuffer.Items; int lastSlotIndex = 0; // drawOrder[endSlot] is excluded for (int si = 0, n = instruction.submeshInstructions.Count; si &lt; n; si++) &#123; var submesh = instruction.submeshInstructions.Items[si]; // é€šè¿‡éª¨éª¼çš„[startSlot,endSlot)æ¥æ¸²æŸ“ç½‘æ ¼ var skeleton = submesh.skeleton; // éª¨éª¼ var skeletonDrawOrderItems = skeleton.drawOrder.Items; // éª¨éª¼å‘½ä»¤æ§½ float a = skeleton.a * 255, r = skeleton.r, g = skeleton.g, b = skeleton.b; int endSlot = submesh.endSlot; int startSlot = submesh.startSlot; lastSlotIndex = endSlot; if (settings.tintBlack) &#123; // æ˜¯ä¸æ˜¯æµ…é»‘è‰²æ•ˆæœï¼Œå¢åŠ ä¸¤å€é¡¶ç‚¹æ¥å®ç°çš„ Vector2 rg, b2; int vi = vertexIndex; b2.y = 1f; &#123; if (uv2 == null) &#123; uv2 = new ExposedList&lt;Vector2&gt;(); uv3 = new ExposedList&lt;Vector2&gt;(); &#125; if (totalVertexCount &gt; uv2.Items.Length) &#123; // Manual ExposedList.Resize() Array.Resize(ref uv2.Items, totalVertexCount); Array.Resize(ref uv3.Items, totalVertexCount); &#125; uv2.Count = uv3.Count = totalVertexCount; &#125; var uv2i = uv2.Items; var uv3i = uv3.Items; for (int slotIndex = startSlot; slotIndex &lt; endSlot; slotIndex++) &#123; var slot = skeletonDrawOrderItems[slotIndex]; var attachment = slot.attachment; rg.x = slot.r2; //r rg.y = slot.g2; //g b2.x = slot.b2; //b var regionAttachment = attachment as RegionAttachment; if (regionAttachment != null) &#123; uv2i[vi] = rg; uv2i[vi + 1] = rg; uv2i[vi + 2] = rg; uv2i[vi + 3] = rg; uv3i[vi] = b2; uv3i[vi + 1] = b2; uv3i[vi + 2] = b2; uv3i[vi + 3] = b2; vi += 4; &#125; else &#123; var meshAttachment = attachment as MeshAttachment; if (meshAttachment != null) &#123; int meshVertexCount = meshAttachment.worldVerticesLength; for (int iii = 0; iii &lt; meshVertexCount; iii += 2) &#123; uv2i[vi] = rg; uv3i[vi] = b2; vi++; &#125; &#125; &#125; &#125; &#125; for (int slotIndex = startSlot; slotIndex &lt; endSlot; slotIndex++) &#123; var slot = skeletonDrawOrderItems[slotIndex]; var attachment = slot.attachment; float z = slotIndex * settings.zSpacing; var regionAttachment = attachment as RegionAttachment; if (regionAttachment != null) &#123; regionAttachment.ComputeWorldVertices(slot.bone, tempVerts, 0); // æ ¹æ®æƒé‡ä¸Šä¸€ä½ç½®ï¼Œè®¡ç®—å½“å‰é¡¶ç‚¹ float x1 = tempVerts[RegionAttachment.BLX], y1 = tempVerts[RegionAttachment.BLY]; float x2 = tempVerts[RegionAttachment.ULX], y2 = tempVerts[RegionAttachment.ULY]; float x3 = tempVerts[RegionAttachment.URX], y3 = tempVerts[RegionAttachment.URY]; float x4 = tempVerts[RegionAttachment.BRX], y4 = tempVerts[RegionAttachment.BRY]; vbi[vertexIndex].x = x1; vbi[vertexIndex].y = y1; vbi[vertexIndex].z = z; vbi[vertexIndex + 1].x = x4; vbi[vertexIndex + 1].y = y4; vbi[vertexIndex + 1].z = z; vbi[vertexIndex + 2].x = x2; vbi[vertexIndex + 2].y = y2; vbi[vertexIndex + 2].z = z; vbi[vertexIndex + 3].x = x3; vbi[vertexIndex + 3].y = y3; vbi[vertexIndex + 3].z = z; // æ··åˆé¢œè‰² if (settings.pmaVertexColors) &#123; color.a = (byte)(a * slot.a * regionAttachment.a); color.r = (byte)(r * slot.r * regionAttachment.r * color.a); color.g = (byte)(g * slot.g * regionAttachment.g * color.a); color.b = (byte)(b * slot.b * regionAttachment.b * color.a); if (slot.data.blendMode == BlendMode.Additive) color.a = 0; &#125; else &#123; color.a = (byte)(a * slot.a * regionAttachment.a); color.r = (byte)(r * slot.r * regionAttachment.r * 255); color.g = (byte)(g * slot.g * regionAttachment.g * 255); color.b = (byte)(b * slot.b * regionAttachment.b * 255); &#125; cbi[vertexIndex] = color; cbi[vertexIndex + 1] = color; cbi[vertexIndex + 2] = color; cbi[vertexIndex + 3] = color; // é˜ˆå€¼ float[] regionUVs = regionAttachment.uvs; ubi[vertexIndex].x = regionUVs[RegionAttachment.BLX]; ubi[vertexIndex].y = regionUVs[RegionAttachment.BLY]; ubi[vertexIndex + 1].x = regionUVs[RegionAttachment.BRX]; ubi[vertexIndex + 1].y = regionUVs[RegionAttachment.BRY]; ubi[vertexIndex + 2].x = regionUVs[RegionAttachment.ULX]; ubi[vertexIndex + 2].y = regionUVs[RegionAttachment.ULY]; ubi[vertexIndex + 3].x = regionUVs[RegionAttachment.URX]; ubi[vertexIndex + 3].y = regionUVs[RegionAttachment.URY]; if (x1 &lt; bmin.x) bmin.x = x1; // æ½œåœ¨çš„ç¬¬ä¸€ä¸ªé™„ä»¶è¾¹ç•Œåˆå§‹åŒ–ã€‚åˆå§‹æœ€å°å€¼ä¸åº”é˜»æ­¢åˆå§‹æœ€å¤§å€¼ã€‚ä¸‹é¢çš„Yä¹Ÿæ˜¯ä¸€æ ·ã€‚ if (x1 &gt; bmax.x) bmax.x = x1; if (x2 &lt; bmin.x) bmin.x = x2; else if (x2 &gt; bmax.x) bmax.x = x2; if (x3 &lt; bmin.x) bmin.x = x3; else if (x3 &gt; bmax.x) bmax.x = x3; if (x4 &lt; bmin.x) bmin.x = x4; else if (x4 &gt; bmax.x) bmax.x = x4; if (y1 &lt; bmin.y) bmin.y = y1; if (y1 &gt; bmax.y) bmax.y = y1; if (y2 &lt; bmin.y) bmin.y = y2; else if (y2 &gt; bmax.y) bmax.y = y2; if (y3 &lt; bmin.y) bmin.y = y3; else if (y3 &gt; bmax.y) bmax.y = y3; if (y4 &lt; bmin.y) bmin.y = y4; else if (y4 &gt; bmax.y) bmax.y = y4; vertexIndex += 4; &#125; else &#123; var meshAttachment = attachment as MeshAttachment; if (meshAttachment != null) &#123; int meshVertexCount = meshAttachment.worldVerticesLength; if (tempVerts.Length &lt; meshVertexCount) this.tempVerts = tempVerts = new float[meshVertexCount]; meshAttachment.ComputeWorldVertices(slot, tempVerts); if (settings.pmaVertexColors) &#123; color.a = (byte)(a * slot.a * meshAttachment.a); color.r = (byte)(r * slot.r * meshAttachment.r * color.a); color.g = (byte)(g * slot.g * meshAttachment.g * color.a); color.b = (byte)(b * slot.b * meshAttachment.b * color.a); if (slot.data.blendMode == BlendMode.Additive) color.a = 0; &#125; else &#123; color.a = (byte)(a * slot.a * meshAttachment.a); color.r = (byte)(r * slot.r * meshAttachment.r * 255); color.g = (byte)(g * slot.g * meshAttachment.g * 255); color.b = (byte)(b * slot.b * meshAttachment.b * 255); &#125; float[] attachmentUVs = meshAttachment.uvs; // æ½œåœ¨çš„ç¬¬ä¸€ä¸ªé™„ä»¶è¾¹ç•Œåˆå§‹åŒ–ã€‚å‚è§åŒºåŸŸè¿æ¥é€»è¾‘ä¸­çš„æ¡ä»¶ã€‚ if (vertexIndex == 0) &#123; // åˆå§‹æœ€å°å€¼ä¸åº”é˜»æ­¢åˆå§‹æœ€å¤§å€¼ã€‚ // vi == vertexIndex does not always mean the bounds are fresh. It could be a submesh. Do not nuke old values by omitting the check. // Should know that this is the first attachment in the submesh. slotIndex == startSlot could be an empty slot. float fx = tempVerts[0], fy = tempVerts[1]; if (fx &lt; bmin.x) bmin.x = fx; if (fx &gt; bmax.x) bmax.x = fx; if (fy &lt; bmin.y) bmin.y = fy; if (fy &gt; bmax.y) bmax.y = fy; &#125; for (int iii = 0; iii &lt; meshVertexCount; iii += 2) &#123; float x = tempVerts[iii], y = tempVerts[iii + 1]; vbi[vertexIndex].x = x; vbi[vertexIndex].y = y; vbi[vertexIndex].z = z; cbi[vertexIndex] = color; ubi[vertexIndex].x = attachmentUVs[iii]; ubi[vertexIndex].y = attachmentUVs[iii + 1]; if (x &lt; bmin.x) bmin.x = x; else if (x &gt; bmax.x) bmax.x = x; if (y &lt; bmin.y) bmin.y = y; else if (y &gt; bmax.y) bmax.y = y; vertexIndex++; &#125; &#125; &#125; &#125; &#125; this.meshBoundsMin = bmin; this.meshBoundsMax = bmax; this.meshBoundsThickness = lastSlotIndex * settings.zSpacing; int submeshInstructionCount = instruction.submeshInstructions.Count; submeshes.Count = submeshInstructionCount; // æ·»åŠ ä¸‰è§’å½¢ if (updateTriangles) &#123; // Match submesh buffers count with submeshInstruction count. if (this.submeshes.Items.Length &lt; submeshInstructionCount) &#123; this.submeshes.Resize(submeshInstructionCount); for (int i = 0, n = submeshInstructionCount; i &lt; n; i++) &#123; var submeshBuffer = this.submeshes.Items[i]; if (submeshBuffer == null) this.submeshes.Items[i] = new ExposedList&lt;int&gt;(); else submeshBuffer.Clear(false); &#125; &#125; var submeshInstructionsItems = instruction.submeshInstructions.Items; // This relies on the resize above. // Fill the buffers. int attachmentFirstVertex = 0; for (int smbi = 0; smbi &lt; submeshInstructionCount; smbi++) &#123; var submeshInstruction = submeshInstructionsItems[smbi]; var currentSubmeshBuffer = this.submeshes.Items[smbi]; &#123; //submesh.Resize(submesh.rawTriangleCount); int newTriangleCount = submeshInstruction.rawTriangleCount; if (newTriangleCount &gt; currentSubmeshBuffer.Items.Length) Array.Resize(ref currentSubmeshBuffer.Items, newTriangleCount); else if (newTriangleCount &lt; currentSubmeshBuffer.Items.Length) &#123; // Zero the extra. var sbi = currentSubmeshBuffer.Items; for (int ei = newTriangleCount, nn = sbi.Length; ei &lt; nn; ei++) sbi[ei] = 0; &#125; currentSubmeshBuffer.Count = newTriangleCount; &#125; var tris = currentSubmeshBuffer.Items; int triangleIndex = 0; var skeleton = submeshInstruction.skeleton; var skeletonDrawOrderItems = skeleton.drawOrder.Items; for (int a = submeshInstruction.startSlot, endSlot = submeshInstruction.endSlot; a &lt; endSlot; a++) &#123; var attachment = skeletonDrawOrderItems[a].attachment; if (attachment is RegionAttachment) &#123; tris[triangleIndex] = attachmentFirstVertex; tris[triangleIndex + 1] = attachmentFirstVertex + 2; tris[triangleIndex + 2] = attachmentFirstVertex + 1; tris[triangleIndex + 3] = attachmentFirstVertex + 2; tris[triangleIndex + 4] = attachmentFirstVertex + 3; tris[triangleIndex + 5] = attachmentFirstVertex + 1; triangleIndex += 6; attachmentFirstVertex += 4; continue; &#125; var meshAttachment = attachment as MeshAttachment; if (meshAttachment != null) &#123; int[] attachmentTriangles = meshAttachment.triangles; for (int ii = 0, nn = attachmentTriangles.Length; ii &lt; nn; ii++, triangleIndex++) tris[triangleIndex] = attachmentFirstVertex + attachmentTriangles[ii]; attachmentFirstVertex += meshAttachment.worldVerticesLength &gt;&gt; 1; // length/2; &#125; &#125; &#125; &#125;&#125; ä¸Šè¿°æ˜¯æ„é€ Meshæ–¹æ³•ã€‚ SpineMesh.cs123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263#region Step 3 : Transfer vertex and triangle data to UnityEngine.Meshpublic void FillVertexData (Mesh mesh) &#123; var vbi = vertexBuffer.Items; var ubi = uvBuffer.Items; var cbi = colorBuffer.Items; // Zero the extra. &#123; int listCount = vertexBuffer.Count; int arrayLength = vertexBuffer.Items.Length; var vector3zero = Vector3.zero; for (int i = listCount; i &lt; arrayLength; i++) vbi[i] = vector3zero; &#125; // Set the vertex buffer. &#123; mesh.vertices = vbi; mesh.uv = ubi; mesh.colors32 = cbi; if (float.IsInfinity(meshBoundsMin.x)) &#123; // meshBoundsMin.x == BoundsMinDefault // == doesn't work on float Infinity constants. mesh.bounds = new Bounds(); &#125; else &#123; //mesh.bounds = ArraysMeshGenerator.ToBounds(meshBoundsMin, meshBoundsMax); Vector2 halfSize = (meshBoundsMax - meshBoundsMin) * 0.5f; mesh.bounds = new Bounds &#123; center = (Vector3)(meshBoundsMin + halfSize), extents = new Vector3(halfSize.x, halfSize.y, meshBoundsThickness * 0.5f) &#125;; &#125; &#125; &#123; int vertexCount = this.vertexBuffer.Count; if (settings.addNormals) &#123; int oldLength = 0; if (normals == null) normals = new Vector3[vertexCount]; else oldLength = normals.Length; if (oldLength &lt; vertexCount) &#123; Array.Resize(ref this.normals, vertexCount); var localNormals = this.normals; for (int i = oldLength; i &lt; vertexCount; i++) localNormals[i] = Vector3.back; &#125; mesh.normals = this.normals; &#125; if (settings.tintBlack) &#123; if (uv2 != null) &#123; mesh.uv2 = this.uv2.Items; mesh.uv3 = this.uv3.Items; &#125; &#125; &#125;&#125;// é€šè¿‡ä¸Šé¢è®¾ç½®çš„ä¸‰è§’å½¢ï¼Œåœ¨è¿™é‡Œè®¾ç½®(lateUpdate)public void FillTrianglesSingle (Mesh mesh) &#123; mesh.SetTriangles(submeshes.Items[0].Items, 0, false);&#125; SkeletonRenderer.cs1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798// Generates a new UnityEngine.Mesh from the internal Skeleton.public virtual void LateUpdate () &#123; if (!valid) return; #if SPINE_OPTIONAL_RENDEROVERRIDE bool doMeshOverride = generateMeshOverride != null; if ((!meshRenderer.enabled) &amp;&amp; !doMeshOverride) return; #else const bool doMeshOverride = false; if (!meshRenderer.enabled) return; #endif var currentInstructions = this.currentInstructions; var workingSubmeshInstructions = currentInstructions.submeshInstructions; var currentSmartMesh = rendererBuffers.GetNextMesh(); // Double-buffer for performance. bool updateTriangles; if (singleSubmesh) &#123; // STEP 1. Determine a SmartMesh.Instruction. Split up instructions into submeshes. ============================================= MeshGenerator.GenerateSingleSubmeshInstruction(currentInstructions, skeleton, skeletonDataAsset.atlasAssets[0].materials[0]); // STEP 1.9. Post-process workingInstructions. ================================================================================== #if SPINE_OPTIONAL_MATERIALOVERRIDE if (customMaterialOverride.Count &gt; 0) // isCustomMaterialOverridePopulated MeshGenerator.TryReplaceMaterials(workingSubmeshInstructions, customMaterialOverride); #endif // STEP 2. Update vertex buffer based on verts from the attachments. =========================================================== meshGenerator.settings = new MeshGenerator.Settings &#123; pmaVertexColors = this.pmaVertexColors, zSpacing = this.zSpacing, useClipping = this.useClipping, tintBlack = this.tintBlack, calculateTangents = this.calculateTangents, addNormals = this.addNormals &#125;; meshGenerator.Begin(); updateTriangles = SkeletonRendererInstruction.GeometryNotEqual(currentInstructions, currentSmartMesh.instructionUsed); if (currentInstructions.hasActiveClipping) &#123; meshGenerator.AddSubmesh(workingSubmeshInstructions.Items[0], updateTriangles); &#125; else &#123; meshGenerator.BuildMeshWithArrays(currentInstructions, updateTriangles); &#125; &#125; else &#123; // STEP 1. Determine a SmartMesh.Instruction. Split up instructions into submeshes. ============================================= MeshGenerator.GenerateSkeletonRendererInstruction(currentInstructions, skeleton, customSlotMaterials, separatorSlots, doMeshOverride, this.immutableTriangles); // STEP 1.9. Post-process workingInstructions. ================================================================================== #if SPINE_OPTIONAL_MATERIALOVERRIDE if (customMaterialOverride.Count &gt; 0) // isCustomMaterialOverridePopulated MeshGenerator.TryReplaceMaterials(workingSubmeshInstructions, customMaterialOverride); #endif #if SPINE_OPTIONAL_RENDEROVERRIDE if (doMeshOverride) &#123; this.generateMeshOverride(currentInstructions); if (disableRenderingOnOverride) return; &#125; #endif updateTriangles = SkeletonRendererInstruction.GeometryNotEqual(currentInstructions, currentSmartMesh.instructionUsed); // STEP 2. Update vertex buffer based on verts from the attachments. =========================================================== meshGenerator.settings = new MeshGenerator.Settings &#123; pmaVertexColors = this.pmaVertexColors, zSpacing = this.zSpacing, useClipping = this.useClipping, tintBlack = this.tintBlack, calculateTangents = this.calculateTangents, addNormals = this.addNormals &#125;; meshGenerator.Begin(); if (currentInstructions.hasActiveClipping) meshGenerator.BuildMesh(currentInstructions, updateTriangles); else meshGenerator.BuildMeshWithArrays(currentInstructions, updateTriangles); &#125; if (OnPostProcessVertices != null) OnPostProcessVertices.Invoke(this.meshGenerator.Buffers); // STEP 3. Move the mesh data into a UnityEngine.Mesh =========================================================================== var currentMesh = currentSmartMesh.mesh; meshGenerator.FillVertexData(currentMesh); rendererBuffers.UpdateSharedMaterials(workingSubmeshInstructions); if (updateTriangles) &#123; // Check if the triangles should also be updated. meshGenerator.FillTriangles(currentMesh); meshRenderer.sharedMaterials = rendererBuffers.GetUpdatedSharedMaterialsArray(); &#125; else if (rendererBuffers.MaterialsChangedInLastUpdate()) &#123; meshRenderer.sharedMaterials = rendererBuffers.GetUpdatedSharedMaterialsArray(); &#125; meshGenerator.FillLateVertexData(currentMesh); // STEP 4. The UnityEngine.Mesh is ready. Set it as the MeshFilter's mesh. Store the instructions used for that mesh. =========== meshFilter.sharedMesh = currentMesh; currentSmartMesh.instructionUsed.Set(currentInstructions);&#125; å·¦å›¾æ˜¯é»˜è®¤çš„meshï¼Œå³å›¾æ˜¯è®¾ç½®å…³é”®å¸§çš„çŠ¶æ€ï¼Œä¸‰è§’å½¢æ•°é‡å’Œé¡¶ç‚¹æ•°é‡æ²¡æœ‰æ”¹å˜ï¼Œåªæ˜¯æ”¹å˜çš„é¡¶ç‚¹ä½ç½®ã€‚ç±»ä¼¼è’™çš®çš„åŸç†123456public static void DrawBoundingBoxes (Transform transform, Skeleton skeleton) &#123; foreach (var slot in skeleton.Slots) &#123; var bba = slot.Attachment as BoundingBoxAttachment; if (bba != null) SpineHandles.DrawBoundingBox(slot, bba, transform); &#125;&#125; ä¸ºä»€ä¹ˆå†™è¿™ä¸ªä¸œè¥¿ä¸ºäº†æ”¯æŒSkeletonAnimationåœ¨ç¼–è¾‘çŠ¶æ€ä¸‹é¢„è§ˆï¼Œæœ€åæŸ¥åˆ°çš„é—®é¢˜æ˜¯ï¼Œæ¸²æŸ“æ²¡æœ‰åˆ·æ–°ï¼Œç„¶ååœ¨æ¯å¸§åšå¼ºåˆ¶åˆ·æ–°EditorUtility.SetDirty(action.gameObject);]]></content>
      <categories>
        <category>Spine</category>
      </categories>
      <tags>
        <tag>Spine</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[éçœŸå®æ„Ÿæ¸²æŸ“]]></title>
    <url>%2F2019%2F04%2F28%2FNon-photorealistic-rendering%2F</url>
    <content type="text"><![CDATA[å¡é€šé£æ ¼çš„æ¸²æŸ“å®ç°æ–¹å¼ï¼šåŸºäºè‰²è°ƒçš„ç€è‰²æŠ€æœ¯ï¼ˆtone-based shadingï¼‰é«˜å…‰ï¼šä¸€å—å—åˆ†ç•Œæ˜æ˜¾çš„çº¯è‰²åŒºåŸŸ æ¸²æŸ“è½®å»“çº¿ åŸºäºè§‚å¯Ÿè€…è§’åº¦å’Œè¡¨é¢æ³•çº¿çš„è½®å»“çº¿æ¸²æŸ“ã€‚ä½¿ç”¨è§†è§’æ–¹å‘å’Œè¡¨é¢æ³•çº¿çš„ç‚¹ä¹˜ç»“æœå¾—åˆ°è½®å»“çº¿ä¿¡æ¯ã€‚ä¼˜ç‚¹å¯ä»¥åœ¨ä¸€ä¸ªPassä¸­å¾—åˆ°æ¸²æŸ“ç»“æœï¼Œä½†æ•ˆæœä¸å¥½ã€‚ è¿‡ç¨‹å¼å‡ ä½•è½®å»“çº¿æ¸²æŸ“ï¼Œä½¿ç”¨ä¸¤ä¸ªPassæ¸²æŸ“ã€‚ç¬¬ä¸€ä¸ªPassæ¸²æŸ“èƒŒé¢çš„é¢ç‰‡ï¼Œç¬¬äºŒä¸ªPassæ¸²æŸ“æ­£é¢çš„é¢ç‰‡ï¼Œé€‚ç”¨äºç»å¤§å¤šæ•°è¡¨é¢å¹³æ»‘çš„æ¨¡å‹ï¼Œç¼ºç‚¹ä¸é€‚åˆç±»ä¼¼ç«‹æ–¹ä½“è¿™æ ·å¹³æ•´çš„æ¨¡å‹ã€‚ åŸºäºå›¾åƒå¤„ç†çš„è½®å»“çº¿æ¸²æŸ“ï¼Œåˆ©ç”¨è¾¹ç¼˜æ£€æµ‹ï¼Œç¼ºç‚¹æ˜¯æ·±åº¦å’Œæ³•çº¿å˜åŒ–å¾ˆå°çš„è½®å»“æ— æ³•è¢«æ£€æµ‹å‡ºæ¥ åŸºäºè½®å»“è¾¹æ£€æµ‹çš„è½®å»“çº¿æ¸²æŸ“ï¼Œæ£€æŸ¥æ˜¯å¦æ˜¯è½®å»“è¾¹çš„å…¬å¼ï¼š$(n_0 \cdot v &gt; 0) \neq (n_1 \cdot v &gt; 0)$å…¶ä¸­ï¼Œ$n_0$å’Œ$n_1$åˆ†åˆ«è¡¨ç¤ºä¸¤ä¸ªç›¸é‚»ä¸‰è§’é¢ç‰‡çš„æ³•çº¿ï¼Œvæ˜¯ä»è§†è§’åˆ°è¯¥è¾¹ä¸Šä»»æ„é¡¶ç‚¹çš„æ–¹å‘ã€‚ä¸Šè¿°å…¬å¼çš„æœ¬è´¨åœ¨ä¸æ£€æŸ¥ä¸¤ä¸ªç›¸é‚»é¢ç‰‡æ˜¯å¦ä¸€ä¸ªæœæ­£é¢ã€ä¸€ä¸ªæœèƒŒé¢ã€‚ æ·»åŠ é«˜å…‰Blinn-Phongä½¿ç”¨æ³•çº¿ç‚¹ä¹˜å…‰ç…§æ–¹å‘ä»¥åŠè§†è§’æ–¹å‘å’Œçš„ä¸€åŠï¼Œå†å’Œå¦ä¸€ä¸ªå‚æ•°æŒ‡æ•°æ“ä½œå¾—åˆ°é«˜å…‰åå°„ç³»æ•°ã€‚ä»£ç å¦‚ä¸‹ï¼š1float spec = pow(max(0, dot(normal, halfDir)), _Gloss) å¯¹äºå¡é€šæ¸²æŸ“éœ€è¦çš„é«˜å…‰åå°„å…‰ç…§æ¨¡å‹ï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦è®¡ç®—normalå’ŒhalfDirçš„ç‚¹ä¹˜ç»“æœï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬æŠŠè¯¥å€¼å’Œä¸€ä¸ªé˜ˆå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå°äºè¯¥é˜ˆå€¼ï¼Œåˆ™é«˜å…‰åå°„ç³»æ•°ä¸º0ï¼Œå¦åˆ™è¿”å›1ã€‚12float spec = dot(worldNormal, worldHalfDir);spec = step(threshold, spec); ä½†æ˜¯ï¼Œè¿™ç§ç²—æš´çš„åˆ¤æ–­æ–¹æ³•ä¼šåœ¨é«˜å…‰åŒºåŸŸçš„è¾¹ç•Œé€ æˆé”¯é½¿ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140Shader "Zenita/Non-photo"&#123; Properties &#123; _Color ("Color Tint", Color) = (1,1,1,1) _MainTex("Main Tex", 2D) = "white"&#123;&#125; _Ramp ("Ramp Texture", 2D) = "white" &#123;&#125; // æ¼«åå°„è‰²è°ƒçš„æ¸å˜çº¹ç† _Outline("Outline", Range(0, 1)) = 0.1 // ç”¨äºæ§åˆ¶è½®å»“çº¿å®½åº¦ _OutlineColor ("Outline Color", Color) = (0,0,0,1) // è½®å»“çº¿é¢œè‰² _Specular("Specular", Color)=(1,1,1,1) // é«˜å…‰åå°„é¢œè‰² _SpecularScale("Specular Scale", Range(0, 0.1)) = 0.01 // é«˜å…‰åå°„çš„é˜ˆå€¼ &#125; SubShader &#123; Tags &#123; "RenderType"="Opaque" &#125; LOD 100 Pass &#123; NAME "OUTLINE" Cull Front CGPROGRAM #pragma vertex vert #pragma fragment frag // make fog work #pragma multi_compile_fog #include "UnityCG.cginc" #include "Lighting.cginc" struct appdata &#123; float4 vertex : POSITION; float2 uv : TEXCOORD0; float3 normal : NORMAL; &#125;; struct v2f &#123; float2 uv : TEXCOORD0; float4 vertex : SV_POSITION; float3 normal : NORMAL; &#125;; sampler2D _MainTex; float4 _MainTex_ST; sampler2D _Ramp; float4 _Ramp_ST; fixed4 _Specular; float _Gloss; float _Outline; float4 _OutlineColor; v2f vert (appdata v) &#123; v2f o; o.vertex = mul(UNITY_MATRIX_MV, v.vertex); float3 normal = mul((float3x3)UNITY_MATRIX_IT_MV, v.normal); normal.z = -0.5; o.vertex = o.vertex + float4(normalize(normal), 0) * _Outline; o.vertex = mul(UNITY_MATRIX_P, o.vertex); return o; &#125; fixed4 frag (v2f i) : SV_Target &#123; return fixed4(_OutlineColor.rgb, 1); &#125; ENDCG &#125; Pass &#123; Tags &#123;"LightMode"="ForwardBase"&#125; Cull Back CGPROGRAM #pragma vertex vert #pragma fragment frag #include "UnityCG.cginc" #include "Lighting.cginc" #include "AutoLight.cginc" #pragma multi_compile_fwdbase struct a2v &#123; float4 vertex : POSITION; float3 texcoord : TEXCOORD0; float3 normal : NORMAL; &#125;; struct v2f &#123; float4 pos : POSITION; float2 uv : TEXCOORD0; float3 worldNormal : TEXCOORD1; float3 worldPos : TEXCOORD2; SHADOW_COORDS(3) &#125;; sampler2D _MainTex; float4 _MainTex_ST; sampler2D _Ramp; float4 _Ramp_ST; fixed4 _Specular; float _Gloss; float _Outline; float4 _OutlineColor; float4 _Color; float _SpecularScale; v2f vert (a2v v)&#123; v2f o; o.pos = UnityObjectToClipPos(v.vertex); o.uv = TRANSFORM_TEX(v.texcoord, _MainTex); o.worldNormal = mul(v.normal, (float3x3)unity_WorldToObject); o.worldPos = mul(unity_ObjectToWorld, v.vertex).xyz; TRANSFER_SHADOW(o); return o; &#125; float4 frag(v2f i) : SV_Target&#123; fixed3 worldNormal = normalize(i.worldNormal); fixed3 worldLightDir = normalize(UnityWorldSpaceLightDir(i.worldPos)); fixed3 worldViewDir = normalize(UnityWorldSpaceViewDir(i.worldPos)); fixed3 worldHalfDir = normalize(worldLightDir + worldViewDir); fixed4 c = tex2D(_MainTex, i.uv); fixed3 albedo = c.rgb * _Color.rgb; fixed3 ambient = UNITY_LIGHTMODEL_AMBIENT.xyz * albedo; UNITY_LIGHT_ATTENUATION(atten, i, i.worldPos); fixed diff = dot(worldNormal, worldLightDir); diff = (diff*0.5+0.5)*atten; fixed3 diffuse = _LightColor0.rgb * albedo * tex2D(_Ramp, float2(diff, diff)).rgb; fixed spec = dot(worldNormal, worldHalfDir); fixed w = fwidth(spec) * 2.0; fixed3 specular = _Specular.rgb * lerp(0, 1, smoothstep(-w, w, spec + _SpecularScale - 1)) * step(0.0001, _SpecularScale); return fixed4(ambient + diffuse + specular, 1.0); &#125; ENDCG &#125; &#125;&#125; æŠ—é”¯é½¿å¤„ç†ï¼š1specular = lerp(0,1,smoothstep(-0.0001, 0.0001, specular - _Threshold)); é¦–å…ˆï¼Œæˆ‘ä»¬è®¡ç®—äº†å…‰ç…§æ¨¡å‹ä¸­éœ€è¦çš„å„ä¸ªæ–¹å‘çŸ¢é‡ï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œäº†å½’ä¸€åŒ–å¤„ç†ã€‚ç„¶åæˆ‘ä»¬è®¡ç®—äº†æè´¨çš„åå°„ç‡albedoå’Œç¯å¢ƒå…‰ç…§ambientã€‚æ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨å†…ç½®çš„UNITY_LIGHT_ATTENUATIONå®æ¥è®¡ç®—å½“å‰ä¸–ç•Œåæ ‡ä¸‹çš„é˜´å½±å€¼ã€‚éšåï¼Œæˆ‘ä»¬è®¡ç®—äº†åŠå…°ä¼¯ç‰¹æ¼«åå°„ç³»æ•°ï¼Œå¹¶å’Œé˜´å½±å€¼ç›¸ä¹˜å¾—åˆ°æœ€ç»ˆçš„æ¼«åå°„ç³»æ•°ã€‚æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªæ¼«åå°„ç³»æ•°å¯¹æ¸å˜çº¹ç†_Rampè¿›è¡Œé‡‡æ ·ï¼Œå¹¶å°†ç»“æœå’Œæè´¨çš„åå°„ç‡ã€å…‰ç…§é¢œè‰²é¢œè‰²ç›¸ä¹˜ï¼Œä½œä¸ºæœ€åçš„æ¼«åå°„å…‰ç…§ã€‚é«˜å…‰åå°„ä½¿ç”¨fwidthå¯¹é«˜å…‰åŒºåŸŸçš„è¾¹ç•Œè¿›è¡ŒæŠ—é”¯é½¿å¤„ç†ï¼Œå¹¶å°†è®¡ç®—å¾—åˆ°çš„é«˜å…‰åå°„ç³»æ•°å’Œé«˜å…‰åå°„é¢œè‰²ç›¸ä¹˜ï¼Œå¾—åˆ°é«˜å…‰åå°„çš„å…‰ç…§éƒ¨åˆ†ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨æœ€åè¿˜ä½¿ç”¨äº†step(0.0001,_SpecularScale)ï¼Œè¿™æ˜¯ä¸ºäº†åœ¨_SpecularScaleä¸º0æ—¶ï¼Œå¯ä»¥å®Œå…¨æ¶ˆé™¤é«˜å…‰åå°„çš„å…‰ç…§ã€‚æœ€åï¼Œè¿”å›ç¯å¢ƒå…‰ç…§ã€æ¼«åå°„å…‰ç…§å’Œé«˜å…‰åå°„å…‰ç…§å åŠ çš„ç»“æœã€‚æœ€åï¼Œæˆ‘ä»¬ä¸ºShaderè®¾ç½®äº†åˆé€‚çš„Fallback:1Fallback "Diffuse" è¿™å¯¹äº§ç”Ÿæ­£ç¡®çš„é˜´å½±æŠ•å°„æ•ˆæœå¾ˆé‡è¦ã€‚ ç´ æé£æ ¼çš„æ¸²æŸ“å¦ä¸€ä¸ªéå¸¸æµè¡Œçš„éçœŸå®æ„Ÿæ¸²æŸ“æ˜¯ç´ æé£æ ¼çš„æ¸²æŸ“ã€‚1234567891011Properties&#123; _Color("Color Tint", Color)=(1,1,1,1) _TitleFactor("Tile Factor", Float) = 1 _Outline("Outline", Range(0, 1))=0.1 _Hatch0("Hatch 0", 2D)="white"&#123;&#125; _Hatch1("Hatch 1", 2D)="white"&#123;&#125; _Hatch2("Hatch 2", 2D)="white"&#123;&#125; _Hatch3("Hatch 3", 2D)="white"&#123;&#125; _Hatch4("Hatch 4", 2D)="white"&#123;&#125; _Hatch5("Hatch 5", 2D)="white"&#123;&#125;&#125; å…¶ä¸­ï¼Œ_Coloræ˜¯ç”¨äºæ§åˆ¶æ¨¡å‹é¢œè‰²çš„å±æ€§ã€‚_TileFactoræ˜¯çº¹ç†çš„å¹³é“ºç³»æ•°ï¼Œ_TileFactorè¶Šå¤§ï¼Œæ¨¡å‹ä¸Šçš„ç´ æçº¿æ¡è¶Šå¯†ã€‚_Hatch0è‡³_Hatch5å¯¹åº”äº†æ¸²æŸ“æ—¶ä½¿ç”¨çš„6å¼ ç´ æçº¹ç†ï¼Œå®ƒä»¬çš„çº¿æ¡å¯†åº¦ä¾æ¬¡å¢å¤§ã€‚ç”±äºç´ æé£æ ¼å¾€å¾€ä¹Ÿéœ€è¦åœ¨ç‰©ä½“å‘¨å›´æ¸²æŸ“è½®å»“çº¿ï¼Œå› æ­¤æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ä¸Šé¢çš„æ¸²æŸ“è½®å»“çº¿çš„Passï¼š12345SubShader&#123; Tags&#123;"RenderType"="Opaque" "Queue"="Geometry"&#125; UsePass "Zentia/Toon Shading/OUTLINE"&#125; æˆ‘ä»¬ä½¿ç”¨UsePasså‘½ä»¤è°ƒç”¨äº†è½®å»“çº¿æ¸²æŸ“çš„Passä¸‹é¢ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰å…‰ç…§æ¨¡å‹æ‰€åœ¨çš„Passã€‚ä¸ºäº†èƒ½å¤Ÿæ­£ç¡®è·å–å„ä¸ªå…‰ç…§å˜é‡ï¼Œæˆ‘ä»¬è®¾ç½®äº†Passçš„æ ‡ç­¾å’Œç›¸å…³çš„ç¼–è¯‘æŒ‡ä»¤ï¼š12345678Pass &#123; Tags &#123;"LightMode"="ForwardBase"&#125; CGPROGRAM #pragma vertex vert #pragma fragment frag #pragma multi_compile_fwdbase&#125; ç”±äºæˆ‘ä»¬éœ€è¦åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­è®¡ç®—6å¼ çº¹ç†çš„æ··åˆæƒé‡ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦åœ¨v2fç»“æ„ä½“ä¸­æ·»åŠ ç›¸åº”çš„å˜é‡ï¼š1234struct &#123; &#125;;]]></content>
      <categories>
        <category>Unity Shader</category>
      </categories>
      <tags>
        <tag>Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[commandbuffer]]></title>
    <url>%2F2019%2F04%2F27%2Fcommandbuffer%2F</url>
    <content type="text"><![CDATA[CommandBuffer ä¸Šå›¾æ˜¯æ‘„åƒæœºæ¸²æŸ“çš„ä¸¤ä¸ªè·¯å¾„ã€‚è¿™ä¸¤ç§é€šç”¨çš„æ–¹æ³•ï¼Œèƒ½å¾ˆå¥½çš„è§£å†³å¸¸ç”¨ç‰©ä½“çš„æ¸²æŸ“çš„å…‰å½±æ•ˆæœã€‚ä½†ä¸€äº›ç‰¹æ•ˆä¼šéœ€è¦åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œæ”¹åŠ¨ã€‚CommandBufferå¯ä»¥åœ¨ä¸Šå›¾ä»»æ„çš„ç»¿ç‚¹æ’å…¥å¼æ¸²æŸ“ã€‚ä¸ºäº†è§£å†³æ­¤é—®é¢˜å¸¸è§„çš„æ–¹æ³•æ˜¯ä½¿ç”¨åæ•ˆã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•æ“ä½œéº»çƒ¦ï¼Œè€Œä¸”æ€§èƒ½ä¸æ˜¯å¾ˆå¥½ã€‚ CommandBufferç±»çš„å¸¸è§„æ“ä½œ1234567891011// å£°æ˜CommandBuffer commandBuffer = new CommandBuffer();// è®¾ç½®æ¸²æŸ“ç›®æ ‡commandBuffer.SetRenderTarget(renderTexture);commandBuffer.ClearRenderTarget(true, true, Color.black);// è®¾ç½®æ¸²æŸ“æ•°æ®commandBuffer.DrawRenderer(targetRenderer, material);// å°†commandBufferçš„æ¸²æŸ“è¿›è¡Œåå¤„ç†commandBuffer.Bilt(renderTexture,DestTexture,material);// å‘ä¸»cameraä¸­æ’å…¥CommandBuffercommandBuffer.AddCommandBuffer(CameraEvent.BeforeForwardOpaque,commandBuffer); æè¾¹æ€è·¯å®ç°]]></content>
      <categories>
        <category>Shader</category>
      </categories>
      <tags>
        <tag>Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç§»åŠ¨å¹³å°çš„AlphaTestæ•ˆç‡é—®é¢˜]]></title>
    <url>%2F2019%2F04%2F25%2Falphatest%2F</url>
    <content type="text"><![CDATA[ä¸ºä»€ä¹ˆAlphaTeståº”è¯¥æ¯”AlphaBlendæ›´æ…¢ï¼ŸAlphaTeståœ¨æ¸²æŸ“æ—¶å®é™…ä¸Šå’Œä¸é€æ˜ç‰©ä½“ç±»å‹ï¼Œä¸å…¶è¯´æ˜¯ä¸€ç§â€œé€æ˜ç‰©ä½“â€ï¼Œä¸å¦‚è¯´æ˜¯ä¸€ç§â€œå¯ä»¥åœ¨ä¸Šé¢æ‰“æ´çš„ä¸é€æ˜ç‰©ä½“â€ã€‚åœ¨Unityé‡Œï¼Œä¹Ÿå¯ä»¥å…è®¸AlpahTestå’ŒOpaqueæ··åˆç»˜åˆ¶ã€‚å…‰ç…§ï¼Œæ˜¯å¦å¯æ¥å—æŠ•å½±ï¼Œåœ¨æ¸²æŸ“ç®¡çº¿çš„ä½ç½®ï¼ŒAlphaTestçš„ç‰©ä½“éƒ½æ˜¯å®Œå…¨æŒ‰Opaqueå¤„ç†çš„ã€‚AlphaTestå®é™…ä¸Šå°±æ˜¯ä¸€ç§ç‰¹æ®Šçš„Opaqueï¼Œåªæ˜¯å…è®¸åœ¨åƒç´ é˜¶æ®µdiscardåƒç´ ï¼Œè®©æŸäº›åƒç´ ä¸ç»˜åˆ¶åˆ°å±å¹•ä¸Šï¼Œä»è¿™ä¸ªè§’åº¦çœ‹ï¼Œç”šè‡³è¿˜åº”è¯¥æ¯”Opaqueæ›´èŠ‚çº¦æ€§èƒ½çŒœå¯¹ã€‚è€ŒAlphaBlendåˆ™æ˜¯çº¯ç²¹çš„é€æ˜ç‰©ä½“ã€‚é€æ˜ç‰©ä½“å¤š=æ•ˆç‡ä½ä¹Ÿæ˜¯å¸¸è§çš„â€œç»éªŒç»“è®ºâ€ï¼Œä¸»è¦åŸå› æ˜¯ALphaBlendä¼šåœ¨Blendçš„æ—¶å€™è¯»å–å±å¹•ç¼“å†²åŒºï¼Œä»¥åŠå¿…é¡»é‡å¤è®¡ç®—æ¯ä¸ªåƒç´ çš„å¤šå±‚å†…å®¹ï¼Œé«˜overdrawä¼šå¾ˆå¿«çƒ§å…‰fillrateã€‚ ä½†ä¸ºä»€ä¹ˆä¼šæœ‰äººè¯´ç§»åŠ¨å¹³å°AlphaTestæ¯”AlphaBlendæ›´æ…¢å‘¢ï¼Ÿæ˜¯å› ä¸ºç§»åŠ¨å¹³å°ä¸Šå¹¿æ³›ä½¿ç”¨äº†early-DTï¼ˆæå‰çš„Depth Testï¼‰åªåšç§»åŠ¨å¹³å°çš„ä¼šäº§ç”Ÿä¸€ç§è¯¯è§£ï¼šè®¤ä¸ºå…ˆç”»äº†ä¸€ä¸ªç‰©ä½“ï¼Œåœ¨æŸä¸ªåŒºåŸŸå†™ä¸Šäº†æ·±åº¦ï¼Œç„¶ååœ¨ä¹‹åå†ç”»ä¸€ä¸ªæ·±åº¦æ¯”å®ƒä½çš„ç‰©ä½“ï¼Œå› ä¸ºè¢«é®æŒ¡æ‰€ä»¥ç”»ä¸ä¸Šå»ï¼Œé‚£GPUå°±ä¸åº”è¯¥èŠ±æ—¶é—´å»ç”»ç„¶è€Œäº‹å®ä¸Šï¼Œä¹‹å‰çš„GPUå¹¶æ²¡æœ‰é‚£ä¹ˆâ€œèªæ˜â€ã€‚è¿™ä¸ªæŠ€æœ¯æœ¬èº«å°±æ˜¯early-DTã€‚è™½ç„¶åªæœ‰è‹¹æœè‡ªå·±åœ¨å¹ï¼Œå®é™…ä¸Šæ‰€æœ‰ç§»åŠ¨å¹³å°çš„GPUéƒ½ä½¿ç”¨è¿™ä¸ªæŠ€æœ¯ã€‚ä¹Ÿåªæœ‰ä½¿ç”¨äº†è¿™ä¸ªæŠ€æœ¯çš„GPUï¼Œæ‰èƒ½å®ç°åˆšæ‰è¯´çš„è¿™ç§â€œç»˜åˆ¶ä¼˜åŒ–â€ã€‚è€Œå…¶ä»–çš„GPUç”±äºæ²¡æœ‰è¿™ä¸ªæŠ€æœ¯ï¼ŒDepthTesté˜¶æ®µéƒ½æ˜¯åœ¨Frag Shaderä¹‹åçš„ï¼ˆä¹Ÿå°±æ˜¯later-DTï¼‰ï¼Œå› æ­¤å±å¹•å†…çš„ç‰©ä½“å¹¶ä¸å­˜åœ¨é®æŒ¡å‰”é™¤ã€‚PCå’Œç§»åŠ¨å¹³å°æ‹¥æœ‰ealy-DTï¼Œå®ƒçš„åŠŸèƒ½å’ŒDeferred Shadingçš„åŠŸèƒ½éƒ¨åˆ†é‡å çš„ï¼Œæ‰€ä»¥æ‰ä¸å»ºè®®ä½¿ç”¨Deferred Shadingï¼Œå› ä¸ºè·å¾—çš„æ”¶ç›Šå¾ˆå¯èƒ½ä¼šåå€’ä¸å¦‚DeffedæŠ€æœ¯æ–°å¢çš„æˆæœ¬ã€‚äº†è§£äº†early-DTå’Œlater-DTåï¼Œè¿˜éœ€è¦åœ¨è°ˆä¸€ä¸ªä¸œè¥¿ï¼š å¹¶è¡ŒåŒ–å’Œä¸²è¡ŒåŒ–ç¡¬ä»¶è¿›è¡Œè®¡ç®—æ—¶ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªåƒç´ ä¸€ä¸ªåƒç´ åœ°æ‰§è¡Œï¼Œè€Œæ˜¯åŒæ—¶å¤šä¸ªåƒç´ åŒæ—¶è¿›è¡Œï¼Œè¿™å°±æ˜¯å¹¶è¡ŒåŒ–ã€‚ä½†æ˜¯åœ¨è¿™ä¸ªå¹¶è¡ŒåŒ–çš„å¤šä¸ªçº¿ç¨‹ä¸­ï¼Œä»–ä»¬å¹¶ä¸æ€»èƒ½ä¿æŒé½å¤´å¹¶è¿›ï¼Œåœ¨Fragé˜¶æ®µï¼Œæ€»ä¼šç”±äºå„ç§åŸå› å¯¼è‡´ä»–ä»¬ç»“æŸçš„æ—¶é—´ç‚¹å‡ºç°ä¸ä¸€è‡´ï¼Œæœ‰å¯èƒ½å‡ºç°å…ˆç”»çš„åƒç´ åè€Œåç»˜åˆ¶çš„æƒ…å†µã€‚å¹¶ä¸æ˜¯æ‰€æœ‰çš„åƒç´ éƒ½æŒ‰è¦æ±‚é¡ºåºå®Œæˆï¼Œä½†æ˜¯å‡å¦‚æˆ‘ä»¬å¼ºè¡Œè®¾ç½®äº†ä»–ä»¬çš„ç»˜åˆ¶é¡ºåºï¼ŒGPUä¹Ÿå¿…é¡»éµå®ˆï¼Œæ‰€ä»¥åªèƒ½è¿™æ ·ï¼šå½“ç„¶ï¼Œåœ¨è¿™ä¸ªWaitçš„é˜¶æ®µå¦‚æœGPUèƒ½å¤Ÿæ‰¾åˆ°ä»€ä¹ˆåˆ«çš„ä¸éœ€è¦æ“ä½œFrame Bufferçš„å·¥ä½œï¼Œå®ƒä¹Ÿä¸ä¼šé—²ç€ï¼Œä½†å‡å¦‚ç¡®å®æ‰¾ä¸åˆ°ä»»ä½•â€œå¯ä»¥å¹²çš„æ´»â€ï¼Œå®ƒä¹Ÿå°±åªèƒ½é—²ç€äº†ã€‚è¿™å°±æ˜¯ä¸²è¡ŒåŒ–ï¼Œæ˜¾ç„¶ï¼Œä¼šé€ æˆæ€§èƒ½ä¸‹é™ã€‚ç„¶è€Œï¼ŒGPUå…¶å®ä¹Ÿæ²¡æœ‰è¿™ä¹ˆè ¢ã€‚ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„ä¼˜åŒ–æ˜¯ï¼šå…¶å®æˆ‘åªéœ€è¦ä¿è¯ç»˜å…¥Frame Bufferæ—¶çš„é¡ºåºæ˜¯ä¸€è‡´çš„ï¼Œé‚£ä¹ˆæˆ‘æŠŠFrag Shaderçš„ç»“æœå †èµ·æ¥æ”¾åœ¨ä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼Œä¿è¯è¿™ä¸ªé˜Ÿåˆ—é¡ºåºæ˜¯ä¸€è‡´çš„ï¼Œé‚£å‰é¢Frag Shaderä»€ä¹ˆæ—¶å€™ç»“æŸä¹Ÿå°±æ— æ‰€è°“äº†ã€‚åœ¨later-DTçš„æ—¶å€™ç¡®å®æ˜¯è¿™æ ·çš„ï¼šå¾ˆå®¹æ˜“è¢«å¿½ç•¥æ‰çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™ä¸ªDepth Testè¿‡ç¨‹ï¼Œå…¶å®æ˜¯ä¸€ä¸ªè¯»+å†™çš„è¿‡ç¨‹ï¼Œä¸é€æ˜ç‰©ä½“åœ¨è¯»å–Depthä¹‹åï¼Œè¿˜éœ€è¦é©¬ä¸ŠæŠŠè‡ªå·±çš„Depthå†™å›å»ï¼Œè¿™æ ·ä¸Šä¸€ä¸ªåƒç´ æŠŠDepthå†™è¿›å»åï¼Œä¸‹ä¸€ä¸ªæ‰èƒ½è¯»å‡ºæ¥ï¼Œæ‰€ä»¥Depth Testçš„é¡ºåºåŒæ ·å¿…é¡»äº‰å–çš„ã€‚æ‰€ä»¥æ¢æˆearly-DTä¹‹åè™½ç„¶Frame Depthå’ŒFrame Color Bufferæ“ä½œçš„æ—¶é—´ç‚¹è¢«é”™å¼€äº†ï¼Œä½†æ˜¯åˆ†åˆ«çš„é¡ºåºè¿˜æ˜¯ä¸€è‡´çš„ï¼Œå¹¶æ²¡æœ‰é—®é¢˜ã€‚é‚£ä¹ˆAlphaTeståˆ°åº•ç”¨çš„æ˜¯later-DTè¿˜æ˜¯early-DTå‘¢ï¼Ÿ PowerVRç›®å‰å’Œåˆ«çš„GPUçš„ä¸»è¦åŒºåˆ«æ˜¯ï¼šå®ƒåœ¨TBRçš„DTé˜¶æ®µå¤šäº†ä¸€æ¬¡å¯»å€æœ€é¡¶ç«¯ä¸‰è§’å½¢çš„æ“ä½œï¼ˆåˆ«äººæ˜¯TBRï¼Œå®ƒæ˜¯TBDRï¼‰ã€‚åœ¨å…¨éƒ¨ç§»åŠ¨å¹³å°ä¸Šï¼Œæœ‰ä¸€ç§å¯èƒ½æ€§ï¼ŒAlpahtTeståªèµ°later-DTï¼Œå¯¼è‡´å®ƒè‡ªèº«æ— æ³•è¢«â€œé®æŒ¡ï¼ˆè€ŒAlphaBlendå¯ä»¥ï¼‰â€ï¼Œè¿™æ˜¯æ•ˆç‡æ¯”AlphaBlendä½çš„ä¸»è¦åŸå› ã€‚æ‰€ä»¥ï¼Œåªè¦AlphaTestè¾ƒå°‘è¢«é®æŒ¡ï¼ŒåŠ£åŠ¿å°±å¹¶ä¸å­˜åœ¨ï¼Œåè€Œå› ä¸ºAlphaTestå¯ä»¥â€œé®æŒ¡â€å…¶å®ƒç‰©ä½“çš„åŸå› ï¼Œå¯¼è‡´AlphaTestæ•ˆç‡æ›´é«˜ï¼ˆä½†è¿™å¿…é¡»è®©AlphaTestå…ˆäºä¸é€æ˜ç‰©ä½“ç»˜åˆ¶ï¼‰ã€‚]]></content>
      <categories>
        <category>Shader</category>
      </categories>
      <tags>
        <tag>Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Photon-TrueSync]]></title>
    <url>%2F2019%2F04%2F24%2FPhoton-TrueSync%2F</url>
    <content type="text"><![CDATA[gitä»“åº“ï¼šhttps://github.com/zentia/TrueSyncä¼˜ç‚¹ï¼š æ”¯æŒå›æ»š æ”¯æŒUDP å®Œæ•´çš„è§£å†³æ–¹æ¡ˆ ç¼ºç‚¹ï¼š lockstepæ¨¡å¼ï¼Œç›®å‰ä¸å¤ªéœ€è¦ ä¸é€‚åˆæ‰©å±•ECSæ¨¡å‹ ä»£ç æ•´ä½“æ€§èƒ½åº”è¯¥ä¸æ˜¯æœ€ä¼˜ï¼Œä¸è¿‡å¯ä»¥è°ƒæ•´ å°è£…çš„æ¯”è¾ƒå®Œæ•´ï¼Œä½†æ˜¯è¦é€‚é…åˆ°é¡¹ç›®ä¸­ï¼Œå¯èƒ½ä¼šå¯¹é¡¹ç›®æ”¹çš„ä¸œè¥¿æ¯”è¾ƒå¤šã€‚ åå°„å’ŒLambdaä½¿ç”¨çš„æƒ…å†µæ¯”è¾ƒå¤š 1234567public enum ConnectionProtocol : byte&#123; Udp = 0, Tcp = 1, WebSocket = 4, WebSocketSecure = 5,&#125; è²Œä¼¼éƒ½æ”¯æŒï¼Œä½†æ˜¯æˆ‘ä»¬ä¸éœ€è¦è¿™ä¹ˆå¤šã€‚æˆ–è€…è¯´æˆ‘ä»¬PVPéƒ¨åˆ†å’Œå¤§å…éƒ¨åˆ†éƒ½èµ°ä¸€å¥—ã€‚ç›®å‰ä¸è€ƒè™‘å¤§å…çš„è®¾è®¡ã€‚ TrueSyncConfigå¸§åŒæ­¥é…ç½® TrueSyncManager123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244ç®¡ç†ã€é©±åŠ¨å¸§åŒæ­¥ //åŒæ­¥å…¨å±€é…ç½®static TrueSyncConfig TrueSyncGlobalConfig;// é…ç½®static TrueSyncConfig Config;TrueSyncConfig ActiveConfig;// é”å¸§private AbstractLockstep lockstep;// åç¨‹è°ƒåº¦CoroutineScheduler scheduler;// ç©å®¶é¢„è®¾åˆ—è¡¨GameObject[] playerPrefabs;// private Dictionary&lt;int, List&lt;GameObject&gt;&gt; gameOjectsSafeMap = new Dictionary&lt;int, List&lt;GameObject&gt;&gt;();// éå“ªä¸ªç©å®¶æ‹¥æœ‰çš„è¡Œä¸ºï¼Œå«åšæ™®é€šè¡Œä¸ºList&lt;TrueSyncManagedBehaviour&gt; generalBehaviours = new List&lt;TrueSyncManagedBehaviour&gt;();// å¯¹åº”ç©å®¶æ‰€æ‹¥æœ‰çš„è¡Œä¸ºDictionary&lt;byte, List&lt;TrueSyncManagedBehaviour&gt;&gt; behaviorsByPlayer;// ä¸€ä¸ªä¸´æ—¶ç¼“å­˜æ± ï¼Œç”¨åœ¨åé¢æ³¨å†Œè¡Œä¸ºçš„æ—¶å€™å å­˜ã€‚åœ¨å¸§æ›´æ–°çš„æ—¶å€™OnStepUpdateè°ƒç”¨CheckQueuedBehavioursã€‚åˆ†é…ç©å®¶æ‹¥æœ‰è€…å’Œè°ƒOnSyncedStartã€‚ç„¶åå°±æ¸…ç†è¯¥åˆ—è¡¨List&lt;TrueSyncManagedBehaviour&gt; queuedBehaviours = new List&lt;TrueSyncManagedBehaviour&gt;();// ä¿å­˜äº†æ‰€æœ‰è¡Œä¸ºçš„å­—å…¸Dictionary&lt;ITrueSyncBehaviour, TrueSyncManagedBehaviour&gt; mapBehaviorToManagedBehavior = new Dictionary&lt;ITrueSyncBehaviour, TrueSyncManagedBehaviour&gt;();// æ—¶é—´FP time = 0;static FP Time;// å¸§æ—¶é—´static FP DeltaTime;// å¸§static int Ticks;static int LastSafeTick;// é‡åŠ›static TSVector Gravity;// ç©å®¶åˆ—è¡¨static List&lt;TSPlayerInfo&gt; Playersï¼›// æœ¬åœ°ç©å®¶static TSPlayerInfo LocalPlayerï¼›// å¯åŠ¨çŠ¶æ€, åœ¨Updateå†³å®šä»€ä¹ˆæ—¶å€™è¿è¡Œlockstep.RunSimulation(true);private enum StartState &#123; BEHAVIOR_INITIALIZED, FIRST_UPDATE, STARTED &#125;;private StartState startState;void Awake() &#123; TrueSyncConfig currentConfig = ActiveConfig; lockedTimeStep = currentConfig.lockedTimeStep; // åˆå§‹åŒ–çŠ¶æ€è·Ÿè¸ª StateTracker.Init(currentConfig.rollbackWindow); // åˆå§‹åŒ–éšæœºæ•° TSRandom.Init(); // åˆå§‹åŒ–ç‰©ç†ç®¡ç†å™¨ if (currentConfig.physics2DEnabled || currentConfig.physics3DEnabled) &#123; PhysicsManager.New(currentConfig); PhysicsManager.instance.LockedTimeStep = lockedTimeStep; PhysicsManager.instance.Init(); &#125; // è·Ÿè¸ª æ—¶é—´ StateTracker.AddTracking(this, "time");&#125;void Start() åšäº†ä»€ä¹ˆ?è®¾ç½®instance = this;è®¾ç½®Application.runInBackground = true;åˆå§‹åŒ–é€šä¿¡PhotonTrueSyncCommunicator åˆ›å»ºlockstepæ£€æµ‹æ˜¯å¦æ˜¯å½•åƒæ¨¡å¼, å¦‚æœæ˜¯å°±åŠ è½½å½•åƒå¦‚æœé…ç½®äº†æ˜¾ç¤ºTrueSyncStatsï¼Œé‚£å°±åˆå§‹åŒ–åˆ›å»ºåç¨‹è°ƒåº¦ scheduler = new CoroutineScheduler(lockstep);éå½•åƒæ¨¡å¼ä¸‹ åˆå§‹åŒ–å¸§çš„ç©å®¶åˆ—è¡¨åˆå§‹åŒ–åœºæ™¯ä¸­ç°æœ‰çš„å¸§åŒæ­¥è¡Œä¸º TrueSyncBehaviourå®ä¾‹åŒ–ç©å®¶é¢„è®¾playerPrefabså’ŒåŒæ­¥å…¶è¡Œä¸ºçš„æ‹¥æœ‰è€… initBehaviorsåˆå§‹åŒ–è¡Œä¸ºæ‹¥æœ‰è€…ï¼Œå¹¶åˆ†é…ç»™å¯¹äºç©å®¶ã€‚æ²¡æœ‰ç»§æ‰¿TrueSyncBehaviourçš„å°±ç»§ç»­æ”¾åˆ°æ™®é€šè¡Œä¸ºåˆ—è¡¨ã€‚initGeneralBehaviorsæ·»åŠ ç‰©ç†å¯¹è±¡ç§»é™¤ç›‘å¬ PhysicsManager.instance.OnRemoveBody(OnRemovedRigidBody);è®¾ç½®å¯åŠ¨çŠ¶æ€ startState = StartState.BEHAVIOR_INITIALIZED;// åˆ›å»ºITrueSyncBehaviourçš„TrueSyncManagedBehaviourï¼Œæ˜¯å¯¹ITrueSyncBehaviourçš„ä¸€å±‚åŒ…è£…private TrueSyncManagedBehaviour NewManagedBehavior(ITrueSyncBehaviour trueSyncBehavior)// åˆå§‹åŒ–ç©å®¶é¢„è®¾å’Œä»–ä»¬çš„åŒæ­¥è¡Œä¸ºã€‚è¡Œä¸ºè®¾ç½®æ‹¥æœ‰è€…ï¼Œå¹¶å…¶æ·»åŠ åˆ°å¯¹åº”ç©å®¶çš„è¡Œä¸ºå­—å…¸é‡ŒbehaviorsByPlayerprivate void initBehaviors()// å¯¹è¡Œä¸ºåˆ—è¡¨åˆ†é…æ‹¥æœ‰è€…ï¼Œ åœ¨Start(), CheckQueuedBehaviours()é‡Œè°ƒç”¨private void initGeneralBehaviors(IEnumerable&lt;TrueSyncManagedBehaviour&gt; behaviours, bool realOwnerId)// å°†æ³¨å†Œè¡Œä¸ºå å­˜åˆ—è¡¨åˆ—queuedBehavioursçš„è¡Œä¸ºè°ƒinitGeneralBehaviorsåˆ†é…æ‹¥æœ‰è€…ã€‚è°ƒSetGameInfoå’ŒOnSyncedStartä¸¤ä¸ªæ–¹æ³•private void CheckQueuedBehaviours()// åªåšä¸€ä»¶äº‹ï¼Œæ£€æµ‹å¯åŠ¨çŠ¶æ€ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡å¯åŠ¨å°±è°ƒlockstep.RunSimulation(true);void Update()// åœ¨å¸§åŒæ­¥è°ƒæš‚åœå æ¢å¤ç»§ç»­è¿è¡Œã€‚instance.lockstep.RunSimulation(false);public static void RunSimulation()// æš‚åœæ¸¸æˆ è°ƒinstance.lockstep.PauseSimulation();public static void PauseSimulation() // ç»“æŸæ¸¸æˆ è°ƒinstance.lockstep.EndSimulation();public static void EndSimulation()// æ›´æ–°ä¸€æ¬¡åç¨‹ï¼Œ ä¸»è¦æ˜¯ç‰©ç†é‡Œè°ƒç”¨äº†ã€‚é»˜è®¤çš„åç¨‹æ›´æ–°åœ¨ å¸§æ›´æ–°é‡ŒOnStepUpdatepublic static void UpdateCoroutines()// æ·»åŠ ä¸€ä¸ªåç¨‹public static void SyncedStartCoroutine(IEnumerator coroutine)// å®ä¾‹åŒ–ä¸€ä¸ªé¢„è®¾// å…ˆåŠ¿åŠ›åŒ–ä¸€ä¸ªGameObject// éå½•åƒæ¨¡å¼å°†è¯¥å¯¹è±¡æ·»åŠ åˆ°å¸§è®°å½•é‡Œã€‚AddGameObjectOnSafeMap(go);// å°†è¯¥å¯¹è±¡çš„å¸§è¡Œä¸ºæ·»åŠ åˆ°queuedBehavioursï¼Œç­‰å¾…å¸§æ›´æ–°çš„æ—¶å€™åˆ†é…æ‹¥æœ‰è€…å’Œè°ƒåº¦åˆå§‹åŒ–æ–¹æ³•// è°ƒè¯¥å¯¹è±¡ä¸Šç»„ä»¶çš„åˆå§‹åŒ–æ–¹æ³•ï¼ˆICollideræ³¨å†Œåˆ°ç‰©ç†ç®¡ç†å™¨é‡ŒPhysicsManager, TSTransform, TSTransform2Dï¼‰ã€‚InitializeGameObjectpublic static GameObject SyncedInstantiate(GameObject prefab)public static GameObject SyncedInstantiate(GameObject prefab, TSVector position, TSQuaternion rotation)public static GameObject SyncedInstantiate(GameObject prefab, TSVector2 position, TSQuaternion rotation)// å°†åŠ¿åŠ›åŒ–çš„GameObjectæ·»åŠ åˆ°å½“å‰çš„å¸§+1åˆ—è¡¨é‡Œprivate static void AddGameObjectOnSafeMap(GameObject go)// åœ¨å¸§æ›´æ–°OnStepUpdateçš„æ—¶å€™æ‰, æ¸…ç†é”€æ¯æ‰å½“å‰ Ticks + 1é‡Œçš„GameObjectã€‚çŒœæµ‹ä¼°è®¡æ˜¯å¸§å›æ»šçš„æ—¶å€™æŠŠé¢„å¤„ç†çš„å¯¹è±¡é”€æ¯private static void CheckGameObjectsSafeMap()// è°ƒè¯¥å¯¹è±¡ä¸Šç»„ä»¶çš„åˆå§‹åŒ–æ–¹æ³•ï¼ˆICollideræ³¨å†Œåˆ°ç‰©ç†ç®¡ç†å™¨é‡ŒPhysicsManager, TSTransform, TSTransform2Dï¼‰private static void InitializeGameObject(GameObject go, TSVector position, TSQuaternion rotation)// é”€æ¯GameObject// ç¬¬ä¸€æ­¥è°ƒSyncedDisableBehaviour, åœæ­¢æ›´æ–°è¯¥å¯¹è±¡ä¸Šçš„ITrueSyncBehaviour// ç¬¬äºŒæ­¥è°ƒ TSColliderå’ŒTSCollider2D è°ƒ DestroyTSRigidBodypublic static void SyncedDestroy(GameObject gameObject)// å°†GameObjectçš„ITrueSyncBehaviourçš„disabledè®¾ç½®ä¸ºtrue, åœæ­¢å¯¹ä»–è°ƒå¸§æ›´æ–°æ–¹æ³• OnSyncedInputï¼ŒOnSyncUpdateã€‚public static void SyncedDisableBehaviour(GameObject gameObject)// è®¾ç½® tsColliderGO.gameObject.SetActive(false);// å°†ç‰©ç†å¯¹è±¡ä»lockstepé”€æ¯ instance.lockstep.Destroy(body);private static void DestroyTSRigidBody(GameObject tsColliderGO, IBody body)// æ³¨å†ŒITrueSyncBehaviour, å°†ä»–æ·»åŠ åˆ°queuedBehavioursã€‚åœ¨ä¸‹æ¬¡CheckQueuedBehavioursçš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯åœ¨ä¸‹æ¬¡å¸§æ›´æ–°çš„æ—¶å€™OnStepUpdateï¼Œå¯¹ä»–åˆ†é…æ‹¥æœ‰è€…ï¼Œè°ƒSetGameInfoå’ŒOnSyncedStartä¸¤ä¸ªæ–¹æ³•public static void RegisterITrueSyncBehaviour(ITrueSyncBehaviour trueSyncBehaviour)// æ³¨å†Œæ¸¸æˆæ˜¯å¦ç»§ç»­çš„å§”æ‰˜ã€‚ è°ƒå§”æ‰˜ä¼šè¿”å›ä¸€ä¸ªboolå€¼ã€‚ trueæ¸¸æˆå¯ä»¥ç»§ç»­è¿è¡Œã€‚lockstepé‡Œä¼šè°ƒè¯¥æ–¹æ³•æ£€æµ‹æ˜¯å¦å¯ä»¥ç»§ç»­CheckGameIsReadyï¼ˆï¼‰public static void RegisterIsReadyChecker(TrueSyncIsReady IsReadyChecker)// ç§»é™¤ç©å®¶// ç¬¬ä¸€æ­¥å°†è¯¥ç©å®¶çš„ è¡Œä¸ºå…¨éƒ¨ç¦æ­¢å¸§æ›´æ–°behaviorsByPlayer[(byte)playerId],disabled = true;// ç¬¬äºŒæ­¥å°†è¿™äº›è¡Œä¸ºçš„GameObjectä¸Šæ‹¥æœ‰TSColliderã€TSCollider2Dçš„ç‰©ç†å…¨éƒ¨æ‰DestroyTSRigidBodypublic static void RemovePlayer(int playerId)// æ£€æµ‹å¸§æ›´æ–°æ—¶é—´ï¼Œæ—¶é—´åˆ°å°±è°ƒinstance.scheduler.UpdateAllCoroutines();å’Œlockstep.Update();// lockedTimeStepï¼Œå¸§åŒæ­¥ä¸€å¸§çš„æ—¶é—´// JitterTimeFactor, ä¸ºäº†é¿å…æµ®åŠ¨ç‚¹æ•°æ¯”è¾ƒé€ æˆè¯¯å·®ã€‚if (tsDeltaTime &gt;= (lockedTimeStep - JitterTimeFactor))// tsDeltaTime, ç”¨çš„æ—¶é—´è¿˜æ˜¯ç”¨Unityçš„ tsDeltaTime += UnityEngine.Time.deltaTime;void FixedUpdate()// é‡Œé¢åˆ›å»ºä¸€ä¸ªè¾“å…¥æ•°æ®ç»“æ„ return new InputData(); æ˜¯åœ¨lockstepåˆ›å»ºçš„æ—¶å€™ä¼ è¿™ä¸ªæ–¹æ³•ç»™ä»–InputDataBase ProvideInputData()// è¿™ä¸ªæ–¹æ³•ä¼šè°ƒæœ¬åœ°ç©å®¶æ‰€æœ‰å¸§è¡Œä¸ºçš„OnSyncedInputæ–¹æ³•// è¿™è¿™ä¸ªæ–¹æ³•ç”Ÿå‘½å‘¨æœŸå†… TrueSyncInput.CurrentInputData = playerInputData// æ˜¯åœ¨lockstepåˆ›å»ºçš„æ—¶å€™ä¼ è¿™ä¸ªæ–¹æ³•ç»™ä»–void GetLocalData(InputDataBase playerInputData)// å¸§æ›´æ–°// æ·»åŠ å½“å‰æ—¶é—´ time += lockedTimeStep;// éå½•åƒæ¨¡å¼ï¼Œ æ£€æµ‹GameObject CheckGameObjectsSafeMap();// éå†generalBehavioursæ™®é€šè¡Œä¸ºåˆ—è¡¨ï¼Œè°ƒè¡Œä¸ºçš„OnPreSyncedUpdate()ã€‚è¿˜ä¼šè°ƒåç¨‹æ›´æ–°instance.scheduler.UpdateAllCoroutines();// éå†allInputData,å’Œå¯¹åº”ç©å®¶çš„è¡Œä¸ºåˆ—è¡¨behaviorsByPlayerã€‚ è°ƒè¡Œä¸ºçš„OnPreSyncedUpdate()ã€‚è¿˜ä¼šè°ƒåç¨‹æ›´æ–°instance.scheduler.UpdateAllCoroutines();// éå†generalBehavioursæ™®é€šè¡Œä¸ºåˆ—è¡¨ï¼Œè°ƒè¡Œä¸ºçš„OnSyncedUpdate()ã€‚è¿˜ä¼šè°ƒåç¨‹æ›´æ–°instance.scheduler.UpdateAllCoroutines();// éå†allInputData,å’Œå¯¹åº”ç©å®¶çš„è¡Œä¸ºåˆ—è¡¨behaviorsByPlayerã€‚ è°ƒè¡Œä¸ºçš„OnSyncedUpdate()ã€‚è¿˜ä¼šè°ƒåç¨‹æ›´æ–°instance.scheduler.UpdateAllCoroutines();// æ£€æµ‹å å­˜è¡Œä¸ºåˆ—è¡¨CheckQueuedBehavioursï¼ˆï¼‰ã€‚ç»™ä»–ä»¬åˆ†é…æ‹¥æœ‰è€…å’Œè°ƒåŒæ­¥å¼€å§‹æ–¹æ³•// æ˜¯åœ¨lockstepåˆ›å»ºçš„æ—¶å€™ä¼ è¿™ä¸ªæ–¹æ³•ç»™ä»–void OnStepUpdate(List&lt;InputDataBase&gt; allInputData)// ç©å®¶ç¦»çº¿æ¶ˆæ¯å¤„ç†// è°ƒTrueSyncManagedBehaviour.OnPlayerDisconnection(generalBehaviours, behaviorsByPlayer, playerId);// æ˜¯åœ¨lockstepåˆ›å»ºçš„æ—¶å€™ä¼ è¿™ä¸ªæ–¹æ³•ç»™ä»– void OnPlayerDisconnection(byte playerId)// æ¸¸æˆå¼€å§‹æ¶ˆæ¯å¤„ç†// æ˜¯åœ¨lockstepåˆ›å»ºçš„æ—¶å€™ä¼ è¿™ä¸ªæ–¹æ³•ç»™ä»– void OnGameStarted() &#123; TrueSyncManagedBehaviour.OnGameStarted(generalBehaviours, behaviorsByPlayer); instance.scheduler.UpdateAllCoroutines(); CheckQueuedBehaviours(); &#125;// æ¸¸æˆæš‚åœæ¶ˆæ¯å¤„ç†// æ˜¯åœ¨lockstepåˆ›å»ºçš„æ—¶å€™ä¼ è¿™ä¸ªæ–¹æ³•ç»™ä»– void OnGamePaused() &#123; TrueSyncManagedBehaviour.OnGamePaused(generalBehaviours, behaviorsByPlayer); instance.scheduler.UpdateAllCoroutines(); &#125;// æ¸¸æˆç»§ç»­æ¶ˆæ¯å¤„ç† void OnGameUnPaused() &#123; TrueSyncManagedBehaviour.OnGameUnPaused(generalBehaviours, behaviorsByPlayer); instance.scheduler.UpdateAllCoroutines(); &#125;// æ¸¸æˆç»“æŸæ¶ˆæ¯å¤„ç† void OnGameEnded() &#123; TrueSyncManagedBehaviour.OnGameEnded(generalBehaviours, behaviorsByPlayer); instance.scheduler.UpdateAllCoroutines(); &#125;// ç§»é™¤ç‰©ç†å¯¹è±¡äº‹ä»¶å¤„ç†// ä¼šç§»é™¤è¯¥å¯¹è±¡çš„GameObjectä¸Šæ‰€æœ‰åŒæ­¥è¡Œä¸º è°ƒRemoveFromTSMBList// PhysicsManager.instance.OnRemoveBody(OnRemovedRigidBody); åœ¨è¿™é‡Œæ³¨å†Œprivate void OnRemovedRigidBody(IBody body) // ä»tsmbListåˆ—è¡¨ä¸­ï¼Œç§»é™¤behavioursprivate void RemoveFromTSMBList(List&lt;TrueSyncManagedBehaviour&gt; tsmbList, List&lt;TrueSyncBehaviour&gt; behaviours)// æ¸…ç†// æ¸…ç†å¯¹è±¡æ±  ResourcePool.CleanUpAll();// æ¸…ç†çŠ¶æ€è·Ÿè¸ª StateTracker.CleanUp();// å»é™¤å®ä¾‹å˜é‡å¼•ç”¨ instance = null;public static void CleanUp()// Unityçš„æ¶ˆæ¯ã€‚é€€å‡ºåº”ç”¨ void OnApplicationQuit() &#123; EndSimulation(); &#125; æ”¯æŒlockstepæ¨¡å¼ï¼Œä½†æ˜¯ç›®å‰æˆ‘ä»¬æ˜¯ä¸ä¼šç”¨åˆ°è¿™ä¸ªçš„ã€‚å¹¶ä¸”ä¸æ˜¯å¯é…ç½®çš„ï¼Œæ”¹é€ èµ·æ¥å¯èƒ½ä¼šæ¯”è¾ƒéº»çƒ¦ä¸€äº›ã€‚ ICommunicator12345678910public interface ICommunicator&#123; // é€šä¿¡å™¨ï¼Œåœ¨TrueSyncç®¡ç†å™¨ä¸­åˆ›å»º // å¾€è¿”æ—¶é—´ int RoundTripTime(); // æ“ä½œæ—¶é—´ void OpRaiseEvent(byte eventCode, object message, bool reliable, int[] toPlayers); // æ·»åŠ ç›‘å¬ void AddEventListener(OnEventReceived onEventReceived); &#125; PhotonTrueSyncCommunicator123456789å¸§åŒæ­¥ é€šä¿¡å™¨ï¼Œ å®ç°ICommunicatoræ¥å£// å¾€è¿”æ—¶é—´int RoundTripTime();// æ“ä½œæ—¶é—´void OpRaiseEvent(byte eventCode, object message, bool reliable, int[] toPlayers);// æ·»åŠ ç›‘å¬void AddEventListener(OnEventReceived onEventReceived); OnEventReceived123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354ä»£ç†äº‹ä»¶ï¼Œ æ¥æ”¶æ¶ˆæ¯// byte eventCode æ¶ˆæ¯ç¼–å·// object content æ¶ˆæ¯å†…å®¹private void OnEventDataReceived(byte eventCode, object content)&#123; if (eventCode == 0xc7) &#123; byte[] data = content as byte[]; SyncedData[] dataArray = SyncedData.Decode(data); if (dataArray.Length &gt; 0) &#123; TSPlayer player = this.players[dataArray[0].inputData.ownerID]; if (!player.dropped) &#123; this.OnSyncedDataReceived(player, dataArray); if ((dataArray[0].dropPlayer &amp;&amp; (player.ID != localPlayer.ID)) &amp;&amp; !this.players[dataArray[0].dropFromPlayerId].dropped) &#123; player.dropCount++; &#125; &#125; &#125; &#125; else if (eventCode == 0xc6) &#123; byte[] infoBytes = content as byte[]; OnChecksumReceived(SyncedInfo.Decode(infoBytes)); &#125; else if (eventCode == 0xc5) &#123; byte[] buffer3 = content as byte[]; if (buffer3.Length &gt; 0) &#123; if (buffer3[0] == 0) &#123; this.Pause(); &#125; else if (buffer3[0] == 1) &#123; this.Run(); &#125; else if (buffer3[0] == 3) &#123; this.End(); &#125; &#125; &#125; else if (eventCode == 0xc4) &#123; byte[] buffer4 = content as byte[]; SyncedInfo info = SyncedInfo.Decode(buffer4); players[info.playerId].sentSyncedStart = true; &#125;&#125; æ¥å£çš„å®ç°æœ‰ä¸€æ¬¡GCï¼Œå¹¶æœªå®æµ‹ TrueSyncBehaviour1234567891011121314151617å¸§åŒæ­¥è¡Œä¸ºï¼Œç»§æ‰¿è‡ª MonoBehaviour, å®ç°æ¥å£ ITrueSyncBehaviourGamePlay, ITrueSyncBehaviourCallbacks// è¯¥è¡Œä¸ºçš„æ‹¥æœ‰è€…ç©å®¶public TSPlayerInfo owner;// æœ¬åœ°ç©å®¶ï¼Œç›¸å½“äºå¿«æ·è®¿é—®æœ¬åœ°ç©å®¶ï¼Œæ­¤å¤„ä¼šè¢«åºåˆ—åŒ–ï¼Œæ”¾åˆ°é¡¹ç›®ä¸­åº”è¯¥è¦å»æ‰public TSPlayerInfo localOwner;// å¿«æ·è®¿é—®TSTransform tsTransformTSTransform2D tsTransform2DTSRigidBody tsRigidBodyTSRigidBody2D tsRigidBody2DTSCollider tsColliderTSCollider2D tsCollider2D// åŸºæœ¬ä¸Šå°±æ˜¯ä¸Šé¢è¿™äº›å±æ€§ï¼Œå®ç°çš„æ¥å£éƒ½æ˜¯ç©ºçš„æ²¡æœ‰å†™ä¸šåŠ¡é€»è¾‘ï¼Œåœ¨Monoä¸Šå±‚å°è£…äº†ä¸€å±‚ï¼ŒåŸºäºå¤šç»„ä»¶çš„æ–¹å¼ï¼Œä¸åˆ©äºECSæ‰©å±• TrueSyncManagedBehaviour12345678910å¸§åŒæ­¥è¡Œä¸ºç®¡ç†å™¨ï¼Œå®ç°æ¥å£ ITrueSyncBehaviourGamePlay, ITrueSyncBehaviour, ITrueSyncBehaviourCallbacksä¸»è¦æ˜¯åŒ…è£…äº†TrueSyncBehaviour/ITrueSyncBehaviour, å®ç°çš„æ¥å£æ–¹æ³•ç›´æ¥æ‰TrueSyncBehaviourçš„æ”¾æ–¹æ³•ï¼ŒTrueSyncBehaviourçš„OnSyncedStartLocalPlayer æ–¹æ³•è¯¥è¡Œä¸ºæ˜¯æœ¬åœ°ç”¨æˆ·æ—¶æ‰è°ƒ// æœ‰ä¸€ä¸ªå±æ€§, trueæ˜¯ï¼Œä¸ä¼šå‚ä¸å¸§æ›´æ–° [AddTracking] public bool disabled;åé¢å°±æ˜¯ä¸€äº›å…¨å±€é™æ€æ–¹æ³•ï¼Œç”¨ç®¡ç†å¤„ç†åˆ—è¡¨çš„äº‹ä»¶ç®¡ç†ä¸»è¦æ˜¯ç®¡ç†è¿™ä¸ªçš„ã€‚ CoroutineScheduler1234åç¨‹è°ƒç”¨åœ¨TrueSyncManager.SyncedStartCoroutine è°ƒ StartCoroutine(IEnumerator coroutine) å¯åŠ¨ä¸€ä¸ªåç¨‹åœ¨TrueSyncManageré©±åŠ¨UpdateAllCorutines()å†…éƒ¨åç¨‹ä½¿ç”¨é“¾è¡¨æ¥ç»´æŠ¤ï¼Œä½†æ˜¯é“¾è¡¨æ“ä½œä¼šæœ‰GCï¼Œæ¯”å¦‚Removeçš„æ—¶å€™ç›´æ¥èˆå¼ƒäº†ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨æ± å¤„ç† ITrueSyncBehaviour1234æ¥å£ å¸§åŒæ­¥è¡Œä¸ºå°±åªæœ‰ä¸€ä¸ªæ–¹æ³•// è®¾ç½®æ¸¸æˆä¿¡æ¯ (æœ¬åœ°ç©å®¶ï¼Œ ç©å®¶æ•°é‡)void SetGameInfo(TSPlayerInfo localOwner, int numberOfPlayers); ITrueSyncBehaviourGamePlay123456789æ¥å£ ç©å®¶æ“ä½œå¸§åŒæ­¥è¡Œä¸º, ç»§æ‰¿è‡ªITrueSyncBehaviourï¼ŒMonoä¸Šå±‚çš„å°è£…æ¥å£// åŒæ­¥ ç©å®¶è¾“å…¥æ“ä½œvoid OnSyncedInput();// åŒæ­¥ è¯»å–ç©å®¶æ“ä½œvoid OnSyncedUpdate();void OnPreSyncedUpdate(); ITrueSyncBehaviourCallbacks12345678910111213141516171819æ¥å£ å›è°ƒåŒæ­¥è¡Œä¸º, ç»§æ‰¿è‡ªITrueSyncBehaviourTrueSyncBehaviourå®ç°ï¼šè¡¨ç¤ºåœ¨è¿æ¥åˆ°æ¸¸æˆçš„æ¯å°æœºå™¨ä¸Šæ¨¡æ‹Ÿçš„æ¯ä¸ªç©å®¶çš„è¡Œä¸ºã€‚// å¼€å§‹void OnSyncedStart();// å¼€å§‹ -- åªè°ƒæœ¬åœ°ç©å®¶çš„void OnSyncedStartLocalPlayer();// æ¸¸æˆæš‚åœvoid OnGamePaused();// æ¸¸æˆç»§ç»­void OnGameUnPaused();// æ¸¸æˆç»“æŸçš„æ—¶å€™è°ƒç”¨void OnGameEnded();// æœ‰ç©å®¶ç¦»çº¿æ—¶è°ƒç”¨void OnPlayerDisconnection(int playerId); TSRandom123456éšæœºæ•°http://www.codeproject.com/Articles/164087/Random-Number-Generationhttps://github.com/ihaiucom/learn.PhotonTrueSync/blob/master/PhotonGame/Assets/TrueSync/Engine/Math/TSRandom.csåŸç†æ˜¯ï¼Œä¼ ä¸€ä¸ªå› ç´ è¿›å»ï¼Œç„¶åé‡Œé¢ç”ŸæˆNæ•°é‡çš„æ•°ç»„ã€‚æ¯ä¸ªæ•°æœ‰ä¸€ä¸ªå…¬å¼è®¡ç®—æ¥ç”Ÿæˆã€‚æ‰€ä»¥ä¼ ç›¸åŒçš„å› ç´ ç”Ÿæˆçš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚è·å–éšæœºæ•°çš„æ—¶å€™æ ¹æ®å½“å‰ç´¢å¼•mtiä¾æ¬¡è¯»å–æ•°ç»„é‡Œé¢çš„æ•°ã€‚å½“mtiå¤§äºNæ—¶ï¼Œå†…éƒ¨é‡æ–°ç”Ÿæˆé»˜è®¤å› ç´ æ˜¯5489U Random-Number-GenerationTrueSync/Engine/Math/TSRandom.cs StateTracker.TrackedInfo123456çŠ¶æ€è·Ÿè¸ªä¿¡æ¯ï¼Œ ç”¨æ¥ä¿å­˜å¯¹è±¡å¼•ç”¨ï¼Œå’Œå¯¹è±¡çš„æˆå‘˜å±æ€§ä¿¡æ¯MemberInfointernal class TrackedInfo&#123; public object relatedObj; // ä¿å­˜å¯¹è±¡ public MemberInfo propInfo; // å¯¹è±¡çš„æˆå‘˜å±æ€§ä¿¡æ¯&#125; æ•ˆç‡ç•¥ä½ StateTracker.State12345678910111213141516171819202122232425262728293031323334353637383940414243// çŠ¶æ€è·Ÿè¸ªä¿¡æ¯ï¼Œ æŒæœ‰TrackedInfoè·Ÿè¸ªä¿¡æ¯internal class State&#123; private StateTracker.TrackedInfo trackedInfo; private object value; public void SetInfo(StateTracker.TrackedInfo trackedInfo) &#123; this.trackedInfo = trackedInfo; this.SaveValue(); &#125; // ä¿å­˜å€¼åˆ°valueå˜é‡ public void SaveValue() &#123; object obj = this.trackedInfo.propInfo.GetValue(this.trackedInfo.relatedObj); if (obj != null) &#123; if (obj.GetType().IsArray) &#123; this.value = (object) Array.CreateInstance(obj.GetType().GetElementType(), ((Array) obj).Length); Array.Copy((Array) obj, (Array) this.value, ((Array) obj).Length); &#125; else this.value = obj; &#125; else this.value = (object) null; &#125; // å°†ä¿å­˜çš„å€¼ç”¨åå°„èµ‹å€¼ç»™å¯¹è±¡ public void RestoreValue() &#123; if (this.trackedInfo.relatedObj == null) return; if (this.value is Array) &#123; Array instance = Array.CreateInstance(this.value.GetType().GetElementType(), ((Array) this.value).Length); Array.Copy((Array) this.value, instance, ((Array) this.value).Length); this.trackedInfo.propInfo.SetValue(this.trackedInfo.relatedObj, (object) instance); &#125; else this.trackedInfo.propInfo.SetValue(this.trackedInfo.relatedObj, this.value); &#125;&#125; StateTracker12345678910111213141516171819// çŠ¶æ€è·Ÿè¸ª// TSRandom ç”¨åˆ°StateTracker.AddTracking(r, "mt"); // å­—ç¬¦ä¸²æ‹¼æ¥StateTracker.AddTracking(r, "mti");//TrueSyncManager ç”¨åˆ°StateTracker.AddTracking(this, "time");//TSTransform ç”¨åˆ° é…åˆ [AddTracking] Attribute ä½¿ç”¨, StateTracker.AddTracking(object obj)é€šè¿‡åå°„è·å–objçš„æˆå‘˜å˜é‡StateTracker.AddTracking(this);// TrueSyncManagedBehaviour ç”¨åˆ°StateTracker.AddTracking(this);StateTracker.AddTracking(trueSyncBehavior);// è¿™ä¸ªæ˜¯æ ¸å¿ƒäº†ï¼Œ é‡Œé¢ä¿å­˜äº† rollbackWindow æ•°é‡çš„åˆ—è¡¨ï¼ŒAddTrackingçš„æ—¶å€™å›æŠŠStateTracker.State æ·»åŠ åˆ°æ‰€æœ‰åˆ—è¡¨é‡Œ// SaveState çš„æ—¶å€™å°±ä¿å­˜GenericBufferWindowå½“å‰åˆ—è¡¨çš„, ä¿å­˜å®Œåå°±GenericBufferWindowçš„ç´¢å¼•ç§»åŠ¨ä¸‹ä¸€ä¸ª// RestoreState ä»GenericBufferWindowå½“å‰çš„åˆ—è¡¨æŠŠå€¼æ¢å¤StateTracker.instance.states = new GenericBufferWindow&lt;List&lt;StateTracker.State&gt;&gt;(rollbackWindow); GenericBufferWindow12345678// é€šç”¨ç¼“å­˜çª—å£ï¼Œå’Œlistç›¸æ¯”å¤šäº†ä¸€ä¸ªå‰é©±ï¼Œéœ€è¦è‡ªå·±è°ƒç”¨Resize(ä¼šæœ‰GCæ¶ˆè€—)ï¼Œæ˜¯ä¸€ä¸ªæ³›å‹æ•°æ®ç»“æ„// StateTracker ç”¨åˆ°StateTracker.instance.states = new GenericBufferWindow&lt;List&lt;StateTracker.State&gt;&gt;(rollbackWindow);// CompoundStats ç”¨åˆ°this.bufferStats = new GenericBufferWindow&lt;Stats&gt;(10);// AbstractLockstep ç”¨åˆ° this.bufferSyncedInfo = new GenericBufferWindow&lt;SyncedInfo&gt;(3);// æ„é€ æ–¹æ³•ï¼š ä¼šåˆ›å»ºä¸€ä¸ªT[size] çš„æ•°ç»„bufferï¼Œå¹¶ä¸”å®ä¾‹åŒ–T ResourcePool å¯¹è±¡æ± 123456789101112131415161718//ResourcePool å†…éƒ¨ä½¿ç”¨Stackå®ç°//æ˜¯ä¸€ä¸ªæŠ½è±¡å¯¹è±¡æ± ,ä»–æœ‰ä¸€ä¸ªé™æ€å¯¹è±¡æ± åˆ—è¡¨ã€‚ä»–ç®¡ç†æ‰€æœ‰å¯¹è±¡æ± çš„æ¸…ç†CleanUpAll();ResourcePool&lt;T&gt; æ˜¯ResourcePoolæ´¾ç”Ÿç±»ã€‚é‡Œé¢æœ‰ä¸€ä¸ªå¯¹è±¡æ ˆå­˜å‚¨ç©ºé—²çš„å¯¹è±¡ã€‚// è¿˜å›å¯¹è±¡GiveBack(T obj)// è·å–å¯¹è±¡, å¦‚æœTæ˜¯ResourcePoolItemçš„æ´¾ç”Ÿç±»å°±ä¼šè°ƒå¯¹è±¡çš„CleanUp()æ–¹æ³•T GetNew()// å®ä¾‹åŒ–å¯¹è±¡T NewInstance()ResourcePoolItem æ˜¯å¯¹è±¡æ± å¯¹è±¡æ¥å£ï¼Œå®ç°è¯¥æ¥å£çš„å¯¹è±¡åœ¨è·å–å¯¹è±¡æ—¶ä¼šè°ƒCleanUp()æ–¹æ³•ã€ä½¿ç”¨ã€‘internal class ResourcePoolListSyncedData : ResourcePool&lt;List&lt;SyncedData&gt;&gt;internal class ResourcePoolStateTrackerState : ResourcePool&lt;StateTracker.State&gt;internal class ResourcePoolSyncedData : ResourcePool&lt;SyncedData&gt; SerializableDictionary1234567891011public class SerializableDictionary&lt;TKey, TValue&gt; : Dictionary&lt;TKey, TValue&gt;, ISerializationCallbackReceiverå…¶å®å°±æ˜¯ä¸€ä¸ªDictionary, ç„¶åå®ç°äº†Unityçš„æ¥å£ISerializationCallbackReceiverã€‚OnBeforeSerializeã€OnAfterDeserializeæ´¾ç”Ÿç±»public class SerializableDictionaryByteByte : SerializableDictionary&lt;byte, byte&gt;public class SerializableDictionaryByteByteArray : SerializableDictionary&lt;byte, byte[]&gt;public class SerializableDictionaryByteInt : SerializableDictionary&lt;byte, int&gt;public class SerializableDictionaryBytePlayer : SerializableDictionary&lt;byte, TSPlayer&gt;public class SerializableDictionaryByteString : SerializableDictionary&lt;byte, string&gt;public class SerializableDictionaryIntSyncedData : SerializableDictionary&lt;int, SyncedData&gt; InputData123456789æ‹¥æœ‰å„ä¸ªåŸºæœ¬ç±»å‹åºåˆ—åŒ–å­—å…¸åºåˆ—åŒ–å’Œè§£æéƒ½æ˜¯å¯¹è¿™äº›è§£ç»‘ç±»å‹å­—å…¸æ¯ä¸ªå€¼çš„åºåˆ—åŒ–:key, valueType, valueæ•°ç»„çš„: key, valueType, length, value[]å­—ç¬¦ä¸²çš„ç”¨char[] ä¹Ÿå°±æ˜¯æ•°ç»„ç„¶åæœ‰å„ä¸ªç±»å‹çš„AddXXå’ŒGetXX SyncedInfo12345678910111213141516171819åŒæ­¥ä¿¡æ¯ï¼Œä¿å­˜äº†3ä¸ªå±æ€§ // ç©å®¶ID public byte playerId; // å¸§ public int tick; // æ ¡éªŒç  public string checksum;2 ä¸ªæ–¹æ³•// åºåˆ—åŒ–public static byte[] Encode(SyncedInfo info)// è§£æpublic static SyncedInfo Decode(byte[] infoBytes) SyncedData1234567891011121314151617181920// åŒæ­¥æ•°æ®// ä¸»è¦å°±åºåˆ—åŒ–ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•çš„æ•°æ®public void GetEncodedHeader(List bytes)&#123; // å¸§ Utils.GetBytes(this.tick, bytes); // æ‹¥æœ‰è€…ç©å®¶ID bytes.Add(this.inputData.ownerID); // ä»å“ªä¸ªç©å®¶æ‰çº¿ bytes.Add(this.dropFromPlayerId); // æ˜¯å¦æ‰çº¿ bytes.Add(this.dropPlayer ? 1 : 0);&#125;public void GetEncodedActions(List bytes)&#123; this.inputData.Serialize(bytes);&#125; TSPlayerInfo123456789//ç©å®¶ä¿¡æ¯,ä¿å­˜2ä¸ªå±æ€§// ç©å®¶ID[SerializeField]internal byte id;// ç©å®¶åç§°[SerializeField]internal string name; TSPlayer123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174// ç©å®¶// ç©å®¶ä¿¡æ¯[SerializeField]public TSPlayerInfo playerInfo;// æ‰çº¿æ¬¡æ•°[NonSerialized]public int dropCount;//æ˜¯å¦æ‰çº¿[NonSerialized]public bool dropped;// å¼€å§‹å‘é€åŒæ­¥æ•°æ®[NonSerialized]public bool sentSyncedStart;// ä¿å­˜ç©å®¶æ•´ä¸ªæˆ˜æ–—çš„æ“ä½œåŒæ­¥æ•°æ®, ä»–æ˜¯ä¸€ä¸ªå­—å…¸SerializableDictionary&lt;int, SyncedData&gt;[SerializeField]internal SerializableDictionaryIntSyncedData controls;// æœ€åä¸€æ¬¡ åŒæ­¥æ“ä½œæ•°æ®çš„å¸§, AddData(SyncedData data)private int lastTick;internal TSPlayer(byte id, string name)&#123; // åˆ›å»ºç©å®¶ä¿¡æ¯ playerInfo = new TSPlayerInfo(id, name); dropCount = 0; dropped = false; // åˆ›å»ºç©å®¶æ“ä½œå­—å…¸å­˜å‚¨å™¨ controls = new SerializableDictionaryIntSyncedData();&#125;// è·å–æŸå¸§æ˜¯å¦æœ‰çœŸå®åŒæ­¥æ“ä½œæ•°æ®public bool IsDataReady(int tick)&#123; return controls.ContainsKey(tick) &amp;&amp; !controls[tick].fake;&#125;// è·å–æŸå¸§æ˜¯å¦æœ‰æ¨¡æ‹ŸåŒæ­¥æ“ä½œæ•°æ®, å®¢æˆ·ç«¯å…ˆè¡Œï¼Œæ˜¯å®¢æˆ·ç«¯é¢„æµ‹çš„æ“ä½œ, å›æ»šæ·»åŠ çš„ã€‚public bool IsDataDirty(int tick)&#123; bool flag = this.controls.ContainsKey(tick); return flag &amp;&amp; this.controls[tick].dirty;&#125;// è·å–è¯¥å¸§çš„åŒæ­¥æ“ä½œæ•°æ®public SyncedData GetData(int tick)&#123; if (!controls.ContainsKey(tick)) &#123; // å¦‚æœä¸å­˜åœ¨ï¼Œå°±æŸ¥æ‰¾ä¸Šä¸€å¸§æ˜¯å¦å­˜åœ¨ SyncedData data = null; if (controls.ContainsKey(tick - 1)) &#123; // å¦‚æœå­˜åœ¨ä¸Šä¸€å¸§ï¼Œå°±å…‹éš†ä¸Šä¸€å¸§çš„åŒæ­¥æ•°æ® data = controls[tick - 1].clone(); data.tick = tick; &#125; else &#123; // å¦åˆ™å°±æ–°å»ºä¸€ä¸ªåŒæ­¥æ•°æ® data = new SyncedData(ID, tick); &#125; // è®¾ç½®ä¸ºä¼ªé€ çš„ data.fake = true; // ä¿å­˜åˆ°å¸§å­—å…¸ this.controls[tick] = data; return data; &#125; // å¦‚æœå­˜åœ¨è¯¥,å°±è¿”å›è¯¥å¸§æ•°æ® return controls[tick];&#125;// æ·»åŠ å­˜åœ¨å¸§åŒæ­¥æ•°æ®public void AddData(SyncedData data)&#123; int tick = data.tick; bool flag = this.controls.ContainsKey(tick); if (flag) &#123; // å¦‚æœå·²ç»å­˜åœ¨ï¼Œå°±è¿˜ç»™å¯¹è±¡æ±  SyncedData.pool.GiveBack(data); &#125; else &#123; // å¦åˆ™ æ·»åŠ åˆ°å­˜å‚¨é‡Œ this.controls[tick] = data; // è®¾ç½®æœ€åå­˜å‚¨çš„å¸§ this.lastTick = tick; &#125;&#125;ReplayRecordå½•åƒè´Ÿè´£è®°å½•æ¸¸æˆæ˜¯æ‰€æœ‰ç©å®¶çš„SynceDataåºåˆ—åŒ–: å„ä¸ªç©å®¶çš„æ‰€æœ‰æ“ä½œAbstractLockstep.SimulationStateå¸§åŒæ­¥æ¨¡æ‹Ÿå™¨çŠ¶æ€private enum SimulationState&#123; // æ²¡å¯åŠ¨ NOT_STARTED, // ç­‰å¾…ç©å®¶ WAITING_PLAYERS, // è¿è¡Œä¸­ RUNNING, // æš‚åœ PAUSED, // ç»“æŸ ENDED&#125;AbstractLockstepå¸§åŒæ­¥æŠ½è±¡åŸºç±»// ç©å®¶åˆå§‹å®¹é‡ private const int INITIAL_PLAYERS_CAPACITY = 4;// åŒæ­¥æ¸¸æˆå¼€å§‹ç¼–ç  private const byte SYNCED_GAME_START_CODE = 196;// æ¨¡æ‹Ÿå™¨ç¼–ç  (0 æš‚åœ, 1 ç¬¬ä¸€æ¬¡å¯åŠ¨, 3 End) private const byte SIMULATION_CODE = 197;// éªŒè¯ç ç¼–ç  private const byte CHECKSUM_CODE = 198;// å‘é€ç¼–ç  private const byte SEND_CODE = 199;// æ¨¡æ‹Ÿå™¨æ—¶é—´--æš‚åœ private const byte SIMULATION_EVENT_PAUSE = 0;// æ¨¡æ‹Ÿå™¨æ—¶é—´--è¿è¡Œ private const byte SIMULATION_EVENT_RUN = 1;// æ¨¡æ‹Ÿå™¨æ—¶é—´--ç»“æŸ private const byte SIMULATION_EVENT_END = 3;// æ¸¸æˆç»“æŸå‰ æœ€å¤§ç­‰å¾…æ‰€æœ‰ç©å®¶è¾“å…¥çš„å¸§ private const int MAX_PANIC_BEFORE_END_GAME = 5;// åŒæ­¥ä¿¡æ¯ ç¼“å­˜çª—å£ private const int SYNCED_INFO_BUFFER_WINDOW = 3;// æ·»åŠ ç©å®¶// internal Dictionary&lt;byte, TSPlayer&gt; players;// internal List activePlayers;// this.localPlayer = tSPlayer;public void AddPlayer(byte playerId, string playerName, bool isLocal)// æ›´æ–°åœ¨çº¿çš„å…¶ä»–ç©å®¶IDåˆ—è¡¨internal void UpdateActivePlayers()// è¿è¡Œæ¨¡æ‹Ÿå™¨// TrueSyncStatsçš„Updateé‡Œæ£€æµ‹è°ƒ lockstep.RunSimulation(true);// CheckGameStart() é‡Œè°ƒ RunSimulation(false);public void RunSimulation(bool firstRun)// æ›´æ–°è®¾ç½®simulationStateæ¨¡æ‹Ÿå™¨çŠ¶æ€, å’Œè°ƒå¯¹åº”çš„å›è°ƒ(OnGameStarted, OnGameUnPaused)// RunSimulation() é‡Œè°ƒ// private void OnEventDataReceived(byte eventCode, object content) é‡Œè°ƒprivate void Run()// å‘é€æ“ä½œ// è°ƒé€šä¿¡å™¨ this.communicator.OpRaiseEvent(eventCode, message, reliable, toPlayers);private void RaiseEvent(byte eventCode, object message)private void RaiseEvent(byte eventCode, object message, bool reliable, int[] toPlayers) ThreadManager123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113using System;using System.Collections.Generic;using System.Threading;namespace EventSource&#123; public class ThreadManager &#123; private static ThreadManager instance; private volatile List&lt;Action&lt;object&gt;&gt; tasks = new List&lt;Action&lt;object&gt;&gt;(); private volatile List&lt;object&gt; parameters = new List&lt;object&gt;(); private ManualResetEvent waitHandleA; private ManualResetEvent waitHandleB; private ManualResetEvent currentWaitHandle; private Thread[] threads; private int currentTaskIndex; private int waitingThreadCount; internal int threadCount; public int ThreadCount &#123; private set &#123; threadCount = value; &#125; get &#123; return threadCount; &#125; &#125; public static ThreadManager Instance &#123; get &#123; if (instance == null) &#123; instance = new ThreadManager(); instance.Initialize(); &#125; return instance; &#125; &#125; private ThreadManager() &#123; &#125; // ä¸‹é¢è¿™ç§å†™æ³•æ„Ÿè§‰æ²¡æœ‰åˆ‡æ¢æ—¶é—´çš„æ¦‚å¿µå‘€ï¼Œè¯¥è¿›ç¨‹å†…éƒ¨ä¸ä¼šå‘é€åˆ‡æ¢æ—¶é—´ç‰‡å‘€ private void Initialize() &#123; threadCount = Environment.ProcessorCount; threads = new Thread[threadCount]; waitHandleA = new ManualResetEvent(false); waitHandleB = new ManualResetEvent(false); currentWaitHandle = waitHandleA; var initWaitHandle = new AutoResetEvent(false); for (var index = 1; index &lt; threads.Length; index++) &#123; threads[index] = new Thread(() =&gt; &#123; initWaitHandle.Set(); ThreadProc(); &#125;) &#123; IsBackground = true &#125;; threads[index].Start(); initWaitHandle.WaitOne(); &#125; &#125; public void Execute() &#123; currentTaskIndex = 0; waitingThreadCount = 0; currentWaitHandle.Set(); PumpTasks(); while (waitingThreadCount &lt; threads.Length - 1) &#123; Thread.Sleep(0); &#125; currentWaitHandle.Reset(); currentWaitHandle = currentWaitHandle == waitHandleA ? waitHandleB : waitHandleA; tasks.Clear(); parameters.Clear(); &#125; public void AddTask(Action&lt;object&gt; task, object param) &#123; tasks.Add(task); parameters.Add(param); &#125; private void ThreadProc() &#123; while (true) &#123; Interlocked.Increment(ref waitingThreadCount); waitHandleA.WaitOne(); PumpTasks(); Interlocked.Increment(ref waitingThreadCount); waitHandleB.WaitOne(); PumpTasks(); &#125; &#125; private void PumpTasks() &#123; var count = tasks.Count; while (currentTaskIndex &lt; count) &#123; var curTaskIndex = currentTaskIndex; if (curTaskIndex == Interlocked.CompareExchange(ref currentTaskIndex, curTaskIndex + 1, curTaskIndex) &amp;&amp; currentTaskIndex &lt; count) tasks[currentTaskIndex](parameters[currentTaskIndex]); &#125; &#125; &#125;&#125;]]></content>
      <tags>
        <tag>Network</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity3Dæ¸¸æˆGCä¼˜åŒ–æ€»ç»“---protobuf-netæ— GCç‰ˆæœ¬ä¼˜åŒ–å®è·µ]]></title>
    <url>%2F2019%2F04%2F24%2Fprotobuf-net-no-gc%2F</url>
    <content type="text"><![CDATA[protobuf-netä¼˜åŒ–æ•ˆæœå›¾protobuf-netæ˜¯Unity3Dæ¸¸æˆå¼€å‘ä¸­è¢«å¹¿æ³›ä½¿ç”¨çš„Google Protocol Bufferåº“çš„c#ç‰ˆæœ¬ï¼Œä¹‹æ‰€ä»¥c#ç‰ˆæœ¬è¢«å¹¿æ³›ä½¿ç”¨ï¼Œæ˜¯å› ä¸ºc++ç‰ˆæœ¬çš„æºä»£ç ä¸æ”¯æŒUnity3Dæ¸¸æˆåœ¨å„ä¸ªå¹³å°ä¸Šçš„åŠ¨æ€åº“æ„å»ºã€‚å®ƒæ˜¯ä¸€ä¸ªç½‘ç»œä¼ è¾“å±‚åè®®ï¼Œå¯¹åº”çš„luaç‰ˆæœ¬æœ‰ä¸¤ä¸ªå¯ç”¨çš„åº“ï¼šä¸€ä¸ªæ˜¯proto-gen-luaï¼Œç”±toluaä½œè€…å¼€å‘ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯protocï¼Œç”±äº‘é£å¼€å‘ã€‚protobuf-netåœ¨GCä¸Šæœ‰å¾ˆå¤§çš„é—®é¢˜ï¼Œåœ¨ä¸€ä¸ªé«˜é¢‘ç‡ç½‘ç»œé€šè®¯çš„çŠ¶æ€åŒæ­¥æ¸¸æˆä¸­ä½¿ç”¨å‘ç°GCè¿‡é«˜ï¼Œæ‰€ä»¥å¯¹å®ƒè¿›è¡Œäº†ä¸€æ¬¡æ¯”è¾ƒå½»åº•çš„GCä¼˜åŒ–ã€‚ä¸‹é¢æ˜¯ä¼˜åŒ–å‰åçš„å¯¹æ¯”å›¾ï¼š Unity3Dæ¸¸æˆGCä¼˜åŒ–æ¦‚è¿°æœ‰å…³Unity3Dåƒåœ¾å›æ”¶çš„åŸºæœ¬æ¦‚å¿µå’Œä¼˜åŒ–ç­–ç•¥Unityå®˜ç½‘æœ‰å‘å¸ƒè¿‡æ–‡ç« ï¼šOptimizing garbage collection in Unity games&gt;ã€‚è¿™ç¯‡æ–‡ç« è®²è¿°äº†Unity3Dåƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå’Œä¸€äº›ç®€å•çš„ä¼˜åŒ–ç­–ç•¥ï¼Œè®¨è®ºçš„ä¸æ˜¯ç‰¹åˆ«æ·±å…¥ï¼Œä½†æ˜¯å¹¿åº¦åŸºæœ¬ä¸Šç®—æ˜¯å¤Ÿäº†ã€‚ C#å˜é‡åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼šå€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹ï¼Œå€¼ç±»å‹åˆ†é…åœ¨æ ˆåŒºï¼Œå¼•ç”¨ç±»å‹åˆ†é…åœ¨å †åŒºï¼ŒGCå…³æ³¨å¼•ç”¨ç±»å‹ GCå¡é¡¿åŸå› ï¼šå †å†…å­˜åƒåœ¾å›æ”¶ï¼Œå‘ç³»ç»Ÿç”³è¯·æ–°çš„å †å†…å­˜ GCè§¦å‘æ¡ä»¶ï¼šå †å†…å­˜åˆ†é…è€Œå½“å†…å­˜ä¸è¶³æ—¶ã€æŒ‰é¢‘ç‡è‡ªåŠ¨è§¦å‘ã€æ‰‹åŠ¨å¼ºè¡Œè§¦å‘ï¼ˆä¸€èˆ¬ç”¨åœ¨åœºæ™¯åˆ‡æ¢ï¼‰ GCè´Ÿé¢æ•ˆæœï¼šå†…å­˜ç¢ç‰‡ï¼ˆå¯¼è‡´å†…å­˜å˜å¤§ï¼ŒGCè§¦å‘æ›´åŠ é¢‘ç¹ï¼‰ã€æ¸¸æˆé¡¿å¡ GCä¼˜åŒ–æ–¹å‘ï¼šå‡å°‘GCæ¬¡æ•°ã€é™ä½å•æ¬¡GCè¿è¡Œæ—¶é—´ã€åœºæ™¯åˆ‡æ¢æ—¶ä¸»åŠ¨GC GCä¼˜åŒ–ç­–ç•¥ï¼šå‡å°‘å¯¹å†…å­˜åˆ†é…æ¬¡æ•°å’Œå¼•ç”¨æ¬¡æ•°ã€é™ä½å †å†…å­˜åˆ†é…å’Œå›æ”¶é¢‘ç‡ å–„ç”¨ç¼“å­˜ï¼šå¯¹æœ‰å †å†…å­˜åˆ†é…çš„å‡½æ•°ï¼Œç¼“å­˜å…¶è°ƒç”¨ç»“æœï¼Œä¸è¦åå¤å»è°ƒç”¨ æ¸…é™¤åˆ—è¡¨ï¼šè€Œä¸è¦æ¯æ¬¡éƒ½å»newä¸€ä¸ªæ–°çš„åˆ—è¡¨ ç”¨å¯¹è±¡æ± ï¼šå¿…ç”¨ æ…ç”¨ä¸²æ‹¼æ¥ï¼šç¼“å­˜ã€Textç»„ä»¶æ‹†åˆ†ã€ä½¿ç”¨StringBuildã€Debug.Logæ¥å£å°è£…ï¼ˆæ‰“Conditionalæ ‡ç­¾ï¼‰ è­¦æƒ•Unityå‡½æ•°è°ƒç”¨ï¼šGameObject.nameã€GameObject.tagã€FindObjectsOfType()ç­‰ä¼—å¤šå‡½æ•°éƒ½æœ‰å †å†…å­˜åˆ†é…ï¼Œå®æµ‹ä¸ºå‡† é¿å…è£…ç®±ï¼šæ…ç”¨objectå½¢å‚ã€å¤šç”¨æ³›å‹ç‰ˆæœ¬ï¼ˆå¦‚Listï¼‰ç­‰ï¼Œè¿™é‡Œçš„ç»†èŠ‚é—®é¢˜å¾ˆå¤šï¼Œå®æµ‹ä¸ºå‡† è­¦æƒ•åç¨‹ï¼šStartCoroutineæœ‰GCã€yield returnå¸¦è¿”å›å€¼æœ‰GCã€yield return new xxxæœ‰GCï¼ˆæœ€å¥½è‡ªå·±åšä¸€å¥—åç¨‹ç®¡ç†ï¼‰ foreachï¼šunity5.5ä¹‹å‰ç‰ˆæœ¬æœ‰GCï¼Œä½¿ç”¨forå¾ªç¯æˆ–è€…è·å–è¿­ä»£å™¨ å‡å°‘å¼•ç”¨ï¼šå»ºç«‹ç®¡ç†ç±»ç»Ÿä¸€ç®¡ç†ï¼Œä½¿ç”¨IDä½œä¸ºè®¿é—®token æ…ç”¨LINQï¼šè¿™ä¸œè¥¿æœ€å¥½ä¸ç”¨ï¼ŒGCå¾ˆé«˜ ç»“æ„ä½“æ•°ç»„ï¼šå¦‚æœç»“æ„ä½“ä¸­å«æœ‰å¼•ç”¨ç±»å‹å˜é‡ï¼Œå¯¹ç»“æ„ä½“æ•°ç»„è¿›è¡Œæ‹†åˆ†ï¼Œé¿å…GCæ—¶éå†æ‰€æœ‰ç»“æ„ä½“æˆå‘˜ åœ¨æ¸¸æˆç©ºé—²ï¼ˆå¦‚åœºæ™¯åˆ‡æ¢æ—¶ï¼‰å¼ºåˆ¶æ‰§è¡ŒGC protobuf-net GCåˆ†æprotobuf-netåºåˆ—åŒ–å…ˆåˆ†æä¸‹åºåˆ—åŒ–GCï¼Œdeep profileå¦‚ä¸‹ï¼š æ‰“å¼€PropertyDecorator.csè„šæœ¬ï¼Œæ‰¾åˆ°Writeå‡½æ•°å¦‚ä¸‹ï¼š 123456public override void Write(object value, ProtoWriter dest)&#123; Helpers.DebugAssert(value != null); value = property.GetValue(value, null); if(value != null) Tail.Write(value, dest);&#125; å¯ä»¥çœ‹åˆ°è¿™é‡ŒMonoProperty.GetValueäº§ç”ŸGCçš„åŸå› æ˜¯å› ä¸ºåå°„çš„ä½¿ç”¨ï¼›è€ŒListDecorator.Writeå¯¹åº”äºä»£ç Tail.Writeï¼Œç»§ç»­å¾€ä¸‹çœ‹ï¼šæ‰¾åˆ°å¯¹åº”æºä»£ç ï¼š12345678910111213141516171819202122232425public override void Write(object value, ProtoWriter dest)&#123; SubItemToken token; bool writePacked = WritePacked; if (writePacked) &#123; ProtoWriter.WriteFieldHeader(fieldNumber, WireType.String, dest); token = ProtoWriter.StartSubItem(value, dest); ProtoWriter.SetPackedField(fieldNumber, dest); &#125; else &#123; token = new SubItemToken(); // default &#125; bool checkForNull = !SupportNull; foreach (object subItem in (IEnumerable)value) &#123; if (checkForNull &amp;&amp; subItem == null) &#123; throw new NullReferenceException(); &#125; Tail.Write(subItem, dest); &#125; if (writePacked) &#123; ProtoWriter.EndSubItem(token, dest); &#125;&#125; å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„GCæ˜¯ç”±listéå†çš„foreachå¼•èµ·çš„ã€‚ç»§ç»­å¾€å†…å±•å¼€ï¼Œäº§ç”ŸGCçš„ç‚¹å…¨éƒ¨æ˜¯è¿™ä¸¤ä¸ªåŸå› ä¸Šã€‚ protobuf-netååºåˆ—åŒ–æ‰¾åˆ°ç¬¬ä¸€ä¸ªäº§ç”ŸGCçš„åˆ†æ”¯ï¼š åŒä¸Šè¿°åˆ†æï¼ŒMonoProperty.GetValueã€MonoProperty.SetValueäº§ç”ŸGCåŸå› æ˜¯åå°„ã€‚è€ŒInt32Serializer.Read()ä»£ç å¦‚ä¸‹ï¼š12345public object Read(object value, ProtoReader source)&#123; Helpers.DebugAssert(value == null); // since replaces return source.ReadInt32();&#125; å¯è§äº§ç”ŸGCçš„åŸå› æ˜¯å› ä¸ºè£…ç®±ã€‚ç»§ç»­å¾€ä¸‹å±•å¼€ListDecorateor.Readå‡½æ•°ï¼šç”±Activator.CreateInstanceå¾—å‡ºè¿™é‡Œäº§ç”ŸGCçš„åŸå› æ˜¯å®ä¾‹çš„åˆ›å»ºã€‚ç»§ç»­å¾€ä¸‹å±•å¼€ï¼šåå°„å’Œè£…ç®±äº§ç”ŸGCä¸Šé¢å·²ç»æåˆ°ï¼Œçœ‹ProtoReader.AppendBytesä»£ç ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051public static byte[] AppendBytes(byte[] value, ProtoReader reader)&#123; if (reader == null) throw new ArgumentNullException("reader"); switch (reader.wireType) &#123; case WireType.String: int len = (int)reader.ReadUInt32Variant(false); reader.wireType = WireType.None; if (len == 0) return value == null ? EmptyBlob : value; int offset; if (value == null || value.Length == 0) &#123; offset = 0; value = new byte[len]; &#125; else &#123; offset = value.Length; byte[] tmp = new byte[value.Length + len]; Helpers.BlockCopy(value, 0, tmp, 0, value.Length); value = tmp; &#125; // value is now sized with the final length, and (if necessary) // contains the old data up to "offset" reader.position += len; // assume success while (len &gt; reader.available) &#123; if (reader.available &gt; 0) &#123; // copy what we *do* have Helpers.BlockCopy(reader.ioBuffer, reader.ioIndex, value, offset, reader.available); len -= reader.available; offset += reader.available; reader.ioIndex = reader.available = 0; // we've drained the buffer &#125; // now refill the buffer (without overflowing it) int count = len &gt; reader.ioBuffer.Length ? reader.ioBuffer.Length : len; if (count &gt; 0) reader.Ensure(count, true); &#125; // at this point, we know that len &lt;= available if (len &gt; 0) &#123; // still need data, but we have enough buffered Helpers.BlockCopy(reader.ioBuffer, reader.ioIndex, value, offset, len); reader.ioIndex += len; reader.available -= len; &#125; return value; default: throw reader.CreateWireTypeException(); &#125;&#125; å¯è§ï¼Œè¿™é‡Œäº§ç”ŸGCçš„åŸå› æ˜¯å› ä¸ºnew byte[]æ“ä½œã€‚ Protobuf-net GCä¼˜åŒ–æ–¹æ¡ˆprotobuf-netåœ¨æœ¬æ¬¡åè®®æµ‹è¯•ä¸­GCäº§ç”Ÿçš„åŸå› æ€»ç»“å¦‚ä¸‹ï¼š åå°„ forearch è£…ç®± åˆ›å»ºæ–°çš„pbå¯¹è±¡ åˆ›å»ºæ–°çš„å­—èŠ‚æ•°ç»„ å»åå°„ç”¨è¿‡luaçš„äººéƒ½çŸ¥é“ï¼Œä¸ç®¡æ˜¯toluaè¿˜æ˜¯xluaï¼Œå»åå°„çš„æ–¹å¼æ˜¯ç”Ÿæˆwrapæ–‡ä»¶ï¼Œè¿™é‡Œå»åå°„å¯ä»¥å€Ÿé‰´åŒæ ·çš„æ€æƒ³ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566using CustomDataStruct;using ProtoBuf.Serializers;namespace battle&#123; public sealed class NtfBattleFrameDataDecorator : ICustomProtoSerializer &#123; public void SetValue(object target, object value, int fieldNumber) &#123; ntf_battle_frame_data data = target as ntf_battle_frame_data; if (data == null) &#123; return; &#125; switch (fieldNumber) &#123; case 1: data.time = ValueObject.Value&lt;int&gt;(value); break; case 3: data.slot_list.Add((ntf_battle_frame_data.one_slot)value); break; case 5: data.server_from_slot = ValueObject.Value&lt;int&gt;(value); break; case 6: data.server_to_slot = ValueObject.Value&lt;int&gt;(value); break; case 7: data.server_curr_frame = ValueObject.Value&lt;int&gt;(value); break; case 8: data.is_check_frame = ValueObject.Value&lt;int&gt;(value); break; default: break; &#125; &#125; public object GetValue(object target, int fieldNumber) &#123; ntf_battle_frame_data data = target as ntf_battle_frame_data; if (data == null) &#123; return null; &#125; switch (fieldNumber) &#123; case 1: return ValueObject.Get(data.time); case 3: return data.slot_list; case 5: return ValueObject.Get(data.server_from_slot); case 6: return ValueObject.Get(data.server_to_slot); case 7: return ValueObject.Get(data.server_curr_frame); &#125; return null; &#125; &#125;&#125; åå°„äº§ç”Ÿçš„åœ°æ–¹åœ¨protobuf-netçš„è£…é¥°ç±»ä¸­ï¼Œå…·ä½“æ˜¯PropertyDecoratorï¼Œæˆ‘è¿™é‡Œå¹¶æ²¡æœ‰å»å†™å·¥å…·è‡ªåŠ¨ç”ŸæˆWrapæ–‡ä»¶ï¼Œè€Œæ˜¯å¯¹æŒ‡å®šçš„åè®®è¿›è¡Œäº†Hookã€‚ foreachforeachå¯¹åˆ—è¡¨æ¥è¯´æ”¹å†™éå†æ–¹å¼å°±å¥½äº†ï¼Œæˆ‘è¿™é‡Œæ²¡æœ‰å¯¹å®ƒè¿›è¡Œä¼˜åŒ–ï¼Œå› ä¸ºUnity5.5ä»¥åç‰ˆæœ¬è¿™ä¸ªé—®é¢˜å°±ä¸å­˜åœ¨äº†ã€‚ç¯‡é¦–ä¼˜åŒ–åçš„æ•ˆæœå›¾ä¸­è¿˜æœ‰ä¸€ç‚¹æ®‹ç•™å°±æ˜¯å› ä¸ºè¿™é‡Œæ£é¬¼ã€‚ æ— GCè£…ç®±è¦æ¶ˆé™¤è¿™é‡Œçš„è£…ç®±æ“ä½œï¼Œéœ€è¦é‡æ„ä»£ç ï¼Œè€Œprotobuf-netå†…éƒ¨å¤§é‡ä½¿ç”¨äº†objectè¿›è¡Œå‚æ•°ä¼ é€’ï¼Œè¿™ä½¿å¾—ç”¨æ³›å‹ç¼–ç¨‹æ¥æ¶ˆé™¤GCå˜å¾—ä¸å¤ªç°å®ã€‚æˆ‘è¿™é‡Œæ˜¯è‡ªå·±å®ç°äº†ä¸€ä¸ªæ— GCç‰ˆæœ¬çš„è£…ç®±æ‹†ç®±ç±»ValueObjectï¼Œä½¿ç”¨æ–¹å¼ååˆ†ç®€å•ï¼Œç±»ä¼¼ï¼š 123456789public object Read(object value, ProtoReader source)&#123; Helpers.DebugAssert(value == null); // since replaces return ValueObject.Get(source.ReadInt32());&#125;public void Write(object value, ProtoWriter dest)&#123; ProtoWriter.WriteInt32(ValueObject.Value&lt;int&gt;(value), dest);&#125; å…¶ä¸­ValueObject.Getæ˜¯è£…ç®±ï¼Œè€ŒValueObject.Valueæ˜¯æ‹†ç®±ï¼Œè£…ç®±å’Œæ‹†ç®±çš„æ­¥éª¤å¿…é¡»ä¸€ä¸€å¯¹åº”ã€‚ ä½¿ç”¨å¯¹è±¡æ± å¯¹äºprotobuf-netååºåˆ—åŒ–çš„æ—¶å€™ä¼šåˆ›å»ºpbå¯¹è±¡è¿™ä¸€ç‚¹ï¼Œæœ€åˆç†çš„æ–¹å¼æ˜¯ä½¿ç”¨å¯¹è±¡æ± ï¼ŒHookä½protobuf-netåˆ›å»ºå¯¹è±¡çš„åœ°æ–¹ï¼Œä»å¯¹è±¡æ± ä¸­å–å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ–°å»ºå¯¹è±¡ï¼Œç”¨å®Œä»¥åå†æ‰§è¡Œå›æ”¶ã€‚æ± æ¥å£å¦‚ä¸‹ï¼š1234567891011121314151617181920212223/// &lt;summary&gt;/// è¯´æ˜ï¼šprotoç½‘ç»œæ•°æ®ç¼“å­˜æ± éœ€è¦å®ç°çš„æ¥å£/// /// @by wsh 2017-07-01/// &lt;/summary&gt;public interface IProtoPool&#123; // è·å–æ•°æ® object Get(); // å›æ”¶æ•°æ® void Recycle(object data); // æ¸…é™¤æŒ‡å®šæ•°æ® void ClearData(object data); // æ·±æ‹·è´æŒ‡å®šæ•°æ® object DeepCopy(object data); // é‡Šæ”¾ç¼“å­˜æ±  void Dispose();&#125; ä½¿ç”¨å­—èŠ‚ç¼“å­˜æ± å¯¹äºnew byte[]æ“ä½œçš„GCä¼˜åŒ–ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡è¿™é‡Œä½¿ç”¨çš„ç¼“å­˜æ± æ˜¯é’ˆå¯¹å­—èŠ‚æ•°ç»„è€Œépbå¯¹è±¡ï¼Œæˆ‘è¿™é‡Œæ˜¯è‡ªå·±å®ç°äº†ä¸€å¥—é€šç”¨çš„å­—èŠ‚æµä¸å­—èŠ‚bufferç¼“å­˜æ± StreamBufferPoolï¼Œæ¯æ¬¡éœ€è¦å­—èŠ‚bufferæ—¶ä»ä¸­å–ï¼Œç”¨å®Œä»¥åæ”¾å›ã€‚ protobuf-net GCä¼˜åŒ–å®è·µä»¥ä¸Šå…³é”®çš„ä¼˜åŒ–æ–¹æ¡ˆéƒ½å·²ç»æœ‰äº†ï¼Œå…·ä½“æ€ä¹ˆéƒ¨ç½²åˆ°protobuf-netçš„ç»†èŠ‚é—®é¢˜è¿™é‡Œä¸å†å¤šè¯´ï¼Œæœ‰å…´è¶£çš„æœ‹å‹è‡ªå·±å»çœ‹ä¸‹æºä»£ç ã€‚è¿™é‡Œå°±ä¼˜åŒ–ä»¥åçš„protobuf-netä½¿ç”¨æ–¹å¼åšä¸‹ä»‹ç»ï¼Œé¦–å…ˆæ˜¯ç›®å½•ç»“æ„ï¼š CustomDatastructï¼šè‡ªå®šä¹‰çš„æ•°æ®ç»“æ„ Protobuf-extension/Protocolï¼šæµ‹è¯•åè®® Protobuf-extension/ProtoFactoryï¼šåŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼Œå…¶ä¸­ProtoPoolæ˜¯pbå¯¹è±¡æ± ï¼Œè€ŒProtoSerializeræ˜¯å¯¹protobuf-netè£…é¥°å™¨çš„æ‰©å±•ï¼Œç”¨äºç‰¹å®šåè®®çš„å»åå°„ ProtoBufSerializerï¼šProtobuf-netå¯¹å¤–æ¥å£çš„å°è£…ã€‚ ä¸»è¦çœ‹ä¸‹ProtoBufSerializerè„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172using battle;using CustomDataStruct;using ProtoBuf.Serializers;using System.IO;/// &lt;summary&gt;/// è¯´æ˜ï¼šProtoBufåˆå§‹åŒ–ã€ç¼“å­˜ç­‰ç®¡ç†ï¼›åºåˆ—åŒ–ã€ååºåˆ—åŒ–ç­‰å°è£…/// /// @by wsh 2017-07-01/// &lt;/summary&gt;public class ProtoBufSerializer : Singleton&lt;ProtoBufSerializer&gt;&#123; ProtoBuf.Meta.RuntimeTypeModel model; public override void Init() &#123; base.Init(); model = ProtoBuf.Meta.RuntimeTypeModel.Default; AddCustomSerializer(); AddProtoPool(); model.netDataPoolDelegate = ProtoFactory.Get; model.bufferPoolDelegate = StreamBufferPool.GetBuffer; &#125; public override void Dispose() &#123; model = null; ClearCustomSerializer(); ClearProtoPool(); &#125; static public void Serialize(Stream dest, object instance) &#123; ProtoBufSerializer.instance.model.Serialize(dest, instance); &#125; static public object Deserialize(Stream source, System.Type type, int length = -1) &#123; return ProtoBufSerializer.instance.model.Deserialize(source, null, type, length, null); &#125; void AddCustomSerializer() &#123; // è‡ªå®šä¹‰Serializerä»¥é¿å…ProtoBufåå°„ CustomSetting.AddCustomSerializer(typeof(ntf_battle_frame_data), new NtfBattleFrameDataDecorator()); CustomSetting.AddCustomSerializer(typeof(ntf_battle_frame_data.one_slot), new OneSlotDecorator()); CustomSetting.AddCustomSerializer(typeof(ntf_battle_frame_data.cmd_with_frame), new CmdWithFrameDecorator()); CustomSetting.AddCustomSerializer(typeof(one_cmd), new OneCmdDecorator()); &#125; void ClearCustomSerializer() &#123; CustomSetting.CrearCustomSerializer(); &#125; void AddProtoPool() &#123; // è‡ªå®šä¹‰ç¼“å­˜æ± ä»¥é¿å…ProtoBufåˆ›å»ºå®ä¾‹ ProtoFactory.AddProtoPool(typeof(ntf_battle_frame_data), new NtfBattleFrameDataPool()); ProtoFactory.AddProtoPool(typeof(ntf_battle_frame_data.one_slot), new OneSlotPool()); ProtoFactory.AddProtoPool(typeof(ntf_battle_frame_data.cmd_with_frame), new CmdWithFramePool()); ProtoFactory.AddProtoPool(typeof(one_cmd), new OneCmdPool()); &#125; void ClearProtoPool() &#123; ProtoFactory.ClearProtoPool(); &#125;&#125; å…¶ä¸­ï¼š AddCustomSerializerï¼šç”¨äºæ·»åŠ è‡ªå®šä¹‰çš„è£…é¥°å™¨åˆ°protobuf-net AddProtoPoolï¼šç”¨äºæ·»åŠ è‡ªå®šä¹‰å¯¹è±¡æ± åˆ°protobuf-net Serializeï¼šæä¾›ç»™é€»è¾‘å±‚ä½¿ç”¨çš„åºåˆ—åŒ–æ¥å£ Deserializeï¼šæä¾›ç»™é€»è¾‘å±‚ä½¿ç”¨çš„ååºåˆ—åŒ–æ¥å£ ä½¿ç”¨ç¤ºä¾‹ï¼š123456789101112131415161718192021222324252627282930const int SENF_BUFFER_LEN = 64 * 1024;const int REVIVE_BUFFER_LEN = 128 * 1024;MemoryStream msSend = new MemoryStream(sendBuffer, 0, SENF_BUFFER_LEN, true, true);;MemoryStream msRecive = new MemoryStream(reciveBuffer, 0, REVIVE_BUFFER_LEN, true, true);;msSend.SetLength(SENF_BUFFER_LEN);msSend.Seek(0, SeekOrigin.Begin);ntf_battle_frame_data dataTmp = ProtoFactory.Get&lt;ntf_battle_frame_data&gt;();ntf_battle_frame_data.one_slot oneSlot = ProtoFactory.Get&lt;ntf_battle_frame_data.one_slot&gt;();ntf_battle_frame_data.cmd_with_frame cmdWithFrame = ProtoFactory.Get&lt;ntf_battle_frame_data.cmd_with_frame&gt;();one_cmd oneCmd = ProtoFactory.Get&lt;one_cmd&gt;();cmdWithFrame.cmd = oneCmd;oneSlot.cmd_list.Add(cmdWithFrame);dataTmp.slot_list.Add(oneSlot);DeepCopyData(data, dataTmp);ProtoBufSerializer.Serialize(msSend, dataTmp);ProtoFactory.Recycle(dataTmp);//*************å›æ”¶ï¼Œå¾ˆé‡è¦msSend.SetLength(msSend.Position);//é•¿åº¦ä¸€å®šè¦è®¾ç½®å¯¹msSend.Seek(0, SeekOrigin.Begin);//æŒ‡é’ˆä¸€å®šè¦å¤ä½//msRecive.SetLength(msSend.Length);//åŒç†ï¼Œä½†æ˜¯å¦‚æœDeserializeæŒ‡å®šé•¿åº¦ï¼Œåˆ™ä¸éœ€è¦è®¾ç½®æµé•¿åº¦msRecive.Seek(0, SeekOrigin.Begin);//åŒç†Buffer.BlockCopy(msSend.GetBuffer(), 0, msRecive.GetBuffer(), 0, (int)msSend.Length);dataTmp = ProtoBufSerializer.Deserialize(msRecive, typeof(ntf_battle_frame_data), (int)msSend.Length) as ntf_battle_frame_data;PrintData(dataTmp);ProtoFactory.Recycle(dataTmp);//*************å›æ”¶ï¼Œå¾ˆé‡è¦ Unity3Dæ¸¸æˆGCä¼˜åŒ–å®è·µprotobuf-netçš„GCä¼˜åŒ–å®è·µè¦è¯´çš„å°±è¿™ä¹ˆå¤šï¼Œå…¶å®åšGCä¼˜åŒ–çš„å¤§æ¦‚æ­¥éª¤å°±æ˜¯è¿™äº›ï¼šGCåˆ†æï¼Œä¼˜åŒ–æ–¹æ¡ˆï¼Œæœ€åå†é‡æ„ä»£ç ã€‚è¿™é‡Œå†è¡¥å……ä¸€äº›å…¶å®ƒçš„å†…å®¹ï¼ŒCustomDatastructä¸­åŒ…å«äº†ï¼š BetterDelegateï¼šæ³›å‹å§”æ‰˜åŒ…è£…ç±»ï¼Œé’ˆå¯¹æ·±å±‚å‡½æ•°è°ƒç”¨æ ‘ä¸­ä½¿ç”¨æ³›å‹å§”æ‰˜ä½œä¸ºå‡½æ•°å‚æ•°è¿›è¡Œä¼ é€’æ—¶ä»£ç ç¼–å†™å›°éš¾çš„é—®é¢˜ã€‚ BetterLinkedListï¼šæ— GCé“¾è¡¨ BetterStringBuilderï¼šæ— GCç‰ˆStrigBuilder StreamBufferPoolï¼šå­—èŠ‚æµä¸å­—èŠ‚bufferç¼“å­˜æ±  ValueObjectï¼šæ— GCè£…ç®±æ‹†ç®± ObjPoolï¼šé€šç”¨å¯¹è±¡æ±  å…¶ä¸­protobuf-netçš„æ— GCä¼˜åŒ–ç”¨åˆ°äº†StreamBufferPoolã€ValueObjectä¸ObjPoolï¼Œä¸»è¦æ˜¯å¯¹è±¡æ± å’Œå…GCè£…ç®±ï¼Œå…¶å®ƒçš„åœ¨æºä»£ç ä¸­æœ‰è¯¦ç»†æ³¨é‡Šã€‚TestScenesä¸‹åŒ…å«äº†å„ç§æµ‹è¯•åœºæ™¯ï¼šè¿™é‡Œå¯¹å…¶ä¸­å…³é”®çš„å‡ ä¸ªç»“è®ºç»™ä¸‹è¯´æ˜ï¼š LinkedListå½“è‡ªå®šä¹‰ç»“æ„åšé“¾è¡¨èŠ‚ç‚¹ï¼Œå¿…é¡»å®ç°IEquatableã€IComparableæ¥å£ï¼Œå¦åˆ™Roemoveã€Cotainsã€Findã€FindLastæ¯æ¬¡éƒ½æœ‰GCäº§ç”Ÿã€‚ 123456789101112131415161718192021222324252627282930313233343536373839// é‡è¦ï¼šå¯¹äºè‡ªå®šä¹‰ç»“æ„ä¸€å®šè¦ç»§æ‰¿IEquatable&lt;T&gt;æ¥å£å¹¶å®ç°å®ƒ// æ­¤å¤–ï¼šå¯¹äºSortï¼Œå®ç°IComparable&lt;T&gt;æ¥å£ï¼Œåˆ™åœ¨ä¼ å…¥å§”æ‰˜çš„æ—¶å€™å¯ä»¥å’Œç³»ç»Ÿç®€å•å€¼ç±»å‹ä¸€æ ·public struct CustomStruct : IEquatable&lt;CustomStruct&gt;, IComparable&lt;CustomStruct&gt;&#123; public int a; public string b; public CustomStruct(int a, string b) &#123; this.a = a; this.b = b; &#125; public bool Equals(CustomStruct other) &#123; return a == other.a &amp;&amp; b == other.b; &#125; public int CompareTo(CustomStruct other) &#123; if (a != other.a) &#123; return a.CompareTo(other.a); &#125; if (b != other.b) &#123; return b.CompareTo(other.b); &#125; return 0; &#125; // è¯´æ˜ï¼šæµ‹è¯•æ­£ç¡®æ€§ç”¨çš„ï¼Œä¸æ˜¯å¿…é¡» public override string ToString() &#123; return string.Format("&lt;a = &#123;0&#125;, b = &#123;1&#125;&gt;", a, b); &#125;&#125; æ‰€æœ‰å§”æ‰˜å¿…é¡»ç¼“å­˜ï¼Œäº§ç”ŸGCçš„æµ‹è¯•ä¸€å¾‹æ˜¯å› ä¸ºæ¯æ¬¡è°ƒç”¨éƒ½ç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„å§”æ‰˜ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495public class TestDelegateGC : MonoBehaviour&#123; public delegate void TestDelegate(GameObject go, string str, int num); public delegate void TestTDelegate&lt;T,U,V&gt;(T go, U str, V num); Delegate mDelegate1; Delegate mDelegate2; TestDelegate mDelegate3; TestTDelegate&lt;GameObject, string, int&gt; mDelegate4; TestDelegate mDelegate5; Comparison&lt;int&gt; mDelegate6; Comparison&lt;int&gt; mDelegate7; int mTestPriviteData = 100; List&lt;int&gt; mTestList = new List&lt;int&gt;(); // Use this for initialization void Start () &#123; mDelegate1 = (TestDelegate)DelegateFun; mDelegate2 = Delegate.CreateDelegate(typeof(TestDelegate), this, "DelegateFun"); mDelegate3 = DelegateFun; mDelegate4 = TDelegateFun; //static mDelegate5 = new TestDelegate(StaticDelegateFun); mDelegate6 = SortByXXX; mDelegate7 = TSortByXXX&lt;int&gt;; mTestList.Add(1); mTestList.Add(2); mTestList.Add(3); &#125; // Update is called once per frame void Update () &#123; // ä¸ä½¿ç”¨æ³›å‹ TestFun(DelegateFun); TestFun(mDelegate1 as TestDelegate); //æ— GC TestFun(mDelegate2 as TestDelegate); //æ— GC TestFun(mDelegate3); //æ— GCï¼Œæ¨è TestFun(mDelegate5); //æ— GC // ä½¿ç”¨æ³›å‹ï¼Œæ›´åŠ é€šç”¨ TestTFun(TDelegateFun, gameObject, "test", 1000);//æ¯æ¬¡è°ƒç”¨äº§ç”Ÿ104Båƒåœ¾ TestTFun(mDelegate4, gameObject, "test", 1000);// æ— GCï¼Œæ›´é€šç”¨ï¼ŒæåŠ›æ¨è*********** // Sortæµ‹è¯• mTestList.Sort();//æ— GC TestSort(SortByXXX);//æ¯æ¬¡è°ƒç”¨äº§ç”Ÿ104Båƒåœ¾ TestSort(mDelegate6);//æ— GC TestSort(TSortByXXX);//æ¯æ¬¡è°ƒç”¨äº§ç”Ÿ104Båƒåœ¾ TestSort(TSortByXXX);//æ¯æ¬¡è°ƒç”¨äº§ç”Ÿ104Båƒåœ¾ TestSort(mDelegate7);//æ— GC &#125; private void TestFun(TestDelegate de) &#123; de(gameObject, "test", 1000); &#125; private void TestTFun&lt;T, U, V&gt;(TestTDelegate&lt;T, U, V&gt; de, T arg0, U arg1, V arg2) &#123; de(arg0, arg1, arg2); &#125; private void TestSort&lt;T&gt;(List&lt;T&gt; list, Comparison&lt;T&gt; sortFunc) &#123; list.Sort(sortFunc); &#125; private void TestSort(Comparison&lt;int&gt; sortFunc) &#123; mTestList.Sort(sortFunc); &#125; private void DelegateFun(GameObject go, string str, int num) &#123; &#125; private void TDelegateFun&lt;T, U, V&gt;(T go, U str, V num) &#123; &#125; private static void StaticDelegateFun(GameObject go, string str, int num) &#123; &#125; private int SortByXXX(int x, int y) &#123; return x.CompareTo(y); &#125; private int TSortByXXX&lt;T&gt;(T x, T y) where T : IComparable&lt;T&gt; &#123; return x.CompareTo(y); &#125;&#125; Listå¯¹äºè‡ªå®šä¹‰ç»“æ„åšåˆ—è¡¨é¡¹ï¼Œå¿…é¡»å®ç°IEquatableã€IComparableæ¥å£ï¼Œå¦åˆ™Roemoveã€Cotainsã€IndexOfã€sortæ¯æ¬¡éƒ½æœ‰GCäº§ç”Ÿï¼›å¯¹äºSortï¼Œéœ€è¦ä¼ é€’ä¸€ä¸ªå§”æ‰˜ã€‚è¿™ä¸¤ç‚¹çš„å®è·µä¸Šé¢éƒ½å·²ç»è¯´æ˜ã€‚]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[KCP C#ç‰ˆ]]></title>
    <url>%2F2019%2F04%2F22%2FKCP-CSharp-README%2F</url>
    <content type="text"><![CDATA[KCP C#ç‰ˆæ”¯æŒç›®æ ‡æ¡†æ¶: dotnetstandard2.0 dotnetstandard1.1 å¼€ç®±å³ç”¨ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨Nuget æœç´¢KCPã€‚ é“¾æ¥c: skywind3000 KCPgo: xtaci kcp-go ç”¨æ³•è¯·å‚è€ƒCç‰ˆæœ¬æ–‡æ¡£ã€‚ è¯´æ˜ å†…éƒ¨ä½¿ç”¨äº†unsafeä»£ç å’Œéæ‰˜ç®¡å†…å­˜ï¼Œæ‰€ä»¥kcpsegmentè¿è¡Œæ—¶ä¸ä¼šallocï¼Œä¸ä¼šå¯¹gcé€ æˆå‹åŠ›ã€‚ å¯¹äºoutputå›è°ƒå’ŒTryRecvå‡½æ•°ã€‚ä½¿ç”¨RentBufferå›è°ƒï¼Œä»å¤–éƒ¨åˆ†é…å†…å­˜ã€‚è¯·å‚è€ƒIMemoryOwnerç”¨æ³•ã€‚ æ”¯æŒSpan&lt;byte&gt; æµ‹è¯•[å·²ä¿®å¤]åŒä¸€ä¸ªè¿›ç¨‹ä¸¤ä¸ªKcp echoæµ‹è¯•ï¼Œè‡³å°‘ä½¿ç”¨3ä¸ªçº¿ç¨‹ï¼Œå¦åˆ™å¯èƒ½æ­»é”ã€‚ åœ¨UnitTestProject1è·¯å¾„ä¸‹æ‰§è¡Œ dotnet test å¯è¿›è¡Œå¤šæ¡†æ¶æµ‹è¯•ã€‚ï¼ˆéœ€è¦å®‰è£…notnetcoreSDKï¼‰ ç›¸å¯¹Cç‰ˆçš„ä¸€äº›å˜åŒ– å·®å¼‚å˜åŒ– Cç‰ˆ C#ç‰ˆ æ•°æ®ç»“æ„ acklist æ•°ç»„ ConcurrentQueue snd_queue åŒå‘é“¾è¡¨ ConcurrentQueue snd_buf åŒå‘é“¾è¡¨ LinkedList rcv_buf åŒå‘é“¾è¡¨ LinkedList rcv_queue åŒå‘é“¾è¡¨ List â€”â€”â€”â€”â€”â€”â€” â€”â€”â€”â€”â€”â€”â€” â€”â€”â€”â€”â€”â€”â€” å›è°ƒå‡½æ•° å¢åŠ äº†RentBufferå›è°ƒï¼Œå½“KCPéœ€è¦æ—¶å¯ä»¥ä»å¤–éƒ¨ç”³è¯·å†…å­˜ã€‚ å¤šçº¿ç¨‹ å¢åŠ äº†çº¿ç¨‹å®‰å…¨ã€‚ æµæ¨¡å¼ ç”±äºæ•°æ®ç»“æ„å˜åŠ¨ï¼Œç§»é™¤äº†æµæ¨¡å¼ã€‚ intervalæœ€å°é—´éš” 10ms 0ms(åœ¨ç‰¹æ®Šå½¢å†µä¸‹å…è®¸CPUæ»¡è´Ÿè·è¿è½¬) â€”â€”â€”â€”â€”â€”â€” â€”â€”â€”â€”â€”â€”â€” â€”â€”â€”â€”â€”â€”â€” APIå˜åŠ¨ å¢åŠ å¤§å°ç«¯ç¼–ç è®¾ç½®ã€‚é»˜è®¤å°ç«¯ç¼–ç ã€‚ å¢åŠ TryRecvå‡½æ•°ï¼Œå½“å¯ä»¥Recvæ—¶åªpeeksizeä¸€æ¬¡ã€‚ ikcp_ack_push åˆ é™¤äº†æ­¤å‡½æ•°ï¼ˆå·²å†…è”ï¼‰ ikcp_ack_get åˆ é™¤äº†æ­¤å‡½æ•°ï¼ˆå·²å†…è”ï¼‰]]></content>
      <tags>
        <tag>Server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[KCP - A Fast and Reliable ARQ Protocol]]></title>
    <url>%2F2019%2F04%2F22%2FKCP-README%2F</url>
    <content type="text"><![CDATA[README in English ç®€ä»‹KCPæ˜¯ä¸€ä¸ªå¿«é€Ÿå¯é åè®®ï¼Œèƒ½ä»¥æ¯” TCPæµªè´¹10%-20%çš„å¸¦å®½çš„ä»£ä»·ï¼Œæ¢å–å¹³å‡å»¶è¿Ÿé™ä½ 30%-40%ï¼Œä¸”æœ€å¤§å»¶è¿Ÿé™ä½ä¸‰å€çš„ä¼ è¾“æ•ˆæœã€‚çº¯ç®—æ³•å®ç°ï¼Œå¹¶ä¸è´Ÿè´£åº•å±‚åè®®ï¼ˆå¦‚UDPï¼‰çš„æ”¶å‘ï¼Œéœ€è¦ä½¿ç”¨è€…è‡ªå·±å®šä¹‰ä¸‹å±‚æ•°æ®åŒ…çš„å‘é€æ–¹å¼ï¼Œä»¥ callbackçš„æ–¹å¼æä¾›ç»™ KCPã€‚ è¿æ—¶é’Ÿéƒ½éœ€è¦å¤–éƒ¨ä¼ é€’è¿›æ¥ï¼Œå†…éƒ¨ä¸ä¼šæœ‰ä»»ä½•ä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨ã€‚ æ•´ä¸ªåè®®åªæœ‰ ikcp.h, ikcp.cä¸¤ä¸ªæºæ–‡ä»¶ï¼Œå¯ä»¥æ–¹ä¾¿çš„é›†æˆåˆ°ç”¨æˆ·è‡ªå·±çš„åè®®æ ˆä¸­ã€‚ä¹Ÿè®¸ä½ å®ç°äº†ä¸€ä¸ªP2Pï¼Œæˆ–è€…æŸä¸ªåŸºäº UDPçš„åè®®ï¼Œè€Œç¼ºä¹ä¸€å¥—å®Œå–„çš„ARQå¯é åè®®å®ç°ï¼Œé‚£ä¹ˆç®€å•çš„æ‹·è´è¿™ä¸¤ä¸ªæ–‡ä»¶åˆ°ç°æœ‰é¡¹ç›®ä¸­ï¼Œç¨å¾®ç¼–å†™ä¸¤è¡Œä»£ç ï¼Œå³å¯ä½¿ç”¨ã€‚ æŠ€æœ¯ç‰¹æ€§TCPæ˜¯ä¸ºæµé‡è®¾è®¡çš„ï¼ˆæ¯ç§’å†…å¯ä»¥ä¼ è¾“å¤šå°‘KBçš„æ•°æ®ï¼‰ï¼Œè®²ç©¶çš„æ˜¯å……åˆ†åˆ©ç”¨å¸¦å®½ã€‚è€Œ KCPæ˜¯ä¸ºæµé€Ÿè®¾è®¡çš„ï¼ˆå•ä¸ªæ•°æ®åŒ…ä»ä¸€ç«¯å‘é€åˆ°ä¸€ç«¯éœ€è¦å¤šå°‘æ—¶é—´ï¼‰ï¼Œä»¥10%-20%å¸¦å®½æµªè´¹çš„ä»£ä»·æ¢å–äº†æ¯” TCPå¿«30%-40%çš„ä¼ è¾“é€Ÿåº¦ã€‚TCPä¿¡é“æ˜¯ä¸€æ¡æµé€Ÿå¾ˆæ…¢ï¼Œä½†æ¯ç§’æµé‡å¾ˆå¤§çš„å¤§è¿æ²³ï¼Œè€ŒKCPæ˜¯æ°´æµæ¹æ€¥çš„å°æ¿€æµã€‚KCPæœ‰æ­£å¸¸æ¨¡å¼å’Œå¿«é€Ÿæ¨¡å¼ä¸¤ç§ï¼Œé€šè¿‡ä»¥ä¸‹ç­–ç•¥è¾¾åˆ°æé«˜æµé€Ÿçš„ç»“æœï¼š RTOç¿»å€vsä¸ç¿»å€ï¼š TCPè¶…æ—¶è®¡ç®—æ˜¯RTOx2ï¼Œè¿™æ ·è¿ç»­ä¸¢ä¸‰æ¬¡åŒ…å°±å˜æˆRTOx8äº†ï¼Œååˆ†ææ€–ï¼Œè€ŒKCPå¯åŠ¨å¿«é€Ÿæ¨¡å¼åä¸x2ï¼Œåªæ˜¯x1.5ï¼ˆå®éªŒè¯æ˜1.5è¿™ä¸ªå€¼ç›¸å¯¹æ¯”è¾ƒå¥½ï¼‰ï¼Œæé«˜äº†ä¼ è¾“é€Ÿåº¦ã€‚ é€‰æ‹©æ€§é‡ä¼  vs å…¨éƒ¨é‡ä¼ ï¼š TCPä¸¢åŒ…æ—¶ä¼šå…¨éƒ¨é‡ä¼ ä»ä¸¢çš„é‚£ä¸ªåŒ…å¼€å§‹ä»¥åçš„æ•°æ®ï¼ŒKCPæ˜¯é€‰æ‹©æ€§é‡ä¼ ï¼Œåªé‡ä¼ çœŸæ­£ä¸¢å¤±çš„æ•°æ®åŒ…ã€‚ å¿«é€Ÿé‡ä¼ ï¼š å‘é€ç«¯å‘é€äº†1,2,3,4,5å‡ ä¸ªåŒ…ï¼Œç„¶åæ”¶åˆ°è¿œç«¯çš„ACK: 1, 3, 4, 5ï¼Œå½“æ”¶åˆ°ACK3æ—¶ï¼ŒKCPçŸ¥é“2è¢«è·³è¿‡1æ¬¡ï¼Œæ”¶åˆ°ACK4æ—¶ï¼ŒçŸ¥é“2è¢«è·³è¿‡äº†2æ¬¡ï¼Œæ­¤æ—¶å¯ä»¥è®¤ä¸º2å·ä¸¢å¤±ï¼Œä¸ç”¨ç­‰è¶…æ—¶ï¼Œç›´æ¥é‡ä¼ 2å·åŒ…ï¼Œå¤§å¤§æ”¹å–„äº†ä¸¢åŒ…æ—¶çš„ä¼ è¾“é€Ÿåº¦ã€‚ å»¶è¿ŸACK vs éå»¶è¿ŸACKï¼š TCPä¸ºäº†å……åˆ†åˆ©ç”¨å¸¦å®½ï¼Œå»¶è¿Ÿå‘é€ACKï¼ˆNODELAYéƒ½æ²¡ç”¨ï¼‰ï¼Œè¿™æ ·è¶…æ—¶è®¡ç®—ä¼šç®—å‡ºè¾ƒå¤§ RTTæ—¶é—´ï¼Œå»¶é•¿äº†ä¸¢åŒ…æ—¶çš„åˆ¤æ–­è¿‡ç¨‹ã€‚KCPçš„ACKæ˜¯å¦å»¶è¿Ÿå‘é€å¯ä»¥è°ƒèŠ‚ã€‚ UNA vs ACK+UNAï¼š ARQæ¨¡å‹å“åº”æœ‰ä¸¤ç§ï¼ŒUNAï¼ˆæ­¤ç¼–å·å‰æ‰€æœ‰åŒ…å·²æ”¶åˆ°ï¼Œå¦‚TCPï¼‰å’ŒACKï¼ˆè¯¥ç¼–å·åŒ…å·²æ”¶åˆ°ï¼‰ï¼Œå…‰ç”¨UNAå°†å¯¼è‡´å…¨éƒ¨é‡ä¼ ï¼Œå…‰ç”¨ACKåˆ™ä¸¢å¤±æˆæœ¬å¤ªé«˜ï¼Œä»¥å¾€åè®®éƒ½æ˜¯äºŒé€‰å…¶ä¸€ï¼Œè€Œ KCPåè®®ä¸­ï¼Œé™¤å»å•ç‹¬çš„ ACKåŒ…å¤–ï¼Œæ‰€æœ‰åŒ…éƒ½æœ‰UNAä¿¡æ¯ã€‚ éé€€è®©æµæ§ï¼š KCPæ­£å¸¸æ¨¡å¼åŒTCPä¸€æ ·ä½¿ç”¨å…¬å¹³é€€è®©æ³•åˆ™ï¼Œå³å‘é€çª—å£å¤§å°ç”±ï¼šå‘é€ç¼“å­˜å¤§å°ã€æ¥æ”¶ç«¯å‰©ä½™æ¥æ”¶ç¼“å­˜å¤§å°ã€ä¸¢åŒ…é€€è®©åŠæ…¢å¯åŠ¨è¿™å››è¦ç´ å†³å®šã€‚ä½†ä¼ é€åŠæ—¶æ€§è¦æ±‚å¾ˆé«˜çš„å°æ•°æ®æ—¶ï¼Œå¯é€‰æ‹©é€šè¿‡é…ç½®è·³è¿‡åä¸¤æ­¥ï¼Œä»…ç”¨å‰ä¸¤é¡¹æ¥æ§åˆ¶å‘é€é¢‘ç‡ã€‚ä»¥ç‰ºç‰²éƒ¨åˆ†å…¬å¹³æ€§åŠå¸¦å®½åˆ©ç”¨ç‡ä¹‹ä»£ä»·ï¼Œæ¢å–äº†å¼€ç€BTéƒ½èƒ½æµç•…ä¼ è¾“çš„æ•ˆæœã€‚ åŸºæœ¬ä½¿ç”¨ åˆ›å»º KCPå¯¹è±¡ï¼š 123// åˆå§‹åŒ– kcpå¯¹è±¡ï¼Œconvä¸ºä¸€ä¸ªè¡¨ç¤ºä¼šè¯ç¼–å·çš„æ•´æ•°ï¼Œå’Œtcpçš„ convä¸€æ ·ï¼Œé€šä¿¡åŒ// æ–¹éœ€ä¿è¯ convç›¸åŒï¼Œç›¸äº’çš„æ•°æ®åŒ…æ‰èƒ½å¤Ÿè¢«è®¤å¯ï¼Œuseræ˜¯ä¸€ä¸ªç»™å›è°ƒå‡½æ•°çš„æŒ‡é’ˆikcpcb *kcp = ikcp_create(conv, user); è®¾ç½®å›è°ƒå‡½æ•°ï¼š 123456789// KCPçš„ä¸‹å±‚åè®®è¾“å‡ºå‡½æ•°ï¼ŒKCPéœ€è¦å‘é€æ•°æ®æ—¶ä¼šè°ƒç”¨å®ƒ// buf/len è¡¨ç¤ºç¼“å­˜å’Œé•¿åº¦// useræŒ‡é’ˆä¸º kcpå¯¹è±¡åˆ›å»ºæ—¶ä¼ å…¥çš„å€¼ï¼Œç”¨äºåŒºåˆ«å¤šä¸ª KCPå¯¹è±¡int udp_output(const char *buf, int len, ikcpcb *kcp, void *user)&#123; ....&#125;// è®¾ç½®å›è°ƒå‡½æ•°kcp-&gt;output = udp_output; å¾ªç¯è°ƒç”¨ updateï¼š 123// ä»¥ä¸€å®šé¢‘ç‡è°ƒç”¨ ikcp_updateæ¥æ›´æ–° kcpçŠ¶æ€ï¼Œå¹¶ä¸”ä¼ å…¥å½“å‰æ—¶é’Ÿï¼ˆæ¯«ç§’å•ä½ï¼‰// å¦‚ 10msè°ƒç”¨ä¸€æ¬¡ï¼Œæˆ–ç”¨ ikcp_checkç¡®å®šä¸‹æ¬¡è°ƒç”¨ updateçš„æ—¶é—´ä¸å¿…æ¯æ¬¡è°ƒç”¨ikcp_update(kcp, millisec); è¾“å…¥ä¸€ä¸ªä¸‹å±‚æ•°æ®åŒ…ï¼š 12// æ”¶åˆ°ä¸€ä¸ªä¸‹å±‚æ•°æ®åŒ…ï¼ˆæ¯”å¦‚UDPåŒ…ï¼‰æ—¶éœ€è¦è°ƒç”¨ï¼šikcp_input(kcp, received_udp_packet, received_udp_size); å¤„ç†äº†ä¸‹å±‚åè®®çš„è¾“å‡º/è¾“å…¥å KCPåè®®å°±å¯ä»¥æ­£å¸¸å·¥ä½œäº†ï¼Œä½¿ç”¨ ikcp_send æ¥å‘è¿œç«¯å‘é€æ•°æ®ã€‚è€Œå¦ä¸€ç«¯ä½¿ç”¨ ikcp_recv(kcp, ptr, size)æ¥æ¥æ”¶æ•°æ®ã€‚ åè®®é…ç½®åè®®é»˜è®¤æ¨¡å¼æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ ARQï¼Œéœ€è¦é€šè¿‡é…ç½®æ‰“å¼€å„é¡¹åŠ é€Ÿå¼€å…³ï¼š å·¥ä½œæ¨¡å¼ï¼š 1int ikcp_nodelay(ikcpcb *kcp, int nodelay, int interval, int resend, int nc) nodelay ï¼šæ˜¯å¦å¯ç”¨ nodelayæ¨¡å¼ï¼Œ0ä¸å¯ç”¨ï¼›1å¯ç”¨ã€‚ interval ï¼šåè®®å†…éƒ¨å·¥ä½œçš„ intervalï¼Œå•ä½æ¯«ç§’ï¼Œæ¯”å¦‚ 10msæˆ–è€… 20ms resend ï¼šå¿«é€Ÿé‡ä¼ æ¨¡å¼ï¼Œé»˜è®¤0å…³é—­ï¼Œå¯ä»¥è®¾ç½®2ï¼ˆ2æ¬¡ACKè·¨è¶Šå°†ä¼šç›´æ¥é‡ä¼ ï¼‰ nc ï¼šæ˜¯å¦å…³é—­æµæ§ï¼Œé»˜è®¤æ˜¯0ä»£è¡¨ä¸å…³é—­ï¼Œ1ä»£è¡¨å…³é—­ã€‚ æ™®é€šæ¨¡å¼ï¼š ikcp_nodelay(kcp, 0, 40, 0, 0); æé€Ÿæ¨¡å¼ï¼š ikcp_nodelay(kcp, 1, 10, 2, 1); æœ€å¤§çª—å£ï¼š 1int ikcp_wndsize(ikcpcb *kcp, int sndwnd, int rcvwnd); è¯¥è°ƒç”¨å°†ä¼šè®¾ç½®åè®®çš„æœ€å¤§å‘é€çª—å£å’Œæœ€å¤§æ¥æ”¶çª—å£å¤§å°ï¼Œé»˜è®¤ä¸º32. è¿™ä¸ªå¯ä»¥ç†è§£ä¸º TCPçš„ SND_BUF å’Œ RCV_BUFï¼Œåªä¸è¿‡å•ä½ä¸ä¸€æ · SND/RCV_BUF å•ä½æ˜¯å­—èŠ‚ï¼Œè¿™ä¸ªå•ä½æ˜¯åŒ…ã€‚ æœ€å¤§ä¼ è¾“å•å…ƒï¼š çº¯ç®—æ³•åè®®å¹¶ä¸è´Ÿè´£æ¢æµ‹ MTUï¼Œé»˜è®¤ mtuæ˜¯1400å­—èŠ‚ï¼Œå¯ä»¥ä½¿ç”¨ikcp_setmtuæ¥è®¾ç½®è¯¥å€¼ã€‚è¯¥å€¼å°†ä¼šå½±å“æ•°æ®åŒ…å½’å¹¶åŠåˆ†ç‰‡æ—¶å€™çš„æœ€å¤§ä¼ è¾“å•å…ƒã€‚ æœ€å°RTOï¼š ä¸ç®¡æ˜¯ TCPè¿˜æ˜¯ KCPè®¡ç®— RTOæ—¶éƒ½æœ‰æœ€å° RTOçš„é™åˆ¶ï¼Œå³ä¾¿è®¡ç®—å‡ºæ¥RTOä¸º40msï¼Œç”±äºé»˜è®¤çš„ RTOæ˜¯100msï¼Œåè®®åªæœ‰åœ¨100msåæ‰èƒ½æ£€æµ‹åˆ°ä¸¢åŒ…ï¼Œå¿«é€Ÿæ¨¡å¼ä¸‹ä¸º30msï¼Œå¯ä»¥æ‰‹åŠ¨æ›´æ”¹è¯¥å€¼ï¼š 1kcp-&gt;rx_minrto = 10; æ–‡æ¡£ç´¢å¼•åè®®çš„ä½¿ç”¨å’Œé…ç½®éƒ½æ˜¯å¾ˆç®€å•çš„ï¼Œå¤§éƒ¨åˆ†æƒ…å†µçœ‹å®Œä¸Šé¢çš„å†…å®¹åŸºæœ¬å¯ä»¥ä½¿ç”¨äº†ã€‚å¦‚æœä½ éœ€è¦è¿›ä¸€æ­¥è¿›è¡Œç²¾ç»†çš„æ§åˆ¶ï¼Œæ¯”å¦‚æ”¹å˜ KCPçš„å†…å­˜åˆ†é…å™¨ï¼Œæˆ–è€…ä½ éœ€è¦æ›´æœ‰æ•ˆçš„å¤§è§„æ¨¡è°ƒåº¦ KCPé“¾æ¥ï¼ˆæ¯”å¦‚ 3500ä¸ªä»¥ä¸Šï¼‰ï¼Œæˆ–è€…å¦‚ä½•æ›´å¥½çš„åŒ TCPç»“åˆï¼Œé‚£ä¹ˆå¯ä»¥ç»§ç»­å»¶ä¼¸é˜…è¯»ï¼š Wiki Home KCP æœ€ä½³å®è·µ åŒç°æœ‰TCPæœåŠ¡å™¨é›†æˆ ä¼ è¾“æ•°æ®åŠ å¯† åº”ç”¨å±‚æµé‡æ§åˆ¶ æ€§èƒ½è¯„æµ‹ å¼€æºæ¡ˆä¾‹ kcptun: åŸºäº kcp-goåšçš„é«˜é€Ÿè¿œç¨‹ç«¯å£è½¬å‘(éš§é“) ï¼Œé…åˆssh -Dï¼Œå¯ä»¥æ¯” shadowsocks æ›´æµç•…çš„çœ‹åœ¨çº¿è§†é¢‘ã€‚ dog-tunnel: GOå¼€å‘çš„ç½‘ç»œéš§é“ï¼Œä½¿ç”¨ KCPæå¤§çš„æ”¹è¿›äº†ä¼ è¾“é€Ÿåº¦ï¼Œå¹¶ç§»æ¤äº†ä¸€ä»½ GOç‰ˆæœ¬ KCP v2rayï¼šè‘—åä»£ç†è½¯ä»¶ï¼ŒShadowsocks ä»£æ›¿è€…ï¼Œ1.17åé›†æˆäº† kcpåè®®ï¼Œä½¿ç”¨UDPä¼ è¾“ï¼Œæ— æ•°æ®åŒ…ç‰¹å¾ã€‚ asio-kcp: ä½¿ç”¨ KCPçš„å®Œæ•´ UDPç½‘ç»œåº“ï¼Œå®Œæ•´å®ç°äº†åŸºäº UDPçš„é“¾æ¥çŠ¶æ€ç®¡ç†ï¼Œä¼šè¯æ§åˆ¶ï¼ŒKCPåè®®è°ƒåº¦ç­‰ kcp-javaï¼šJavaç‰ˆæœ¬ KCPåè®®å®ç°ã€‚ kcp-nettyï¼škcpçš„Javaè¯­è¨€å®ç°ï¼ŒåŸºäºnettyã€‚ kcp-go: é«˜å®‰å…¨æ€§çš„kcpçš„ GOè¯­è¨€å®ç°ï¼ŒåŒ…å« UDPä¼šè¯ç®¡ç†çš„ç®€å•å®ç°ï¼Œå¯ä»¥ä½œä¸ºåç»­å¼€å‘çš„åŸºç¡€åº“ã€‚ kcp-csharp: kcpçš„ csharpç§»æ¤ï¼ŒåŒæ—¶åŒ…å«ä¸€ä»½å›è¯ç®¡ç†ï¼Œå¯ä»¥è¿æ¥ä¸Šé¢kcp-goçš„æœåŠ¡ç«¯ã€‚ kcp-csharp: æ–°ç‰ˆæœ¬ Kcpçš„ csharpç§»æ¤ã€‚çº¿ç¨‹å®‰å…¨ï¼Œè¿è¡Œæ—¶æ— allocï¼Œå¯¹gcæ— å‹åŠ›ã€‚ kcp-rs: KCPçš„ rustç§»æ¤ kcp-rustï¼šæ–°ç‰ˆæœ¬ KCPçš„ rust ç§»æ¤ tokio-kcpï¼šrust tokio çš„ kcp é›†æˆ lua-kcp: KCPçš„ Luaæ‰©å±•ï¼Œç”¨äº LuaæœåŠ¡å™¨ node-kcp: node-js çš„ KCP æ¥å£ nysocks: åŸºäºlibuvå®ç°çš„node-addonï¼Œæä¾›nodejsç‰ˆæœ¬çš„ä»£ç†æœåŠ¡ï¼Œå®¢æˆ·ç«¯æ¥å…¥æ”¯æŒSOCKS5å’Œssä¸¤ç§åè®® shadowsocks-android: Shadowsocks for android é›†æˆäº† kcptun ä½¿ç”¨ kcpåè®®åŠ é€Ÿ shadowsocksï¼Œæ•ˆæœä¸é”™ kcpuv: ä½¿ç”¨ libuvå¼€å‘çš„kcpuvåº“ï¼Œç›®å‰è¿˜åœ¨ Demoé˜¶æ®µ Lanternï¼šæ›´å¥½çš„ VPNï¼ŒGithub 50000 æ˜Ÿï¼Œä½¿ç”¨ kcpgo åŠ é€Ÿ rpcx ï¼šRPC æ¡†æ¶ï¼Œ1000+ æ˜Ÿï¼Œä½¿ç”¨ kcpgo åŠ é€Ÿ RPC xkcptun: cè¯­è¨€å®ç°çš„kcptunï¼Œä¸»è¦ç”¨äºOpenWrt, LEDEå¼€å‘çš„è·¯ç”±å™¨é¡¹ç›®ä¸Š et-frame: C#å‰åç«¯æ¡†æ¶(å‰ç«¯unity3d)ï¼Œç»Ÿä¸€ç”¨C#å¼€å‘æ¸¸æˆï¼Œå®ç°äº†å‰åç«¯kcpåè®® å•†ä¸šæ¡ˆä¾‹ æ˜æ—¥å¸å›½ï¼šGame K17 çš„ ã€Šæ˜æ—¥å¸å›½ã€‹ ï¼ˆGoogle Playï¼‰ï¼Œä½¿ç”¨ KCP åŠ é€Ÿæ¸¸æˆæ¶ˆæ¯ï¼Œè®©å…¨çƒç©å®¶æµç•…è”ç½‘ ä»™çµå¤§ä½œæˆ˜ï¼š4399 çš„ MOBAæ¸¸æˆï¼Œä½¿ç”¨ KCP ä¼˜åŒ–æ¸¸æˆåŒæ­¥ CCï¼šç½‘æ˜“ CC ä½¿ç”¨ kcp åŠ é€Ÿè§†é¢‘æ¨æµï¼Œæœ‰æ•ˆæé«˜æµç•…æ€§ BOBOï¼šç½‘æ˜“ BOBO ä½¿ç”¨ kcp åŠ é€Ÿä¸»æ’­æ¨æµ äº‘å¸†åŠ é€Ÿï¼šä½¿ç”¨ KCP åŠ é€Ÿæ–‡ä»¶ä¼ è¾“å’Œè§†é¢‘æ¨æµï¼Œä¼˜åŒ–äº†å°æ¹¾ä¸»æ’­æ¨æµçš„æµç•…åº¦ æ¬¢è¿å‘ŠçŸ¥æ›´å¤šæ¡ˆä¾‹ åè®®æ¯”è¾ƒå¦‚æœç½‘ç»œæ°¸è¿œä¸å¡ï¼Œé‚£ KCP/TCP è¡¨ç°ç±»ä¼¼ï¼Œä½†æ˜¯ç½‘ç»œæœ¬èº«å°±æ˜¯ä¸å¯é çš„ï¼Œä¸¢åŒ…å’ŒæŠ–åŠ¨æ— æ³•é¿å…ï¼ˆå¦åˆ™è¿˜è¦å„ç§å¯é åè®®å¹²å˜›ï¼‰ã€‚åœ¨å†…ç½‘è¿™ç§å‡ ä¹ç†æƒ³çš„ç¯å¢ƒé‡Œç›´æ¥æ¯”è¾ƒï¼Œå¤§å®¶éƒ½å·®ä¸å¤šï¼Œä½†æ˜¯æ”¾åˆ°å…¬ç½‘ä¸Šï¼Œæ”¾åˆ°3G/4Gç½‘ç»œæƒ…å†µä¸‹ï¼Œæˆ–è€…ä½¿ç”¨å†…ç½‘ä¸¢åŒ…æ¨¡æ‹Ÿï¼Œå·®è·å°±å¾ˆæ˜æ˜¾äº†ã€‚å…¬ç½‘åœ¨é«˜å³°æœŸæœ‰å¹³å‡æ¥è¿‘10%çš„ä¸¢åŒ…ï¼Œwifi/3g/4gä¸‹æ›´ç³Ÿç³•ï¼Œè¿™äº›éƒ½ä¼šè®©ä¼ è¾“å˜å¡ã€‚ æ„Ÿè°¢ asio-kcp çš„ä½œè€… zhangyuan å¯¹ KCP ä¸ enet, udtåšè¿‡çš„ä¸€æ¬¡æ¨ªå‘è¯„æµ‹ï¼Œç»“è®ºå¦‚ä¸‹ï¼š ASIO-KCP has good performace in wifi and phone network(3G, 4G). The kcp is the first choice for realtime pvp game. The lag is less than 1 second when network lag happen. 3 times better than enet when lag happen. The enet is a good choice if your game allow 2 second lag. UDT is a bad idea. It always sink into badly situation of more than serval seconds lag. And the recovery is not expected. enet has the problem of lack of doc. And it has lots of functions that you may intrest. kcpâ€™s doc is chinese. Good thing is the function detail which is writen in code is english. And you can use asio_kcp which is a good wrap. The kcp is a simple thing. You will write more code if you want more feature. UDT has a perfect doc. UDT may has more bug than others as I feeling. å…·ä½“è§ï¼šæ¨ªå‘æ¯”è¾ƒ å’Œ è¯„æµ‹æ•°æ®ï¼Œä¸ºçŠ¹è±«é€‰æ‹©çš„äººæä¾›äº†æ›´å¤šæŒ‡å¼•ã€‚ æ¬¢è¿æèµ  æ¬¢è¿ä½¿ç”¨æ”¯ä»˜å®æ‰‹æ‰«æä¸Šé¢çš„äºŒç»´ç ï¼Œå¯¹è¯¥é¡¹ç›®è¿›è¡Œæèµ ã€‚æèµ æ¬¾é¡¹å°†ç”¨äºæŒç»­ä¼˜åŒ– KCPåè®®ä»¥åŠå®Œå–„æ–‡æ¡£ã€‚ æ„Ÿè°¢ï¼šæ˜æ˜ã€æ˜Ÿä»”ã€è¿›ã€å¸†ã€é¢é’Šã€æ–Œé“¨ã€æ™“ä¸¹ã€ä½™äº‰ã€è™ã€æ™Ÿæ•¢ã€å¾ç®ã€ç‹å·ã€èµµåˆšå¼ºã€èƒ¡çŸ¥é”‹ã€ä¸‡æ–°æœã€ä½•æ–°è¶…ã€åˆ˜æ—¸ã€ä¾¯å®ªè¾‰ã€å´ä½©ä»ªã€åæ–Œã€å¦‚æ¶›ã€èƒ¡åšã€‚ã€‚ã€‚ï¼ˆæ—©å…ˆçš„åå•å®åœ¨ä¸å¥½æ„æ€æ²¡è®°å½•ä¸‹æ¥ï¼‰ç­‰åŒå­¦çš„æåŠ©ä¸æ”¯æŒã€‚ æ¬¢è¿å…³æ³¨ KCPäº¤æµç¾¤ï¼š364933586ï¼ˆQQç¾¤å·ï¼‰ï¼ŒKCPé›†æˆï¼Œè°ƒä¼˜ï¼Œç½‘ç»œä¼ è¾“ä»¥åŠç›¸å…³æŠ€æœ¯è®¨è®ºGitter ç¾¤ï¼šhttps://gitter.im/skywind3000/KCP blog: http://www.skywind.me zhihu: https://www.zhihu.com/people/skywind3000 ContributorsThis project exists thanks to all the people who contribute.]]></content>
      <tags>
        <tag>Server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¸§é”å®šåŒæ­¥(frame lock sync)æŒ‰å¸§åŒæ­¥ï¼ˆframe syncï¼‰çŠ¶æ€åŒæ­¥(state sync)]]></title>
    <url>%2F2019%2F04%2F22%2Fframe-sync%2F</url>
    <content type="text"><![CDATA[å¸§é”å®šåŒæ­¥(frame lock sync)lockstepè¿™ä¸ªæ¦‚å¿µå¤§å®¶çš„ç†è§£åŸºæœ¬éƒ½æ˜¯ä¸€è‡´çš„ã€‚å‡†ç¡®çš„è¯´ï¼Œåº”è¯¥å«frame lockstep syncã€‚ä½†å› ä¸ºlockstep syncåŸºæœ¬éƒ½æ˜¯é’ˆå¯¹å¸§çš„ï¼ˆè‡³å°‘æˆ‘ç°åœ¨æƒ³ä¸å‡ºå…¶ä»–ç”¨æ³•ï¼‰ï¼ŒæŠŠlockstep syncå’Œframe lock syncç›´æ¥ç”»ç­‰å·ä¹Ÿæ²¡å•¥é—®é¢˜ã€‚lockstep syncè¿™ä¸ªä¸œè¥¿ï¼Œæœ€å¤§çš„ç‰¹ç‚¹åˆ™æ˜¯ï¼š æ¯ä¸€å¸§çš„è¿ç®—éƒ½è¦ä¾èµ–ä¸Šä¸€å¸§çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„ä¸Šä¸‹æ–‡å¼ºç›¸å…³ã€‚ æ¯å¸§çš„æ•°æ®ï¼Œéƒ½æ˜¯é€šè¿‡ä¸Šä¸€å¸§çš„æ•°æ®é€šè¿‡ç›¸åŒçš„è¾“å…¥å‚æ•°å†æ¬¡è®¡ç®—å‡ºæ¥çš„ï¼Œåªè¦ä¸Šä¸€å¸§æœ‰ä¸€ç‚¹ç‚¹çš„ä¸åŒï¼Œåé¢çš„ç»“æœå°±ä¼šå®Œå…¨ä¸åŒã€‚æ‰€ä»¥å¯¼è‡´äº†lockstepåœ¨è·å¾—å®ƒçš„å”¯ä¸€ä¼˜ç‚¹ï¼ˆåŒæ­¥æ•°æ®å°‘ï¼‰çš„åŒæ—¶ï¼Œæœ‰äº†ä¸€äº›é—¹å¿ƒçš„ç¼ºç‚¹ï¼š å¯¹è¯¯å·®æåº¦æ•æ„Ÿï¼Œä»»ä½•å·®é”™éƒ½ä¼šå› ä¸ºäº§ç”Ÿè´è¶æ•ˆåº”è¢«æ”¾å¤§ æ‰€æœ‰é€»è¾‘éƒ½å¿…é¡»è®¡ç®—ï¼ˆåŒ…æ‹¬è§†é‡å¤–çš„ï¼‰ï¼Œå¯¼è‡´å®¢æˆ·ç«¯è¿ç®—é‡å¢åŠ  å› ä¸ºæ•´ä¸ªæ¸¸æˆçŠ¶æ€éƒ½å¿…é¡»å­˜åœ¨äºå®¢æˆ·ç«¯ï¼Œæ•°æ®å¯¹â€œå¤–æŒ‚â€é€æ˜ã€‚ å½“æœ¬åœ°çŠ¶æ€é—å¤±åï¼ˆæ–­ç½‘æˆ–åº”ç”¨å´©æºƒï¼‰ï¼Œå¿…é¡»è·å¾—ä¸€ä¸ªéå¸¸å¤§çš„æ•°æ®åŒ…æ¥æ¢å¤çŠ¶æ€ï¼Œå› ä¸ºå¿…é¡»åŒ…å«è§†é‡å¤–ï¼Œä»¥åŠä¸€äº›å®¢æˆ·ç«¯æœ¬ä¸éœ€è¦å…³å¿ƒçš„å†…å®¹ã€‚ å½“ç„¶ï¼Œä¸Šè¿°ç¼ºç‚¹åœ¨ç‰¹å®šæƒ…å†µå¹¶ä¸ç®—æ˜¯ç¼ºç‚¹ï¼Œæ¯”å¦‚å¯¹äºMobaç±»æ¸¸æˆè€Œè¨€ï¼Œåœºæ™¯å°ï¼Œç‰©ä½“æ•°é‡å°‘ï¼Œé‚£ä¹ˆæ•´ä¸ªåœºæ™¯çš„æ€»æ•°æ®é‡ä¹Ÿä¸æ˜¯å¾ˆå¤§ï¼Œå¢åŠ çš„è¿ç®—é‡ä¹Ÿå¯ä»¥æ¥å—ã€‚å¯¹äº2v2çš„æ ¼æ–—æ¸¸æˆå°±æ›´ä¸ç”¨è¯´äº†ï¼Œè¿™äº›éƒ½æ˜¯åŸæœ¬lockstepçš„æ ‡å‡†åº”ç”¨æ ·ä¾‹ã€‚ ä½†è¿™æ—¶å€™è‚¯å®šå°±æœ‰äººè¯´äº†ï¼Œâ€œå¸§åŒæ­¥çš„ä¼˜ç‚¹â€å¹¶ä¸æ˜¯åªæœ‰â€œæ•°æ®é‡å°‘â€è¿™ä¸€ä¸ªå•Šï¼Œä»–è¿˜æœ‰å¸•æ‹‰å•ªå•¦å•ªå•¦â€¦â€¦ æ²¡é”™â€œæŒ‰å¸§åŒæ­¥â€(frame sync)çš„ä¼˜ç‚¹ç¡®å®æ²¡æœ‰å¸§é”å®šåŒæ­¥(frame lock sync)è¿™ä¹ˆå°‘ã€‚ å½“ç„¶ï¼Œäº‹å®ä¸Šå…¶å®å¹¶æ²¡æœ‰frame syncè¿™æ ·ä¸€ä¸ªè¯åœ¨æµä¼ ã€‚ä½†æ˜¯ä»â€œå¸§åŒæ­¥â€è¿™ä¸ªè¯çš„å­—é¢æ„æ€ï¼Œæ­£å¸¸äººéƒ½ä¼šå¾€è¿™è¾¹ç†è§£æˆframe syncå¥½å§ï¼Ÿ æŠŠå¸§é”å®šåŒæ­¥(frame lock sync)ç¼©å†™æˆå¸§åŒæ­¥(frame sync)ï¼Œä¾¿æ˜¯ä¸€åˆ‡æ¶çš„æ ¹æºã€‚è€ŒæŒ‰å¸§åŒæ­¥ï¼ˆframe syncï¼‰ï¼ŒæŒ‰å­—é¢å°±æ˜¯ä»¥ä¸€å¸§æ•°æ®ä¸ºå•ä½è¿›è¡ŒåŒæ­¥ï¼ŒæŒ‰ç…§åˆ†è¯ç»“æ„ï¼Œå¸§é”å®šåŒæ­¥(frame lock sync)å¿…å®šæ˜¯æŒ‰å¸§åŒæ­¥ï¼ˆframe syncï¼‰ï¼Œä¹Ÿå°±æ˜¯è¿™æ ·çš„å…³ç³»ã€‚ lockstepæ˜¯ç”¨æ¥äº¤æ¢æµç•…æ€§çš„ç‰¹æ€§æ˜¯å…¬å¹³æ€§ï¼Œè¿™ä¸ªç‰¹æ€§å…¶å®å’Œä¸€è‡´æ€§æœ‰æ‰€ç±»ä¼¼ã€‚æˆ‘ä»¬å’Œå…¶ä»–ç©å®¶ä¸€èµ·æ¸¸æˆçš„æ—¶å€™ï¼Œæœ‰æ—¶å€™ä¸å¸Œæœ›å¯¹æ–¹å› ä¸ºç”µè„‘é€Ÿåº¦æ¯”è¾ƒå¿«ï¼Œç½‘ç»œæ¯”è¾ƒå¥½ï¼Œè€Œèƒ½æ¯”æˆ‘ä»¬æ›´æ—©çš„çœ‹åˆ°æ¸¸æˆçš„è¿è¡Œç»“æœï¼Œä»è€Œææ—©ä½œå‡ºæ“ä½œã€‚è¿™ä¸€ç‚¹åœ¨æ ¼æ–—å¯¹æ‰“æ¸¸æˆï¼ˆå¦‚ã€Šè¡—éœ¸ã€‹ï¼‰é‡Œé¢éå¸¸å…³é”®ï¼Œåœ¨ä¸€äº›RTSï¼ˆã€Šæ˜Ÿé™…äº‰éœ¸ã€‹ï¼‰é‡Œé¢ï¼Œææ—©çœ‹åˆ°æ¸¸æˆè¿è¡Œç»“æœä¹Ÿæ˜¯å¾ˆæœ‰ç«äº‰ä¼˜åŠ¿çš„ã€‚å› æ­¤æˆ‘ä»¬ä¸ºäº†è®©ç½‘ç»œã€ç¡¬ä»¶ä¸ä¸€æ ·çš„ç©å®¶èƒ½å…¬å¹³æ¸¸æˆï¼Œå¾€å¾€ä¼šä½¿ç”¨ä¸€ç§å«â€œé”æ­¥â€çš„ç­–ç•¥ï¼šå°±å¥½åƒä¸€ä¸²ç»‘ç€è„šé•£çš„å›šçŠ¯ï¼Œä»–ä»¬åªèƒ½ä¸€èµ·æŠ¬èµ·å·¦è„šï¼Œç„¶åå†ä¸€èµ·æŠ¬èµ·å³è„šçš„èµ°è·¯ï¼Œè°ä¹Ÿä¸èƒ½èµ°çš„æ›´å¿«ã€‚æŠ€æœ¯ä¸Šçš„å®ç°ï¼Œå°±æ˜¯æ¯ä¸ªå®¢æˆ·ç«¯éƒ½å®šæ—¶ï¼ˆæ¯Nä¸ªæ¸²æŸ“å¸§ï¼‰å‘é€ä¸€ä¸ªç½‘ç»œå¸§åˆ°æœåŠ¡å™¨ä¸Šï¼Œå°±ç®—ç©å®¶æ²¡æ“ä½œï¼Œä¹Ÿç±»ä¼¼å¿ƒè·³çš„è¿™æ ·å‘é€ç©ºæ•°æ®å¸§ï¼Œæ‰€æœ‰å®¢æˆ·ç«¯éƒ½è¦å®Œæ•´çš„æ”¶åˆ°æ‰€æœ‰çš„å…¶ä»–å®¢æˆ·ç«¯çš„â€œå¿ƒè·³å¸§â€æ‰èƒ½å¼€å§‹è¿ç®—ä¸€æ¬¡æ¸¸æˆé€»è¾‘ã€‚è¿™å°±æ˜¯è®©æ‰€æœ‰çš„å®¢æˆ·ç«¯ï¼Œéƒ½äº’ç›¸ç­‰å¾…ï¼Œå¦‚æœä»»ä½•ä¸€ä¸ªå®¢æˆ·ç«¯å¡äº†ï¼Œå…¶ä»–çš„å®¢æˆ·ç«¯éƒ½ç«‹åˆ»å°±èƒ½çŸ¥é“ï¼Œç„¶åå¼¹å‡ºç•Œé¢è®©ç©å®¶åœæ­¢è¾“å…¥æ¥ç­‰å¾…ã€‚å› æ­¤åœ¨å¾ˆå¤šåœºåˆï¼Œå¸§åŒæ­¥çš„æŠ€æœ¯ä¹Ÿè¢«æˆä¸ºâ€œé”æ­¥â€æŠ€æœ¯ï¼Œäº‹å®ä¸Šï¼Œåœ¨æ²¡æœ‰ç»Ÿä¸€çš„Relay ServeræœåŠ¡å™¨çš„æ—¶ä»£ï¼ˆIPXå±€åŸŸç½‘è¿æœºå¯¹æˆ˜çš„æ—¶ä»£ï¼‰ï¼Œå¸§åŒæ­¥çš„ç½‘ç»œå¸§å…¶å®å°±æ˜¯ä¸Šé¢æ‰€è¯´çš„æŸä¸ªå®¢æˆ·ç«¯çš„â€œå¿ƒè·³å¸§â€ï¼Œæ˜¯ç”±æŸä¸ªå®¢æˆ·ç«¯äº§ç”Ÿå¹¶å¹¿æ’­çš„ï¼ˆæ¯”å¦‚ä»¥å‰çš„å±€åŸŸç½‘æ¸¸æˆï¼Œéƒ½ä¼šç”±ä¸€ä¸ªå®¢æˆ·ç«¯å……å½“Hostä¸»æœºï¼‰ã€‚åœ¨ã€Šæ˜Ÿé™…äº‰éœ¸ã€‹è¿æœºæ¸¸æˆä¸­ï¼Œå¦‚æœæœ‰ä¸€ä¸ªç©å®¶æ‰çº¿äº†ï¼Œæ‰€æœ‰å…¶ä»–ç©å®¶å°±ä¼šå‘ç°æœ‰ä¸€ä¸ªç•Œé¢å¼¹å‡ºæ¥æŒ¡ä½ç”»é¢ï¼Œè¡¨ç¤ºåœ¨ç­‰æŸæŸæŸã€‚è¿™ç§åšæ³•å®é™…ä¸Šæ˜¯ç‰ºç‰²äº†æµç•…åº¦çš„ï¼Œå› ä¸ºä½ ä¼šå‘ç°ä¸€æ—¦æœ‰ç½‘ç»œã€ç¡¬ä»¶å¡çš„ç©å®¶åŠ å…¥æ¸¸æˆï¼Œæ‰€æœ‰å…¶ä»–ç©å®¶éƒ½å—ä»–çš„å½±å“ã€‚ä¸ºäº†å‡å°‘è¿™ç§å¯¹æµç•…åº¦çš„å½±å“ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨éœ€è¦â€œé”æ­¥â€çš„æ—¶å€™ï¼Œå°½é‡å°‘é”ä¸€ç‚¹ï¼Œæ¯”å¦‚ä¸æ˜¯å‘ç°ç¼ºäº†ä¸€å¸§å°±åœä¸‹æ¥ï¼Œè€Œæ˜¯ç¼ºäº†è‹¥å¹²å¸§ï¼Œè¿˜æ˜¯å¯ä»¥ä»¥â€œä¸å…¬å¹³â€çš„æ–¹å¼ç»§ç»­ç©ä¸€ä¼šå„¿ï¼ˆæ¯”å¦‚å‡ ç§’ï¼‰ï¼Œå¦‚æœè¿™æ®µæ—¶é—´å†…è¿˜æ˜¯æ²¡æœ‰è¡¥é½æ‰€ç¼ºçš„å¸§ï¼Œæ‰å®£å¸ƒé”ä½æ¸¸æˆç­‰å¾…ã€‚å½“ç„¶è¿™ä¸ªâ€œå®¹å¿â€çš„å¸§æ•°æˆ‘ä»¬å¯ä»¥è°ƒèŠ‚åˆ°â€œæœ€å¤§â€â€”â€”å°±æ˜¯æ²¡æœ‰ã€‚é‚£ä¹ˆä¸€ä¸ªå®Œå…¨ä¸é”æ­¥çš„æ¸¸æˆï¼Œè‚¯å®šä¸æ˜¯ä¸€ä¸ªå…¬å¹³çš„æ¸¸æˆï¼Œä½†æ˜¯ä¹Ÿä¼šåœ¨æµç•…æ€§äº§ç”Ÿæœ€å¤§çš„å¥½å¤„ï¼Œå°±æ˜¯å®Œå…¨ä¸å—å…¶ä»–ç©å®¶å½±å“ã€‚åœ¨é‚£äº›ä¸æ˜¯PVPï¼ˆç©å®¶å¯¹æˆ˜ï¼‰çš„å¸§åŒæ­¥æ¸¸æˆä¸­ï¼Œä¸å…¬å¹³è¿™ä¸ªå¾€å¾€é—®é¢˜ä¸å¤§ã€‚æˆ‘ä»¬å®Œå…¨å¯ä»¥åœ¨æ¸¸æˆçš„ä¸åŒç©æ³•é‡Œï¼Œæ‰“å¼€ã€è°ƒæ•´ã€ç”šè‡³å…³é—­è¿™ä¸ªâ€œé”æ­¥â€çš„æœºåˆ¶ï¼Œä»è€Œè®©æ¸¸æˆæœ€å¤§ç¨‹åº¦çš„å¹³è¡¡å…¬å¹³æ€§å’Œæµç•…æ€§ã€‚ ä¹Ÿå°±æ˜¯ä¸€ä¸ªåŒ…å«å…³ç³»ã€‚å¸§é”å®šåŒæ­¥(frame lock sync)ä¸€å®šåŒ…å«lock syncçš„æ‰€æœ‰ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œä½†å¸§åŒæ­¥æœªå¿…åŒ…å«locksetçš„ä¼˜ç¼ºç‚¹â€”â€”å‡å¦‚ï¼Œå¸§åŒæ­¥ä»…ä»…æ˜¯æŒ‰å¸§åŒæ­¥frame syncï¼Œè€Œä¸æ˜¯å¸§é”å®šåŒæ­¥çš„â€œç®€ç§°â€çš„è¯ã€‚ ä¼˜ç‚¹ å®ƒçš„å¼€å‘æ•ˆç‡æ¯”è¾ƒé«˜ã€‚å¦‚æœä½ å¼€å‘æ€è·¯çš„æ•´ä½“æ¡†æ¶æ˜¯éªŒè¯å¯è¡Œçš„ï¼Œå¦‚æœä½ æŠŠå®ƒçš„ç¼ºç‚¹è§£å†³äº†ï¼Œé‚£ä¹ˆä½ çš„å¼€å‘æ€è·¯å®Œå…¨å°±è·Ÿå†™å•æœºä¸€æ ·ï¼Œä½ åªéœ€è¦éµä»è¿™æ ·çš„æ€è·¯ï¼Œå°½é‡ä¿è¯æ€§èƒ½ï¼Œç¨‹åºè¯¥æ€ä¹ˆå†™å°±æ€ä¹ˆå†™ã€‚æ¯”å¦‚æˆ‘ä»¬ä»¥å‰è¦åœ¨çŠ¶æ€åŒæ­¥ä¸‹é¢åšä¸€ä¸ªå¤æ‚çš„æŠ€èƒ½ï¼Œæœ‰å¾ˆå¤šæ®µä½çš„æŠ€èƒ½ï¼Œå¯èƒ½è¦å¼€å‘å¥½å‡ å¤©ï¼Œæ‰èƒ½æœ‰ä¸€ä¸ªç¨å¾®è¿‡å¾—å»çš„ç»“æœï¼Œè€Œåœ¨å¸§åŒæ­¥ä¸‹é¢ï¼Œè‹±é›„åšå¤šæ®µä½æŠ€èƒ½å¾ˆå¯èƒ½åŠå¤©å°±æå®šäº†ã€‚ å®ƒèƒ½å®ç°æ›´å¼ºçš„æ‰“å‡»æ„Ÿï¼Œæ‰“å‡»æ„Ÿå¼ºé™¤äº†æˆ‘ä»¬è¯´çš„å„ç§åé¦ˆã€ç‰¹æ•ˆã€éŸ³æ•ˆå¤–ï¼Œè¿˜æœ‰å®ƒçš„å‡†ç¡®æ€§ã€‚åˆ©ç”¨å¸§åŒæ­¥ï¼Œæ¸¸æˆé‡Œé¢çœ‹åˆ°è¿™äº›æŒ¥èˆçš„åŠ¨ä½œï¼Œå°±èƒ½åšåˆ°åœ¨æ¯”è¾ƒå‡†ç¡®çš„æ—¶åˆ»äº§ç”Ÿåé¦ˆï¼Œä»¥åŠåŠ¨ä½œæœ¬èº«çš„å¯†åº¦ä¹Ÿå¯ä»¥åšåˆ°å¾ˆé«˜çš„é¢‘ç‡ï¼Œè¿™åœ¨çŠ¶æ€åŒæ­¥ä¸‹æ˜¯æ¯”è¾ƒéš¾åšçš„ã€‚ å®ƒçš„æµé‡æ¶ˆè€—æ˜¯ç¨³å®šçš„ã€‚å¤§å®¶åº”è¯¥çœ‹è¿‡ã€Šæ˜Ÿçº§äº‰éœ¸ã€‹çš„å½•åƒï¼Œå®ƒåªæœ‰å‡ ç™¾Kçš„å¤§å°ï¼Œè¿™é‡Œé¢åªæœ‰é©±åŠ¨æ¸¸æˆçš„è¾“å…¥åºåˆ—ã€‚å¸§åŒæ­¥åªä¼šéšç€ç©å®¶æ•°é‡çš„å¢å¤šï¼Œæµé‡æ‰ä¼šå¢é•¿ï¼Œå¦‚æœç©å®¶æ•°é‡å›ºå®šçš„è¯ï¼Œä¸ç®¡ä½ çš„æ¸¸æˆæœ‰å¤šå¤æ‚ï¼Œä½ çš„è§’è‰²æœ‰å¤šå°‘ï¼Œæµé‡æ¶ˆè€—åŸºæœ¬ä¸Šéƒ½æ˜¯ç¨³å®šçš„ã€‚è¿™ç‚¹å»¶ä¼¸å¼€æ¥è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯å¯ä»¥æ›´æ–¹ä¾¿åœ°å®ç°è§‚æˆ˜ï¼Œå½•åƒçš„å­˜å‚¨ã€å›æ”¾ï¼Œä»¥åŠåŸºäºå½•åƒæ–‡ä»¶çš„åç»­å¤„ç†ã€‚ ç¼ºç‚¹ æœ€è‡´å‘½çš„ç¼ºç‚¹æ˜¯ç½‘ç»œè¦æ±‚æ¯”è¾ƒé«˜ï¼Œå¸§åŒæ­¥æ˜¯é”å¸§çš„ï¼Œå¦‚æœæœ‰ç½‘ç»œçš„æŠ–åŠ¨ï¼Œä¸€æ®µæ—¶é—´è°ƒç”¨æ¬¡æ•°ä¸ç¨³å®šï¼Œç½‘ç»œå‘½ä»¤çš„å»¶è¿Ÿå°±ä¼šæŒ¤å‹ï¼Œå¼•èµ·å¡é¡¿ã€‚ å®ƒçš„åå¤–æŒ‚èƒ½åŠ›å¾ˆå¼±ï¼Œå¸§åŒæ­¥çš„é€»è¾‘éƒ½åœ¨å®¢æˆ·ç«¯é‡Œé¢ï¼Œä½ å¯ä»¥æ¯”è¾ƒå®¹æ˜“çš„ä¿®æ”¹å®ƒã€‚ä½†ä¸ºä»€ä¹ˆã€Šç‹è€…è£è€€ã€‹æ•¢ç”¨å¸§åŒæ­¥ï¼Œä¸€æ–¹é¢æ˜¯å› ä¸ºå½“æ—¶ç«‹é¡¹çš„æ—¶å€™å¼€å‘å‘¨æœŸå¾ˆçŸ­ï¼ŒåŠå¹´æ—¶é—´è¦åšä¸Šçº¿ï¼Œè¦æœ‰å‡ åä¸ªè‹±é›„ï¼Œå­˜åœ¨æ—¶é—´çš„å‹åŠ›ï¼Œå¦ä¸€æ–¹é¢ï¼ŒMOBAç±»æ¸¸æˆä¸åƒæ•°å€¼æˆé•¿ç±»çš„æ¸¸æˆï¼Œå®ƒçš„ç©æ³•æ˜¯åŸºäºå•å±€çš„ï¼Œå•å±€çš„ä½œå¼Šä¿®æ”¹ï¼Œé¡¶å¤šå½±å“è¿™ä¸€å±€çš„èƒœè´Ÿï¼Œä¸ä¼šå­˜æ¡£ï¼Œä¸ä¼šå‡ºç°åˆ·å¤šå°‘é’±åˆ·å¤šå°‘å¥½çš„è£…å¤‡çš„é—®é¢˜ï¼Œè€Œä¸”ä½œå¼Šä¹‹åæˆ‘ä»¬ä¹Ÿå¾ˆå®¹æ˜“ç›‘æµ‹åˆ°ï¼Œå¹¶ç»™äºˆåº”æœ‰çš„æƒ©ç½šï¼Œæ‰€ä»¥æˆ‘ä»¬è®¤ä¸ºè¿™ä¸æ˜¯è‡´å‘½çš„ç¼ºç‚¹ã€‚ å®ƒçš„æ–­çº¿é‡å›æ—¶é—´å¾ˆé•¿ï¼Œç›¸ä¿¡å°ä¸‹ä¹Ÿæœ‰å¾ˆå¤šç‹è€…ç©å®¶ï¼Œä¹Ÿæ›¾ç¢°åˆ°è¿‡é—ªé€€ä»¥åé‡å›åŠ è½½éå¸¸é•¿çš„æƒ…å†µï¼Œç”šè‡³åŠ è½½å®Œä»¥åæ¸¸æˆä¹Ÿå¿«ç»“æŸäº†ï¼Œè¿™æ˜¯å¸§åŒæ­¥æ¯”è¾ƒè‡´å‘½çš„é—®é¢˜ã€‚ å®ƒçš„é€»è¾‘æ€§èƒ½ä¼˜åŒ–æœ‰å¾ˆå¤§çš„å‹åŠ›ã€‚å¤§å®¶åº”è¯¥æ²¡æœ‰è§åˆ°å“ªä¸€æ¬¾å¤§å‹æ¸¸æˆæ˜¯ç”¨å¸§åŒæ­¥æ¥åšçš„ï¼Œå› ä¸ºè¿™äº›æ¸¸æˆçš„æ¯ä¸€ä¸ªé€»è¾‘å¯¹è±¡éƒ½æ˜¯éœ€è¦åœ¨å®¢æˆ·ç«¯è¿›è¡Œè¿ç®—çš„ã€‚å¦‚æœä½ åšä¸€ä¸ªä¸»åŸï¼Œä¸»åŸé‡Œé¢æœ‰ä¸Šåƒäººï¼Œä¸Šåƒäººè™½ç„¶ç©å®¶çœ‹ä¸åˆ°å®ƒï¼Œä½†æ¸¸æˆä»ç„¶éœ€è¦å¯¹ä»–ä»¬è¿›è¡Œæœ‰æ•ˆçš„é€»è¾‘è¿ç®—ï¼Œæ‰€ä»¥å¸§åŒæ­¥æ— æ³•åšéå¸¸å¤šçš„å¯¹è±¡éƒ½éœ€è¦æ›´æ–°çš„æ¸¸æˆåœºæ™¯ã€‚ ä¸‰åº§å¤§å±±åŒæ­¥é—®é¢˜å¸§åŒæ­¥çš„æŠ€æœ¯åŸç†ç›¸å½“ç®€å•ï¼Œä»ä¸€ä¸ªç›¸åŒåˆå§‹çš„çŠ¶æ€å¼€å§‹ï¼Œè·å¾—ä¸€ä¸ªç›¸åŒçš„è¾“å…¥ï¼Œå¾€ä¸‹ä¸€å¸§ä¸€å¸§æ‰§è¡Œï¼Œæ‰§è¡Œæ—¶æ‰€æœ‰ä»£ç çš„æµç¨‹èµ°å¾—éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¿™ä¸ªç»“æœè°ƒç”¨å®Œäº†ä»¥åï¼Œåˆæœ‰ä¸€ä¸ªæ–°çŠ¶æ€ï¼Œå®Œæˆå¾ªç¯ã€‚ç›¸åŒçš„çŠ¶æ€ï¼Œç›¸åŒçš„æµç¨‹ï¼Œä¸åœçš„è¿™æ ·å¾ªç¯ä¸‹å»ã€‚è¿™ä¸ªåŸç†è™½ç„¶ç®€å•ï¼Œä½†æ˜¯ä½ è¦å»å®ç°å®ƒçš„æ—¶å€™ï¼Œè¿˜æ˜¯ä¼šæœ‰å¾ˆå¤šå‘ã€‚å³è¾¹å†™çš„æ˜¯å®ç°è¦ç‚¹ï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨è§£å†³ç¬¬ä¸€åº§å¤§å±±ç»éªŒçš„æ€»ç»“ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å®é™…å¼€å‘è¿‡ç¨‹å½“ä¸­åšçš„äº‹æƒ…ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬æ‰€æœ‰çš„è¿ç®—éƒ½æ˜¯åŸºäºæ•´æ•°ï¼Œæ²¡æœ‰æµ®ç‚¹æ•°ã€‚æµ®ç‚¹æ•°æ˜¯ç”¨åˆ†å­åˆ†æ¯è¡¨è¾¾çš„ã€‚ å…¶æ¬¡ï¼Œæˆ‘ä»¬è¿˜ä¼šç”¨åˆ°ç¬¬ä¸‰æ–¹çš„ç»„ä»¶ï¼Œå¸§ç»„ä»¶ä¹Ÿè¦éœ€è¦è¿›è¡Œä¸€ä¸ªæ¯”è¾ƒä¸¥æ ¼çš„ç”„åˆ«ã€‚æˆ‘ä»¬æœ¬èº«ç”¨çš„å…¬å¸é‡Œé¢å…³äºæ—¶é—´è½´çš„ç¼–è¾‘å™¨é‡Œé¢ï¼Œæœ€åˆä¹Ÿæ˜¯æ˜¯æµ®ç‚¹æ•°ï¼Œæˆ‘ä»¬éƒ½æ˜¯è¿›è¡Œé‡å†™æ”¹é€ çš„ã€‚ å†æ¬¡ï¼Œå¾ˆå¤šäººåˆæ¬¡æ¥è§¦å¸§åŒæ­¥é‡Œé¢çš„é—®é¢˜ï¼Œå°±æ˜¯åœ¨å†™é€»è¾‘çš„æ—¶å€™å’Œæœ¬åœ°è¿›è¡Œäº†å…³è”ã€å’Œâ€œæˆ‘â€ç›¸å…³ï¼Œè¿™æ ·å°±å¯¼è‡´ä¸åŒå®¢æˆ·ç«¯èµ°åˆ°äº†ä¸åŒçš„åˆ†æ”¯ã€‚å®é™…ä¸Šï¼ŒçœŸæ­£å®¢æˆ·ç«¯è·Ÿé€»è¾‘çš„è¯ï¼Œè¦è·Ÿæˆ‘è¿™æ ·ä¸€ä¸ªæ¦‚å¿µæ— å…³ã€‚ æ¥ä¸‹æ¥è¿˜æœ‰éšæœºæ•°ï¼Œè¿™ä¸ªè¦ä¸¥æ ¼ä¸€è‡´ã€‚è¿™æ˜¯å®ç°çš„è¦ç‚¹ï¼Œä¸¥æ ¼æŒ‰ç…§è¿™ä¸Šé¢çš„è§„åˆ™å†™ä»£ç è¿˜æ˜¯æœ‰å¯èƒ½ä¸åŒæ­¥ï¼Œæœ¬èº«å°±å¾ˆéš¾æœç»è¿™æ ·çš„é—®é¢˜ã€‚æœ€åï¼ŒçœŸæ­£é‡è¦çš„æ˜¯å¼€å‘è€…è¦æå‡è‡ªå·±å‘ç°ä¸åŒæ­¥é—®é¢˜çš„èƒ½åŠ›ï¼Œä»€ä¹ˆæ—¶å€™ä¸åŒæ­¥äº†ï¼Œä¸åŒæ­¥ä½ è¿˜è¦çŸ¥é“ä¸åŒæ­¥åœ¨ä»€ä¹ˆç‚¹ï¼Œè¿™æ˜¯æœ€å…³é”®çš„ã€‚ä½ éœ€è¦é€šè¿‡ä½ çš„ç»éªŒå’Œæ€»ç»“æå‡è¿™æ ·çš„èƒ½åŠ›ã€‚è¿™ä¸ªèƒ½åŠ›è¿˜æ˜¯é€šè¿‡è¾“å‡ºæ¥çœ‹ä¸åŒå®¢æˆ·ç«¯ä¸åŒè¾“å‡ºï¼Œæ‰¾åˆ°å‘ç”Ÿåœ¨ä»€ä¹ˆç‚¹ã€‚ æ¯”å¦‚åœ¨ã€Šç‹è€…è£è€€ã€‹é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸åŒæ­¥çš„ç°è±¡åº”è¯¥æ˜¯è¿™æ ·ï¼Œæœ‰äººå¯¹ç€å¢™è·‘ï¼Œä½ çœ‹åˆ°çš„å’Œåˆ«äººç©çš„æ¸¸æˆæ˜¯ä¸ä¸€æ ·çš„ï¼Œå°±åƒè¿›å…¥å¹³è¡Œä¸–ç•Œã€‚ æœ€å¼€å§‹æµ‹è¯•ã€Šç‹è€…è£è€€ã€‹çš„ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸åŒæ­¥ç‡è¾¾åˆ°1%ï¼Œå°±æ˜¯100å±€é‡Œé¢æœ‰1å±€å‡ºç°ä¸åŒæ­¥ï¼Œæˆ‘ä»¬å°±ç®—æ¸¸æˆåˆæ ¼ï¼Œä½†å®é™…ä¸Šå¯¹äºè¿™ä¹ˆå¤§ä½“é‡æ¸¸æˆæ¥è¯´ï¼Œè¿™ä¸ªæ¯”ç‡æ˜¯æœ‰é—®é¢˜çš„ï¼Œç»è¿‡æˆ‘ä»¬ä¸åœçš„åŠªåŠ›ï¼Œç°åœ¨å·²ç»æ§åˆ¶åœ¨ä¸‡åˆ†ä¹‹å‡ ï¼Œä¸€ä¸‡å±€æ¸¸æˆé‡Œé¢ï¼Œå¯èƒ½æœ‰å‡ å±€æ˜¯ä¸åŒæ­¥çš„ã€‚è¿™ä¸ªé—®é¢˜ä¸ä¸€å®šæ˜¯ä»£ç åŸå› æˆ–è€…æ²¡æœ‰éµå¾ªè¿™äº›è¦ç‚¹æ‰å‡ºç°çš„ï¼Œæœ‰å¯èƒ½æ˜¯ä½ å»ä¿®æ”¹å†…å­˜ï¼Œä½ å»åŠ è½½èµ„æºçš„æ—¶å€™ï¼Œæœ¬åœ°èµ„æºæœ‰æŸå®³æˆ–è€…ç¼ºå¤±ï¼Œæˆ–è€…æ˜¯å¼‚å¸¸ã€‚è¯´ç™½äº†ï¼Œä½ æ²¡æœ‰åŠæ³•å¾€ä¸‹æ‰§è¡Œï¼Œå¤§å®¶èµ°äº†ä¸åŒåˆ†æ”¯ï¼Œè¿™éƒ½å¯èƒ½å¼•èµ·æœ€ç»ˆæ˜¯ä¸åŒæ­¥çš„ã€‚ å¦‚æœä½ ä¸åŒæ­¥æ¦‚ç‡æ¯”è¾ƒä½ï¼Œåˆ°äº†è¿™ç§ä¸‡åˆ†ä¹‹å‡ æ¦‚ç‡çš„æ—¶å€™ï¼Œå¾ˆéš¾é€šè¿‡æµ‹è¯•æ¥å»è¿˜åŸï¼Œå»æ‰¾åˆ°è¿™æ ·ä¸åŒæ­¥çš„ç‚¹ã€‚ æœ€å¼€å§‹æˆ‘ä»¬æ¸¸æˆå‡ºç°ä¸åŒæ­¥çš„æ—¶å€™ï¼Œå°±æ˜¯åœ¨å‘¨æœ«ç©å®¶å¼€é»‘å¤šçš„æ—¶å€™ï¼Œéšç€ä½ çš„æ¦‚ç‡è¶Šæ¥è¶Šä½ï¼ŒåŸºæœ¬ä¸Šä½ å°±è‡ªå·±å°±è¿˜åŸä¸å‡ºè¿™äº›é—®é¢˜äº†ï¼Œåªèƒ½ä¾é ç©å®¶å¸®ä½ è¿˜åŸè¿™æ ·çš„åœºæ™¯ï¼Œæ¥åˆ†æè¿™æ ·çš„ä¸åŒæ­¥é—®é¢˜ã€‚åŒæ­¥æ€§éµå¾ªè¿™æ ·çš„è¦ç‚¹ï¼ŒæŒ‰ç…§è¿™æ ·çš„æ€è·¯æ¥å†™ï¼ŒåŠ ä¸Šä½ ä¸åŒæ­¥å®šä½çš„èƒ½åŠ›ï¼Œæœ‰äº†ç›‘æ§æ‰‹æ®µèƒ½å¤Ÿå»å‘ç°ï¼Œè¿™ä¸ªé—®é¢˜å…¶å®å°±è§£å†³äº†ã€‚è§£å†³ä¹‹åï¼Œä½ å°±å¯ä»¥å¥½å¥½äº«å—å¸§åŒæ­¥çš„å¼€å‘ä¼˜åŠ¿ã€‚ ç½‘ç»œã€Šç‹è€…è£è€€ã€‹æŠ€æœ¯æµ‹è¯•ç‰ˆæœ¬å‡ºå°çš„æ—¶å€™ï¼Œå»¶è¿Ÿéå¸¸å¤§ï¼Œè€Œä¸”è¿˜æ˜¯å¡é¡¿ï¼Œç°åœ¨çœ‹ä¸€ä¸‹å¸§åŒæ­¥é‡Œé¢æ¯”è¾ƒç‰¹åˆ«çš„åœ°æ–¹ã€‚å¸§åŒæ­¥æœ‰ç‚¹åƒåœ¨çœ‹ç”µå½±ï¼Œå®ƒä¼ ç»Ÿçš„å¸§åŒæ­¥éœ€è¦æœ‰bufferï¼Œæ¯ä¸ªç©å®¶è¾“å…¥ä¼šè½¬å‘ç»™æ‰€æœ‰å®¢æˆ·ç«¯ï¼Œäº’ç›¸ä¼šæœ‰ç¼–å·ï¼ŒæŒ‰é¡ºåºè¾“å…¥å¸§ã€‚ æ¯”å¦‚æˆ‘ç°åœ¨å·²ç»æ”¶åˆ°ç¬¬Nå¸§ï¼Œåªæœ‰å½“æˆ‘æ”¶åˆ°ç¬¬N+1å¸§çš„æ—¶å€™ï¼Œç¬¬Nè¿™ä¸€å¸§æˆ‘æ‰å¯ä»¥æ‰§è¡Œã€‚æœåŠ¡å™¨ä¼šæŒ‰ç…§ä¸€å®šçš„é¢‘ç‡ï¼Œä¸åŒçš„ç»™å¤§å®¶åŒæ­¥å¸§ç¼–å·ï¼ŒåŒ…æ‹¬è¿™ä¸€å¸§çš„è¾“å…¥å¸¦ç»™å®¢æˆ·ç«¯ï¼Œå¦‚æœå¸¦ä¸€å¸§ç»™ä½ çš„æ•°æ®ä½ æ‹¿åˆ°ä¹‹åå°±æ‰§è¡Œï¼Œä¸‹ä¸€å¸§æ•°æ®æ²¡æ¥å°±ä¸èƒ½æ‰§è¡Œï¼Œå®ƒçš„ç»“æœå°±æ˜¯å¡é¡¿ã€‚ ç½‘ç»œç»å¯¹ç†æƒ³çš„æƒ…å†µä¸‹è¿˜å¥½ï¼Œä½†ç°å®çš„ç½‘ç»œç¯å¢ƒä¸æ˜¯è¿™æ ·çš„ã€‚å¸§åŒæ­¥è¦è§£å†³é—®é¢˜å°±æ˜¯è°ƒè¯•bufferï¼Œä»¥å‰æœ‰åŠ¨æ€çš„bufferï¼Œå®ƒæœ‰1åˆ°nè¿™æ ·çš„ç¼“å†²åŒºï¼Œæ ¹æ®ç½‘ç»œæŠ–åŠ¨çš„æƒ…å†µï¼Œæ”¶å…¥ç„¶åæ”¾åˆ°é˜Ÿåˆ—é‡Œé¢ã€‚ è¿™ä¸ªbufferçš„å¤§å°ï¼Œä¼šå½±å“åˆ°å»¶è¿Ÿå’Œå¡é¡¿ã€‚å¦‚æœä½ çš„bufferè¶Šå°ï¼Œä½ çš„å»¶è¿Ÿå°±è¶Šä½ï¼Œä½ æ‹¿åˆ°ä»¥åä½ ä¸éœ€è¦ç¼“å†²ç­‰å¾…ï¼Œé©¬ä¸Šå°±å¯ä»¥æ‰§è¡Œã€‚ä½†æ˜¯å¦‚æœä¸‹ä¸€å¸§æ²¡æ¥ï¼Œbufferå¾ˆå°ï¼Œä½ å°±ä¸èƒ½æ‰§è¡Œï¼Œæœ€ç»ˆå¯¼è‡´çš„ç»“æœä½ çš„å»¶è¿Ÿè¿˜å¥½ï¼Œä½†æ˜¯å¡é¡¿å¾ˆæ˜æ˜¾ã€‚ å¦‚æœè°ƒåˆ°å¸§åŒæ­¥çš„bufferï¼Œå‡å¦‚æˆ‘ä»¬è®¤ä¸ºç½‘ç»œå»¶è¿Ÿæ˜¯1ç§’ï¼Œä½ æŠ–åŠ¨è°ƒåˆ°1ç§’ï¼Œé‚£å¾—åˆ°çš„ç»“æœè™½ç„¶ä½ ç”»é¢ä¸æŠ–åŠ¨äº†ï¼Œä½†æ˜¯ä½ çš„å»¶è¿Ÿæå…¶é«˜ã€‚å¦‚æœè¿æœ€åçš„ç½‘ç»œæƒ…å†µéƒ½è€ƒè™‘è¿›å»ï¼Œbufferè¶³å¤Ÿå¤§ï¼Œé‚£ä¹ˆè®°è¿‡å°±è·Ÿçœ‹è§†é¢‘æ˜¯ä¸€æ ·çš„ï¼Œå¹³è¡Œçš„ä¸œè¥¿ï¼Œçœ‹ä½ è°ƒå¤§æ¡å°ã€‚ä¸€äº›å±€éƒ¨çš„æªæ–½æˆ‘ä»¬éƒ½åšè¿‡ï¼Œéƒ½æ˜¯ä¸€æ ·çš„é—®é¢˜ã€‚ å…·ä½“æˆ‘ä»¬æ€ä¹ˆä¼˜åŒ–å¡é¡¿çš„é—®é¢˜å‘¢ï¼Ÿ åˆšæ‰æåˆ°è¯¥å¸§åŒæ­¥ä¸bufferï¼Œè¿™ä¸ªbufferå¯ä»¥æ˜¯1ä¹Ÿå¯ä»¥åˆ°nï¼Œæˆ‘ä»¬è¦è§£å†³æˆ‘ä»¬çš„å»¶è¿Ÿé—®é¢˜ï¼Œæˆ‘ä»¬å°±è®©bufferè¶³å¤Ÿå°ã€‚äº‹å®ä¸Šã€Šç‹è€…è£è€€ã€‹æœ€ååšåˆ°çš„bufferæ˜¯é›¶ï¼Œå®ƒä¸éœ€è¦bufferï¼ŒæœåŠ¡å™¨ç»™äº†æˆ‘nï¼Œé©¬ä¸ŠçŸ¥é“æ˜¯nï¼Œæˆ‘æ”¶åˆ°nï¼Œæˆ‘çŸ¥é“ä¸‹ä¸€æ¬¡è‚¯å®šæ˜¯n+1ï¼Œæ‰€ä»¥æˆ‘æ”¶åˆ°nä¹‹åé©¬ä¸Šå°±æŠŠnè¿™ä¸€å¸§çš„è¾“å…¥æ‰§è¡Œäº†ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆä¸å¡é¡¿äº†ï¼Œç”»é¢ä¸æŠ–åŠ¨äº†ï¼Ÿ æœ€åä¸€ä¸ªå…³é”®ç‚¹ï¼Œæ˜¯æœ¬åœ°æ’å€¼å¹³æ»‘åŠ é€»è¾‘ä¸è¡¨ç°åˆ†ç¦»ã€‚å®¢æˆ·ç«¯åªè´Ÿè´£ä¸€äº›æ¨¡å‹ã€åŠ¨ç”»ã€å®ƒçš„ä½ç½®ï¼Œå®ƒä¼šæ ¹æ®ç»‘å®šçš„é€»è¾‘å¯¹è±¡çŠ¶æ€ã€é€Ÿåº¦ã€æ–¹å‘æ¥è¿›è¡Œä¸€ä¸ªæ’å€¼ï¼Œè¿™æ ·å¯ä»¥åšåˆ°æˆ‘ä»¬çš„é€»è¾‘å¸§ç‡å’Œæ¸²æŸ“å¸§ç‡ä¸ä¸€æ ·ï¼Œä½†æ˜¯åšäº†æ’å€¼å¹³æ»‘å’Œé€»è¾‘è¡¨ç°åˆ†ç¦»ï¼Œç”»é¢ä¸æŠ–äº†ï¼Œå»¶è¿Ÿæ„Ÿä¹Ÿæ˜¯å¾ˆå¥½çš„ã€‚ åšäº†è¿™äº›åï¼Œæˆ‘ä»¬è¿˜æŠŠTCPæ¢æˆUDPï¼Œåœ¨æ‰‹æœºç¯å¢ƒä¸‹ï¼Œå¼±ç½‘çš„æƒ…å†µä¸‹ï¼ŒTCPå¾ˆéš¾æ¢å¤é‡è¿ï¼Œæ‰€ä»¥æœ€åç”¨äº†UDPæ¥åšã€‚æ•´ä½“æ¥è¯´ï¼Œåœ¨ç½‘ç»œå¥½çš„æƒ…å†µä¸‹ï¼Œå®ƒå»¶è¿Ÿä¹Ÿæ˜¯å¾ˆå¥½çš„ï¼Œåœ¨ç½‘ç»œæ¯”è¾ƒå·®çš„æƒ…å†µä¸‹åšæ’å€¼ï¼Œä¹Ÿæ˜¯ä¼ ç»ŸCSçš„è¡¨ç°ã€‚ æˆ‘ä»¬ç»å¸¸è§åˆ°è§’è‰²Aå’ŒBï¼Œæœ‰äº›å®¢æˆ·ç«¯Aåœ¨å·¦Båœ¨å³ï¼Œæœ‰äº›æ˜¯Aåœ¨å³Båœ¨å·¦ï¼Œå¸§åŒæ­¥é€»è¾‘ä¸Šé¢ABä¹‹é—´çš„è·ç¦»å’Œåæ ‡éƒ½æ˜¯å®Œå…¨ä¸€æ ·ï¼Œä½†æ˜¯ç”»é¢ä¸Šçœ‹åˆ°ä»–ä»¬å¯èƒ½ä¼šä¸é‡åˆï¼Œé‚£å°±æ˜¯ä½ æŠŠå®ƒä»¬åˆ†ç¦»ä¹‹åçš„è¡¨ç°ã€‚ç½‘ç»œæå…¶å¥½çš„æƒ…å†µä¸‹ï¼Œå®ƒåº”è¯¥æ˜¯é‡åˆçš„ï¼Œä½†æ˜¯åœ¨ç½‘ç»œå·®çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šæœ‰äº›åå·®ã€‚è¿™é‡Œé¢æ˜¯æœ€é‡è¦çš„ä¸€å—ä¼˜åŒ–ã€‚ æ€§èƒ½çš„ä¼˜åŒ–æœ¬èº«å¸§åŒæ­¥é€»è¾‘ä¸Šé¢åœ¨ä¼˜åŒ–ä¸Šé¢å­˜åœ¨ä¸€äº›ç¼ºç‚¹ï¼Œæ‰€æœ‰çš„è§’è‰²éƒ½éœ€è¦è¿›è¡Œè¿ç®—ã€‚è¿™æ–¹é¢æˆ‘ä»¬ä¹Ÿæ˜¯å€ŸåŠ©Unityçš„ç‰¹æ€§ï¼Œå¦‚æœä½ æƒ³è¿½æ±‚æ€§èƒ½ä¸Šçš„æè‡´ï¼Œæœ‰äº›ä¸œè¥¿ä½ éœ€è¦å¯»æ±‚å¥½çš„æ–¹å¼ã€‚ ç¬¬ä¸€ç‚¹æ˜¯çƒ­ç‚¹çš„å¤„ç†ã€‚ æˆ‘ä»¬æ˜¯ä¸ç”¨åå°„çš„ï¼Œå®ƒéƒ½æœ‰GCæ€§èƒ½å¼€é”€ï¼Œæˆ‘ä»¬çš„åšæ³•é‡Œé¢ï¼Œä¼šæŠŠå¯¹è±¡çš„æ˜¾ç¤ºéšè—æ”¾åœ¨ä¸åŒçš„æ¸²æŸ“å±‚é‡Œé¢ï¼Œå°½é‡è®©æ•´ä¸ªæ¸¸æˆå¸§ç‡æ˜¯å¹³æ»‘çš„è¿‡ç¨‹ã€‚è¿˜æœ‰æˆ‘ä»¬æœ¬èº«æœ‰è‡ªå·±çš„ç³»ç»Ÿï¼Œæ¯”å¦‚AIï¼Œåœ¨ã€Šç‹è€…è£è€€ã€‹è¿™æ ·çš„å¤šè§’è‰²æ¸¸æˆä¸­ï¼Œä½ å¦‚æœæƒ³è¦åšå‡ºæ¯”è¾ƒå¥½çš„ä½“éªŒï¼Œé‚£ä¹ˆAIå°±è¦åšå¾—æ¯”è¾ƒå¤æ‚ã€‚ è€Œè¦å»ä¼˜åŒ–çƒ­ç‚¹ï¼Œæˆ‘è§‰å¾—å°±åªæœ‰è¿™ä¸‰ä¸ªæ­¥éª¤å¯ä»¥èµ°ã€‚ é¦–å…ˆï¼Œä»ç¨‹åºçš„ç»“æ„ä¸Šé¢èƒ½æ‰¾åˆ°æ›´ä¼˜çš„ï¼Œå®ƒçš„ä¼˜åŒ–æ•ˆæœå°±æ˜¯æœ€æ˜æ˜¾çš„ï¼›å…¶æ¬¡ï¼Œå¦‚æœä½ çš„ç»“æ„éƒ½æ˜¯ç”¨çš„æœ€å¥½ï¼Œå°±å»æŒ–æ˜å±€éƒ¨çš„ç®—æ³•ï¼Œè°ƒæ•´ä½ ä»£ç çš„ä¸€äº›å†™æ³•ã€‚æœ€åï¼Œå¦‚æœå±€éƒ¨çš„ç®—æ³•éƒ½å·²ç»è°ƒåˆ°æœ€ä¼˜è¿˜æ˜¯æ²¡æœ‰ä»€ä¹ˆåŠæ³•ï¼Œé‚£åªæœ‰ä¸€æ¡è·¯ï¼Œå°±æ˜¯ç‰ºç‰²æ•´ä¸ªè´¨é‡ï¼Œå°±æ˜¯åˆ†å¸§é™é¢‘ã€‚ ç¬¬äºŒç‚¹æ˜¯GCï¼Œè¿™å—åˆšæ‰è¯´ä¸ç”¨åå°„ï¼Œè¿˜æœ‰è£…ç®±å’Œæ‹†ç®±çš„è¡Œä¸ºä¹Ÿæ˜¯å°½é‡å°‘ç”¨ã€‚UnityæŒ‡å¯¼è¿‡æˆ‘ä»¬çš„ä¼˜åŒ–ï¼Œä»GCä¸Šé¢çš„è€ƒè™‘ï¼Œä»–ä»¬å»ºè®®æ¯ä¸€å¸§åº”è¯¥åœ¨200ä¸ªå­—èŠ‚ä»¥å†…æ˜¯æ¯”è¾ƒå¥½çš„çŠ¶æ€ï¼Œå…¶å®å¾ˆéš¾åšåˆ°ï¼Œç‹è€…ä¹Ÿæ˜¯æ¯ä¸€å¸§åœ¨1kå·¦å³ï¼Œå¾ˆéš¾åšåˆ°200ã€‚ ç¬¬ä¸‰ç‚¹æ˜¯Drawcallï¼Œè¿™äº›ä¼ ç»Ÿçš„ä¼˜åŒ–æ‰‹æ®µå¤§å®¶éƒ½ç”¨çš„å¾ˆç†Ÿäº†ã€‚ ç¬¬å››ç‚¹æ˜¯è£å‰ªï¼Œå¸§åŒæ­¥é‡Œé¢æ˜¯ä¸èƒ½è£å‰ªçš„ï¼Œè¡¨ç°é‡Œé¢æˆ‘çœ‹ä¸åˆ°çš„å¯ä»¥é™ä½é¢‘ç‡æˆ–è€…ä¸æ›´æ–°å®ƒï¼Œè¿™åœ¨è¡¨ç°é‡Œé¢å¯ä»¥åšçš„ã€‚ ç¬¬äº”ç‚¹æ˜¯3DUIçš„ä¼˜åŒ–ï¼Œæ¯”å¦‚ã€Šç‹è€…è£è€€ã€‹çš„è¡€æ¡ã€å°åœ°å›¾ä¸Šé¢å çš„å…ƒç´ ç­‰ç­‰ï¼Œè¿™äº›UIéƒ½æ¯”è¾ƒä¸°å¯Œï¼Œè¿™å—æˆ‘ä»¬ç”¨äº†31UIçš„æ–¹å¼æ¥ä¼˜åŒ–ï¼Œæ²¡æœ‰ç”¨UGUIé‡Œé¢è¿›è¡Œè¡€æ¡æ–¹é¢çš„å¤„ç†ã€‚ æˆ‘ä»¬ä¹Ÿç‰ºç‰²äº†ä¸€äº›ä¸œè¥¿ï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½åŠ è½½äº†ï¼Œåœ¨æ¸¸æˆè¿‡ç¨‹å½“ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸è¦æœ‰ä»»ä½•IOè¡Œä¸ºï¼ŒåŒ…æ‹¬è¾“å‡ºæˆ‘ä»¬éƒ½æ˜¯è¦å¸ƒå±€çš„ã€‚ä½ å¤„ç†çš„å†³ç­–å’Œå¤æ‚åº¦ï¼Œå¦‚æœåœ¨ä¸€å¸§é‡Œé¢æ”¾å‡º100é¢—å­å¼¹ï¼Œåœ¨æ”¾100é¢—å­å¼¹çš„æ—¶å€™ä¸€å®šè¦æ‰å¸§çš„ï¼Œä¸€å®šè¦åœ¨åŠ›æ‰€èƒ½åŠçš„æ—¶å€™æŠŠè¿™äº›ä¸œè¥¿åšåˆ°æè‡´ã€‚ä¸Šé¢æçš„æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä»£ï¼Œä¹Ÿæ˜¯åœ¨å»å¹´5æœˆä»½ä»¥å‰åšçš„ä¼˜åŒ–æ–¹æ¡ˆã€‚5æœˆä»½ä»¥åï¼Œæˆ‘ä»¬è¿˜åšäº†å¦å¤–ä¸€ä»¶äº‹æƒ…ï¼šGameCoreã€‚ é¦–å…ˆï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬è§‰å¾—iOSæ¯”å®‰å“çš„ä¼˜åŒ–æ•ˆç‡é«˜ä¸€äº›ï¼Œä¸€æ–¹é¢æ˜¯iOSçš„CPUæ¶æ„åŒ…æ‹¬ç³»ç»Ÿç¡®å®éƒ½ä¼˜åŒ–çš„æ¯”è¾ƒå¥½ï¼Œå¦ä¸€æ–¹é¢æˆ‘ä»¬ç”¨çš„Unity4.6ï¼Œåœ¨IOSä¸‹é¢å®ƒæœ¬èº«æ•ˆç‡é«˜ä¸€äº›ï¼Œåœ¨å®‰å“ç«¯çš„æœºå™¨å„ç§å„æ ·ï¼Œæ€§èƒ½ä¹Ÿæ˜¯åƒå·®ä¸‡åˆ«ï¼Œæˆ‘ä»¬åªèƒ½ç”¨æ€§èƒ½æ¯”è¾ƒå·®çš„æ–¹å¼ã€‚ å› ä¸ºæˆ‘ä»¬å·²ç»åšåˆ°é€»è¾‘å’Œè¡¨ç°çš„åˆ†ç¦»ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½æŠŠé€»è¾‘ç‹¬ç«‹å‡ºæ¥ï¼Œåšæˆä¸€ä¸ªC++çš„ä¸œè¥¿ï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨å»å¹´å¼€å§‹å·²ç»åœ¨è¿™æ ·åšäº†ã€‚åšä¹‹å‰ä¹Ÿæµ‹è¯•è¿‡C++å’ŒMonoæ€§èƒ½çš„å·®åˆ«ï¼Œå¤§æ¦‚æ˜¯2.5å·¦å³ï¼Œæœ¬èº«æˆ‘ä»¬çš„é€»è¾‘å æ¯”æ¸¸æˆæ¶ˆè€—20%å¤šï¼Œé€»è¾‘ä¸æ˜¯ä¸€ä¸ªå¤§å¤´ï¼Œæˆ‘ä»¬åšäº†è¿™ä»¶äº‹æƒ…ä¹‹åï¼Œè¿˜æ˜¯æœ‰æ•ˆçš„ï¼Œå¸§ç‡æå‡äº†2åˆ°3å¸§ï¼ŒèŠ±çš„æ—¶é—´å¾ˆé•¿ã€‚ å…¶æ¬¡ï¼ŒåšGameCoreä»¥åæœ€æ˜æ˜¾çš„å˜åŒ–æ˜¯æˆ‘ä»¬ä»¥å‰é€»è¾‘ä¸Šçš„GCæ²¡æœ‰äº†ï¼Œæˆ‘ä»¬æœ‰è‡ªå·±å†…å­˜çš„ç®¡ç†ã€å¯¹è±¡çš„ç®¡ç†ï¼ŒåŒ…æ‹¬é‡Œé¢æ‰€æœ‰çš„å®¹å™¨ç±»è¿™äº›ä¸œè¥¿éƒ½æ˜¯æˆ‘ä»¬è‡ªå·±å®ç°çš„ï¼ŒåŒ…æ‹¬åå°„æ•´ä¸ªä¸€å¥—ã€‚å®ƒæœ‰äº†è‡ªå·±çš„å†…å­˜ç®¡ç†ï¼Œæœ¬èº«çš„æ•ˆç‡å°±ä¼šæ¯”è¾ƒé«˜ï¼Œè¿™å°±å·²ç»æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„ä¼˜åŠ¿äº†ã€‚ å†æ¬¡ï¼Œæœ‰äº†GameCoreä¹‹åï¼Œåˆå¤šäº†å¾ˆå¤šåº”ç”¨åœºæ™¯ï¼Œè¿™ä¸ªä¸œè¥¿å°±æ˜¯ç©æ³•çš„æœåŠ¡å™¨ç‰ˆæœ¬ï¼Œåº”ç”¨åœºæ™¯è¿è¡ŒæœåŠ¡å™¨è¦åšå¾ˆå¤šçš„åˆ†æï¼Œè¿˜æœ‰ç¬¬ä¸‰æ–¹ä½¿ç”¨éƒ½æ˜¯å¯ä»¥çš„ã€‚ æœ€åï¼ŒGameCoreè¿˜æœ‰å¯ä»¥æ‰©å±•å¤šçº¿ç¨‹çš„æ½œåŠ›ã€‚ status syncè¿™æ—¶å€™å’±ä»¬å†æ¥è°ˆè°ˆçŠ¶æ€åŒæ­¥ï¼ˆstatus syncï¼‰ã€‚æ€ä¹ˆè¯´å‘¢ï¼Œå…¶å®çŠ¶æ€åŒæ­¥å¹¶éå­—é¢ä¸Šçš„æ„æ€ï¼Œè€Œæ˜¯ä»¥å‰ä¸€ä¸ªæ ‡å‡†åŒ–çš„ç½‘ç»œåŒæ­¥æ–¹æ¡ˆã€‚æ¯•ç«ŸæŒ‰å­—é¢æ„æ€çš„è¯ï¼Œå¸§åŒæ­¥/å¸§é”å®šåŒæ­¥ï¼Œäººå®¶åŒæ­¥çš„æ“ä½œæ•°æ®éš¾é“å°±ä¸æ˜¯çŠ¶æ€äº†ï¼Ÿæ¸¸æˆä¸­äº†åŒ…å«å„ç§çŠ¶æ€ï¼ŒçŠ¶æ€åŒæ­¥ä¼šåœ¨â€œåˆé€‚â€çš„æ—¶é—´ï¼Œâ€åˆé€‚â€çš„é—´éš”ï¼Œâ€åˆé€‚â€çš„æ•°æ®åˆ‡åˆ†ä¸‹ï¼Œå°†ä¸€ä¸ªå®¢æˆ·æœºçš„çŠ¶æ€åŒæ­¥åˆ°å…¶ä»–å®¢æˆ·æœºä¸Šã€‚æ‰€è°“â€œåˆé€‚â€ï¼Œå³æ˜¯æ²¡è°±ï¼Œä¹Ÿå°±æ˜¯ä¸å®šæ—¶ä¸å®šæœŸï¼Œæœ‰æ•°æ®å°±ç®—æ²¡æ•°æ®å°±ç®—äº†ï¼Œæ‰€ä»¥ï¼Œæ— æ³•ä¿è¯æ¯ä¸ªå®¢æˆ·æœºä¸Šçœ‹åˆ°çš„ç”»é¢æ˜¯ä¸€è‡´çš„ï¼Œåªèƒ½ä¿è¯ä»–ä»¬çœ‹åˆ°çš„å†…å®¹ä¸ä¼šå·®åˆ«ç‰¹åˆ«å¤§ã€‚å¦å¤–ï¼Œä¸ºäº†å‡å°‘åŒæ­¥çš„æ•°æ®é‡ï¼Œå®ƒé€šå¸¸åªä¼šå°†å˜åŒ–çš„æ•°æ®è¿›è¡ŒåŒæ­¥ï¼Œæ‰€ä»¥éœ€è¦å¯¹æ•°æ®è¿›è¡Œåˆ‡åˆ†ä»¥åˆ¤æ–­å“ªäº›æœ‰å˜åŒ–ï¼Œå“ªäº›éœ€è¦åŒæ­¥ã€‚å› æ­¤ï¼ŒECSè‡ªå¸¦çš„æ•°æ®åˆ‡åˆ†å°±å¯¹â€œçŠ¶æ€åŒæ­¥å¤©ç”Ÿäº²å’Œâ€ï¼Œåªè¦ç»™Componentå†™ä¸€ä¸ªDirtyæœºåˆ¶ï¼Œç„¶ååŒæ­¥æ‰€æœ‰Dirtyçš„Componentå°±å¥½äº†ï¼Œä¸éœ€è¦é‡æ–°è®¾è®¡åŒæ­¥è§„åˆ™ã€‚ä½†æ˜¯ï¼Œå³ä½¿æ˜¯è¿™ä¸ªç‹­ä¹‰çš„çŠ¶æ€åŒæ­¥ï¼ˆstatus syncï¼‰ï¼Œå®ƒå…¶å®å’ŒæŒ‰å¸§åŒæ­¥ï¼ˆframe syncï¼‰ä¹Ÿæ˜¯ä¸çŸ›ç›¾çš„ã€‚åªè¦æœåŠ¡ç«¯å…ˆé›†é½ä¸€å¸§æ‰€æœ‰å®¢æˆ·ç«¯å‘é€çš„çŠ¶æ€ï¼Œå†ç»Ÿä¸€å½’ç»“æˆä¸€ä¸ªæ•°æ®åŒ…å¹¿æ’­åˆ°æ‰€æœ‰å®¢æˆ·ç«¯ï¼Œå®ƒå°±å¯ä»¥æ‹¥æœ‰å’Œframe syncå®Œå…¨ä¸€è‡´çš„ç‰¹æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œstatus syncå’Œframe syncå…¶å®æ˜¯ä¸å†²çªçš„ï¼Œä½ å®Œå…¨å¯ä»¥æå‡ºframe status syncï¼ˆä»¥å¸§ä¸ºå•ä½çš„çŠ¶æ€åŒæ­¥ï¼‰æ¥ã€‚æ‰€ä»¥ï¼Œæˆ‘ä¸ªäººå»ºè®®å¤§å®¶èˆå¼ƒæ‰â€œå¸§åŒæ­¥â€â€œçŠ¶æ€åŒæ­¥â€è¿™ç§è¯ï¼Œè€Œæ”¹æˆæ›´å°‘æ­§ä¹‰çš„â€œå¸§é”å®šåŒæ­¥â€å’Œâ€œéå¸§é”å®šåŒæ­¥â€ï¼ˆæˆ–è€…lockstepåŒæ­¥å’ŒélockstepåŒæ­¥ï¼‰ã€‚å¦‚æœæåˆ°äº†æˆ‘ä¸Šé¢å®šä¹‰çš„è¿™ç§ä¸æ˜¯lockstepçš„frame syncï¼ˆå…¶å®LOLå°±æ˜¯è¿™æ ·çš„ï¼‰ï¼Œå°±å¹²è„†ç›´æ¥è¯´â€œä¸æ˜¯lockstepçš„æŒ‰å¸§åŒæ­¥â€ã€‚ çŠ¶æ€åŒæ­¥çš„ä¼˜ç‚¹ å®ƒçš„å®‰å…¨æ€§éå¸¸é«˜ï¼Œå¤–æŒ‚åŸºæœ¬ä¸Šæ²¡æœ‰ä»€ä¹ˆèƒ½åŠ›ä»ä¸­æ”¶ç›Šã€‚ çŠ¶æ€åŒæ­¥å¯¹äºç½‘ç»œçš„å¸¦å®½å’ŒæŠ–åŠ¨åŒ…æœ‰æ›´å¼ºçš„é€‚åº”èƒ½åŠ›ï¼Œå³ä¾¿å‡ºç°äº†200ã€300çš„è¾“å…¥å»¶è¿Ÿå†æ¢å¤æ­£å¸¸ï¼Œç©å®¶å…¶å®ä¹Ÿæ„Ÿå—ä¸åˆ°ä¸å¤ªèˆ’æœçš„åœ°æ–¹ã€‚ åœ¨å¼€å‘æ¸¸æˆè¿‡ç¨‹ä¸­ï¼Œå®ƒçš„æ–­çº¿é‡è¿æ¯”è¾ƒå¿«ï¼Œå¦‚æœæˆ‘çš„æ¸¸æˆå´©æºƒäº†ï¼Œå®¢æˆ·ç«¯é‡å¯ä¹‹ååªéœ€è¦æœåŠ¡å™¨æŠŠæ‰€æœ‰é‡è¦å¯¹è±¡çš„çŠ¶æ€å†åŒæ­¥ä¸€æ¬¡è¿‡æ¥ï¼Œé‡æ–°å†åˆ›å»ºå‡ºæ¥å°±å¯ä»¥äº†ã€‚ å®ƒçš„å®¢æˆ·ç«¯æ€§èƒ½ä¼˜åŒ–ä¼˜åŠ¿ä¹Ÿæ¯”è¾ƒæ˜æ˜¾ï¼Œæ¯”å¦‚ä¼˜åŒ–æ—¶å¯ä»¥åšè£å‰ªï¼Œç©å®¶çœ‹ä¸åˆ°çš„è§’è‰²å¯ä»¥ä¸ç”¨åˆ›å»ºï¼Œä¸ç”¨å¯¹å®ƒè¿›è¡Œè¿ç®—ï¼ŒèŠ‚çœæ¶ˆè€—ã€‚ ç¼ºç‚¹ç¬¬ä¸€ï¼Œå®ƒçš„å¼€å‘æ•ˆç‡ç›¸å¯¹å¸§åŒæ­¥è€Œè¨€è¦å·®ä¸€äº›ï¼Œå¾ˆå¤šæ—¶å€™ä½ éœ€è¦ä¿è¯æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯çš„æ¯ä¸€ä¸ªè§’è‰²å¯¹è±¡çš„çŠ¶æ€ä¹‹é—´ä¿æŒä¸€è‡´ï¼Œä½†äº‹å®ä¸Šä½ å¾ˆéš¾åšåˆ°ä¸€è‡´ã€‚ æ¯”å¦‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯æ›´æ–°çš„é¢‘ç‡ï¼Œå¯¹ä¼˜åŒ–çš„ä¸€äº›è£å‰ªï¼Œç½‘ç»œçš„æŠ–åŠ¨ç­‰ç­‰ï¼Œä½ è¦è®©æ¯ä¸€ä¸ªçŠ¶æ€åœ¨å®¢æˆ·ç«¯åŒæ­¥æ˜¯æ¯”è¾ƒéš¾çš„ï¼Œè€Œä½ è¦æƒ³è°ƒè¯•è¿™äº›ä¸œè¥¿ï¼Œæ¥ä¼˜åŒ–å®ƒå¸¦æ¥çš„æ¼æ´ã€ä¸ä¸€è‡´çš„ç°è±¡ï¼ŒèŠ±è´¹çš„å‘¨æœŸä¹Ÿä¼šæ¯”è¾ƒé•¿ï¼Œæƒ³è¦è¾¾åˆ°ä¼˜åŒ–å¥½çš„æ°´å¹³ä¹Ÿæ¯”è¾ƒéš¾ã€‚ ç¬¬äºŒï¼Œå®ƒæ¯”è¾ƒéš¾åšå‡ºåŠ¨ä½œç±»æ¸¸æˆæ‰“å‡»æ„Ÿå’Œç²¾ç¡®æ€§ã€‚æ¯”å¦‚è¯´ä½ è¦åšä¸€ä¸ªå°„å‡»ç±»è§’è‰²ï¼Œä»–çš„å­å¼¹æ¯ç§’é’Ÿè¦äº§ç”Ÿå‡ åé¢—ï¼ŒåŸºäºçŠ¶æ€åŒæ­¥æ¥åšæ˜¯æ¯”è¾ƒéš¾çš„ï¼Œå› ä¸ºç³»ç»Ÿåœ¨å¾ˆçŸ­æ—¶é—´å†…ï¼Œä¼šäº§ç”Ÿå¾ˆå¤šæ•°æ®ï¼Œè¦é€šè¿‡åˆ›å»ºã€é”€æ¯ã€ä½ç½®è¿ç®—æ¥åŒæ­¥ã€‚ ç¬¬ä¸‰ï¼Œå®ƒçš„æµé‡ä¼šéšç€æ¸¸æˆçš„å¤æ‚åº¦ï¼Œè€Œé€æ¸å¢é•¿ï¼Œæ¯”å¦‚è§’è‰²çš„å¤šå°‘ã€‚æˆ‘ä»¬åšã€Šç‹è€…è£è€€ã€‹æ—¶ï¼Œå¸Œæœ›åœ¨3Gã€4Gçš„ç½‘ç»œæ¡ä»¶ä¸‹ä¹Ÿèƒ½å¤Ÿç©PvPï¼Œæ‰€ä»¥æˆ‘ä»¬å¸Œæœ›å®ƒå¯¹ä»˜è´¹æµé‡çš„æ¶ˆè€—èƒ½æ§åˆ¶åœ¨æ¯”è¾ƒåˆç†çš„æ°´å¹³ï¼Œä¸å¸Œæœ›æ‰“ä¸€å±€æ¸¸æˆå°±æ¶ˆè€—å‡ åå…†çš„æ•°æ®æµé‡ã€‚ lockstepæ— æ³•é™ä½æ¸¸æˆå»¶è¿Ÿï¼Œåè€Œè¿˜ä¼šå¢åŠ å»¶è¿Ÿã€‚lockstepæˆ–è€…è¯´æŒ‰å¸§åŒæ­¥frame syncï¼Œä¿è¯çš„æ˜¯ç”»é¢çš„ä¸€è‡´æ€§ã€‚å»¶è¿Ÿåªèƒ½é ä¼˜åŒ–ç½‘ç»œé€Ÿåº¦å’Œæœ¬åœ°é¢„æµ‹é™ä½ã€‚ åŒæ­¥ç²¾åº¦å’ŒåŒæ­¥æ–¹å¼æ— å…³ï¼Œåªå’ŒæœåŠ¡å™¨å¸§çš„é¢‘ç‡å’ŒåŒæ­¥é¢‘ç‡æœ‰å…³ã€‚é¢‘ç‡è¶Šé«˜ç²¾åº¦è‡ªç„¶å°±è¶Šé«˜ï¼Œå°±è¶Šä¸å®¹æ˜“å‡ºç°æš‚æ—¶æ€§çš„ç”»é¢é”™è¯¯ã€‚æ˜¯å¦èƒ½é€šè¿‡å½•åƒæ–‡ä»¶é‡æ”¾ï¼Œåªéœ€è¦â€œä¼ªéšæœºæ•°â€å’Œâ€œå›ºå®šé—´éš”è¿è¡Œâ€å³å¯ï¼Œå’Œâ€œåŒæ­¥â€æ— å…³ã€‚ä»¥å‰çš„FCæ¨¡æ‹Ÿå™¨å°±æœ‰å®Œæ•´çš„å½•åƒåŠŸèƒ½ï¼Œéš¾ä¸æˆé‚£ä¹Ÿæ˜¯lockstepäº†ï¼Ÿ â€œlockstepï¼ˆæ­¥è°ƒä¸€è‡´ï¼‰â€ç¼©å†™æˆâ€lockï¼ˆé”ï¼‰â€è¿™ä¸ªç¼©å†™æœ¬èº«å°±æ˜¯é”™çš„è¿™ä»¶äº‹ï¼Œå°±ä¸ç”¨æäº†ã€‚æ¯•ç«Ÿè¿™ä¸ªç¼©å†™é”™è¯¯åªä¼šå¯¼è‡´è¿·æƒ‘ï¼Œå¹¶ä¸ä¼šå¯¼è‡´æ­§ä¹‰ã€‚ lockstepä¸æ˜¯MOBAæ¸¸æˆçš„å”¯ä¸€è§£ï¼Œæœ¬æ¥ä¹Ÿä¸æ˜¯ã€‚ä½†æ˜¯æŒ‰å¸§åŒæ­¥ç¡®å®æ˜¯å¿…é¡»çš„ã€‚ å¸§åŒæ­¥çš„å‡ ä¸ªéš¾ç‚¹ä¿è¯å®¢æˆ·ç«¯ç‹¬è‡ªè®¡ç®—çš„æ­£ç¡®ï¼Œå³ä¸€è‡´æ€§å¸§åŒæ­¥çš„åŸºç¡€ï¼Œæ˜¯ä¸åŒçš„å®¢æˆ·ç«¯ï¼ŒåŸºäºç›¸åŒçš„æ“ä½œæŒ‡ä»¤é¡ºåºï¼Œå„è‡ªæ‰§è¡Œé€»è¾‘ï¼Œèƒ½å¾—åˆ°ç›¸åŒçš„æ•ˆæœã€‚å°±å¦‚å¤§å®¶æ‰€çŸ¥é“çš„ï¼Œåœ¨unityä¸‹ï¼Œä¸åŒçš„è°ƒç”¨é¡ºåºï¼Œæ—¶åºï¼Œæµ®ç‚¹æ•°è®¡ç®—çš„åå·®ï¼Œå®¹å™¨çš„æ’åºä¸ç¡®å®šæ€§ï¼Œcoroutineå†…å†™é€»è¾‘å¸¦æ¥çš„ä¸ç¡®å®šæ€§ï¼Œç‰©ç†æµ®ç‚¹æ•°ï¼Œéšæœºæ•°å€¼å¸¦æ¥çš„ä¸ç¡®å®šæ€§ç­‰ç­‰ã€‚æœ‰äº›æ¯”è¾ƒå¥½è§£å†³ï¼Œæ¯”å¦‚éšæœºæ•°å€¼ï¼Œåªéœ€è¦åšéšæœºç§å­å³å¯ã€‚æœ‰äº›æ³¨æ„ä»£ç è§„èŒƒï¼Œæ¯”å¦‚åœ¨å¸§åŒæ­¥çš„æˆ˜æ–—ä¸­ï¼Œé€»è¾‘éƒ¨åˆ†ä¸ä½¿ç”¨Coroutineï¼Œä¸ä¾èµ–ç±»ä¼¼Dictionaryç­‰ä¸ç¡®å®šé¡ºåºçš„å®¹å™¨çš„å¾ªç¯ç­‰ã€‚è¿˜æœ‰æœ€åŸºç¡€çš„ï¼Œè¦é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„é€»è¾‘tickå…¥å£ï¼Œæ¥æ›´æ–°æ•´ä¸ªæˆ˜æ–—é€»è¾‘ï¼Œè€Œä¸æ˜¯æ¯ä¸ªé€»è¾‘è‡ªå·±å»Updateã€‚ä¿è¯æ¯æ¬¡tickéƒ½ä»ä¸Šåˆ°ä¸‹ï¼Œæ¯æ¬¡æ‰§è¡Œçš„é¡ºåºä¸€è‡´ã€‚æµ®ç‚¹æ•°è®¡ç®—æ— æ³•ä¿è¯ä¸€è‡´æ€§ï¼Œæˆ‘ä»¬éœ€è¦è½¬æ¢ä¸ºå®šç‚¹æ•°ã€‚å…³äºå®šç‚¹æ•°çš„å®ç°ï¼Œæ¯”è¾ƒç®€å•çš„æ–¹å¼æ˜¯ï¼Œåœ¨åŸæ¥æµ®ç‚¹æ•°çš„åŸºç¡€ä¸Šä¹˜1000æˆ–10000ï¼Œå¯¹åº”åœ°æ–¹é™¤ä»¥1000æˆ–10000ï¼Œè¿™ç§åšæ³•æœ€ä¸ºç®€å•ï¼Œå†è¾…ä»¥ä¸‰è§’å‡½æ•°æŸ¥è¡¨ï¼Œèƒ½è§£å†³ä¸€äº›é—®é¢˜ï¼Œå‡å°‘è®¡ç®—ä¸ä¸€è‡´çš„æ¦‚ç‡ï¼Œä½†æ˜¯ï¼Œè¿™ç§åšæ³•æ˜¯æ²»æ ‡ä¸æ²»æœ¬çš„æ–¹å¼ï¼Œå­˜åœ¨ä¸€äº›éšæ‚£ï¼ˆä¸¾ä¸ªä¾‹å­ï¼Œä¾‹å¦‚ä¸€ä¸ªintå’Œä¸€ä¸ªfloatåšä¹˜æ³•ï¼Œå¦‚æœåŸæ•°å€¼å°±è¦*1000ï¼Œé‚£æœ€åç®—å‡ºæ¥çš„æ•°å€¼ï¼Œå¯èƒ½ä¼šéå¸¸å¤§ï¼Œæœ‰è¶Šç•Œçš„é£é™©ã€‚ï¼‰ã€‚æ˜¯ä½¿ç”¨å®ç°æ›´åŠ ç²¾ç¡®å’Œä¸¥è°¨ï¼Œå¹¶ç»è¿‡éªŒè¯çš„å®šç‚¹æ•°æ•°å­¦åº“ã€‚å¯¹äºè®¡ç®—çš„ä¸ç¡®å®šæ€§ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ä¸€äº›å°çš„éšæ‚£ï¼Œå°±æ˜¯ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†Physics.Raycastæ¥æ£€æµ‹åœ°é¢å’Œå›´å¢™ï¼Œè®©äººç‰©å¯ä»¥ä¸Šä¸‹å¡ï¼Œèµ°æ¥¼æ¢¯ç­‰é«˜ä½ä¸å¹³çš„è·¯ï¼Œä¹Ÿå¯ä»¥æœ‰å½¢çŠ¶ä¸è§„åˆ™çš„å¢™ã€‚è¿™é‡Œä¼šè·å¾—ä¸€ä¸ªæµ®ç‚¹æ•°çš„ä½ç½®ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸ç¡®å®šæ€§ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬ç”¨äº†æ•°å€¼æˆªæ–­ç­‰æ–¹å¼ï¼Œå°½é‡è§„é¿ï¼Œç»è¿‡åå¤æµ‹è¯•ï¼Œæ²¡æœ‰å‡ºç°è¿‡ä¸ä¸€è‡´ã€‚ å¸§åŒæ­¥æ¸¸æˆä¸­ï¼Œç”±äºéœ€è¦â€œæ¯ä¸€å¸§â€éƒ½è¦å¹¿æ’­æ•°æ®ï¼Œæ‰€ä»¥å¹¿æ’­çš„é¢‘ç‡éå¸¸é«˜ï¼Œè¿™å°±è¦æ±‚æ¯æ¬¡å¹¿æ’­çš„æ•°æ®è¦è¶³å¤Ÿçš„å°ã€‚æœ€å¥½æ¯ä¸€ä¸ªç½‘ç»œå¸§ï¼Œèƒ½åœ¨ä¸€ä¸ªMTUä»¥ä¸‹ï¼Œè¿™æ ·æ‰èƒ½æœ‰æ•ˆé™ä½åº•å±‚ç½‘ç»œçš„å»¶è¿Ÿã€‚åŒæ ·çš„ç†ç”±ï¼Œæˆ‘ä»¬ä¸ºäº†æé«˜å®æ—¶æ€§ï¼Œä¸€èˆ¬ä¹Ÿå€¾å‘äºä½¿ç”¨UDPè€Œä¸æ˜¯TCPåè®®ï¼Œè¿™æ ·åº•å±‚çš„å¤„ç†ä¼šæ›´é«˜æ•ˆã€‚ä½†æ˜¯ï¼Œè¿™æ ·ä¹Ÿä¼šå¸¦æ¥äº†ä¸¢åŒ…ã€ä¹±åºçš„å¯èƒ½æ€§ã€‚å› æ­¤æˆ‘ä»¬å¸¸å¸¸ä¼šä»¥å†—ä½™çš„æ–¹å¼â€”â€”æ¯”å¦‚æ¯ä¸ªå¸§æ•°æ®åŒ…ï¼Œå®é™…ä¸Šæ˜¯åŒ…å«äº†è¿‡å»2å¸§çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡å‘3å¸§çš„æ•°æ®ï¼Œæ¥å¯¹æŠ—ä¸¢åŒ…ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸‰ä¸ªåŒ…é‡Œé¢åªè¦æœ‰ä¸€ä¸ªåŒ…æ²¡ä¸¢ï¼Œå°±ä¸å½±å“æ¸¸æˆã€‚å¦å¤–æˆ‘ä»¬è¿˜ä¼šåœ¨RelayServerä¸Šä¿å­˜å¤§é‡çš„å®¢æˆ·ç«¯ä¸Šä¼ çš„æ•°æ®ï¼Œå¦‚æœå®¢æˆ·ç«¯å‘ç°ä¸¢äº†åŒ…ï¼ˆå¦‚æœä¹±åºäº†ä¹Ÿè®¤ä¸ºæ˜¯ä¸¢åŒ…ï¼‰ï¼Œé‚£ä¹ˆå°±å‘èµ·ä¸€æ¬¡â€œä¸‹è½½â€è¯·æ±‚ï¼Œä»æœåŠ¡å™¨ä¸Šé‡æ–°ä¸‹è½½ä¸¢å¤±äº†çš„å¸§æ•°æ®åŒ…ï¼ˆè¿™ä¸ªå¯èƒ½ä¼šä½¿ç”¨TCPï¼‰ã€‚è¿™ä¸€åˆ‡ï¼Œéƒ½ä¾èµ–äºæ¯ä¸ªå¸§æ•°æ®è¦è¶³å¤Ÿçš„å°ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬è¦æ±‚ï¼Œæ¯æ¬¡å®¢æˆ·ç«¯å‘é€çš„æ•°æ®ï¼Œåº”è¯¥å°äº128å­—èŠ‚ã€‚ä½ å¯ä»¥å¤§æ¦‚è®¡ç®—ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬çš„æ¸¸æˆæœ‰4ä¸ªç©å®¶ï¼Œæˆ‘ä»¬çš„å†—ä½™æ˜¯3å¸§ï¼Œé‚£ä¹ˆä¸€ä¸ªä¸‹è¡Œçš„ç½‘ç»œå¸§æ•°æ®åŒ…å¤§å°ä¼šåˆ°128x4x3=1536å­—èŠ‚ï¼Œè€Œæ¯ç§’æˆ‘ä»¬å‘15ä¸ªç½‘ç»œå¸§ï¼Œé‚£ä¹ˆå ç”¨çš„å¸¦å®½ä¼šåˆ°1536x15=23,040å­—èŠ‚/ç§’ï¼ŒåŠ ä¸Šä¸€äº›åº•å±‚åè®®åŒ…å¤´ä¹Ÿå°±æ˜¯24kB/sï¼Œè¿™ä¸ªé€Ÿåº¦çœ‹èµ·æ¥å·²ç»è¦æ±‚æ‰‹æœºæ˜¯3Gç½‘ç»œæ‰èƒ½æ”¯æŒäº†ï¼ˆå®æµ‹ä¸­GPRSä¸€èˆ¬å¾ˆéš¾ç¨³å®šåˆ°è¿™ä¸ªé€Ÿåº¦ï¼‰ã€‚å¦å¤–ä¸€ä¸ªé™ä½å¹¿æ’­æ•°æ®é‡çš„åšæ³•å°±æ˜¯è‡ªå·±ç¼–å†™åºåˆ—åŒ–å‡½æ•°ï¼šä¸€èˆ¬ç°ä»£ç¼–ç¨‹è¯­è¨€ï¼Œç‰¹åˆ«æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œéƒ½å¸¦æœ‰æŠŠå¯¹è±¡åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„åŠŸèƒ½ã€‚æˆ‘ä»¬è¦å¹¿æ’­æ¸¸æˆæ“ä½œçš„æ—¶å€™ï¼Œè¿™äº›æ“ä½œå¾€å¾€ä¹Ÿæ˜¯ä¸€ä¸ªä¸ªçš„â€œå¯¹è±¡â€ï¼Œå› æ­¤æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨ç¼–ç¨‹è¯­è¨€è‡ªå¸¦çš„åºåˆ—åŒ–åº“æ¥æŠŠå¯¹è±¡è½¬æ¢æˆå­—èŠ‚æ•°ç»„å»å¹¿æ’­ã€‚ä½†æ˜¯è¿™äº›ç¼–ç¨‹è¯­è¨€çš„é»˜è®¤åºåˆ—åŒ–åŠŸèƒ½ï¼Œä¸ºäº†å®ç°è¯¸å¦‚åå°„ç­‰é«˜çº§åŠŸèƒ½ï¼Œä¼šæŠŠå¾ˆå¤šæ¸¸æˆé€»è¾‘æ‰€â€œä¸å¿…è¦â€çš„æ•°æ®ä¹Ÿåºåˆ—åŒ–äº†ï¼Œæ¯”å¦‚å¯¹è±¡çš„ç±»åã€å±æ€§åä»€ä¹ˆçš„ã€‚å¦‚æœæˆ‘ä»¬è‡ªå·±å»é’ˆå¯¹ç‰¹å®šçš„æ•°æ®å¯¹è±¡æ¥ç¼–å†™åºåˆ—åŒ–å‡½æ•°ï¼Œå°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä»…ä»…æå–æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ï¼Œç”šè‡³èƒ½åˆå¹¶å’Œè£å‰ªä¸€äº›æ•°æ®é¡¹ï¼Œè¾¾åˆ°æœ€å°åŒ–æ•°æ®é•¿åº¦çš„ç›®çš„ã€‚ åœ¨ç½‘ç»œæ¸¸æˆä¸­ï¼Œå„ä¸ªå®¢æˆ·ç«¯çš„è¿è¡Œæ¡ä»¶å’Œç¯å¢ƒå¾€å¾€åƒå·®ä¸‡åˆ«ï¼Œæœ‰çš„ç¡¬ä»¶å¥½ä¸€äº›ï¼Œæœ‰çš„å·®ä¸€äº›ï¼Œå„æ–¹çš„ç½‘ç»œæƒ…å†µä¹Ÿä¸ä¸€è‡´ï¼›æ—¶ä¸æ—¶ç©å®¶çš„ç½‘ç»œè¿˜ä¼šåœ¨æ¸¸æˆè¿‡ç¨‹ä¸­ï¼Œå‘ç”Ÿä¸´æ—¶çš„æ‹¥å µï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œç½‘ç»œæŠ–åŠ¨â€ã€‚ç½‘ç»œæ¸¸æˆæœ‰æ—¶å€™è¿˜ä¼šéœ€è¦æœ‰ä¸­é€”åŠ å…¥æ¸¸æˆçš„éœ€æ±‚ï¼ˆä¹±å…¥ï¼‰ï¼Œæœ‰æ¸¸æˆå½•åƒå’Œè§‚çœ‹ã€å¿«è¿›å½•åƒçš„åŠŸèƒ½ã€‚è¿™äº›åŠŸèƒ½ï¼Œéƒ½å¯èƒ½å¯¼è‡´å®¢æˆ·ç«¯æ”¶åˆ°â€œè¿‡å»æ—¶é—´â€é‡Œçš„ä¸€å †ç½‘ç»œå¸§ï¼Œå› æ­¤ï¼Œå®¢æˆ·ç«¯å¿…é¡»è¦æœ‰å¤„ç†è¿™äº›å †ç§¯èµ·æ¥çš„ç½‘ç»œæ•°æ®çš„èƒ½åŠ›ã€‚æœ€ç®€å•çš„åšæ³•å°±æ˜¯åŠ é€Ÿæ’­æ”¾ï¼ˆå¿«è¿›ï¼‰â€”â€”å¦‚æœæ”¶åˆ°ç½‘ç»œæ•°æ®å¤„ç†å®Œæ¸¸æˆé€»è¾‘åï¼Œç„¶ååœ¨åŒä¸€ä¸ªæ¸²æŸ“å¸§ï¼ˆåŒä¸€æ¬¡Update()å‡½æ•°é‡Œï¼‰å†…ï¼Œé©¬ä¸Šç»§ç»­æ”¶ä¸‹ä¸€ä¸ªç½‘ç»œæ•°æ®ï¼Œç„¶ååˆç«‹åˆ»å¤„ç†ã€‚è¿™æ ·å¾€å¾€èƒ½åœ¨ä¸€ä¸ªæ¸²æŸ“å¸§çš„æ—¶é—´å†…ï¼ŒåŠ é€Ÿèµ¶ä¸ŠæœåŠ¡å™¨å¹¿æ’­çš„æœ€æ–°æ¸¸æˆè¿›åº¦ã€‚ä½†æ˜¯è¿™æ ·åšä¹Ÿä¼šæœ‰å‰¯ä½œç”¨ï¼Œå¦‚æœå®¢æˆ·ç«¯ç§¯ç´¯çš„åŒ…å¤ªå¤šï¼ˆæ¯”å¦‚æ¸¸æˆå·²ç»å¼€å§‹ç©äº†10åˆ†é’Ÿï¼Œæ–°çš„ç”¨æˆ·ä¸­é€”åŠ å…¥ï¼‰ï¼Œä¼šå¯¼è‡´è¿™ä¸ªç”¨æˆ·é•¿æ—¶é—´å¡ä½ï¼Œå› ä¸ºç¨‹åºæ­£åœ¨ç–¯ç‹‚çš„ä¸‹è½½ç§¯ç´¯çš„å¸§åŒæ­¥åŒ…å’Œè¿ç®—å¿«è¿›ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ‰äº›ç¨‹åºå‘˜ä¼šé™åˆ¶æ¯ä¸€ä¸ªæ¸²æŸ“å¸§ä¸­æ‰€å¿«è¿›çš„æ“ä½œæ¬¡æ•°ï¼Œè¿™æ ·ç”¨æˆ·è¿˜æ˜¯èƒ½çœ‹åˆ°ç”»é¢æœ‰æ´»åŠ¨ã€‚å¦‚æœå®åœ¨è¦å¿«è¿›çš„è¿›åº¦å¤ªå¤šï¼Œå°±è¦é‡‡ç”¨â€œå¿«ç…§â€æŠ€æœ¯ï¼Œé€šè¿‡å®šæ—¶ä¿å­˜çš„æ¸¸æˆçŠ¶æ€æ•°æ®ï¼Œæ¥å‡å°‘å¿«è¿›çš„è¿›åº¦äº†ã€‚è¿™ä¸ªå¿«ç…§åŠŸèƒ½è¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬çš„å®¢æˆ·ç«¯çš„æ¸²æŸ“å¸§ç‡éƒ½ä¼šå¤§å¤§é«˜äºç½‘ç»œå¸§çš„æ¥æ”¶é¢‘ç‡ã€‚å¦‚æœæˆ‘ä»¬æ¯ä¸ªæ¸²æŸ“å¸§éƒ½å»å‘é€ä¸€æ¬¡ç©å®¶æ“ä½œï¼ˆæ¯”å¦‚è§¦æ‘¸å±ä¸Šçš„æ‰‹æŒ‡ä½ç½®ï¼‰ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå¯¼è‡´å‘é€çš„æ¸¸æˆæ“ä½œè¿œè¿œå¤§äºæ”¶åˆ°çš„æ“ä½œï¼Œè¿™æ ·åšè¦ä¹ˆä¼šè®©æ¸¸æˆæ“ä½œå †ç§¯åœ¨æœåŠ¡å™¨ä¸Šï¼Œå¯¼è‡´æ“ä½œçš„ä¸¥é‡å»¶è¿Ÿï¼Œè¦ä¹ˆå¯¼è‡´ä¸‹è¡Œçš„ç½‘ç»œåŒ…éå¸¸å¤§ï¼ˆæœåŠ¡å™¨æ¯æ¬¡éƒ½æŠŠæ”¶åˆ°çš„æ‰€æœ‰æ“ä½œä¸€æ¬¡ä¸‹å‘ï¼‰ï¼Œè¿™æ ·ä¼šè®©ç½‘ç»œå¸¦å®½å æ»¡ï¼ŒåŒæ ·æ˜¯ä¼šæ„Ÿè§‰å»¶è¿Ÿã€‚ä¸ç®¡æ€ä¹ˆå¤„ç†ï¼Œéƒ½æ˜¯ä¸å¤ªå¥½çš„ç»“æœã€‚æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯æ§åˆ¶å‘åŒ…é¢‘ç‡ï¼Œæœ€å¥½æ˜¯è‡³å°‘æ”¶åˆ°ä¸€ä¸ªç½‘ç»œä¸‹è¡Œå¸§ï¼Œæ‰å‘é€ä¸€ä¸ªä¸Šè¡Œçš„æ¸¸æˆæ“ä½œï¼Œé¿å…å †ç§¯ã€‚å¦å¤–ï¼Œåˆšåˆšè®²åˆ°çš„â€œå¿«è¿›â€ï¼Œå¦‚æœæˆ‘ä»¬åœ¨å¿«é€Ÿæ’­æ”¾æ¸¸æˆé€»è¾‘çš„æ—¶å€™ï¼Œæ¯æ¬¡æ’­æ”¾åŒæ—¶ä¹Ÿé‡‡é›†ç©å®¶è¾“å…¥å»å‘é€ï¼Œé‚£ä¹ˆåŒæ ·ä¼šå¯¼è‡´çŸ­æ—¶é—´å†…å‘é€ä¸€å¤§å †ä¸Šè¡Œæ•°æ®ç»™æœåŠ¡å™¨ï¼Œè€Œè¿™äº›æ•°æ®å¾ˆå¯èƒ½å®¢æˆ·ç«¯æ¥æ”¶æ—¶äº§ç”Ÿå¤§é‡çš„å»¶è¿Ÿã€‚æ‰€ä»¥æœ€å¥½æ˜¯åœ¨å¿«è¿›çš„æ—¶å€™ä¸é‡‡é›†ç©å®¶çš„è¾“å…¥ï¼Œå› ä¸ºç©å®¶åœ¨çœ‹åˆ°å¿«è¿›è¿‡ç¨‹ä¸­ï¼Œå®é™…ä¸Šä¹Ÿå¾ˆéš¾æœ‰æ•ˆçš„åšå‡ºåˆç†çš„ååº”ï¼Œä¸€ä¸ªå¸¸è§çš„åšæ³•ï¼Œå°±æ˜¯å¿«è¿›çš„æ—¶å€™ï¼Œç»™æ¸¸æˆè¦†ç›–ä¸€ä¸ªâ€œç­‰å¾…â€æˆ–â€œLoadingâ€çš„è’™çš®å±‚ï¼Œè®©ç©å®¶ä¸å¯ä»¥è¾“å…¥æ“ä½œã€‚ å…³äºæµç•…åº¦çš„ä¼˜åŒ–å®æ—¶åŒæ­¥æ¸¸æˆæœ€é‡è¦çš„æ˜¯æµç•…ï¼Œç„¶è€Œå½±å“æ¸¸æˆæµç•…çš„å› ç´ å¾ˆå¤šï¼Œç½‘ç»œå¸¦å®½çš„é™åˆ¶ï¼ŒCPUè¿ç®—å’Œæ¸²æŸ“æ•ˆç‡çš„é™åˆ¶ï¼Œéƒ½æ˜¯å¾ˆå¤§çš„é—®é¢˜ã€‚æ‰€å¹¸æ¸¸æˆæœ¬èº«è¿˜æ˜¯æœ‰å¾ˆå¤šå¯ä»¥å–èˆçš„å› ç´ ï¼Œè¿™è®©æˆ‘ä»¬å¯ä»¥ç‰ºç‰²ä¸€äº›æ¸¸æˆä¸å¤ªé‡è¦çš„ç‰¹æ€§ï¼Œå»æé«˜æµç•…åº¦ã€‚ ç¬¬ä¸€ä¸ªå¯ä»¥ç”¨æ¥äº¤æ¢æµç•…åº¦çš„æ˜¯â€œä¸€è‡´æ€§â€ç‰¹æ€§ã€‚æˆ‘ä»¬åšå¸§åŒæ­¥çš„ç›®æ ‡æ˜¯å„ä¸ªå®¢æˆ·ç«¯éƒ½èƒ½çœ‹åˆ°ä¸€è‡´çš„æ˜¾ç¤ºã€‚ä½†æ˜¯æ¸¸æˆå†…å®¹æœ‰å¾ˆå¤šï¼Œæœ‰ä¸€éƒ¨åˆ†å†…å®¹æ˜¯å¯ä»¥å®¹å¿â€œä¸ä¸€è‡´â€çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬åšé£è¡Œå°„å‡»å¼¹å¹•æ¸¸æˆï¼Œæ»¡å±å¹•æœ‰å¾ˆå¤šå­å¼¹ï¼Œè€Œæ¯ä¸€é¢—å­å¼¹æœ¬èº«çš„å­˜åœ¨çš„æ—¶é—´å¾ˆçŸ­ï¼Œå¦‚æœæˆ‘ä»¬ä¸æ˜¯åšå¯¹æ‰“çš„æ¸¸æˆï¼ˆè€Œæ˜¯ä¸€èµ·æ‰“ç”µè„‘ï¼‰ï¼Œé‚£ä¹ˆè¿™äº›å­å¼¹æ˜¯å¯ä»¥ä¸ä¸€è‡´çš„ã€‚åˆæ¯”å¦‚æˆ‘ä»¬åšä¸€ä¸ªæ¨ªç‰ˆè¿‡å…³çš„é…åˆæ¸¸æˆï¼Œå‡ ä¸ªç©å®¶ä¸€èµ·æ‰“ç”µè„‘æ§åˆ¶çš„æ€ªç‰©ï¼Œå¤§å®¶å…³å¿ƒçš„æ˜¯æ€ªç‰©æ˜¯æ€ä¹ˆè¢«æ‰“æ­»çš„ï¼Œè€Œç©æ³•æœ¬èº«åˆæ¯”è¾ƒå®¹å¿ä¸ä¸€è‡´ï¼ˆæ¨ªç‰ˆåŠ¨ä½œæ¸¸æˆçš„æ”»å‡»èŒƒå›´å¾€å¾€æ¯”è¾ƒå¤§ï¼‰ï¼Œæ‰€ä»¥å°±ç®—æœ‰äº›ä¸ä¸€è‡´é—®é¢˜ä¹Ÿä¸å¤§ã€‚åœ¨ä»¥ä¸Šçš„æ¡ä»¶ä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•ï¼ŒæŠŠæ›´å¤šçš„æ¸¸æˆé€»è¾‘ï¼Œä»ç½‘ç»œå¸§çš„UpdateByNet()å‡½æ•°é‡Œé¢æ‹¿å‡ºå»ï¼Œæ”¾å›åˆ°å•æœºæ¸¸æˆä¸­çš„Update()å‡½æ•°é‡Œå»ã€‚è¿™æ ·å°±ç®—ç½‘ç»œæœ‰ç‚¹å¡ï¼Œèµ·ç æ•´ä¸ªç”»é¢é‡Œè¿˜æ˜¯æœ‰å¾ˆå¤šä¸œè¥¿æ˜¯ä¸ä¼šè¢«â€œå¡ä½â€çš„ã€‚ä½†æ˜¯å¿…é¡»æ³¨æ„çš„æ˜¯ï¼Œä¸€èˆ¬ç©å®¶æ§åˆ¶çš„è§’è‰²çš„åŠ¨ä½œï¼ŒåŒ…æ‹¬å½“å‰å®¢æˆ·ç«¯æ§åˆ¶çš„è§’è‰²ï¼Œè¿˜æ˜¯åº”è¯¥ä»ç½‘ç»œå¸§é‡Œé¢è·å¾—è¡Œä¸ºæ•°æ®ï¼Œå› ä¸ºå¦‚æœç©å®¶çˆ±æ§åˆ¶è§’è‰²ä¸ä¸€è‡´çš„å¤ªå¤šï¼Œæ•´ä¸ªæ¸¸æˆåœºé¢å°±ä¼šå·®æ›´å¤šã€‚å¾ˆå¤šæ¸¸æˆä¸­çš„æ€ªç‰©AIéƒ½æ˜¯æ ¹æ®ç©å®¶è§’è‰²æ¥è®¾å®šçš„ï¼Œæ‰€ä»¥ä¸€æ—¦ç©å®¶è§’è‰²çš„è¡Œä¸ºæ˜¯åŒæ­¥çš„ï¼Œé‚£ä¹ˆå¤§å¤šæ•°çš„æ€ªç‰©çš„è¡¨ç°è¿˜æ˜¯ä¸€è‡´çš„ã€‚ ç¬¬äºŒä¸ªå¯ä»¥ç”¨æ¥äº¤æ¢æµç•…åº¦çš„ç‰¹æ€§æ˜¯å®æ—¶æ€§ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬éƒ½å¸Œæœ›æ¸¸æˆä¸­çš„è§’è‰²æ§åˆ¶æ˜¯çµæ•çš„ï¼Œå®æ—¶çš„ã€‚æˆ‘ä»¬çš„æ¸¸æˆè§’è‰²å¾€å¾€åœ¨ä¼šç©å®¶è¾“å…¥æ“ä½œåçš„å‡ ååˆ†ä¹‹ä¸€ç§’å†…ï¼Œå°±å¼€å§‹æ˜¾ç¤ºå˜åŒ–ã€‚åœ¨å¸§åŒæ­¥æ¸¸æˆä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®©ç©å®¶ä¸€è¾“å…¥å®Œæ“ä½œï¼Œå°±ç«‹åˆ»å‘åŒ…ï¼Œç„¶åå°½å¿«åœ¨ä¸‹ä¸€ä¸ªæ”¶åˆ°çš„ç½‘ç»œå¸§ä¸­æ”¶åˆ°è¿™ä¸ªæ“ä½œï¼Œä»è€Œå°½å¿«çš„å®Œæˆæ˜¾ç¤ºã€‚ç„¶è€Œï¼Œç½‘ç»œå¹¶ä¸æ˜¯é‚£ä¹ˆç¨³å®šï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šå‘ç°ä¸€ä¼šå¿«ä¸€ä¼šæ…¢ï¼Œè¿™æ ·ç©å®¶çš„æ“ä½œä½“éªŒå°±éå¸¸å¥‡æ€ªï¼Œæ— æ³•é¢„æµ‹è¾“å…¥åŠ¨ä½œåï¼Œè§’è‰²ä¼šåœ¨ä»€ä¹ˆæ—¶å€™èµ·ååº”ã€‚è¿™å¯¹äºä¸€äº›è®²æ±‚æ“ä½œå®æ—¶æ€§çš„æ¸¸æˆæ˜¯å¾ˆéº»çƒ¦çš„ã€‚æ¯”å¦‚çƒç±»æ¸¸æˆï¼Œæ§åˆ¶çš„è§’è‰²è·‘çš„ä¸€ä¼šå„¿å¿«ä¸€ä¼šå„¿æ…¢ï¼Œå¾ˆéš¾ç©å¥½â€œå¾®æ“â€ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¸€èˆ¬å¯ä»¥å­¦ä¹ ä¼ è¾“è¯­éŸ³ä¸šåŠ¡çš„åšæ³•ï¼Œå°±æ˜¯æ¥æ”¶ç½‘ç»œæ•°æ®æ—¶ï¼Œä¸ç«‹åˆ»å¤„ç†ï¼Œè€Œæ˜¯ç»™æ‰€æœ‰çš„æ“ä½œå¢åŠ ä¸€ä¸ªå›ºå®šçš„å»¶è¿Ÿï¼Œååœ¨å»¶è¿Ÿçš„æ—¶é—´å†…ï¼Œæœé›†å¤šå‡ ä¸ªç½‘ç»œåŒ…ï¼Œç„¶åæŒ‰å›ºå®šçš„æ—¶é—´å»æ’­æ”¾ï¼ˆè¿ç®—ï¼‰ã€‚è¿™æ ·ç›¸å½“äºåšäº†ä¸€ä¸ªç½‘ç»œå¸§çš„ç¼“å†²åŒºï¼Œç”¨æ¥å¹³æ»‘é‚£äº›ä¸€ä¼šå„¿å¿«ä¸€ä¼šå„¿æ…¢çš„æ•°æ®åŒ…ï¼Œæ”¹æˆåŒ€é€Ÿçš„è¿ç®—ã€‚è¿™ç§åšæ³•ä¼šè®©ç©å®¶æ„Ÿè§‰åˆ°ä¸€ä¸ªå›ºå®šå»¶è¿Ÿï¼šè¾“å…¥æ“ä½œåï¼Œæœ€å°‘è¦éš”ä¸€æ®µæ—¶é—´ï¼Œæ‰ä¼šèµ·ååº”ã€‚ä½†æ˜¯èµ·ç è¿™ä¸ªå»¶è¿Ÿæ˜¯å›ºå®šçš„ï¼Œå¯é¢„è®¡çš„ï¼Œè¿™å¯¹äºæ¸¸æˆæ“ä½œå°±ä¾¿æ·å¾ˆå¤šäº†ï¼Œåªè¦æŒæ¡äº†æå‰é‡ï¼Œè¿™ä¸ªæ“ä½œçš„æ„Ÿè§‰å°±å¥½åƒè§’è‰²æœ‰ä¸€å®šçš„â€œæƒ¯æ€§â€ä¸€æ ·ï¼šæŒ‰ä¸‹è·‘å¹¶ä¸ç«‹åˆ»è·‘ï¼Œæ¾å¼€è·‘ä¸ä¼šç«‹åˆ»åœï¼Œä½†è¿™ä¸ªæƒ¯æ€§çš„æ—¶é—´æ˜¯å›ºå®šçš„ã€‚ é¦–å…ˆï¼Œæ˜¯ç½‘ç»œåè®®çš„é€‰æ‹©ã€‚TCPå’ŒUDPçš„é€‰æ‹©ï¼Œæˆ‘å°±ä¸å¤šè¯´äº†ï¼Œå¸§åŒæ­¥è‚¯å®šè¦åŸºäºUDPæ‰èƒ½ä¿è¯æ›´ä½çš„å»¶è¿Ÿã€‚åœ¨UDPçš„é€‰æ‹©ä¸Šï¼Œæˆ‘çœ‹ç½‘ä¸Šæœ‰äº›æ–‡ç« ï¼Œå®¹æ˜“å¯¼å…¥ä¸€ä¸ªè¯¯åŒºï¼Œå³ï¼Œæˆ‘ä»¬æ˜¯è¦ç”¨å¯é ä¼ è¾“çš„UDPï¼Œè¿˜æ˜¯å†—ä½™ä¿¡æ¯çš„UDPã€‚ åŸºäºå¯é ä¼ è¾“çš„UDPï¼Œæ˜¯æŒ‡åœ¨UDPä¸ŠåŠ ä¸€å±‚å°è£…ï¼Œè‡ªå·±å»å®ç°ä¸¢åŒ…å¤„ç†ï¼Œæ¶ˆæ¯åºåˆ—ï¼Œé‡ä¼ ç­‰ç±»ä¼¼TCPçš„æ¶ˆæ¯å¤„ç†æ–¹å¼ï¼Œä¿è¯ä¸Šå±‚é€»è¾‘åœ¨å¤„ç†æ•°æ®åŒ…çš„æ—¶å€™ï¼Œä¸éœ€è¦è€ƒè™‘åŒ…çš„é¡ºåºï¼Œä¸¢åŒ…ç­‰ã€‚ç±»ä¼¼çš„å®ç°æœ‰Enetï¼ŒKCPç­‰ã€‚ å†—ä½™ä¿¡æ¯çš„UDPï¼Œæ˜¯æŒ‡éœ€è¦ä¸Šå±‚é€»è¾‘è‡ªå·±å¤„ç†ä¸¢åŒ…ï¼Œä¹±åºï¼Œé‡ä¼ ç­‰é—®é¢˜ï¼Œåº•å±‚ç›´æ¥ç”¨åŸå§‹çš„UDPï¼Œæˆ–è€…ç”¨ç±»ä¼¼Enetçš„Unsequencedæ¨¡å¼ã€‚å¸¸è§çš„å¤„ç†æ–¹å¼ï¼Œå°±æ˜¯ä¸¤ç«¯çš„æ¶ˆæ¯é‡Œé¢ï¼Œå¸¦æœ‰ç¡®è®¤å¸§ä¿¡æ¯ï¼Œæ¯”å¦‚å®¢æˆ·ç«¯ï¼ˆCï¼‰é€šçŸ¥æœåŠ¡å™¨ï¼ˆSï¼‰ç¬¬100å¸§çš„æ•°æ®ï¼ŒSæ”¶åˆ°åé€šçŸ¥Cï¼Œå·²æ”¶åˆ°Cçš„ç¬¬100å¸§ï¼Œå¦‚æœCä¸€ç›´æ²¡æ”¶åˆ°Sçš„é€šçŸ¥ï¼ˆä¸¢åŒ…ï¼Œä¹±åºç­‰åŸå› ï¼‰ï¼Œå°±ä¼šç»§ç»­å‘é€ç¬¬100å¸§çš„æ•°æ®ç»™Sï¼Œç›´åˆ°æ”¶åˆ°Sçš„ç¡®è®¤ä¿¡æ¯ã€‚æœ‰äº›æ–‡ç« ä»‹ç»çš„æ—¶å€™ï¼Œæ²¡æœ‰æ˜ç¡®è¿™ä¸¤è€…çš„åŒºåˆ«ï¼Œä½†æ˜¯è¿™ä¸¤ç§æ–¹å¼ï¼ŒåŒºåˆ«æ˜¯å·¨å¤§çš„ã€‚å¯é ä¼ è¾“çš„UDPï¼Œåœ¨å¸§åŒæ­¥ä¸­ï¼Œä¸ªäººè®¤ä¸ºæ˜¯ä¸åˆé€‚çš„ï¼Œå› ä¸ºä»–ä¸ºäº†ä¿è¯åŒ…çš„é¡ºåºå’Œå¤„ç†ä¸¢åŒ…é‡ä¼ ç­‰ï¼Œåœ¨ç½‘ç»œä¸ä½³çš„æƒ…å†µä¸‹ï¼Œdelayå¾ˆå¤§ï¼Œå°†å¯¼è‡´æ”¶å‘åŒ…å¤„ç†éƒ½ä¼šå˜æˆç±»ä¼¼tcpçš„æ•ˆæœï¼Œåªæ˜¯æ¯”TCPä¼šå¥½ä¸€äº›ã€‚å¿…é¡»è¦ç”¨å†—ä½™ä¿¡æ¯çš„UDPçš„æ–¹å¼ï¼Œæ‰èƒ½è·å¾—å¥½çš„æ•ˆæœã€‚å¹¶ä¸”å®ç°å¹¶ä¸å¤æ‚ï¼Œåªè¦å’ŒæœåŠ¡å™¨å•†è®®å¥½ç¡®è®¤å¸§å’Œå¦‚ä½•é‡ä¼ å³å¯ï¼Œè‡ªå·±å®ç°ï¼Œæœ‰å¾ˆå¤§çš„ä¼˜åŒ–ç©ºé—´ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬çš„åè®®å®šä¹‰ç±»ä¼¼å¦‚ä¸‹ï¼š è¿™é‡Œç®€å•è¯´ä¸€ä¸‹ï¼Œå¯¹äºè¿™ç§æ”¶å‘é¢‘ç¹çš„æ¶ˆæ¯ï¼Œå¦‚æœä½¿ç”¨protobufï¼Œä¼šé€ æˆæ¯ä¸ªé€»è¾‘å¸§çš„GCï¼Œè¿™æ˜¯éå¸¸ä¸å¥½çš„ï¼Œè§£å†³æ–¹æ¡ˆï¼Œè¦ä¹ˆå¯¹protobufåšæ— GCæ”¹é€ &gt;ï¼Œè¦ä¹ˆå°±è‡ªå·±å®ç°ä¸€ä¸ªç®€å•çš„byte[]è¯»å†™ã€‚æ— GCæ”¹é€ å·¥ç¨‹å¤ªå¤§ï¼Œæ„Ÿè§‰æ— å¿…è¦ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨æˆ˜æ–—çš„å‡ ä¸ªé¢‘ç¹å‘é€çš„æ¶ˆæ¯ï¼Œéœ€è¦è‡ªå·±å¤„ç†ä¸€ä¸‹byte[]è¯»å†™å³å¯ã€‚ æ­¤å¤„è¡¥å……ä¸€ä¸‹ï¼Œkcp+fecçš„æ¨¡å¼ï¼Œå¯ä»¥æ¯”å†—ä½™æ–¹å¼ï¼Œæœ‰æ›´å¥½çš„æ•ˆæœï¼Œæˆ‘ä¹‹å‰å¹¶æ²¡æœ‰ä»”ç»†ç ”ç©¶è¿‡è¿™ä¸ªæ¨¡å¼ï¼Œä¸è¿‡å¯ä»¥æ¨èå¤§å®¶çœ‹ä¸€ä¸‹ï¼Œå¦‚æœæœ‰ç”¨è¿‡æœ‹å‹åˆ†äº«ä¸‹ç»“è®ºå°±æ›´å¥½äº†ã€‚ å› ä¸ºæˆ‘ä»¬é¡¹ç›®æ—©æœŸï¼ŒæœåŠ¡å™¨å®šä¸‹äº†ä½¿ç”¨enetï¼Œæˆ‘è¯„ä¼°äº†ä¸€ä¸‹ï¼Œåæ­£ä½¿ç”¨å†—ä½™åŒ…çš„æ–¹å¼ï¼Œæ‰€ä»¥æ²¡æœ‰çº ç»“enetæˆ–kcpï¼Œåç»­å…¶å®æƒ³æ”¹æˆkcpï¼ŒæœåŠ¡å™¨ä¸æƒ³å†åŠ¨ï¼Œä¹Ÿå°±æ”¾ä¸‹äº†ã€‚ enetéº»çƒ¦çš„åœ°æ–¹æ˜¯ï¼Œenetçš„ipv6ç‰ˆæœ¬ï¼Œæ˜¯ä¸€ä¸ªä¸æˆç†Ÿçš„pull requestï¼Œenetä½œè€…æ²¡æœ‰mergeï¼ˆå¹¶ä¸”å­˜åœ¨å¥½å‡ ä¸ªipv6çš„pull requestï¼‰ï¼Œæˆ‘ä¸ç¡®å®šç¨³å®šæ€§ï¼Œè¿˜å¥½çœ‹äº†ä¸‹commitï¼ŒåŠ ä¸Šæµ‹è¯•ä¸‹æ¥ï¼Œæ²¡æœ‰å¤ªå¤§é—®é¢˜ã€‚KCPæˆ‘æ²¡æœ‰è¯„ä¼°è¿‡ipv6çš„é—®é¢˜ï¼Œä¸è¿‡githubä¸Šæœ‰C#ç‰ˆæœ¬ï¼Œæ”¹ä¸€ä¸‹ipv6æ”¯æŒåº”è¯¥å¾ˆç®€å•ã€‚ é€»è¾‘å’Œæ˜¾ç¤ºçš„åˆ†ç¦»è¿™å—å¾ˆå¤šè®²å¸§åŒæ­¥çš„æ–‡ç« éƒ½æè¿‡äº†ã€‚æˆ‘åœ¨å‰é¢è®²æŠ€èƒ½ç¼–è¾‘å™¨çš„æ—¶å€™ï¼Œä¹Ÿæè¿‡ï¼Œé…ç½®çš„æ•°æ®å’Œæ˜¾ç¤ºè¦åˆ†ç¦»ï¼Œåœ¨æˆ˜æ–—ä¸­ï¼Œæˆ˜æ–—çš„é€»è¾‘ï¼Œä¹Ÿè¦å’Œæ˜¾ç¤ºåšåˆ°åˆ†ç¦»ã€‚ ä¾‹å¦‚ï¼Œæœ€åŸºæœ¬ï¼Œæˆ‘ä»¬åŠ¨ä½œåˆ‡æ¢çš„é€»è¾‘ï¼Œæ˜¯åŸºäºè‡ªå·±æŠ½è±¡çš„é€»è¾‘å¸§ï¼Œè€Œä¸æ˜¯åŸºäºanimatorä¸­ä¸€ä¸ªclipçš„æ’­æ”¾ã€‚æ¯”å¦‚ä¸€ä¸ªæ”»å‡»åŠ¨ä½œï¼Œå½“ç¬¬10å¸§çš„æ—¶å€™ï¼Œå¼€å§‹å‡ºç°æ”»å‡»æ¡†ï¼Œå¹¶å¼€å§‹æ£€æµ‹å’Œæ•Œäººå—å‡»æ¡†çš„ç¢°æ’ï¼Œè¿™ä¸ªæ—¶å€™çš„ç¬¬10å¸§ï¼Œå¿…é¡»æ˜¯ç‹¬ç«‹çš„é€»è¾‘ï¼Œä¸èƒ½ä¾èµ–äºanimatoræ’­æ”¾çš„æ—¶é—´ï¼Œæˆ–è€…AnimatorStateInfoçš„normalizedTimeç­‰ã€‚ç”šè‡³ï¼Œå½“æˆ‘ä»¬ä¸åŠ è½½è§’è‰²çš„æ¨¡å‹ï¼Œä¸€æ ·å¯ä»¥è·‘æˆ˜æ–—çš„é€»è¾‘ã€‚å¦‚æœæŠ½ç¦»å¾—å¥½ï¼Œè¿˜å¯ä»¥æ”¾åˆ°æœåŠ¡å™¨è·‘ï¼Œåšä¸ºæˆ˜æ–—çš„éªŒè¯ç¨‹åºï¼Œç‹è€…è£è€€å°±æ˜¯è¿™æ ·åšçš„ã€‚ è”æœºå¦‚ä½•åšåˆ°æµç•…æˆ˜æ–—å‰é¢æ‰€æœ‰çš„å‡†å¤‡ï¼Œæœ€ç»ˆçš„ç›®çš„ï¼Œéƒ½æ˜¯ä¸ºäº†æˆ˜æ–—çš„æµç•…ã€‚ç‰¹åˆ«æ˜¯æˆ‘ä»¬è¿™ç§Actæ¸¸æˆï¼Œæˆ–è€…æ ¼æ–—ç±»æ¸¸æˆï¼Œå¯¹æŒ‰é”®ä»¥åæ“ä½œåé¦ˆçš„å³æ—¶æ€§ï¼Œè¦æ±‚éå¸¸é«˜ï¼Œä¸€ç‚¹ç‚¹å»¶è¿Ÿï¼Œéƒ½ä¼šå½±å“ç©å®¶çš„æ‰‹æ„Ÿï¼Œå¯¼è‡´ç©å®¶çš„è¿æ‹›æ“ä½œæ‰“æ–­ï¼Œéå¸¸å½±å“ä½“éªŒã€‚æˆ‘ä»¬å¯¹å»¶è¿Ÿçš„æ•æ„Ÿæ€§ï¼Œç”šè‡³æ¯”MOBAç±»æ¸¸æˆè¿˜è¦é«˜ï¼Œæˆ‘ä»¬è¦åšåˆ°å¥½çš„æ“ä½œæ‰‹æ„Ÿï¼Œè¿˜è¦è”æœºæˆ˜æ–—ï¼ˆPVPï¼Œç»„é˜ŸPVEï¼‰ï¼Œéƒ½éœ€è¦æŠŠå¸§åŒæ­¥åšåˆ°æè‡´ï¼Œä¸èƒ½å› ä¸ºå»¶è¿Ÿå¡ä½æˆ–è€…æ“ä½œåé¦ˆå‡ºç°å˜åŒ–ã€‚ æˆ‘ä»¬ä¹Ÿä¸èƒ½ç”¨ç¼“å­˜æœåŠ¡å™¨ç¡®è®¤æ“ä½œçš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ä¸€äº›æ¸¸æˆåšçš„æŒ‡ä»¤bufferã€‚å…·ä½“æè¿°ï¼Œç‹è€…è£è€€çš„åˆ†ææ–‡ç« ï¼Œè®²å¾—å¾ˆå…·ä½“äº†ã€‚è¿™ä¹Ÿæ˜¯ä»–ä»¬è¯´çš„æ¨¡å¼ï¼Œè¿™ä¸ªæ¨¡å¼èƒ½è§£å†³ä¸€äº›å°çš„ç½‘ç»œæ³¢åŠ¨ï¼Œå¯¹ä¸€äº›æ“ä½œåé¦ˆä¸éœ€è¦å¤ªé«˜çš„æ¸¸æˆï¼Œä¾‹å¦‚æœ‰äº›æ¸¸æˆæ”»å‡»å‰ä¼šæœ‰ä¸€ä¸ªæ¯”è¾ƒé•¿çš„å‰æ‘‡åŠ¨ä½œï¼Œè¿™ç±»æ¸¸æˆï¼Œç”¨è¿™ç§æ–¹å¼ï¼Œåº”è¯¥å°±èƒ½è§£å†³å¤§éƒ¨åˆ†é—®é¢˜ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼è¿˜æ˜¯å­˜åœ¨éšæ‚£ï¼Œå³ä½¿é€šè¿‡ç­–ç•¥èƒ½å¾ˆå¥½åœ°åŠ¨æ€è°ƒæ•´bufferï¼Œä¹Ÿè¿˜æ˜¯éš¾ä»¥è§£å†³é«˜å»¶è¿Ÿä¸‹çš„å¡é¡¿å’Œä¸æµç•…ã€‚ç‹è€…è£è€€ä¼˜åŒ–å¾—å¾ˆå¥½ï¼Œä»–ä»¬è¯´èƒ½è®©bufferé•¿åº¦ä¸º0ï¼Œæ–‡ç« åªæåˆ°é€šè¿‡å¹³æ»‘æ’å€¼å’Œé€»è¾‘è¡¨ç°åˆ†ç¦»æ¥ä¼˜åŒ–ï¼Œæ›´ç»†èŠ‚çš„æ²¡æœ‰æåˆ°ï¼Œæˆ‘ä¸ç¡®å®šä»–ä»¬æ˜¯å¦åªæ˜¯åŸºäºè¿™ä¸ªæ–¹å¼æ¥ä¼˜åŒ–çš„ã€‚ç›®å‰ä¹Ÿæ²¡æœ‰çœ‹åˆ°æ›´å…·ä½“çš„åˆ†æã€‚ æŒ‡ä»¤bufferçš„æ–¹å¼ï¼Œä¹Ÿä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œæˆ–è€…è¯´ï¼Œæˆ‘æ²¡æœ‰æ‰¾åˆ°åŸºäºæ­¤æ–¹å¼ï¼Œèƒ½ä¼˜åŒ–åˆ°ç‹è€…è£è€€çš„æ•ˆæœçš„åŠæ³•ã€‚æˆ‘ä¹Ÿæµ‹è¯•è¿‡å…¶ä»–mobaå’Œactï¼Œarpgç±»æ¸¸æˆçš„è”æœºï¼Œåœ¨é«˜å»¶è¿Ÿï¼Œç½‘ç»œæ³¢åŠ¨æƒ…å†µä¸‹ï¼Œæ²¡æœ‰æ¯”ç‹è€…è¡¨ç°æ›´å¥½çš„äº†ã€‚ æœ€åï¼Œåœ¨ä»”ç»†ç ”ç©¶äº†æˆ‘ä»¬çš„éœ€æ±‚åï¼Œæ‰¾åˆ°ä¸€ç¯‡æŒ‡å¯¼æ€§çš„æ–‡ç« ï¼Œéå¸¸é€‚åˆæˆ‘ä»¬ã€‚]]></content>
      <tags>
        <tag>Server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[3dmaxåˆ©ç”¨è§†å£ç”»å¸ƒåœ¨çª—å£ä¸­ç»˜åˆ¶è´´å›¾]]></title>
    <url>%2F2019%2F04%2F21%2Fdraw-texture%2F</url>
    <content type="text"><![CDATA[æ‰“å¼€åœºæ™¯æ–‡ä»¶åœºæ™¯ä¸­åˆ›å»ºäº†5ä¸ªçƒä½“ã€‚å•æœºæ‰“å¼€æè´¨ç¼–è¾‘å™¨ï¼Œå•æœºä¸€ä¸ªæè´¨çƒï¼Œå°†æè´¨åç§°æˆ‘ä»¬å‘½åä¸ºé»„è‰²ï¼Œç„¶åå°†å®ƒçš„æè´¨ç±»å‹è®¾ç½®ä¸ºVRæè´¨å•æœºæ¼«åå°„åé¢çš„é€šé“ï¼Œæ·»åŠ ä¸€å¼ é»„è‰²çš„è´´å›¾ï¼ˆé€‰æ‹©ä½å›¾å¯ä»¥è‡ªå®šä¹‰ï¼‰ï¼Œé€‰æ‹©è´´å›¾ï¼Œå•æœºæ‰“å¼€æ·»åŠ å®Œæˆï¼Œéœ€è¦è®¾ç½®ä¸‹é¢çš„å‚æ•°å•å‡»è½¬åˆ°çˆ¶å¯¹è±¡ï¼Œè®¾ç½®ä¸€ä¸‹å®ƒçš„åå°„é¢œè‰²ä¸ºç™½è‰²ï¼Œå¹¶ä¸”è¦å‹¾é€‰è²æ¶…å°”åå°„ï¼Œè®¾ç½®ç»†åˆ†çš„æ•°å€¼ä¸º20ã€‚å¯ä»¥æ‰“å¼€å®ƒçš„èƒŒæ™¯æ˜¾ç¤ºã€‚å‡å¦‚æ¸²æŸ“çš„æ›´åŠ æ¸…æ™°ä¸€ç‚¹ï¼Œå¯ä»¥è®¾ç½®ä¸€ä¸‹æ¨¡ç³Šä¸º0.01ã€‚è¿™æ ·é»„è‰²æè´¨å°±åˆ¶ä½œå®Œæˆäº†ï¼Œç„¶åå¯ä»¥åˆ¶ä½œä¸‹ä¸€ä¸ªæè´¨ï¼Œè“è‰²æè´¨ã€‚ä¸ºäº†æ“ä½œæ–¹ä¾¿ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†å®ƒæ‹–åŠ¨å¤åˆ¶ï¼Œå¹¶å°†å®ƒå‘½åä¸ºè“è‰²ã€‚æˆ‘ä»¬éœ€è¦åœ¨èœå•ä¸­è¿›è¡Œå·¥å…·ï¼Œéœ€è¦å°†è§†å£ç”»å¸ƒçš„å·¥å…·æ‰¾åˆ°ã€‚é€‰æ‹©è§†å£ç”»å¸ƒï¼Œå¹¶å•å‡»ã€‚æ­¤æ—¶ä¼šå•å‡»è¿™æ ·ä¸€ä¸ªå¯¹è¯æ¡†ã€‚ ç„¶åçœ‹åˆ°æœ‰è¿™æ ·ä¸€äº›ç”»ç¬”å¯ä»¥è¿›è¡Œè®¾ç½®ã€‚é€‰æ‹©ä¸€ä¸ªé»„è‰²çš„çƒä½“ï¼Œæ¥ç€å•å‡»ç»˜åˆ¶æŒ‰é’®ã€‚æ­¤æ—¶å¼¹å‡ºè¿™æ ·ä¸€ä¸ªå¯¹è¯æ¡†ã€‚é€‰æ‹©ç¬¬ä¸€é¡¹æ¼«åå°„-è´´å›¾ï¼Œé€‰æ‹©å®Œæˆï¼Œæ­¤æ—¶å¼¹å‡ºå±‚çš„å¯¹è¯æ¡†ï¼Œåœ¨è¿™ä¸ªå¯¹è¯æ¡†å¯ä»¥å•å‡»æ·»åŠ æ–°å±‚çš„æŒ‰é’®ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åé¢ç»˜åˆ¶çš„è´´å›¾éƒ½ä¼šå‘ˆç°åœ¨æ–°å±‚ä¸Šé¢è¿™ä¸ªæ—¶å€™è®¾ç½®ä¸€ä¸‹ç”»ç¬”åŸºæœ¬çš„å‚æ•°ã€‚é¦–å…ˆè®¾ç½®å®ƒçš„é¢œè‰²ä¸ºé»‘è‰²ï¼ŒåŠå¾„æ•°å€¼è®¾ç½®ä¸º10ï¼Œè®¾ç½®ç¡¬åº¦è®¾ç½®ä¸º25å·¦å³ï¼Œè®¾ç½®å®Œæˆã€‚æœ€åå¯ä»¥å–æ¶ˆä½¿ç”¨é€‰é¡¹ã€‚å¹¶ä¸”è®¾ç½®å®ƒçš„é®ç½©ã€‚åœ¨è¿™é‡Œå¯ä»¥å•å‡»é€‰æ‹©å®ƒçš„é®ç½©ï¼Œæˆ‘ä»¬é€‰æ‹©ç¬¬ä¸‰ä¸ªã€‚è®¾ç½®å®Œæˆï¼Œç„¶ååœ¨è¯¥çƒä½“ä¸Šå•å‡»é¼ æ ‡å·¦é”®å°±å¯ä»¥è¿›è¡Œç»˜åˆ¶äº†å½“ç„¶æˆ‘ä»¬ç°åœ¨æ˜¯ç”¨é¼ æ ‡è¿›è¡Œç»˜åˆ¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æ‰‹å†™æ¿è¿›è¡Œç»˜åˆ¶ã€‚è®¾ç½®æˆ‘ä»¬åœ¨ç»˜åˆ¶è¿›è¡Œä¸­ä¹Ÿå¯ä»¥è°ƒæ•´ã€‚è¿™æ ·å°±åˆ¶ä½œå®Œæˆã€‚å½“ç„¶ä¹Ÿå¯ä»¥æ›´æ¢å®ƒçš„é®ç½©ç­‰é€‰é¡¹ï¼Œè¿™ä¸ªç»˜åˆ¶å®Œæˆä»¥åã€‚è¿™æ—¶å€™å¯ä»¥å•å‡»é€‰æ‹©å¹¶ç§»åŠ¨å·¥å…·ã€‚è¿™æ ·ä¼šå¼¹å‡ºä¿å­˜çº¹ç†å±‚çš„å¯¹è¯æ¡†ã€‚è¿™æ—¶å€™å¯ä»¥å•å‡»å¦å­˜ä¸ºPSDæ–‡ä»¶ï¼Œå¹¶ä¸”å°†å®ƒè¿›è¡Œä¿å­˜ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä¿å­˜ä¸ºé»„è‰².psdå°±å¯ä»¥äº†ã€‚åŒæ ·çš„æ–¹æ³•æˆ‘ä»¬å¯ä»¥å°†å¦å¤–çš„å››ä¸ªçƒä½“ç»˜åˆ¶å‡ºæ¥ã€‚æ–¹æ³•æ˜¯ä¸€æ ·çš„ã€‚éƒ½ç»˜åˆ¶å®Œæˆä»¥åï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æ­¤æ—¶çš„ç»˜åˆ¶æ•ˆæœã€‚æˆ‘ä»¬çœ‹åˆ°å·²ç»å‡ºç°5ä¸ªå¡é€šçš„çƒä½“ã€‚]]></content>
      <categories>
        <category>3DMax</category>
      </categories>
      <tags>
        <tag>3DMax</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[flash-effect]]></title>
    <url>%2F2019%2F04%2F17%2Fflash-effect%2F</url>
    <content type="text"></content>
  </entry>
  <entry>
    <title><![CDATA[ç‰¹æ€§ï¼ˆAttributeï¼‰]]></title>
    <url>%2F2019%2F04%2F17%2Fattribute%2F</url>
    <content type="text"><![CDATA[ç‰¹æ€§ï¼ˆAttributeï¼‰æ˜¯ç”¨äºåœ¨è¿è¡Œæ—¶ä¼ é€’ç¨‹åºä¸­å„ç§å…ƒç´ ï¼ˆæ¯”å¦‚ç±»ã€æ–¹æ³•ã€ç»“æ„ã€æšä¸¾ã€ç»„ä»¶ç­‰ï¼‰çš„è¡Œä¸ºä¿¡æ¯çš„å£°æ˜æ€§æ ‡ç­¾ã€‚å¯ä»¥é€šè¿‡ä½¿ç”¨ç‰¹æ€§å‘ç¨‹åºæ·»åŠ å£°æ˜æ€§ä¿¡æ¯ã€‚ä¸€ä¸ªå£°æ˜æ€§æ ‡ç­¾æ˜¯é€šè¿‡æ”¾ç½®åœ¨å®ƒæ‰€åº”ç”¨çš„å…ƒç´ å‰é¢çš„æ–¹æ‹¬å·ï¼ˆ[ ]ï¼‰æ¥æè¿°çš„ã€‚ ç‰¹æ€§ï¼ˆAttributeï¼‰ç”¨äºæ·»åŠ å…ƒæ•°æ®ï¼Œå¦‚ç¼–è¯‘å™¨æŒ‡ä»¤å’Œæ³¨é‡Šã€æè¿°ã€æ–¹æ³•ã€ç±»ç­‰å…¶ä»–ä¿¡æ¯ã€‚.Net æ¡†æ¶æä¾›äº†ä¸¤ç§ç±»å‹çš„ç‰¹æ€§ï¼šé¢„å®šä¹‰ç‰¹æ€§å’Œè‡ªå®šä¹‰ç‰¹æ€§ã€‚ è§„å®šç‰¹æ€§ï¼ˆAttributeï¼‰è§„å®šç‰¹æ€§ï¼ˆAttributeï¼‰çš„è¯­æ³•å¦‚ä¸‹ï¼š12[attribute(positional_parameters, name_parameter = value, ...)]element ç‰¹æ€§ï¼ˆAttributeï¼‰çš„åç§°å’Œå€¼æ˜¯åœ¨æ–¹æ‹¬å·å†…è§„å®šçš„ï¼Œæ”¾ç½®åœ¨å®ƒæ‰€åº”ç”¨çš„å…ƒç´ ä¹‹å‰ã€‚positional_parameters è§„å®šå¿…éœ€çš„ä¿¡æ¯ï¼Œname_parameter è§„å®šå¯é€‰çš„ä¿¡æ¯ã€‚ é¢„å®šä¹‰ç‰¹æ€§ï¼ˆAttributeï¼‰.Net æ¡†æ¶æä¾›äº†ä¸‰ç§é¢„å®šä¹‰ç‰¹æ€§ï¼š AttributeUsage Conditional Obsolete AttributeUsageé¢„å®šä¹‰ç‰¹æ€§ AttributeUsage æè¿°äº†å¦‚ä½•ä½¿ç”¨ä¸€ä¸ªè‡ªå®šä¹‰ç‰¹æ€§ç±»ã€‚å®ƒè§„å®šäº†ç‰¹æ€§å¯åº”ç”¨åˆ°çš„é¡¹ç›®çš„ç±»å‹ã€‚ è§„å®šè¯¥ç‰¹æ€§çš„è¯­æ³•å¦‚ä¸‹ï¼š12345[AttributeUsage( validon, AllowMultiple=allowmultiple, Inherited=inherited)] å…¶ä¸­ï¼š å‚æ•° validon è§„å®šç‰¹æ€§å¯è¢«æ”¾ç½®çš„è¯­è¨€å…ƒç´ ã€‚å®ƒæ˜¯æšä¸¾å™¨ AttributeTargets çš„å€¼çš„ç»„åˆã€‚é»˜è®¤å€¼æ˜¯ AttributeTargets.Allã€‚ å‚æ•° allowmultipleï¼ˆå¯é€‰çš„ï¼‰ä¸ºè¯¥ç‰¹æ€§çš„ AllowMultiple å±æ€§ï¼ˆpropertyï¼‰æä¾›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚å¦‚æœä¸º trueï¼Œåˆ™è¯¥ç‰¹æ€§æ˜¯å¤šç”¨çš„ã€‚é»˜è®¤å€¼æ˜¯ falseï¼ˆå•ç”¨çš„ï¼‰ã€‚ å‚æ•° inheritedï¼ˆå¯é€‰çš„ï¼‰ä¸ºè¯¥ç‰¹æ€§çš„ Inherited å±æ€§ï¼ˆpropertyï¼‰æä¾›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚å¦‚æœä¸º trueï¼Œåˆ™è¯¥ç‰¹æ€§å¯è¢«æ´¾ç”Ÿç±»ç»§æ‰¿ã€‚é»˜è®¤å€¼æ˜¯ falseï¼ˆä¸è¢«ç»§æ‰¿ï¼‰ã€‚ ä¾‹å¦‚ï¼š123456[AttributeUsage(AttributeTargets.Class |AttributeTargets.Constructor |AttributeTargets.Field |AttributeTargets.Method |AttributeTargets.Property, AllowMultiple = true)] Conditionalè¿™ä¸ªé¢„å®šä¹‰ç‰¹æ€§æ ‡è®°äº†ä¸€ä¸ªæ¡ä»¶æ–¹æ³•ï¼Œå…¶æ‰§è¡Œä¾èµ–äºæŒ‡å®šçš„é¢„å¤„ç†æ ‡è¯†ç¬¦ã€‚ å®ƒä¼šå¼•èµ·æ–¹æ³•è°ƒç”¨çš„æ¡ä»¶ç¼–è¯‘ï¼Œå–å†³äºæŒ‡å®šçš„å€¼ï¼Œæ¯”å¦‚ Debug æˆ– Traceã€‚ä¾‹å¦‚ï¼Œå½“è°ƒè¯•ä»£ç æ—¶æ˜¾ç¤ºå˜é‡çš„å€¼ã€‚ è§„å®šè¯¥ç‰¹æ€§çš„è¯­æ³•å¦‚ä¸‹ï¼š123[Conditional( conditionalSymbol)] Obsoleteè¿™ä¸ªé¢„å®šä¹‰ç‰¹æ€§æ ‡è®°äº†ä¸åº”è¢«ä½¿ç”¨çš„ç¨‹åºå®ä½“ã€‚å®ƒå¯ä»¥è®©æ‚¨é€šçŸ¥ç¼–è¯‘å™¨ä¸¢å¼ƒæŸä¸ªç‰¹å®šçš„ç›®æ ‡å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªæ–°æ–¹æ³•è¢«ç”¨åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œä½†æ˜¯æ‚¨ä»ç„¶æƒ³è¦ä¿æŒç±»ä¸­çš„æ—§æ–¹æ³•ï¼Œæ‚¨å¯ä»¥é€šè¿‡æ˜¾ç¤ºä¸€ä¸ªåº”è¯¥ä½¿ç”¨æ–°æ–¹æ³•ï¼Œè€Œä¸æ˜¯æ—§æ–¹æ³•çš„æ¶ˆæ¯ï¼Œæ¥æŠŠå®ƒæ ‡è®°ä¸º obsoleteï¼ˆè¿‡æ—¶çš„ï¼‰ã€‚ è§„å®šè¯¥ç‰¹æ€§çš„è¯­æ³•å¦‚ä¸‹ï¼š1234[Obsolete( message)][Obsolete( message, iserror)] å…¶ä¸­ï¼š å‚æ•° messageï¼Œæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæè¿°é¡¹ç›®ä¸ºä»€ä¹ˆè¿‡æ—¶çš„åŸå› ä»¥åŠè¯¥æ›¿ä»£ä½¿ç”¨ä»€ä¹ˆã€‚ å‚æ•° iserrorï¼Œæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ã€‚å¦‚æœè¯¥å€¼ä¸º trueï¼Œç¼–è¯‘å™¨åº”æŠŠè¯¥é¡¹ç›®çš„ä½¿ç”¨å½“ä½œä¸€ä¸ªé”™è¯¯ã€‚é»˜è®¤å€¼æ˜¯ falseï¼ˆç¼–è¯‘å™¨ç”Ÿæˆä¸€ä¸ªè­¦å‘Šï¼‰ã€‚ åˆ›å»ºè‡ªå®šä¹‰ç‰¹æ€§ï¼ˆAttributeï¼‰.Net æ¡†æ¶å…è®¸åˆ›å»ºè‡ªå®šä¹‰ç‰¹æ€§ï¼Œç”¨äºå­˜å‚¨å£°æ˜æ€§çš„ä¿¡æ¯ï¼Œä¸”å¯åœ¨è¿è¡Œæ—¶è¢«æ£€ç´¢ã€‚è¯¥ä¿¡æ¯æ ¹æ®è®¾è®¡æ ‡å‡†å’Œåº”ç”¨ç¨‹åºéœ€è¦ï¼Œå¯ä¸ä»»ä½•ç›®æ ‡å…ƒç´ ç›¸å…³ã€‚åˆ›å»ºå¹¶ä½¿ç”¨è‡ªå®šä¹‰ç‰¹æ€§åŒ…å«å››ä¸ªæ­¥éª¤ï¼š å£°æ˜è‡ªå®šä¹‰ç‰¹æ€§ æ„å»ºè‡ªå®šä¹‰ç‰¹æ€§ åœ¨ç›®æ ‡ç¨‹åºå…ƒç´ ä¸Šåº”ç”¨è‡ªå®šä¹‰ç‰¹æ€§ é€šè¿‡åå°„è®¿é—®ç‰¹æ€§ æœ€åä¸€ä¸ªæ­¥éª¤åŒ…å«ç¼–å†™ä¸€ä¸ªç®€å•çš„ç¨‹åºæ¥è¯»å–å…ƒæ•°æ®ä»¥ä¾¿æŸ¥æ‰¾å„ç§ç¬¦å·ã€‚å…ƒæ•°æ®æ˜¯ç”¨äºæè¿°å…¶ä»–æ•°æ®çš„æ•°æ®å’Œä¿¡æ¯ã€‚è¯¥ç¨‹åºåº”ä½¿ç”¨åå°„æ¥åœ¨è¿è¡Œæ—¶è®¿é—®ç‰¹æ€§ã€‚ å£°æ˜è‡ªå®šä¹‰ç‰¹æ€§ä¸€ä¸ªæ–°çš„è‡ªå®šä¹‰ç‰¹æ€§åº”æ´¾ç”Ÿè‡ª System.Attribute ç±»ã€‚ä¾‹å¦‚ï¼š123456789// ä¸€ä¸ªè‡ªå®šä¹‰ç‰¹æ€§ BugFix è¢«èµ‹ç»™ç±»åŠå…¶æˆå‘˜[AttributeUsage(AttributeTargets.Class |AttributeTargets.Constructor |AttributeTargets.Field |AttributeTargets.Method |AttributeTargets.Property,AllowMultiple = true)]public class DeBugInfo : System.Attribute åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å·²ç»å£°æ˜äº†ä¸€ä¸ªåä¸º DeBugInfo çš„è‡ªå®šä¹‰ç‰¹æ€§ã€‚ æ„å»ºè‡ªå®šä¹‰ç‰¹æ€§è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªåä¸º DeBugInfo çš„è‡ªå®šä¹‰ç‰¹æ€§ï¼Œè¯¥ç‰¹æ€§å°†å­˜å‚¨è°ƒè¯•ç¨‹åºè·å¾—çš„ä¿¡æ¯ã€‚å®ƒå­˜å‚¨ä¸‹é¢çš„ä¿¡æ¯ï¼š bug çš„ä»£ç ç¼–å· è¾¨è®¤è¯¥ bug çš„å¼€å‘äººå‘˜åå­— æœ€åä¸€æ¬¡å®¡æŸ¥è¯¥ä»£ç çš„æ—¥æœŸ ä¸€ä¸ªå­˜å‚¨äº†å¼€å‘äººå‘˜æ ‡è®°çš„å­—ç¬¦ä¸²æ¶ˆæ¯ æˆ‘ä»¬çš„ DeBugInfo ç±»å°†å¸¦æœ‰ä¸‰ä¸ªç”¨äºå­˜å‚¨å‰ä¸‰ä¸ªä¿¡æ¯çš„ç§æœ‰å±æ€§ï¼ˆpropertyï¼‰å’Œä¸€ä¸ªç”¨äºå­˜å‚¨æ¶ˆæ¯çš„å…¬æœ‰å±æ€§ï¼ˆpropertyï¼‰ã€‚æ‰€ä»¥ bug ç¼–å·ã€å¼€å‘äººå‘˜åå­—å’Œå®¡æŸ¥æ—¥æœŸå°†æ˜¯ DeBugInfo ç±»çš„å¿…éœ€çš„å®šä½ï¼ˆ positionalï¼‰å‚æ•°ï¼Œæ¶ˆæ¯å°†æ˜¯ä¸€ä¸ªå¯é€‰çš„å‘½åï¼ˆnamedï¼‰å‚æ•°ã€‚ æ¯ä¸ªç‰¹æ€§å¿…é¡»è‡³å°‘æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚å¿…éœ€çš„å®šä½ï¼ˆ positionalï¼‰å‚æ•°åº”é€šè¿‡æ„é€ å‡½æ•°ä¼ é€’ã€‚ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº† DeBugInfo ç±»ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657using System;using System.Reflection;// ä¸€ä¸ªè‡ªå®šä¹‰ç‰¹æ€§ BugFix è¢«èµ‹ç»™ç±»åŠå…¶æˆå‘˜[AttributeUsage(AttributeTargets.Class |AttributeTargets.Constructor |AttributeTargets.Field |AttributeTargets.Method |AttributeTargets.Property,AllowMultiple = true)]public class DeBugInfo : Attribute&#123; private int bugNo; private string developer; private string lastReview; public string message; public DeBugInfo(int bg, string dev, string d) &#123; bugNo = bg; developer = dev; lastReview = d; &#125; public int BugNo &#123; get &#123; return bugNo; &#125; &#125; public string Developer &#123; get &#123; return developer; &#125; &#125; public string LastReview &#123; get &#123; return lastReview; &#125; &#125; public string Message &#123; get &#123; return message; &#125; set &#123; message = value; &#125; &#125;&#125; åº”ç”¨è‡ªå®šä¹‰ç‰¹æ€§é€šè¿‡æŠŠç‰¹æ€§æ”¾ç½®åœ¨ç´§æ¥ç€å®ƒçš„ç›®æ ‡ä¹‹å‰ï¼Œæ¥åº”ç”¨è¯¥ç‰¹æ€§ï¼š1234567891011121314151617181920212223242526[DeBugInfo(45, "Zara Ali", "12/8/2012", Message = "Return type mismatch")][DeBugInfo(49, "Nuha Ali", "10/10/2012", Message = "Unused variable")]class Rectangle&#123; // æˆå‘˜å˜é‡ protected double length; protected double width; public Rectangle(double l, double w) &#123; length = l; width = w; &#125; [DeBugInfo(55, "Zara Ali", "19/10/2012", Message = "Return type mismatch")] public double GetArea() &#123; return length * width; &#125; [DeBugInfo(56, "Zara Ali", "19/10/2012")] public void Display() &#123; Console.WriteLine("Length: &#123;0&#125;", length); Console.WriteLine("Width: &#123;0&#125;", width); Console.WriteLine("Area: &#123;0&#125;", GetArea()); &#125;&#125; é€šè¿‡åå°„è®¿é—®ç‰¹æ€§æ³¨æ„ï¼šåªæœ‰åœ¨è°ƒç”¨GetCustomAttributesæ‰å¼€å§‹åˆ›å»ºç‰¹æ€§å®ä¾‹ã€‚123456789101112131415161718192021222324252627282930313233343536373839class ExecuteRectangle&#123; static void Main(string[] args) &#123; Rectangle r = new Rectangle(4.5, 7.5); r.Display(); Type type = typeof(Rectangle); foreach (Object attributes in type.GetCustomAttributes(false)) &#123; DeBugInfo dbi = (DeBugInfo)attributes; if (null != dbi) &#123; Console.WriteLine("Bug no: &#123;0&#125;", dbi.BugNo); Console.WriteLine("Developer: &#123;0&#125;", dbi.Developer); Console.WriteLine("Last Reviewed: &#123;0&#125;", dbi.LastReview); Console.WriteLine("Remarks: &#123;0&#125;", dbi.Message); &#125; &#125; foreach (MethodInfo m in type.GetMethods()) &#123; foreach (Attribute a in m.GetCustomAttributes(true)) &#123; if (a is DeBugInfo) &#123; DeBugInfo dbi = (DeBugInfo)a; if (null != dbi) &#123; Console.WriteLine("Bug no: &#123;0&#125;, for Method: &#123;1&#125;", dbi.BugNo, m.Name); Console.WriteLine("Developer: &#123;0&#125;", dbi.Developer); Console.WriteLine("Last Reviewed: &#123;0&#125;", dbi.LastReview); Console.WriteLine("Remarks: &#123;0&#125;", dbi.Message); &#125; &#125; &#125; &#125; Console.ReadLine(); &#125;&#125;]]></content>
      <tags>
        <tag>CSharp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[houdini]]></title>
    <url>%2F2019%2F04%2F14%2Fhoudini%2F</url>
    <content type="text"><![CDATA[entagmaå…è´¹çš„æ•™ç¨‹éƒ½æ˜¯æ•™åŸºç¡€çš„ ç¨‹åºåŒ–ç”Ÿæˆæ ‘ master classå…¨é›† https://cgpersia.com https://www.anastasiaopara.com/houdini-hive-siggraph-17 http://www.tokeru.com/cgwiki/index.php?title=Main_Page# https://www.bilibili.com/video/av29099924 å¾ˆæ¸£]]></content>
      <categories>
        <category>Houdini</category>
      </categories>
      <tags>
        <tag>Houdini</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é®æŒ¡æ˜¾ç¤º]]></title>
    <url>%2F2019%2F04%2F13%2Fshader-xray%2F</url>
    <content type="text"><![CDATA[3Dæ¸¸æˆä¸­ä¸»è§’ä¼šç»å¸¸è¢«å¢™å£ä¹‹å†…çš„ä¸œè¥¿æŒ¡ä½ï¼Œæ­¤æ—¶ä¸ºäº†è¾¾åˆ°çªå‡ºä¸»è§’çš„æ•ˆæœï¼Œä¼šåšä¸€äº›ç‰¹æ®Šå¤„ç†è®©ä¸»è§’æ˜¾ç¤ºå‡ºæ¥ã€‚å…‰æ …åŒ–é˜¶æ®µçš„åæœŸï¼Œä¼šæœ‰ä¸€ä¸ªæ·±åº¦æµ‹è¯•å’Œé¢œè‰²æ··åˆçš„è¿‡ç¨‹ï¼Œæ­¤æ•ˆæœå°±æ˜¯é’ˆå¯¹è¿™ä¸ªè¿‡ç¨‹è¿›è¡Œçš„ä¸€ç§ç‰¹æ®Šå¤„ç†ã€‚ æ·±åº¦å°±æ˜¯è¯¥åƒç´ ç‚¹åœ¨3Dä¸–ç•Œä¸­è·ç¦»æ‘„åƒæœºçš„è·ç¦»ï¼Œç¦»æ‘„åƒæœºè¶Šè¿‘ï¼Œæ·±åº¦å€¼è¶Šå°ã€‚ æ·±åº¦æµ‹è¯•ï¼šåœ¨å±å¹•ä¸Šæ¯ä¸€ä¸ªç‚¹ï¼Œéƒ½å­˜æ”¾åœ¨ä¸€ä¸ªç¼“å­˜åˆ—è¡¨ã€‚å¦‚æœå¯ç”¨æ·±åº¦ç¼“å­˜Zwrite Onï¼Œé‚£ä¹ˆåœ¨ç»˜åˆ¶æ¯ä¸ªåƒç´ é’±ï¼Œåº•å±‚ä¼šå°†å½“å‰ç‚¹çš„æ·±åº¦å€¼å’Œå·²ç»å­˜å‚¨åœ¨è¿™ä¸ªä½ç½®çš„ç‚¹çš„æ·±åº¦å€¼è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ–°çš„ç‚¹çš„æ·±åº¦å€¼å°äºåŸæ¥ç‚¹çš„æ·±åº¦å€¼ï¼Œåˆ™æ–°çš„ç‚¹ä¼šä»£æ›¿åŸæ¥çš„ç‚¹ã€‚åä¹‹æ–°çš„ç‚¹ä¼šè¢«é®æŒ¡ï¼Œå…¶é¢œè‰²å€¼å’Œæ·±åº¦å€¼ä¼šè¢«ä¸¢å¼ƒã€‚ å®ç°æ­¥éª¤ï¼š å®šä¹‰äº†2ä¸ªpassï¼Œä¸€ä¸ªè¾“å‡ºçº¯è‰²ï¼Œä¸€ä¸ªè¾“å‡ºæ¨¡å‹è‰² å½“å¯¹è±¡æ²¡æœ‰è¢«é®æŒ¡æ˜¯ï¼Œå…ˆæ‰§è¡Œçš„çº¯è‰²passè¾“å‡ºäº†çº¯è‰²ï¼Œç„¶åæ¨¡å‹çš„passè¾“å‡ºäº†æ¨¡å‹è‰²ï¼Œæœ€ç»ˆçº¯è‰²è¢«æ›¿æ¢æ˜¾ç¤ºæ­£å¸¸æ¨¡å‹ã€‚ å½“å¯¹è±¡è¢«å¢™å£æŒ¡ä½æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä»€ä¹ˆä¹Ÿä¸åšï¼Œçº¯è‰²passè¾“å‡ºçš„é¢œè‰²å’Œæ¨¡å‹passè¾“å‡ºçš„é¢œè‰²éƒ½ä¼šè¢«å¢™å£ä»£æ›¿ï¼Œå› ä¸ºå®ƒä»¬çš„æ·±åº¦å€¼é€—é€¼å¢™å£æ·±åº¦å€¼å¤§ å½“å¯¹è±¡è¢«å¢™å£é®æŒ¡ä½æ—¶ï¼Œæˆ‘ä»¬æƒ³è¦çš„æ•ˆæœæ˜¯æ˜¾ç¤ºçº¯è‰²ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å…³é—­çº¯è‰²çš„ZWriteï¼Œå°±æ˜¯ä¸å°†å®ƒçš„æ·±åº¦å€¼å†™å…¥æ·±åº¦ç¼“å­˜ï¼Œæ­¤æ—¶å®ƒçš„æ·±åº¦æµ‹è¯•å‚æ•°ZTesté»˜è®¤æ˜¯LEqualï¼Œè€Œå®ƒçš„æ·±åº¦å€¼æ˜¯å¤§äºå¢™å£çš„ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šæ˜¾ç¤ºã€‚ è¢«æŒ¡ä½æ—¶ï¼Œæ¨¡å‹è‰²å·²ç»è¢«å‰”é™¤äº†ï¼Œæœ€ç»ˆçš„é¢œè‰²æ··åˆä¸ºBlend SrcAlpha OneMinusSrcAlphaæœ€ç»ˆè‰² = çº¯è‰²rgbçº¯è‰²a + å¢™å£rgb(1-çº¯è‰²a) 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182Shader "Custome/XRay"&#123; Properties &#123; _Color("Color", Color)=(1,1,1,1) _MainTex ("Texture", 2D) = "white" &#123;&#125; _AfterColor("After Color", Color)=(0.435,0.851,1,0.419) &#125; SubShader &#123; Tags&#123;"Queue"="Geometry+1" "RenderType"="Opaque"&#125; LOD 300 Blend SrcAlpha OneMinusSrcAlpha Pass &#123; ZTest GEqual // æ·±åº¦æµ‹è¯•ï¼Œå¤§äºç­‰äºå½“å‰æœ€å°ä¸­çš„å€¼å°±ä¼šæ˜¾ç¤º ZWrite Off CGPROGRAM #pragma vertex vert #pragma fragment frag #include "UnityCG.cginc" struct appdata &#123; float4 vertex : POSITION; &#125;; struct v2f &#123; float4 vertex : SV_POSITION; &#125;; v2f vert (appdata v) &#123; v2f o; o.vertex = UnityObjectToClipPos(v.vertex); return o; &#125; fixed4 _AfterColor; fixed4 frag (v2f i) : SV_Target &#123; return _AfterColor; &#125; ENDCG &#125; Pass &#123; ZTest LEqual CGPROGRAM #pragma vertex vert #pragma fragment frag #include "UnityCG.cginc" struct appdata &#123; float4 vertex : POSITION; float2 uv : TEXCOORD0; &#125;; struct v2f &#123; float4 vertex: SV_POSITION; float2 uv : TEXCOORD0; &#125;; v2f vert(appdata i) &#123; v2f o; o.vertex = UnityObjectToClipPos(i.vertex); o.uv = i.uv; return o; &#125; sampler2D _MainTex; fixed4 _Color; fixed4 frag(v2f i):SV_Target &#123; fixed4 c = tex2D(_MainTex, i.uv) + _Color; return c; &#125; ENDCG &#125; &#125;&#125;]]></content>
      <categories>
        <category>Unity Shader</category>
      </categories>
      <tags>
        <tag>Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨é™æ€åˆ†æä¼˜åŒ–Unityä»£ç ]]></title>
    <url>%2F2019%2F04%2F13%2Fstatic-analyze-unity-code%2F</url>
    <content type="text"><![CDATA[UnityEngineAnalyzerUnityEngineAnalyzer is a set of Roslyn analyzers that aim to detect common problems in Unity3D C# code. Unity3D makes it easy for us to make cross platform games, but there are hidden rules about performance and AOT, which might only come with experience, testing or reading the forums. It is hoped that such problems can be caught before compilation. Building CLI executableCLI requires .NET Core 2.1 1dotnet publish -c Release -r win10-x64 or1dotnet publish -c Release -r ubuntu.16.10-x64 Comand Line InterfaceIn order to use the Command Line Interface (CLI), download the latest release of UnityEngineAnalyzer then unzip the archive (https://github.com/vad710/UnityEngineAnalyzer/releases). Open a Command Prompt or Powershell Window Run Linty.CLI.exe &lt;project path&gt; Observe the analysis results (Optional) In the same location as the project file are report.json and UnityReport.html files containig the results of the analysis Use command -e customexporter exporter2 ... to load custom exporters (Optional) configuration file path. Use command -c configureFilePath.json to load custom configurations Configuration json, allows to enable / disable analyzers (Optional) minimal severity for reports Use command -s Info/Warning/Error to defined used minimal severity for reporting Default is Warning (Optional) Unity version for check Use command -v UNITY_2017_1/UNITY_5_5/UNITY_4_0/... to Unity version For default analyzer will try to find ProjectVersion.txt file and parse version automatically. Example: &gt; Linty.CLI.exe C:\Code\MyGame.CSharp.csproj Visual Studio IntegrationIn Visual Studio 2017, go to Tools &gt; Nuget Package Manager &gt; Manage Nuget Packages for Solution.... Search for and install UnityEngineAnalyzer ConfigurationRight-click Analyzers to modify the severity or to disable the rule completely. Limitations HTML Report requires FireFox or XOR (Corss Origin Request) enabled in other browsers It doesnâ€™t have rules for all of Monoâ€™s AOT Limitations IL2CPP might change the limitations of AOT compilation Below is a sample of all the rules available in this analyzer 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647// AOT0001: System.Runtime.Remoting is not suppportedusing System.Runtime.Remoting;// AOT0002: System.Reflection.Emit is not supportedusing System.Reflection.Emit;using UnityEngine;class FooBehaviour : MonoBehaviour &#123; void Start() &#123; // AOT0003: Reflection only works for looking up existing types Type.GetType(""); // UEA0002: Using string methods can lead to code that is hard to maintain SendMessage(""); // UEA0006: Use of coroutines cause some allocations StartCoroutine(""); &#125; // UEA0001: Using OnGUI causes allocations and GC spikes void OnGUI() &#123; &#125; // UEA0003: Empty MonoBehaviour methods are executed and incur a small overhead void FixedUpdate() &#123; &#125; void OnTriggerEnter(Collider other) &#123; // UEA0004: Using CompareTag for tag comparison does not cause allocations if (other.tag == "") &#123; &#125; &#125; void Update() &#123; // UEA0005: Warning to cache the result of find in Start or Awake GameObject.Find(""); &#125;&#125; LicenseSee LICENSE]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RTR 4th Chapter2 å›¾å½¢æ¸²æŸ“ç®¡çº¿]]></title>
    <url>%2F2019%2F04%2F12%2FRTR-4th-Chapter2%2F</url>
    <content type="text"><![CDATA[æ•´ä¸ªæ¸²æŸ“æµæ°´çº¿çš„ç›®æ ‡æ˜¯å®æ—¶åœ°é€šè¿‡ä¸€ä¸ªè™šæ‹Ÿçš„cameraï¼ŒæŠŠå…‰æºï¼Œ3Dç‰©ä½“ï¼ˆåŒ…æ‹¬ä¸Šé¢çš„çº¹ç†ï¼‰ç­‰æ¸²æŸ“åˆ°2Då›¾åƒä¸Šï¼Œæµæ°´çº¿æ˜¯å¹¶è¡ŒåŒ–æ‰§è¡Œçš„ï¼Œä½†æ˜¯ä¼šå‡ºç°stallï¼Œç›´åˆ°æµæ°´çº¿ä¸­æœ€æ…¢çš„ä¸€ä¸ªé˜¶æ®µå®Œæˆå®ƒçš„ä»»åŠ¡æ•´æ¡æµæ°´çº¿çš„æ¶æ„ï¼Œä¸»è¦ä¾æ¬¡åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼šApplication,Geometry Processing,Rasterizationå’ŒPixel Processing æ¯ä¸ªé˜¶æ®µå†…éƒ¨ä¹Ÿæœ‰è‡ªå·±çš„pipelineçš„ã€‚æˆ‘ä»¬è¦åŒºåˆ«â€œé˜¶æ®µï¼ˆfunctional stageï¼‰â€å’Œå…·ä½“çš„å®ç°ç»“æ„ï¼Œä¹Ÿå°±æ˜¯è¯´å…·ä½“çš„æŸä¸ªå®ç°ç»“åˆå¯èƒ½åˆå¹¶äº†å‡ ä¸ªstageçš„å†…å®¹åˆ°ä¸€ä¸ªå•å…ƒï¼ˆunitï¼‰ï¼Œä½¿å¾—å…¶è¿‡ç¨‹æ—¶é—´æ¶ˆè€—æ›´çŸ­ã€‚ ç®€è¦ä»‹ç»Applicationé˜¶æ®µä¸»è¦æ˜¯åœ¨CPUä¸Šå®Œæˆçš„ï¼Œå¯ä»¥åˆ©ç”¨ç°ä»£CPUçš„å¤šå’Œç‰¹æ€§è¿›è¡Œå¤šçº¿ç¨‹ä¼˜åŒ–ï¼Œè¿™ä¸€éƒ¨åˆ†é€šå¸¸åŒ…æ‹¬ç¢°æ’æ£€æµ‹ï¼Œå…¨å±€åŠ é€Ÿç®—æ³•ï¼ŒåŠ¨ç”»ï¼Œç‰©ç†æ¨¡æ‹Ÿç­‰å¾…ï¼Œè¿™äº›å–å†³äºapplicationçš„ç±»å‹ã€‚Geometry Processingé˜¶æ®µä¸»è¦å¤„ç†è½¬æ¢ï¼ˆtransformsï¼‰ï¼ŒæŠ•å½±ï¼ˆprojectionsï¼‰ç­‰ç­‰å…¶ä»–æ‰€æœ‰ç±»å‹çš„å‡ ä½•æ“ä½œï¼Œè¿™ä¸ªé˜¶æ®µè®¡ç®—äº†ä»€ä¹ˆå°†ä¼šè¢«æ¸²æŸ“ï¼Œæ€æ ·è¢«æ¸²æŸ“ï¼Œåœ¨å“ªé‡Œè¢«æ¸²æŸ“ï¼Œä¸»è¦åœ¨GPUä¸Šå®Œæˆã€‚Rasterizationé˜¶æ®µä¸€èˆ¬æ¥å—ä¸‰ä¸ªé¡¶ç‚¹ï¼Œæ„å»ºå‡ºä¸€ä¸ªä¸‰è§’å½¢ï¼Œæ‰¾åˆ°æ‰€æœ‰è¢«è¿™ä¸ªä¸‰è§’å½¢åŒ…å«ç€çš„åƒç´ ç‚¹ï¼Œç„¶åæŠŠè¿™äº›åƒç´ ç‚¹ä¼ é€’ç»™Pixel Processingé˜¶æ®µï¼Œè¿™éƒ¨åˆ†å®Œå…¨åœ¨GPUä¸Šå®Œæˆã€‚Pixel Processingé˜¶æ®µæ‰§è¡Œé€åƒç´ çš„ç¨‹åºï¼Œè®¡ç®—æ¯ä¸ªåƒç´ çš„colorï¼Œä¹Ÿè®¸ä¼šè¿›è¡ŒZ-Testç­‰è¿›è¡Œå¯è§æ€§åˆ¤æ–­ï¼Œä¹Ÿè®¸ä¼šè¿›è¡Œblendæ“ä½œç­‰ï¼Œè¿™éƒ¨åˆ†ä¹Ÿå®Œå…¨åœ¨GPUä¸Šå®Œæˆã€‚ å…·ä½“ä»‹ç»æ¯ä¸ªé˜¶æ®µApplication Stageè¿™éƒ¨åˆ†æ˜¯å¼€å‘è€…å®Œå…¨æ§åˆ¶çš„é˜¶æ®µï¼Œå› ä¸ºè¿™éƒ¨åˆ†é€šå¸¸æ˜¯åŸºäºCPUæ‰§è¡Œçš„ï¼Œå¯¹äºè¿™éƒ¨åˆ†çš„æ”¹å˜ä¼šå½±å“åç»­é˜¶æ®µçš„performanceï¼ˆæ¯”å¦‚è¿™é‡Œå¯ä»¥é€šè¿‡ç®—æ³•å‡ä½è¦è¢«æ¸²æŸ“çš„ä¸‰è§’å½¢çš„æ•°é‡ï¼‰ä½†æ˜¯ç°åœ¨åœ¨è¿™éƒ¨åˆ†å¹³å°ä¸Šä¹Ÿå¯ä»¥ä½¿ç”¨è®¡ç®—ç€è‰²å™¨æ¥å€ŸGPUçš„åŠ›é‡åŠ é€Ÿã€‚è¿™ä¸ªé˜¶æ®µçš„æœ€åï¼Œæ¸²æŸ“å›¾å…ƒï¼ˆç‚¹ã€çº¿ã€ä¸‰è§’å½¢ï¼‰ä¼ å…¥åˆ°Geometry Procssingé˜¶æ®µã€‚è¿™ä¸ªéƒ¨åˆ†æ˜¯ä¸èƒ½è¢«åˆ†å‰²æˆå­éƒ¨åˆ†çš„ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯åŸºäºè½¯ä»¶çš„å®ç°æ–¹å¼ï¼Œæˆ‘ä»¬æœ€å¤šåªèƒ½å€ŸåŠ©CPUçš„å¤šæ ¸ç¼–å†™å¤šçº¿ç¨‹ç¨‹åºæ¥æå‡æ€§èƒ½è¿™ä¸ªé˜¶æ®µä¹Ÿæ˜¯ç”¨æ¥å¤„ç†å¤–æ¥è®¾å¤‡çš„è¾“å…¥ï¼Œä¸¤ä¸ªç‰©ä½“çš„ç¢°æ’æ£€æµ‹ï¼ŒåŠ é€Ÿç®—æ³•ï¼ˆæ¯”å¦‚éƒ¨åˆ†å‰”é™¤ç®—æ³•ï¼‰ Geometry Processingç”¨æ¥è´Ÿè´£é€ä¸‰è§’å½¢å’Œé€é¡¶ç‚¹çš„æ“ä½œã€‚è¿™éƒ¨åˆ†å¯ä»¥è¢«åˆ†ä¸º4ä¸ªé˜¶æ®µï¼šVertex Shadingï¼ŒProjectionï¼ŒClippingå’ŒScreen Mappingï¼Œä¸‹é¢é€ä¸€ä»‹ç»ï¼šVertex Shadingï¼šè¿™ä¸ªå­é˜¶æ®µä¸»è¦å¤„ç†ä¸¤ä¸ªä»»åŠ¡ï¼š1.è®¡ç®—é¡¶ç‚¹ä½ç½® 2.è®¡ç®—æ¯ä¸ªé¡¶ç‚¹åŒ…å«çš„å…¶ä»–æ€§è´¨ï¼Œå¦‚å‘ç°ï¼Œçº¹ç†åæ ‡ç­‰ä»¥å‰ä¼šåœ¨è¿™é‡Œå®ç°é€é¡¶ç‚¹çš„å…‰ç…§ï¼Œæ‰€ä»¥å«é¡¶ç‚¹ç€è‰²å™¨ï¼Œç°åœ¨é¡¶ç‚¹ç€è‰²å™¨å˜æˆäº†ä¸€ä¸ªæ›´åŠ é€šç”¨çš„ç”¨æ¥è®¾å®šä¸æ“ä½œæ¯ä¸ªé¡¶ç‚¹ç›¸å…³çš„æ•°æ®çš„è®¡ç®—å•å…ƒï¼ˆæ¯”å¦‚å¯ä»¥å®ç°é¡¶ç‚¹åŠ¨ç”»ç­‰ï¼‰è¿™ä¸ªé˜¶æ®µåŒæ—¶æ˜¯è½¬æ¢åæ ‡çš„é˜¶æ®µï¼ŒæŠŠåæ ‡ä»æ¨¡å‹ç©ºé—´è½¬æ¢åˆ°ä¸–ç•Œç©ºé—´ï¼Œä¸ºäº†ä¾¿äºåç»­çš„æŠ•å½±å’Œè£å‰ªï¼Œåœ¨ä½¿ç”¨view transformè½¬æ¢åˆ°ç›¸æœºç©ºé—´ï¼ŒåŒæ—¶ä¿å­˜æ¯ä¸ªé¡¶ç‚¹å¯¹åº”çš„materialï¼Œnormalç­‰ä¿¡æ¯ï¼Œæ¥ä¸‹æ¥æŠŠå®ƒè½¬æ¢åˆ°ä¸€ä¸ªå•ä½(-1,-1,-1)(1,1,1)ä¸­è¿›è¡ŒæŠ•å½±ï¼ˆzä¹Ÿå¯èƒ½æ˜¯[0,1]ï¼‰ï¼Œé¦–å…ˆæ˜¯è¿›è¡ŒæŠ•å½±ï¼ŒæŠ•å½±å¯åˆ†ä¸ºæ­£äº¤æŠ•å½±å’Œé€è§†æŠ•å½±ï¼Œåœ¨è¿›è¡Œé¡¶ç‚¹ç€è‰²å™¨çš„æ“ä½œè¿™ä¸ªå­é˜¶æ®µçš„è¾“å‡ºï¼ˆåŒ…å«é¢œè‰²ï¼Œçº¹ç†åæ ‡ç­‰ï¼‰è¢«é€åˆ°Rasterizationå’ŒPixel Processingé˜¶æ®µè¢«æ’å€¼ï¼Œç”¨æ¥è®¡ç®—è¡¨é¢çš„shadingï¼Œè¿™ä¸€æ­¥ç»“æŸåï¼Œz-è½´åæ ‡ä¸å†å­˜å‚¨åœ¨imageä¸­ï¼Œè€Œæ˜¯z-bufferå†…ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸€æ­¥æŠŠ3D-&gt;2Dã€‚ Optional Vertex Processingï¼šè¿™ä¸ªé˜¶æ®µæ˜¯å¯é€‰çš„ï¼Œè€Œä¸”ä¸åŒçš„GPUå¯¹è¿™éƒ¨åˆ†çš„ç¡¬ä»¶æ”¯æŒç¨‹åº¦ä¹Ÿæ˜¯ä¸åŒçš„ã€‚ç®€å•æ¥è¯´ä¾æ¬¡æ˜¯æ›²é¢ç»†åˆ†ï¼Œå‡ ä½•ç€è‰²å’Œæµè¾“å‡ºã€‚ Clippingï¼šåªæœ‰é‚£äº›å…¨éƒ¨éƒ¨åˆ†åœ¨view volumeä¸­çš„æ¸²æŸ“å›¾å…ƒæ‰èƒ½å¤Ÿpassè¿™ä¸ªé˜¶æ®µè¿›å…¥åç»­çš„é˜¶æ®µï¼Œä½¿ç”¨æŠ•å½±çŸ©é˜µæ„å‘³ç€æŠŠtransformåçš„å›¾å…ƒè£å‰ªå•ä½ç«‹æ–¹ä½“ä¸­ã€‚ Screen Mappingï¼šæŠŠè¿˜æ˜¯3Dçš„åæ ‡è½¬æ¢æˆå±å¹•åæ ‡ï¼ˆå±å¹•åæ ‡åŸç‚¹å–å†³äºAPIï¼‰ Rasterizationç›®æ ‡ï¼šæ‰¾åˆ°æ‰€æœ‰è¢«æ¸²æŸ“å›¾å…ƒåŒ…å«æˆ–è¦†ç›–çš„åƒç´ ç‚¹è¿™éƒ¨åˆ†åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šä¸‰è§’å½¢å»ºç«‹å’Œä¸‰è§’å½¢éå†ã€‚æŠŠ2Dçš„é¡¶ç‚¹åœ¨å±å¹•ç©ºé—´è½¬æ¢åˆ°å±å¹•ä¸Šçš„åƒç´ ï¼Œåœ¨è¿™é‡Œï¼Œä¸‰è§’å½¢é€šè¿‡ä¼ å…¥çš„3ä¸ªç‚¹å¾—ä»¥ç®€å†ï¼Œæœ€åæŠŠæ‰€æœ‰å›¾å…ƒçš„åƒç´ ç‚¹ä¼ é€’åˆ°Pixel Processingä¸­ã€‚è¿™ä¸ªé˜¶æ®µé€šå¸¸æ˜¯ç”±ç¡¬ä»¶å®ç°çš„ã€‚ Pixel Processingè¿™ä¸ªé˜¶æ®µé€šå¸¸åˆ†ä¸º2ä¸ªå­é˜¶æ®µï¼Œåˆ†åˆ«æ˜¯Pixel Shadingå’ŒMergeingPixel Shadingï¼šæ‰€æœ‰é€åƒç´ çš„è®¡ç®—éƒ½åœ¨è¿™é‡Œå®Œæˆï¼Œè¿™é‡Œçš„è¾“å…¥æ˜¯é€šè¿‡shading dataçš„æ’å€¼å¾—åˆ°çš„ã€‚è¿™é‡Œæ˜¯åŸºæœ¬ä¸Šå®Œå…¨å¯ç¼–ç¨‹çš„ï¼Œé€šè¿‡è‡ªå®šä¹‰ç‰‡å…ƒç€è‰²å™¨ï¼ˆæˆ–è€…å«åƒç´ ç€è‰²å™¨ï¼‰åœ¨GPUä¸Šå®Œæˆå…‰ç…§ï¼Œçº¹ç†ç­‰è®¡ç®—Mergeingï¼šæ¯ä¸ªåƒç´ å­˜å‚¨æ¥ä¸€ä¸ªå«é¢œè‰²ç¼“å†²çš„åœ°æ–¹ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªMergeé˜¶æ®µå¤„ç†ç‰‡å…ƒç€è‰²å™¨å‡ºæ¥çš„é¢œè‰²å’Œbufferä¸­æœ¬æ¥å­˜ç€çš„é¢œè‰²ä¹‹é—´çš„å…³ç³»ï¼Œè¿™éƒ¨åˆ†ä¹Ÿç”¨æ¥è´Ÿè´£å¯è§æ€§é—®é¢˜ï¼ˆä½¿ç”¨z-bufferç®—æ³•ï¼‰æ¨¡ç‰ˆç¼“å†²æ˜¯ä¸€ä¸ªç¦»å±ç¼“å†²ç”¨æ¥è®°å½•æ¸²æŸ“å›¾å…ƒçš„ä½ç½®ï¼Œæ¯ä¸ªåƒç´ é€šå¸¸ä¸º8bitï¼Œå¯ä»¥ç”¨æ¥æ§åˆ¶åç»­å›¾å…ƒçš„æ¸²æŸ“æƒ…å†µï¼ˆé€šè¿‡æ¨¡ç‰ˆæµ‹è¯•çš„æ–¹å¼ï¼‰]]></content>
      <categories>
        <category>RTR-4th</category>
      </categories>
      <tags>
        <tag>å›¾å½¢å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unityä¸­çš„æ¸²æŸ“ä¼˜åŒ–æŠ€æœ¯]]></title>
    <url>%2F2019%2F04%2F11%2Funity-render-optimize%2F</url>
    <content type="text"><![CDATA[ç§»åŠ¨å¹³å°çš„ç‰¹ç‚¹å’ŒPCå¹³å°ç›¸æ¯”ï¼Œç§»åŠ¨å¹³å°ä¸Šçš„GPUæ¶æ„æœ‰å¾ˆå¤§çš„ä¸åŒã€‚ç”±äºå¤„ç†èµ„æºç­‰æ¡ä»¶çš„é™åˆ¶ï¼Œç§»åŠ¨è®¾å¤‡ä¸Šçš„GPUæ¶æ„ä¸“æ³¨äºå°½å¯èƒ½ä½¿ç”¨æ›´å°çš„å¸¦å®½å’Œå…¬å…±èƒ½ï¼Œä¹Ÿç”±æ­¤å¸¦æ¥è®¸å¤šå’ŒPCå¹³å°å®Œå…¨ä¸åŒçš„ç°è±¡ã€‚ä¾‹å¦‚ï¼Œä¸ºäº†å°½å¯èƒ½ç§»é™¤é‚£äº›éšè—çš„è¡¨é¢ï¼Œå‡å°‘overdrawï¼ˆå³ä¸€ä¸ªåƒç´ è¢«ç»˜åˆ¶å¤šæ¬¡ï¼‰ï¼ŒPowerVRèŠ¯ç‰‡ï¼ˆé€šå¸¸ç”¨äºiOSè®¾å¤‡å’ŒæŸäº›Androidè®¾å¤‡ï¼‰ä½¿ç”¨äº†åŸºäºç“¦ç‰‡çš„å»¶è¿Ÿæ¸²æŸ“ï¼ˆTiled-based Deffered Renderingï¼ŒTBDRï¼‰æ¶æ„ï¼ŒæŠŠæ‰€æœ‰çš„æ¸²æŸ“å›¾åƒè£…å…¥ä¸€ä¸ªä¸ªç“¦ç‰‡ï¼ˆtileï¼‰ä¸­ï¼Œå†ç”±ç¡¬ä»¶æ‰¾åˆ°å¯è§çš„ç‰‡å…ƒï¼Œè€Œåªæœ‰è¿™äº›å¯è§ç‰‡å…ƒæ‰ä¼šæ‰§è¡Œç‰‡å…ƒç€è‰²å™¨ã€‚å¦ä¸€äº›åŸºäºç“¦ç‰‡çš„GPUæ¶æ„ï¼Œå¦‚Adrenoï¼ˆé«˜é€šçš„èŠ¯ç‰‡ï¼‰å’ŒMaliï¼ˆARMçš„èŠ¯ç‰‡ï¼‰åˆ™ä¼šä½¿ç”¨Early-Zæˆ–ç›¸ä¼¼çš„æŠ€æœ¯è¿›è¡Œä¸€ä¸ªä½ç²¾åº¦çš„æ·±åº¦æ£€æµ‹ï¼Œæ¥å‰”é™¤é‚£äº›ä¸éœ€è¦æ¸²æŸ“çš„ç‰‡å…ƒã€‚è¿˜æœ‰ä¸€äº›GPUï¼Œå¦‚Tegraï¼ˆè‹±ä¼Ÿè¾¾çš„èŠ¯ç‰‡ï¼‰ï¼Œåˆ™ä½¿ç”¨äº†ä¼ ç»Ÿçš„æ¶æ„è®¾è®¡ï¼Œå› ä¸ºåœ¨è¿™äº›è®¾å¤‡ä¸Šï¼Œoverdrawæ›´å¯èƒ½é€ æˆæ€§èƒ½çš„ç“¶é¢ˆã€‚ç”±äºè¿™äº›èŠ¯ç‰‡æ¶æ„é€ æˆçš„ä¸åŒï¼Œä¸€äº›æ¸¸æˆå¾€å¾€éœ€è¦é’ˆå¯¹ä¸é€šçš„èŠ¯ç‰‡å‘å¸ƒä¸åŒçš„ç‰ˆæœ¬ï¼Œä»¥ä¾¿å¯¹æ¯ä¸ªèŠ¯ç‰‡è¿›è¡Œæ›´æœ‰é’ˆå¯¹æ€§çš„ä¼˜åŒ–ã€‚å°¤å…¶æ˜¯åœ¨Androidå¹³å°ä¸Šï¼Œä¸é€šè®¾å¤‡ä½¿ç”¨çš„ç¡¬ä»¶ï¼Œå¦‚å›¾å½¢èŠ¯ç‰‡ã€å±å¹•åˆ†è¾¨ç‡ç­‰ï¼Œå¤§ç›¸å¾„åº­ï¼Œè¿™å¯¹å›¾å½¢ä¼˜åŒ–æå‡ºäº†æ›´é«˜çš„æŒ‘æˆ˜ã€‚ç›¸æ¯”äºAndroidå¹³å°ï¼ŒiOSå¹³å°çš„ç¡¬ä»¶æ¡ä»¶åˆ™ç›¸å¯¹ç»Ÿä¸€ã€‚ å½±å“æ€§èƒ½çš„å› ç´ é¦–å…ˆï¼Œåœ¨å­¦ä¹ å¦‚ä½•ä¼˜åŒ–ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—å…ˆäº†è§£å½±å“æ¸¸æˆæ€§èƒ½çš„å› ç´ æœ‰å“ªäº›ã€‚å¯¹äºä¸€ä¸ªæ¸¸æˆæ¥è¯´ï¼Œå®ƒä¸»è¦éœ€è¦ä½¿ç”¨ä¸¤ç§è®¡ç®—èµ„æºï¼šCPUå’ŒGPUã€‚å®ƒä»¬ä¼šäº’ç›¸åˆä½œï¼Œæ¥è®©æˆ‘ä»¬çš„æ¸¸æˆå¯ä»¥åœ¨é¢„æœŸçš„å¸§ç‡å’Œåˆ†è¾¨ç‡ä¸‹å·¥ä½œã€‚å…¶ä¸­ï¼ŒCPUä¸»è¦è´Ÿè´£ä¿è¯å¸§ç‡ï¼ŒGPUä¸»è¦è´Ÿè´£åˆ†è¾¨ç‡ç›¸å…³çš„ä¸€äº›å¤„ç†ã€‚æ®æ­¤ï¼Œå¯ä»¥æŠŠé€ æˆæ¸¸æˆæ€§èƒ½ç“¶é¢ˆçš„ä¸»è¦åŸå› åˆ†æˆä»¥ä¸‹å‡ ä¸ªæ–¹é¢ã€‚ CPU è¿‡å¤šçš„draw call å¤æ‚çš„è„šæœ¬æˆ–è€…ç‰©ç†æ¨¡æ‹Ÿ GPU é¡¶ç‚¹å¤„ç† è¿‡å¤šçš„é¡¶ç‚¹ è¿‡å¤šçš„é€é¡¶ç‚¹è®¡ç®— ç‰‡å…ƒå¤„ç† è¿‡å¤šçš„ç‰‡å…ƒï¼ˆæ—¢å¯èƒ½æ˜¯ç”±äºåˆ†è¾¨ç‡é€ æˆçš„ï¼Œä¹Ÿå¯èƒ½æ˜¯ç”±äºoverdrawé€ æˆçš„ï¼‰ã€‚ è¿‡å¤šçš„é€ç‰‡å…ƒè®¡ç®—ã€‚ å¸¦å®½ ä½¿ç”¨äº†å°ºå¯¸å¾ˆå¤§ä¸”æœªå‹ç¼©çš„çº¹ç† åˆ†è¾¨ç‡è¿‡é«˜çš„å¸§ç¼“å­˜ å¯¹äºCPUæ¥è¯´ï¼Œé™åˆ¶å®ƒçš„ä¸»è¦æ˜¯æ¯ä¸€å¸§draw callçš„æ•°ç›®ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯CPUåœ¨æ¯æ¬¡é€šçŸ¥GPUè¿›è¡Œæ¸²æŸ“ä¹‹å‰ï¼Œéƒ½éœ€è¦æå‰å‡†å¤‡å¥½é¡¶ç‚¹æ•°æ®ï¼ˆå¦‚ä½ç½®ã€æ³•çº¿ã€é¢œè‰²ã€çº¹ç†åæ ‡ç­‰ï¼‰ï¼Œç„¶åè°ƒç”¨ä¸€ç³»åˆ—APIæŠŠå®ƒä»¬æ”¾åˆ°GPUå¯ä»¥è®¿é—®åˆ°çš„æŒ‡å®šä½ç½®ï¼Œæœ€åï¼Œè°ƒç”¨ä¸€ä¸ªç»˜åˆ¶å‘½ä»¤ï¼Œæ¥å‘Šè¯‰GPUã€‚è€Œè°ƒç”¨ä¸€æ¬¡ç»˜åˆ¶å‘½ä»¤çš„æ—¶å€™ï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªdraw callã€‚è¿‡å¤šçš„draw callä¼šé€ æˆCPUçš„æ€§èƒ½ç“¶é¢ˆï¼Œè¿™æ˜¯å› ä¸ºæ¯æ¬¡è°ƒç”¨draw callæ—¶ï¼ŒCPUå¾€å¾€éƒ½éœ€è¦æ”¹å˜å¾ˆå¤šæ¸²æŸ“çŠ¶æ€çš„è®¾ç½®ï¼Œè€Œè¿™äº›æ“ä½œæ˜¯éå¸¸è€—æ—¶çš„ã€‚å¦‚æœä¸€å¸§ä¸­éœ€è¦çš„draw callæ•°ç›®è¿‡å¤šçš„è¯ï¼Œå°±ä¼šå¯¼è‡´CPUæŠŠå¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±è´¹åœ¨æäº¤draw callçš„å·¥ä½œä¸Šé¢äº†ã€‚å½“ç„¶ï¼Œå…¶ä»–åŸå› ä¹Ÿå¯èƒ½é€ æˆCPUç“¶é¢ˆï¼Œä¾‹å¦‚ç‰©ç†ã€å¸ƒæ–™æ¨¡æ‹Ÿã€è’™çš®ã€ç²’å­æ¨¡æ‹Ÿç­‰ï¼Œè¿™äº›éƒ½æ˜¯è®¡ç®—é‡å¾ˆå¤§çš„æ“ä½œã€‚è€Œå¯¹äºGPUæ¥è¯´ï¼Œå®ƒè´Ÿè´£æ•´ä¸ªæ¸²æŸ“æµæ°´çº¿ã€‚å®ƒä»å¤„ç†CPUä¼ é€’è¿‡æ¥çš„æ¨¡æ‹Ÿæ•°æ®å¼€å§‹ï¼Œè¿›è¡Œé¡¶ç‚¹ç€è‰²å™¨ã€ç‰‡å…ƒç€è‰²å™¨ç­‰ä¸€ç³»åˆ—å·¥ä½œï¼Œæœ€åè¾“å‡ºå±å¹•ä¸Šçš„æ¯ä¸ªåƒç´ ã€‚å› æ­¤ï¼ŒGPUçš„æ€§èƒ½ç“¶é¢ˆå’Œéœ€è¦å¤„ç†çš„é¡¶ç‚¹æ•°ç›®ã€å±å¹•åˆ†è¾¨ç‡ã€æ˜¾å­˜ç­‰å› ç´ æœ‰å…³ã€‚è€Œç›¸å…³çš„ä¼˜åŒ–ç­–ç•¥å¯ä»¥å‡å°‘å¤„ç†çš„æ•°æ®ï¼ˆåŒ…æ‹¬é¡¶ç‚¹æ•°ç›®å’Œç‰‡å…ƒæ•°ç›®ï¼‰ã€å‡å°‘è¿ç®—å¤æ‚åº¦ç­‰æ–¹é¢å…¥æ‰‹ã€‚ CPUä¼˜åŒ– ä½¿ç”¨æ‰¹å¤„ç†æŠ€æœ¯å‡å°‘draw callæ•°ç›® GPUä¼˜åŒ– å‡å°‘éœ€è¦å¤„ç†çš„é¡¶ç‚¹æ•°ç›®ã€‚ ä¼˜åŒ–å‡ ä½•ä½“ ä½¿ç”¨æ¨¡å‹çš„LODï¼ˆLevel of Detailï¼‰æŠ€æœ¯ ä½¿ç”¨é®æŒ¡å‰”é™¤ï¼ˆOvvlusion Cullingï¼‰æŠ€æœ¯ å‡å°‘éœ€è¦å¤„ç†çš„ç‰‡å…ƒæ•°ç›® æ§åˆ¶ç»˜åˆ¶é¡ºåº è­¦æƒ•é€æ˜ç‰©ä½“ å‡å°‘å®æ—¶å…‰ç…§ å‡å°‘è®¡ç®—å¤æ‚åº¦ ä½¿ç”¨Shaderçš„LODï¼ˆLevel Of Deailï¼‰æŠ€æœ¯ ä»£ç æ–¹é¢çš„ä¼˜åŒ– èŠ‚çœå†…å­˜å¸¦å®½ å‡å°‘çº¹ç†å¤§å° åˆ©ç”¨åˆ†è¾¨ç‡ç¼©æ”¾ åœ¨å¼€å§‹ä¼˜åŒ–ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦çŸ¥é“æ˜¯å“ªä¸ªæ­¥éª¤é€ æˆäº†æ€§èƒ½ç“¶é¢ˆã€‚è€Œè¿™å¯ä»¥åˆ©ç”¨Unityæä¾›çš„ä¸€äº›æ¸²æŸ“åˆ†æå·¥å…·æ¥å®ç°ã€‚ Unityä¸­çš„æ¸²æŸ“åˆ†æå·¥å…·Unityå†…ç½®äº†ä¸€äº›å·¥å…·ï¼Œæ¥å¸®åŠ©æˆ‘ä»¬æ–¹ä¾¿åœ°æŸ¥çœ‹å’Œæ¸²æŸ“ç›¸å…³çš„å„ä¸ªç»Ÿè®¡æ•°æ®ã€‚è¿™äº›æ•°æ®å¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ†ææ¸¸æˆæ¸²æŸ“æ€§èƒ½ï¼Œä»è€Œæ›´æœ‰é’ˆå¯¹æ€§çš„è¿›è¡Œä¼˜åŒ–ã€‚è¿™äº›å·¥å…·åŒ…æ‹¬äº†æ¸²æŸ“ç»Ÿè®¡çª—å£ï¼ˆRendering Statistics Windowï¼‰ã€æ€§èƒ½åˆ†æå™¨ï¼ˆProfilerï¼‰ï¼Œä»¥åŠå¸§è°ƒè¯•å™¨ï¼ˆFrame Debuggerï¼‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¸åŒçš„ç›®æ ‡å¹³å°ä¸Šï¼Œè¿™äº›å·¥å…·ä¸­æ˜¾ç¤ºçš„æ•°æ®ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚ æ¸²æŸ“ç»Ÿè®¡çª—å£æ¸²æŸ“ç»Ÿè®¡çª—å£ä¸»è¦åŒ…å«äº†éŸ³é¢‘ï¼ˆAudioï¼‰ã€å›¾åƒï¼ˆGraphicsï¼‰ã€‚è¿™é‡Œæˆ‘ä»¬åªå…³å¿ƒå›¾åƒç›¸å…³çš„æ¸²æŸ“ç»Ÿè®¡ç»“æœã€‚æ¸²æŸ“ç»Ÿè®¡çª—å£ä¸­æ˜¾ç¤ºäº†å¾ˆå¤šé‡è¦çš„æ¸²æŸ“æ•°æ®ï¼Œä¾‹å¦‚FPSã€æ‰¹å¤„ç†æ•°ç›®ã€é¡¶ç‚¹å’Œä¸‰è§’ç½‘æ ¼çš„æ•°ç›®ç­‰ã€‚ ä¿¡æ¯åç§° æè¿° æ¯å¸§çš„æ—¶é—´å’ŒFPS åœ¨Graphicçš„å³ä¾§æ˜¾ç¤ºï¼Œç»™å‡ºäº†å¤„ç†å’Œæ¸²æŸ“ä¸€å¸§æ‰€éœ€çš„æ—¶é—´ï¼Œä»¥åŠFPSæ•°ç›® Batches ä¸€å¸§ä¸­éœ€è¦è¿›è¡Œçš„æ‰¹å¤„ç†æ•°ç›® Saved by batching åˆå¹¶çš„æ‰¹å¤„ç†æ•°ç›®ï¼Œè¿™ä¸ªæ•°å­—è¡¨æ˜äº†æ‰¹å¤„ç†ä¸ºæˆ‘ä»¬èŠ‚çœäº†å¤šå°‘çš„draw call Triså’ŒVerts éœ€è¦ç»˜åˆ¶çš„ä¸‰è§’é¢ç‰‡å’Œé¡¶ç‚¹æ•°ç›® Screen å±å¹•çš„å¤§å°ï¼Œä»¥åŠå®ƒå ç”¨çš„å†…å­˜å¤§å° SetPass calls æ¸²æŸ“ä½¿ç”¨çš„Passçš„æ•°ç›®ï¼Œæ¯ä¸ªPasséƒ½éœ€è¦Unityçš„runtimeæ¥ç»‘å®šä¸€ä¸ªæ–°çš„Shaderï¼Œè¿™å¯èƒ½é€ æˆCPUç“¶é¢ˆ Shadow casters åœºæ™¯ä¸­æœ‰å¤šå°‘å¯ä»¥æŠ•å°„é˜´å½±çš„ç‰©ä½“ï¼Œä¸€èˆ¬è¿™äº›ç‰©ä½“éƒ½ä½œä¸ºåœºæ™¯ä¸­å…‰æº visible skinned meshed æ¸²æŸ“çš®è‚¤ç½‘æ ¼çš„æ•°é‡ animations æ­£åœ¨æ’­æ”¾åŠ¨ç”»çš„æ•°é‡ æ€§èƒ½åˆ†æå™¨çš„æ¸²æŸ“åŒºåŸŸ æ€§èƒ½åˆ†æå™¨æ˜¾ç¤ºäº†ç»å¤§éƒ¨åˆ†åœ¨æ¸²æŸ“ç»Ÿè®¡çª—å£ä¸­æä¾›çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œç»¿çº¿æ˜¾ç¤ºäº†æ‰¹å¤„ç†æ•°ç›®ã€è“çº¿æ˜¾ç¤ºäº†Passæ•°ç›®ç­‰ï¼ŒåŒæ—¶è¿˜ç»™å‡ºäº†è®¸å¤šå…¶ä»–éå¸¸æœ‰ç”¨çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œdraw callæ•°ç›®ã€åŠ¨æ€æ‰¹å¤„ç†/é™æ€æ‰¹å¤„ç†çš„æ•°ç›®ã€æ¸²æŸ“çº¹ç†çš„æ•°ç›®å’Œå†…å­˜å ç”¨ç­‰ã€‚ç»“åˆæ¸²æŸ“ç»Ÿè®¡çª—å£å’Œæ€§èƒ½åˆ†æå™¨ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä¸æ¸²æŸ“ç›¸å…³çš„ç»å¤§å¤šæ•°é‡è¦çš„æ•°æ®ã€‚ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„æƒ³è±¡æ˜¯ï¼Œæ€§èƒ½åˆ†æå™¨ç»™å‡ºçš„draw callæ•°ç›®å’Œæ‰¹å¤„ç†æ•°ç›®ã€Passæ•°ç›®å¹¶ä¸ç›¸ç­‰ï¼Œå¹¶ä¸”çœ‹èµ·æ¥å¥½åƒè¦å¤§äºæˆ‘ä»¬ä¼°ç®—çš„æ•°ç›®ï¼Œè¿™æ˜¯å› ä¸ºUnityåœ¨èƒŒåéœ€è¦è¿›è¡Œå¾ˆå¤šå·¥ä½œï¼Œä¾‹å¦‚ï¼Œåˆå§‹åŒ–å„ä¸ªç¼“å­˜ã€ä¸ºé˜´å½±æ›´æ–°æ·±åº¦çº¹ç†å’Œé˜´å½±æ˜ å°„çº¹ç†ç­‰ï¼Œå› æ­¤éœ€è¦èŠ±è´¹æ¯”â€œé¢„æœŸâ€æ›´å¤šçš„draw callã€‚ å¸§è°ƒè¯•å™¨å¸§è°ƒè¯•å™¨çš„è°ƒè¯•é¢æ¿ä¸Šæ˜¾ç¤ºäº†æ¸²æŸ“è¿™ä¸€å¸§é”éœ€è¦çš„æ‰€æœ‰çš„æ¸²æŸ“æ—¶é—´ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œäº‹ä»¶æ•°ç›®ä¸º41ï¼Œè€Œå…¶ä¸­åŒ…å«äº†36ä¸ªdraw calläº‹ä»¶ï¼ˆå…¶ä»–æ¸²æŸ“æ—¶é—´å¤šä¸ºæ¸…ç©ºç¼“å­˜ç­‰ï¼‰ã€‚é€šè¿‡å•å‡»é¢æ¿ä¸Šçš„æ¯ä¸ªäº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Gameè§†å›¾æŸ¥çœ‹è¯¥æ—¶é—´çš„ç»˜åˆ¶ç»“æœï¼ŒåŒæ—¶æ¸²æŸ“ç»Ÿè®¡é¢ä¸Šçš„æ•°æ®ä¹Ÿä¼šæ˜¾ç¤ºæˆæˆªè‡³å½“å‰äº‹ä»¶ä¸ºæ­¢çš„å„ä¸ªæ¸²æŸ“ç»Ÿè®¡æ•°æ®ã€‚ å…¶ä»–æ€§èƒ½åˆ†æå·¥å…·å¯¹äºAndroidå¹³å°æ¥è¯´ï¼Œé«˜é€šçš„Adrenoåˆ†æå·¥å…·å¯ä»¥å¯¹ä¸åŒçš„æµ‹è¯•æœºè¿›è¡Œè¯¦ç»†çš„æ€§èƒ½åˆ†æã€‚è‹±ä¼Ÿè¾¾æä¾›çš„NVPerfHUDå·¥å…·æ¥å¸®åŠ©æˆ‘ä»¬å¾—åˆ°å‡ ä¹æ‰€æœ‰éœ€è¦çš„æ€§èƒ½åˆ†ææ•°æ®ï¼Œä¾‹å¦‚ï¼Œæ¯ä¸ªdraw callçš„GPUæ—¶é—´ï¼Œæ¯ä¸ªshaderè¯è´¹çš„cycleæ•°ç›®ç­‰ã€‚å¯¹äºiOSå¹³å°æ¥è¯´ï¼ŒUnityå†…ç½®çš„åˆ†æå™¨å¯ä»¥å¾—åˆ°æ•´ä¸ªåœºæ™¯çš„èŠ±è´¹çš„GPUæ—¶é—´ã€‚PowerVRawçš„PVRUniSCo shaderåˆ†æå™¨ä¹Ÿå¯ä»¥ç»™å‡ºä¸€ä¸ªå¤§è‡´çš„æ€§èƒ½è¯„ä¼°ã€‚Xcodeä¸­çš„OpenGL ES Driver Instrumentså¯ä»¥ç»™å‡ºä¸€äº›å®è§‚ä¸Šçš„æ€§èƒ½ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œè®¾å¤‡åˆ©ç”¨ç‡ã€æ¸²æŸ“å™¨åˆ©ç”¨ç‡ç­‰ã€‚ä½†ç›¸å¯¹äºAndroidå¹³å°ï¼Œå¯¹iOSçš„æ€§èƒ½åˆ†ææ›´åŠ å›°éš¾ï¼ˆå·¥å…·è¾ƒå°‘ï¼‰ã€‚è€Œä¸”PowerVRèŠ¯ç‰‡é‡‡ç”¨äº†åŸºäºç“¦ç‰‡çš„å»¶è¿Ÿæ¸²æŸ“å™¨ï¼Œå› æ­¤ï¼Œæƒ³è¦å¾—åˆ°æ¯ä¸ªdraw callè¯è´¹çš„GPUæ—¶é—´æ˜¯å‡ ä¹ä¸å¯èƒ½çš„ã€‚è¿™æ˜¯ï¼Œä¸€äº›å®è§‚ä¸Šç»Ÿè®¡æ•°æ®å¯èƒ½æ›´æœ‰å‚è€ƒä»·å€¼ã€‚ å‡å°‘draw callæ•°ç›®æ‰¹å¤„ç†çš„å®ç°åŸç†å°±æ˜¯ä¸ºäº†å‡å°‘æ¯ä¸€å¸§éœ€è¦çš„draw callæ•°ç›®ã€‚ä¸ºäº†æŠŠä¸€ä¸ªå¯¹è±¡æ¸²æŸ“åˆ°å±å¹•ä¸Šï¼Œ åŠ¨æ€æ‰¹å¤„ç†åŸºæœ¬åŸç†ï¼šæ¯ä¸€å¸§æŠŠå¯ä»¥è¿›è¡Œæ‰¹å¤„ç†çš„æ¨¡å‹ç½‘æ ¼è¿›è¡Œåˆå¹¶ï¼Œå†æŠŠåˆå¹¶åçš„æ¨¡å‹æ•°æ®ä¼ é€’ç»™GPUï¼Œç„¶åä½¿ç”¨åŒä¸€ä¸ªæè´¨å¯¹å…¶æ¸²æŸ“ã€‚åŠ¨æ€æ‰¹å¤„ç†çš„ä¸€ä¸ªå¥½å¤„æ˜¯å®ç°æ–¹ä¾¿ï¼Œå¦ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œç»è¿‡æ‰¹å¤„ç†çš„ç‰©ä½“ä»ç„¶å¯ä»¥ç§»åŠ¨ï¼Œè¿™æ˜¯ç”±äºåœ¨å¤„ç†æ¯å¸§æ—¶Unityéƒ½ä¼šé‡æ–°åˆå¹¶ä¸€æ¬¡ç½‘æ ¼ã€‚ æ¡ä»¶é™åˆ¶ï¼š èƒ½å¤Ÿè¿›è¡ŒåŠ¨æ€æ‰¹å¤„ç†çš„ç½‘æ ¼çš„é¡¶ç‚¹å±æ€§è§„æ¨¡è¦å°äº900ã€‚ä¾‹å¦‚ï¼Œå¦‚æœshaderä¸­éœ€è¦ä½¿ç”¨é¡¶ç‚¹ä½ç½®ã€å‘ç°å’Œçº¹ç†åæ ‡è¿™3ä¸ªé¡¶ç‚¹å±æ€§ï¼Œé‚£ä¹ˆè¦æƒ³è®©æ¨¡å‹èƒ½å¤Ÿè¢«åŠ¨æ€æ‰¹å¤„ç†ï¼Œå®ƒçš„é¡¶ç‚¹æ•°ç›®ä¸èƒ½è¶…è¿‡300ã€‚ å¤šPassçš„shaderä¼šä¸­æ–­æ‰¹å¤„ç†ã€‚åœ¨å‰å‘æ¸²æŸ“ä¸­ï¼Œæˆ‘ä»¬æœ‰æ—¶éœ€è¦ä½¿ç”¨é¢å¤–çš„Passæ¥ä¸ºæ¨¡å‹æ·»åŠ æ›´å¤šçš„å…‰ç…§æ•ˆæœï¼Œä½†è¿™æ ·ä¸€æ¥æ¨¡å‹å°±ä¸ä¼šè¢«åŠ¨æ€æ‰¹å¤„ç†äº†ã€‚ é™æ€æ‰¹å¤„ç†Unityæä¾›äº†å¦ä¸€ç§æ‰¹å¤„ç†æ–¹å¼ï¼Œå³é™æ€æ‰¹å¤„ç†ã€‚ç›¸æ¯”äºåŠ¨æ€æ‰¹å¤„ç†æ¥è¯´ï¼Œé™æ€æ‰¹å¤„ç†é€‚ç”¨äºä»»ä½•å¤§å°çš„å‡ ä½•æ¨¡å¼ã€‚å®ƒçš„å®ç°åŸç†æ˜¯ï¼Œåªåœ¨è¿è¡Œå¼€å§‹é˜¶æ®µï¼ŒæŠŠéœ€è¦è¿›è¡Œé™æ€æ‰¹å¤„ç†çš„æ¨¡å‹åˆå¹¶åˆ°ä¸€ä¸ªæ–°çš„ç½‘ç»œç»“æ„ä¸­ï¼Œè¿™æ„å‘³ç€è¿™äº›æ¨¡å‹ä¸å¯ä»¥åœ¨è¿è¡Œæ—¶åˆ»è¢«ç§»åŠ¨ã€‚ä½†ç”±äºå®ƒåªéœ€è¦è¿›è¡Œä¸€æ¬¡åˆå¹¶æ“ä½œï¼Œå› æ­¤ï¼Œæ¯”åŠ¨æ€æ‰¹å¤„ç†æ›´åŠ é«˜æ•ˆã€‚é™æ€æ‰¹å¤„ç†çš„å¦ä¸€ä¸ªç¼ºç‚¹åœ¨ä¸ï¼Œå®ƒå¾€å¾€éœ€è¦å ç”¨æ›´å¤šçš„å†…å­˜æ¥å­˜å‚¨åˆå¹¶åçš„å‡ ä½•ç»“æ„ã€‚è¿™æ˜¯å› ä¸ºï¼Œå¦‚æœåœ¨é™æ€æ‰¹å¤„ç†é’±ä¸€äº›ç‰©ä½“å…±äº«äº†ç›¸åŒçš„ç½‘æ ¼ï¼Œé‚£ä¹ˆåœ¨å†…å­˜ä¸­æ¯ä¸€ä¸ªç‰©ä½“éƒ½ä¼šå¯¹åº”ä¸€ä¸ªè¯¥ç½‘æ ¼çš„å¤åˆ¶å“ï¼Œå³ä¸€ä¸ªç½‘æ ¼ä¼šå˜æˆå¤šä¸ªç½‘æ ¼åœ¨å‘é€ç»™GPUã€‚å¦‚æœè¿™ç±»ä½¿ç”¨åŒä¸€ç½‘æ ¼çš„å¯¹è±¡å¾ˆå¤šï¼Œé‚£ä¹ˆè¿™å°±ä¼šæˆä¸ºä¸€ä¸ªæ€§èƒ½ç“¶é¢ˆäº†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåœ¨ä¸€ä¸ªä½¿ç”¨äº†1000ä¸ªç›¸åŒæ¨¡å‹çš„æ£®æ—ä¸­ä½¿ç”¨é™æ€æ‰¹å¤„ç†ï¼Œé‚£ä¹ˆï¼Œå°±ä¼šå¤šä½¿ç”¨1000å€çš„å†…å­˜ï¼Œè¿™ä¼šé€ æˆä¸¥é‡çš„å†…å­˜å½±å“ã€‚ å…±äº«æè´¨æ— è®ºæ˜¯é™æ€æ‰¹å¤„ç†è¿˜æ˜¯åŠ¨æ€æ‰¹å¤„ç†ï¼Œéƒ½è¦æ±‚æ¨¡å‹ä¹‹é—´éœ€è¦å…±äº«åŒä¸€ä¸ªæè´¨ã€‚ä½†ä¸åŒçš„æ¨¡å‹ä¹‹é—´æ€»ä¼šéœ€è¦æœ‰ä¸åŒçš„æ¸²æŸ“å±æ€§ï¼Œä¾‹å¦‚ï¼Œä½¿ç”¨ä¸åŒçš„çº¹ç†ã€é¢œè‰²ç­‰ã€‚è¿™æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›ç­–ç•¥æ¥å°½å¯èƒ½åœ°åˆå¹¶æè´¨ã€‚å¦‚æœä¸¤ä¸ªæè´¨ä¹‹é—´åªæœ‰ä½¿ç”¨çš„çº¹ç†ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™äº›çº¹ç†åˆå¹¶åˆ°ä¸€å¼ æ›´å¤§çš„çº¹ç†ä¸­ï¼Œè¿™å¼ æ›´å¤§çš„çº¹ç†è¢«ç§°ä¸ºæ˜¯ä¸€å¼ å›¾é›†ï¼ˆatlasï¼‰ã€‚ä¸€æ—¦ä½¿ç”¨äº†åŒä¸€å¼ çº¹ç†ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªæè´¨ï¼Œå†ä½¿ç”¨ä¸åŒçš„é‡‡æ ·åæ ‡å¯¹çº¹ç†é‡‡æ ·å³å¯ã€‚ä½†æœ‰æ—¶ï¼Œé™¤äº†çº¹ç†ä¸åŒå¤–ï¼Œä¸åŒçš„ç‰©ä½“åœ¨æè´¨ä¸Šè¿˜æœ‰ä¸€äº›å¾®å°çš„å‚æ•°å˜åŒ–ï¼Œä¾‹å¦‚ï¼Œé¢œè‰²ä¸åŒã€æŸäº›æµ®ç‚¹å±æ€§ä¸åŒã€‚ä½†æ˜¯ï¼Œä¸ç®¡æ˜¯åŠ¨æ€æ‰¹å¤„ç†è¿˜æ˜¯é™æ€æ‰¹å¤„ç†ï¼Œå®ƒä»¬çš„å‰æéƒ½æ˜¯è¦ä½¿ç”¨åŒä¸€ä¸ªæè´¨ã€‚æ˜¯åŒä¸€ä¸ªï¼Œè€Œä¸æ˜¯ä½¿ç”¨äº†åŒä¸€ç§Shaderçš„æè´¨ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬æŒ‡å‘çš„æè´¨å¿…é¡»æ˜¯åŒä¸€ä¸ªå®ä½“ã€‚è¿™æ„å‘³ç€ï¼Œåªè¦æˆ‘ä»¬è°ƒæ•´äº†å‚æ•°ï¼Œå°±ä¼šå½±å“æ‰€æœ‰ä½¿ç”¨è¿™ä¸ªæè´¨çš„å¯¹è±¡ï¼Œé‚£ä¹ˆæƒ³è¦å¾®å°çš„è°ƒæ•´æ€ä¹ˆåŠï¼Ÿä¸€ç§å¸¸ç”¨çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨ç½‘æ ¼çš„é¡¶ç‚¹ï¼ˆæœ€å¸¸è§çš„å°±æ˜¯é¡¶ç‚¹é¢œè‰²æ•°æ®ï¼‰æ¥å­˜å‚¨è¿™äº›å‚æ•°ã€‚ç»è¿‡æ‰¹å¤„ç†åçš„ç‰©ä½“ä¼šè¢«å¤„ç†æˆæ›´å¤§çš„VBOå‘é€ç»™GPUï¼ŒVBOä¸­çš„æ•°æ®å¯ä»¥ä½œä¸ºè¾“å…¥ä¼ é€’ç»™é¡¶ç‚¹ç€è‰²å™¨ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å·§å¦™åœ°å¯¹VBOä¸­çš„æ•°æ®è¿›è¡Œæ§åˆ¶ï¼Œä»è€Œè¾¾åˆ°ä¸é€šæ•ˆæœçš„ç›®çš„ã€‚ä¸€ä¸ªä¾‹å­æ˜¯ï¼Œæ£®æ—åœºæ™¯ä¸­æ‰€æœ‰çš„æ ‘ä½¿ç”¨äº†åŒä¸€ç§æè´¨ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒä»¬å¯ä»¥é€šè¿‡æ‰¹å¤„ç†æ¥å‡å°‘draw callï¼Œä½†ä¸åŒæ ‘çš„é¢œè‰²å¯èƒ½ä¸åŒã€‚è¿™ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç½‘æ ¼çš„é¡¶ç‚¹çš„é¢œè‰²æ•°æ®æ¥è°ƒæ•´ã€‚ æ‰¹å¤„ç†çš„æ³¨æ„äº‹é¡¹å‡å°‘éœ€è¦å¤„ç†çš„é¡¶ç‚¹æ•°ç›®ä¼˜åŒ–å‡ ä½•ä½“ç§»é™¤ä¸å¿…è¦çš„ç¡¬è¾¹ä»¥åŠçº¹ç†è¡”æ¥ï¼Œé¿å…è¾¹ç•Œå¹³æ»‘å’Œçº¹ç†åˆ†ç¦»ã€‚ æ¨¡å‹çš„LODæŠ€æœ¯é®æŒ¡å‰”é™¤æŠ€æœ¯å‡å°‘éœ€è¦å¤„ç†çš„ç‰‡å…ƒæ•°ç›®æ§åˆ¶ç»˜åˆ¶é¡ºåºæ—¶åˆ»è­¦æƒ•é€æ˜ç‰©ä½“å‡å°‘å®æ—¶å…‰ç…§å’Œé˜´å½±èŠ‚çœå¸¦å®½å‡å°‘çº¹ç†å¤§å° çº¹ç†çš„é•¿å®½æ¯”æœ€å¥½æ˜¯æ­£æ–¹å½¢ï¼Œé•¿å®½å€¼æœ€å¥½æ˜¯2çš„æ•´æ•°å¹‚ å¤šçº§æ¸è¿œçº¹ç†æŠ€æœ¯ï¼ˆmipmappingï¼‰å’Œçº¹ç†å‹ç¼©ã€‚ åˆ©ç”¨åˆ†è¾¨ç‡ç¼©æ”¾å‡å°‘è®¡ç®—å¤æ‚åº¦Shaderçš„LODæŠ€æœ¯ä»£ç æ–¹é¢çš„ä¼˜åŒ–æ ¹æ®ç¡¬ä»¶è¿›è¡Œç¼©æ”¾]]></content>
      <categories>
        <category>Unity Shader</category>
      </categories>
      <tags>
        <tag>Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŸºäºç‰©ç†çš„æ¸²æŸ“]]></title>
    <url>%2F2019%2F04%2F11%2Fphysics-base-render%2F</url>
    <content type="text"><![CDATA[åŒå‘åå°„åˆ†å¸ƒå‡½æ•°ï¼ˆBRDFï¼‰è¾å°„ç‡ï¼ˆradianceï¼‰æ˜¯å•ä½é¢ç§¯ã€å•ä½æ–¹å‘ä¸Šå…‰æºçš„è¾å°„é€šé‡ï¼Œé€šå¸¸ç”¨Lè¡¨ç¤ºï¼Œè¢«è®¤ä¸ºæ˜¯å¯¹å•ä¸€å…‰çº¿çš„äº®åº¦å’Œé¢œè‰²è¯„ä¼°ã€‚åœ¨æ¸²æŸ“ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šåŸºäºè¡¨é¢çš„å…¥å°„å…‰çº¿çš„å…¥å°„è¾å°„ç‡ $ L_i $ æ¥è®¡ç®—å‡ºå°„è¾å°„ç‡ $L_{0}$ ï¼Œè¿™ä¸ªè¿‡ç¨‹å¾€å¾€ä¹Ÿç§°ä¸ºç€è‰²ï¼ˆshadingï¼‰è¿‡ç¨‹ã€‚è€Œè¦å¾—åˆ°å‡ºå°„è¾å°„ç‡$L_{o}$ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ç‰©ä½“è¡¨é¢ä¸€ç‚¹æ˜¯å¦‚ä½•å’Œå…‰è¿›è¡Œäº¤äº’çš„ã€‚è€Œè¿™ä¸ªè¿‡ç¨‹å°±å¯ä»¥ä½¿ç”¨BRDFï¼ˆBidirectional Reflectance Distribution Functionï¼ŒåŒå‘åå°„åˆ†å¸ƒå‡½æ•°ï¼‰æ¥å®šé‡åˆ†æã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒBRDFå¯ä»¥ç”¨$f(I,v)$æ¥è¡¨ç¤ºï¼Œå…¶ä¸­Iä¸ºå…¥å°„æ–¹å‘å’Œvä¸ºè§‚å¯Ÿæ–¹å‘ï¼ˆåŒå‘çš„å«ä¹‰ï¼‰ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œç»•ç€è¡¨é¢æ³•çº¿æ—‹è½¬å…¥å°„æ–¹å‘æˆ–è§‚å¯Ÿæ–¹å‘å¹¶ä¸ä¼šå½±å“BRDFçš„ç»“æœï¼Œè¿™ç§BRDFè¢«ç§°ä¸ºæ˜¯å„é¡¹åŒæ€§ï¼ˆisotropicï¼‰çš„BRDFã€‚ä¸ä¹‹å¯¹åº”çš„åˆ™æ˜¯å„é¡¹å¼‚æ€§ï¼ˆanisotropicï¼‰çš„BRDFã€‚ å…¬å¼å¦‚ä¸‹ï¼š $L_{o}(p,w_{o}) = \int_\Omega(k_{d}{c \over \pi} + k_{s}{DGF \over 4(w_{o} \cdot n)(w_{i} \cdot n)})L_{i}(p,w_{i})(w_{i} \cdot n)dw_{i}$ è¿™æ˜¯PBRçš„æ ¸å¿ƒï¼Œä¹Ÿæ˜¯ä¸»è¦çš„åŠé€€ç‚¹ã€‚ç¿»è¯‘æˆè‡ªç„¶è¯­è¨€ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š $è¾“å‡ºé¢œè‰² = \int_\Omega(æ¼«åå°„æ¯”ä¾‹{çº¹ç†é¢œè‰² \over \pi} + é•œé¢åå°„æ¯”ä¾‹{é•œé¢é«˜å…‰ x å‡ ä½•é®è”½ x è²æ¶…å°”æ•ˆåº” \over 4(view_{Dir} \cdot normal)(lightDir \cdot normal)})å…‰æºé¢œè‰²(lightDir,normal)dw_{i}$ å…ˆè§£é‡Šä¸‹è¿™ä¸ªå…¬å¼é—ç•™çš„éƒ¨åˆ†ã€‚åŠçƒç§¯åˆ†($\int_\Omegaâ€¦â€¦â€¦dw_{i}$) æ”¾ç½®åå°„æ¢é’ˆåœ¨å®æ—¶æ¸²æŸ“ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨Cubemapæ¥æ¨¡æ‹Ÿç‰©ä½“çš„åå°„æ•ˆæœã€‚ä¾‹å¦‚ï¼Œåœ¨èµ›è½¦æ¸¸æˆä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è½¦èº«æˆ–è½¦çª—ä½¿ç”¨åå°„æ˜ å°„çš„æŠ€æœ¯æ¥æ¨¡æ‹Ÿå®ƒä»¬çš„åå…‰æè´¨ã€‚ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬æ°¸è¿œä½¿ç”¨åŒä¸€ä¸ªCubemapï¼Œé‚£ä¹ˆï¼Œå½“èµ›è½¦å‘¨å›´çš„åœºæ™¯å‘ç”Ÿè¾ƒå¤§å˜åŒ–æ—¶ï¼Œå°±å¾ˆå®¹æ˜“å‡ºç°â€œç©¿å¸®é•œå¤´â€ï¼Œå› ä¸ºè½¦èº«æˆ–è½¦çª—çš„ç¯å¢ƒåå°„å¹¶æ²¡æœ‰éšç¯å¢ƒå˜åŒ–è€Œå˜æ¢ã€‚ä¸€ç§è§£å†³åŠæ³•æ˜¯å¯ä»¥åœ¨è„šæœ¬ä¸­æ§åˆ¶ä½•æ—¶ç”Ÿæˆä»å½“å‰ä½ç½®è§‚å¯Ÿåˆ°çš„Cubemapï¼ŒUnityä¸­æä¾›äº†åå°„æ¢é’ˆï¼ˆReflection Probesï¼‰ã€‚åå°„æ¢é’ˆçš„å·¥ä½œåŸç†å’Œå…‰ç…§æ¢é’ˆï¼ˆLight Probesï¼‰ç±»ä¼¼ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨åœºæ™¯ä¸­çš„ç‰¹å®šä½ç½®ä¸Šå¯¹æ•´ä¸ªåœºæ™¯çš„ç¯å¢ƒåå°„è¿›è¡Œé‡‡æ ·ï¼Œå¹¶æŠŠé‡‡æ ·ç»“æœå­˜å‚¨åœ¨æ¯ä¸ªæ¢é’ˆä¸Šã€‚å½“æ¸¸æˆä¸­åŒ…å«åå°„æ•ˆæœçš„ç‰©ä½“ä»è¿™äº›æ¢é’ˆé™„è¿‘ç»è¿‡æ—¶ï¼ŒUnityä¼šæŠŠè¿™äº›é‚»è¿‘æ¢é’ˆå­˜å‚¨çš„åå°„ç»“æœä¼ é€’ç»™ç‰©ä½“ä½¿ç”¨çš„åå°„çº¹ç†ã€‚å¦‚æœç‰©ä½“å‘¨å›´å­˜åœ¨å¤šä¸ªåå°„æ¢é’ˆï¼ŒUnityè¿˜ä¼šåœ¨è¿™äº›åå°„ä¹‹é—´è¿›è¡Œæ’å€¼ï¼Œæ¥å¾—åˆ°å¹³æ»‘æ¸å˜çš„åå°„æ•ˆæœã€‚å®é™…ä¸Šï¼ŒUnityä¼šåœ¨åœºæ™¯ä¸­æ”¾ç½®ä¸€ä¸ªé»˜è®¤çš„åå°„æ¢é’ˆï¼Œè¿™ä¸ªåå°„æ¢é’ˆç²—æ€’è§¦äº†å¯¹åœºæ™¯ä½¿ç”¨çš„Skyboxçš„åå°„ç»“æœï¼Œæ¥ä½œä¸ºåœºæ™¯çš„ç¯å¢ƒå…‰ç…§ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦è®©åœºæ™¯ä¸­çš„ç‰©ä½“åŒ…å«é¢å¤–çš„åå°„æ•ˆæœï¼Œå°±éœ€è¦æ”¾ç½®æ›´å¤šçš„åå°„æ¢é’ˆã€‚åå°„æ¢é’ˆåŒæ ·æœ‰3ç§ç±»å‹ï¼šBakedï¼Œè¿™ç§ç±»å‹çš„åå°„æ¢é’ˆæ˜¯é€šè¿‡æå‰çƒ˜åŸ¹æ¥å¾—åˆ°è¯¥ä½ç½®ä½¿ç”¨çš„Cubemapçš„ï¼Œåœ¨æ¸¸æˆè¿è¡Œæ—¶åå°„æ¢é’ˆä¸­å­˜å‚¨çš„Cubemapå¹¶ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§ç±»å‹çš„åå°„æ¢é’ˆåœ¨çƒ˜åŸ¹æ—¶åŒæ ·åªä¼šå¤„ç†é‚£äº›é™æ€ç‰©ä½“ï¼ˆå³é‚£äº›è¢«æ ‡å¿—ä¸ºReflection Probe Staticçš„ç‰©ä½“ï¼‰ï¼›Realtimeï¼Œè¿™ç§ç±»å‹åˆ™ä¼šå®æ—¶æ›´æ–°å½“å‰çš„Cubemapï¼Œå¹¶ä¸”ä¸å—é™æ€ç‰©ä½“è¿˜æ˜¯åŠ¨æ€ç‰©ä½“çš„å½±å“ã€‚å½“ç„¶ï¼Œè¿™ç§ç±»å‹çš„åå°„æ¢é’ˆéœ€è¦èŠ±è´¹æ›´å¤šçš„å¤„ç†æ—¶é—´ï¼Œå› æ­¤ï¼Œåœ¨ä½¿ç”¨æ—¶åº”å½“éå¸¸å°å¿ƒå®ƒä»¬çš„æ€§èƒ½ã€‚å¹¸è¿çš„æ˜¯ï¼ŒUnityå…è®¸æˆ‘ä»¬ä»è„šæœ¬ä¸­é€šè¿‡è§¦å‘æ¥ç²¾ç¡®æ§åˆ¶åå°„æ¢é’ˆçš„æ›´æ–°ï¼›æœ€åä¸€ç§ç±»å‹æ˜¯Customï¼Œè¿™ç§ç±»å‹çš„æ¢é’ˆå³å¯ä»¥è®©æˆ‘ä»¬ä»ç¼–è¾‘å™¨ä¸­çƒ˜åŸ¹å®ƒï¼Œä¹Ÿå¯ä»¥è®©æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„Cubemapæ¥ä½œä¸ºåå°„æ˜ å°„ï¼Œä½†è‡ªå®šä¹‰çš„Cubemapä¸ä¼šè¢«å®æ—¶æ›´æ–°ã€‚]]></content>
      <categories>
        <category>Unity Shader</category>
      </categories>
      <tags>
        <tag>å›¾å½¢å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬åä¹ç«  æ•ˆæœæ¶æ„(The Effects Framework)]]></title>
    <url>%2F2019%2F04%2F11%2FThe-Effects-Framework%2F</url>
    <content type="text"><![CDATA[æ¦‚è¿°ä¸€ä¸ªæ¸²æŸ“æ•ˆæœä¸€èˆ¬ç”±ä»¥ä¸‹éƒ¨åˆ†ç»„æˆï¼šä¸€ä¸ªé¡¶ç‚¹å’Œ/æˆ–åƒç´ ç€è‰²å™¨ï¼Œä¸€ä¸ªéœ€è¦è®¾ç½®çš„è®¾å¤‡çŠ¶æ€åˆ—è¡¨ï¼Œä¸€ä¸ªæˆ–æ›´å¤šçš„æ¸²æŸ“é€šé“ï¼ˆrendering passesï¼‰ã€‚æ­¤å¤–ï¼Œæœ‰ä¸€ä¸ªèƒ½åœ¨ä¸åŒçº§åˆ«çš„å›¾å½¢ç¡¬ä»¶ä¸Šæ¸²æŸ“æ•ˆæœçš„å¯é æœºåˆ¶é€šå¸¸æ˜¯å€¼å¾—çš„ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰ä¸åŒçš„å¯ç”¨çš„æ•ˆæœç‰ˆæœ¬æ‰§è¡ŒåŒæ ·çš„æ•ˆæœæˆ–å°½å¯èƒ½å°è¯•æ‰§è¡ŒåŒæ ·çš„æ•ˆæœï¼‰ã€‚æ˜¾ç„¶ï¼Œæ‰€æœ‰è¿™äº›å¿…è¦çš„ä»»åŠ¡ç»„åˆåœ¨ä¸€èµ·æˆä¸ºä¸€ä¸ªæ•ˆæœã€‚å› æ­¤ï¼Œä¸€ä¸ªåˆç†çš„åšæ³•æ˜¯ï¼Œè®¾æ³•å°†è¿™äº›ä»»åŠ¡å°è£…åˆ°ä¸€ä¸ªå•å…ƒä¸­ã€‚Direct3Dæ•ˆæœæ„æ¶æä¾›äº†è¿™æ ·ä¸€ä¸ªæœºåˆ¶ï¼šå°†æ¸²æŸ“æ•ˆæœçš„ä»»åŠ¡å°è£…åˆ°ä¸€ä¸ªæ•ˆæœæ–‡ä»¶ã€‚åœ¨æ•ˆæœæ–‡ä»¶ä¸­å®ç°æ•ˆæœæœ‰ä¸¤æ–¹é¢ä¼˜åŠ¿ã€‚å…¶ä¸€ï¼Œå®ƒå…è®¸æˆ‘ä»¬ä¸å¿…é‡ç¼–è¯‘åº”ç”¨ç¨‹åºå°±èƒ½æ”¹å˜ä¸€ä¸ªæ•ˆæœçš„æ‰§è¡Œã€‚è¿™æ˜¯ä¸€ç§æ›´æ–°æ•ˆæœçš„è¿‡ç¨‹ï¼Œä¸ç®¡æ˜¯ä¿®æ­£ä¸€ä¸ªbugï¼Œä¸€äº›ç®€å•çš„åŠ å¼ºï¼Œæˆ–è€…åˆ©ç”¨æœ€æ–°çš„3Dç¡¬ä»¶ç‰¹æ€§ã€‚ç¬¬äºŒï¼Œå®ƒå°†æ‰€æœ‰çš„æ•ˆæœç»„æˆéƒ¨åˆ†å°è£…åˆ°ä¸€ä¸ªæ–‡ä»¶ã€‚è¿™ä¸€ç« æŒ‡å¯¼ä½ ç”¨å¿…è¦ä¿¡æ¯å’Œæ­¥éª¤ï¼Œç¼–å†™å’Œåˆ›å»ºä¸€ä¸ªæ•ˆæœæ–‡ä»¶çš„ã€‚æˆ‘ä»¬æ³¨æ„åˆ°æ•ˆæœæ–‡ä»¶è±¡æˆ‘ä»¬çš„HLSLç¨‹åºä¸€æ ·å¯ä»¥å†™åœ¨ä»»ä½•ASCIIæ–‡ä»¶ä¸­ã€‚ ç›®æ ‡ ç†è§£ä¸€ä¸ªæ•ˆæœæ–‡ä»¶çš„ç»“æ„å’Œç»„ç»‡ æ‰¾åˆ°HLSLä¸­çš„ä¸€äº›é¢å¤–çš„å¯¹è±¡ å­¦ä¹ å¦‚ä½•åœ¨æ•ˆæœæ–‡ä»¶ä¸­æŒ‡å®šè®¾å¤‡çŠ¶æ€ å­¦ä¹ å¦‚ä½•åˆ›å»ºå¹¶ä½¿ç”¨ä¸€ä¸ªæ•ˆæœ é€šè¿‡å­¦ä¹ ä¸€äº›ä¾‹å­ç¨‹åºï¼Œå–å¾—ä½¿ç”¨æ•ˆæœæ¡†æ¶ä¸Šçš„ä¸€äº›ç»éªŒæŠ€æœ¯ä¸ä¼ é€’ï¼ˆTechniques and Passesï¼‰ä¸€ä¸ªæ•ˆæœæ–‡ä»¶ç”±ä¸€ä¸ªæˆ–å¤šä¸ªæŠ€æœ¯ç»„æˆã€‚ä¸€ä¸ªæŠ€æœ¯æ˜¯ç”¨ä¸€ä¸ªç‰¹æ®Šçš„æ–¹æ³•æ¸²æŸ“ä¸€äº›ç‰¹æ•ˆã€‚æ‰€ä»¥æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªæ•ˆæœæ–‡ä»¶æä¾›äº†æ¸²æŸ“ç›¸åŒç‰¹æ•ˆçš„ä¸€ä¸ªæˆ–å¤šä¸ªä¸åŒçš„ä¼ é€’ã€‚ä¸ºä»€ä¹ˆåŒæ ·çš„æ•ˆæœéœ€è¦å‡ ä¸ªä¸åŒå®ç°å‘¢ï¼Ÿæ˜¯çš„ï¼Œä¸€äº›ç¡¬ä»¶å¯èƒ½ä¸æ”¯æŒä¸€ä¸ªæ•ˆæœçš„ä¸€ç§ç‰¹å®šå®ç°ã€‚å› æ­¤ï¼Œå¿…éœ€åœ¨ä¸åŒç¡¬ä»¶ä¸Šå®ç°ç›¸åŒæ•ˆæœçš„ä¸åŒç‰ˆæœ¬ã€‚æ³¨æ„ï¼šä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½å®ç°ä¸€ç§æ•ˆæœçš„ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¸€ç§ç”¨ç€è‰²å™¨å®ç°è€Œä¸€ç§ç”¨å›ºå®šç®¡çº¿å®ç°ã€‚è¿™æ ·ï¼Œé‚£äº›æœ‰ç€è‰²å™¨ï¼ˆshaderï¼‰æ”¯æŒçš„æ˜¾å¡ç”¨æˆ·èƒ½å¤Ÿåˆ©ç”¨ç€è‰²å™¨å®ç°ï¼Œè€Œé‚£äº›ä¸æ”¯æŒç€è‰²å™¨çš„ç”¨æˆ·ä»ç„¶å¯ä»¥ä½¿ç”¨å›ºå®šç®¡çº¿å®ç°ã€‚å¯ä»¥åœ¨ä¸€ä¸ªæ•ˆæœæ–‡ä»¶ä¸­å®ç°æ‰€æœ‰ç‰ˆæœ¬çš„æ•ˆæœï¼Œè¿™è®©æˆ‘ä»¬æ›´å®Œæ•´çš„å°è£…äº†æ‰€æœ‰çš„æ•ˆæœï¼Œä¹Ÿæ˜¯æ•ˆæœæ¡†æ¶çš„ç›®æ ‡ä¹‹ä¸€ â€•â€• å°è£…ï¼ˆencapsulationï¼‰ã€‚æ¯ç§æŠ€æœ¯åŒ…æ‹¬ä¸€æ¬¡æˆ–å¤šæ¬¡æ¸²æŸ“ä¼ é€’ï¼ˆpassesï¼‰ã€‚ä¸€æ¬¡æ¸²æŸ“ä¼ é€’ï¼ˆrendering passï¼‰åœ¨ç‰¹å®šä¼ é€’ï¼ˆpassï¼‰ä¸­å°è£…äº†è®¾å¤‡çŠ¶æ€ã€é‡‡æ ·å™¨ã€å’Œ/æˆ–ç”¨äºæ¸²æŸ“å‡ ä½•ä½“çš„ç€è‰²å™¨ã€‚æ³¨æ„ï¼šä¸€ä¸ªæ•ˆæœä¸ä»…é™äºå¯ç¼–ç¨‹ç®¡çº¿ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯ä»¥ä½¿ç”¨å›ºå®šåŠŸèƒ½ç®¡çº¿æ§åˆ¶è®¾å¤‡çŠ¶æ€ï¼Œæ¯”å¦‚ç¯å…‰ã€æè´¨ä»¥åŠçº¹ç†ã€‚ä½¿ç”¨å¤šæ¬¡ä¼ é€’ï¼ˆmultiple passesï¼‰çš„ç†ç”±æ˜¯ï¼Œå› ä¸ºå¯¹æ¯ç§ç‰¹æ•ˆï¼Œæ˜¯é€šè¿‡ä½¿ç”¨ä¸åŒçš„è®¾å¤‡çŠ¶æ€ã€ç€è‰²å™¨ç­‰ç­‰ï¼Œå¯¹åŒæ ·çš„å‡ ä½•ä½“è¿›è¡Œå¤šæ¬¡æ¸²æŸ“æ¥å®Œæˆçš„ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå›å¿†ç¬¬8ç«  ï¼Œæˆ‘ä»¬ä¸å¾—ä¸åœ¨æ¯å¸§é‡Œç”¨ä¸åŒçš„è®¾å¤‡çŠ¶æ€ã€å¤šæ¬¡æ¸²æŸ“ç›¸åŒçš„å‡ ä½•ä½“ï¼Œä»¥è¾¾åˆ°åå°„æ•ˆæœã€‚ è¿™ä¸ªä¾‹å­ï¼Œæ˜¯ä¸€ä¸ªç”¨ä¸¤ç§æŠ€æœ¯å®ç°çš„æ•ˆæœæ–‡ä»¶çš„æ¡†æ¶ï¼Œç¬¬ä¸€ç§æŠ€æœ¯åŒ…æ‹¬ä¸€æ¬¡ä¼ é€’è€Œæ¯äºŒç§æŠ€æœ¯åŒ…æ‹¬ä¸¤æ¬¡ä¼ é€’:12345678910111213141516171819202122232425// effect.txttechnique T0&#123; // first and only pass for this technique pass P0 &#123; [specify pass device states, shaders, samplers, etc.] &#125;&#125;technique T1&#123; // first pass pass P0 &#123; [specify pass device states, shaders, samplers, etc.] &#125; // second pass pass P1 &#123; [specify pass device states, shaders, samplers, etc.] &#125;&#125; æ›´å¤šHLSLå†…ç½®å¯¹è±¡ï¼ˆ More HLSL Intrinsic Objectsï¼‰è¿™æ˜¯ä¸€äº›åœ¨HLSLä¸­é¢å¤–çš„å†…å»ºå¯¹è±¡ç±»å‹ã€‚æˆ‘ä»¬ä»¥å‰æ²¡æœ‰è¿‡æ—©çš„æåŠï¼Œæ˜¯å› ä¸ºå®ƒä»¬ä¸»è¦ç”¨äºæ•ˆæœæ¡†æ¶ã€‚ çº¹ç†å¯¹è±¡ HLSLå†…å»ºçº¹ç†ç±»å‹æè¿°äº†ä¸€ä¸ªIDirect3DTexture9å¯¹è±¡ã€‚é€šè¿‡ä½¿ç”¨çº¹ç†å¯¹è±¡æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ°åœ¨æ•ˆæœæ–‡ä»¶ä¸­å¯¹ç‰¹å®šçš„é‡‡æ ·å™¨é˜¶æ®µç»“åˆçº¹ç†ã€‚çº¹ç†å¯¹è±¡æœ‰ä¸‹é¢çš„å¯ä»¥è®¿é—®çš„æ•°æ®æˆå‘˜ï¼š typeâ€”çº¹ç†ç±»å‹ (ä¾‹å¦‚ï¼š2D, 3D) formatâ€”çº¹ç†çš„åƒç´ æ ¼å¼ widthâ€”çº¹ç†çš„å®½åº¦ï¼ˆå•ä½åƒç´ ï¼‰ heightâ€”çº¹ç†çš„é«˜åº¦ï¼ˆå•ä½åƒç´ ï¼‰ depthâ€”çº¹ç†çš„æ·±åº¦ï¼ˆå¦‚æœæ˜¯3Dçº¹ç†ï¼Œå•ä½åƒç´ ï¼‰ æ³¨æ„ï¼šè¿„ä»Šä¸ºæ­¢æˆ‘ä»¬ä»…ä»…ä½¿ç”¨çº¹ç†æ¥å­˜è´®å›¾å½¢æ•°æ®ï¼Œä½†æ˜¯å½“ä½ å­¦åˆ°æ›´é«˜çº§çš„æŠ€æœ¯ï¼Œä½ ä¼šå‘ç°çº¹ç†å¯ç”¨æ¥ä¿å­˜ä»»æ„è¡¨æ ¼ä¿¡æ¯ã€‚æ¢å¥è¯è¯´ï¼Œçº¹ç†ä»…æ˜¯æ•°æ®è¡¨ï¼Œä¸æ˜¯å¿…é¡»åŒ…å«å›¾å½¢æ•°æ®ã€‚ä¾‹å¦‚ï¼Œåœ¨ç¢°æ’æ˜ å°„ï¼ˆbump mappingï¼‰æ—¶æˆ‘ä»¬ç”¨åˆ°ä¸€ç§å«åšæ³•çº¿å›¾çš„ä¸œä¸œï¼ˆnormal mapï¼‰ï¼Œå°±æ˜¯ä¸€ç§åœ¨æ¯ä¸ªç‚¹ä¸ŠåŒ…æ‹¬äº†æ³•å‘é‡çš„çº¹ç†ã€‚ é‡‡æ ·å™¨å¯¹è±¡ä¸é‡‡æ ·å™¨çŠ¶æ€æˆ‘ä»¬åœ¨18ç« è®¨è®ºäº†é‡‡æ ·å™¨å¯¹è±¡ï¼Œç„¶è€Œï¼Œæ•ˆæœæ¡†æ¶å®šä¹‰äº†æ–°çš„å…³é”®å­—ï¼šsampler_stateã€‚ä½¿ç”¨sampler_stateå…³é”®å­—ï¼Œæˆ‘ä»¬èƒ½åˆå§‹åŒ–ä¸€ä¸ªé‡‡æ ·å™¨å¯¹è±¡ï¼ˆå³ï¼Œç›´æ¥åœ¨æ•ˆæœæ–¹ä»¶ä¸­è®¾ç½®é‡‡æ ·å™¨å¯¹è±¡çš„çº¹ç†å’ŒçŠ¶æ€ï¼‰ã€‚ä¸‹é¢çš„ä¾‹å­è¯´æ˜äº†è¿™ç‚¹ï¼š12345678910Texture Tex;sampler SO = sampler_state&#123; Texture = (Tex); // çº¹ç† // é‡‡æ ·å™¨çŠ¶æ€ MinFilter = LINEAR; MagFilter = LINEAR; MipFilter = LINEAR;&#125;; è¿™é‡Œæˆ‘ä»¬ç»™é‡‡æ ·å™¨S0çš„textureæˆå‘˜å…³è”äº†çº¹ç† Texï¼Œå¹¶ç»™çŠ¶æ€æˆå‘˜è®¾ç½®äº†é‡‡æ ·çŠ¶æ€ã€‚æˆ‘ä»¬ç›´æ¥æ˜äº†çš„åœ¨æ•ˆæœæ–‡ä»¶ä¸­è®¾ç½®æ‰€æœ‰ä¿¡æ¯ã€‚ é¡¶ç‚¹ä¸åƒç´ ç€è‰²å™¨å¯¹è±¡ï¼ˆVertex and Pixel Shader Objectsï¼‰vertexshader å’Œ pixelshaderæ˜¯HLSLçš„å†…å»ºç±»å‹ï¼Œåˆ†åˆ«è¡¨ç¤ºé¡¶ç‚¹ç€è‰²å™¨å’Œåƒç´ ç€è‰²å™¨ã€‚å®ƒä»¬åœ¨æ•ˆæœæ–‡ä»¶ä¸­è¡¨ç¤ºç‰¹å®šé¡¶ç‚¹å’Œ/æˆ–åƒç´ ç€è‰²å™¨ï¼Œç”¨äºä¸€ä¸ªç‰¹å®šçš„æ¸²æŸ“ä¼ é€’(pass)ã€‚vertexshaderå’Œ/æˆ–pixelshaderç±»å‹åœ¨åº”ç”¨ç¨‹åºä¸­ç”¨ID3DXEffect::SetVertexShaderå’ŒID3DXEffect::SetPixelShaderå‡½æ•°åˆ†åˆ«è®¾ç½®ã€‚ä¾‹å¦‚ï¼Œåœ¨æ•ˆæœæ–‡ä»¶ä¸­ï¼Œè®©Effectæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ID3DXEffectå¯¹è±¡ï¼Œè®©VSæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„IDirect3DVertexShader9å¯¹è±¡ï¼Œä»¥åŠè®©VSHandleæ˜¯ä¸€ä¸ªD3DXHANDLEï¼ˆæ˜¯vertexshader å¯¹è±¡çš„å¼•ç”¨ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹å†™æ³•åˆå§‹åŒ–VSHandleæ‰€å¼•ç”¨çš„é¡¶ç‚¹ç€è‰²å™¨ï¼šEffect-&gt;SetVertexShader(VSHandle, VS);å½“åœ¨åº”ç”¨ç¨‹åºä¸­è®¾ç½®æ•ˆæœæ–‡ä»¶ä¸­çš„å˜é‡æ—¶ï¼Œå¤šæ•°æ—¶å€™æˆ‘ä»¬ä½¿ç”¨SetVertexShader å’Œ SetPixelShaderã€‚åšä¸ºé€‰æ‹©ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æ•ˆæœæ–‡ä»¶ä¸­å†™é¡¶ç‚¹å’Œ/æˆ–åƒç´ ç€è‰²å™¨ã€‚å½“ä½¿ç”¨ä¸€ç§ç‰¹å®šçš„ç¼–è¯‘è¯­æ³•æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªç€è‰²å™¨å˜é‡ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•åˆå§‹åŒ–ä¸€ä¸ªpixelshaderç±»å‹çš„å˜é‡psã€‚12345// å®šä¹‰å…¥å£å‡½æ•°OUTPUT Main(INPUT input)&#123;...&#125;// ç¼–è¯‘å…¥å£å‡½æ•°pixelshader ps = compile ps_2_0 Main(); è§‚å¯Ÿåœ¨pixelshaderå…³é”®å­—ä¹‹åçš„ç‰¹å®šçš„ç‰ˆæœ¬åï¼Œæ¥ä¸‹æ¥æ˜¯ç€è‰²å™¨å…¥å£å‡½æ•°ã€‚æ³¨æ„ï¼Œå½“ç”¨è¿™ç§æ–¹å¼ï¼ˆstyleï¼‰åˆå§‹åŒ–ä¸€ä¸ªé¡¶ç‚¹æˆ–åƒç´ ç€è‰²å™¨å¯¹è±¡æ—¶ï¼Œå…¥å£å‡½æ•°å¿…é¡»å®šä¹‰åœ¨æ•ˆæœæ–‡ä»¶ä¸­ã€‚ æœ€åï¼Œæˆ‘ä»¬ç»™ä¸€ä¸ªç‰¹å®šä¼ é€’å…³è”ä¸€ä¸ªç€è‰²å™¨ï¼Œå¦‚ä¸‹ï¼š123456789101112// å®šä¹‰å…¥å£å‡½æ•°OUTPUT Main(INPUT input)&#123;...&#125;// ç¼–è¯‘å…¥å£å‡½æ•°vertexshader vs = compile vs_2_0 Main();pass P0&#123; // ç»™è¿™ä¸ªä¼ é€’ï¼ˆpassï¼‰å…³è”ä¸€ä¸ªç€è‰²å™¨ï¼ˆvsï¼‰ vertexshader = (vs); ...&#125; æˆ–è€…æ›´ç®€æ´çš„ï¼š123456pass P0&#123; // è®¾ç½®è¿™ä¸ªä¼ é€’çš„é¡¶ç‚¹ç€è‰²å™¨ï¼Œä¸ºå…¥å£å‡½æ•°" Main()"çš„é¡¶ç‚¹ç€è‰²å™¨ vertexshader = compile vs_2_0 Main(); ...&#125; æ³¨æ„ï¼šè¿™æ˜¯ä¸€ä¸ªç›¸å½“æœ‰ä»·å€¼çš„è®ºè¿°ï¼Œå› æ­¤ä½ è‡³å°‘è¦æ˜ç™½ï¼Œä½ èƒ½ç”¨è¿™æ ·çš„è¯­æ³•æ¥åˆå§‹åŒ–ä¸€ä¸ªvertexshader å’Œ pixelshader ç±»å‹ï¼š12vertexshader vs = asm &#123; /*assembly instructions go here */ &#125;;pixelshader ps = asm &#123; /*assembly instructions go here */ &#125;; å¦‚æœä½ ç”¨æ±‡ç¼–è¯­è¨€æ¥å†™ç€è‰²å™¨ï¼Œä½ å°±ç”¨è¿™ç§è¯­æ³•ã€‚ å­—ç¬¦ä¸²æœ€åï¼Œè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œå®ƒçš„ç”¨æ³•æ˜¯è¿™æ ·åœ°ï¼š1string filename = "texName.bmp"; å°½ç®¡æ²¡æœ‰ä»»ä½•HLSLçš„å†…å»ºå‡½æ•°æ”¯æŒå­—ç¬¦ä¸²ç±»å‹ï¼Œä½†å®ƒå¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­è¯»å–ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬èƒ½è¿›ä¸€æ­¥å°è£…æ•ˆæœä½¿ç”¨çš„æ•°æ®æ–‡ä»¶ï¼Œæ¯”å¦‚çº¹ç†æ–‡ä»¶åå’ŒXæ–‡ä»¶å­—ã€‚ æ³¨è§£ (Annotations)é™¤æˆ‘ä»¬å·²ç»æè¿°è¿‡çš„è¯­ä¹‰ç¬¦ä¹‹å¤–ï¼Œæ³¨è§£å¯ä»¥ç”¨åœ¨å˜é‡ä¸Šã€‚æ³¨è§£åœ¨HLSLä¸­æ˜¯ä¸ä½¿ç”¨çš„ï¼Œä½†æ˜¯å®ƒä»¬å¯ä»¥è¢«åº”ç”¨ç¨‹åºé€šè¿‡æ•ˆæœæ¡†æ¶è®¿é—®ã€‚å®ƒä»¬ä»…ä»…æœåŠ¡äºä¸€ä¸ªç»‘å®š â€œnoteâ€çš„å˜é‡ï¼Œè¿™æ ·åº”ç”¨ç¨‹åºå°±èƒ½å¤Ÿè®¿é—®è¿™ä¸ªå˜é‡äº†ã€‚ä¸ºæ³¨è§£åŠ å…¥äº†è¯­æ³•ã€‚ä¸‹é¢ä¸€è¡Œä¸¾ä¾‹è¯´æ˜ï¼š1texture tex0 &lt; string name = "tiger.bmp"; &gt;; åœ¨è¿™ä¸ªä¾‹å­ä¸­çš„æ³¨è§£æ˜¯ã€‚å®ƒå…³è”äº†ä¸€ä¸ªå­—ç¬¦ä¸²åˆ°å˜é‡tex0ï¼Œå³ä¿å­˜çº¹ç†æ•°æ®çš„æ–‡ä»¶åã€‚å¾ˆæ˜æ˜¾ï¼Œç”¨ç›¸åº”çš„æ–‡ä»¶åæ³¨è§£ä¸€ä¸ªçº¹ç†æ˜¯æœ‰ç›Šçš„ã€‚æ³¨è§£å¯ä»¥ä½¿ç”¨ä¸‹é¢å‡½æ•°è¢«é‡æ–°å¾—åˆ°ï¼š1234D3DXHANDLE ID3DXEffect::GetAnnotationByName( D3DXHANDLE hObject, LPCSTR pName); pNameæ˜¯æˆ‘ä»¬è¦æ“ä½œçš„æ³¨è§£çš„åå­—ï¼Œè€ŒhObjectæ˜¯æ³¨è§£æ‰€åœ¨çš„çˆ¶å—å¥æŸ„ï¼Œå¦‚ä¸€ä¸ªtechniqueã€passæˆ–è€…ç»“æ„å—ã€‚ä¸€æ—¦æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæ³¨è§£çš„å¥æŸ„ï¼Œæˆ‘ä»¬å°±èƒ½é€šè¿‡åº”ç”¨ID3DXEffect::GetParameterDescå¾—åˆ°æœ‰å…³å®ƒçš„ä¿¡æ¯ã€‚æŸ¥çœ‹DirectX SDKæ–‡æ¡£ä»¥å¾—åˆ°æ›´å¤šè¯¦ç»†çš„å†…å®¹ã€‚ æ•ˆæœæ–‡ä»¶çš„è®¾å¤‡çŠ¶æ€ï¼ˆ Device States in an Effect Fileï¼‰é€šå¸¸ï¼Œä¸ºäº†æ­£ç¡®æ‰§è¡Œä¸€ä¸ªæ•ˆæœï¼Œæˆ‘ä»¬å¿…é¡»è®¾ç½®è®¾å¤‡çš„çŠ¶æ€ï¼Œæ¯”å¦‚æ¸²æŸ“çŠ¶æ€ã€çº¹ç†çŠ¶æ€ã€æè´¨ã€ç¯å…‰å’Œçº¹ç†ã€‚å°†å…¨éƒ¨æ•ˆæœå°è£…è¿›ä¸€ä¸ªæ–‡ä»¶ä½¿å®ƒæœ‰æ”¯æŒå…¨éƒ¨æ•ˆæœçš„èƒ½åŠ›ï¼Œæ•ˆæœæ¡†æ¶å…è®¸æˆ‘ä»¬åœ¨æ•ˆæœæ–‡ä»¶ä¸­è®¾ç½®è®¾å¤‡çŠ¶æ€ã€‚è®¾å¤‡çŠ¶æ€è¢«åœ¨æ¸²æŸ“çš„ä¼ é€’éƒ¨åˆ†ï¼ˆpass blockï¼‰é‡Œè®¾ç½®ï¼Œè¯­æ³•çœ‹èµ·æ¥è±¡è¿™æ ·ï¼šState= Value;å¯¹äºå®Œæ•´çš„çŠ¶æ€çš„åˆ—è¡¨ï¼Œåœ¨DirectX SDKæ–‡æ¡£çš„ç´¢å¼•ï¼ˆindexï¼‰ä¸­æŸ¥æ‰¾â€statesâ€ï¼Œæˆ–è€…ä»SDKçš„ç›®å½•ï¼ˆContentsï¼‰æ ‡ç­¾ä¸‹ï¼ŒæŸ¥æ‰¾DirectX Graphics\Reference\Effect Reference\Effect Format\Statesè€ƒè™‘FillModeçŠ¶æ€ã€‚å¦‚æœä½ çœ‹äº†ä¸€ä¸‹åˆšåˆšæåˆ°çš„SDKä¸­çš„å†…å®¹ï¼Œå€¼ä¸D3DFILLMODEä¸€æ ·ï¼Œä½†æ²¡æœ‰D3DFILL_å‰ç¼€ã€‚å¦‚æœæˆ‘ä»¬åœ¨SDKæ–‡æ¡£ä¸­æŸ¥æ‰¾D3DFILLMODEï¼Œæˆ‘ä»¬æ‰¾åˆ°å€¼ï¼šD3DFILL_POINT, D3DFILL_WIREFRAME, and D3DFILL_SOLIDã€‚å› è€Œï¼Œå¯¹äºæ•ˆæœæ–‡ä»¶æˆ‘ä»¬çœç•¥äº†å‰ç¼€ï¼Œå¹¶è·å¾—ä¸‹åˆ—çŠ¶æ€FillModeçš„æœ‰æ•ˆå€¼ï¼šPOINT, WIREFRAME, å’Œ SOLIDã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥åœ¨æ•ˆæœæ–‡ä»¶ä¸­è¿™ä¹ˆå†™-ï¼š123FillMode = WIREFRAME;FillMode = POINT;FillMode = SOLID; æ³¨æ„ï¼šåœ¨åé¢çš„å°èŠ‚ä¸­æˆ‘ä»¬å°†åœ¨ä¾‹å­ç¨‹åºä¸­è®¾ç½®å‡ ä¸ªè®¾å¤‡çŠ¶æ€ã€‚å¤šæ•°æ—¶å€™èƒ½å¤Ÿé€šè¿‡çŠ¶æ€çš„åå­—çŒœåˆ°å®ƒçš„ç”¨é€”ï¼Œä½†å¦‚æœä½ æƒ³å¾—åˆ°æ›´è¯¦ç»†çš„æè¿°ï¼Œè¯·æŸ¥çœ‹SDKæ–‡æ¡£ã€‚ åˆ›å»ºæ•ˆæœæ•ˆæœç”¨ID3DXEffectæ¥å£è¡¨ç¤ºï¼Œæˆ‘ä»¬ç”¨ä¸‹é¢çš„D3DXå‡½æ•°åˆ›å»ºå®ƒï¼š 12345678910HRESULT D3DXCreateEffectFromFile( LPDIRECT3DDEVICE9 pDevice, LPCSTR pSrcFile, CONST D3DXMACRO* pDefines, LPD3DXINCLUDE pInclude, DWORD Flags, LPD3DXEFFECTPOOL pPool, LPD3DXEFFECT* ppEffect, LPD3DXBUFFER *ppCompilationErrors); pDeviceâ€”è¢«åˆ›å»ºçš„ID3DXEffectå¯¹è±¡æ‰€å…³è”çš„è®¾å¤‡ pSrcFileâ€”æˆ‘ä»¬è¦ç¼–è¯‘çš„åŒ…æ‹¬æ•ˆæœæºä»£ç çš„æ–‡æœ¬æ–‡ä»¶çš„åå­—ï¼ˆæ•ˆæœæ–‡ä»¶åï¼‰ pDefinesâ€”è¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œåœ¨æœ¬ä¹¦ä¸­æŒ‡å®šä¸ºnull pIncludeâ€”ID3DXIncludeæ¥å£æŒ‡é’ˆã€‚è¿™ä¸ªæ¥å£è¢«è®¾è®¡æˆç”±åº”ç”¨ç¨‹åºæ‰§è¡Œï¼Œå› è€Œæˆ‘ä»¬å¯ä»¥æ›¿æ¢é»˜è®¤è¡Œä¸ºã€‚é€šå¸¸ï¼Œé»˜è®¤è¡Œä¸ºå°±æŒºå¥½ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šnullå¿½ç•¥è¿™ä¸ªå‚æ•°ã€‚ Flagsâ€”ç¼–è¯‘æ•ˆæœæ–‡ä»¶ä¸­çš„shaderçš„é€‰é¡¹æ ‡å¿—ï¼ŒæŒ‡å®š0ä¸ºæ²¡æœ‰æ ‡å¿—ã€‚æœ‰æ•ˆé€‰é¡¹ä¸ºï¼šo D3DXSHADER_DEBUGâ€”æŒ‡ç¤ºç¼–è¯‘å™¨å†™å…¥è°ƒè¯•ä¿¡æ¯o D3DXSHADER_SKIPVALIDATIONâ€”æŒ‡ç¤ºç¼–è¯‘å™¨ä¸åšä»»ä½•ä»£ç æ£€æµ‹ã€‚è¿™åªåœ¨ä½ æ­£åœ¨ç”¨åˆ°ä¸€ä¸ªå·²çŸ¥æ­£å¸¸å·¥ä½œçš„shaderæ—¶ä½¿ç”¨ã€‚o D3DXSHADER_SKIPOPTIMIZATIONâ€”æŒ‡ç¤ºç¼–è¯‘å™¨ä¸æ‰§è¡Œä»»ä½•ä¼˜åŒ–ã€‚å®é™…ä¸Šè¿™åªç”¨äºè°ƒè¯•æ—¶ï¼Œå½“ä½ ä¸æƒ³è®©ç¼–è¯‘å™¨å¯¹ä»£ç åšä»»ä½•æ›´æ”¹æ—¶ã€‚ pPoolâ€”å¯é€‰çš„ID3DXEffectPoolæ¥å£æŒ‡é’ˆï¼Œç”¨äºæŒ‡å®šæ•ˆæœå‚æ•°å¦‚ä½•å…±äº«å…¶å®ƒçš„æ•ˆæœå®ä¾‹ã€‚æœ¬ä¾‹ä¸­æŒ‡å®šnullï¼Œè¡¨ç¤ºæˆ‘ä»¬ä¸åœ¨å‚æ•°ä¸æ•ˆæœæ–‡ä»¶ä¹‹é—´å…±äº«ã€‚ ppEffectâ€”è¿”å›ä¸€ä¸ªID3DXEffectæ¥å£æŒ‡é’ˆï¼Œè¡¨ç¤ºè¢«åˆ›å»ºçš„æ•ˆæœã€‚ ppCompilationErrorsâ€”è¿”å›ä¸€ä¸ªåŒ…å«é”™è¯¯ä»£ç å­—ç¬¦ä¸²å’Œæ¶ˆæ¯çš„ID3DXBufferæŒ‡é’ˆã€‚ è¿™æ˜¯ä¸€ä¸ªè°ƒç”¨D3DXCreateEffectFromFileçš„ä¾‹å­ï¼š12345678910111213141516171819202122232425// ä¿®å»ºæ•ˆæœID3DXEffect* Effect = 0;ID3DXBuffer* errorBuffer = 0;hr = D3DXCreateEffectFromFile( Device, // å…³è”çš„è®¾å¤‡ "effect.txt", // æ•ˆæœæºæ–‡ä»¶ 0, // no preprocessor definitions 0, // no ID3DXInclude interface D3DXSHADER DEBUG, // ç¼–è¯‘æ ‡è®° 0, // ä¸å…±äº«å‚æ•° &amp;Effect, // è¿”å›åˆ›å»ºæ•ˆæœçš„æŒ‡é’ˆ &amp;errorBuffer); // è¿”å›çš„é”™è¯¯ä¿¡æ¯// è¾“å‡ºé”™è¯¯ä¿¡æ¯if( errorBuffer )&#123; ::MessageBox(0, (char*)errorBuffer-&gt;GetBufferPointer(), 0, 0); d3d::Release&lt;ID3DXBuffer*&gt;(errorBuffer);&#125;if (FAILED(hr))&#123; ::MessageBox(0, "D3DXCreateEffectFromFile() - FAILED", 0, 0); return false;&#125; è®¾ç½®ç³»æ•°ï¼ˆSetting Constantsï¼‰å› ä¸ºå¯¹äºé¡¶ç‚¹å’Œåƒç´ ç€è‰²å™¨ï¼Œæˆ‘ä»¬éœ€è¦ä»ç¨‹åºä»£ç ä¸­åˆå§‹åŒ–æ•ˆæœæ–‡ä»¶ä¸­çš„å˜é‡ã€‚ä»£æ›¿ä½¿ç”¨å¸¸é‡è¡¨ï¼Œå°±è±¡æˆ‘ä»¬åœ¨é¡¶ç‚¹å’Œåƒç´ ç€è‰²å™¨ä¸­åšçš„é‚£æ ·ï¼ŒID3DXEffectæ¥å£ä¸­æœ‰å†…å»ºçš„è®¾ç½®å˜é‡çš„æ–¹æ³•ã€‚æˆ‘ä»¬è¿™é‡Œä¸ä¼šåˆ—å‡ºæ‰€æœ‰çš„è®¾ç½®ä¸åŒç±»å‹å˜é‡çš„æ–¹æ³•ï¼Œå› ä¸ºè¦å®Œå…¨åˆ—å‡ºå®åœ¨æ˜¯å¤§å¤šäº†â€”è¯·æŸ¥çœ‹DirectX SDKæ–‡æ¡£ä»¥è·å¾—å®Œæ•´åˆ—è¡¨ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªåˆ èŠ‚çš„åˆ—è¡¨ï¼š123456789101112131415161718192021222324252627282930313233343536HRESULT ID3DXEffect::SetFloat( D3DXHANDLE hParameter, FLOAT f);Sets a floating-point variable in the effect file identified by hParameter to the value f HRESULT ID3DXEffect::SetMatrix( D3DXHANDLE hParameter, CONST D3DXMATRIX* pMatrix);Sets a matrix variable in the effect file identified by hParameter to the value pointed to by pMatrix HRESULT ID3DXEffect::SetString( D3DXHANDLE hParameter, CONST LPCSTR pString);Sets a matrix variable in the effect file identified by hParameter to the value pointed to by pString HRESULT ID3DXEffect::SetTexture( D3DXHANDLE hParameter, LPDIRECT3DBASETEXTURE9 pTexture);Sets a texture variable in the effect file identified by hParameter to the value pointed to by pTexture HRESULT ID3DXEffect::SetVector( D3DXHANDLE hParameter, CONST D3DXVECTOR4* pVector);Sets a vector variable in the effect file identified by hParameter to the value pointed to by pVector HRESULT ID3DXEffect::SetVertexShader( D3DXHANDLE hParameter, LPDIRECT3DVERTEXSHADER9 pVertexShader);Sets a vertex shader variable in the effect file identified by hParameter to the value pointed to by pVertexShader HRESULT ID3DXEffect::SetPixelShader( D3DXHANDLE hParameter, LPDIRECT3DPIXELSHADER9 pPShader);Sets a pixel shader variable in the effect file identified by hParameter to the value pointed to by pPShader æˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„æ–¹æ³•å¾—åˆ°å˜é‡ï¼ˆåˆå«æ•ˆæœå‚æ•°effect parametersï¼‰å¥æŸ„ï¼š1234D3DXHANDLE ID3DXEffect::GetParameterByName( D3DXHANDLE hParent, // scope of variable - parent structure LPCSTR pName // name of variable); å®ƒçš„ç”¨æ³•ä¸D3DXConstantTable::GetConstantByNameæ–¹æ³•ä¸€æ ·ã€‚å³æ¯ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªD3DXHANDLEï¼Œå®ƒæ ‡è¯†æˆ‘ä»¬æƒ³å¾—åˆ°çš„åœ¨å“ªä¸ªçˆ¶ç»“æ„ä¸­çš„å˜é‡å¥æŸ„ã€‚å¯¹äºæ²¡æœ‰çˆ¶ç»“æ„çš„å…¨å±€å˜é‡ï¼Œæˆ‘ä»¬æŒ‡å®šnullã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯åœ¨æ•ˆæœæ–‡ä»¶ä¸­æ‰€æ˜¾ç¤ºçš„å˜é‡åã€‚åšä¸ºä¾‹å­ï¼Œä»¥ä¸‹æ˜¾ç¤ºå¦‚ä½•è®¾ç½®æ•ˆæœæ–‡ä»¶ä¸­çš„ä¸€äº›å˜é‡ï¼š123456789101112131415161718// some data to setD3DXMATRIX M;D3DXMatrixIdentity(&amp;M);D3DXVECTOR4 color(1.0f, 0.0f, 1.0f, 1.0f);IDirect3DTexture9* tex = 0;D3DXCreateTextureFromFile(Device, "shade.bmp", &amp;tex);// get handles to parametersD3DXHANDLE MatrixHandle = Effect-&gt;GetParameterByName(0, "Matrix");D3DXHANDLE MtrlHandle = Effect-&gt;GetParameterByName(0, "Mtrl");D3DXHANDLE TexHandle = Effect-&gt;GetParameterByName(0, "Tex");// set parametersEffect-&gt;SetMatrix(MatrixHandle, &amp;M);Effect-&gt;SetVector(MtrlHandle, &amp;color);Effect-&gt;SetTexture(TexHandle, tex); æ³¨æ„ï¼šå¯¹æ¯ä¸€ä¸ªID3DXEffect::Setæ–¹æ³•éƒ½æœ‰ç›¸åº”çš„ID3DXEffect::Getæ–¹æ³•ç”¨æ¥å–å¾—æ•ˆæœæ–‡ä»¶ä¸­çš„å˜é‡å€¼ã€‚ä¾‹å¦‚ï¼Œä¸ºå¾—åˆ°ä¸€ä¸ªè·é˜µç±»å‹çš„å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªå‡½æ•°ï¼š1234HRESULT ID3DXEffect::GetMatrix( D3DXHANDLE hParameter, D3DXMATRIX* pMatrix); è¦å–å¾—æ‰€æœ‰çš„æ–¹æ³•åˆ—è¡¨ï¼ŒæŸ¥çœ‹DirectX SDKæ–‡æ¡£ã€‚ ä½¿ç”¨æ•ˆæœåœ¨è¿™ä¸€èŠ‚å’Œå®ƒçš„å°èŠ‚ï¼Œæˆ‘ä»¬å±•ç¤ºä¸€æ—¦ä¸€ä¸ªæ•ˆæœè¢«åˆ›å»ºå‡ºæ¥åå¦‚ä½•ä½¿ç”¨å®ƒã€‚ä¸‹é¢æ­¥éª¤æ¦‚è¿°äº†å…¨éƒ¨è¿‡ç¨‹ï¼š å¾—åˆ°ä¸€ä¸ªåœ¨ä½ æƒ³ä½¿ç”¨çš„æ•ˆæœæ–‡ä»¶ä¸­çš„æŠ€æœ¯å¥æŸ„ã€‚ æ¿€æ´»æƒ³å¾—åˆ°çš„æŠ€æœ¯ã€‚ å¯åŠ¨å½“å‰æ´»åŠ¨çš„æŠ€æœ¯ã€‚ å¯¹æ¯ä¸ªæ¿€æ´»æŠ€æœ¯ä¸­çš„æ¸²æŸ“ä¼ é€’ï¼Œæ¸²æŸ“æƒ³è¦çš„å‡ ä½•ä½“ã€‚å›æƒ³ä¸€ä¸‹ï¼ŒæŠ€æœ¯å¯èƒ½ç”±å‡ ä¸ªæ¸²æŸ“ä¼ é€’ç»„æˆï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ¯ä¸ªä¼ é€’ä¸­æ¸²æŸ“ä¸€æ¬¡å‡ ä½•ä½“ã€‚ ç»“æŸå½“å‰æ¿€æ´»çš„æŠ€æœ¯ã€‚ è·å¾—æ•ˆæœå¥æŸ„ï¼ˆ Obtaining a Handle to an Effectï¼‰ä½¿ç”¨æŠ€æœ¯çš„ç¬¬ä¸€æ­¥æ˜¯è·å¾—ä¸€ä¸ªæŠ€æœ¯D3DXHANDLEã€‚å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•å¾—åˆ°ä¸€ä¸ªæŠ€æœ¯å¥æŸ„ï¼š123D3DXHANDLE ID3DXEffect::GetTechniqueByName( LPCSTR pName // Name of the technique.); æ³¨æ„ï¼šå®é™…ä¸Šï¼Œä¸€ä¸ªæ•ˆæœæ–‡ä»¶åŒ…æ‹¬å‡ ä¸ªæŠ€æœ¯ï¼Œæ¯ä¸€ä¸ªéƒ½è¢«é’ˆå¯¹ä¸€ä¸ªç‰¹å®šçš„ç¡¬ä»¶èƒ½åŠ›è®¾è®¡ã€‚å› æ­¤ï¼Œåº”ç”¨ç¨‹åºé€šå¸¸åœ¨ç³»ç»Ÿä¸Šè¿è¡Œä¸€äº›èƒ½åŠ›æµ‹è¯•ï¼Œç„¶åé€šè¿‡è¿™äº›æµ‹è¯•é€‰æ‹©æœ€å¥½çš„æŠ€æœ¯ã€‚çœ‹ä¸‹é¢å°èŠ‚ä¸­çš„ID3DXEffect::ValidateTechniqueã€‚ æ¿€æ´»ä¸€ä¸ªæ•ˆæœï¼ˆ Activating an Effectï¼‰ä¸€æ—¦å¾—åˆ°äº†æƒ³è¦çš„æŠ€æœ¯çš„å¥æŸ„ï¼Œæˆ‘ä»¬å¿…é¡»æ¿€æ´»è¿™ä¸ªæŠ€æœ¯ã€‚è¿™å¯ä»¥é€šè¿‡ä¸‹é¢æ–¹æ³•å®ç°ï¼š123HRESULT ID3DXEffect::SetTechnique( D3DXHANDLE hTechnique // Handle to the technique to set.); æ³¨æ„ï¼šåœ¨æ¿€æ´»ä¸€é¡¹æŠ€æœ¯å‰ä½ å¯èƒ½æƒ³ç”¨ç°æœ‰è®¾å¤‡éªŒè¯å®ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ ä¹Ÿè®¸æƒ³ç¡®ä¿ç¡¬ä»¶æ”¯æŒçš„ç‰¹è‰²ã€é…ç½®æŠ€æœ¯çš„ä½¿ç”¨ã€‚ä½ å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼š123HRESULT ID3DXEffect::ValidateTechnique( D3DXHANDLE hTechnique // Handle to the technique to validate.); å›æƒ³ä¸€ä¸ªæ•ˆæœæ–‡ä»¶å¯èƒ½æœ‰å‡ ä¸ªæŠ€æœ¯ï¼Œæ¯ä¸ªå¿è¯•ç”¨ä¸åŒçš„ç¡¬ä»¶ç‰¹è‰²æ‰§è¡Œä¸€ä¸ªç‰¹å®šæ•ˆæœï¼Œå¸Œæœ›æœ€å°‘ä¸€ä¸ªæŠ€æœ¯å°†åœ¨ç”¨æˆ·ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚å¯¹äºä¸€ä¸ªæ•ˆæœï¼Œä½ å°†éä¾‹æ¯ä¸€ä¸ªæŠ€æœ¯å¹¶ç”¨ID3DXEffect::ValidateTechniqueè¿è¡Œå®ƒï¼Œå› è€Œä½ èƒ½æ£€æµ‹å“ªä¸ªæŠ€æœ¯æ˜¯è¢«æ”¯æŒçš„è€Œå“ªä¸ªä¸è¢«æ”¯æŒï¼Œç„¶åè¿›è¡Œé€‚å½“çš„åŠ¨ä½œã€‚ å¯åŠ¨æ•ˆæœä¸ºäº†ä½¿ç”¨ä¸€ä¸ªæ•ˆæœæ¸²æŸ“å‡ ä½•ä½“ï¼Œæˆ‘ä»¬å¿…é¡»å›´ç»•ç»˜å›¾å‡½æ•°åœ¨ID3DXEffect::Begin å’Œ ID3DXEffect::EndæŠ€æœ¯é—´è°ƒç”¨ã€‚è¿™äº›å‡½æ•°å°±æ˜¯åˆ†åˆ«å¼€å¯å’Œå…³é—­æ•ˆæœã€‚1234HRESULT ID3DXEffect::Begin( UINT* pPasses, DWORD Flags); pPassesâ€”è¿”å›åœ¨å½“å‰æ´»åŠ¨çš„æŠ€æœ¯ä¸­çš„ä¼ é€’çš„æ•°é‡ã€‚ Flagsâ€”ä¸‹é¢æ ‡å¿—çš„ä»»ä½•ä¸€ä¸ªï¼šo Zero (0)â€”æŒ‡å®šæ•ˆæœä¿å­˜å½“å‰è®¾å¤‡çŠ¶æ€å’Œç€è‰²çŠ¶æ€ï¼Œå¹¶åœ¨æ•ˆæœç»“æŸï¼ˆè¿™æ—¶ID3DXEffect::Endè¢«è°ƒç”¨ï¼‰åæ¢å¤å®ƒä»¬ã€‚å› ä¸ºæ•ˆæœæ–‡ä»¶èƒ½å¤Ÿæ”¹å˜çŠ¶æ€ï¼Œå¯¹äºå¯ä»¥ä¿å­˜å¯åŠ¨æ•ˆæœå‰çš„çŠ¶æ€æ¥è¯´ï¼Œæ˜¯å¾ˆæœ‰ç”¨çš„ã€‚o D3DXFX_DONOTSAVESTATEâ€”æŒ‡ç¤ºæ•ˆæœä¸ä¿å­˜å’Œæ¢å¤è®¾å¤‡çŠ¶æ€ï¼ˆé™¤shaderçŠ¶æ€å¤–ï¼‰ã€‚o D3DXFX_DONOTSAVESHADERSTATEâ€”æŒ‡ç¤ºæ•ˆæœä¸ä¿å­˜å’Œæ¢å¤shaderçŠ¶æ€ã€‚ è®¾ç½®å½“å‰çš„æ¸²æŸ“ä¼ é€’ï¼ˆSetting the Current Rendering Passï¼‰åœ¨æˆ‘ä»¬ç”¨æ•ˆæœæ¸²æŸ“ä»»ä½•å‡ ä½•ä½“å‰ï¼Œæˆ‘ä»¬å¿…é¡»æŒ‡å®šä½¿ç”¨çš„æ¸²æŸ“ä¼ é€’ã€‚å›æƒ³ä¸€ä¸ªæŠ€æœ¯åŒ…æ‹¬ä¸€ä¸ªæˆ–å¤šä¸ªæ¸²æŸ“ä¼ é€’ï¼Œæ¯ä¸€ä¸ªä¼ é€’å°è£…äº†ä¸åŒçš„è®¾å¤‡çŠ¶æ€ã€é‡‡æ ·å™¨ã€å’Œ/æˆ–ç”¨äºè¿™ä¸€ä¼ é€’çš„ç€è‰²å™¨ã€‚æ¸²æŸ“ä¼ é€’é€šè¿‡ä¸‹é¢æ–¹æ³•æŒ‡å®šï¼š123HRESULT ID3DXEffect::Pass( UINT iPass // Index identifying the pass.); ä¸€ä¸ªæŠ€æœ¯çš„æ¸²æŸ“ä¼ é€’è¢«ç”¨æ ‡è¯†ä¸º0â€¦n-1çš„ç´¢å¼•ï¼Œå…±nä¸ªä¼ é€’ã€‚å› è€Œï¼Œæˆ‘ä»¬èƒ½ç”¨ä¸€ä¸ªç®€å•çš„å¾ªç¯éä¾‹æ¯ä¸€ä¸ªä¼ é€’ï¼Œå¹¶ç”¨è¿™ä¸€ä¼ é€’æ¸²æŸ“å‡ ä½•ä½“ã€‚19.6.6èŠ‚æœ‰ä¸€ä¸ªä¾‹å­ã€‚ ç»“æŸæ•ˆæœï¼ˆEnding an Effectï¼‰æœ€åï¼Œå¯¹äºæ¯ä¸ªä¼ é€’ï¼Œæˆ‘ä»¬æ¸²æŸ“å®Œå‡ ä½•ä½“åï¼Œåœæ­¢å¹¶ç»“æŸæ•ˆæœæ—¶ä½¿ç”¨ID3DXEffect::Endæ–¹æ³•ï¼šHRESULT ID3DXEffect::End(VOID); ä¾‹å­ä¸‹é¢çš„ä»£ç ç‰‡æ–­ç¤ºä¾‹äº†ä»¥ä¸Šçš„ä½¿ç”¨ä¸€ä¸ªæ•ˆæœçš„å¿…è¦çš„äº”ä¸ªæ­¥éª¤ï¼š12345678// æœ‰æ•ˆæœæ–‡ä»¶ä¸­technique T0&#123; pass P0 &#123; &#125;&#125; 1234567891011121314151617181920212223// åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œå–å¾—æŠ€æœ¯å¥æŸ„D3DXHANDLE hTech = 0;hTech = Effect-&gt;GetTechniqueByName("TO");// æ¿€æ´»æŠ€æœ¯Effect-&gt;SetTechnique(hTech );// å¯åŠ¨æ¿€æ´»çš„æŠ€æœ¯UINT numPasses = 0;Effect-&gt;Begin(&amp;numPasses, 0);// éä¾‹æ¯ä¸ªä¼ é€’for(int i = 0; i &lt; numPasses; i++)&#123; // è®¾ç½®å½“å‰ä¼ é€’ Effect-&gt;Pass(i); // åœ¨ä¼ é€’ä¸­æ¸²æŸ“å‡ ä½•ä½“ Sphere-&gt;Draw();&#125;// ç»“æŸæ•ˆæœEffect-&gt;End(); ä¾‹å­ç¨‹åº: Lighting and Texturing in an Effect Fileåšä¸ºçƒ­èº«ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåœ¨3Dæ¨¡å‹ä¸­æ“ä½œç¯å…‰å’Œçº¹ç†çš„æ•ˆæœæ–‡ä»¶ã€‚è¿™ä¸ªä¾‹å­å®Œå…¨è¿è¡Œäºå›ºå®šåŠŸèƒ½ç®¡çº¿ï¼Œæ„å‘³ç€æ•ˆæœæ¡†æ¶ä¸ä»…é™äºä½¿ç”¨ç€è‰²å™¨ã€‚å›¾19.1å±•ç¤ºäº†ä½¿ç”¨ç¯å…‰å’Œçº¹ç†ä¾‹å­çš„å±å¹•æˆªå›¾ã€‚ å›¾19.1: ç¯å…‰å’Œçº¹ç†ä¾‹å­çš„å±å¹•æˆªå›¾. çº¹ç†ã€æè´¨å’Œç¯å…‰çŠ¶æ€åœ¨æ•ˆæœæ–‡ä»¶ä¸­æŒ‡å®šã€‚ ä»¥ä¸‹æ˜¯æ•ˆæœæ–‡ä»¶çš„å®ç°ï¼š// File: light tex.txt// Desc: æ•ˆæœæ–‡ä»¶æ§åˆ¶å…‰çš„è®¾å¤‡çŠ¶æ€ï¼Œå’Œçº¹ç†ä¸€ä¸ª3Dæ¨¡å‹?// å…¨å±€å˜é‡matrix WorldMatrix;matrix ViewMatrix;matrix ProjMatrix;?texture Tex;?// è¿‡æ»¤å™¨?// Associated the texture â€˜Texâ€™ with the texture stage â€˜S0â€™// corresponds with and also set the sampler states for the sampler// stage â€˜S0â€™ corresponds with.sampler S0 = sampler state{ Texture = (Tex); MinFilter = LINEAR; MagFilter = LINEAR; MipFilter = LINEAR;}; // Effecttechnique LightAndTexture{ pass P0 { // Set misc. render states.? pixelshader = null; // No pixel shader. vertexshader = null; // No vertex shader. fvf = XYZ | Normal | Tex1; // Flexible vertex format Lighting = true; // Enable lighting. NormalizeNormals = true; // Renormalize normals. SpecularEnable = false; // Disable specular highlights. // Set transformation states? WorldTransform[0] = (WorldMatrix); ViewTransform = (ViewMatrix); ProjectionTransform = (ProjMatrix); // Set a light source at light index 0. We fill out all the // components for light[0] because the Direct3D // documentation recommends filling out all components // for best performance.? LightType[0] = Directional; LightAmbient[0] = {0.2f, 0.2f, 0.2f, 1.0f}; LightDiffuse[0] = {1.0f, 1.0f, 1.0f, 1.0f}; LightSpecular[0] = {0.0f, 0.0f, 0.0f, 1.0f}; LightDirection[0] = {1.0f, -1.0f, 1.0f, 0.0f}; LightPosition[0] = {0.0f, 0.0f, 0.0f, 0.0f}; LightFalloff[0] = 0.0f; LightRange[0] = 0.0f; LightTheta[0] = 0.0f; LightPhi[0] = 0.0f; LightAttenuation0[0] = 1.0f; LightAttenuation1[0] = 0.0f; LightAttenuation2[0] = 0.0f; ? // Finally, enable the light:? LightEnable[0] = true;? // Set material components. This is like calling // IDirect3DDevice9::SetMaterial.? MaterialAmbient = {1.0f, 1.0f, 1.0f, 1.0f}; MaterialDiffuse = {1.0f, 1.0f, 1.0f, 1.0f}; MaterialEmissive = {0.0f, 0.0f, 0.0f, 0.0f}; MaterialPower = 1.0f; MaterialSpecular = {1.0f, 1.0f, 1.0f, 1.0f};? // Hook up the sampler object â€˜S0â€™ to sampler stage 0, // which is given by Sampler[0].? Sampler[0] = (S0); }} åœ¨è¿™ä¸ªæ•ˆæœæ–‡ä»¶ä¸­æˆ‘ä»¬ä¸»è¦è®¾ç½®è®¾å¤‡çŠ¶æ€ï¼Œå°±è±¡åœ¨19.3èŠ‚æ‰€è¿°ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨æ•ˆæœæ–‡ä»¶ä¸­è®¾ç½®ä¸€ä¸ªå…‰æºå’Œä¸€ä¸ªæè´¨ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æŒ‡å®šè½¬æ¢è·é˜µå’Œçº¹ç†åŠé‡‡æ ·å™¨çŠ¶æ€ã€‚è¿™äº›çŠ¶æ€è¢«æŒ‡å®šï¼Œç„¶åç”¨LightAndTextureæ–¹æ³•å’Œæ¸²æŸ“ä¼ é€’P0æ¸²æŸ“å…¨éƒ¨å‡ ä½•ä½“ï¼Œã€‚ æ³¨æ„ï¼šè€ƒè™‘åˆ°åœ¨ä¸€ä¸ªæ•ˆæœæ–‡ä»¶ä¸­æ¶‰åŠåˆ°çš„çš„å˜é‡ï¼Œä½ å¿…é¡»æŠŠå®ƒä»¬è£…å…¥åœ†æ‹¬å·ä¸­ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæ¶‰åŠåˆ°è·é˜µå˜é‡ï¼Œä½ å¿…é¡»è¿™æ ·å†™ï¼š(WorldMatrix), (ViewMatrix), and (ProjMatrix)ã€‚ä¸ä½¿ç”¨åœ†æ‹¬å·æ˜¯è¿æ³•çš„ã€‚ å› ä¸ºå¤§éƒ¨åˆ†å¿…éœ€çš„å’Œç¹ççš„å·¥ä½œéƒ½åœ¨æ•ˆæœæ–‡ä»¶é‡Œåšäº†ï¼Œæ¯”å¦‚è®¾ç½®ç¯å…‰ã€æè´¨å’Œçº¹ç†ã€‚åº”ç”¨ç¨‹åºä»£ç å°±æ˜¯åšä¸€äº›åˆ›å»ºæ•ˆæœå’Œå¼€å¯æ•ˆæœç­‰ç®€å•çš„äº‹æƒ…ã€‚ä¾‹å­ä¸­æœ‰ä¸‹é¢ä¸€äº›ç›¸å…³çš„å…¨å±€å˜é‡ï¼šID3DXEffect* LightTexEffect = 0; D3DXHANDLE WorldMatrixHandle = 0;D3DXHANDLE ViewMatrixHandle = 0;D3DXHANDLE ProjMatrixHandle = 0;D3DXHANDLE TexHandle = 0; D3DXHANDLE LightTexTechHandle = 0; ?è¿™äº›ä¸œè¥¿å¾ˆæ²¡åŠ² â€”â€”- åªæ˜¯ä¸€ä¸ªID3DXEffectæŒ‡é’ˆå’Œä¸€äº›å¥æŸ„ã€‚LightTexTechHandleæ˜¯ä¸€ä¸ªæŠ€æœ¯çš„å¥æŸ„ï¼Œå› æ­¤åœ¨å®ƒçš„åå­—ä¸­æœ‰å­å­—ç¬¦ä¸²â€œTechâ€ã€‚ RestoreDeviceObjectså‡½æ•°æ‰§è¡Œä¸‰ä¸ªä¸»è¦æ­¥éª¤ï¼šåˆ›å»ºæ•ˆæœï¼Œè·å¾—ä½œä¸ºæ•ˆæœå‚æ•°çš„æˆ‘ä»¬è¦ç”¨çš„æŠ€æœ¯çš„å¥æŸ„ï¼Œå¹¶åˆå§‹åŒ–ä¸€äº›æ•ˆæœå‚æ•°ã€‚ä¸‹é¢æ˜¯åˆ èŠ‚çš„å®ç°ï¼šbool Setup(){ HRESULT hr = 0; // â€¦çœç•¥äº†é‡‡æ ·å™¨çš„è¯»å–? // åˆ›å»ºæ•ˆæœ ID3DXBuffer errorBuffer = 0; hr = D3DXCreateEffectFromFile( m_pd3dDevice , â€œlight_tex.txtâ€, 0, // æ²¡æœ‰å®šä¹‰é¢„å¤„ç†å™¨ 0, // æ²¡æœ‰ID3DXIncludeæ¥å£ D3DXSHADER_DEBUG, // ç¼–è¯‘æ ‡è®° 0, // ä¸å…±äº«å‚æ•° &amp;m_LightTexEffect, &amp;errorBuffer);? // è¾“å‡ºé”™è¯¯ä¿¡æ¯ if( errorBuffer ) { ::MessageBox(0, (char)errorBuffer-&gt;GetBufferPointer(), 0, 0); SAFE_RELEASE(errorBuffer); }? if(FAILED(hr)) { ::MessageBox(0, â€œD3DXCreateEffectFromFile() - FAILEDâ€, 0, 0); return false; }? // ä¿å­˜ç»å¸¸è®¿é—®çš„å‚æ•°å¥æŸ„ m_WorldMatrixHandle = m_LightTexEffect-&gt;GetParameterByName(0, â€œWorldMatrixâ€); m_ViewMatrixHandle = m_LightTexEffect-&gt;GetParameterByName(0, â€œViewMatrixâ€); m_ProjMatrixHandle = m_LightTexEffect-&gt;GetParameterByName(0, â€œProjMatrixâ€); m_TexHandle = m_LightTexEffect-&gt;GetParameterByName(0, â€œTexâ€);? m_LightTexTechHandle = m_LightTexEffect-&gt;GetTechniqueByName(â€œLightAndTextureâ€);? // è®¾ç½®æ•ˆæœå‚æ•° // è®¾ç½®çŸ©é˜µ D3DXMATRIX W, P;? D3DXMatrixIdentity(&amp;W); m_LightTexEffect-&gt;SetMatrix( m_WorldMatrixHandle, &amp;W);? D3DXMatrixPerspectiveFovLH( &amp;P, D3DX_PI * 0.25f, // 45 - degree (float)800.0f / (float)600.0f, 1.0f, 1000.0f);? m_LightTexEffect-&gt;SetMatrix( m_ProjMatrixHandle, &amp;P); ? // Set texture IDirect3DTexture9 tex = 0; D3DXCreateTextureFromFile(m_pd3dDevice, â€œTerrain_3x_diffcol.jpgâ€, &amp;tex);? LightTexEffect-&gt;SetTexture(TexHandle, tex); d3d::Release&lt;IDirect3DTexture9&gt;(tex);? return true;} Displyå‡½æ•°å¾ˆç®€å•ï¼Œè¿è¡Œæ­¥èšåœ¨19.6 èŠ‚ä¸­ç®€è¦è¯´æ˜:bool Display(float timeDelta){ if( Device ) { // â€¦[Camera update snipped] // set the new updated view matrix LightTexEffect-&gt;SetMatrix(ViewMatrixHandle, &amp;V); // Activate the technique and render Device-&gt;Clear(0, 0, D3DCLEAR TARGET | D3DCLEAR ZBUFFER, 0xffffffff, 1.0f, 0); Device-&gt;BeginScene(); // set the technique to use LightTexEffect-&gt;SetTechnique( LightTexTechHandle ); UINT numPasses = 0; LightTexEffect-&gt;Begin(&amp;numPasses, 0); for(int i = 0; i &lt; numPasses; i++) { LightTexEffect-&gt;Pass(i); for(int j = 0; j &lt; Mtrls.size(); j++) { Mesh-&gt;DrawSubset(j); } } LightTexEffect-&gt;End(); Device-&gt;EndScene(); Device-&gt;Present(0, 0, 0, 0); } return true;} 19.8ä¾‹å­ç¨‹åº: Fog Effect éå¸¸é—æ†¾ï¼Œæˆ‘ä»¬æ²¡æœ‰ç”¨ä¸€æ•´ç« ç¯‡å¹…æ¥ä»‹ç»Direct3Dé›¾åŒ–æ•ˆæœã€‚é›¾åŒ–æ•ˆæœï¼ˆä»¥ä¸‹ç®€ç§°é›¾ï¼‰æé«˜äº†åœºæ™¯çš„çœŸå®æ€§ï¼Œå¯ä»¥ç”¨å®ƒæ¥æ¨¡æ‹Ÿé€¼çœŸçš„å¤©æ°”çŠ¶å†µã€‚å¦å¤–ï¼Œé›¾å¯ä»¥å¤§å¤§å‡å°‘é•¿å‰ªè£ï¼ˆfar-clipï¼‰å¹³é¢è§†è§‰æ•ˆæœã€‚ è™½ç„¶æˆ‘ä»¬ä¸èƒ½ç»™å®ƒåº”æœ‰çš„é‡è§†ï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯æŒ¤å‡ºäº†ä¸€ä¸ªç®€è¦çš„é›¾åŒ–ä¾‹ç¨‹ã€‚è™½ç„¶æˆ‘ä»¬ä¸æ¶‰åŠè¯¦ç»†çš„ç»†èŠ‚ï¼Œæˆ‘ä»¬è¿˜æ˜¯å±•ç¤ºå¹¶è§£é‡Šäº†Direct3Dä»£ç ï¼Œè¿™æ˜¯å¾ˆç›´æ¥çš„ã€‚ Direct3Dé›¾åŒ–æ˜¯å›ºå®šåŠŸèƒ½ç®¡çº¿çš„ä¸€éƒ¨ä»½ï¼Œå—æ¸²æŸ“çŠ¶æ€é™åˆ¶ã€‚ä¸‹é¢çš„æ•ˆæœæ–‡ä»¶è®¾ç½®é¡¶ç‚¹é›¾ï¼Œä»¥è¾¾åˆ°å¿…è¦çš„é›¾åŒ–çŠ¶æ€ã€‚ æ³¨æ„ï¼šDirect3Dä¹Ÿæ”¯æŒåƒç´ é›¾ï¼ˆä¹Ÿå«è¡¨æ ¼é›¾table fogï¼‰ï¼Œæ¯”é¡¶ç‚¹é›¾è¦æ›´ç²¾ç¡®ã€‚// File: fog.txt// Desc: Effect file that handles device states for linear vertex fog.technique Fog{ pass P0 { // Set misc render states.? pixelshader = null; vertexshader = null; fvf = XYZ | Normal; Lighting = true; NormalizeNormals = true; SpecularEnable = false;? // Fog states? FogVertexMode = LINEAR; // Linear fog function. FogStart = 50.0f; // Fog starts 50 units away from viewpoint. FogEnd = 300.0f; // Fog ends 300 units away from viewpoint.? FogColor = 0x00CCCCCC; // Gray colored fog. FogEnable = true; // Enable vertex fog. }} å°±è±¡ä½ çœ‹åˆ°çš„ï¼Œçº¿æ€§é¡¶ç‚¹é›¾èƒ½å¤Ÿé€šè¿‡äº”ä¸ªç®€å•çš„æ¸²æŸ“çŠ¶æ€æ§åˆ¶ï¼š*???????? FogVertexModeâ€”ä½¿ç”¨æŒ‡å®šçš„é›¾å‡½æ•°ç”¨äºé¡¶ç‚¹é›¾ã€‚é›¾å‡½æ•°æŒ‡å®šé›¾å¦‚ä½•æ ¹æ®è·ç¦»å¢é•¿ï¼Œè‡ªç„¶ç•Œçš„é›¾åœ¨è¿‘è§†å£çš„åœ°æ–¹æ¯”è¾ƒè–„å¹¶ä¸”æ ¹æ®è·ç¦»å¢é•¿å˜å¾—åšèµ·æ¥äº†ã€‚æœ‰æ•ˆçš„ä»»åŠ¡ç±»å‹ä¸ºLINEARã€EXPã€EXP2ã€‚è¿™äº›å‡½æ•°è¢«å®šä¹‰ä¸ºï¼š d æ˜¯åˆ°è§†å£çš„è·ç¦»(viewpoint.) æ³¨æ„ï¼šå¦‚æœä½ ç”¨EXPæˆ–EXP2é›¾åŒ–å‡½æ•°ï¼Œä½ ä¸ç”¨è®¾ç½®FogStart å’Œ FogEndï¼Œå› ä¸ºå®ƒä»¬åœ¨è¿™äº›é›¾å‡½æ•°ç±»å‹ä¸­æ²¡è¢«ç”¨åˆ°ã€‚ä»£æ›¿çš„ä½ å¿…é¡»è®¾ç½®é›¾å¯†åº¦ï¼ˆfog densityï¼‰æ¸²æŸ“çŠ¶æ€ï¼ˆå¦‚ï¼ŒFogDensity = someFloatTypeï¼‰???????? FogStartâ€”æ ‡è®°äº†ç‰©ä½“å°†å¼€å§‹é›¾åŒ–çš„èµ·å§‹æ·±åº¦ã€‚ ???????? FogEndâ€”æ ‡è®°äº†ç‰©ä½“å°†ç»“æŸé›¾åŒ–çš„ç»“æŸæ·±åº¦ã€‚ æ³¨æ„ï¼šFogStart ä¸ FogEndæœ¬è´¨ä¸Šå®šä¹‰äº†ç‰©ä½“åœ¨å…¶ä¸­è¢«é›¾åŒ–çš„æ·±åº¦é—´éš”ï¼ˆä»è§†å£ï¼‰ã€‚???????? FogColorâ€”ä¸€ä¸ªDWORD æˆ– D3DCOLORå€¼ï¼Œä»¥æè¿°é›¾çš„é¢œè‰² ???????? FogEnableâ€”æŒ‡å®štrueä»¥å¼€å¯é¡¶ç‚¹é›¾æˆ–falseä»¥å…³é—­é¡¶ç‚¹é›¾ ä»»ä½•æˆ‘ä»¬ç”¨fog.txtæ•ˆæœæ¸²æŸ“çš„å‡ ä½•ä½“å°†è¢«é›¾åŒ–ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶å“ªä¸€ç‰©ä½“å¾—åˆ°é›¾åŒ–ï¼Œè€Œå“ªäº›ä¸ç”¨é›¾åŒ–ã€‚è¿™å¯¹åªé›¾åŒ–ç‰¹å®šåŒºåŸŸæ˜¯å¾ˆæœ‰ç”¨çš„ã€‚ä¾‹å¦‚ï¼Œé€šå¸¸å±‹å¤–æ˜¯æœ‰é›¾çš„ï¼Œå±‹é‡Œä¸è¢«é›¾åŒ–ã€‚åŒæ ·çš„ï¼Œä¸€å®šåœ°ç†éƒ¨åˆ†å¯èƒ½æœ‰é›¾ï¼Œè€Œå¦å¤–éƒ¨åˆ†å¯èƒ½æ²¡æœ‰ã€‚å›¾19.2å±•ç¤ºäº†è¿™ä¸€å°èŠ‚çš„è°ƒç”¨é›¾æ•ˆæœçš„ä¾‹ç¨‹çš„å±å¹•æˆªå›¾ã€‚å›¾19.2: é›¾åŒ–æ•ˆæœä¾‹å­ç¨‹åºçš„å±å¹•æˆªå›¾ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬ä½¿ç”¨çº¿æ€§é›¾å‡½æ•°ï¼Œè€Œä¸”é›¾åŒ–æ¸²æŸ“çŠ¶æ€åœ¨æ•ˆæœæ–‡ä»¶ä¸­æŒ‡å®šã€‚19.9ä¾‹å­ç¨‹åº: Cartoon Effect åˆ°ç›®å‰ä¸ºæ­¢çš„2ä¸ªæ•ˆæœæ–‡ä»¶çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ç€è‰²å™¨ï¼ˆshaderï¼‰ã€‚å› ä¸ºç€è‰²å™¨åœ¨ç‰¹æ•ˆä¸­çš„é‡è¦éƒ¨åˆ†ï¼Œæˆ‘ä»¬æƒ³å±•ç¤ºä¸€ä¸ªæœ€ç²¾ç®€çš„ä¾‹å­ã€‚ä¾‹ç¨‹CartoonEffectæ‰§è¡Œäº†åœ¨17ç« ä¸­è®¨è®ºçš„å¡é€šç€è‰²å™¨ï¼Œä½†æ˜¯è¿™æ¬¡åº”ç”¨æ•ˆæœæ¡†æ¶ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåˆ èŠ‚ç‰ˆçš„æ•ˆæœæ–‡ä»¶ï¼š// File: tooneffect.txt// åœ¨æ•ˆæœæ–‡ä»¶ä¸­çš„å¡é€šç€è‰²å™¨extern matrix WorldMatrix;extern matrix ViewMatrix;extern matrix ProjMatrix;extern vector Color;extern vector LightDirection;static vector Black = {0.0f, 0.0f, 0.0f, 0.0f};extern texture ShadeTex;?struct VS_INPUT{ vector position : POSITION; vector normal : NORMAL;}; struct VS_OUTPUT{ vector position : POSITION; float2 uvCoords : TEXCOORD; vector diffuse : COLOR;};?// Cartoon Shader Function:VS_OUTPUT Main(VS_INPUT input){ â€¦[Implementation omitted for brevity.]}?sampler ShadeSampler = sampler state{ Texture = (ShadeTex); MinFilter = POINT; // no filtering for cartoon shading MagFilter = POINT; MipFilter = NONE;};?technique Toon{ pass P0 { // Set P0â€™s vertex shader. vertexShader = compile vs_1_1 Main(); // Hook up the sampler object to sampler stage 0. Sampler[0] = (ShadeSampler); }} æˆ‘ä»¬æ³¨æ„åˆ°å¡é€šç€è‰²å™¨å‡½æ•°è¢«å®šä¹‰åœ¨æ•ˆæœæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”æˆ‘ä»¬æŒ‡å®šç€è‰²å™¨ä½¿ç”¨ä¸€ä¸ªç‰¹å®šçš„ä¼ é€’ï¼Œåœ¨ä¼ é€’éƒ¨åˆ†ä½¿ç”¨è¯­æ³•ï¼švertexShader = compile vs_1_1_Main();ã€‚åœ¨æ•ˆæœæ–‡ä»¶ä¸­çš„è®¾å¤‡çŠ¶æ€è±¡é€šå¸¸ä¸€æ ·è®¾ç½®ã€‚ 19.10 æ•ˆæœç¼–è¾‘ï¼ˆEffectEditï¼‰ åœ¨ç»“æŸè¿™ç« å‰ï¼Œæˆ‘ä»¬æƒ³æä¸€ä¸‹åœ¨DirectX SDKä¸­çš„EffectEditç¨‹åºã€‚å¯ä»¥åœ¨\DXSDK\Samples\C++\Direct3D\Binæ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°å®ƒã€‚å›¾19.3æ˜¾ç¤ºäº†ä¸€ä¸ªå±å¹•æˆªå›¾ã€‚ å›¾19.3: ä¸€ä¸ªåœ¨DirectX SDK ä¸­çš„EffectEdit ç¨‹åºçš„å±å¹•æˆªå›¾ è¿™ä¸ªEffectEditç¨‹åºåœ¨æµ‹è¯•å’Œä¹¦å†™æ•ˆæœæ–‡ä»¶æ—¶æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚æˆ‘ä»¬æ¨èæ‚¨åœ¨è¿™ä¸ªå·¥å…·ä¸ŠèŠ±ç‚¹æ—¶é—´ã€‚ 19.11æ‘˜è¦ç•¥ ç›¸å…³æ–‡ç« ï¼šAGPå†…å­˜AGPï¼ˆAccelerate Graphical Portï¼‰ï¼ŒåŠ é€Ÿå›¾å½¢æ¥å£ã€‚éšç€æ˜¾ç¤ºèŠ¯ç‰‡çš„å‘å±•ï¼ŒPCIæ€»çº¿æ—¥ç›Šæ— æ³•æ»¡è¶³å…¶éœ€æ±‚ã€‚è‹±ç‰¹å°”äº1996å¹´7æœˆæ­£å¼æ¨å‡ºäº†AGPæ¥å£ï¼Œå®ƒæ˜¯ä¸€ç§æ˜¾ç¤ºå¡ä¸“ç”¨çš„å±€éƒ¨æ€»çº¿ã€‚ä¸¥æ ¼çš„è¯´ï¼ŒAGPä¸èƒ½ç§°ä¸ºæ€»çº¿ï¼Œå®ƒä¸PCIæ€»çº¿ä¸åŒï¼Œå› ä¸ºå®ƒæ˜¯ç‚¹å¯¹ç‚¹è¿æ¥ï¼Œå³è¿æ¥æ§åˆ¶èŠ¯ç‰‡å’ŒAGPæ˜¾ç¤ºå¡ï¼Œä½†åœ¨ä¹ æƒ¯ä¸Šæˆ‘ä»¬ä¾ç„¶ç§°å…¶ä¸ºAGPæ€»çº¿ã€‚AGPæ¥å£æ˜¯åŸºäºPCI 2.1 ç‰ˆè§„èŒƒå¹¶è¿›è¡Œæ‰©å……ä¿®æ”¹è€Œæˆï¼Œå·¥ä½œé¢‘ç‡ä¸º66MHzã€‚ AGPæ€»çº¿ç›´æ¥ä¸ä¸»æ¿çš„åŒ—æ¡¥èŠ¯ç‰‡ç›¸è¿ï¼Œä¸”é€šè¿‡è¯¥æ¥å£è®©æ˜¾ç¤ºèŠ¯ç‰‡ä¸ç³»ç»Ÿä¸»å†…å­˜ç›´æ¥ç›¸è¿ï¼Œé¿å…äº†çª„å¸¦å®½çš„PCIæ€»çº¿å½¢æˆçš„ç³»ç»Ÿç“¶é¢ˆï¼Œå¢åŠ 3Då›¾å½¢æ•°æ®ä¼ è¾“é€Ÿåº¦ï¼ŒåŒæ—¶åœ¨æ˜¾å­˜ä¸è¶³çš„æƒ…å†µä¸‹è¿˜å¯ä»¥è°ƒç”¨ç³»ç»Ÿä¸»å†…å­˜ã€‚æ‰€ä»¥å®ƒæ‹¥æœ‰å¾ˆé«˜çš„ä¼ è¾“é€Ÿç‡ï¼Œè¿™æ˜¯PCIç­‰æ€»çº¿æ— æ³•ä¸å…¶ç›¸æ¯”æ‹Ÿçš„ã€‚ ç”±äºé‡‡ç”¨äº†æ•°æ®è¯»å†™çš„æµæ°´çº¿æ“ä½œå‡å°‘äº†å†…å­˜ç­‰å¾…æ—¶é—´ï¼Œæ•°æ®ä¼ è¾“é€Ÿåº¦æœ‰äº†å¾ˆå¤§æé«˜ï¼›å…·æœ‰133MHzåŠæ›´é«˜çš„æ•°æ®ä¼ è¾“é¢‘ç‡ï¼›åœ°å€ä¿¡å·ä¸æ•°æ®ä¿¡å·åˆ†ç¦»å¯æé«˜éšæœºå†…å­˜è®¿é—®çš„é€Ÿåº¦ï¼›é‡‡ç”¨å¹¶è¡Œæ“ä½œå…è®¸åœ¨CPUè®¿é—®ç³»ç»ŸRAMçš„åŒæ—¶AGPæ˜¾ç¤ºå¡è®¿é—®AGPå†…å­˜ï¼›æ˜¾ç¤ºå¸¦å®½ä¹Ÿä¸ä¸å…¶å®ƒè®¾å¤‡å…±äº«ï¼Œä»è€Œè¿›ä¸€æ­¥æé«˜äº†ç³»ç»Ÿæ€§èƒ½ã€‚ AGPæ ‡å‡†åœ¨ä½¿ç”¨32ä½æ€»çº¿æ—¶ï¼Œæœ‰66MHzå’Œ133MHzä¸¤ç§å·¥ä½œé¢‘ç‡ï¼Œæœ€é«˜æ•°æ®ä¼ è¾“ç‡ä¸º266Mbpså’Œ533Mbpsï¼Œè€ŒPCIæ€»çº¿ç†è®ºä¸Šçš„æœ€å¤§ä¼ è¾“ç‡ä»…ä¸º133Mbpsã€‚ç›®å‰æœ€é«˜è§„æ ¼çš„AGP 8Xæ¨¡å¼ä¸‹ï¼Œæ•°æ®ä¼ è¾“é€Ÿåº¦è¾¾åˆ°äº†2.1GB/sã€‚ AGPæ¥å£çš„å‘å±•ç»å†äº†AGP1.0(AGP1Xã€AGP2X)ã€AGP2.0(AGP Proã€AGP4X)ã€AGP3.0(AGP8X)ç­‰é˜¶æ®µï¼Œå…¶ä¼ è¾“é€Ÿåº¦ä¹Ÿä»æœ€æ—©çš„AGP1Xçš„266MB/Sçš„å¸¦å®½å‘å±•åˆ°äº†AGP8Xçš„2.1GB/Sã€‚AGP 1.0ï¼ˆAGP1Xã€AGP2Xï¼‰ 1996å¹´7æœˆAGP 1.0 å›¾å½¢æ ‡å‡†é—®ä¸–ï¼Œåˆ†ä¸º1Xå’Œ2Xä¸¤ç§æ¨¡å¼ï¼Œæ•°æ®ä¼ è¾“å¸¦å®½åˆ†åˆ«è¾¾åˆ°äº†266MB/så’Œ533MB/sã€‚è¿™ç§å›¾å½¢æ¥å£è§„èŒƒæ˜¯åœ¨66MHz PCI2.1è§„èŒƒåŸºç¡€ä¸Šç»è¿‡æ‰©å……å’ŒåŠ å¼ºè€Œå½¢æˆçš„ï¼Œå…¶å·¥ä½œé¢‘ç‡ä¸º66MHzï¼Œå·¥ä½œç”µå‹ä¸º3.3vï¼Œåœ¨ä¸€æ®µæ—¶é—´å†…åŸºæœ¬æ»¡è¶³äº†æ˜¾ç¤ºè®¾å¤‡ä¸ç³»ç»Ÿäº¤æ¢æ•°æ®çš„éœ€è¦ã€‚è¿™ç§è§„èŒƒä¸­çš„AGPå¸¦å®½å¾ˆå°ï¼Œç°åœ¨å·²ç»è¢«æ·˜æ±°äº†ï¼Œåªæœ‰åœ¨å‰å‡ å¹´çš„è€ä¸»æ¿ä¸Šè¿˜è§å¾—åˆ°ã€‚AGP2.0(AGP4X) æ˜¾ç¤ºèŠ¯ç‰‡çš„é£é€Ÿå‘å±•ï¼Œå›¾å½¢å¡å•ä½æ—¶é—´å†…æ‰€èƒ½å¤„ç†çš„æ•°æ®å‘ˆå‡ ä½•çº§æ•°æˆå€å¢é•¿ï¼ŒAGP 1.0 å›¾å½¢æ ‡å‡†è¶Šæ¥è¶Šéš¾ä»¥æ»¡è¶³æŠ€æœ¯çš„è¿›æ­¥äº†ï¼Œç”±æ­¤AGP 2.0ä¾¿åº”è¿è€Œç”Ÿäº†ã€‚1998å¹´5æœˆä»½ï¼ŒAGP 2.0 è§„èŒƒæ­£å¼å‘å¸ƒï¼Œå·¥ä½œé¢‘ç‡ä¾ç„¶æ˜¯66MHzï¼Œä½†å·¥ä½œç”µå‹é™ä½åˆ°äº†1.5vï¼Œå¹¶ä¸”å¢åŠ äº†4xæ¨¡å¼ï¼Œè¿™æ ·å®ƒçš„æ•°æ®ä¼ è¾“å¸¦å®½è¾¾åˆ°äº†1066MB/secï¼Œæ•°æ®ä¼ è¾“èƒ½åŠ›å¤§å¤§åœ°å¢å¼ºäº†ã€‚AGP Pro AGP Proæ¥å£ä¸AGP 2.0åŒæ—¶æ¨å‡ºï¼Œè¿™æ˜¯ä¸€ç§ä¸ºäº†æ»¡è¶³æ˜¾ç¤ºè®¾å¤‡åŠŸè€—æ—¥ç›ŠåŠ å¤§çš„ç°å®è€Œç ”å‘çš„å›¾å½¢æ¥å£æ ‡å‡†ï¼Œåº”ç”¨è¯¥æŠ€æœ¯çš„å›¾å½¢æ¥å£ä¸»è¦çš„ç‰¹ç‚¹æ˜¯æ¯”AGP 4xç•¥é•¿ä¸€äº›ï¼Œå…¶åŠ é•¿éƒ¨åˆ†å¯å®¹çº³æ›´å¤šçš„ç”µæºå¼•è„šï¼Œä½¿å¾—è¿™ç§æ¥å£å¯ä»¥é©±åŠ¨åŠŸè€—æ›´å¤§ï¼ˆ25-110wï¼‰æˆ–è€…å¤„ç†èƒ½åŠ›æ›´å¼ºå¤§çš„AGPæ˜¾å¡ã€‚è¿™ç§æ ‡å‡†å…¶å®æ˜¯ä¸“ä¸ºé«˜ç«¯å›¾å½¢å·¥ä½œç«™è€Œè®¾è®¡çš„ï¼Œå®Œå…¨å…¼å®¹AGP 4xè§„èŒƒï¼Œä½¿å¾—AGP 4xçš„æ˜¾å¡ä¹Ÿå¯ä»¥æ’åœ¨è¿™ç§æ’æ§½ä¸­æ­£å¸¸ä½¿ç”¨ã€‚AGP Proåœ¨åŸæœ‰AGPæ’æ§½çš„ä¸¤ä¾§è¿›è¡Œå»¶ä¼¸ï¼Œæä¾›é¢å¤–çš„ç”µèƒ½ã€‚å®ƒæ˜¯ç”¨æ¥å¢å¼ºï¼Œè€Œä¸æ˜¯å–ä»£ç°æœ‰AGPæ’æ§½çš„åŠŸèƒ½ã€‚æ ¹æ®æ‰€èƒ½æä¾›èƒ½é‡çš„ä¸åŒï¼Œå¯ä»¥æŠŠAGP Proç»†åˆ†ä¸ºAGP Pro110å’ŒAGP Pro50ã€‚åœ¨æŸäº›é«˜æ¡£å°å¼æœºä¸»æ¿ä¸Šä¹Ÿèƒ½è§åˆ°AGP Proæ’æ§½ï¼Œä¾‹å¦‚åç¡•çš„è®¸å¤šä¸»æ¿ã€‚AGP 3.0(AGP8X) 2000å¹´8æœˆï¼ŒIntelæ¨å‡ºAGP3.0è§„èŒƒï¼Œå·¥ä½œç”µå‹é™åˆ°0.8V,å¹¶å¢åŠ äº†8xæ¨¡å¼ï¼Œè¿™æ ·å®ƒçš„æ•°æ®ä¼ è¾“å¸¦å®½è¾¾åˆ°äº†2133MB/secï¼Œæ•°æ®ä¼ è¾“èƒ½åŠ›ç›¸å¯¹äºAGP 4Xæˆå€å¢é•¿ï¼Œèƒ½è¾ƒå¥½çš„æ»¡è¶³å½“å‰æ˜¾ç¤ºè®¾å¤‡çš„å¸¦å®½éœ€æ±‚ã€‚AGPæ¥å£çš„æ¨¡å¼ä¼ è¾“æ–¹å¼ ä¸åŒAGPæ¥å£çš„æ¨¡å¼ä¼ è¾“æ–¹å¼ä¸åŒã€‚1Xæ¨¡å¼çš„AGPï¼Œå·¥ä½œé¢‘ç‡è¾¾åˆ°äº†PCIæ€»çº¿çš„ä¸¤å€â€”66MHzï¼Œä¼ è¾“å¸¦å®½ç†è®ºä¸Šå¯è¾¾åˆ°266MB/sã€‚AGP 2Xå·¥ä½œé¢‘ç‡åŒæ ·ä¸º66MHzï¼Œä½†æ˜¯å®ƒä½¿ç”¨äº†æ­£è´Ÿæ²¿ï¼ˆä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸçš„ä¸Šå‡æ²¿å’Œä¸‹é™æ²¿ï¼‰è§¦å‘çš„å·¥ä½œæ–¹å¼ï¼Œåœ¨è¿™ç§è§¦å‘æ–¹å¼ä¸­åœ¨ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸçš„ä¸Šå‡æ²¿å’Œä¸‹é™æ²¿å„ä¼ é€ä¸€æ¬¡æ•°æ®ï¼Œä»è€Œä½¿å¾—ä¸€ä¸ªå·¥ä½œå‘¨æœŸå…ˆåè¢«è§¦å‘ä¸¤æ¬¡ï¼Œä½¿ä¼ è¾“å¸¦å®½è¾¾åˆ°äº†åŠ å€çš„ç›®çš„ï¼Œè€Œè¿™ç§è§¦å‘ä¿¡å·çš„å·¥ä½œé¢‘ç‡ä¸º133MHzï¼Œè¿™æ ·AGP 2Xçš„ä¼ è¾“å¸¦å®½å°±è¾¾åˆ°äº†266MB/sÃ—2ï¼ˆè§¦å‘æ¬¡æ•°ï¼‰ï¼533MB/sçš„é«˜åº¦ã€‚AGP 4Xä»ä½¿ç”¨äº†è¿™ç§ä¿¡å·è§¦å‘æ–¹å¼ï¼Œåªæ˜¯åˆ©ç”¨ä¸¤ä¸ªè§¦å‘ä¿¡å·åœ¨æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸçš„ä¸‹é™æ²¿åˆ†åˆ«å¼•èµ·ä¸¤æ¬¡è§¦å‘ï¼Œä»è€Œè¾¾åˆ°äº†åœ¨ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸä¸­è§¦å‘4æ¬¡çš„ç›®çš„ï¼Œè¿™æ ·åœ¨ç†è®ºä¸Šå®ƒå°±å¯ä»¥è¾¾åˆ°266MB/sÃ—2ï¼ˆå•ä¿¡å·è§¦å‘æ¬¡æ•°ï¼‰Ã—2ï¼ˆä¿¡å·ä¸ªæ•°ï¼‰ï¼1066MB/sçš„å¸¦å®½äº†ã€‚åœ¨AGP 8Xè§„èŒƒä¸­ï¼Œè¿™ç§è§¦å‘æ¨¡å¼ä»ç„¶ä½¿ç”¨ï¼Œåªæ˜¯è§¦å‘ä¿¡å·çš„å·¥ä½œé¢‘ç‡å˜æˆ266MHzï¼Œä¸¤ä¸ªä¿¡å·è§¦å‘ç‚¹ä¹Ÿå˜æˆäº†æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸçš„ä¸Šå‡æ²¿ï¼Œå•ä¿¡å·è§¦å‘æ¬¡æ•°ä¸º4æ¬¡ï¼Œè¿™æ ·å®ƒåœ¨ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸæ‰€èƒ½ä¼ è¾“çš„æ•°æ®å°±ä»AGP4Xçš„4å€å˜æˆäº†8å€ï¼Œç†è®ºä¼ è¾“å¸¦å®½å°†å¯è¾¾åˆ°266MB/sÃ—4ï¼ˆå•ä¿¡å·è§¦å‘æ¬¡æ•°ï¼‰Ã—2ï¼ˆä¿¡å·ä¸ªæ•°ï¼‰ï¼2133MB/sçš„é«˜åº¦äº†ã€‚ ç›®å‰å¸¸ç”¨çš„AGPæ¥å£ä¸ºAGP4Xã€AGP PROã€AGPé€šç”¨åŠAGP8Xæ¥å£ã€‚éœ€è¦è¯´æ˜çš„æ˜¯ç”±äºAGP3.0æ˜¾å¡çš„é¢å®šç”µå‹ä¸º0.8â€”1.5Vï¼Œå› æ­¤ä¸èƒ½æŠŠAGP8Xçš„æ˜¾å¡æ’æ¥åˆ°AGP1.0è§„æ ¼çš„æ’æ§½ä¸­ã€‚è¿™å°±æ˜¯è¯´AGP8Xè§„æ ¼ä¸æ—§æœ‰çš„AGP1X/2Xæ¨¡å¼ä¸å…¼å®¹ã€‚è€Œå¯¹äºAGP4Xç³»ç»Ÿï¼ŒAGP8Xæ˜¾å¡ä»æ—§åœ¨å…¶ä¸Šå·¥ä½œï¼Œä½†ä»…ä¼šä»¥AGP4Xæ¨¡å¼å·¥ä½œï¼Œæ— æ³•å‘æŒ¥AGP8Xçš„ä¼˜åŠ¿ã€‚ Direct3Dä¸­å®ç°å›¾å…ƒçš„é¼ æ ‡æ‹¾å–ç´¢å¼•ï¼š 1ã€ä»€ä¹ˆæ˜¯æ‹¾å–ï¼Œæ‹¾å–èƒ½åšä»€ä¹ˆï¼Ÿ 2ã€æ‹¾å–æ“ä½œçš„æ­¥éª¤å’Œå®ç° 2.1ï¼ å˜æ¢å¹¶è·å¾—é€šè¿‡è§†ç‚¹å’Œå±å¹•ä¸Šç‚¹å‡»ç‚¹çš„å°„çº¿çŸ¢é‡ï¼ˆDirï¼‰ 2.1.1 ç¡®å®šé¼ æ ‡é€‰å–ç‚¹çš„å±å¹•åæ ‡ 2.1.2 å¾—åˆ°Diråœ¨è§‚å¯Ÿåæ ‡ç©ºé—´å†…çš„è¡¨ç¤º 2.1.3 è½¬æ¢Diråˆ°ä¸–ç•Œåæ ‡ç©ºé—´ï¼Œå¹¶å¾—åˆ°è§‚å¯Ÿç‚¹åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­çš„åæ ‡ 2.2 ä½¿ç”¨å°„çº¿çŸ¢é‡å¯¹åœºæ™¯ä¸­çš„æ‰€æœ‰ä¸‰è§’å½¢å›¾å…ƒæ±‚äº¤ï¼Œè·å¾—ä¸‰è§’å½¢ç´¢å¼•å€¼å’Œé‡å¿ƒåæ ‡ã€‚ 2.2.1 D3Dæ‰©å±•å‡½æ•°å®ç°æ±‚äº¤ 2.2.2å°„çº¿ä¸‰è§’é¢ç›¸äº¤çš„æ•°å­¦ç®—æ³• 2.2.3 æ‹¾å–å®Œæˆæ ¹æ®è·å¾—çš„ä¸­å¿ƒåæ ‡è®¡ç®—æˆ‘ä»¬å…³å¿ƒçš„å¸¸è§é‡ 3ã€ç»“æŸåŠå£°æ˜ 4ã€å‚è€ƒæ–‡çŒ® è¡¥å……ï¼šé‡å¿ƒåæ ‡çš„æ¦‚å¿µ 3Däº¤äº’å›¾å½¢åº”ç”¨ç¨‹åºä¸­ï¼Œå¸¸å¸¸è¦ç”¨é¼ æ ‡å»é€‰æ‹©å›¾å½¢ï¼Œå…¶å®ç°çš„æœºåˆ¶åŸºäºé¼ æ ‡æ‹¾å–ç®—æ³•ã€‚æœ¬æ–‡ä¸»è¦è®²è¿°å¦‚ä½•åœ¨D3Dä¸­å®ç°å›¾å…ƒçš„é¼ æ ‡æ‹¾å–ã€‚ä¸ºäº†è®¨è®ºç®€å•ï¼Œæœ¬æ–‡å‡å®šè¯»è€…ç†è§£D3D åæ ‡å˜æ¢æµç¨‹å’ŒåŸºæœ¬çš„å›¾å½¢å­¦çŸ¥è¯†ï¼Œå¦‚æœé˜…è¯»æœ‰å›°éš¾è¯·å‚è€ƒç›¸å…³èµ„æ–™ã€‚1ã€ä»€ä¹ˆæ˜¯æ‹¾å–ï¼Œæ‹¾å–èƒ½åšä»€ä¹ˆï¼Ÿ é¦–å…ˆï¼Œæ‹¾å–æ“ä½œæŒ‡å½“æˆ‘ä»¬åœ¨å±å¹•ä¸Šç”¨é¼ æ ‡ç‚¹å‡»æŸä¸ªå›¾å…ƒï¼Œåº”ç”¨ç¨‹åºèƒ½è¿”å›è¯¥å›¾å…ƒçš„ä¸€ä¸ªæ ‡å¿—å’ŒæŸäº›ç›¸å…³ä¿¡æ¯ã€‚æœ‰å›¾å½¢ç¨‹åºè®¾è®¡ç»éªŒçš„äººéƒ½çŸ¥é“ï¼Œæœ‰è¿™äº›ä¿¡æ¯å°±è¡¨ç¤ºæˆ‘ä»¬æœ‰äº†å¯¹è¯¥å›¾å…ƒçš„æ§åˆ¶æƒï¼Œæˆ‘ä»¬å¯ä»¥åˆ é™¤ï¼Œå¯ä»¥ç¼–è¾‘ï¼Œå¯ä»¥ä»»æ„å¯¹å¾…è¯¥å›¾å…ƒï¼Œè‡³äºä½ åˆ°åº•æƒ³å¹²ä»€ä¹ˆï¼Œå°±æ˜¯é˜ä¸‹è‡ªå·±çš„äº‹äº†^_^ã€‚ 2ã€æ‹¾å–æ“ä½œçš„æ­¥éª¤å’Œå®ç° æ‹¾å–ç®—æ³•çš„æ€æƒ³å¾ˆç®€å•ï¼šå¾—åˆ°é¼ æ ‡ç‚¹å‡»å¤„çš„å±å¹•åæ ‡ï¼Œé€šè¿‡æŠ•å½±çŸ©é˜µå’Œè§‚å¯ŸçŸ©é˜µæŠŠè¯¥åæ ‡è½¬æ¢ä¸ºé€šè¿‡è§†ç‚¹å’Œé¼ æ ‡ç‚¹å‡»ç‚¹çš„ä¸€æ¡å°„å…¥åœºæ™¯çš„å…‰çº¿ï¼Œè¯¥å…‰çº¿å¦‚æœä¸åœºæ™¯æ¨¡å‹çš„ä¸‰è§’å½¢ç›¸äº¤ï¼ˆæœ¬æ–‡åªå¤„ç†ä¸‰è§’å½¢å›¾å…ƒï¼‰ï¼Œåˆ™è·å–è¯¥ç›¸äº¤ä¸‰è§’å½¢çš„ä¿¡æ¯ã€‚æœ¬æ–‡è®²è¿°çš„æ–¹æ³•é™¤å¯ä»¥å¾—åˆ°ä¸‰è§’å½¢çš„ä¸€ä¸ªç´¢å¼•å·ä»¥å¤–è¿˜å¯ä»¥å¾—åˆ°ç›¸äº¤ç‚¹çš„é‡å¿ƒåæ ‡ã€‚ä»æ•°å­¦è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬åªè¦å¾—åˆ°å°„çº¿çš„æ–¹å‘çŸ¢é‡å’Œå°„çº¿çš„å‘å°„ç‚¹ï¼Œæˆ‘ä»¬å°±å…·å¤‡äº†åˆ¤æ–­å°„çº¿ä¸ç©ºé—´ä¸‰è§’é¢æ˜¯å¦ç›¸äº¤çš„æ¡ä»¶ï¼Œæœ¬æ–‡ä¸»è¦è®¨è®ºå¦‚ä½•è·å¾—è¿™äº›æ¡ä»¶ï¼Œå¹¶æè¿°äº†å°„çº¿ä¸ä¸‰è§’é¢ç›¸äº¤åˆ¤æ–­ç®—æ³•å’ŒD3Dçš„é€šå¸¸å®ç°æ–¹æ³•ã€‚ æ ¹æ®æ‹¾å–æ“ä½œçš„å¤„ç†é¡ºåºï¼Œå¤§æ¦‚å¯ä»¥ä¾æ¬¡åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤2.1ï¼ å˜æ¢å¹¶è·å¾—é€šè¿‡è§†ç‚¹å’Œå±å¹•ä¸Šç‚¹å‡»ç‚¹çš„å°„çº¿çŸ¢é‡ï¼ˆDirï¼‰è¯¦ç»†ä»‹ç»ä¹‹å‰ï¼Œä¸ºäº†å¤§å®¶æ–¹ä¾¿ç†è§£ï¼Œæˆ‘ä»¬è¦å…ˆç®€å•è¯´ä¸€ä¸‹d3dåæ ‡è½¬æ¢çš„å¤§æ¦‚æµç¨‹ï¼Œå¦‚ä¸‹å›¾: æ‰€ä»¥æˆ‘ä»¬è¦é€šè¿‡ä¸€ç³»åˆ—çš„åå˜æ¢ï¼Œå¾—åˆ°æˆ‘ä»¬å…³å¿ƒçš„å€¼åœ¨ä¸–ç•Œåæ ‡ä¸­çš„è¡¨ç¤ºã€‚ 2.1.1 ç¡®å®šé¼ æ ‡é€‰å–ç‚¹çš„å±å¹•åæ ‡ è¿™ä¸€æ­¥æ˜¯éå¸¸ç®€å•çš„Windowsç»™æˆ‘ä»¬æä¾›äº†APIæ¥å®Œæˆå±å¹•åæ ‡çš„è·å–ï¼Œä½¿ç”¨GetCursorPosè·å¾—é¼ æ ‡æŒ‡é’ˆä½ç½®ï¼Œç„¶åå†åˆ©ç”¨ScreenToClientè½¬æ¢åæ ‡åˆ°å®¢æˆ·åŒºåæ ‡ç³»(ä»¥çª—å£è§†åŒºå·¦ä¸Šè§’ä¸ºåæ ‡åŸç‚¹ï¼Œå•ä½ä¸ºåƒç´ )ï¼Œè®¾è¯¥åæ ‡ä¸ºï¼ˆPOINT screenPtï¼‰ã€‚ 2.1.2 å¾—åˆ°Diråœ¨è§‚å¯Ÿåæ ‡ç©ºé—´å†…çš„è¡¨ç¤º åœ¨è§‚å¯Ÿåæ ‡ç³»ä¸­ï¼ŒDiræ˜¯ä¸€æ¡ä»è§‚å¯Ÿåæ ‡åŸç‚¹å‡ºå‘çš„å°„çº¿ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å†ç¡®å®šä¸€ä¸ªè¯¥å°„çº¿ç»è¿‡çš„ç‚¹ï¼Œå°±å¯ä»¥å¾—åˆ°å®ƒåœ¨è§‚å¯Ÿåæ ‡ç³»ä¸­çš„è¡¨ç¤ºã€‚å‡è®¾æˆ‘ä»¬è¦æ±‚çš„å°„çº¿ä¸Šçš„å¦å¤–ä¸€ç‚¹ä¸ºè¯¥å°„çº¿ä¸é€è§†æŠ•å½±å¹³æˆªå¤´ä½“è¿‘å‰ªåˆ‡é¢çš„äº¤ç‚¹ï¼Œé’ˆå¯¹æœ€æ™®éçš„é€è§†æŠ•å½±è€Œè¨€ï¼Œé€è§†æŠ•å½±å¹³æˆªå¤´ä½“ç»æŠ•å½±å˜æ¢åï¼Œå˜æˆä¸€ä¸ª1/2ç«‹æ–¹ä½“ï¼ˆè¯·å…è®¸æˆ‘è¿™ä¹ˆå«^_^ï¼Œå› ä¸ºå®ƒçš„å¤§å°ä¸ºä¸€ä¸ªæ­£æ–¹ä½“çš„ä¸€åŠï¼Œx,yæ–¹å‘è¾¹é•¿ä¸º2ï¼Œzæ–¹å‘ä¸º1ï¼‰å¦‚å›¾ï¼š æŠ•å½±åæ ‡ç³»ä»¥è¿‘å‰ªåˆ‡é¢ä¸­å¿ƒä¸ºåæ ‡åŸç‚¹ï¼Œè¯¥ç«‹æ–¹ä½“ä»zè½´è´Ÿå‘çœ‹è¿‡å»ä¸å›¾å½¢ç¨‹åºè§†åŒºç›¸å¯¹åº”ï¼Œæœ€ç»ˆè¿‘å‰ªåˆ‡é¢ï¼ˆå‰å‰ªåˆ‡é¢ï¼‰ä¸Šä¸€ç‚¹ä¸å±å¹•åæ ‡ä¹‹é—´çš„å¯¹åº”å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ ¹æ®æ¯”ä¾‹å…³ç³»ï¼ŒscreenPtä¸æŠ•å½±ç©ºé—´ä¸Šçš„ç‚¹projPtä¹‹é—´çš„å…³ç³»ä¸º å‡è®¾å›¾å½¢ç¨‹åºçª—å£çš„å®½ä¸ºscreenWidth,é«˜ä¸ºscreenHeight, projPt.x = (screenPt.x-screenWidth/2)/screenWidth2; ï¼ˆå…¬å¼1ï¼‰ projPt.y = (screenPt.y-screenHeight/2)/screenHeight2; ï¼ˆå…¬å¼2ï¼‰ projPt.z =0;ï¼ˆå®é™…è¯¥å€¼å¯ä»»æ„å–ï¼Œä¸å½±å“æœ€ç»ˆç»“æœã€‚ä¸ºäº†å¤„ç†ç®€å•ï¼Œæˆ‘ä»¬å–æ”¹å€¼ä¸º0ï¼Œè¡¨ç¤ºè¯¥ç‚¹å–åœ¨è¿‘å‰ªåˆ‡é¢ä¸Šï¼‰ å¾—åˆ°projPtåï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯æŠŠè¯¥ç‚¹åæ ‡ä»æŠ•å½±ç©ºé—´è½¬æ¢åˆ°è§‚å¯Ÿç©ºé—´(view space), æ ¹æ®é€è§†æŠ•å½±çš„å®šä¹‰ï¼Œå¯å‡è®¾ç‚¹(projPt.xï¼ŒprojPt.yï¼ŒprojPt.z) å¯¹åº”çš„å…¶æ¬¡åæ ‡ä¸º (projPt.xprojPt.wï¼ŒprojPt.yprojPt.wï¼ŒprojPt.zprojPt.wï¼ŒprojPt.w) æˆ‘ä»¬å¯ä»¥é€šè¿‡ GetTransform( D3DTS_PROJECTION, &amp;ProjMatrix)å‡½æ•°è·å¾—æŠ•å½±çŸ©é˜µProjMatrix,åˆ™æ ¹æ®è§‚å¯Ÿç©ºé—´åˆ°æŠ•å½±ç©ºé—´çš„å˜æ¢å…³ç³»åˆ™ï¼šæŠ•å½±åæ ‡ = è§‚å¯Ÿåæ ‡Ã—æŠ•å½±çŸ©é˜µ (projPt.xprojPt.wï¼ŒprojPt.yprojPt.wï¼ŒprojPt.zprojPt.wï¼ŒprojPt.w) = (viewPt.xï¼ŒviewPt.yï¼ŒviewPt.z, 1)pProjMatrx; æ ¹æ®å®šä¹‰å’Œå›¾å½¢å­¦åŸç† ProjMatrix = = æ‰€ä»¥, (projPt.xprojPt.wï¼ŒprojPt.yprojPt.wï¼ŒprojPt.zprojPt.wï¼ŒprojPt.w) = ( viewPt.xProjMatrix._m11, viewPt.yProjMatrix._m22, viewPt.z*Q-QZn, viewPt.z) æ‰€ä»¥ projPt.xprojPt.w = viewPt.xProjMatrix._m11 projPt.yprojPt.w = viewPt.yProjMatrix._m22 projPt.zprojPt.w = viewPt.zQ-QZn ï¼ˆæ³¨æ„projPt.z = 0ï¼‰ projPt.w = viewPt.z; è§£å¾— viewPt.x = projPt.xZn/ ProjMatrix._m11; viewPt.y = projPt.yZn/ ProjMatrix._m22; viewPt.z = Zn; å¥½äº†ï¼Œåˆ°è¿™é‡Œä¸ºæ­¢æˆ‘ä»¬ç»ˆäºæ±‚å‡ºäº†å°„çº¿ä¸è¿‘å‰ªåˆ‡é¢äº¤ç‚¹åœ¨è§‚å¯Ÿåæ ‡ç³»ä¸­çš„åæ ‡ï¼Œç°åœ¨æˆ‘ä»¬æ‹¥æœ‰äº†å°„çº¿çš„å‡ºå‘ç‚¹(0,0,0)å’Œå°„çº¿æ–¹å‘ä¸Šå¦å¤–ä¸€ç‚¹(viewPt.x,viewPt.y,viewPt.z),åˆ™è¯¥å°„çº¿çš„æ–¹å‘çŸ¢é‡åœ¨è§‚å¯Ÿç©ºé—´ä¸­çš„è¡¨ç¤ºå¯ç¡®å®šä¸ºï¼ˆviewPt.x-0,viewPt.y-0,viewPt.z-0ï¼‰,åŒ–ç®€ä¸€ä¸‹ä¸‰ä¸ªåˆ†é‡åŒé™¤è¿‘å‰ªåˆ‡é¢zåæ ‡Znï¼Œè¯¥æ–¹å‘çŸ¢é‡å¯å†™ä½œ DIRview = (projPt.x/projMatrix._m11,projPt.y/projMatrix._m22,1) ä»£å…¥å…¬å¼1ï¼Œå…¬å¼2 DIRview.x = (2screenPt.x/screenWidth-1)/projMatrix._m11; DIRview.y = (2screenPt.y/screenHeight-1)/projMatrix._m22; DIRview.z = 1; å…¶ä¸­screenWidthå’ŒscreenHeightå¯ä»¥é€šè¿‡å›¾åƒæ˜¾ç¤ºçš„backBufferçš„ç›®æ ‡è¡¨é¢ï¼ˆD3DSURFACE_DESCï¼‰æ¥è·å¾—ï¼Œè¯¥è¡¨é¢åœ¨ç¨‹åºåˆå§‹åŒ–æ—¶ç”±ç”¨æˆ·åˆ›å»ºã€‚ 2.1.3 è½¬æ¢Diråˆ°ä¸–ç•Œåæ ‡ç©ºé—´ï¼Œå¹¶å¾—åˆ°è§‚å¯Ÿç‚¹åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­çš„åæ ‡ ç”±äºæœ€ç»ˆçš„è¿ç®—è¦åœ¨ä¸–ç•Œåæ ‡ç©ºé—´ä¸­è¿›è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦æŠŠçŸ¢é‡DIRviewä»è§‚å¯Ÿç©ºé—´è½¬æ¢ä¸ºä¸–ç•Œåæ ‡ç©ºé—´ä¸­çš„çŸ¢é‡DIRworldã€‚ å› ä¸º DIRview = DIRworldViewMatrix; å…¶ä¸­ViewMatrixä¸ºè§‚å¯ŸçŸ©é˜µï¼Œåœ¨D3Dä¸­å¯ä»¥ç”¨å‡½æ•°GetTransform( D3DTS_VIEW, &amp;ViewMatrix )å¾—åˆ°ã€‚ æ‰€ä»¥DIRworld = DIRview inverse_ViewMatrix,å…¶ä¸­inverse_ViewMatrixä¸ºViewMatrixçš„é€†çŸ©é˜µã€‚ è§‚å¯Ÿç‚¹åœ¨è§‚å¯Ÿåæ ‡ç³»ä¸­åæ ‡ä¸ºOriginViewï¼ˆ0ï¼Œ0ï¼Œ0ï¼Œ1ï¼‰ï¼Œæ‰€ä»¥å…¶åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­çš„åæ ‡åŒæ ·å¯ä»¥åˆ©ç”¨ViewMatrixçŸ©é˜µï¼Œåå˜æ¢è‡³ä¸–ç•Œåæ ‡ç³»ä¸­ï¼Œäº‹å®ä¸Šæˆ‘ä»¬å¯ä»¥å¾ˆç®€å•çš„åˆ¤æ–­å‡º,å…¶åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­çš„è¡¨ç¤ºä¸º: OriginWorld = (inverse_ViewMatrix._41, inverse_ViewMatrix._42, inverse_ViewMatrix._43, 1); åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œåˆ¤æ–­å°„çº¿ä¸ä¸‰è§’é¢æ˜¯å¦ç›¸äº¤çš„æ¡ä»¶å°±å®Œå…¨å…·å¤‡äº†ã€‚2.2 ä½¿ç”¨å°„çº¿çŸ¢é‡å¯¹åœºæ™¯ä¸­çš„æ‰€æœ‰ä¸‰è§’å½¢å›¾å…ƒæ±‚äº¤ï¼Œè·å¾—ä¸‰è§’å½¢ç´¢å¼•å€¼å’Œé‡å¿ƒåæ ‡ã€‚ è¿™ä¸€æ­¥éª¤åœ°å®ç°ç”±ä¸¤ç§é€”å¾„: ç¬¬ä¸€ç§æ–¹æ³•éå¸¸ç®€å•ï¼Œåˆ©ç”¨D3Dæä¾›çš„æ‰©å±•å‡½æ•°D3DXIntersectå¯ä»¥è½»æ¾æå®šä¸€åˆ‡ã€‚è§2.1 ç¬¬äºŒç§æ–¹æ³•å°±æ˜¯æˆ‘ä»¬æ ¹æ®ç©ºé—´è§£æå‡ ä½•çš„çŸ¥è¯†ï¼Œè‡ªå·±æ¥å®Œæˆå°„çº¿ä¸‰è§’å½¢çš„æ±‚äº¤ç®—æ³•ã€‚ä¸€èˆ¬æ¥è®²ï¼Œåº”ç”¨ä¸Šç”¨ç¬¬ä¸€ç§æ–¹æ³•å°±è¶³å¤Ÿäº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¦‚æœè¦æ·±å…¥çš„è¯ï¼Œå¿…é¡»ç†è§£ç›¸äº¤æ£€æµ‹çš„æ•°å­¦ç®—æ³•ï¼Œè¿™æ ·æ‰èƒ½è‡ªç”±çš„æ‰©å±•ï¼Œé¢å¯¹ä¸åŒçš„éœ€æ±‚ï¼Œå†…å®¹è§2.2 ä¸‹é¢åˆ†åˆ«è®²è§£ä¸¤ç§å®ç°é€”å¾„ï¼š 2.2.1 D3Dæ‰©å±•å‡½æ•°å®ç°æ±‚äº¤ è¿™ç§æ–¹æ³•å¾ˆç®€å•ä¹Ÿå¾ˆå¥½ç”¨ï¼Œå¯¹äºåº”ç”¨æ¥è¯´åº”å°½åŠ›æ˜¯ç”¨è¿™ç§æ–¹å¼æ¥å®ç°ï¼Œæ¯•ç«Ÿæ•ˆç‡æ¯”è‡ªå·±å†™å¾—è¦é«˜å¾—å¤šã€‚ å®é™…ä¸Šå…¶å®æ²¡ä»€ä¹ˆå¥½è®²çš„ï¼Œå¤§æ¦‚è®²ä¸€ä¸‹å‡½æ•°D3DXIntersectå§ D3D SDKè¯¥å‡½æ•°å£°æ˜å¦‚ä¸‹ HRESULT D3DXIntersect( LPD3DXBASEMESH pMesh, CONST D3DXVECTOR3 pRayPos, CONST D3DXVECTOR3 pRayDir, BOOL pHit, DWORD pFaceIndex, FLOAT pU, FLOAT pV, FLOAT pDist, LPD3DXBUFFER ppAllHits, DWORD pCountOfHits ); l pMeshæŒ‡å‘ä¸€ä¸ªID3DXBaseMeshçš„å¯¹è±¡ï¼Œæœ€ç®€å•çš„æ–¹å¼æ˜¯ä».xæ–‡ä»¶è·å¾—ï¼Œæè¿°äº†è¦è¿›è¡Œç›¸äº¤æ£€æµ‹çš„ä¸‰è§’é¢å…ƒé›†åˆçš„ä¿¡æ¯ï¼Œå…·ä½“è§„èŒƒå‚é˜…direct9 SDK l pRayPos æŒ‡å‘å°„çº¿å‘å‡ºç‚¹ l pRayDir æŒ‡å‘å‰é¢æˆ‘ä»¬è¾›è¾›è‹¦è‹¦æ±‚å‡ºçš„å°„çº¿æ–¹å‘çš„å‘é‡ l pHit å½“æ£€æµ‹åˆ°ç›¸äº¤å›¾å…ƒæ—¶ï¼ŒæŒ‡å‘ä¸€ä¸ªtrue,ä¸ä¸ä»»ä½•å›¾å…ƒç›¸äº¤åˆ™ä¸ºå‡ l pU ç”¨äºè¿”å›é‡å¿ƒåæ ‡Uåˆ†é‡ l pVè¿”å›é‡å¿ƒåæ ‡Våˆ†é‡ l pDist è¿”å›å°„çº¿å‘å‡ºç‚¹åˆ°ç›¸äº¤ç‚¹çš„é•¿åº¦ æ³¨æ„ï¼šä»¥ä¸Šçº¢è‰²å­—ä½“éƒ¨åˆ†å‡æŒ‡æœ€è¿‘çš„ä¸€ä¸ªè¿”å›ç»“æœï¼ˆå³pDistæœ€å°ï¼‰ l ppAllHitsç”¨äºå¦‚æœå­˜åœ¨å¤šä¸ªç›¸äº¤ä¸‰è§’é¢è¿”å›ç›¸äº¤çš„æ‰€æœ‰ç»“æœ l pCountOfHits è¿”å›å…±æœ‰å¤šå°‘ä¸ªä¸‰è§’å½¢ä¸è¯¥å°„çº¿ç›¸äº¤ è¡¥å……ï¼šé‡å¿ƒåæ ‡çš„æ¦‚å¿µä¸‰è§’å½¢çš„é‡å¿ƒåæ ‡ï¼š P1ï¼ŒP2ï¼ŒP3ä¸ºç©ºé—´ä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹çŸ¢é‡ï¼Œ (U,?V)å°±ç§°ä¸ºä¸‰è§’å½¢çš„é‡å¿ƒåæ ‡åœ¨ç©ºé—´ä¸‰è§’å½¢å¹³é¢ä¸Šçš„ç‚¹å¯ä»¥è¡¨ç¤ºä¸ºï¼š P?=?P1?+?U??(P2?-?P1)?+?V??(P3?-?P1)å½“0?&lt;?U?&lt;?1ï¼Œ0?&lt;?V?&lt;?1ï¼Œ0?&lt;?U?+?V?&lt;?1æ—¶ï¼Œè¿™ä¸ªç‚¹På°±åœ¨è¿™ä¸ªä¸‰è§’å½¢çš„å†…éƒ¨ æ”¶é›† å…¶ä¸­pUå’ŒpVç”¨åˆ°äº†é‡å¿ƒåæ ‡çš„æ¦‚å¿µï¼Œä¸‹é¢ç¨ä½œæè¿° ä¸€ä¸ªä¸‰è§’å½¢æœ‰ä¸‰ä¸ªé¡¶ç‚¹ï¼Œåœ¨è¿ªå¡å°”åæ ‡ç³»ä¸­å‡è®¾è¡¨ç¤ºï¼š V1(x1,y1,z1), V2(x2,y2,z2), V3(x3,y3,z3), åˆ™ä¸‰è§’å½¢å†…ä»»æ„ä¸€ç‚¹çš„åæ ‡å¯ä»¥è¡¨ç¤ºä¸ºï¼ˆpVä¸ºä»»æ„ç‚¹ï¼‰ï¼š pV = V1 + U(V2-V1) + V(V3-V1) æ‰€ä»¥å·²çŸ¥ä¸‰ä¸ªé¡¶ç‚¹åæ ‡çš„æƒ…å†µä¸‹ï¼Œä»»æ„ä¸€ç‚¹å¯ç”¨åæ ‡(U,V)æ¥è¡¨ç¤ºï¼Œå…¶ä¸­ å‚æ•°Uæ§åˆ¶V2åœ¨ç»“æœä¸­å å¤šå¤§çš„æƒå€¼ï¼Œå‚æ•°Væ§åˆ¶V3å å¤šå¤§æƒå€¼ï¼Œæœ€ç»ˆV1å å¤šå¤§æƒå€¼ = 1 - U - Vï¼Œè¿™ç§åæ ‡å®šä¹‰æ–¹å¼å°±å«é‡å¿ƒåæ ‡ã€‚ 2..2.2å°„çº¿ä¸‰è§’é¢ç›¸äº¤çš„æ•°å­¦ç®—æ³• ä½¿ç”¨d3dæ‰©å±•å‡½æ•°ï¼Œæ¯•ç«Ÿæœ‰æ—¶ä¸èƒ½æ»¡è¶³å…·ä½“éœ€æ±‚ï¼ŒæŒæ¡äº†è¯¥æ–¹æ³•ï¼Œæˆ‘ä»¬æ‰èƒ½å¤Ÿè·å¾—æœ€å¤§çš„æ§åˆ¶è‡ªç”±åº¦ï¼Œä»»æ„ä¿®æ”¹ç®—æ³•ã€‚ å·²çŸ¥æ¡ä»¶: å°„çº¿æºç‚¹orginPoint,ä¸‰è§’å½¢ä¸‰ä¸ªé¡¶ç‚¹ v1,v2,v3,å°„çº¿æ–¹å‘ Dirï¼ˆå‡ä»¥ä¸‰ç»´åæ ‡å‘é‡å½¢å¼è¡¨ç¤ºï¼‰ã€‚ ç®—æ³•ç›®çš„: åˆ¤æ–­å°„çº¿ä¸ä¸‰è§’å½¢æ˜¯å¦ç›¸äº¤ï¼Œå¦‚æœç›¸äº¤æ±‚å‡ºäº¤ç‚¹çš„é‡å¿ƒåæ ‡(U,V)å’Œå°„çº¿åŸç‚¹åˆ°äº¤ç‚¹çš„è·ç¦»Tã€‚ æˆ‘ä»¬å¯å…ˆå‡è®¾å°„çº¿ä¸ä¸‰è§’å½¢ç›¸äº¤åˆ™äº¤ç‚¹ (æ³¨ä»¥ä¸‹å‡ä¸ºå‘é‡è¿ç®—ï¼šdot(X,Y) ç‚¹ä¹˜ï¼› cross(Xï¼ŒY) å‰ä¹˜ï¼› Uï¼ŒVï¼ŒT æ ‡é‡(è¿™ä¸‰ä¸ªå€¼ä¸ºXã€Yã€Zè½´åæ ‡)) åˆ™ï¼šï¼ˆIntersectPointä¸ºä¸‰è§’å½¢ä¸Šçš„äº¤ç‚¹ï¼‰ IntersectPoint = V1 + UÃ—(V2-V1) + VÃ—(V3-V1) ; IntersectPoint = originPoint + TÃ—Dirï¼› æ‰€ä»¥ï¼š orginPoint + TÃ—Dir = V1 + UÃ—(V2-V1) + VÃ—(V3-V1); æ•´ç†å¾—ï¼š orginPoint - V1 = UÃ—(V2-V1) + VÃ—(V3-V1) - TÃ—Dir;?è¿™æ˜¯ä¸€ä¸ªç®€å•çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼Œè‹¥æœ‰è§£åˆ™è¡Œåˆ—å¼ï¼»-Dir, V2-V1, V3-V1ï¼½ä¸ä¸º0ã€‚ æ ¹æ®T,U,Vçš„å«ä¹‰å½“T&gt;0, 0&lt;U&lt;1,0&lt;V&lt;1,0&lt;U+V&lt;1æ—¶è¯¥äº¤ç‚¹åœ¨ä¸‰è§’å½¢å†…éƒ¨ï¼Œè§£æ­¤æ–¹ç¨‹ç»„å³å¯è·å¾—æˆ‘ä»¬å…³å¿ƒçš„å€¼,å…·ä½“è§£æ³•ä¸å†èµ˜è¿°ï¼Œå…‹è±å§†æ³•åˆ™å°±å¤Ÿäº†ï¼ˆè¯¦ç»†è§çº¿æ€§ä»£æ•°ï¼‰:å°„çº¿åŸç‚¹åˆ°ç›¸äº¤ç‚¹çš„è·ç¦»T,å’Œäº¤ç‚¹çš„ä¸­å¿ƒåæ ‡(U,V)ã€‚ä¸‹é¢ç»™å‡ºDirect 9 SDKç¤ºä¾‹ç¨‹åºä¸­çš„å®ç°ä»£ç ï¼šIntersectTriangle( const D3DXVECTOR3&amp; orig,?????????????????? const D3DXVECTOR3&amp; dir, D3DXVECTOR3&amp; v0,?????? ???????????? D3DXVECTOR3&amp; v1, D3DXVECTOR3&amp; v2,?????? ???????????? FLOAT t, FLOAT u, FLOAT* v ){??? // ç®—å‡ºä¸¤ä¸ªè¾¹çš„å‘é‡??? D3DXVECTOR3 edge1 = v1 - v0;??? D3DXVECTOR3 edge2 = v2 - v0;? D3DXVECTOR3 pvec; D3DXVec3Cross( &amp;pvec, &amp;dir, &amp;edge2 ); // å¦‚æœdetä¸º0ï¼Œæˆ–æ¥è¿‘äºé›¶åˆ™å°„çº¿ä¸ä¸‰è§’é¢å…±é¢æˆ–å¹³è¡Œï¼Œä¸ç›¸äº¤ //æ­¤å¤„detå°±ç›¸å½“äºä¸Šé¢çš„[-Dir, V2-V1, V3-V1]ï¼Œ??? FLOAT det = D3DXVec3Dot( &amp;edge1, &amp;pvec );???? D3DXVECTOR3 tvec;??? if( det &gt; 0 )??? {??????? tvec = orig - v0;??? }??? else??? {??????? tvec = v0 - orig;??????? det = -det;??? }???? if( det &lt; 0.0001f )??????? return FALSE;???? // è®¡ç®—uå¹¶æµ‹è¯•æ˜¯å¦åˆæ³•ï¼ˆåœ¨ä¸‰è§’å½¢å†…ï¼‰??? u = D3DXVec3Dot( &amp;tvec, &amp;pvec );??? if( u &lt; 0.0f || u &gt; det )??????? return FALSE;???? // Prepare to test V parameter??? D3DXVECTOR3 qvec;??? D3DXVec3Cross( &amp;qvec, &amp;tvec, &amp;edge1 );???? //è®¡ç®—uå¹¶æµ‹è¯•æ˜¯å¦åˆæ³•ï¼ˆåœ¨ä¸‰è§’å½¢å†…ï¼‰??? v = D3DXVec3Dot( &amp;dir, &amp;qvec );??? if( v &lt; 0.0f || u + v &gt; det )??????? return FALSE;???? /è®¡ç®—t,å¹¶æŠŠt,u,væ”¾ç¼©ä¸ºåˆæ³•å€¼ï¼ˆæ³¨æ„å‰é¢çš„t,v,uä¸åŒäºç®—æ³•æè¿°ä¸­çš„ç›¸åº”é‡ï¼Œä¹˜äº†ä¸€ä¸ªç³»æ•°detï¼‰,æ³¨æ„ï¼šç”±äºè¯¥æ­¥è¿ç®—éœ€è¦ä½¿ç”¨é™¤æ³•ï¼Œæ‰€ä»¥æ”¾åˆ°æœ€åæ¥è¿›è¡Œï¼Œé¿å…ä¸å¿…è¦çš„è¿ç®—ï¼Œæé«˜ç®—æ³•æ•ˆç‡/??? t = D3DXVec3Dot( &amp;edge2, &amp;qvec );??? FLOAT fInvDet = 1.0f / det;??? t = fInvDet;??? u = fInvDet;??? v = fInvDet;???? return TRUE;} ?2.2.3? æ‹¾å–å®Œæˆæ ¹æ®è·å¾—çš„ä¸­å¿ƒåæ ‡è®¡ç®—æˆ‘ä»¬å…³å¿ƒçš„å¸¸è§é‡æ ¹æ®é‡å¿ƒåæ ‡ï¼ˆU,Vï¼‰,æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„ç®—å‡ºå„ç§ç›¸å…³é‡æ¯”å¦‚çº¹ç†åæ ‡å’Œäº¤ç‚¹çš„å·®å€¼é¢œè‰²ï¼Œå‡è®¾ä»¥çº¹ç†åæ ‡ä¸ºä¾‹è®¾V1,V2,V3çš„çº¹ç†åæ ‡åˆ†åˆ«ä¸ºT1(tu1,tv1),T2(tu2,tv2),T3(tu3,tv3)åˆ™äº¤ç‚¹çš„åæ ‡ä¸º?IntersectPointTexture = T1 + U(T2-T1) + V(T3-T1) 3ã€ç»“æŸåŠå£°æ˜ Ok, åˆ°è¿™é‡Œä¸ºæ­¢å…³äºæ‹¾å–çš„ç›¸å…³çŸ¥è¯†å°±ä»‹ç»å®Œäº†ï¼Œå°å¼Ÿç¬¬ä¸€æ¬¡å†™è¿™ç§æ–‡ç« ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰æŠŠé—®é¢˜è¯´æ¸…æ¥šï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©ï¼Œæœ‰ä»»ä½•é—®é¢˜å¯ä»¥ç»™æˆ‘å‘email: jzhang1@mail.xidian.edu.cn æˆ–è€…åˆ°æˆ‘çš„ç½‘ç«™ç•™è¨€ï¼š www.heavysword.com å£°æ˜ï¼š æœ¬æ–‡å†™ä½œçš„ç›®çš„æ˜¯ä¸ºäº†å¹¿å¤§D3Då­¦ä¹ è€…æ–¹ä¾¿å­¦ä¹ æœåŠ¡ï¼Œæ–‡ä¸­ç®—æ³•ä¸ºä½œè€…å‚è€ƒç›¸å…³æ–‡çŒ®æ€»ç»“ï¼Œä½œè€…æ— æ„æŠŠè¿™äº›æ®ä¸ºè‡ªå·±çš„æˆæœï¼Œæ‰€æœ‰æƒåŸç®—æ³•æå‡ºè€…æ‰€æœ‰ï¼ˆå‚é˜…å‚è€ƒæ–‡çŒ®ï¼‰ï¼Œæ–‡ä¸­ä»£ç ä¸ºD3d SDKçš„ç¤ºä¾‹å†…å®¹ï¼Œç”±ç¬”è€…è¿›è¡Œäº†å¿…è¦çš„è§£é‡Šï¼Œä»£ç ç‰ˆæƒå½’microsoftæ‰€æœ‰ã€‚4ã€å‚è€ƒæ–‡çŒ® ã€1ã€‘Microsoft DirectX 9.0 SDK,microsoft ã€2ã€‘fast,Minimun Storage Ray/Triangle Intersection,Tomas Moler,Ben Trumbore ?BY å…‹è±å§†ï¼ˆCramerï¼‰æ³•åˆ™ä¸€ã€çº¿æ€§æ–¹ç¨‹ç»„ å…ƒçº¿æ€§æ–¹ç¨‹ç»„æ˜¯æŒ‡å½¢å¼ä¸ºï¼š ï¼ˆ1ï¼‰çš„æ–¹ç¨‹ç»„ï¼Œå…¶ä¸­ä»£è¡¨ä¸ªæœªçŸ¥é‡ï¼Œæ˜¯æ–¹ç¨‹çš„ä¸ªæ•°ï¼Œï¼Œ ; ç§°ä¸ºæ–¹ç¨‹ç»„çš„ç³»æ•°ï¼Œç§°ä¸ºå¸¸æ•°é¡¹ã€‚ çº¿æ€§æ–¹ç¨‹ç»„çš„ä¸€ä¸ªè§£æ˜¯æŒ‡ç”±ä¸ªæ•°ç»„æˆçš„æœ‰åºæ•°ç»„ï¼Œ å½“ä¸ªæœªçŸ¥é‡åˆ†åˆ«ç”¨ä»£å…¥åï¼Œå¼ï¼ˆ1ï¼‰ä¸­æ¯ä¸ªç­‰å¼éƒ½æˆä¸ºæ’ç­‰å¼ã€‚æ–¹ç¨‹ç»„ï¼ˆ1ï¼‰çš„è§£çš„å…¨ä½“ç§°ä¸ºå®ƒçš„è§£é›†åˆï¼Œå¦‚æœä¸¤ä¸ªçº¿æ€§æ–¹ç¨‹ç»„æœ‰ç›¸åŒçš„è§£é›†åˆï¼Œå°±ç§°å®ƒä»¬æ˜¯åŒè§£æ–¹ç¨‹ç»„ã€‚ ä¸ºäº†æ±‚è§£ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ç»„ï¼Œå¿…é¡»è®¨è®ºä»¥ä¸‹ä¸€äº›é—®é¢˜ï¼š (1).è¿™ä¸ªæ–¹ç¨‹ç»„æœ‰æ²¡æœ‰è§£ï¼Ÿ (2).å¦‚æœè¿™ä¸ªæ–¹ç¨‹ç»„æœ‰è§£ï¼Œæœ‰å¤šå°‘ä¸ªè§£ï¼Ÿ (3).åœ¨æ–¹ç¨‹ç»„æœ‰è§£æ—¶,è§£ä¹‹é—´çš„å…³ç³»,å¹¶æ±‚å‡ºå…¨éƒ¨è§£ã€‚ æœ¬èŠ‚è®¨è®ºæ–¹ç¨‹çš„ä¸ªæ•°ä¸æœªçŸ¥é‡çš„ä¸ªæ•°ç›¸ç­‰(å³)çš„æƒ…å½¢ã€‚ äºŒã€å…‹è±å§†æ³•åˆ™ å®šç†1ï¼ˆå…‹è±å§†æ³•åˆ™ï¼‰å¦‚æœçº¿æ€§æ–¹ç¨‹ç»„ ???????????ï¼ˆ2ï¼‰çš„ç³»æ•°è¡Œåˆ—å¼ï¼š é‚£ä¹ˆè¿™ä¸ªæ–¹ç¨‹ç»„æœ‰è§£ï¼Œå¹¶ä¸”è§£æ˜¯å”¯ä¸€çš„ï¼Œè¿™ä¸ªè§£å¯è¡¨ç¤ºæˆï¼š ï¼ˆ3ï¼‰å…¶ä¸­æ˜¯æŠŠä¸­ç¬¬åˆ—æ¢æˆå¸¸æ•°é¡¹æ‰€å¾—çš„è¡Œåˆ—å¼ï¼Œå³ ã€‚ åˆ†æï¼šå®šç†ä¸€å…±æœ‰3ä¸ªç»“è®ºï¼šæ–¹ç¨‹ç»„æœ‰è§£ï¼›è§£æ˜¯å”¯ä¸€çš„ï¼›è§£ç”±å…¬å¼ï¼ˆ3ï¼‰ç»™å‡ºã€‚å› æ­¤è¯æ˜çš„æ­¥éª¤æ˜¯ï¼š ç¬¬ä¸€ï¼ŒæŠŠ ä»£å…¥æ–¹ç¨‹ç»„ï¼ŒéªŒè¯å®ƒç¡®å®æ˜¯è§£ã€‚è¿™æ ·å°±è¯æ˜äº†æ–¹ç¨‹ç»„æœ‰è§£ï¼Œå¹¶ä¸”ï¼ˆ3ï¼‰æ˜¯ä¸€ä¸ªè§£ï¼Œå³è¯æ˜äº†ç»“è®ºä¸ã€‚ ç¬¬äºŒï¼Œè¯æ˜å¦‚æœæ˜¯æ–¹ç¨‹ç»„ï¼ˆï¼’ï¼‰çš„ä¸€ä¸ªè§£ï¼Œé‚£ä¹ˆä¸€å®šæœ‰ã€‚è¿™å°±è¯æ˜äº†è§£çš„å”¯ä¸€æ€§ï¼Œå³è¯æ˜äº†ç»“è®ºã€‚ è¯æ˜ï¼šå…ˆå›å¿†è¡Œåˆ—å¼çš„ä¸€ä¸ªæ€§è´¨ï¼Œè®¾é˜¶è¡Œåˆ—å¼ï¼Œåˆ™æœ‰ï¼š æ¥ä¸‹æ¥è¯æ˜å®šç†ã€‚é¦–å…ˆï¼Œè¯æ˜ï¼ˆ3ï¼‰ç¡®å®æ˜¯ï¼ˆ2ï¼‰çš„è§£ã€‚å°†è¡Œåˆ—å¼æŒ‰ç¬¬åˆ—å±•å¼€å¾—ï¼š ï¼Œå…¶ä¸­æ˜¯è¡Œåˆ—å¼ä¸­å…ƒç´ çš„ä»£æ•°ä½™å­å¼ã€‚ç°æŠŠä»£å…¥ç¬¬ä¸ªæ–¹ç¨‹çš„å·¦ç«¯ï¼Œå¾—ï¼š è¿™è¯´æ˜å°†ï¼ˆ3ï¼‰ä»£å…¥ç¬¬ä¸ªæ–¹ç¨‹åï¼Œå¾—åˆ°äº†ä¸€ä¸ªæ’ç­‰å¼ï¼Œæ‰€ä»¥ï¼ˆ3ï¼‰æ˜¯ï¼ˆ2ï¼‰çš„ä¸€ä¸ªè§£ã€‚ å…¶æ¬¡ï¼Œè®¾æ˜¯æ–¹ç¨‹ç»„ï¼ˆ2ï¼‰çš„ä¸€ä¸ªè§£ï¼Œé‚£ä¹ˆï¼Œå°†ä»£å…¥ï¼ˆ2ï¼‰åï¼Œå¾—åˆ°ä¸ªæ’ç­‰å¼ï¼š ï¼ˆ4ï¼‰ç”¨ç³»æ•°è¡Œåˆ—å¼çš„ç¬¬åˆ—çš„ä»£æ•°ä½™å­å¼ä¾æ¬¡å»ä¹˜ï¼ˆ4ï¼‰ä¸­ä¸ªæ’ç­‰å¼ï¼Œå¾—åˆ°ï¼š å°†æ­¤ä¸ªç­‰å¼ç›¸åŠ ï¼Œå¾—ï¼š ä»è€Œæœ‰ï¼šã€‚è¿™å°±æ˜¯è¯´ï¼Œå¦‚æœæ˜¯æ–¹ç¨‹ç»„ï¼ˆ2ï¼‰çš„ä¸€ä¸ªè§£ï¼Œé‚£ä¹ˆä¸€å®šæœ‰ï¼Œæ‰€ä»¥æ–¹ç¨‹ç»„åªæœ‰ä¸€ä¸ªè§£ã€‚ ä¸‰ã€é½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„ åœ¨çº¿æ€§æ–¹ç¨‹ç»„ä¸­ï¼Œæœ‰ä¸€ç§ç‰¹æ®Šçš„çº¿æ€§æ–¹ç¨‹ç»„ï¼Œå³å¸¸æ•°é¡¹å…¨ä¸ºé›¶çš„æ–¹ç¨‹ç»„ï¼Œç§°ä¸ºé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„ã€‚æ˜¾ç„¶ï¼Œé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„æ€»æ˜¯æœ‰è§£çš„ï¼Œå› ä¸ºå°±æ˜¯å®ƒçš„è§£ï¼Œè¿™ä¸ªè§£ç§°ä¸ºé›¶è§£ï¼›å…¶ä»–çš„ï¼Œå³ä¸å…¨ä¸ºé›¶çš„è§£ï¼ˆå¦‚æœè¿˜æœ‰çš„è¯ï¼‰ï¼Œç§°ä¸ºéé›¶è§£ã€‚æ‰€ä»¥ï¼Œå¯¹äºé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„ï¼Œéœ€è¦è®¨è®ºçš„é—®é¢˜ï¼Œä¸æ˜¯æœ‰æ²¡æœ‰è§£ï¼Œè€Œæ˜¯æœ‰æ²¡æœ‰éé›¶è§£ã€‚è¿™ä¸ªé—®é¢˜ä¸é½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„è§£çš„ä¸ªæ•°æ˜¯æœ‰å¯†åˆ‡å…³ç³»çš„ã€‚å¦‚æœä¸€ä¸ªé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„åªæœ‰é›¶è§£ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹ç¨‹ç»„å°±åªæœ‰å”¯ä¸€è§£ï¼›åä¹‹ï¼Œ å¦‚æœæŸä¸ªé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„æœ‰å”¯ä¸€è§£ï¼Œ é‚£ä¹ˆç”±äºé›¶è§£æ˜¯ä¸€ä¸ªè§£ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹ç¨‹ç»„ä¸å¯èƒ½æœ‰éé›¶è§£ã€‚ å¯¹äºæ–¹ç¨‹ä¸ªæ•°ä¸æœªçŸ¥é‡ä¸ªæ•°ç›¸åŒçš„é½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„ï¼Œåº”ç”¨å…‹è±å§†æ³•åˆ™ï¼Œæœ‰ æ¨è®º1? å¦‚æœé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„ ï¼ˆ5ï¼‰çš„ç³»æ•°è¡Œåˆ—å¼ä¸ç­‰äºé›¶ï¼Œé‚£ä¹ˆï¼ˆ5ï¼‰åªæœ‰é›¶è§£ã€‚ æ¨è®º2 é½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„ æœ‰éé›¶è§£çš„å¿…è¦æ¡ä»¶æ˜¯å®ƒçš„ç³»æ•°è¡Œåˆ—å¼ç­‰äºé›¶ã€‚ å››ã€ä¾‹å­ ä¾‹1 è§£çº¿æ€§æ–¹ç¨‹ç»„ è§£ï¼šæ–¹ç¨‹ç»„çš„ç³»æ•°è¡Œåˆ—å¼ï¼š æ‰€ä»¥æ ¹æ®å…‹è±å§†æ³•åˆ™ï¼Œè¿™ä¸ªçº¿æ€§æ–¹ç¨‹ç»„æœ‰å”¯ä¸€è§£ã€‚åˆå›  æ‰€ä»¥è¿™ä¸ªçº¿æ€§æ–¹ç¨‹ç»„çš„å”¯ä¸€è§£ä¸ºï¼š ä¾‹2 è§£çº¿æ€§æ–¹ç¨‹ç»„ è§£ï¼šæ–¹ç¨‹ç»„çš„ç³»æ•°è¡Œåˆ—å¼ï¼š æ‰€ä»¥æ ¹æ®å…‹è±å§†æ³•åˆ™ï¼Œè¿™ä¸ªçº¿æ€§æ–¹ç¨‹ç»„æœ‰å”¯ä¸€è§£ã€‚åˆå›  æ‰€ä»¥è¿™ä¸ªçº¿æ€§æ–¹å’Œç»„çš„å”¯ä¸€è§£ä¸ºï¼š ä¾‹3???????? å·²çŸ¥ä¸‰æ¬¡æ›²çº¿åœ¨å››ä¸ªç‚¹å¤„çš„å€¼åˆ†åˆ«ä¸ºï¼šï¼Œè¯•æ±‚å…¶ç³»æ•°ã€‚ è§£ï¼šå°†ä¸‰æ¬¡æ›²çº¿åœ¨4ç‚¹å¤„çš„å€¼ä»£å…¥å…¶æ–¹ç¨‹ï¼Œå¾—åˆ°å…³äºçš„çº¿æ€§æ–¹ç¨‹ç»„ï¼š å®ƒçš„ç³»æ•°è¡Œåˆ—å¼æ˜¯èŒƒå¾·è’™è¡Œåˆ—å¼ï¼š æ‰€ä»¥æ ¹æ®å…‹è±å§†æ³•åˆ™ï¼Œè¿™ä¸ªçº¿æ€§æ–¹ç¨‹ç»„æœ‰å”¯ä¸€è§£ã€‚åˆå›  æ‰€ä»¥ï¼Œå³æ‰€æ±‚çš„ä¸‰æ¬¡æ›²çº¿æ–¹ç¨‹ä¸ºã€‚ ä¾‹4 å¦‚æœé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„ æœ‰éé›¶è§£ï¼Œé‚£ä¹ˆå¿…é¡»æ»¡è¶³ä»€ä¹ˆæ¡ä»¶ï¼Ÿ è§£ï¼šç”±å…‹è±å§†æ³•åˆ™çŸ¥ï¼Œé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„æœ‰éé›¶è§£çš„å¿…è¦æ¡ä»¶æ˜¯å…¶ç³»æ•°è¡Œåˆ—å¼ç­‰äºé›¶ï¼Œå› æ­¤æœ‰ åˆç”±ï¼šï¼Œä»è€Œå¿…é¡»æ»¡è¶³çš„æ¡ä»¶ä¸ºã€‚ æ³¨ ç”¨å…‹è±å§†æ³•åˆ™æ±‚è§£ç³»æ•°è¡Œåˆ—å¼ä¸ç­‰äºé›¶çš„å…ƒéé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„ï¼Œéœ€è¦è®¡ç®—ä¸ªé˜¶è¡Œåˆ—å¼ï¼Œå®ƒçš„è®¡ç®—å·¥ä½œé‡å¾ˆå¤§ã€‚å®é™…ä¸Šå…³äºæ•°å­—ç³»æ•°çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼ˆåŒ…æ‹¬ç³»æ•°è¡Œåˆ—å¼ç­‰äºé›¶åŠæ–¹ç¨‹ä¸ªæ•°å’ŒæœªçŸ¥é‡ä¸ªæ•°ä¸ç›¸åŒçš„çº¿æ€§æ–¹ç¨‹ç»„ï¼‰çš„è§£æ³•ï¼Œä¸€èˆ¬éƒ½é‡‡ç”¨åç»­ç« èŠ‚ä»‹ç»çš„æ–¹æ³•æ¥æ±‚è§£ã€‚å…‹è±å§†æ³•åˆ™ä¸»è¦æ˜¯åœ¨ç†è®ºä¸Šå…·æœ‰é‡è¦çš„æ„ä¹‰ï¼Œç‰¹åˆ«æ˜¯å®ƒæ˜ç¡®åœ°æ­ç¤ºäº†æ–¹ç¨‹ç»„çš„è§£å’Œç³»æ•°ä¹‹é—´çš„å…³ç³»ã€‚]]></content>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬åå…«ç«  åƒç´ ç€è‰²å™¨å…¥é—¨(Introduction to Pixel Shaders)]]></title>
    <url>%2F2019%2F04%2F11%2FIntroduction-to-Pixel-Shaders%2F</url>
    <content type="text"><![CDATA[åƒç´ ç€è‰²å™¨æ˜¯ä¸€ä¸ªæ‰§è¡Œåœ¨å›¾å½¢å¡çš„GPUä¸Šçš„ç¨‹åºï¼Œå®ƒè¿è¡Œåœ¨å¯¹æ¯ä¸ªåƒç´ è¿›è¡Œå…‰æ …åŒ–å¤„ç†æ—¶ã€‚ï¼ˆä¸åƒé¡¶ç‚¹ç€è‰²å™¨ï¼ŒDirect3Dä¸ä¼šä»¥è½¯ä»¶æ¨¡æ‹Ÿåƒç´ ç€è‰²å™¨çš„åŠŸèƒ½ã€‚ï¼‰å®ƒå®é™…ä¸Šæ›¿æ¢äº†å›ºå®šåŠŸèƒ½ç®¡çº¿çš„å¤šçº¹ç†åŒ–é˜¶æ®µï¼ˆthe multitexturing stageï¼‰ï¼Œå¹¶èµ‹äºˆæˆ‘ä»¬ç›´æ¥æ“çºµå•ç‹¬çš„åƒç´ å’Œè®¿é—®æ¯ä¸ªåƒç´ çš„çº¹ç†åæ ‡çš„èƒ½åŠ›ã€‚è¿™ç§å¯¹åƒç´ å’Œçº¹ç†åæ ‡çš„ç›´æ¥è®¿é—®ä½¿æˆ‘ä»¬å¯ä»¥è¾¾æˆå„ç§ç‰¹æ•ˆï¼Œä¾‹å¦‚ï¼šå¤šçº¹ç†åŒ–ï¼ˆmultitexturingï¼‰ã€æ¯åƒç´ å…‰ç…§ï¼ˆper pixel lightingï¼‰ã€æ™¯æ·±ï¼ˆdepth of fieldï¼‰ã€äº‘çŠ¶ç‰©æ¨¡æ‹Ÿï¼ˆcloud simulationï¼‰ã€ç„°ç«æ¨¡æ‹Ÿï¼ˆfire simulationï¼‰ã€é«˜çº§é˜´å½±æŠ€æœ¯ï¼ˆsophisticated shadowing techniqueï¼‰ã€‚ å›¾å½¢å¡æ”¯æŒçš„åƒç´ ç€è‰²å™¨çš„ç‰ˆæœ¬å¯ä»¥é€šè¿‡D3DCAPS9ç»“æ„çš„PixelShaderVersionæˆå‘˜å’ŒD3DPS_VERSIONå®è¿›è¡Œæ£€æŸ¥ã€‚ä¸‹åˆ—ä»£ç ç‰‡æ–­å±•ç¤ºäº†è¿™ç‚¹ï¼š// If the deviceâ€™s supported version is less than version 2.0if( caps.PixelShaderVersion &lt; D3DPS_VERSION(2, 0) ) // Then pixel shader version 2.0 is not supported on this device. ç›®æ ‡ è·å¾—å¯¹å¤šçº¹ç†åŒ–æ¦‚å¿µçš„åŸºæœ¬ç†è§£ å­¦ä¹ å¦‚ä½•ç¼–å†™ã€åˆ›å»ºå¹¶ä½¿ç”¨åƒç´ ç€è‰²å™¨ å­¦ä¹ å¦‚ä½•ä½¿ç”¨åƒç´ ç€è‰²å™¨å®ç°å¤šçº¹ç†åŒ–æ•ˆæœ 18.1å¤šçº¹ç†åŒ–æ¦‚è§ˆ å¤šçº¹ç†åŒ–ï¼ˆMultitexturingï¼‰å¯èƒ½æ˜¯ç”¨åƒç´ ç€è‰²å™¨å®ç°çš„æœ€ç®€å•çš„æŠ€å·§äº†ã€‚æ­¤å¤–ï¼Œå› ä¸ºåƒç´ ç€è‰²å™¨æ›¿æ¢å¤šçº¹ç†åŒ–é˜¶æ®µï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬åº”è¯¥å¯¹å¤šçº¹ç†åŒ–â€œæ˜¯ä»€ä¹ˆâ€å’Œâ€œåšä»€ä¹ˆâ€æœ‰ä¸€ä¸ªæœ€åŸºæœ¬çš„ç†è§£ã€‚æœ¬èŠ‚ä»‹ç»å¤šçº¹ç†åŒ–çš„ç®€æ˜æ¦‚è§ˆã€‚ å½“æˆ‘ä»¬ä¸€å¼€å§‹è®¨è®ºçº¹ç†åŒ–ï¼ˆtexturingï¼‰çš„æ—¶å€™ï¼ˆç¬¬6ç« ï¼‰ï¼Œæˆ‘ä»¬å¿½ç•¥äº†å›ºå®šåŠŸèƒ½ç®¡çº¿ä¸­å¯¹å¤šçº¹ç†åŒ–çš„è®¨è®ºï¼Œè¿™æœ‰ä¸¤ä¸ªåŸå› ï¼šç¬¬ä¸€ï¼Œå¤šçº¹ç†åŒ–æ˜¯æœ‰ä¸€ç‚¹æ£˜æ‰‹çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬è€ƒè™‘åˆ°è¿™åœ¨å½“æ—¶æ˜¯ä¸€ä¸ªé«˜çº§è¯é¢˜ï¼›æ­¤å¤–ï¼Œå›ºå®šåŠŸèƒ½å¤šçº¹ç†åŒ–é˜¶æ®µè¢«æ–°çš„å’Œæ›´å¼ºæœ‰åŠ›çš„åƒç´ ç€è‰²å™¨æ›¿æ¢æ‰äº†ã€‚å› æ­¤èŠ±æ—¶é—´åœ¨å·²ç»è¿‡æ—¶çš„å›ºå®šåŠŸèƒ½çº¹ç†åŒ–é˜¶æ®µä¸Šæ˜¯æ— æ„ä¹‰çš„ã€‚ å¤šçº¹ç†åŒ–åé¢çš„æ¦‚å¿µæœ‰ä¸€ç‚¹å’Œæ··åˆï¼ˆblendingï¼‰ç›¸å…³ã€‚åœ¨ç¬¬ä¸ƒç« ä¸­æˆ‘ä»¬äº†è§£åˆ°ï¼šå¯ä»¥å°†æ­£è¦è¢«å…‰æ …åŒ–çš„åƒç´ ä¸ä¹‹å‰å†™å…¥åå°ç¼“å†²çš„åƒç´ è¿›è¡Œæ··åˆæ¥è¾¾æˆä¸€ç§ç‰¹æ•ˆã€‚æˆ‘ä»¬å»¶ä¼¸è¿™ç§ç›¸åŒçš„æ€æƒ³åˆ°å¤šçº¹ç†åŒ–ä¸­ï¼ˆmultiple textureï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¸€æ¬¡ä½¿ç”¨å‡ ä¸ªçº¹ç†ï¼Œç„¶åå®šä¹‰è¿™äº›çº¹ç†å¦‚ä½•è¢«æ··åˆåœ¨ä¸€èµ·ï¼Œä»¥è¾¾åˆ°ä¸€ç§ç‰¹æ®Šæ•ˆæœã€‚å¤šçº¹ç†åŒ–çš„ä¸€ä¸ªé€šå¸¸çš„ç”¨æ³•æ˜¯æ‰§è¡Œå…‰ç…§ã€‚ä½œä¸ºåœ¨é¡¶ç‚¹å¤„ç†é˜¶æ®µä½¿ç”¨Direct3Dçš„å…‰ç…§æ¨¡å‹çš„æ›¿ä»£ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ç§å«åšâ€œå…‰ç…§å›¾â€ï¼ˆlight mapï¼‰çš„ç‰¹æ®Šçº¹ç†è´´å›¾ï¼ˆtexture mapï¼‰ï¼Œå®ƒç¼–ç ï¼ˆencodeï¼‰è¡¨é¢æ˜¯å¦‚ä½•è¢«å…‰ç…§çš„ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬å¸Œæœ›ä¸€ç›èšå…‰ç¯ï¼ˆspotlightï¼‰ç…§åœ¨ä¸€ä¸ªå¤§æœ¨ç®±ä¸Šï¼Œæˆ‘ä»¬è¦ä¹ˆå¯ä»¥å®šä¹‰ä¸€ä¸ªD3DLIGHT9ç»“æ„çš„èšå…‰ç¯ï¼Œè¦ä¹ˆå¯ä»¥å°†ä»£è¡¨æœ¨ç®±çš„çº¹ç†è´´å›¾ä¸ä»£è¡¨èšå…‰ç¯çš„å…‰ç…§æ˜ å°„æ··åˆåœ¨ä¸€èµ·ï¼Œå¦‚å›¾18.1æ‰€ç¤ºã€‚ å›¾18.1ï¼šä½¿ç”¨å¤šçº¹ç†åŒ–æ¸²æŸ“ä¸€ä¸ªé€šè¿‡èšå…‰ç¯ç…§äº®çš„æœ¨ç®±ã€‚è¿™é‡Œæˆ‘ä»¬é€šè¿‡å°†ç›¸åº”çš„çº¹ç†åƒç´ ï¼ˆtexelsï¼‰ç›¸ä¹˜æ¥å°†è¿™ä¸¤ä¸ªçº¹ç†ç»„åˆèµ·æ¥ã€‚ æ³¨æ„ï¼šç”¨ç¬¬ä¸ƒç« é‡Œçš„æ··åˆï¼Œç»“æœå›¾åƒä¾èµ–äºçº¹ç†è¢«æ··åˆçš„æ–¹å¼ã€‚åœ¨å›ºå®šåŠŸèƒ½ç®¡çº¿çš„å¤šçº¹ç†åŒ–é˜¶æ®µï¼Œæ··åˆæ–¹ç¨‹å¼è¢«çº¹ç†æ¸²æŸ“çŠ¶æ€ï¼ˆtexture render stateï¼‰æ§åˆ¶ã€‚ç”¨åƒç´ ç€è‰²å™¨ï¼Œæˆ‘ä»¬ èƒ½å¤Ÿä»¥å¯ç¼–ç¨‹çš„æ–¹å¼åœ¨ä»£ç ä¸­å†™å‡ºæ··åˆå‡½æ•°çš„ç®€å•è¡¨è¾¾å¼ã€‚è¿™ä½¿æˆ‘ä»¬å¯ä»¥ç”¨ä»»ä½•æˆ‘ä»¬æƒ³è¦çš„æ–¹å¼æ··åˆçº¹ç†ã€‚æˆ‘ä»¬å°†åœ¨è®¨è®ºæœ¬ç« çš„ä¾‹å­ç¨‹åºæ—¶è¯¦ç»†è®¨è®ºçº¹ç†æ··åˆã€‚ æ··åˆå¤šä¸ªçº¹ç†ï¼ˆæœ¬ä¾‹ä¸­æ˜¯ä¸¤ä¸ªï¼‰æ¥ç…§äº®æœ¨ç®±æ¯”èµ·Direct3Dçš„å…‰ç…§æ¥æœ‰ä¸¤ä¸ªå¥½å¤„ï¼š å…‰ç…§æ˜¯æ˜¯é¢„å…ˆåœ¨èšå…‰ç¯çš„å…‰ç…§è´´å›¾é‡Œè®¡ç®—å¥½çš„ã€‚å› æ­¤ï¼Œå…‰ç…§ä¸éœ€è¦åœ¨è¿è¡Œæ—¶è¢«è®¡ç®—ï¼Œè¿™èŠ‚çœäº†å¤„ç†æ—¶é—´ã€‚å½“ç„¶ï¼Œåªæœ‰é™æ€å¯¹è±¡å’Œé™æ€ç¯å…‰çš„å…‰ç…§å¯ä»¥è¢«é¢„å…ˆè®¡ç®—ã€‚ å› ä¸ºå…‰ç…§å›¾æ˜¯é¢„å…ˆè®¡ç®—å¥½çš„ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨æ¯”Direct3Dçš„ï¼ˆå…‰ç…§ï¼‰æ¨¡å‹å¤šçš„å¤šçš„æ›´åŠ ç²¾ç¡®çš„å’Œæˆç†Ÿçš„å…‰ç…§æ¨¡å‹ã€‚ï¼ˆæ›´å¥½çš„å…‰ç…§å¯ä»¥äº§ç”Ÿæ›´çœŸå®çš„åœºæ™¯ã€‚ï¼‰ å¤‡æ³¨ï¼šå¤šçº¹ç†åŒ–é˜¶æ®µçš„å…¸å‹åº”ç”¨æ˜¯å®ç°é™æ€å¯¹è±¡çš„å®Œå…¨å…‰ç…§å¼•æ“ï¼ˆfull lighting engineï¼‰ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªçº¹ç†è´´å›¾ä¿å­˜å¯¹è±¡çš„é¢œè‰²ï¼Œæ¯”å¦‚æœ¨ç®±çš„çº¹ç†è´´å›¾ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ•£å°„å…‰ç…§è´´å›¾ï¼ˆdiffuse light mapï¼‰ä¿å­˜æ•£å°„è¡¨é¢ç€è‰²ï¼ˆdiffuse surface shadeï¼‰ï¼Œä¸€ä¸ªå•ç‹¬çš„é•œé¢å…‰ç…§è´´å›¾ä¿å­˜é•œé¢è¡¨é¢ç€è‰²ï¼Œä¸€ä¸ªé›¾çŠ¶ç‰©è´´å›¾ï¼ˆfog mapï¼‰ä¿å­˜è¦†ç›–åœ¨è¡¨é¢çš„é›¾çŠ¶ç‰©çš„æ€»é‡ï¼Œè¿˜æœ‰å¯ä»¥ç”¨ä¸€ä¸ªè¯¦ç»†è´´å›¾ï¼ˆdetail mapï¼‰ä¿å­˜å°çš„ã€é«˜è®¿é—®ç‡çš„è¡¨é¢çš„ç»†èŠ‚ã€‚å½“æ‰€æœ‰è¿™äº›çº¹ç†è¢«ç»„åˆèµ·æ¥ï¼Œåªéœ€åˆ°è¿™äº›é¢„å…ˆè®¡ç®—çš„çº¹ç†ä¸­æ£€ç´¢ï¼Œå°±å¯ä»¥æœ‰æ•ˆçš„ç…§äº®ã€ç€è‰²å¹¶ä¸”å¢åŠ ç»†èŠ‚åˆ°åœºæ™¯ä¸­å»ã€‚ æ³¨æ„ï¼šèšå…‰ç¯å…‰ç…§è´´å›¾åœ¨å¾ˆåŸºç¡€çš„å…‰ç…§è´´å›¾ä¸­æ˜¯ä¸€ä¸ªä»·å€¼ä¸é«˜ï¼ˆtrivialï¼‰çš„ä¾‹å­ã€‚ä¸€èˆ¬çš„çš„ç¨‹åºé€šè¿‡ç»™å®šçš„åœºæ™¯å’Œå…‰æºæ¥ç”Ÿæˆå…‰ç…§è´´å›¾ã€‚ç”Ÿæˆå…‰ç…§è´´å›¾è¶…è¶Šäº†æœ¬ä¹¦çš„èŒƒå›´ã€‚æœ‰å…´è¶£çš„è¯»è€…å¯ä»¥å‚è€ƒAlan Wattå’ŒFabio Policarpoåœ¨ã€Š3D Games: Real-time Rendering and Software Technologyã€‹ä¸­æè¿°çš„å…‰ç…§è´´å›¾ã€‚ 18.1.1 å…è®¸å¤šä¸ªçº¹ç† å›å¿†ä¸€ä¸‹ï¼Œçº¹ç†æ˜¯ç”¨IDirect3DDevice9::SetTextureæ–¹æ³•è®¾ç½®ï¼Œè€Œé‡‡æ ·å™¨çŠ¶æ€ï¼ˆsampler stateï¼‰æ˜¯ç”¨IDirect3DDevice9::SetSamplerStateæ–¹æ³•è®¾ç½®ï¼ŒåŸå‹å¦‚ä¸‹ï¼šHRESULT IDirect3DDevice9::SetTexture( DWORD Stage, // specifies the texture stage index IDirect3DBaseTexture9 *pTexture); HRESULT IDirect3DDevice9::SetSamplerState( DWORD Sampler, // specifies the sampler stage index D3DSAMPLERSTATETYPE Type, DWORD Value); æ³¨æ„ï¼šä¸€ä¸ªç‰¹å®šçš„é‡‡æ ·å™¨é˜¶æ®µç´¢å¼•Iè”åˆç¬¬iä¸ªçº¹ç†é˜¶æ®µï¼ˆtexture stageï¼‰ã€‚å³ç¬¬iä¸ªé‡‡æ ·å™¨é˜¶æ®µæŒ‡å®šé‡‡æ ·å™¨çŠ¶æ€æ˜¯ç¬¬ié›†ï¼ˆsetï¼‰çº¹ç†ã€‚ çº¹ç†/é‡‡æ ·å™¨é˜¶æ®µç´¢å¼•æ ‡è¯†äº†æˆ‘ä»¬å¸Œæœ›è®¾ç½®çš„çº¹ç†/é‡‡æ ·å™¨çš„çº¹ç†/é‡‡æ ·å™¨é˜¶æ®µã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å…è®¸å¤šä¸ªçº¹ç†å¹¶é€šè¿‡ä½¿ç”¨ä¸åŒçš„é˜¶æ®µç´¢å¼•è®¾ç½®å…¶ç›¸åº”çš„é‡‡æ ·å™¨çŠ¶æ€ã€‚åœ¨æœ¬ä¹¦å‰é¢çš„éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬æ€»æ˜¯æŒ‡å®š0ï¼Œæ¥æŒ‡ç¤ºç¬¬ä¸€ä¸ªé˜¶æ®µï¼Œå› ä¸ºæˆ‘ä»¬ä¸€æ¬¡ä»…ä½¿ç”¨ä¸€ä¸ªçº¹ç†ã€‚æ‰€ä»¥ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬è¦å…è®¸ä¸‰ä¸ªçº¹ç†ï¼Œæˆ‘ä»¬åƒè¿™æ ·ä½¿ç”¨é˜¶æ®µ0,1å’Œ2ï¼š// Set first texture and corresponding sampler states.Device-&gt;SetTexture(0, Tex1);Device-&gt;SetSamplerState(0, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR);Device-&gt;SetSamplerState(0, D3DSAMP_MINFILTER, D3DTEXF_LINEAR);Device-&gt;SetSamplerState(0, D3DSAMP_MIPFILTER, D3DTEXF_LINEAR); // Set second texture and corresponding sampler states.Device-&gt;SetTexture(1, Tex2);Device-&gt;SetSamplerState(1, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR);Device-&gt;SetSamplerState(1, D3DSAMP_MINFILTER, D3DTEXF_LINEAR);Device-&gt;SetSamplerState(1, D3DSAMP_MIPFILTER, D3DTEXF_LINEAR); // Set third texture and corresponding sampler states.Device-&gt;SetTexture(2, Tex3);Device-&gt;SetSamplerState(2, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR);Device-&gt;SetSamplerState(2, D3DSAMP_MINFILTER, D3DTEXF_LINEAR);Device-&gt;SetSamplerState(2, D3DSAMP_MIPFILTER, D3DTEXF_LINEAR);è¿™æ®µä»£ç ä½¿ç”¨Tex1, Tex2å’ŒTex3ï¼Œå¹¶è®¾ç½®æ¯ä¸ªçº¹ç†çš„è¿‡æ»¤æ¨¡å¼ã€‚ 18.1.2 å¤šçº¹ç†åæ ‡ å›å¿†ä¸€ä¸‹ç¬¬å…­ç« ï¼Œå¯¹äºæ¯ä¸ª3Dä¸‰è§’å½¢ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨çº¹ç†ä¸Šå®šä¹‰ä¸€ä¸ªä¸‰è§’å½¢ä»¥æ˜ å°„è¯¥3Dä¸‰è§’å½¢ã€‚æˆ‘ä»¬é€šè¿‡å¯¹æ¯ä¸ªé¡¶ç‚¹å¢åŠ çº¹ç†åæ ‡å®Œæˆæ˜ å°„ã€‚å› æ­¤ï¼Œæ¯ä¸‰ä¸ªé¡¶ç‚¹å®šä¹‰ä¸€ä¸ªä¸‰è§’å½¢ï¼Œå®ƒå¯¹åº”äºçº¹ç†ä¸Šçš„ä¸‰è§’å½¢ã€‚ å› ä¸ºæˆ‘ä»¬ç°åœ¨ä½¿ç”¨å¤šçº¹ç†ï¼Œæ¯ä¸‰ä¸ªé¡¶ç‚¹å®šä¹‰ä¸€ä¸ªä¸‰è§’å½¢ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ¯ä¸ªè¢«ä½¿ç”¨çš„çº¹ç†ä¸Šå®šä¹‰ä¸€ä¸ªç›¸åº”çš„ä¸‰è§’å½¢ã€‚æˆ‘ä»¬é€šè¿‡ç»™æ¯ä¸ªé¡¶ç‚¹å¢åŠ é¢å¤–çš„ä¸€å¥—çº¹ç†åæ ‡â€”â€”æ¯ä¸ªé¡¶ç‚¹ä¸€å¥—ï¼Œå¯¹åº”äºæ¯ä¸ªä½¿ç”¨çš„çº¹ç†ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æ··åˆä¸‰ä¸ªçº¹ç†åˆ°ä¸€èµ·ï¼Œé‚£ä¹ˆæ¯ä¸ªé¡¶ç‚¹å¿…é¡»æœ‰ä¸‰å¥—çº¹ç†åæ ‡ä»¥ç´¢å¼•åˆ°ä¸‰ä¸ªä½¿ç”¨çš„çº¹ç†ã€‚å› æ­¤ï¼Œä¸€ä¸ªåŒ…å«ä¸‰ä¸ªçº¹ç†çš„å¤šçº¹ç†åŒ–é¡¶ç‚¹ç»“æ„çœ‹èµ·æ¥å¯èƒ½åƒè¿™æ ·ï¼šstruct MultiTexVertex{ MultiTexVertex(float x, float y, float z, float u0, float v0, float u1, float v1, float u2, float v2) { _x = x; _y = y; _z = z; _u0 = u0; _v0 = v0; _u1 = u1; _v1 = v1; _u2 = u2; _v2 = v2; } float _x, _y, _z; float _u0, _v0; // Texture coordinates for texture at stage 0. float _u1, _v1; // Texture coordinates for texture at stage 1. float _u2, _v2; // Texture coordinates for texture at stage 2. static const DWORD FVF; };const DWORD MultiTexVertex::FVF = D3DFVF_XYZ | D3DFVF_TEX3; æ³¨æ„ï¼ŒæŒ‡å®šè‡ªç”±é¡¶ç‚¹æ ¼å¼æ ‡è®°D3DFVF_TEX3è¡¨æ˜é¡¶ç‚¹ç»“æ„åŒ…å«3å¥—çº¹ç†åæ ‡ã€‚å›ºå®šåŠŸèƒ½ç®¡çº¿æ”¯æŒæœ€å¤š8å¥—çº¹ç†åæ ‡ã€‚å¦‚æœå¤šäº8å¥—ï¼Œä½ å¿…é¡»ä½¿ç”¨é¡¶ç‚¹å£°æ˜å’Œå¯ç¼–ç¨‹é¡¶ç‚¹ç®¡çº¿ã€‚ æ³¨æ„ï¼šåœ¨æ–°ç‰ˆæœ¬åƒç´ ç€è‰²å™¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€å¥—çº¹ç†åæ ‡é›†æ¥ç´¢å¼•å¤šä¸ªçº¹ç†ï¼Œå¹¶å› æ­¤æ¶ˆé™¤äº†å¯¹å¤šä¸ªçº¹ç†åæ ‡çš„éœ€è¦ã€‚å½“ç„¶è¿™å¾—å‡è®¾æ¯ä¸ªçº¹ç†é˜¶æ®µä½¿ç”¨ç›¸åŒçš„çº¹ç†åæ ‡ã€‚å¦‚æœæ¯ä¸ªé˜¶æ®µçš„çº¹ç†åæ ‡ä¸åŒï¼Œåˆ™æˆ‘ä»¬ä»ç„¶éœ€è¦å¤šçº¹ç†åæ ‡ã€‚ åƒç´ ç€è‰²å™¨è¾“å…¥å’Œè¾“å‡ºæœ‰ä¸¤æ ·ä¸œè¥¿è¦è¾“å…¥åˆ°åƒç´ ç€è‰²å™¨ï¼šé¢œè‰²å’Œçº¹ç†åæ ‡ã€‚ä¸¤æ ·éƒ½æ˜¯ä»¥æ¯åƒç´ ä¸ºå•ä½çš„ã€‚æ³¨æ„ï¼šå›æƒ³ä¸€ä¸‹ï¼Œé¡¶ç‚¹é¢œè‰²æ˜¯åœ¨å›¾å…ƒçš„é¢ï¼ˆface of primitiveï¼‰é—´è¿›è¡Œæ’å€¼çš„ã€‚æ¯ä¸ªåƒç´ çš„çº¹ç†åæ ‡å°±æ˜¯ç®€å•çš„ (u , v) ï¼Œå®ƒæŒ‡å®šäº†çº¹ç†çš„å“ªä¸ªå›¾ç´ è¢«æ˜ å°„åˆ°åƒç´ ä¸Šã€‚åœ¨è¾“å…¥åˆ°åƒç´ ç€è‰²å™¨å‰ï¼ŒDirect3Dæ ¹æ®é¡¶ç‚¹é¢œè‰²å’Œé¡¶ç‚¹çº¹ç†åæ ‡ï¼Œä¸ºæ¯ä¸ªåƒç´ è®¡ç®—é¢œè‰²å’Œçº¹ç†åæ ‡ã€‚è¾“å…¥åˆ°åƒç´ ç€è‰²å™¨çš„é¢œè‰²å’Œçº¹ç†åæ ‡çš„æ•°å€¼ä¾èµ–äºé¡¶ç‚¹ç€è‰²å™¨è¾“å‡ºçš„é¢œè‰²å’Œçº¹ç†åæ ‡çš„æ•°å€¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªé¡¶ç‚¹ç€è‰²å™¨è¾“å‡ºäº†ä¸¤ä¸ªé¢œè‰²å’Œä¸‰ä¸ªçº¹ç†åæ ‡ï¼Œé‚£ä¹ˆDirect3Då°†ä¼šä¸ºæ¯ä¸ªåƒç´ è®¡ç®—ä¸¤ä¸ªé¢œè‰²å’Œä¸‰ä¸ªçº¹ç†åæ ‡å¹¶ä¸”æŠŠå®ƒä»¬æŠŠå®ƒä»¬è¾“å…¥åˆ°åƒç´ ç€è‰²å™¨ã€‚æˆ‘ä»¬ä½¿ç”¨å¸¦è¯­æ„çš„è¯­æ³•ï¼ˆsemantic syntaxï¼‰æ˜ å°„è¾“å…¥é¢œè‰²å’Œçº¹ç†åæ ‡è¿›æˆ‘ä»¬çš„ç€è‰²å™¨ç¨‹åºçš„å˜é‡é‡Œã€‚ç”¨å‰é¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š12345678struct PS_INPUT&#123; vector c0 : COLOR0; vector c1 : COLOR1; float2 t0 : TEXCOORD0; float2 t1 : TEXCOORD1; float2 t2 : TEXCOORD2;&#125;; å¯¹äºè¾“å‡ºï¼Œåƒç´ ç€è‰²å™¨åªè¾“å‡ºä¸€ä¸ªè®¡ç®—è¿‡çš„è¯¥åƒç´ çš„é¢œè‰²å€¼ï¼š1234struct PS_OUTPUT&#123; vector finalPixelColor : COLOR0;&#125;; ä½¿ç”¨åƒç´ ç€è‰²å™¨çš„æ­¥éª¤ä¸‹é¢çš„åˆ—è¡¨æ¦‚è¿°äº†åˆ›å»ºå’Œä½¿ç”¨åƒç´ ç€è‰²å™¨çš„å¿…è¦æ­¥éª¤ï¼š ç¼–å†™å¹¶ç¼–è¯‘åƒç´ ç€è‰²å™¨ åˆ›å»ºä¸€ä¸ªIDirect3DPixelShader9æ¥å£æ¥ä»£è¡¨åŸºäºå·²ç¼–è¯‘ä»£ç çš„åƒç´ ç€è‰²å™¨ ç”¨IDirect3DDevice9::SetPixelShaderæ–¹æ³•å…è®¸è¯¥åƒç´ ç€è‰²å™¨ å½“ç„¶ï¼Œç”¨å®Œé¡¶ç‚¹ç€è‰²å™¨ä¹‹åæˆ‘ä»¬å¿…é¡»é”€æ¯å®ƒã€‚ä¸‹é¢å‡ ä¸ªå°èŠ‚å°†æ·±å…¥è¿™äº›æ­¥éª¤ã€‚ 18.3.1 ç¼–å†™å¹¶ç¼–è¯‘åƒç´ ç€è‰²å™¨ æˆ‘ä»¬ç”¨ä¸ç¼–è¯‘é¡¶ç‚¹ç€è‰²å™¨ä¸€æ ·çš„æ–¹å¼ç¼–è¯‘åƒç´ ç€è‰²å™¨ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»ç¼–å†™ä¸€ä¸ªåƒç´ ç€è‰²å™¨ç¨‹åºã€‚æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬ç”¨HLSLç¼–å†™æˆ‘ä»¬çš„ç€è‰²å™¨ã€‚ä¸€æ—¦å†™å¥½ç€è‰²å™¨ä»£ç ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨D3DXCompileShaderFromFileå‡½æ•°ç¼–è¯‘è¯¥ç€è‰²å™¨äº†ï¼Œå¦‚16.2èŠ‚æ‰€è¿°ã€‚å›å¿†ä¸€ä¸‹ï¼Œè¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªID3DXBufferæŒ‡é’ˆï¼Œå®ƒåŒ…å«å·²ç¼–è¯‘çš„ç€è‰²å™¨ä»£ç ã€‚ æ³¨æ„ï¼šå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯åƒç´ ç€è‰²å™¨ï¼Œæ‰€ä»¥è¦è®°å¾—æŠŠç¼–è¯‘ç›®æ ‡æ”¹æˆåƒç´ ç€è‰²å™¨ç›®æ ‡ï¼ˆæ¯”å¦‚ï¼šps_2_0ï¼‰ï¼Œè€Œä¸æ˜¯é¡¶ç‚¹ç€è‰²å™¨ç›®æ ‡ï¼ˆæ¯”å¦‚ï¼švs_2_0ï¼‰ã€‚ç¼–è¯‘ç›®æ ‡é€šè¿‡D3DXCompileShaderFromFileå‡½æ•°çš„ä¸€ä¸ªå‚æ•°æŒ‡å®šã€‚è¯¦è§16.2èŠ‚ã€‚18.3.2 åˆ›å»ºåƒç´ ç€è‰²å™¨ ä¸€æ—¦æˆ‘ä»¬ç¼–è¯‘äº†ç€è‰²å™¨ä»£ç ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å¾—ä¸€ä¸ªIDirect3DPixelShaderçš„æ¥å£æŒ‡é’ˆï¼Œå®ƒä»£è¡¨ä¸€ä¸ªåƒç´ ç€è‰²å™¨ï¼Œä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼šHRESULT IDirect3DDevice9::CreatePixelShader( CONST DWORD pFunction, IDirect3DPixelShader9* ppShader);pFunctionâ€”â€”å·²ç¼–è¯‘ç€è‰²å™¨ä»£ç çš„æŒ‡é’ˆppShaderâ€”â€”è¿”å›ä¸€ä¸ªIDirect3DPixelShader9æ¥å£çš„æŒ‡é’ˆ ä¾‹å¦‚ï¼Œå‡è®¾å˜é‡shaderæ˜¯ä¸€ä¸ªåŒ…å«å·²ç¼–è¯‘ç€è‰²å™¨ä»£ç çš„ID3DXBufferæ¥å£æŒ‡é’ˆã€‚é‚£ä¹ˆè¦è·å¾—IDirect3DPixelShader9æ¥å£ï¼Œæˆ‘ä»¬åº”è¯¥å†™ï¼šIDirect3DPixelShader9 MultiTexPS = 0;hr = Device-&gt;CreatePixelShader( (DWORD)shader-&gt;GetBufferPointer(), &amp;MultiTexPS);æ³¨æ„ï¼šé‡ç”³ä¸€éï¼ŒD3DXCompileShaderFromFileæ˜¯ä¸€ä¸ªå¯ä»¥è¿”å›å·²ç¼–è¯‘ç€è‰²å™¨ä»£ç ï¼ˆshaderï¼‰çš„å‡½æ•°ã€‚ 18.3.3 å»ºç«‹åƒç´ ç€è‰²å™¨ åœ¨æˆ‘ä»¬è·å¾—ä¸€ä¸ªä»£è¡¨æˆ‘ä»¬çš„åƒç´ ç€è‰²å™¨çš„IDirect3DPixelShader9æ¥å£çš„æŒ‡é’ˆä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ä½¿ç”¨å®ƒï¼šHRESULT IDirect3DDevice9::SetPixelShader( IDirect3DPixelShader9* pShader); è¿™ä¸ªæ–¹æ³•åªæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬é€šè¿‡å®ƒä¼ é€’ä¸€ä¸ªæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨çš„æŒ‡å‘åƒç´ ç€è‰²å™¨çš„æŒ‡é’ˆã€‚è¦ä½¿ç”¨æˆ‘ä»¬åœ¨18.3.2èŠ‚åˆ›å»ºçš„åƒç´ ç€è‰²å™¨ï¼Œæˆ‘ä»¬åº”è¯¥å†™ï¼šDevice-&gt;SetPixelShader(MultiTexPS); 18.3.4 é”€æ¯åƒç´ ç€è‰²å™¨ å’Œå…¶å®ƒæ‰€æœ‰Direct3Dæ¥å£ä¸€æ ·ï¼Œè¦æ¸…é™¤è¿™äº›æ¥å£ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ä½¿ç”¨å®Œæ¯•åè°ƒç”¨å®ƒä»¬çš„Releaseæ–¹æ³•ã€‚ç»§ç»­ä½¿ç”¨æˆ‘ä»¬åœ¨18.3.2èŠ‚åˆ›å»ºçš„åƒç´ ç€è‰²å™¨ï¼Œæˆ‘ä»¬å†™ï¼šd3d::Release(MultiTexPS); 18.4 HLSLé‡‡æ ·å™¨å¯¹è±¡ åœ¨åƒç´ ç€è‰²å™¨ä¸­ä½¿ç”¨HLSLçš„å†…å»ºå‡½æ•°tex*XXXXç»™çº¹ç†é‡‡æ ·ã€‚æ³¨æ„ï¼šé‡‡æ ·æ—¶å¼•ç”¨çº¹ç†ä¸Šå›¾ç´ çš„åæ ‡ç´¢å¼•å’Œé‡‡æ ·å™¨çŠ¶æ€æ¥ç”Ÿæˆåƒç´ ã€‚ çœ‹16.7èŠ‚è¯¦ç»†åœ°è§£é‡Šäº†è¿™äº›å‡½æ•°ï¼Œé€šå¸¸è¿™äº›å‡½æ•°éœ€è¦æˆ‘ä»¬åš2ä»¶äº‹ï¼š ä½¿ç”¨çº¹ç†ä¸­çš„ç´¢å¼•å»ºç«‹(u, v)çº¹ç†åæ ‡ã€‚ ç»™ç‰¹å®šçš„çº¹ç†ä¸­ç¼–å…¥ç´¢å¼•ã€‚ å°†çº¹ç†åæ ‡ï¼ˆu, vï¼‰è¾“å…¥åˆ°åƒç´ ç€è‰²å™¨ï¼Œåœ¨ä¸€ä¸ªæŒ‡å®šçš„HLSLå¯¹è±¡ä¸­çš„åƒç´ ç€è‰²å™¨ä¸­ï¼Œæˆ‘ä»¬æƒ³ç¼–å…¥ç´¢å¼•çš„çº¹ç†æ˜¯åœ¨åƒç´ ç€è‰²å™¨ä¸­è¢«å®šä¹‰è¿‡çš„ï¼Œåœ¨HLSLä¸­å«ä½œé‡‡æ ·å™¨ã€‚ï¼ˆThe particular texture that we want to index into is identified in the pixel shader by a special HLSL object called a sampler.ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠé‡‡æ ·å™¨å¯¹è±¡æƒ³è±¡æˆå®šä¹‰çº¹ç†å’Œé‡‡æ ·å™¨é˜¶æ®µçš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼šå‡å¦‚æˆ‘ä»¬ä½¿ç”¨3å¼ çº¹ç†ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦åœ¨åƒç´ ç€è‰²å™¨é‡Œèƒ½å¤Ÿå¼•ç”¨3ä¸ªé˜¶æ®µä¸­çš„æ¯ä¸ªä¸€ä¸ªã€‚åœ¨åƒç´ ç€è‰²å™¨ä¸­æˆ‘ä»¬è¿™æ ·å†™ï¼šsampler FirstTex;sampler SecondTex;sampler ThirdTex; Direct3Då°†ç»™æ¯ä¸ªé‡‡æ ·å™¨å¯¹è±¡è¿æ¥ä¸€ä¸ªå”¯ä¸€çš„çº¹ç†çº§åˆ«(stage)ï¼Œåœ¨åº”ç”¨ç¨‹åºä¸­æˆ‘ä»¬æ‰¾å‡ºä¸é‡‡æ ·å™¨å¯¹è±¡ç›¸å…³è”çš„é˜¶æ®µï¼Œå¹¶è®¾ç½®ç›¸åº”çš„çº¹ç†å’Œé‡‡æ ·å™¨çŠ¶æ€ç»™è¯¥é˜¶æ®µã€‚ä¸‹åˆ—ä»£ç å°†ä¸¾ä¾‹è¯´æ˜å¦‚ä½•åœ¨åº”ç”¨ç¨‹åºä¸­è®¾ç½®çº¹ç†å¹¶æŠŠé‡‡æ ·å™¨çŠ¶æ€è®¾ç½®ä¸ºFirstTexï¼š// åˆ›å»ºIDirect3DTexture9* Tex;D3DXCreateTextureFromFile(Device, â€œtex.bmpâ€, &amp;Tex);â€¦ â€¦// å–å¾—å¸¸é‡FirstTexçš„å¥æŸ„FirstTexHandle = MultiTexCT-&gt;GetConstantByName(0, â€œFirstTexâ€); // å–å¾—å¸¸é‡çš„æè¿°D3DXCONSTANT_DESC FirstTexDesc;UINT count;MultiTexCT-&gt;GetConstantDesc(FirstTexHandle, &amp;FirstTexDesc, &amp;count);â€¦ â€¦// ä¸ºFirstTexè®¾ç½®çº¹ç†å’Œé‡‡æ ·å™¨çŠ¶æ€. We identify// the stage FirstTex is associated with from the// D3DXCONSTANT_DESC::RegisterIndex member:Device-&gt;SetTexture(FirstTexDesc.RegisterIndex, Tex); Device-&gt;SetSamplerState(FirstTexDesc.RegisterIndex, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR);Device-&gt;SetSamplerState(FirstTexDesc.RegisterIndex, D3DSAMP_MINFILTER, D3DTEXF_LINEAR);Device-&gt;SetSamplerState(FirstTexDesc.RegisterIndex, D3DSAMP_MIPFILTER, D3DTEXF_LINEAR); æ³¨æ„ï¼šä½œä¸ºé€‰æ‹©ï¼Œæ›¿æ¢ä½¿ç”¨é‡‡æ ·å™¨ç±»å‹ï¼Œä½ å¯ä»¥ä½¿ç”¨æ›´å¤šç‰¹æ®Šçš„ã€å¼ºå¤§çš„ç±»å‹ï¼Œå¦‚ï¼šsampler1Dï¼Œsampler2Dï¼Œsampler3Dï¼Œå’ŒsamplerCubeç±»å‹ï¼Œè¿™äº›ç±»å‹æ›´å®‰å…¨å¹¶ä¸”å®ƒä»¬åªä½¿ç”¨tex å‡½æ•°ã€‚ä¾‹å¦‚ï¼šä¸€ä¸ªsampler2Då¯¹è±¡åªä½¿ç”¨tex2Då‡½æ•°ï¼ŒåŒæ ·ä¸€ä¸ªsampler3Då¯¹è±¡åªä½¿ç”¨tex3D*å‡½æ•°ã€‚18.5 ä¾‹å­ç¨‹åºï¼šMultitexturing in a Pixel Shader è¿™ç« ä¸­çš„ä¾‹å­æ¼”ç¤ºäº†åœ¨åƒç´ ç€è‰²å™¨ä¸­ä½¿ç”¨å¤šçº¹ç†ï¼Œè¿™ä¸ªä¾‹å­å°†çº¹ç†ä¸€ä¸ªåŸºäºå›¾18.2æ–¹æ ¼ï¼Œæ¸²æŸ“çš„ç›®æ ‡æ˜¯ä¸€ä¸ªæœ¨ç®±çº¹ç†ï¼Œä¸€ä¸ªèšå…‰ç¯çº¹ç†ï¼Œå’Œä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸²çš„çº¹ç†ã€‚è¿™å°±æ˜¯ä¾‹å­ç¨‹åºï¼šPixel Shaderã€‚ å›¾18.2: æ··åˆçº¹ç†. è®©æˆ‘ä»¬åˆ†åˆ«å–å¾—æœ¨ç®±çº¹ç†ä¸Šã€èšå…‰ç¯çº¹ç†å’Œå­—ç¬¦ä¸²çº¹ç†ä¸Šç›¸å…³è”çš„åƒç´ é¢œè‰²ï¼šbï¼Œså’Œtï¼Œç„¶åå®šä¹‰å¦‚ä½•å°†è¿™äº›é¢œè‰²æ··åˆï¼š c = b Ã— s + t ã€‚ è¿™ä¸ªä¾‹å­å¯ä»¥ä¸ä½¿ç”¨åƒç´ ç€è‰²å™¨æ¥å®ç°ï¼Œä½†å®ç°è¿™ä¸ªç¨‹åºæ˜¯ç®€å•ç›´æ¥ï¼Œå®ƒå…è®¸æˆ‘ä»¬ç¤ºèŒƒå¦‚ä½•å†™ï¼Œåˆ›å»ºï¼Œè€Œä¸”ä½¿ç”¨åƒç´ ç€è‰²å™¨å®ç°ä¸€äº›ç‰¹æ•ˆä¸å¿…ä½¿ç”¨é‚£äº›å¤æ‚çš„ç®—æ³•ã€‚ è™½ç„¶åœ¨è¿™ä¸ªä¾‹å­ä¸­ä¸€æ¬¡åªä½¿ç”¨3å¼ çº¹ç†ï¼Œæ£€æŸ¥é‡‡æ ·å™¨å¯¹è±¡çš„æˆå‘˜ä»¥ç¡®å®šæ¯ä¸ªåƒç´ ç€è‰²å™¨èƒ½å¤Ÿä½¿ç”¨çš„ç‰ˆæœ¬ï¼Œè¿™æ˜¯å€¼å¾—çš„ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬ä¸€æ¬¡èƒ½ä½¿ç”¨å¤šå°‘çº¹ç†è¿™ä¾èµ– äºä½¿ç”¨çš„åƒç´ ç€è‰²å™¨çš„ç‰ˆæœ¬ã€‚ åƒç´ ç€è‰²å™¨çš„ç‰ˆæœ¬ps_1_1 åˆ° ps_1_3æ”¯æŒ4ä¸ªçº¹ç†é‡‡æ ·å™¨ã€‚ åƒç´ ç€è‰²å™¨çš„ç‰ˆæœ¬ps_1_4æ”¯æŒ6ä¸ªçº¹ç†é‡‡æ ·å™¨ã€‚ åƒç´ ç€è‰²å™¨çš„ç‰ˆæœ¬ps_2_0åˆ° ps_3_0æ”¯æŒ16ä¸ªçº¹ç†é‡‡æ ·å™¨ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041// File: ps_multitex.txt// Desc: Pixel shader that does multitexturing.// Globalssampler BaseTex;sampler SpotLightTex;sampler StringTex;// Structuresstruct PS_INPUT&#123; float2 base : TEXCOORD0; float2 spotlight : TEXCOORD1; float2 text : TEXCOORD2;&#125;;struct PS_OUTPUT&#123; vector diffuse : COLOR0;&#125;;// MainPS_OUTPUT Main(PS_INPUT input)&#123; // zero out members of output PS_OUTPUT output = (PS_OUTPUT)0; // sample appropriate textures vector b = tex2D(BaseTex, input.base); vector s = tex2D(SpotLightTex, input.spotlight); vector t = tex2D(StringTex, input.text); // combine texel colors vector c =b *s +t; // increase the intensity of the pixel slightly c += 0.1f; // save the resulting pixel color output.diffuse = c; return output;&#125; é¦–å…ˆåƒç´ ç€è‰²å™¨å®šä¹‰äº†3ä¸ªsamplerå¯¹è±¡ï¼Œè¦æ¸²æŸ“çš„æ¯ä¸ªçº¹ç†ï¼Œæ¥ä¸‹æ¥å®šä¹‰æ˜¯inputå’Œoutputç»“æ„ã€‚æ³¨æ„ï¼šæˆ‘ä»¬æ²¡æœ‰å°†ä»»ä½•çš„é¢œè‰²å€¼è¾“å…¥åˆ°åƒç´ ç€è‰²å™¨ä¸­ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çº¹ç†è‡ªå·±çš„é¢œè‰²å’Œå…‰ç…§ï¼›å³BaseTexä¿å­˜è¡¨é¢çš„é¢œè‰²ï¼ŒSpotLightTexæ˜¯å…‰ç…§å›¾ã€‚åƒç´ ç€è‰²å™¨è¾“å‡ºåªä¸€ä¸ªç®€é¢œè‰²å€¼ï¼ŒæŒ‡å®šäº†æˆ‘ä»¬è®¡ç®—è¿‡çš„è¿™ä¸ªç‰¹å®šåƒç´ çš„é¢œè‰²ã€‚Mainå‡½æ•°ä½¿ç”¨tex2Då‡½æ•°é‡‡æ ·3 ä¸ªçº¹ç†ï¼Œå³å®ƒå–å¾—æ¯ä¸ªçº¹ç†çš„å›¾ç´ ï¼Œè®¡ç®—æ˜ å°„åˆ°çš„åƒç´ ï¼Œè¿™é€šå¸¸ä¾èµ–äºæŒ‡å®šçš„çº¹ç†åæ ‡å’Œé‡‡æ ·å™¨å¯¹è±¡ã€‚ç„¶åæˆ‘ä»¬æ··åˆå›¾ç´ çš„é¢œè‰²ç”¨å…¬å¼ï¼šc = b * s + tã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è®©å…¨éƒ¨çš„åƒç´ å˜äº®ä¸€ä¸ªbitï¼Œç»™æ¯ä¸ªéƒ¨åˆ†å¢åŠ 0.1fã€‚æœ€åæˆ‘ä»¬ä¿å­˜ç»“æœåƒç´ é¢œè‰²å¹¶è¿”å›å®ƒã€‚ç°åœ¨æˆ‘ä»¬çœ‹åˆ°äº†çš„åƒç´ ç€è‰²å™¨çš„ä»£ç ï¼Œç°åœ¨æˆ‘ä»¬æ”¹å˜å¹¶è€ƒè™‘åº”ç”¨ç¨‹åºçš„ä»£ç ã€‚åº”ç”¨ç¨‹åºæœ‰ä¸‹åˆ—ç›¸åº”çš„å…¨å±€å˜é‡ï¼š123456789101112131415IDirect3DPixelShader9* MultiTexPS = 0;ID3DXConstantTable* MultiTexCT = 0;IDirect3DVertexBuffer9* QuadVB = 0;IDirect3DTexture9* BaseTex = 0;IDirect3DTexture9* SpotLightTex = 0;IDirect3DTexture9* StringTex = 0;D3DXHANDLE BaseTexHandle = 0;D3DXHANDLE SpotLightTexHandle = 0;D3DXHANDLE StringTexHandle = 0;D3DXCONSTANT_DESC BaseTexDesc;D3DXCONSTANT_DESC SpotLightTexDesc;D3DXCONSTANT_DESC StringTexDesc; å¤šçº¹ç†é¡¶ç‚¹ç»“æ„çš„ä¾‹å­å¦‚ä¸‹ï¼š123456789101112131415161718192021struct MultiTexVertex&#123; MultiTexVertex(float x, float y, float z, float u0, float v0, float u1, float v1, float u2, float v2) &#123; _x = x; _y = y; _z = z; _u0 = u0; _v0 = v0; _u1 = u1; _v1 = v1; _u2 = u2, _v2 = v2; &#125; float _x, _y, _z; float _u0, _v0; float _u1, _v1; float _u2, _v2; static const DWORD FVF;&#125;;const DWORD MultiTexVertex::FVF = D3DFVF_XYZ | D3DFVF_TEX3; å®ƒåŒ…å«3ä¸ªçº¹ç†åæ ‡ç³»ç»Ÿã€‚ Setupå‡½æ•°æ‰§è¡Œä¸‹åˆ—åŠŸèƒ½ï¼š å¡«å……æ–¹å½¢çš„é¡¶ç‚¹ç¼“å­˜ ç¼–è¯‘ç€åƒç´ è‰²å™¨ åˆ›å»ºåƒç´ è‰²å™¨ è¯»å–çº¹ç† è®¾ç½®æŠ•å½±çŸ©é˜µï¼Œä¸ä½¿ç”¨å…‰ç…§ å–å¾—é‡‡æ ·å™¨(sampler)å¯¹è±¡çš„å¥æŸ„ å–å¾—é‡‡æ ·å™¨å¯¹è±¡çš„æè¿°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100bool Setup()&#123; HRESULT hr = 0; // Create quad geometry. Device-&gt;CreateVertexBuffer( 6 * sizeof(MultiTexVertex), D3DUSAGE_WRITEONLY, MultiTexVertex::FVF, D3DPOOL_MANAGED, &amp;QuadVB, 0); MultiTexVertex*v =0; QuadVB-&gt;Lock(0, 0, (void**)&amp;v, 0); v[0] = MultiTexVertex(-10.0f, -10.0f, 5.0f, 0.0f, 1.0f, 0.0f, 1.0f, 0.0f, 1.0f); v[1] = MultiTexVertex(-10.0f, 10.0f, 5.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f); v[2] = MultiTexVertex( 10.0f, 10.0f, 5.0f, 1.0f, 0.0f, 1.0f, 0.0f, 1.0f, 0.0f); v[3] = MultiTexVertex(-10.0f, -10.0f, 5.0f, 0.0f, 1.0f, 0.0f, 1.0f, 0.0f, 1.0f); v[4] = MultiTexVertex( 10.0f, 10.0f, 5.0f, 1.0f, 0.0f, 1.0f, 0.0f, 1.0f, 0.0f); v[5] = MultiTexVertex( 10.0f, -10.0f, 5.0f, 1.0f, 1.0f, 1.0f, 1.0f, 1.0f, 1.0f); QuadVB-&gt;Unlock(); // Compile shader ID3DXBuffer* shader = 0; ID3DXBuffer* errorBuffer = 0; hr = D3DXCompileShaderFromFile( "ps_multitex.txt", 0, 0, "Main", // entry point function name "ps_1_1", D3DXSHADER_DEBUG, &amp;shader, &amp;errorBuffer, &amp;MultiTexCT); // output any error messages if( errorBuffer ) &#123; ::MessageBox(0, (char*)errorBuffer-&gt;GetBufferPointer(), 0, 0); d3d::Release&lt;ID3DXBuffer*&gt;(errorBuffer); &#125; if(FAILED(hr)) &#123; ::MessageBox(0, "D3DXCompileShaderFromFile() - FAILED", 0, 0); return false; &#125; // Create Pixel Shader hr = Device-&gt;CreatePixelShader((DWORD*)shader-&gt;GetBufferPointer(),&amp;MultiTexPS); if(FAILED(hr)) &#123; ::MessageBox(0, "CreateVertexShader - FAILED", 0, 0); return false; &#125; d3d::Release&lt;ID3DXBuffer*&gt;(shader); // Load textures. D3DXCreateTextureFromFile(Device, "crate.bmp", &amp;BaseTex); D3DXCreateTextureFromFile(Device, "spotlight.bmp", &amp;SpotLightTex); D3DXCreateTextureFromFile(Device, "text.bmp", &amp;StringTex); // Set projection matrix D3DXMATRIX P; D3DXMatrixPerspectiveFovLH(&amp;P, D3DX_PI * 0.25f, (float)Width / (float)Height, 1.0f, 1000.0f); Device-&gt;SetTransform(D3DTS_PROJECTION, &amp;P); // Disable lighting. Device-&gt;SetRenderState(D3DRS_LIGHTING, false); // Get handles BaseTexHandle = MultiTexCT-&gt;GetConstantByName(0, "BaseTex"); SpotLightTexHandle = MultiTexCT-&gt;GetConstantByName(0, "SpotLightTex"); StringTexHandle = MultiTexCT-&gt;GetConstantByName(0, "StringTex"); // Set constant descriptions: UINT count; MultiTexCT-&gt;GetConstantDesc(BaseTexHandle, &amp;BaseTexDesc, &amp;count); MultiTexCT-&gt;GetConstantDesc(SpotLightTexHandle, &amp;SpotLightTexDesc, &amp;count); MultiTexCT-&gt;GetConstantDesc(StringTexHandle,&amp;StringTexDesc, &amp;count); MultiTexCT-&gt;SetDefaults(Device); return true;&#125; Displayå‡½æ•°è®¾ç½®åƒç´ ç€è‰²å™¨ï¼Œä½¿ç”¨2ä¸ªçº¹ç†ï¼Œå¹¶ä¸”åœ¨æ¸²æŸ“æ–¹æ ¼å‰è®¾ç½®ä»–ä»¬å¯¹åº”çš„é‡‡æ ·å™¨çŠ¶æ€ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950bool Display(float timeDelta)&#123; if( Device ) &#123; // ...camera update code snipped // Render Device-&gt;Clear(0, 0, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER, 0xffffffff, 1.0f, 0); Device-&gt;BeginScene(); // set the pixel shader Device-&gt;SetPixelShader(MultiTexPS); Device-&gt;SetFVF(MultiTexVertex::FVF); Device-&gt;SetStreamSource(0, QuadVB, 0, sizeof(MultiTexVertex)); // base tex Device-&gt;SetTexture(BaseTexDesc.RegisterIndex, BaseTex); Device-&gt;SetSamplerState(BaseTexDesc.RegisterIndex, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR); Device-&gt;SetSamplerState(BaseTexDesc.RegisterIndex, D3DSAMP_MINFILTER, D3DTEXF_LINEAR); Device-&gt;SetSamplerState(BaseTexDesc.RegisterIndex, D3DSAMP_MIPFILTER, D3DTEXF_LINEAR); // spotlight tex Device-&gt;SetTexture(SpotLightTexDesc.RegisterIndex, SpotLightTex); Device-&gt;SetSamplerState(SpotLightTexDesc.RegisterIndex, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR); Device-&gt;SetSamplerState(SpotLightTexDesc.RegisterIndex, D3DSAMP_MINFILTER, D3DTEXF_LINEAR); Device-&gt;SetSamplerState(SpotLightTexDesc.RegisterIndex, D3DSAMP_MIPFILTER, D3DTEXF_LINEAR); // string tex Device-&gt;SetTexture( StringTexDesc.RegisterIndex, StringTex); Device-&gt;SetSamplerState(StringTexDesc.RegisterIndex, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR); Device-&gt;SetSamplerState(StringTexDesc.RegisterIndex, D3DSAMP_MINFILTER, D3DTEXF_LINEAR); Device-&gt;SetSamplerState(StringTexDesc.RegisterIndex, D3DSAMP_MIPFILTER, D3DTEXF_LINEAR); // draw the quad Device-&gt;DrawPrimitive(D3DPT_TRIANGLELIST, 0, 2); Device-&gt;EndScene(); Device-&gt;Present(0, 0, 0, 0);&#125;return true;&#125; å½“ç„¶æˆ‘ä»¬å¿…é¡»æƒ³ç€åœ¨Cleanupå‡½æ•°ä¸­é‡Šæ”¾æˆ‘ä»¬è‡ªå·±åˆ†é…çš„æ¥å£ã€‚12345678910void Cleanup()&#123; d3d::Release&lt;IDirect3DVertexBuffer9*&gt;(QuadVB); d3d::Release&lt;IDirect3DTexture9*&gt;(BaseTex); d3d::Release&lt;IDirect3DTexture9*&gt;(SpotLightTex); d3d::Release&lt;IDirect3DTexture9*&gt;(StringTex); d3d::Release&lt;IDirect3DPixelShader9*&gt;(MultiTexPS); d3d::Release&lt;ID3DXConstantTable*&gt;(MultiTexCT);&#125; æ‘˜è¦ åƒç´ ç€è‰²å™¨å–ä»£äº†å›ºå®šåŠŸèƒ½ç®¡çº¿çš„å¤šçº¹ç†çº§åˆ«ï¼ˆstageï¼‰ï¼Œè€Œä¸”ï¼Œåƒç´ ç€è‰²å™¨ç»™æˆ‘ä»¬æ›´æ”¹å•ç‹¬åƒç´ çš„èƒ½åŠ›ï¼Œä»¥ä»»ä½•æ–¹å¼é€‰æ‹©å’Œè®¿é—®çº¹ç†æ•°æ®ã€‚å› è€Œï¼Œä½¿æˆ‘ä»¬èƒ½å®ç°å¾ˆå¤šä½¿ç”¨å›ºå®šåŠŸèƒ½ç®¡çº¿æ‰€ä¸èƒ½å®Œæˆçš„ç‰¹æ®Šæ•ˆæœã€‚ å¤šçº¹ç†æ˜¯ä¸€æ¬¡ä½¿ç”¨å‡ ä¸ªçº¹ç†ï¼Œå¹¶æ¸²æŸ“å®ƒä»¬ä¸€èµ·åˆ›é€ å‡ºä¸€ä¸ªæƒ³è¦çš„ç»“æœçš„ä¸€ä¸ªè¿‡ç¨‹ã€‚å¤šçº¹ç†ä»£è¡¨æ€§çš„ç”¨æ³•æ˜¯ç”¨å®ƒä¸ºé™æ€å‡ ä½•å›¾å½¢å®ç°å…‰å¼•æ“ã€‚ HLSLå†…å»ºçš„é‡‡æ ·å™¨ï¼ˆsamplerï¼‰å¯¹è±¡ï¼Œæ ‡è¯†ç‰¹å®šçš„çº¹ç†/é‡‡æ ·å™¨çº§åˆ«ï¼ˆstageï¼‰ã€‚Aé‡‡æ ·å™¨å¸¸ç”¨äºä»åƒç´ ç€è‰²å™¨ä¸­å¼•ç”¨ä¸€ä¸ªçº¹ç†/é‡‡æ ·å™¨çº§åˆ«ã€‚ æ³¨æ„ï¼šä¸€æ—¦ä½ æ‡‚å¾—äº†å¦‚ä½•å»å®ç°é¡¶ç‚¹å’Œåƒç´ ç€è‰²å™¨ï¼Œä½ éœ€è¦çš„ä¸€äº›ç‰¹æ•ˆçš„åˆ›æ„ï¼Œå¯ä»¥ç”¨å®ƒä»¬å»å®ç°ã€‚å¾—åˆ°ç‰¹æ•ˆåˆ›æ„æœ€å¥½çš„æ–¹æ³•æ˜¯ï¼Œå­¦ä¹ ç°æœ‰çš„ç”¨é¡¶ç‚¹å’Œåƒç´ ç€è‰²å™¨å®ç°çš„ç‰¹æ•ˆã€‚ã€ŠDirect3D ShaderX: Vertex and Pixel Shader Tipsã€‹å’Œã€ŠTricks edited by Wolfgang Engelã€‹è¿™2æœ¬ä¹¦æ˜¯ä¼—å¤šå‡ºç‰ˆç‰©ä¸­æœ€å¥½çš„ï¼ŒåƒNvidiaå’ŒATIçš„å¼€å‘ç«™ç‚¹ï¼šhttp://developer.nvidia.com/ å’Œ http://ati.com/developer/index.htmlã€‚å¦å¤–æˆ‘ä»¬æ¨èCGæ–¹é¢ï¼šç”±Randima Fernando å’Œ Mark J. Kilgardå†™çš„ã€ŠThe Cg Tutorial by Randima Fernandoã€‹ï¼Œè¿™æœ¬ä¹¦å¯¹äºä½¿ç”¨Cgçš„3Då›¾å½¢ç¼–ç¨‹æ˜¯ä¸€æœ¬ç›¸å½“å¥½çš„æŒ‡å—ï¼Œå®ƒåŸºæœ¬ä¸Šå’ŒDirect3Dâ€™s HLSLç›¸åŒã€‚]]></content>
      <categories>
        <category>Direct3D</category>
      </categories>
      <tags>
        <tag>å›¾å½¢å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Introduction-to-Vertex-Shaders]]></title>
    <url>%2F2019%2F04%2F11%2FIntroduction-to-Vertex-Shaders%2F</url>
    <content type="text"><![CDATA[ç¬¬åä¸ƒç«  é¡¶ç‚¹ç€è‰²å™¨å…¥é—¨(Introduction to Vertex Shaders)æ¦‚è§ˆ é¡¶ç‚¹ç€è‰²å™¨ï¼ˆvertex shaderï¼‰æ˜¯ä¸€ä¸ªåœ¨å›¾å½¢å¡çš„GPUä¸Šæ‰§è¡Œçš„ç¨‹åºï¼Œå®ƒæ›¿æ¢äº†å›ºå®šåŠŸèƒ½ç®¡çº¿ï¼ˆfixed function pipelineï¼‰ä¸­çš„å˜æ¢ï¼ˆtransformationï¼‰å’Œå…‰ç…§ï¼ˆlightingï¼‰é˜¶æ®µã€‚ï¼ˆè¿™ä¸æ˜¯ç™¾åˆ†ä¹‹ç™¾çš„æ­£ç¡®ï¼Œå› ä¸ºé¡¶ç‚¹ç€è‰²å™¨å¯ä»¥è¢«Direct3Dè¿è¡Œæ—¶ï¼ˆDirect3D runtimeï¼‰ä»¥è½¯ä»¶æ¨¡æ‹Ÿï¼Œå¦‚æœç¡¬ä»¶ä¸æ”¯æŒé¡¶ç‚¹ç€è‰²å™¨çš„è¯ï¼‰ã€‚å›¾16.1è¯´æ˜äº†ç®¡çº¿ä¸­é¡¶ç‚¹ç€è‰²å™¨æ›¿æ¢çš„éƒ¨ä»¶ã€‚ å›¾16.1ï¼šé¡¶ç‚¹ç€è‰²å™¨æ›¿æ¢å›ºå®šåŠŸèƒ½ç®¡çº¿çš„å…‰ç…§å’Œå˜å½¢é˜¶æ®µ ä»å›¾16.1ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œé¡¶ç‚¹ä»¥å±€éƒ¨åæ ‡è¾“å…¥åˆ°é¡¶ç‚¹ç€è‰²å™¨ï¼Œå¹¶ä¸”å¿…é¡»è¾“å‡ºé½æ¬¡å‰ªè£ç©ºé—´çš„æœ‰é¢œè‰²çš„é¡¶ç‚¹ã€‚ï¼ˆä¸ºäº†ä¿æŒç®€å•ï¼Œæœ¬ä¹¦ä¸­æˆ‘ä»¬æ²¡æœ‰æ·±å…¥ç ”ç©¶æŠ•å½±å˜æ¢çš„ç»†èŠ‚ã€‚ä½†æ˜¯ç»æŠ•å½±çŸ©é˜µå˜æ¢é¡¶ç‚¹åçš„ç©ºé—´ç§°ä½œé½æ¬¡å‰ªè£ç©ºé—´ï¼ˆhomogeneous clip spaceï¼‰ã€‚å› æ­¤ï¼Œè¦æŠŠä¸€ä¸ªé¡¶ç‚¹ä»å±€éƒ¨ç©ºé—´å˜æ¢åˆ°é½æ¬¡åæ ‡ç©ºé—´ï¼Œæˆ‘ä»¬å¿…é¡»åº”ç”¨ä¸‹åˆ—å˜æ¢åºåˆ—ï¼šä¸–ç•Œå˜æ¢ï¼ˆworld transformationï¼‰ï¼Œè§†å›¾å˜æ¢ï¼ˆview transformationï¼‰å’ŒæŠ•å½±å˜æ¢ï¼ˆprojection transformationï¼‰ï¼Œå®ƒä»¬åˆ†åˆ«ç”±ä¸–ç•ŒçŸ©é˜µï¼Œè§†å›¾çŸ©é˜µå’ŒæŠ•å½±çŸ©é˜µæ¥å®Œæˆã€‚ï¼‰å¯¹äºç‚¹å…ƒï¼ˆpoint primitiveï¼‰ï¼Œé¡¶ç‚¹ç€è‰²å™¨ä¹Ÿè¢«ç”¨äºæ“ä½œæ¯ä¸ªé¡¶ç‚¹çš„é¡¶ç‚¹å¤§å°ã€‚ ç”±äºé¡¶ç‚¹ç€è‰²å™¨æ˜¯æˆ‘ä»¬ï¼ˆåœ¨HLSLä¸­ï¼‰å†™çš„ä¸€ä¸ªè‡ªå®šä¹‰ç¨‹åºï¼Œå› æ­¤æˆ‘ä»¬åœ¨å›¾å½¢æ•ˆæœæ–¹é¢è·å¾—äº†æˆ‘ä»¬èƒ½å¤Ÿè¾¾åˆ°çš„æå¤§çš„è‡ªç”±æ€§ã€‚æˆ‘ä»¬ä¸å†å—é™äºDirect3Dçš„å›ºå®šå…‰ç…§ç®—æ³•ã€‚æ­¤å¤–ï¼Œåº”ç”¨ç¨‹åºæ“çºµé¡¶ç‚¹ä½ç½®çš„èƒ½åŠ›ä¹Ÿæœ‰äº†å¤šæ ·æ€§ï¼Œä¾‹å¦‚ï¼šcloth simulationï¼Œç²’å­ç³»ç»Ÿçš„ç‚¹å¤§å°æ“çºµï¼Œè¿˜æœ‰é¡¶ç‚¹æ··åˆ/morphingã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬çš„é¡¶ç‚¹æ•°æ®ç»“æ„æ›´è‡ªç”±äº†ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å¯ç¼–ç¨‹ç®¡çº¿ä¸­åŒ…å«æ¯”åœ¨å›ºå®šåŠŸèƒ½ç®¡çº¿ä¸­å¤šå¾—å¤šçš„æ•°æ®ã€‚ é¡¶ç‚¹ç€è‰²å™¨ä»ç„¶æ˜¯ç›¸å¯¹æ–°çš„ç‰¹æ€§ï¼Œå¹¶ä¸”è®¸å¤šå›¾å½¢å¡ä¸æ”¯æŒå®ƒä»¬ï¼Œç‰¹åˆ«æ˜¯éšDirectX 9å‘å¸ƒçš„è¾ƒæ–°ç‰ˆæœ¬çš„é¡¶ç‚¹ç€è‰²å™¨ã€‚é€šè¿‡æ£€æŸ¥D3DCAPS9ç»“æ„çš„VertexShaderVersionæˆå‘˜ï¼Œå¯ä»¥æµ‹è¯•é¡¶ç‚¹ç€è‰²å™¨çš„ç‰ˆæœ¬ã€‚ä¸‹åˆ—ä»£ç æ®µå±•ç¤ºäº†è¿™ä¸€ç‚¹ï¼š// If the deviceâ€™s supported version is less than version 2.0if( caps.VertexShaderVersion &lt; D3DVS VERSION(2, 0) ) // Then vertex shader version 2.0 is not supported on this device. æˆ‘ä»¬çœ‹åˆ°D3D_VERSIONçš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ¥æ”¶ä¸»å’Œæ¬¡ç‰ˆæœ¬å·ã€‚ç°åœ¨ï¼ŒD3DXCompileShaderFromFileå‡½æ•°æ”¯æŒé¡¶ç‚¹ç€è‰²å™¨ç‰ˆæœ¬1.1å’Œ2.0ã€‚ ç›®æ ‡ å­¦ä¹ å¦‚ä½•åœ¨å¯ç¼–ç¨‹ç®¡çº¿ä¸­å®šä¹‰é¡¶ç‚¹ç»“æ„çš„åˆ†é‡ äº†è§£é¡¶ç‚¹åˆ†é‡çš„ä¸åŒç”¨æ³• å­¦ä¹ å¦‚ä½•åˆ›å»ºã€è®¾ç½®å’Œé”€æ¯ä¸€ä¸ªé¡¶ç‚¹ç€è‰²å™¨ å­¦ä¹ å¦‚ä½•ä½¿ç”¨é¡¶ç‚¹ç€è‰²å™¨å®ç°å¡é€šåŠ¨ç”»æ¸²æŸ“æ•ˆæœ 17.1é¡¶ç‚¹å£°æ˜ åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨è‡ªç”±é¡¶ç‚¹æ ¼å¼ï¼ˆflexible vertex formatï¼ŒFVFï¼‰æ¥æè¿°é¡¶ç‚¹ç»“æ„ä¸­çš„å„åˆ†é‡ã€‚ä½†æ˜¯ï¼Œåœ¨å¯ç¼–ç¨‹ç®¡çº¿ä¸­ï¼Œé¡¶ç‚¹æ•°æ®åŒ…å«çš„æ•°æ®æ¯”ç”¨FVFæ‰€èƒ½è¡¨è¾¾çš„å¤šå¾ˆå¤šã€‚å› æ­¤ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨æ›´å…·è¡¨è¾¾æ€§å¹¶ä¸”æ›´å¼ºå¤§çš„é¡¶ç‚¹å£°æ˜ï¼ˆvertex declarationï¼‰ã€‚ æ³¨æ„ï¼šå¦‚æœFVFèƒ½å¤Ÿæè¿°æˆ‘ä»¬çš„é¡¶ç‚¹æ ¼å¼ æˆ‘ä»¬ä»ç„¶å¯ä»¥åœ¨å¯ç¼–ç¨‹ç®¡çº¿ä¸­ä½¿ç”¨å®ƒã€‚ä¸ç®¡ç”¨ä½•ç§æ–¹æ³•ï¼Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿ï¼ŒåŒæ ·FVFä¼šåœ¨å†…éƒ¨è¢«è½¬æ¢ä¸ºä¸€ä¸ªé¡¶ç‚¹å£°æ˜ã€‚ 17.1.1 æè¿°é¡¶ç‚¹å£°æ˜ æˆ‘ä»¬å°†ä¸€ä¸ªé¡¶ç‚¹å£°æ˜æè¿°ä¸ºä¸€ä¸ªD3DVERTEXELEMENT9ç»“æ„çš„æ•°ç»„ã€‚D3DVERTEXELEMENT9æ•°ç»„ä¸­çš„æ¯ä¸ªæˆå‘˜æè¿°äº†ä¸€ä¸ªé¡¶ç‚¹çš„åˆ†é‡ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ çš„é¡¶ç‚¹ç»“æ„æœ‰ä¸‰ä¸ªåˆ†é‡ï¼ˆä¾‹å¦‚ï¼šä½ç½®ã€æ³•çº¿ã€é¢œè‰²ï¼‰ï¼Œé‚£ä¹ˆå…¶ç›¸åº”çš„é¡¶ç‚¹å£°æ˜å°†æè¿°3ä¸ªD3DVERTEXELEMENT9ç»“æ„çš„æ•°ç»„ã€‚è¿™ä¸ªD3DVERTEXELEMENT9ç»“æ„å®šä¹‰å¦‚ä¸‹ï¼štypedef struct _D3DVERTEXELEMENT9 { BYTE Stream; BYTE Offset; BYTE Type; BYTE Method; BYTE Usage; BYTE UsageIndex;} D3DVERTEXELEMENT9; Streamâ€”â€”æŒ‡å®šå…³è”åˆ°é¡¶ç‚¹åˆ†é‡çš„æµ Offsetâ€”â€”åç§»ï¼ŒæŒ‰å­—èŠ‚ï¼Œç›¸å¯¹äºé¡¶ç‚¹ç»“æ„æˆå‘˜çš„é¡¶ç‚¹åˆ†é‡çš„å¼€å§‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœé¡¶ç‚¹ç»“æ„æ˜¯ï¼šstruct Vertex{ D3DXVECTOR3 pos; D3DXVECTOR3 normal;};â€¦â€¦posåˆ†é‡çš„åç§»æ˜¯0ï¼Œå› ä¸ºå®ƒæ˜¯ç¬¬ä¸€ä¸ªåˆ†é‡ï¼›normalåˆ†é‡çš„åç§»æ˜¯12ï¼Œå› ä¸ºsizeof(pos) == 12ã€‚æ¢å¥è¯è¯´ï¼Œnormalåˆ†é‡ä»¥Vertexçš„ç¬¬12ä¸ªå­—èŠ‚ä¸ºå¼€å§‹ã€‚ Typeâ€”â€”æŒ‡å®šæ•°æ®ç±»å‹ã€‚å®ƒå¯ä»¥æ˜¯D3DDECLTYPEæšä¸¾ç±»å‹çš„ä»»æ„æˆå‘˜ï¼›å®Œæ•´åˆ—è¡¨è¯·å‚è§æ–‡æ¡£ã€‚å¸¸ç”¨ç±»å‹å¦‚ä¸‹ï¼š D3DDECLTYPE_FLOAT1â€”â€”æµ®ç‚¹æ•°å€¼ D3DDECLTYPE_FLOAT2â€”â€”2Dæµ®ç‚¹å‘é‡ D3DDECLTYPE_FLOAT3â€”â€”3Dæµ®ç‚¹å‘é‡ D3DDECLTYPE_FLOAT4â€”â€”4Dæµ®ç‚¹å‘é‡ D3DDECLTYPE_D3DCOLORâ€”D3DCOLORç±»å‹ï¼Œå®ƒæ‰©å±•ä¸ºRGBAæµ®ç‚¹é¢œè‰²å‘é‡(r g b a)ï¼Œå…¶æ¯ä¸€åˆ†é‡éƒ½æ˜¯å½’ä¸€åŒ–åˆ°åŒºé—´[0, 1]äº†çš„ã€‚ Methodâ€”â€”æŒ‡å®šç½‘æ ¼åŒ–æ–¹æ³•ã€‚æˆ‘ä»¬è®¤ä¸ºè¿™ä¸ªå‚æ•°æ˜¯é«˜çº§çš„ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨é»˜è®¤å€¼ï¼Œæ ‡è¯†ä¸ºD3DDECLMETHOD_DEFAULT.ã€‚ Usageâ€”â€”æŒ‡å®šå·²è®¡åˆ’çš„å¯¹é¡¶ç‚¹åˆ†é‡çš„ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œå®ƒæ˜¯å¦å‡†å¤‡ç”¨äºä¸€ä¸ªä½ç½®å‘é‡ã€æ³•çº¿å‘é‡ã€çº¹ç†åæ ‡ç­‰ï¼Ÿæœ‰æ•ˆçš„ç”¨é€”æ ‡è¯†ç¬¦ï¼ˆusage identifierï¼‰æ˜¯D3DDECLUSAGEæšä¸¾ç±»å‹çš„ï¼štypedef enum _D3DDECLUSAGE { D3DDECLUSAGE_POSITION = 0, // Position. D3DDECLUSAGE_BLENDWEIGHTS = 1, // Blending weights. D3DDECLUSAGE_BLENDINDICES = 2, // Blending indices. D3DDECLUSAGE_NORMAL = 3, // Normal vector. D3DDECLUSAGE_PSIZE = 4, // Vertex point size. D3DDECLUSAGE_TEXCOORD = 5, // Texture coordinates. D3DDECLUSAGE_TANGENT = 6, // Tangent vector. D3DDECLUSAGE_BINORMAL = 7, // Binormal vector. D3DDECLUSAGE_TESSFACTOR = 8, // Tessellation factor. D3DDECLUSAGE_POSITIONT = 9, // Transformed position. D3DDECLUSAGE_COLOR = 10, // Color. D3DDECLUSAGE_FOG = 11, // Fog blend value. D3DDECLUSAGE_DEPTH = 12, // Depth value. D3DDECLUSAGE_SAMPLE = 13 // Sampler data.} D3DDECLUSAGE; D3DDECLUSAGE_PSIZEç±»å‹ç”¨äºæŒ‡å®šä¸€ä¸ªé¡¶ç‚¹çš„ç‚¹çš„å¤§å°ã€‚å®ƒç”¨äºç‚¹ç²¾çµï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åŸºäºæ¯ä¸ªé¡¶ç‚¹æ§åˆ¶å…¶å¤§å°ã€‚ä¸€ä¸ªD3DDECLUSAGE_POSITIONæˆå‘˜çš„é¡¶ç‚¹å£°æ˜æ„å‘³ç€è¿™ä¸ªé¡¶ç‚¹å·²ç»è¢«å˜æ¢ï¼Œå®ƒé€šçŸ¥å›¾å½¢å¡ä¸è¦æŠŠè¿™ä¸ªé¡¶ç‚¹é€åˆ°é¡¶ç‚¹å¤„ç†é˜¶æ®µï¼ˆå˜å½¢å’Œå…‰ç…§ï¼‰ã€‚ æ³¨æ„ï¼šè¿™äº›ä¸­çš„å°‘æ•°ç”¨é€”ç±»å‹ï¼ˆusage typeï¼‰æœªåœ¨æœ¬ä¹¦ä¸­æåŠï¼Œä¾‹å¦‚BLENDWEIGHTS, BLENDINDICES, TANGENT, BINORMAL, å’ŒTESSFACTOR UsageIndexâ€”â€”ç”¨äºæ ‡è¯†å¤šä¸ªç›¸åŒç”¨é€”çš„é¡¶ç‚¹åˆ†é‡ã€‚è¿™ä¸ªç”¨é€”ç´¢å¼•æ˜¯ä½äºåŒºé—´[0, 15]é—´çš„ä¸€ä¸ªæ•´æ•°ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸‰ä¸ªç”¨é€”ä¸ºD3DDECLUSAGE_NORMALçš„é¡¶ç‚¹åˆ†é‡ã€‚æˆ‘ä»¬å¯ä»¥ä¸ºç¬¬ä¸€ä¸ªæŒ‡å®šç”¨é€”ç´¢å¼•ä¸º0ï¼Œä¸ºç¬¬äºŒä¸ªæŒ‡å®šç”¨é€”ç´¢å¼•ä¸º1ï¼Œå¹¶ä¸”ä¸ºç¬¬ä¸‰ä¸ªæŒ‡å®šç”¨é€”ç´¢å¼•ä¸º2ã€‚æŒ‰è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…¶ç”¨é€”ç´¢å¼•æ ‡è¯†æ¯ä¸ªç‰¹å®šçš„æ³•çº¿ã€‚ é¡¶ç‚¹æè¿°å£°æ˜çš„ä¾‹å­ï¼šå‡è®¾æˆ‘ä»¬æƒ³è¦æè¿°çš„é¡¶ç‚¹æ ¼å¼ç”±ä½ç½®å‘é‡å’Œä¸‰ä¸ªæ³•çº¿å‘é‡ç»„æˆã€‚é¡¶ç‚¹å£°æ˜å¯ä»¥æŒ‡å®šå¦‚ä¸‹ï¼šD3DVERTEXELEMENT9 decl[] ={{0, 0, D3DDECLTYPE_FLOAT3, D3DDECLMETHOD_DEFAULT, D3DDECLUSAGE_POSITION, 0}, {0, 12, D3DDECLTYPE_FLOAT3, D3DDECLMETHOD_DEFAULT, D3DDECLUSAGE_NORMAL, 0}, {0, 24, D3DDECLTYPE_FLOAT3, D3DDECLMETHOD_DEFAULT, D3DDECLUSAGE_NORMAL, 1}, {0, 36, D3DDECLTYPE_FLOAT3, D3DDECLMETHOD_DEFAULT, D3DDECLUSAGE_NORMAL, 2}, D3DDECL_END()};D3DDECL_ENDå®ç”¨äºåˆå§‹åŒ–D3DVERTEXELEMENT9æ•°ç»„çš„æœ€åä¸€ä¸ªé¡¶ç‚¹å…ƒç´ ã€‚åŒæ ·çš„ï¼Œæ³¨æ„æ³•çº¿å‘é‡çš„ç”¨é€”ç´¢å¼•æ ‡ç­¾ã€‚ 17.1.2 åˆ›å»ºé¡¶ç‚¹å£°æ˜ä¸€æ—¦ä½ æè¿°äº†ä¸€ä¸ªé¡¶ç‚¹å£°æ˜ä¸ºD3DVERTEXELEMENT9æ•°ç»„ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•è·å¾—ä¸€ä¸ªIDirect3DVertexDeclaration9æ¥å£æŒ‡é’ˆï¼šHRESULT IDirect3DDevice9::CreateVertexDeclaration( CONST D3DVERTEXELEMENT9 pVertexElements, IDirect3DVertexDeclaration9* ppDecl); pVertexElementsâ€”â€”D3DVERTEXELEMENT9ç»“æ„æ•°ç»„ï¼Œå®ƒæè¿°æˆ‘ä»¬æƒ³è¦åˆ›å»ºçš„é¡¶ç‚¹å£°æ˜ã€‚ ppDeclâ€”â€”ç”¨äºè¿”å›åˆ›å»ºçš„IDirect3DVertexDeclaration9æ¥å£æŒ‡é’ˆä¾‹å­è°ƒç”¨ï¼Œå…¶ä¸­declæ˜¯ä¸€ä¸ªD3DVERTEXELEMENT9æ•°ç»„ï¼šIDirect3DVertexDeclaration9* _decl = 0;hr = _device-&gt;CreateVertexDeclaration(decl, &amp;_decl); 17.1.3 ä½¿ç”¨ä¸€ä¸ªé¡¶ç‚¹å£°æ˜ å›å¿†ä¸€ä¸‹ï¼šè‡ªç”±é¡¶ç‚¹æ ¼å¼æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„ç‰¹æ€§å¹¶ä¸”åœ¨å†…éƒ¨è½¬æ¢æˆäº†é¡¶ç‚¹å£°æ˜ã€‚å› æ­¤ï¼Œå½“ç›´æ¥ä½¿ç”¨é¡¶ç‚¹å£°æ˜ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦è°ƒç”¨ï¼šDevice-&gt;SetFVF( fvf );ç›¸åï¼Œæˆ‘ä»¬è°ƒç”¨ï¼šDevice-&gt;SetVertexDeclaration( _decl );å…¶ä¸­ï¼Œ_declæ˜¯ä¸€ä¸ªIDirect3DVertexDeclaration9æ¥å£æŒ‡é’ˆã€‚17.2é¡¶ç‚¹æ•°æ®ç”¨é€”è€ƒè™‘è¿™ä¸ªé¡¶ç‚¹å£°æ˜ï¼šD3DVERTEXELEMENT9 decl[] ={{0, 0, D3DDECLTYPE_FLOAT3, D3DDECLMETHOD_DEFAULT, D3DDECLUSAGE_POSITION, 0}, {0, 12, D3DDECLTYPE_FLOAT3, D3DDECLMETHOD_DEFAULT, D3DDECLUSAGE_NORMAL, 0}, {0, 24, D3DDECLTYPE_FLOAT3, D3DDECLMETHOD_DEFAULT, D3DDECLUSAGE_NORMAL, 1}, {0, 36, D3DDECLTYPE_FLOAT3, D3DDECLMETHOD_DEFAULT, D3DDECLUSAGE_NORMAL, 2}, D3DDECL_END()}; æˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹å¼ï¼Œæ¥å®šä¹‰ä¸€ä¸ªé¡¶ç‚¹å£°æ˜çš„å…ƒç´ åˆ°é¡¶ç‚¹ç€è‰²å™¨çš„Inputç»“æ„çš„æ•°æ®æˆå‘˜çš„æ˜ å°„ã€‚æˆ‘ä»¬åœ¨Inputç»“æ„ä¸­é€šè¿‡æŒ‡å®šæ¯ä¸ªæ•°æ®æˆå‘˜çš„è¯­ä¹‰ï¼ˆ: usage-type [usage-index]ï¼‰å®šä¹‰è¿™ä¸ªæ˜ å°„ã€‚è¯­ä¹‰é€šè¿‡å…ƒç´ çš„ç”¨é€”ç±»å‹å’Œç”¨é€”ç´¢å¼•æ ‡è¯†é¡¶ç‚¹å£°æ˜ä¸­çš„ä¸€ä¸ªå…ƒç´ ã€‚ç”±æ•°æ®æˆå‘˜çš„è¯­ä¹‰æ ‡è¯†çš„é¡¶ç‚¹å…ƒç´ æ˜¯å¾—ä»¥æ˜ å°„åˆ°æ•°æ®æˆå‘˜çš„å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œå¯¹åº”äºå‰é¢çš„é¡¶ç‚¹å£°æ˜çš„è¾“å…¥ç»“æ„æ˜¯ï¼šstruct VS_INPUT{ vector position : POSITION; vector normal : NORMAL0; vector faceNormal1 : NORMAL1; vector faceNormal2 : NORMAL2;}; æ³¨æ„ï¼šå¦‚æœæˆ‘ä»¬é—æ¼äº†ç”¨é€”ç´¢å¼•ï¼Œå°±æ„å‘³ç€ç”¨é€”ç´¢å¼•ä¸ºé›¶ã€‚ä¾‹å¦‚ï¼ŒPOSITIONå’ŒPOSITION0æ˜¯åŒä¸€æ ·ä¸œè¥¿ã€‚ è¿™é‡Œdeclä¸­çš„å…ƒç´ 0ï¼Œç”±ç”¨é€”POSITIONå’Œç”¨é€”ç´¢å¼•0æ ‡è¯†ï¼Œå®ƒæ˜ å°„åˆ°positionã€‚declä¸­çš„å…ƒç´ 1ï¼Œç”±ç”¨é€”NORMALå’Œç”¨é€”ç´¢å¼•0æ ‡è¯†ï¼Œå®ƒæ˜ å°„åˆ°normalã€‚declä¸­çš„å…ƒç´ 2ï¼Œç”±NORMALå’Œç”¨é€”ç´¢å¼•1æ ‡è¯†ï¼Œå®ƒæ˜ å°„åˆ°faceNormal1ã€‚declä¸­çš„å…ƒç´ 3ï¼Œç”±ç”¨é€”NORMALå’Œç”¨é€”ç´¢å¼•2æ ‡è¯†ï¼Œå®ƒæ˜ å°„åˆ°faceNormal2ã€‚ å—æ”¯æŒçš„é¡¶ç‚¹ç€è‰²å™¨è¾“å…¥ç”¨é€”ï¼ˆinput usageï¼‰æ˜¯ï¼š POSITION [n]â€”â€”ä½ç½® BLENDWEIGHTS [n]â€”â€”æ··åˆæƒé‡ BLENDINDICES [n]â€”â€”æ··åˆç´¢å¼• NORMAL [n]â€”â€”æ³•çº¿å‘é‡ PSIZE[n]â€”â€”é¡¶ç‚¹å¤§å° DIFFUSE [n]â€”â€”æ•£å°„é¢œè‰² SPECULAR [n]â€”â€”é•œé¢é¢œè‰² TEXCOORD [n]â€”â€”çº¹ç†åæ ‡å…¶ä¸­ï¼Œnæ˜¯ä¸€ä¸ªä½äºåŒºé—´[0, 15]çš„å¯é€‰æ•´æ•°ã€‚ æ³¨æ„ï¼šå†é‡å¤ä¸€éï¼Œè¿™äº›ç”¨é€”ç±»å‹ä¸­çš„å°‘æ•°æœªåœ¨æœ¬ä¹¦ä¸­æåŠï¼Œå¦‚ï¼šBLENDWEIGHTS, TANGENT, BINORMAL, BLENDINDICES, å’ŒTESSFACTORã€‚ æ­¤å¤–ï¼Œå¯¹äºè¾“å‡ºç»“æ„ï¼Œæˆ‘ä»¬å¿…é¡»æŒ‡å®šæ¯ä¸ªæˆå‘˜æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ã€‚ä¾‹å¦‚ï¼Œæ•°æ®æˆå‘˜åº”è¯¥è¢«ä½œä¸ºä½ç½®å‘é‡ã€é¢œè‰²ã€çº¹ç†åæ ‡ç­‰å¯¹å¾…å—ï¼Ÿå›¾å½¢å¡æ²¡ä¸»æ„ï¼Œé™¤éä½ å¼ºåˆ¶çš„å‘Šè¯‰å®ƒã€‚è¿™ä¹Ÿéœ€è¦é€šè¿‡è¯­æ³•çš„è¯­ä¹‰æ¥å®Œæˆï¼šstruct VS_OUTPUT{ vector position : POSITION; vector diffuse : COLOR0; vector specular : COLOR1;}; å—æ”¯æŒçš„é¡¶ç‚¹ç€è‰²å™¨è¾“å‡ºç”¨é€”æ˜¯ï¼š POSITIONâ€”ä½ç½® PSIZEâ€”é¡¶ç‚¹å¤§å° FOGâ€”é›¾æ··åˆå€¼ COLOR [n]â€”é¡¶ç‚¹é¢œè‰²ã€‚æ³¨æ„ï¼šå¯ä»¥æœ‰å¤šä¸ªé¡¶ç‚¹é¢œè‰²è¢«è¾“å‡ºï¼Œå¹¶ä¸”è¿™äº›é¢œè‰²å¯ä»¥è¢«æ··åˆåœ¨ä¸€èµ·ä»¥äº§ç”Ÿæœ€ç»ˆçš„é¢œè‰²ã€‚ TEXCOORD [n]â€”é¡¶ç‚¹çº¹ç†åæ ‡ã€‚æ³¨æ„ï¼šå¤šä¸ªé¡¶ç‚¹çº¹ç†åæ ‡å¯ä»¥è¢«è¾“å‡ºã€‚å…¶ä¸­ï¼Œnæ˜¯ä¸€ä¸ªä½äºåŒºé—´[0, 15]çš„å¯é€‰æ•´æ•°ã€‚ 17.3ä½¿ç”¨é¡¶ç‚¹ç€è‰²å™¨çš„æ­¥éª¤ä¸‹é¢çš„åˆ—è¡¨æ¦‚æ‹¬äº†åˆ›å»ºå’Œä½¿ç”¨é¡¶ç‚¹ç€è‰²å™¨çš„å¿…é¡»æ­¥éª¤ï¼š ç¼–å†™å¹¶ç¼–è¯‘é¡¶ç‚¹ç€è‰²å™¨ åˆ›å»ºä¸€ä¸ªIDirect3DVertexShader9æ¥å£ä»¥å¼•ç”¨å·²ç¼–è¯‘çš„ç€è‰²å™¨ä»£ç ä¸Šçš„é¡¶ç‚¹ç€è‰²å™¨ã€‚ ç”¨IDirect3DDevice9:: SetVertexShaderæ–¹æ³•ä½¿ç”¨è¿™ä¸ªé¡¶ç‚¹ç€è‰²å™¨ã€‚ å½“ç„¶ï¼Œåœ¨æˆ‘ä»¬åšå®Œè¿™äº›ä¹‹åï¼Œæˆ‘ä»¬è¿˜å¾—é”€æ¯è¿™ä¸ªé¡¶ç‚¹ç€è‰²å™¨ã€‚ä¸‹é¢çš„å„å°èŠ‚å°†æ›´è¯¦ç»†çš„è¿ˆå…¥è¿™äº›æ­¥éª¤ã€‚ 17.3.1 ç¼–å†™å¹¶ç¼–è¯‘é¡¶ç‚¹ç€è‰²å™¨ é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»ç¼–å†™ä¸€ä¸ªé¡¶ç‚¹ç€è‰²å™¨ç¨‹åºã€‚åœ¨æœ¬ä¹¦ä¸­çš„HLSLä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»ç¼–å†™äº†æˆ‘ä»¬çš„ç€è‰²å™¨ï¼ˆè¯‘è€…æ³¨ï¼šå‚è§æˆ‘ç¿»è¯‘çš„è¯‘æ–‡ç¬¬ä¸€ç« ä¸­å„èŠ‚ï¼‰ã€‚ä¸€æ—¦ç€è‰²å™¨ä»£ç å†™å¥½ä¹‹åï¼Œæˆ‘ä»¬å°±ä½¿ç”¨D3DXCompileShaderFromFileå‡½æ•°ç¼–è¯‘è¿™ä¸ªç€è‰²å™¨ï¼Œå¦‚16.2.2èŠ‚æ‰€è¿°ã€‚å›å¿†ä¸€ä¸‹ï¼Œè¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªID3DXBufferæŒ‡é’ˆï¼Œå®ƒåŒ…å«å·²ç¼–è¯‘çš„ç€è‰²å™¨ä»£ç ã€‚ 17.3.2 åˆ›å»ºé¡¶ç‚¹ç€è‰²å™¨ ä¸€æ—¦æˆ‘ä»¬æ‹¥æœ‰äº†ç¼–è¯‘å¥½çš„ç€è‰²å™¨ä»£ç ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿè·å¾—ä¸€ä¸ªIDirect3DVertexShader9æ¥å£çš„æŒ‡é’ˆï¼Œå®ƒä»£è¡¨ä¸€ä¸ªé¡¶ç‚¹ç€è‰²å™¨â€”â€”é€šè¿‡ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼šHRESULT IDirect3DDevice9::CreateVertexShader( const DWORD pFunction, IDirect3DVertexShader9* ppShader);pFunctionâ€”â€”å·²ç¼–è¯‘ç€è‰²å™¨ä»£ç çš„æŒ‡é’ˆppShaderâ€”â€”è¿”å›ä¸€ä¸ªIDirect3DVertexShader9æ¥å£çš„æŒ‡é’ˆ ä¾‹å¦‚ï¼Œå‡è®¾å˜é‡shaderæ˜¯ä¸€ä¸ªåŒ…å«å·²ç¼–è¯‘çš„ï¼Œç€è‰²å™¨ä»£ç çš„ID3DXBufferæŒ‡é’ˆã€‚ç„¶åè¦è·å¾—ä¸€ä¸ªIDirect3DVertexShader9æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥å†™ï¼šIDirect3DVertexShader9 ToonShader = 0;hr = Device-&gt;CreateVertexShader( (DWORD)shader-&gt;GetBufferPointer(), &amp;ToonShader);æ³¨æ„ï¼šé‡ç”³ä¸€éï¼ŒD3DXCompileShaderFromFileæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå°†è¿”å›å·²ç¼–è¯‘ç€è‰²å™¨çš„ä»£ç ï¼ˆshaderï¼‰ã€‚ 17.3.3 å»ºç«‹é¡¶ç‚¹ç€è‰²å™¨ åœ¨æˆ‘ä»¬è·å¾—äº†ä¸€ä¸ªä»£è¡¨æˆ‘ä»¬çš„é¡¶ç‚¹ç€è‰²å™¨çš„IDirect3DVertexShader9æ¥å£çš„æŒ‡é’ˆä¹‹åï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ä½¿ç”¨å®ƒï¼šHRESULT IDirect3DDevice9::SetVertexShader( IDirect3DVertexShader9* pShader);è¿™ä¸ªæ–¹æ³•ä»…æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬åœ¨å…¶ä¸­ä¼ é€’ä¸€ä¸ªæƒ³è¦ä½¿ç”¨çš„é¡¶ç‚¹ç€è‰²å™¨çš„æŒ‡é’ˆã€‚è¦ä½¿ç”¨è¿™ä¸ªæˆ‘ä»¬åœ¨17.3.2èŠ‚åˆ›å»ºçš„ç€è‰²å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å†™ï¼šDevice-&gt;SetVertexShader(ToonShader); 17.3.4 é”€æ¯é¡¶ç‚¹ç€è‰²å™¨ å’Œæ‰€æœ‰çš„Direc3Dæ¥å£ä¸€æ ·ï¼Œè¦æ¸…é™¤ä»–ä»¬ï¼Œæˆ‘ä»¬å°±å¿…é¡»åœ¨ç”¨å®Œå®ƒä»¬ä¹‹åè°ƒç”¨å…¶çš„Releaseæ–¹æ³•ã€‚ä»ç„¶ä»¥æˆ‘ä»¬åœ¨17.3.2èŠ‚åˆ›å»ºçš„é¡¶ç‚¹ç€è‰²å™¨ä¸ºä¾‹ï¼Œæˆ‘ä»¬å†™ï¼šd3d::Release(ToonShader); 17.4æ ·ä¾‹åº”ç”¨ç¨‹åºï¼šæ•£å°„å…‰ç…§ ä½œä¸ºåˆ›å»ºå¹¶ä½¿ç”¨é¡¶ç‚¹ç€è‰²å™¨çš„çƒ­èº«ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªé¡¶ç‚¹ç€è‰²å™¨ï¼Œå®ƒç”¨ä¸€ä¸ªæ–¹å‘ï¼ˆå¹³è¡Œï¼‰å…‰å¯¹æ¯ä¸ªé¡¶ç‚¹è¿›è¡Œæ ‡å‡†çš„æ•£å°„å…‰ç…§ã€‚ç®€è€Œè¨€ä¹‹ï¼Œæ•£å°„å…‰ç…§æ ¹æ®é¡¶ç‚¹æ³•çº¿å’Œå…‰çº¿å‘é‡ï¼ˆå®ƒçš„ç‚¹æœå‘å…‰æºæ–¹å‘ï¼‰çš„è§’åº¦è®¡ç®—é¡¶ç‚¹æ¥æ”¶åˆ°çš„å…‰çº¿çš„æ•°é‡ã€‚è§’åº¦è¶Šå°ï¼Œåˆ™é¡¶ç‚¹æ¥æ”¶åˆ°çš„å…‰çº¿å°±è¶Šå¤šï¼›è€Œè§’åº¦è¶Šå¤§ï¼Œåˆ™é¡¶ç‚¹æ¥æ”¶åˆ°çš„å…‰çº¿å°±è¶Šå°‘ã€‚å¦‚æœè§’åº¦å¤§äºç­‰äº90åº¦ï¼Œé¡¶ç‚¹å°±æ¥æ”¶ä¸åˆ°å…‰çº¿äº†ã€‚ æˆ‘ä»¬ä»¥æ£€é˜…ç€è‰²å™¨ä»£ç ä½œä¸ºå¼€å§‹ï¼š// File: diffuse.txt// Desc: Vertex shader that does diffuse lighting.// Global variables we use to hold the view matrix, projection matrix,// ambient material, diffuse material, and the light vector that// describes the direction to the light source. These variables are// initialized from the application. matrix ViewMatrix;matrix ViewProjMatrix;vector AmbientMtrl;vector DiffuseMtrl;vector LightDirection; // ç¯å¢ƒå…‰å¼ºåº¦ï¼Œæ¼«å°„å…‰å¼ºåº¦// è¿™äº›å˜é‡å®šä¹‰åœ¨ç€è‰²å™¨ä»£ç ä¸­vector DiffuseLightIntensity = {0.0f, 0.0f, 1.0f, 1.0f};vector AmbientLightIntensity = {0.0f, 0.0f, 0.2f, 1.0f}; // Input and Output structures.struct VS_INPUT{ vector position : POSITION; vector normal : NORMAL;}; struct VS_OUTPUT{ vector position : POSITION; vector diffuse : COLOR;}; //MainVS_OUTPUT Main(VS_INPUT input){ // zero out all members of the output instance. VS_OUTPUT output = (VS_OUTPUT)0; // å˜æ¢ä½ç½®åˆ°é½æ¬¡åæ ‡ç©ºé—´ï¼Œä¿å­˜åˆ°output.positionæˆå‘˜ä¸­ output.position = mul(input.position, ViewProjMatrix); // å˜æ¢å…‰å’Œæ³•çº¿åˆ°è§†å›¾ç©ºé—´ï¼Œè®¾ç½®wåˆ†é‡ä¸º0ï¼Œæ˜¯å› ä¸ºå˜æ¢çš„å‘é‡ä¸æ˜¯ç‚¹ LightDirection.w = 0.0f; input.normal.w = 0.0f; LightDirection = mul(LightDirection, ViewMatrix); input.normal = mul(input.normal, ViewMatrix); // è®¡ç®—å…‰ä¸æ³•çº¿å¤¹è§’çš„ä½™å¼¦ float s = dot(LightDirection, input.normal); // å›å¿†ä¸€ä¸‹ï¼Œå¦‚æœæ³•çº¿å’Œå…‰çš„å¤¹è§’å¤§äº90åº¦ï¼Œåˆ™è¡¨é¢æ¥æ”¶ä¸åˆ°å…‰ã€‚ if( s &lt; 0.0f ) s = 0.0f; // ç¯å¢ƒå…‰åå°„æ˜¯æ‰§è¡Œä¸€ä¸ªå‰ç§¯ï¼ˆç¯å¢ƒæè´¨å‘é‡ä¸ç¯å¢ƒå…‰å¼ºåº¦å‘é‡ï¼‰ï¼Œ // æ¼«å°„å…‰åå°„æ˜¯æ‰§è¡Œä¸€ä¸ªå‰ç§¯ï¼ˆæ¼«å°„æè´¨å‘é‡ä¸æ¼«å°„å…‰å¼ºåº¦å‘é‡ï¼Œ // æ›´è¿›ä¸€æ­¥è®²ï¼Œæˆ‘ä»¬æµ‹é‡ç€è‰²å™¨çš„é¢œè‰²ï¼ŒåŸºäºé¡¶ç‚¹ä»å…‰æºå¤„æ¥æ”¶åˆ°å¤šå°‘å…‰ //ç¯å¢ƒå…‰å’Œæ¼«å°„å…‰ç»¼åˆèµ·æ¥ï¼Œå†³å®šä¸€ä¸ªé¡¶ç‚¹çš„æœ€ç»ˆé¢œè‰² output.diffuse = (AmbientMtrl * AmbientLightIntensity) + ((DiffuseMtrl * DiffuseLightIntensity) * s); return output; } æ—¢ç„¶æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å®é™…çš„é¡¶ç‚¹ç€è‰²å™¨çš„ä»£ç ï¼Œé‚£ä¹ˆå°±è®©æˆ‘ä»¬æ”¹å˜æ–¹å¼æ¥çœ‹çœ‹åº”ç”¨ç¨‹åºçš„ä»£ç ã€‚è¿™ä¸ªåº”ç”¨ç¨‹åºæœ‰ä¸‹åˆ—ç›¸å…³çš„å…¨å±€å˜é‡ï¼šIDirect3DVertexShader9 DiffuseShader = 0;ID3DXConstantTable DiffuseConstTable = 0;ID3DXMesh* Teapot = 0;D3DXHANDLE ViewMatrixHandle = 0;D3DXHANDLE ViewProjMatrixHandle = 0;D3DXHANDLE AmbientMtrlHandle = 0;D3DXHANDLE DiffuseMtrlHandle = 0;D3DXHANDLE LightDirHandle = 0;D3DXMATRIX Proj; æœ‰ä»£è¡¨é¡¶ç‚¹ç€è‰²å™¨åŠå…¶å¸¸é‡è¡¨çš„å˜é‡ï¼Œæœ‰èŒ¶å£¶ç½‘æ ¼çš„å˜é‡ï¼Œæ¥ç€æ˜¯ä¸€ç»„D3DXHANDLEï¼Œå…¶åå­—æè¿°äº†ä»–ä»¬å¼•ç”¨çš„å˜é‡ï¼š Setupå‡½æ•°æ‰§è¡Œä¸‹åˆ—ä»»åŠ¡ï¼š åˆ›å»ºèŒ¶å£¶ç½‘æ ¼ ç¼–è¯‘é¡¶ç‚¹ç€è‰²å™¨ æ ¹æ®å·²ç¼–è¯‘ä»£ç åˆ›å»ºé¡¶ç‚¹ç€è‰²å™¨ é€šè¿‡å¸¸é‡è¡¨è·å–ç€è‰²å™¨ç¨‹åºä¸­çš„å‡ ä¸ªå˜é‡çš„å¥æŸ„ é€šè¿‡å¸¸é‡è¡¨åˆå§‹åŒ–ç€è‰²å™¨çš„è¿™å‡ ä¸ªå˜é‡ æ³¨æ„ï¼šå¯¹äºæœ¬åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬çš„é¡¶ç‚¹ç»“æ„ä¸éœ€è¦ä»»ä½•è‡ªç”±é¡¶ç‚¹æ ¼å¼æ²¡æœ‰çš„é¢å¤–çš„åˆ†é‡ã€‚å› æ­¤ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªè‡ªç”±é¡¶ç‚¹æ ¼å¼æ¥ä»£æ›¿é¡¶ç‚¹å£°æ˜ã€‚å›æƒ³ä¸€ä¸‹ï¼Œè‡ªç”±é¡¶ç‚¹æ ¼å¼æè¿°æœ€ç»ˆåœ¨å†…éƒ¨è¢«è½¬æ¢ä¸ºä¸€ä¸ªé¡¶ç‚¹å£°æ˜ã€‚bool Setup(){ HRESULT hr = 0; // Create geometry: D3DXCreateTeapot(Device, &amp;Teapot, 0); // Compile shader ID3DXBuffer* shader = 0; ID3DXBuffer* errorBuffer = 0; hr = D3DXCompileShaderFromFile( &quot;diffuse.txt&quot;, 0, 0, &quot;Main&quot;, // entry point function name &quot;vs_1_1&quot;, D3DXSHADER_DEBUG, &amp;shader, &amp;errorBuffer, &amp;DiffuseConstTable); // output any error messages if( errorBuffer ) { ::MessageBox(0, (char*)errorBuffer-&gt;GetBufferPointer(), 0, 0); d3d::Release&lt;ID3DXBuffer*&gt;(errorBuffer); } if(FAILED(hr)) { ::MessageBox(0, &quot;D3DXCompileShaderFromFile() - FAILED&quot;, 0, 0); return false; } // Create shader hr = Device-&gt;CreateVertexShader( (DWORD*)shader-&gt;GetBufferPointer(), &amp;DiffuseShader); if(FAILED(hr)) { ::MessageBox(0, &quot;CreateVertexShader - FAILED&quot;, 0, 0); return false; } d3d::Release&lt;ID3DXBuffer*&gt;(shader); // Get Handles LightDirHandle = DiffuseConstTable-&gt;GetConstantByName(0, &quot;LightDirection&quot;); ViewMatrixHandle = DiffuseConstTable-&gt;GetConstantByName(0, &quot;ViewMatrix&quot;); ViewProjMatrixHandle = DiffuseConstTable-&gt;GetConstantByName(0, &quot;ViewProjMatrix&quot;); AmbientMtrlHandle = DiffuseConstTable-&gt;GetConstantByName(0, &quot;AmbientMtrl&quot;); DiffuseMtrlHandle = DiffuseConstTable-&gt;GetConstantByName(0, &quot;DiffuseMtrl&quot;); // Set shader constants: // Light direction: D3DXVECTOR4 directionToLight(-0.57f, 0.57f, -0.57f, 0.0f); DiffuseConstTable-&gt;SetVector(Device, LightDirHandle, &amp;directionToLight); // Materials: D3DXVECTOR4 ambientMtrl(0.0f, 0.0f, 1.0f, 1.0f); D3DXVECTOR4 diffuseMtrl(0.0f, 0.0f, 1.0f, 1.0f); DiffuseConstTable-&gt;SetVector(Device,AmbientMtrlHandle,&amp;ambientMtrl); DiffuseConstTable-&gt;SetVector(Device,DiffuseMtrlHandle,&amp;diffuseMtrl); DiffuseConstTable-&gt;SetDefaults(Device); // Compute projection matrix. D3DXMatrixPerspectiveFovLH( &amp;Proj, D3DX PI * 0.25f, (float)Width / (float)Height, 1.0f, 1000.0f); return true; } Displayå‡½æ•°éå¸¸ç®€å•ã€‚å®ƒæ£€æµ‹ç”¨æˆ·è¾“å…¥ï¼ˆè¯‘è€…æ³¨ï¼šè¿™é‡ŒæŒ‡çš„æ˜¯ç”¨æˆ·è¾“å…¥çš„ä¼ å…¥ç€è‰²å™¨ç¨‹åºçš„å˜é‡ï¼‰ï¼Œå¹¶ç›¸åº”çš„æ›´æ–°è§†å›¾çŸ©é˜µã€‚ä½†æ˜¯ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ç€è‰²å™¨ä¸­æ‰§è¡Œè¿™ä¸ªè§†å›¾çŸ©é˜µå˜æ¢ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜å¿…é¡»æ›´æ–°ç€è‰²å™¨ä¸­çš„è§†å›¾çŸ©é˜µå˜é‡ã€‚æˆ‘ä»¬ç”¨å¸¸é‡è¡¨å®Œæˆè¿™ä»¶äº‹æƒ…ã€‚bool Display(float timeDelta){ if( Device ) { // Update view matrix code snippedâ€¦ D3DXMATRIX V; D3DXMatrixLookAtLH(&amp;V, &amp;position, &amp;target, &amp;up); DiffuseConstTable-&gt;SetMatrix(Device, ViewMatrixHandle, &amp;V); D3DXMATRIX ViewProj =V *Proj; DiffuseConstTable-&gt;SetMatrix(Device, ViewProjMatrixHandle, &amp;ViewProj); // Render Device-&gt;Clear(0, 0, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER, 0xffffffff, 1.0f, 0); Device-&gt;BeginScene(); Device-&gt;SetVertexShader(DiffuseShader); Teapot-&gt;DrawSubset(0); Device-&gt;EndScene(); Device-&gt;Present(0, 0, 0, 0); } return true; } åŒæ ·æ³¨æ„ï¼Œå°±åœ¨DrawSubsetè°ƒç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬å…è®¸äº†è¿™ä¸ªæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨çš„é¡¶ç‚¹ç€è‰²å™¨ã€‚æ¸…ç†ä¹Ÿéœ€è¦è¢«å®Œæˆï¼›æˆ‘ä»¬ç®€å•çš„é‡Šæ”¾äº†è¿™ä¸ªå·²åˆ†é…çš„æ¥å£ï¼švoid Cleanup(){ d3d::Release(Teapot); d3d::Release(DiffuseShader); d3d::Release(DiffuseConstTable);} 17.5 å¡é€šæ¸²æŸ“ ä½œä¸ºç¬¬äºŒä¸ªé¡¶ç‚¹ç€è‰²å™¨çš„ä¾‹å­ï¼Œè®©æˆ‘ä»¬ç¼–å†™ä¸¤ä¸ªé¡¶ç‚¹ç€è‰²å™¨ï¼Œå®ƒä»¬ä»¥å¡é€šé£æ ¼çš„ç»˜ç”»æ–¹å¼å¯¹ç½‘æ ¼ç€è‰²ï¼ˆshadeï¼‰å¹¶ç”»è½®å»“ï¼ˆoutlineï¼‰ã€‚å›¾17.2å±•ç¤ºäº†è¿™ä¸€ç‚¹ï¼š å›¾17.2ï¼šï¼ˆaï¼‰ä½¿ç”¨å¡é€šç€è‰²æ³•ç€è‰²çš„å¯¹è±¡ï¼ˆæ³¨æ„ç€è‰²é—´çš„å°–é”è¿‡æ¸¡ï¼‰ã€‚ï¼ˆbï¼‰å¢å¼ºå¡é€šæ•ˆæœï¼Œè½®å»“è¾¹ï¼ˆsilhouette edgeï¼‰è¢«å‹¾å‡ºã€‚ï¼ˆcï¼‰ä½¿ç”¨æ ‡å‡†æ•£å°„å…‰ç…§ç€è‰²çš„å¯¹è±¡ æ³¨æ„ï¼šå¡é€šæ¸²æŸ“æ˜¯ä¸€ç§ç‰¹å®šç±»å‹çš„éå†™å®æ¸²æŸ“ï¼ˆnon-photorealistic renderingï¼‰ï¼Œæœ‰æ—¶è¢«ç§°ä½œé£æ ¼åŒ–æ¸²æŸ“ï¼ˆstylistic renderingï¼‰ã€‚ è™½ç„¶å¡é€šæ¸²æŸ“ä¸é€‚ç”¨äºæ‰€æœ‰æ¸¸æˆï¼Œä¾‹å¦‚æ¿€çƒˆçš„ç¬¬ä¸€äººç§°å°„å‡»æ¸¸æˆï¼Œä½†æ˜¯å®ƒä»ç„¶å¯ä»¥å¢å¼ºä¸€äº›å¸Œæœ›è¡¨ç°å¡é€šæ„Ÿè§‰ç±»å‹æ¸¸æˆçš„æ°”æ°›ã€‚æ­¤å¤–ï¼Œå¡é€šæ¸²æŸ“æ˜¯æ¼‚äº®çš„ï¼Œå¹¶æ˜“äºå®ç°ã€‚è®©æˆ‘ä»¬å¥½å¥½çš„æ¼”ç¤ºä¸€ä¸ªé¡¶ç‚¹ç€è‰²å™¨ã€‚ æˆ‘ä»¬å°†å¡é€šæ¸²æŸ“åˆ†ä¸ºä¸¤æ­¥ï¼š å¡é€šç»˜ç”»çš„ç‰¹ç‚¹æ˜¯ï¼šåœ¨ä¸€ä¸ªé¡¶ç‚¹åˆ°ä¸‹ä¸€ä¸ªé¡¶ç‚¹çš„å¼ºçƒˆè½¬æ¢æ—¶ï¼Œæœ‰å°‘é‡çš„é˜´å½±å¼ºåº¦çº§åˆ«ï¼›æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªå¡é€šé˜´å½±ï¼ˆcartoon shadingï¼‰ã€‚åœ¨å›¾17.2ï¼ˆaï¼‰ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°ç½‘ç»œç€è‰²ä½¿ç”¨äº†ä¸‰ç§é˜´å½±å¼ºåº¦ï¼ˆäº®ã€ä¸­ã€æš—ï¼‰ï¼Œè€Œä¸”å…¶é—´çš„è¿‡æ¸¡æ˜¯ä¸å¹³æ»‘çš„â€”â€”ä¸åƒå›¾17.2ï¼ˆcï¼‰ï¼Œå…¶æ˜æš—è¿‡æ¸¡æ˜¯å¹³æ»‘çš„ã€‚ å¡é€šç»˜å›¾çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼šåœ¨å…¶å¤–æ¡†ä¸Šå‹¾ç”»è½®å»“ï¼Œå¦‚å›¾17.2ï¼ˆbï¼‰æ‰€ç¤ºã€‚è¿™ä¸¤ä¸ªæ­¥éª¤éƒ½éœ€è¦å…¶å„è‡ªçš„é¡¶ç‚¹ç€è‰²å™¨ã€‚ 17.5.1 å¡é€šç€è‰² è¦å®ç°å¡é€šç€è‰²ï¼Œæˆ‘ä»¬é‡‡ç”¨Landeråœ¨2000å¹´3æœˆå‘è¡¨åœ¨Game Developer Magazineçš„æ–‡ç« â€œShades of Disney: Opaquing a 3D Worldâ€ä¸­æ‰€æè¿°çš„æ–¹æ³•ã€‚å®ƒåƒè¿™æ ·å·¥ä½œï¼šæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¸¦å¼ºåº¦çº§åˆ«çš„ç°åº¦çº¹ç†ï¼Œå®ƒåŒ…å«æˆ‘ä»¬éœ€è¦çš„ä¸åŒçš„ç€è‰²å¼ºåº¦ã€‚å›¾17.3æ˜¾ç¤ºäº†æˆ‘ä»¬åœ¨æ ·ä¾‹ç¨‹åºä¸­ä½¿ç”¨çš„è¿™ä¸ªçº¹ç†ã€‚ å›¾ 17.3ï¼šç”¨æ¥ä¿å­˜ç€è‰²å¼ºåº¦çš„ç€è‰²çº¹ç†ã€‚æ³¨æ„è§‚å¯Ÿä¸è¿ç»­çš„ç€è‰²é—´è¿‡æ¸¡å’Œçº¹ç†ç€è‰²å¼ºåº¦å¿…é¡»ä»å·¦åˆ°å³å¢åŠ ã€‚ ç„¶ååœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œæ ‡å‡†æ•£å°„ç‚¹ç§¯è¿ç®—ï¼ˆstandard diffuse calculation dot productï¼‰æ¥ç¡®å®šé¡¶ç‚¹æ³•çº¿Nå’Œå…‰çº¿å‘é‡Lä¹‹é—´è§’åº¦çš„ä½™å¼¦ï¼Œç”¨ä»¥ç¡®å®šé¡¶ç‚¹æ¥æ”¶åˆ°å¤šå°‘å…‰çº¿ï¼šs=LÂ·N å¦‚æœsï¼œ0ï¼Œå°±è¡¨ç¤ºå…‰çº¿å‘é‡å’Œé¡¶ç‚¹æ³•çº¿ä¹‹é—´çš„è§’åº¦å¤§äº90åº¦ï¼Œä¹Ÿå°±è¡¨ç¤ºè¯¥è¡¨é¢æ¥æ”¶ä¸åˆ°å…‰çº¿ã€‚å› æ­¤ï¼Œå¦‚æœsï¼œ0ï¼Œæˆ‘ä»¬å°±è®©sï¼0ã€‚æ‰€ä»¥s âˆˆ [0, 1]ã€‚ ç°åœ¨ï¼Œåœ¨é€šå¸¸çš„æ•£å°„å…‰ç…§æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨sæ¥æ ‡è®°é¢œè‰²å‘é‡ã€‚è¿™æ ·ï¼Œé¡¶ç‚¹é¢œè‰²çš„æ˜æš—å–å†³äºæ¥æ”¶åˆ°çš„å…‰ç…§çš„æ•°é‡ï¼šdiffuseColor = s(r, g, b, a) ä½†æ˜¯ï¼Œè¿™å°†ä¼šå¯¼è‡´ä»äº®åˆ°æš—ä¹‹é—´å¹³æ»‘çš„ç€è‰²ã€‚è¿™æ˜¯ä¸æˆ‘ä»¬æœŸæœ›çš„å¡é€šç€è‰²ç›¸åçš„ã€‚æˆ‘ä»¬æƒ³è¦ä¸€ç§åœ¨å‡ ä¸ªä¸åŒç€è‰²å™¨é—´çªç„¶è½¬æ¢é¢œè‰²çš„æ•ˆæœï¼ˆå¯¹å¡é€šæ¸²æŸ“æ¥è¯´ï¼Œåœ¨2è‡³4ç§ç€è‰²å™¨å·¥ä½œèµ·æ¥è¿˜æ˜¯æŒºä¸é”™çš„ï¼‰ã€‚ ä¸ä½¿ç”¨sæ¥æ ‡è®°é¢œè‰²å‘é‡ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨sä½œä¸ºæ—©å…ˆæåˆ°çš„å¼ºåº¦çº¹ç†çš„uçº¹ç†åæ ‡â€”â€”å¦‚å›¾17.3ã€‚æ³¨æ„ï¼šæ ‡é‡ï¼ˆscalarï¼‰så¿…å®šæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„çº¹ç†åæ ‡ï¼Œå› ä¸ºs âˆˆ [0, 1]ï¼Œè¿™æ˜¯é€šå¸¸çš„çº¹ç†åæ ‡åŒºé—´ã€‚ æŒ‰è¿™ç§æ–¹å¼ï¼Œé¡¶ç‚¹ä¸ä¼šè¢«å¹³æ»‘ç€è‰²ï¼Œè€Œæ˜¯é—´æ–­çš„ã€‚ä¾‹å¦‚ï¼Œå¼ºåº¦çº¹ç†å¯èƒ½è¢«åˆ†æˆ3ç§ç€è‰²ï¼Œå¦‚å›¾17.4æ‰€ç¤ºï¼š å›¾17.4ï¼šé‚£ä¹ˆï¼Œs âˆˆ [0, 0.33]çš„å€¼ä½¿ç”¨shader0ç€è‰²ï¼Œs âˆˆ [ 0.33ï¼Œ0.66]çš„å€¼ä½¿ç”¨shader1ç€è‰²ï¼Œs âˆˆ [0.66,1]çš„å€¼ä½¿ç”¨shader2ç€è‰²ã€‚å½“ç„¶ï¼Œä»è¿™äº›ç€è‰²çš„ä¸€ç§åˆ°å¦ä¸€ç§çš„è¿‡æ¸¡æ˜¯ä¸å¹³æ»‘çš„ï¼Œè¿™å°±èµ‹äºˆäº†æˆ‘ä»¬æœŸæœ›çš„æ•ˆæœã€‚ æ³¨æ„ï¼šæˆ‘ä»¬è¿˜ä¸ºå¡é€šç€è‰²å…³é—­äº†çº¹ç†è¿‡æ»¤ï¼Œå› ä¸ºè¿™ç§è¿‡æ»¤ä¼šè¯•å›¾ä½¿ç€è‰²è¿‡æ¸¡å˜å¹³æ»‘ã€‚è¿™å¯¹äºæˆ‘ä»¬è¦æ±‚çš„ä¸è¿ç»­è¿‡æ¸¡æ˜¯å¤šä½™çš„ã€‚ 17.5.2 å¡é€šç€è‰²çš„é¡¶ç‚¹ç€è‰²å™¨ä»£ç  æˆ‘ä»¬ç°åœ¨ä»‹ç»å¡é€šç€è‰²çš„é¡¶ç‚¹ç€è‰²å™¨ã€‚è¿™ä¸ªç€è‰²å™¨çš„ä¸»è¦ä»»åŠ¡åªæ˜¯æ ¹æ®s=LÂ·Nè®¡ç®—å¹¶è®¾ç½®çº¹ç†åæ ‡ã€‚æ³¨æ„è§‚å¯Ÿè¾“å‡ºç»“æ„ï¼Œæˆ‘ä»¬å·²ç»å¢åŠ äº†ä¸€ä¸ªæ•°æ®æˆå‘˜æ¥å­˜å‚¨å·²è¢«è®¡ç®—è¿‡çš„çº¹ç†åæ ‡ã€‚åŒæ—¶è¿˜éœ€æ³¨æ„ï¼Œæˆ‘ä»¬ä»ç„¶è¾“å‡ºé¡¶ç‚¹é¢œè‰²ï¼Œè™½ç„¶æˆ‘ä»¬ä¸ä¿®æ”¹å®ƒï¼Œä¸è¿‡å½“é¢œè‰²è¢«ä¸å¼ºåº¦çº¹ç†ç»„åˆèµ·æ¥çš„æ—¶å€™ï¼Œå®ƒå‘ˆç°ä¸ºè¢«ç€è‰²çš„ã€‚// File: toon.txt// Desc: Vertex shader that lights geometry so it appears to be// drawn in a cartoon style. // Globalsextern matrix WorldViewMatrix;extern matrix WorldViewProjMatrix;extern vector Color;extern vector LightDirection;static vector Black = {0.0f, 0.0f, 0.0f, 0.0f}; // Structuresstruct VS_INPUT{ vector position : POSITION; vector normal : NORMAL;}; struct VS_OUTPUT{ vector position : POSITION; float2 uvCoords : TEXCOORD; vector diffuse : COLOR;}; // MainVS_OUTPUT Main(VS_INPUT input){ // zero out each member in output VS_OUTPUT output = (VS_OUTPUT)0; // transform vertex position to homogenous clip space output.position = mul(input.position, WorldViewProjMatrix); // Transform lights and normals to view space. Set w // components to zero since weâ€™re transforming vectors. // Assume there are no scalings in the world // matrix as well. LightDirection.w = 0.0f; input.normal.w = 0.0f; LightDirection = mul(LightDirection, WorldViewMatrix); input.normal = mul(input.normal, WorldViewMatrix); // Compute the 1D texture coordinate for toon rendering. float u = dot(LightDirection, input.normal); // Clamp to zero if u is negative because u // negative implies the angle between the light // and normal is greater than 90 degrees. And // if that is true then the surface receives no light. if(u &lt; 0.0f) u = 0.0f; // Set other tex coord to middle. float v = 0.5f; output.uvCoords.x = u; output.uvCoords.y = v; // save color output.diffuse = Color; return output;} ä¸¤ç‚¹æ³¨è§£ï¼š æˆ‘ä»¬å‡è®¾ä¸–ç•ŒçŸ©é˜µæ²¡æœ‰æ‰§è¡Œä»»ä½•ç¼©æ”¾ã€‚å› ä¸ºå¦‚æœå®ƒæ‰§è¡Œï¼Œå®ƒå°±ä¼šå¼„ä¹±ä¹˜ä»¥å®ƒçš„é¡¶ç‚¹çš„é•¿åº¦å’Œæ–¹å‘ã€‚ æˆ‘ä»¬æ€»æ˜¯è®¾ç½®vçº¹ç†åæ ‡ä¸ºçº¹ç†çš„ä¸­ç‚¹ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä»…ä½¿ç”¨çº¹ç†ä¸­ä¸€æ¡å•ä¸€çš„çº¿ï¼Œé‚£å°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ä½¿ç”¨1Då¼ºåº¦çº¹ç†æ¥ä»£æ›¿2Dçš„é‚£ä¸ªçº¹ç†ã€‚ä¸ç®¡æ€æ ·ï¼Œ1Då’Œ2Dçº¹ç†éƒ½èƒ½å·¥ä½œã€‚æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†2Dçº¹ç†è€Œä¸æ˜¯1Dçº¹ç†ï¼Œè¿™æ˜¯æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„åŸå› çš„ã€‚ 17.5.3è½®å»“å‹¾å‹’è¦å®Œæˆå¡é€šæ•ˆæœï¼Œæˆ‘ä»¬è¿˜éœ€è¦å‹¾å‹’ï¼ˆoutlineï¼‰è½®å»“è¾¹ï¼ˆsilhouette edgeï¼‰ã€‚è¿™æ¯”å¡é€šç€è‰²ç¨å¾®å¤æ‚ä¸€ç‚¹ã€‚ 17.5.3.1 è¾¹çš„è¡¨ç¤ºæ³•æˆ‘ä»¬å°†ä¸€ä¸ªç½‘æ ¼çš„ä¸€æ¡è¾¹è¡¨ç¤ºä¸ºä¸€ä¸ªå››å…ƒç»„ï¼ˆæ„å»ºè‡ª2ä¸ªä¸‰è§’å½¢ï¼‰â€”â€”å‚è§å›¾17.5ã€‚ å›¾ 17.5ï¼šè¡¨ç¤ºè¾¹çš„å››å…ƒç»„ æˆ‘ä»¬é€‰æ‹©å››å…ƒç»„æœ‰ä¸¤ä¸ªåŸå› ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒæ•´å››å…ƒç»„çš„ç»´å®¹æ˜“çš„æ”¹å˜è¾¹çš„åšåº¦ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥æ¸²æŸ“é€€åŒ–çš„å››å…ƒç»„æ¥éšè—æŸäº›è¾¹ï¼Œä¹Ÿå³éè½®å»“è¾¹ã€‚åœ¨Direct3Dä¸­ï¼Œæˆ‘ä»¬ä»ä¸¤ä¸ªä¸‰è§’å½¢æ¥æ„å»ºä¸€ä¸ªå››å…ƒç»„ã€‚é€€åŒ–å››å…ƒç»„ï¼ˆdegenerate quadï¼‰æ˜¯ä»ä¸¤ä¸ªé€€åŒ–ä¸‰è§’å½¢æ„å»ºè€Œæ¥çš„å››å…ƒç»„ã€‚é€€åŒ–ä¸‰è§’å½¢ï¼ˆdegenerate triangleï¼‰æ˜¯ä¸€ä¸ªé¢ç§¯ä¸ºé›¶çš„ä¸‰è§’å½¢ï¼Œæˆ–è€…æ¢å¥è¯è¯´ï¼Œæ˜¯ä¸€ä¸ªä¸‰ç‚¹ä½äºä¸€çº¿ä¸Šçš„ä¸‰è§’å½¢ã€‚å¦‚æœæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªé€€åŒ–ä¸‰è§’å½¢åˆ°æ¸²æŸ“ç®¡çº¿ï¼Œåˆ™è¯¥ä¸‰è§’å½¢æ˜¾ç¤ºä¸ºç©ºã€‚è¿™æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œå› ä¸ºå¦‚æœæˆ‘ä»¬å¸Œæœ›éšè—ç‰¹å®šä¸‰è§’å½¢ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„é€€åŒ–å®ƒè€Œä¸éœ€è¦å®é™…çš„ä»ä¸‰è§’å½¢åˆ—è¡¨ï¼ˆé¡¶ç‚¹ç¼“å†²ï¼‰ç§»é™¤å®ƒã€‚å›æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦æ˜¾ç¤ºè½®å»“è¾¹â€”â€”è€Œä¸æ˜¯ç½‘æ ¼çš„æ¯ä¸€æ¡è¾¹ã€‚ å½“æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€æ¡è¾¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŒ‡å®šå…¶å››ä¸ªé¡¶ç‚¹ï¼Œå¹¶ä½¿å…¶é€€åŒ–ï¼Œè¿™æ„å‘³ç€è¾¹å°†ä¼šè¢«éšè—ï¼ˆæ¸²æŸ“æ—¶ä¸æ˜¾ç¤ºï¼‰ã€‚ å›¾17.6ï¼šç”±ä¸¤ä¸ªä¸‰è§’å½¢å…±ç”¨è¾¹æè¿°çš„é€€åŒ–å››å…ƒç»„ æ³¨æ„å›¾17.6ä¸­çš„ä¸¤ä¸ªé¡¶ç‚¹v0å’Œv1ï¼Œæˆ‘ä»¬è®¾ç½®å…¶é¡¶ç‚¹æ³•çº¿å‘é‡ä¸ºé›¶å‘é‡ã€‚ç„¶åå½“æˆ‘ä»¬å°†è¾¹çš„é¡¶ç‚¹é€å…¥é¡¶ç‚¹ç€è‰²å™¨çš„æ—¶å€™ï¼Œé¡¶ç‚¹ç€è‰²å™¨å°†ä¼šæ£€æµ‹é¡¶ç‚¹æ˜¯å¦ä½äºè½®å»“è¾¹ä¸Šï¼›å¦‚æœæ˜¯ï¼Œåˆ™é¡¶ç‚¹ç€è‰²å™¨å°†æŒ‰é¡¶ç‚¹æ³•çº¿çš„æ–¹å‘åç§»é¡¶ç‚¹ä½ç½®çš„æ ‡é‡ã€‚è§‚å¯Ÿæ³•çº¿å‘é‡ä¸ºé›¶çš„é¡¶ç‚¹ï¼Œå®ƒä¸ä¼šè¢«åç§»ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬æœ€ç»ˆä»¥ä¸€ä¸ªéé€€åŒ–å››å…ƒç»„ï¼ˆnon-degenerate quadï¼‰æ¥è¡¨ç¤ºè½®å»“è¾¹ï¼Œå¦‚å›¾17.7æ‰€ç¤ºã€‚ å›¾17.7ï¼šä½äºè½®å»“è¾¹ä¸Šçš„é¡¶ç‚¹v2å’Œv3è¢«æŒ‰ç…§å…¶å„è‡ªçš„é¡¶ç‚¹æ³•çº¿n2å’Œn3è¿›è¡Œåç§»ã€‚è§‚å¯Ÿé¡¶ç‚¹v0å’Œv1ä»ç„¶ä¿æŒåœ¨å…¶å›ºå®šä½ç½®ï¼Œå› ä¸ºå…¶é¡¶ç‚¹æ³•çº¿ç­‰äºé›¶å‘é‡ï¼Œå› æ­¤å¯¹äºå®ƒä»¬æ¥è¯´æ²¡æœ‰åç§»å‘ç”Ÿã€‚æŒ‰è¿™ç§æ–¹å¼ï¼Œå››å…ƒç»„æˆåŠŸçš„é‡æ–°ç”Ÿæˆæ¥è¡¨ç¤ºè½®å»“è¾¹ã€‚ å¤‡æ³¨ï¼šå¦‚æœæˆ‘ä»¬æ²¡æœ‰è®¾ç½®é¡¶ç‚¹v0å’Œv1çš„é¡¶ç‚¹æ³•çº¿ä¸ºé›¶å‘é‡ï¼Œé‚£ä¹ˆé‚£äº›é¡¶ç‚¹å°±åŒæ ·ä¼šè¢«åç§»ã€‚ä½†æ˜¯å¦‚æœåç§»æè¿°è½®å»“è¾¹çš„æ‰€æœ‰å››ä¸ªé¡¶ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä»…æ˜¯å¹³ç§»äº†è¯¥é€€åŒ–å››å…ƒç»„ã€‚é€šè¿‡ä¿æŒé¡¶ç‚¹v0å’Œv1å›ºå®šå¹¶ä»…ä»…åç§»é¡¶ç‚¹v2å’Œv3ï¼Œæˆ‘ä»¬é‡æ–°ç”Ÿæˆäº†å››å…ƒç»„ã€‚ 17.5.3.2 è½®å»“è¾¹æµ‹è¯• è‹¥ä¸¤ä¸ªä¸‰è§’é¢face0å’Œface1åœ¨è§†å›¾æ–¹å‘ä¸Šä¸ä¸¤ä¸ªä¸åŒæ–¹å‘çš„é¢å…±äº«åŒä¸€æ¡è¾¹ï¼Œåˆ™è¯¥è¾¹ä¸ºè½®å»“è¾¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªé¢æ˜¯å‰é¢ï¼ˆfront facingï¼‰è€Œå¦ä¸€ä¸ªé¢æ˜¯åé¢ï¼ˆback facingï¼‰ï¼Œé‚£ä¹ˆè¿™æ¡è¾¹å°±æ˜¯ä¸€æ¡è½®å»“è¾¹ã€‚å›¾17.8ç»™å‡ºäº†ä¸€ä¸ªè½®å»“è¾¹å’Œä¸€ä¸ªéè½®å»“è¾¹çš„ä¾‹å­ã€‚ å›¾17.8ï¼šåœ¨ï¼ˆaï¼‰ä¸­ï¼Œç”±v0 å’Œv1å®šä¹‰çš„å…±äº«è¾¹çš„ä¸€ä¸ªé¢æ˜¯å‰é¢ï¼Œè€Œå…±äº«è¾¹å¦ä¸€ä¸ªé¢æ˜¯èƒŒé¢ï¼Œå› æ­¤è¯¥è¾¹æ˜¯è½®å»“è¾¹ã€‚åœ¨ï¼ˆbï¼‰ä¸­ï¼Œç”±v0 å’Œv1å®šä¹‰çš„è¿™ä¸¤ä¸ªå…±äº«è¾¹é¢éƒ½æ˜¯å‰é¢ï¼Œå› æ­¤è¯¥è¾¹ä¸æ˜¯è½®å»“è¾¹ã€‚ æ¥ä¸‹æ¥ï¼Œä¸ºäº†æ£€æµ‹ä¸€ä¸ªé¡¶ç‚¹æ˜¯å¦åœ¨è½®å»“è¾¹ä¸Šï¼Œæˆ‘ä»¬å¿…é¡»ä»¥æ¯ä¸ªé¡¶ç‚¹ä¸ºåŸºç¡€äº†è§£face0 å’Œ face1çš„æ³•çº¿å‘é‡ã€‚æˆ‘ä»¬çš„è¾¹çš„é¡¶ç‚¹æ•°æ®ç»“æ„åæ˜ å¦‚ä¸‹ï¼šstruct VS_INPUT{ vector position : POSITION; vector normal : NORMAL0; vector faceNormal1 : NORMAL1; vector faceNormal2 : NORMAL2;}; å‰ä¸¤ä¸ªåˆ†é‡å¾ˆç›´æ¥ï¼Œä½†è®©æˆ‘ä»¬çœ‹çœ‹ä¸¤ä¸ªé¢å¤–çš„æ³•çº¿å‘é‡ï¼Œå®ƒä»¬æ˜¯faceNormal1å’ŒfaceNormal2ã€‚è¿™äº›å‘é‡æè¿°äº†ä¸¤ä¸ªä¸‰è§’é¢çš„é¢æ³•çº¿ï¼Œå…±äº«è¾¹çš„é¡¶ç‚¹ä½äºè¿™ä¸¤ä¸ªé¢çš„å…±äº«è¾¹ä¸Šï¼Œè¿™ä¸¤ä¸ªé¢æ˜¯face0å’Œface1ã€‚ å®é™…æ£€æµ‹é¡¶ç‚¹æ˜¯å¦åœ¨å…±äº«è¾¹ä¸Šçš„æ•°å­¦å¦‚ä¸‹ã€‚å‡è®¾æˆ‘ä»¬åœ¨è§†å›¾ç©ºé—´ä¸­ï¼Œä»¤vä¸ºä¸€åŸç‚¹æŒ‡å‘æ£€æµ‹é¡¶ç‚¹çš„å‘é‡â€”â€”å›¾17.8ï¼Œä»¤n0ä¸ºface0çš„é¢æ³•çº¿ä¸”n1ä¸ºface0çš„é¢æ³•çº¿ï¼Œè‹¥ä¸‹é¢çš„ä¸ç­‰å¼ä¸ºçœŸï¼Œåˆ™é¡¶ç‚¹ä½äºè½®å»“è¾¹ä¸Šï¼šï¼ˆ1ï¼‰ï¼ˆvÂ·n0ï¼‰ï¼ˆvÂ·n1ï¼‰ï¼œ0 è‹¥ä¸¤ç‚¹ç§¯ç¬¦å·ç›¸å¼‚ï¼Œåˆ™ä¸ç­‰å¼ä¸ºçœŸï¼Œä½¿å¾—ä¸ç­‰å¼å·¦è¾¹ä¸ºè´Ÿã€‚å›æƒ³ä¸€ä¸‹ç‚¹ç§¯çš„æ€§è´¨ï¼šä¸¤ä¸ªç‚¹ç§¯çš„ç¬¦å·ç›¸å¼‚ï¼Œè¿™æ„å‘³ç€ä¸€ä¸ªä¸‰è§’é¢æ˜¯å‰é¢è€Œå¦ä¸€ä¸ªæ˜¯åé¢ã€‚ ç°åœ¨ï¼Œè€ƒè™‘ä¸€æ¡è¾¹åªæœ‰ä¸€ä¸ªä¸‰è§’å½¢å…±äº«å®ƒçš„æƒ…å†µï¼Œå¦‚å›¾17.9ï¼Œå…¶æ³•çº¿å°†ä¼šè¢«å­˜å‚¨åœ¨faceNormal1ä¸­ã€‚ å›¾ 17.9ï¼šé¡¶ç‚¹v0å’Œv1å®šä¹‰çš„è¾¹åªæœ‰ä¸€ä¸ªä¸‰è§’é¢å…±äº«å®ƒ æˆ‘ä»¬å®šä¹‰è¿™ç§è¾¹æ€»ä¸ºè½®å»“è¾¹ã€‚è¦ç¡®ä¿é¡¶ç‚¹ç€è‰²å™¨å°†è¿™ç§è¾¹ä½œä¸ºè½®å»“è¾¹å¤„ç†ï¼Œæˆ‘ä»¬è¦è®©faceNormal2 = -faceNormal1ã€‚å› æ­¤ï¼Œåå‘çš„é¢æ³•çº¿å’Œä¸ç­‰å¼ï¼ˆ1ï¼‰ä¸ºçœŸï¼Œè¡¨ç¤ºè¯¥è¾¹ä¸ºä¸€è½®å»“è¾¹ã€‚ 17.5.3.3 è¾¹çš„ç”Ÿæˆ ç”Ÿæˆç½‘æ ¼çš„è¾¹æ˜¯å¾®ä¸è¶³é“çš„ï¼›æˆ‘ä»¬ç®€å•çš„éå†ç½‘æ ¼çš„æ¯ä¸ªä¸‰è§’é¢å¹¶ä¸ºä¸‰è§’é¢ä¸Šæ¯æ¡è¾¹è®¡ç®—ä¸€ä¸ªå››å…ƒç»„ï¼ˆé€€åŒ–çš„ï¼Œå¦‚å›¾17.6æ‰€ç¤ºï¼‰ã€‚æ³¨æ„ï¼šæ¯ä¸ªä¸‰è§’é¢æœ‰ä¸‰æ¡è¾¹ï¼Œå› ä¸ºæ¯ä¸ªä¸‰è§’å½¢æœ‰ä¸‰æ¡è¾¹ã€‚ å¯¹äºæ¯æ¡è¾¹ä¸Šçš„é¡¶ç‚¹ï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦çŸ¥é“å…±äº«è¾¹çš„ä¸¤ä¸ªä¸‰è§’é¢ã€‚ä¸€ä¸ªé¢æ˜¯è¾¹æ‰€åœ¨çš„ä¸‰è§’å½¢ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¦è®¡ç®—ç¬¬1ä¸ªé¢çš„ä¸€æ¡è¾¹ï¼Œé‚£ä¹ˆç¬¬1ä¸ªé¢å…±äº«è¯¥è¾¹ã€‚å…±äº«è¯¥è¾¹çš„å¦ä¸€ä¸ªé¢å¯ä»¥ä½¿ç”¨ç½‘æ ¼çš„é‚»æ¥ä¿¡æ¯æ‰¾åˆ°ã€‚17.5.4 è½®å»“è¾¹é¡¶ç‚¹ç€è‰²å™¨ä»£ç  æˆ‘ä»¬ç°åœ¨å‘ˆç°æ¸²æŸ“è½®å»“è¾¹çš„é¡¶ç‚¹ç€è‰²å™¨ä»£ç ã€‚è¿™ä¸ªç€è‰²å™¨çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯ç¡®å®šä¼ å…¥çš„é¡¶ç‚¹æ˜¯å¦åœ¨è½®å»“è¾¹ä¸Šã€‚å¦‚æœæ˜¯ï¼Œé¡¶ç‚¹ç€è‰²å™¨å°±ä»¥ä¸€å®šçš„å€¼ï¼ŒæŒ‰é¡¶ç‚¹æ³•çº¿çš„æ–¹å‘åç§»é¡¶ç‚¹ã€‚// File: outline.txt// Desc: Vertex shader renders silhouette edges. // Globals extern matrix WorldViewMatrix;extern matrix ProjMatrix;static vector Black = {0.0f, 0.0f, 0.0f, 0.0f}; // Structuresstruct VS_INPUT{ vector position : POSITION; vector normal : NORMAL0; vector faceNormal1 : NORMAL1; vector faceNormal2 : NORMAL2;};struct VS_OUTPUT{ vector position : POSITION; vector diffuse : COLOR;}; // MainVS_OUTPUT Main(VS_INPUT input){ // zero out each member in output VS_OUTPUT output = (VS_OUTPUT)0; // transform position to view space input.position = mul(input.position, WorldViewMatrix); // Compute a vector in the direction of the vertex // from the eye. Recall the eye is at the origin // in view space - eye is just camera position. vector eyeToVertex = input.position; // transform normals to view space. Set w // components to zero since we&#39;re transforming vectors. // Assume there are no scalings in the world // matrix as well. input.normal.w = 0.0f; input.faceNormal1.w = 0.0f; input.faceNormal2.w = 0.0f; input.normal = mul(input.normal, WorldViewMatrix); input.faceNormal1 = mul(input.faceNormal1, WorldViewMatrix); input.faceNormal2 = mul(input.faceNormal2, WorldViewMatrix); // compute the cosine of the angles between // the eyeToVertex vector and the face normals. float dot0 = dot(eyeToVertex, input.faceNormal1); float dot1 = dot(eyeToVertex, input.faceNormal2); // if cosines are different signs (positive/negative) // then we are on a silhouette edge. Do the signs // differ? if( (dot0 * dot1) &lt; 0.0f ) { // yes, then this vertex is on a silhouette edge, // offset the vertex position by some scalar in the // direction of the vertex normal. input.position += 0.1f * input.normal; } // transform to homogeneous clip space output.position = mul(input.position, ProjMatrix); // set outline color output.diffuse = Black; return output; } 17.6 æ‘˜è¦ ä½¿ç”¨é¡¶ç‚¹ç€è‰²å™¨ï¼Œæˆ‘ä»¬å¯ä»¥æ›¿æ¢å›ºå®šåŠŸèƒ½ç®¡çº¿çš„å˜æ¢å’Œå…‰ç…§é˜¶æ®µã€‚é€šè¿‡ç”¨æˆ‘ä»¬è‡ªå·±çš„ç¨‹åºï¼ˆé¡¶ç‚¹ç€è‰²å™¨ï¼‰æ›¿æ¢æ­¤å›ºå®šå¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å›¾å½¢æ•ˆæœæ–¹é¢è·å¾—æˆ‘ä»¬èƒ½å¤Ÿè¾¾åˆ°çš„æå¤§çš„è‡ªç”±æ€§ã€‚ é¡¶ç‚¹å£°æ˜ç”¨äºæè¿°é¡¶ç‚¹æ ¼å¼ã€‚å®ƒä»¬å’Œè‡ªç”±é¡¶ç‚¹æ ¼å¼ç›¸ä¼¼ï¼Œä½†æ˜¯æ›´åŠ è‡ªç”±å¹¶å…è®¸æˆ‘ä»¬æè¿°FVFä¸èƒ½æè¿°çš„é¡¶ç‚¹æ ¼å¼ã€‚æ³¨æ„ï¼Œå¦‚æœé¡¶ç‚¹å¯ä»¥ç”¨FVFæè¿°ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨å®ƒä»¬ï¼›ä¸ç®¡æ€æ ·ï¼Œåœ¨å†…éƒ¨å®ƒä»¬è¢«è½¬æ¢ä¸ºé¡¶ç‚¹å£°æ˜ã€‚ å¯¹äºè¾“å…¥ï¼Œç”¨é€”è¯­ä¹‰æŒ‡å®šäº†é¡¶ç‚¹åˆ†é‡å¦‚ä½•è¢«ä»é¡¶ç‚¹å£°æ˜æ˜ å°„åˆ°HLSLç¨‹åºä¸­çš„å˜é‡ã€‚å¯¹äºè¾“å‡ºï¼Œç”¨é€”è¯­ä¹‰æŒ‡å®šäº†é¡¶ç‚¹åˆ†é‡æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼ˆä¾‹å¦‚ï¼šä½ç½®ã€é¢œè‰²ã€çº¹ç†åæ ‡ï¼Œç­‰ç­‰ï¼‰ã€‚]]></content>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬åå…­ç«  é«˜çº§ç€è‰²å™¨è¯­è¨€å…¥é—¨(Introduction to the High-Level Shading Language)]]></title>
    <url>%2F2019%2F04%2F11%2FIntorduction-to-the-High-Level-Shading-Language%2F</url>
    <content type="text"><![CDATA[åœ¨è¿™ä¸€ç« é‡Œæˆ‘ä»¬æè¿°é«˜çº§ç€è‰²å™¨è¯­è¨€ï¼ˆHigh-Level Shading Language ï¼Œç®€ç§°HLSLï¼‰ï¼Œåœ¨ä¸‹ä¸‰ç« é‡Œæˆ‘ä»¬ç”¨å®ƒå»ç¼–å†™é¡¶ç‚¹å’Œåƒç´ ç€è‰²å™¨ã€‚ç®€å•çš„è¯´ï¼Œåœ¨æˆ‘ä»¬å†™çš„ç¨‹åºé‡Œé¡¶ç‚¹å’Œåƒç´ æ˜¯å¾ˆå°çš„å¯¹è±¡ï¼Œå®ƒä»¬ç”±GPUæ¥æ‰§è¡Œï¼Œæ˜¯å›ºå®šåŠŸèƒ½ç®¡çº¿çš„ä¸€éƒ¨åˆ†ã€‚ç”¨æˆ‘ä»¬è‡ªå·±å†™çš„ç€è‰²å™¨ç¨‹åºæ›¿æ¢ä¸€éƒ¨åˆ†å›ºå®šåŠŸèƒ½ç®¡çº¿ï¼Œåœ¨ç»˜åˆ¶æ•ˆæœä¸Šæˆ‘ä»¬è·å¾—å¾ˆå¤§çš„çµæ´»æ€§ã€‚æˆ‘ä»¬ä¸å†å±€é™äºé¢„å®šä¹‰çš„â€å›ºå®šâ€æ“ä½œã€‚ ä¸ºäº†ç¼–å†™ç€è‰²å™¨ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§è¯­è¨€ã€‚ åœ¨DirectX 8.x,ä¸­ï¼Œç€è‰²å™¨æ˜¯ç”¨ä½çº§ç€è‰²å™¨æ±‡ç¼–è¯­è¨€ç¼–å†™çš„ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸å¿…å†ç”¨æ±‡ç¼–è¯­è¨€æ¥å†™ç€è‰²å™¨äº†ï¼ŒDirectX 9æ”¯æŒä¸€ç§é«˜çº§ç€è‰²å™¨è¯­è¨€æ¥xynaå†™ã€‚ç”¨HLSLåœ¨æ±‡ç¼–è¯­è¨€æ¥å†™ç€è‰²å™¨ç¨‹åºä¸ä½¿ç”¨é«˜çº§è¯­è¨€æœ‰åŒæ ·çš„ä¼˜åŠ¿ï¼ŒåƒC++ï¼Œå®ƒè¶…è¶Šäº†æ±‡ç¼–è¯­è¨€ï¼Œå³ï¼š å¢åŠ ç”Ÿäº§åŠ›â€”ç”¨é«˜çº§è¯­è¨€æ¯”ç”¨ä½çº§è¯­è¨€å†™ç¨‹åºæ›´å¿«ã€æ›´å®¹æ˜“ã€‚ æˆ‘ä»¬å¯ä»¥èŠ±è´¹æ›´å¤šçš„æ—¶é—´å…³æ³¨äºç®—æ³•è€Œä¸æ˜¯ä»£ç ã€‚ å¢åŠ å¯è¯»æ€§â€”ç”¨é«˜çº§è¯­è¨€å†™çš„ç¨‹åºæ›´æ˜“è¯»ï¼Œè¿™æ„å‘³ç€ç”¨é«˜çº§è¯­è¨€ç¼–ç¨‹æ›´æ˜“äºè°ƒè¯•å’Œç»´æŠ¤ã€‚ å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨äº§ç”Ÿçš„æ±‡ç¼–ä»£ç æ¯”æ‰‹å†™æœ‰æ•ˆç‡ã€‚ ä½¿ç”¨HLSL ç¼–è¯‘å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–è¯‘æˆ‘ä»¬çš„ä»£ç åˆ°ä»»ä½•å¯ç”¨shaderç‰ˆæœ¬ï¼Œä½¿ç”¨æ±‡ç¼–è¯­è¨€æˆ‘ä»¬å°†ä¸å¾—ä¸ä¸ºæ¯ä¸ªéœ€è¦çš„ç‰ˆæœ¬ç§»æ¤ä»£ç ã€‚ HLSL åŒCå’ŒC++è¯­æ³•å¾ˆç±»ä¼¼, æ‰€ä»¥ç¼©çŸ­äº†å­¦ä¹ æ›²çº¿ã€‚ æœ€åï¼Œå¦‚æœä½ çš„æ˜¾å¡ä¸æ”¯æŒé¡¶ç‚¹å’Œåƒç´ ç€è‰²å™¨çš„è¯ï¼Œä¸ºäº†æ‰§è¡Œç€è‰²å™¨çš„ä¾‹å­ç¨‹åºä½ å°†éœ€è¦è½¬æ¢REFè®¾å¤‡ã€‚ä½¿ç”¨REFè®¾å¤‡æ„å‘³ç€ç€è‰²å™¨ä¾‹å­è¿è¡Œçš„ä¼šå¾ˆæ…¢ï¼Œä½†å®ƒè‡³å°‘èƒ½æ˜¾ç¤ºç»“æœï¼Œè®©æˆ‘ä»¬å»æ£€æŸ¥æ˜¯å¦ä»£ç å¯ä»¥è¢«æ‰§è¡Œã€‚ æç¤ºï¼šé¡¶ç‚¹shaderså¯ä»¥ç”¨è½¯ä»¶æ¥æ¨¡æ‹Ÿ â€•â€• D3DCREATE_SOFTWARE_VERTEX-PROCESSINGã€‚16.1 ç›®æ ‡ å­¦ä¹ å¦‚ä½•å®šã€ç¼–è¯‘ä¸€ä¸ªHLSL ç€è‰²å™¨ç¨‹åºã€‚ å­¦ä¹ å¦‚ä½•å°†ç¨‹åºä¸­çš„æ•°æ®ä¼ é€åˆ°ç€è‰²å™¨ç¨‹åºã€‚ ç†Ÿæ‚‰è¯­æ³•ã€ç±»å‹ï¼Œå’ŒHLSLçš„å†…å»ºå‡½æ•°ã€‚16.1 ç¼–å†™HLSL ç€è‰²å™¨ æˆ‘ä»¬å¯ä»¥åœ¨ç¨‹åºæºæ–‡ä»¶ä¸­ç”¨é•¿å­—ç¬¦ä¸²ç›´æ¥ç¼–å†™HLSL ç€è‰²å™¨ä»£ç ï¼Œç„¶è€Œæ›´æ–¹ä¾¿ã€æ›´æ¨¡å—åŒ–çš„æ–¹æ³•æ˜¯æŠŠå®ƒä¸ç¨‹åºä»£ç åˆ†ç¦»å‡ºæ¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨è®°äº‹æœ¬ä¸­ç¼–å†™ç€è‰²å™¨å¹¶ä¿å­˜æˆä¸€èˆ¬çš„ASCIIæ–‡æœ¬æ–‡ä»¶ï¼Œç„¶åå¯ä»¥ç”¨D3DXCompileShaderFromFileå‡½æ•°(section 16.2.2)æ¥ç¼–è¯‘å®ƒä»¬ã€‚ ä½œä¸ºä»‹ç»ï¼Œä¸‹é¢æ˜¯ç”¨HLSLç¼–å†™çš„ä¸€ä¸ªç®€å•çš„é¡¶ç‚¹ç€è‰²å™¨ï¼Œç”¨è®°äº‹æœ¬ç”Ÿæˆå¹¶ä¿å­˜æˆæ–‡æœ¬æ–‡ä»¶â€œTransform.txtâ€ã€‚å…¨éƒ¨å·¥ç¨‹éƒ½åœ¨æ ‡é¢˜ä¸ºTransformçš„ç›®å½•ä¸‹ï¼Œé¡¶ç‚¹ç€è‰²å™¨ç”¨ç»„åˆè§†å›¾å’ŒæŠ•å½±çŸ©é˜µè½¬æ¢é¡¶ç‚¹ï¼Œå¹¶è®¾ç½®é¡¶ç‚¹æ¼«å°„å…‰ä¸ºè“è‰²ã€‚ æ³¨æ„ï¼šè¿™æ˜¯ä¸€ä¸ªé¡¶ç‚¹ç€è‰²å™¨çš„ä¾‹å­ï¼Œä¸å¿…å…³å¿ƒé¡¶ç‚¹ç€è‰²å™¨åšäº†ä»€ä¹ˆï¼Œè¿™æ˜¯ä¸‹ä¸€ç« åŒ…å«çš„å†…å®¹ï¼Œç°åœ¨çš„ç›®æ ‡æ˜¯ç†Ÿæ‚‰HLSLç¼–ç¨‹çš„è¯­æ³•å’Œæ ¼å¼ã€‚// File: transform.txt// Author: Frank D. Luna (C) All Rights Reserved// System: AMD Athlon 1800+ XP, 512 DDR, Geforce 3, Windows XP,// MSVC++ 7.0 // Desc: é¡¶ç‚¹ç€è‰²å™¨ç”¨ç»„åˆè§†å›¾å’ŒæŠ•å½±çŸ©é˜µè½¬æ¢é¡¶ç‚¹ï¼Œå¹¶è®¾ç½®é¡¶ç‚¹æ¼«å°„å…‰ä¸ºè“è‰². //å…¨å±€å˜é‡//ç”¨æ¥ä¿å­˜è§†å›¾å’ŒæŠ•å½±çš„ç»„åˆçŸ©é˜µï¼Œåœ¨ç¨‹åºä¸­åˆå§‹åŒ–å˜é‡matrix ViewProjMatrix; // åˆå§‹åŒ–é¢œè‰²å˜é‡ï¼ˆè“è‰²ï¼‰vector Blue = {0.0f, 0.0f, 1.0f, 1.0f}; // ç»“æ„// Inputç»“æ„ç”¨æ¥æè¿°è¾“å…¥åˆ°ç€è‰²å™¨çš„é¡¶ç‚¹ï¼Œè¿™ä¸ªInputé¡¶ç‚¹åªåŒ…å«ä¸€ä¸ªä½ç½®æˆå‘˜struct VS_INPUT{ vector position : POSITION;}; //Outputç»“æ„ç”¨æ¥æè¿°ä»ç€è‰²å™¨è¾“å‡ºçš„é¡¶ç‚¹ï¼Œè¿™ä¸ªOutputé¡¶ç‚¹åŒ…å«ä½ç½®å’Œé¢œè‰²æˆå‘˜struct VS_OUTPUT{ vector position : POSITION; vector diffuse : COLOR;}; //ä¸»å…¥å£ç‚¹ï¼Œè¿™ä¸ªmainå‡½æ•°æ¥æ”¶ä¸€ä¸ªInputé¡¶ç‚¹çš„æ‹·è´ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªOutputé¡¶ç‚¹çš„æ‹·è´VS_OUTPUT Main(VS_INPUT input){ // å°†outputç»“æ„æ‰€æœ‰æˆå‘˜åˆå§‹åŒ– VS_OUTPUT output = (VS_OUTPUT)0; // å°†ä½ç½®å˜æ¢åˆ°æŠ•å½±ç©ºé—´ output.position = mul(input.position, ViewProjMatrix); // è®¾ç½®é¡¶ç‚¹é¢œè‰² output.diffuse = Blue; //Output the projected and colored vertex. return output;} 16.1.1 å…¨å±€å˜é‡é¦–å…ˆæ˜¯2ä¸ªå…¨å±€å˜é‡ï¼šmatrix ViewProjMatrix;vector Blue = {0.0f, 0.0f, 1.0f, 1.0f}; ç¬¬1ä¸ªå˜é‡ViewProjMatrixæ˜¯çŸ©é˜µç±»å‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªåœ¨HLSL å†…åˆ›å»ºçš„4Ã—4çš„çŸ©é˜µç±»å‹ã€‚è¿™ä¸ªå˜é‡ä¿å­˜è§†å›¾ä¸æŠ•å½±çš„ç»„åˆçŸ©é˜µï¼Œå®ƒæè¿°ä¸¤è€…çš„å˜æ¢ã€‚ä½¿ç”¨è¿™ç§æ–¹æ³•æˆ‘ä»¬åªè¦åšä¸€ä¸ªå‘é‡å’ŒçŸ©é˜µçš„ä¹˜æ³•ï¼ˆè€Œä¸æ˜¯äºŒä¸ªï¼‰ã€‚æ³¨æ„ï¼Œåœ¨ç€è‰²å™¨æºä»£ç çš„ä»»ä½•åœ°æ–¹éƒ½æ²¡æœ‰åˆå§‹åŒ–è¿™ä¸ªå˜é‡ï¼Œå› ä¸ºå®ƒæ˜¯æˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºçš„æºä»£ç é‡Œè®¾ç½®çš„ï¼Œè€Œä¸æ˜¯åœ¨ç€è‰²å™¨ä¸­ã€‚ä»åº”ç”¨ç¨‹åºå‘ç€è‰²å™¨ç¨‹åºé€šè®¯æ˜¯å¸¸ç”¨çš„æ“ä½œï¼Œä¾‹å­åœ¨16.2.1èŠ‚ã€‚ ç¬¬äºŒä¸ªå˜é‡Blueæ˜¯built-inï¼ˆå†…å»ºï¼‰ç±»å‹çš„4Då‘é‡ï¼Œæˆ‘ä»¬ç®€å•çš„å°†å®ƒåˆå§‹åŒ–æˆè“è‰²ï¼Œå®ƒæ˜¯ä¸ªRGBAçš„é¢œè‰²å‘é‡ã€‚ 16.1.2 è¾“å…¥å’Œè¾“å‡ºç»“æ„ åœ¨å…¨å±€å˜é‡å®šä¹‰ä¹‹åï¼Œå®šä¹‰2ä¸ªç‰¹æ®Šçš„ç»“æ„ï¼Œæˆ‘ä»¬è°ƒç”¨è¾“å…¥å’Œè¾“å‡ºç»“æ„ã€‚å¯¹äºé¡¶ç‚¹ç€è‰²å™¨è€Œè¨€ï¼Œè¿™äº›ç»“æ„å®šä¹‰äº†é¡¶ç‚¹çš„æ•°æ®ï¼Œåˆ†åˆ«æ˜¯ï¼šstruct VS_INPUT{ vector position : POSITION;}; struct VS_OUTPUT{ vector position : POSITION; vector diffuse : COLOR;};æ³¨æ„ï¼šç»™åƒç´ ç€è‰²å™¨çš„ç»“æ„å®šä¹‰è¾“å…¥å’Œè¾“å‡ºåƒç´ æ•°æ®ã€‚ åœ¨ä¾‹å­ä¸­ï¼ŒINPUT é¡¶ç‚¹ç€è‰²å™¨åªåŒ…å«ä½ç½®æˆå‘˜ï¼ˆPOSITIONï¼‰ï¼ŒOUTPUTé¡¶ç‚¹ç€è‰²å™¨åŒ…å«ä½ç½®å’Œé¢œè‰²æˆå‘˜ï¼ˆPOSITION and COLORï¼‰ã€‚ ç‰¹æ®Šçš„å†’å·æ˜¯ä¸€ç§è¯­ä¹‰ï¼Œç”¨äºæ˜¯å£°æ˜å˜é‡ã€‚è¿™ä¸vertexç»“æ„ä¸­çš„è‡ªç”±é¡¶ç‚¹æ ¼å¼ï¼ˆFVFï¼‰ç›¸ä¼¼ã€‚ä¾‹å¦‚ï¼Œåœ¨VS_INPUTä¸­æœ‰æˆå‘˜ï¼švector position : POSITION; â€œ: COLORâ€æ˜¯è¯´é¡¶ç‚¹çš„æ¼«å°„å…‰æ˜¯ç”¨VS_OUTPUTç»“æ„çš„COLORæˆå‘˜æ¥è¯´æ˜çš„ã€‚åœ¨ä¸‹ä¸€ç« ä¸­å¯¹äºé¡¶ç‚¹å’Œåƒç´ ç€è‰²å™¨ä¸­å‘é‡çš„æ ‡è¯†ç¬¦ç”¨æ³•ï¼Œæˆ‘ä»¬å°†ä¼šæœ‰æ›´å¤šçš„è®¨è®ºã€‚ æ³¨æ„ï¼šä»åº•å±‚æ¥è¯´ï¼Œç€è‰²å™¨å˜é‡çš„è¯­ä¹‰å’Œè¯­æ³•åŒç¡¬ä»¶å¯„å­˜å™¨æ˜¯ç›¸å…³è”çš„ã€‚å³ï¼Œinputå˜é‡ä¸inputå¯„å­˜å™¨å…³è”ï¼Œoutputå˜é‡ä¸outputå¯„å­˜å™¨å…³è”ã€‚ä¾‹å¦‚ï¼ŒVS_INPUTä¸­çš„positionæˆå‘˜ä¸é¡¶ç‚¹inputçš„positionå¯„å­˜å™¨ç›¸å…³è”ã€‚åŒæ ·ï¼Œdiffuseä¸é¡¶ç‚¹çš„output çš„colorå¯„å­˜å™¨å…³è”ã€‚ 16.1.3 å‡½æ•°çš„å…¥å£ç‚¹ åœ¨C++ç¨‹åºä¸­ï¼Œæ¯ä¸ªHLSLç¨‹åºæœ‰ä¸€ä¸ªå…¥å£ç‚¹ã€‚åœ¨æˆ‘ä»¬çš„ç€è‰²å™¨ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨å…¥å£ç‚¹å‡½æ•°mainã€‚ç„¶è€Œåå­—ä¸æ˜¯å¼ºåˆ¶çš„ã€‚å…¥å£ç‚¹å‡½æ•°åå¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆçš„å‡½æ•°åï¼Œå…¥å£ç‚¹å‡½æ•°å¿…é¡»æœ‰ä¸€ä¸ªinputç»“æ„å‚æ•°ï¼Œå®ƒé€šè¿‡inputé¡¶ç‚¹è¿›å…¥ç€è‰²å™¨ã€‚å…¥å£ç‚¹å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªoutputç»“æ„å®ä¾‹ï¼Œåœ¨ç€è‰²å™¨ä¸­ä½¿ç”¨outputæ“ä½œé¡¶ç‚¹ã€‚VS_OUTPUT Main(VS_INPUT input){ æ³¨æ„ï¼šå®é™…ä¸Šï¼Œä½¿ç”¨inputã€outputç»“æ„ä¸æ˜¯å¼ºåˆ¶çš„ã€‚ä¾‹å¦‚ï¼Œæœ‰æ—¶ä½ å°†ä¼šçœ‹åˆ°ä½¿ç”¨ç±»ä¼¼ä¸‹é¢çš„è¯­æ³•ï¼Œç‰¹åˆ«æ˜¯åœ¨åƒç´ ç€è‰²å™¨ä¸­ï¼šfloat4 Main(in float2 base : TEXCOORD0, in float2 spot : TEXCOORD1, in float2 text : TEXCOORD2) : COLOR{â€¦} ä¾‹å­ä¸­ï¼Œè¾“å…¥åˆ°ç€è‰²å™¨ä¸­çš„å‚æ•°æ˜¯3ä¸ªçº¹ç†åæ ‡ã€‚ç€è‰²å™¨è¾“å‡ºï¼ˆè¿”å›ï¼‰ä¸€ä¸ªé¢œè‰²ï¼ŒCOLORè¯­å¥åœ¨å‡½æ•°çš„å£°æ˜ä»¥åã€‚è¿™ç§å®šä¹‰æ˜¯ç±»ä¼¼äºï¼šstruct INPUT{ float2 base : TEXCOORD0; float2 spot : TEXCOORD1; float2 text : TEXCOORD2;}; struct OUTPUT{ float4 c : COLOR;}; OUTPUT Main(INPUT input){â€¦} è¾“å…¥ç‚¹å‡½æ•°è´Ÿè´£æ ¹æ®ç»™å®šçš„inputé¡¶ç‚¹è®¡ç®—outputé¡¶ç‚¹ã€‚ä¾‹å­ä¸­çš„ç€è‰²å™¨ç®€å•çš„å˜æ¢inputé¡¶ç‚¹åˆ°è§†å›¾ç©ºé—´å’ŒæŠ•å½±ç©ºé—´ï¼Œè®¾ç½®é¡¶ç‚¹é¢œè‰²ä¸ºè“è‰²ï¼Œå¹¶è¿”å›ç»“æœé¡¶ç‚¹ã€‚é¦–å…ˆæˆ‘ä»¬å®šä¹‰VS_OUTPUTçš„å®ä¾‹å¹¶åˆå§‹åŒ–æ‰€æœ‰æˆå‘˜ä¸º0ã€‚VS_OUTPUT output = (VS_OUTPUT)0; // zero out all members ç„¶åç€è‰²å™¨å˜æ¢inputé¡¶ç‚¹ä½ç½®ç”¨ViewProjMatrixå˜é‡ï¼Œä½¿ç”¨mul å‡½æ•°ã€‚å®ƒæ˜¯ä¸€ä¸ªbuilt-inï¼ˆå†…å»ºï¼‰å‡½æ•°ï¼Œå®ç°å‘é‡ä¸çŸ©é˜µç›¸ä¹˜ï¼Œæˆ–çŸ©é˜µä¸çŸ©é˜µç›¸ä¹˜ã€‚æˆ‘ä»¬ä¿å­˜ç»“æœå˜æ¢çš„å‘é‡ï¼ˆåœ¨outputå®ä¾‹çš„positionæˆå‘˜ä¸­ï¼‰ã€‚// å˜æ¢åä¸ºæŠ•å½±ç©ºé—´çš„ä½ç½®output.position = mul(input.position, ViewProjMatrix); ç„¶åè®¾ç½®outputçš„æˆå‘˜diffuseçš„é¢œè‰²ä¸ºè“è‰²ï¼š// è®¾ç½®é¡¶ç‚¹é¢œè‰²output.diffuse = Blue; æœ€åè¿”å›ç»“æœå‘é‡ï¼šreturn output;}16.2 ç¼–è¯‘HLSL ç€è‰²å™¨16.2.1 å¸¸é‡è¡¨ æ¯ä¸ªç€è‰²å™¨æœ‰ä¸€ä¸ªå¸¸é‡è¡¨ï¼Œç”¨æ¥ä¿å­˜å®ƒçš„å˜é‡ã€‚D3DXåº“é€šè¿‡ID3DXConstantTableæ¥å£ï¼Œæä¾›ç»™åº”ç”¨ç¨‹åºè®¿é—®ç€è‰²å™¨çš„å¸¸é‡è¡¨ã€‚é€šè¿‡è¿™ä¸ªæ¥å£æˆ‘ä»¬èƒ½å¤Ÿåœ¨åº”ç”¨ç¨‹åºä¸­è®¾ç½®ç€è‰²å™¨æºä»£ç ä¸­çš„å˜é‡ã€‚ æˆ‘ä»¬ç°åœ¨æè¿°ä¸€ä¸ªè¢«èŠ‚é€‰äº†çš„ID3DXConstantTableæ¥å£çš„æ–¹æ³•åˆ—è¡¨çš„å®ç°ï¼Œå…¨éƒ¨çš„åˆ—è¡¨è¯·æŸ¥é˜…Direct3Dæ–‡æ¡£ã€‚16.2.1.1 å–å¾—å¸¸é‡å¥æŸ„ ä¸ºäº†åœ¨åº”ç”¨ç¨‹åºä¸­è®¾ç½®ç€è‰²å™¨ä¸­çš„ä¸€ä¸ªç‰¹å®šå˜é‡ï¼Œéœ€è¦æœ‰ä¸€ç§æ–¹æ³•å»å¼•ç”¨å®ƒï¼Œæˆ‘ä»¬èƒ½å¤Ÿåœ¨åº”ç”¨ç¨‹åºä¸­ç”¨D3DXHANDLEå¼•ç”¨ä¸€ä¸ªåœ¨ç€è‰²å™¨ä¸­çš„å˜é‡ï¼Œä¸‹é¢çš„æ–¹æ³•è¿”å›ä¸€ä¸ªç€è‰²å™¨ä¸­çš„å˜é‡çš„D3DXHANDLEï¼Œä½¿ç”¨æ—¶ï¼Œéœ€è¦ä¼ é€’ä¸€ä¸ªå˜é‡çš„åå­—ä½œä¸ºå‚æ•°ï¼šD3DXHANDLE ID3DXConstantTable::GetConstantByName( D3DXHANDLE hConstant, // scope of constant LPCSTR pName // name of constant); Hconstantâ€”â€”æˆ‘ä»¬è¦å–å¾—çš„çˆ¶ç»“æ„ä¸­å˜é‡å¥æŸ„çš„D3DXHANDLEæ ‡è¯†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è·å¾—ä¸€ä¸ªç‰¹å®šæ•°æ®ç»“æ„ä¸­å•ä¸€æ•°æ®æˆå‘˜çš„å¥æŸ„ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ é€’ç»“æ„å®ä¾‹çš„å¥æŸ„ã€‚å¦‚æœæˆ‘ä»¬è·å¾—ä¸€ä¸ªé¡¶çº§å˜é‡çš„å¥æŸ„ï¼Œç»™è¿™ä¸ªå‚æ•°è®¾ä¸º0ã€‚ PNameâ€”â€”æˆ‘ä»¬æƒ³è·å¾—çš„å¥æŸ„çš„ç€è‰²å™¨ä»£ç ä¸­çš„å˜é‡çš„åå­—ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœåœ¨ç€è‰²å™¨ä¸­å˜é‡çš„åå­—ä¸ºViewProjMatrixï¼Œå¹¶ä¸”è¿™æ˜¯é¡¶çº§å˜é‡ï¼Œæˆ‘ä»¬è¿™ä¹ˆå†™ï¼š// å–å¾—ç€è‰²å™¨ä¸­ViewProjMatrixå˜é‡çš„å¥æŸ„D3DXHANDLE h0;h0 = ConstTable-&gt;GetConstantByName(0, â€œViewProjMatrixâ€); 16.2.1.2 è®¾ç½®å¸¸é‡ ä¸€æ—¦åº”ç”¨ç¨‹åºæœ‰äº†ä¸€ä¸ªD3DXHANDLEï¼Œè¦å¼•ç”¨ç€è‰²å™¨ä»£ç ä¸­çš„å…·ä½“å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ID3DXConstantTable::SetXXXæ–¹æ³•è®¾ç½®å˜é‡ã€‚å¦‚æœæˆ‘ä»¬æƒ³è®¾ç½®ä¸€ä¸ªå‘é‡æ•°ç»„ç±»å‹çš„å˜é‡ï¼Œæ–¹æ³•åæ˜¯SetVectorArrayã€‚ ID3DXConstantTable::SetXXXçš„ä¸€èˆ¬è¯­æ³•æ˜¯ï¼šHRESULT ID3DXConstantTable::SetXXX( LPDIRECT3DDEVICE9 pDevice, D3DXHANDLE hConstant, XXX value); PDeviceï¼šå¸¸é‡è¡¨æ‰€å…³è”çš„è®¾å¤‡çš„æŒ‡é’ˆã€‚ HConstantï¼šæˆ‘ä»¬æ­£åœ¨è®¾ç½®çš„å˜é‡å¥æŸ„çš„å¼•ç”¨ã€‚ Valueï¼šæˆ‘ä»¬è¦æŠŠå˜é‡è®¾ç½®æˆçš„å€¼ï¼ŒXXXæ˜¯æˆ‘ä»¬è®¾ç½®çš„è¦æ›¿æ¢çš„å˜é‡ç±»å‹åï¼Œå¯¹äºæœ‰äº›ç±»å‹ï¼ˆbool, int, floatï¼‰ï¼Œä¼ é€’å˜é‡å€¼çš„COPYï¼Œå¦å¤–ä¸€äº›ç±»å‹ï¼ˆvectors, matrices, structuresï¼‰ï¼Œä¼ é€’å€¼çš„æŒ‡é’ˆã€‚ ä¸‹é¢åˆ—è¡¨æè¿°äº†æˆ‘ä»¬èƒ½ç”¨ID3DXConstantTableæ¥å£è®¾ç½®çš„ç±»å‹åˆ—è¡¨ã€‚è¿™é‡Œå‡å®šæˆ‘ä»¬æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„è®¾å¤‡ï¼Œå’Œä¸€ä¸ªæœ‰æ•ˆå¥æŸ„ã€‚SetBoolâ€”Used to set a Boolean value. Sample call:bool b = true;ConstTable-&gt;SetBool(Device, handle, b); SetBoolArrayâ€”Used to set a Boolean array. Sample call:bool b[3] = {true, false, true};ConstTable-&gt;SetBoolArray(Device, handle, b, 3); SetFloatâ€”Used to set a float. Sample call:float f = 3.14f;ConstTable-&gt;SetFloat(Device, handle, f); SetFloatArrayâ€”Used to set a float array. Sample call:float f[2] = {1.0f, 2.0f};ConstTable-&gt;SetFloatArray(Device, handle, f, 2); SetIntâ€”Used to set an integer. Sample call:int x = 4;ConstTable-&gt;SetInt(Device, handle, x); SetIntArrayâ€”Used to set an integer array. Sample call:int x[4] = {1, 2, 3, 4};ConstTable-&gt;SetIntArray(Device, handle, x, 4); SetMatrixâ€”Used to set a 4 Ã— 4 matrix. Sample call:D3DXMATRIX M(â€¦);ConstTable-&gt;SetMatrix(Device, handle, &amp;M); SetMatrixArrayâ€”Used to set a 4 Ã— 4 matrix array. Sample call:D3DXMATRIX M[4];// â€¦Initialize matricesConstTable-&gt;SetMatrixArray(Device, handle, M, 4); SetMatrixPointerArrayâ€”Used to set an array of 4 Ã— 4 matrix pointers. Sample call:D3DXMATRIX* M[4];// â€¦Allocate and initialize matrix pointersConstTable-&gt;SetMatrixPointerArray(Device, handle, M, 4); SetMatrixTransposeâ€”Used to set a transposed 4 Ã— 4 matrix. Sample call:D3DXMATRIX M(â€¦);D3DXMatrixTranspose(&amp;M, &amp;M);ConstTable-&gt;SetMatrixTranspose(Device, handle, &amp;M); SetMatrixTransposeArrayâ€”Used to set an array of 4 Ã— 4 transposed matrices. Sample call:D3DXMATRIX M[4];// â€¦Initialize matrices and transpose them.ConstTable-&gt;SetMatrixTransposeArray(Device, handle, M, 4); SetMatrixTransposePointerArrayâ€”Used to set an array of pointers to 4 Ã— 4 transposed matrices. Sample call:D3DXMATRIX* M[4];// â€¦Allocate,initialize matrix pointers and transpose them.ConstTable-&gt;SetMatrixTransposePointerArray(Device, handle, M, 4); SetVectorâ€”Used to set a variable of type D3DXVECTOR4. Sample call:D3DXVECTOR4 v(1.0f, 2.0f, 3.0f, 4.0f);ConstTable-&gt;SetVector(Device, handle, &amp;v); SetVectorArrayâ€”Used to set a variable that is a vector array. Sample call:D3DXVECTOR4 v[3];// â€¦Initialize vectorsConstTable-&gt;SetVectorArray(Device, handle, v, 3); SetValueâ€”Used to set an arbitrarily sized type, such as a structure. In the sample call, we use SetValue to set a D3DXMATRIX:D3DXMATRIX M(â€¦);ConstTable-&gt;SetValue(Device, handle, (void*)&amp;M, sizeof(M)); 16.2.1.3 è®¾ç½®å¸¸é‡é»˜è®¤å€¼ ä¸‹ä¸€ä¸ªæ–¹æ³•å°±æ˜¯è®¾ç½®å¸¸é‡çš„é»˜è®¤å€¼ï¼Œè¿™äº›é»˜è®¤å€¼åœ¨å£°æ˜æ—¶åˆå§‹åŒ–ã€‚è¿™ä¸ªæ–¹æ³•åº”è¯¥åœ¨åº”ç”¨ç¨‹åºå»ºç«‹ï¼ˆsetupï¼‰æœŸé—´è¢«ä¸€æ¬¡æ€§è°ƒç”¨ï¼ˆcalled onceï¼‰ã€‚ HRESULT ID3DXConstantTable::SetDefaults( LPDIRECT3DDEVICE9 pDevice ); pDeviceâ€”â€”å…³è”åˆ°å¸¸é‡è¡¨çš„è®¾å¤‡çš„æŒ‡é’ˆã€‚ 16.2.2 ç¼–è¯‘HLSLç€è‰²å™¨ æˆ‘ä»¬å¯ä»¥ç¼–è¯‘ä¸€ä¸ªç€è‰²å™¨â€”â€”ç”¨æˆ‘ä»¬å·²ä¿å­˜çš„ç€è‰²å™¨çš„æ–‡æœ¬æ–‡ä»¶â€”â€”ä½¿ç”¨ä¸‹åˆ—å‡½æ•°ï¼š HRESULT D3DXCompileShaderFromFile( LPCSTR pSrcFile, CONST D3DXMACRO pDefines, LPD3DXINCLUDE pInclude, LPCSTR pFunctionName, LPCSTR pTarget, DWORD Flags, LPD3DXBUFFER ppShader, LPD3DXBUFFER ppErrorMsgs, LPD3DXCONSTANTTABLE ppConstantTable ); pSrcFileâ€”â€”è¦ç¼–è¯‘çš„åŒ…å«ç€è‰²å™¨æºä»£ç çš„æ–‡æœ¬æ–‡ä»¶çš„æ–‡ä»¶å pDefinesâ€”â€”å‚æ•°å¯é€‰ï¼Œæœ¬ä¹¦ä¸­æŒ‡å®šä¸ºç©ºã€‚ pIncludeâ€”â€”ID3DXIncludeæ¥å£æŒ‡é’ˆã€‚è¿™ä¸ªæ¥å£è¢«è®¾è®¡æˆç”±åº”ç”¨ç¨‹åºå®ç°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡è½½é»˜è®¤includeçš„è¡Œä¸ºã€‚é€šå¸¸ï¼Œé»˜è®¤è¡Œä¸ºå°±å¯ä»¥äº†ï¼Œè€Œä¸”æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†å…¶æŒ‡å®šä¸ºç©ºå¿½ç•¥æ­¤å‚æ•°ã€‚ pFunctionNameâ€”â€”æŒ‡å®šå…¥å£ç‚¹å‡½æ•°åçš„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç€è‰²å™¨çš„å…¥å£ç‚¹å‡½æ•°å«åšMainï¼Œæˆ‘ä»¬å¯ä»¥ç»™æ­¤å‚æ•°ä¼ é€’â€œMainâ€ã€‚ pTargetâ€”â€”æŒ‡å®šè¦ç¼–è¯‘æˆçš„HLSLç€è‰²å™¨æºæ–‡ä»¶çš„ç‰ˆæœ¬çš„å­—ç¬¦ä¸²ã€‚æœ‰æ•ˆçš„é¡¶ç‚¹ç€è‰²å™¨ç‰ˆæœ¬æ˜¯ï¼švs_1_1, vs_2_0, vs_2_swã€‚æœ‰æ•ˆçš„åƒç´ ç€è‰²å™¨ç‰ˆæœ¬æ˜¯2.0ï¼Œæˆ‘ä»¬å¯ä»¥ç»™æ­¤å‚æ•°ä¼ é€’vs_2_0ã€‚ å¤‡æ³¨ï¼šæœ‰ç¼–è¯‘ä¸åŒç‰ˆæœ¬ç€è‰²å™¨çš„èƒ½åŠ›ï¼Œæ˜¯HLSLä¸æ±‡ç¼–è¯­è¨€æ¯”çš„ä¸»è¦ä¼˜åŠ¿ã€‚ç”¨HLSLæˆ‘ä»¬åªéœ€ä¸ºéœ€è¦çš„ç›®æ ‡ç®€å•çš„é‡æ–°ç¼–è¯‘ï¼Œä¾¿å¯å¿«é€Ÿç§»æ¤ç€è‰²å™¨åˆ°ä¸åŒçš„ç‰ˆæœ¬ã€‚ä½¿ç”¨æ±‡ç¼–ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æ‰‹åŠ¨ç§»æ¤ä»£ç ã€‚ Flagsâ€”â€”å¯é€‰çš„ç¼–è¯‘æ ‡è®°ï¼ŒæŒ‡å®šä¸º0æ ‡è¯†æ²¡æœ‰æ ‡è®°ã€‚æœ‰æ•ˆçš„é€‰é¡¹æ˜¯ï¼š D3DXSHADER_DEBUGâ€”â€”é€šçŸ¥ç¼–è¯‘å™¨å†™å…¥è°ƒè¯•ä¿¡æ¯ D3DXSHADER_SKIPVALIDATIONâ€”â€”é€šçŸ¥ç¼–è¯‘å™¨ä¸è¦åšä»»ä½•ä»£ç æ£€æŸ¥ã€‚æ­¤é¡¹ä»…ç”¨äºä½ å·²çŸ¥ç€è‰²å™¨èƒ½å¤Ÿå·¥ä½œæ—¶ D3DXSHADER_SKIPOPTIMIZATIONâ€”â€”é€šçŸ¥ç¼–è¯‘å™¨ä¸è¦æ‰§è¡Œä»»ä½•ä»£ç ä¼˜åŒ–ã€‚å®è·µä¸­ï¼Œè¿™ä¸ªé€‰é¡¹åº”è¯¥ä»…ç”¨äºè°ƒè¯•ï¼Œå› ä¸ºè¿™ç§æƒ…å†µä¸‹ä½ ä¸å¸Œæœ›ç¼–è¯‘å™¨ä»¥ä»»ä½•æ–¹å¼ä¿®æ”¹ä»£ç ã€‚ ppShaderâ€”â€”è¿”å›å·²ç¼–è¯‘çš„ç€è‰²å™¨ä»£ç çš„ID3DXBufferæŒ‡é’ˆã€‚è¿™ä¸ªå·²ç¼–è¯‘è¿‡çš„ç€è‰²å™¨ä»£ç å°†ä½œä¸ºå¦ä¸€ä¸ªå®é™…åˆ›å»ºé¡¶ç‚¹/åƒç´ ç€è‰²å™¨å‡½æ•°çš„å‚æ•° ppErrorMsgsâ€”â€”è¿”å›åŒ…å«é”™è¯¯ç å’Œé”™è¯¯æ¶ˆæ¯å­—ç¬¦ä¸²çš„ID3DXBufferæŒ‡é’ˆ ppConstantTableâ€”â€”è¿”å›åŒ…å«æ­¤ç€è‰²å™¨å¸¸é‡è¡¨æ•°æ®çš„ID3DXConstantTableæŒ‡é’ˆ è¿™é‡Œæ˜¯ä¸€ä¸ªè°ƒç”¨D3DXCompileShaderFromFileçš„ä¾‹å­ï¼š // Compile shader ID3DXConstantTable TransformConstantTable = 0; ID3DXBuffer shader = 0; ID3DXBuffer* errorBuffer = 0; hr = D3DXCompileShaderFromFile( &quot;transform.txt&quot;, // shader filename 0, 0, &quot;Main&quot;, // entry point function name &quot;vs 2 0&quot;, // shader version to compile to D3DXSHADER_DEBUG, // debug compile &amp;shader, &amp;errorBuffer, &amp;TransformConstantTable); // output any error messages if( errorBuffer ) { ::MessageBox(0, (char*)errorBuffer-&gt;GetBufferPointer(), 0, 0); d3d::Release&lt;ID3DXBuffer*&gt;(errorBuffer); } if (FAILED (hr)) { ::MessageBox(0, &quot;D3DXCreateEffectFromFile() - FAILED&quot;, 0, 0); return false; } 16.3 å˜é‡ç±»å‹ æ³¨æ„ï¼šé™¤äº†ä¸‹åˆ—å„å°èŠ‚ä¸­æè¿°çš„ç±»å‹å¤–ï¼ŒHLSLè¿˜æœ‰ä¸€äº›å†…å»ºçš„å¯¹è±¡ç±»å‹ï¼ˆå¦‚ï¼šçº¹ç†å¯¹è±¡ï¼‰ã€‚ä½†æ˜¯ï¼Œç”±äºè¿™äº›å¯¹è±¡ç±»å‹ä¸»è¦ç”¨äºæ•ˆæœæ¡†æ¶ï¼Œæˆ‘ä»¬å°†å¯¹å…¶å»¶è¿Ÿåˆ°ç¬¬19ç« è®¨è®ºã€‚ 16.3.1 æ•°å€¼ç±»å‹HLSLæ”¯æŒä¸‹åˆ—æ•°å€¼ç±»å‹ï¼ˆscalar typeï¼‰ï¼š boolâ€”True or false value. Note that HLSL provides the true and false keywords. intâ€”32-bit signed integer halfâ€”16-bit floating-point number floatâ€”32-bit floating-point number doubleâ€”64-bit floating-point number æ³¨æ„ï¼šä¸€äº›å¹³å°ä¸æ”¯æŒint, half, and doubleç±»å‹ï¼Œè¿™æ—¶æˆ‘ä»¬ä½¿ç”¨ floatç±»å‹æ¨¡æ‹Ÿã€‚ 16.3.2 å‘é‡ç±»å‹HLSLæœ‰ä¸‹åˆ—å†…å»ºçš„å‘é‡ç±»å‹ï¼ˆvector typeï¼‰ï¼š vectorâ€”â€”å„åˆ†é‡ä¸ºfloatç±»å‹çš„4Då‘é‡ vectorâ€”â€”ä¸€ä¸ªnç»´å‘é‡ï¼Œå…¶æ¯ä¸ªåˆ†é‡éƒ½ä¸ºTç±»å‹ã€‚nç»´å¿…é¡»åœ¨1åˆ°4ä¹‹é—´ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ª2D doubleå‘é‡çš„ä¾‹å­ï¼švector vec2; æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°ç»„ä¸‹æ ‡çš„è¯­æ³•è®¿é—®å‘é‡çš„ä¸€ä¸ªåˆ†é‡ã€‚ä¾‹å¦‚ï¼Œè¦è®¾ç½®å‘é‡vecçš„ç¬¬iä¸ªåˆ†é‡ï¼Œæˆ‘ä»¬å¯ä»¥å†™æˆï¼švec[i] = 2.0f; æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥åƒè®¿é—®ç»“æ„çš„æˆå‘˜ä¸€æ ·è®¿é—®å‘é‡vecçš„ä¸€ä¸ªåˆ†é‡ï¼Œä½¿ç”¨å·²å®šä¹‰çš„åˆ†é‡åxï¼Œyï¼Œzï¼Œwï¼Œrï¼Œgï¼Œbå’Œaã€‚vec.x = vec.r = 1.0f;vec.y = vec.g = 2.0f;vec.z = vec.b = 3.0f; vec.w = vec.a = 4.0f; åç§°ä¸ºrï¼Œgï¼Œbå’Œaçš„åˆ†é‡åˆ†åˆ«å¯¹åº”xï¼Œyï¼Œzå’Œwçš„åˆ†é‡ã€‚å½“ä½¿ç”¨å‘é‡æ¥è¡¨ç¤ºé¢œè‰²æ—¶ï¼ŒRGBAç¬¦å·æ˜¯æ›´é€‚åˆçš„ï¼Œå› ä¸ºå®ƒåŠ å¼ºäº†å‘é‡æ‰€è¡¨ç¤ºçš„é¢œè‰²ã€‚ ä½œä¸ºé€‰æ‹©ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶å®ƒä¸€äº›é¢„å®šä¹‰ç±»å‹ï¼Œåˆ†åˆ«ç”¨æ¥ä»£è¡¨2Dï¼Œ3Då’Œ4Då‘é‡çš„ç±»å‹ï¼šfloat2 vec2;float3 vec3;float4 vec4; è€ƒè™‘å‘é‡u = (ux, uy, uz, uw)ï¼Œå‡è®¾æˆ‘ä»¬è¦æ‹·è´uçš„æ‰€æœ‰åˆ†é‡åˆ°ä¸€ä¸ªåƒv = (ux, uy, uy, uw)è¿™æ ·çš„å‘é‡vã€‚æœ€ç›´æ¥çš„æ–¹æ³•å¯èƒ½æ˜¯é€ä¸ªä»uå¾€væ‹·è´æ¯ä¸ªåˆ†é‡ã€‚ä½†ä¸ç®¡æ€æ ·ï¼ŒHLSLæä¾›äº†ä¸€ç§ç‰¹æ®Šçš„è¯­æ³•åšè¿™äº›æ— åºçš„æ‹·è´ï¼Œå®ƒå«åšâ€œé¸¡å°¾é…’â€ï¼ˆswizzlesï¼‰ï¼švector u = {l.0f, 2.0f, 3.0f, 4.0f};vector v = {0.0f, 0.0f, 5.0f, 6.0f};v = u.xyyw; // v = {1.0f, 2.0f, 2.0f, 4.0f} æ‹·è´æ•°ç»„æ—¶ï¼Œæˆ‘ä»¬ä¸å¿…æ‹·è´æ¯ä¸ªåˆ†é‡ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä»…æ‹·è´xå’Œyåˆ†é‡ï¼Œä»£ç æ®µä¸¾ä¾‹å¦‚ä¸‹ï¼švector u = {1.0f, 2.0f, 3.0f, 4.0f};vector v = {0.0f, 0.0f, 5.0f, 6.0f};v.xy = u; // v = {l.0f, 2.0f, 5.0f, 6.0f} 16.3.3 çŸ©é˜µç±»å‹HLSLæœ‰ä¸‹åˆ—å†…å»ºçŸ©é˜µç±»å‹ï¼š matrixâ€”â€”ä¸€ä¸ª4Ã—4çŸ©é˜µï¼Œå…¶å„é¡¹ç±»å‹ä¸ºfloat matrixâ€”â€”ä¸€ä¸ªmÃ—nçŸ©é˜µï¼Œå…¶æ¯ä¸ªæˆå‘˜ä¸ºç±»å‹Tã€‚çŸ©é˜µç»´æ•°må’Œnå¿…é¡»åœ¨1è‡³4ä¹‹é—´ã€‚ è¿™é‡Œæ˜¯ä¸€ä¸ª2Ã—2æ•´å‹çŸ©é˜µçš„ä¾‹å­ï¼šmatrix m2x2; ä½œä¸ºé€‰æ‹©ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªmÃ—nçŸ©é˜µï¼Œå…¶må’Œnåœ¨1è‡³4ä¹‹é—´ï¼Œä½¿ç”¨ä¸‹åˆ—è¯­æ³•ï¼šfloatmxn matmxn;å®ä¾‹ï¼šfloat2x2 mat2x2;float3x3 mat3x3;float4x4 mat4x4;float2x4 mat2x4;æ³¨æ„ï¼šç±»å‹ä¸å¿…æ˜¯floatç±»å‹â€”â€”æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶å®ƒç±»å‹ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ•´å‹ï¼Œå†™æˆè¿™æ ·ï¼šint2x2 i2x2;int2x2 i3x3;int2x2 i2x4; æˆ‘ä»¬å¯ä»¥ç”¨äºŒç»´æ•°ç»„çš„ä¸‹æ ‡è¯­æ³•è®¿é—®çŸ©é˜µä¸­çš„é¡¹ã€‚ä¾‹å¦‚ï¼Œè¦è®¾ç½®çŸ©é˜µMçš„ç¬¬iï¼Œjä¸ªé¡¹ï¼Œæˆ‘ä»¬å¯ä»¥å†™æˆï¼šM[i] [j] = value; æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥åƒè®¿é—®ç»“æ„çš„æˆå‘˜é‚£æ ·è®¿é—®çŸ©é˜µMçš„é¡¹ã€‚ä¸‹åˆ—æ¡ç›®å·²å®šä¹‰ï¼šä»¥1ä¸ºåŸºæ•°çš„ï¼šM._11 = M._12 = M._13 = M._14 = 0.0f;M._21 = M._22 = M._23 = M._24 = 0.0f;M._31 = M._32 = M._33 = M._34 = 0.0f;M._41 = M._42 = M._43 = M._44 = 0.0f; ä»¥0ä¸ºåŸºæ•°çš„ï¼šM._m00 = M._m01 = M._m02 = M._m03 = 0.0f;M._m10 = M._m11 = M._m12 = M._m13 = 0.0f;M._m20 = M._m21 = M._m22 = M._m23 = 0.0f;M._m30 = M._m31 = M._m32 = M._m33 = 0.0f; æœ‰æ—¶ï¼Œæˆ‘ä»¬æƒ³è¦è®¿é—®çŸ©é˜µä¸­ä¸€ä¸ªç‰¹å®šçš„è¡Œã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ç»´æ•°ç»„çš„ä¸‹æ ‡è¯­æ³•æ¥åšã€‚ä¾‹å¦‚ï¼Œè¦å¼•ç”¨çŸ©é˜µMä¸­ç¬¬iè¡Œçš„å‘é‡ï¼Œæˆ‘ä»¬å¯ä»¥å†™ï¼švector ithRow = M[i]; // get the ith row vector in M æ³¨æ„ï¼šå¯ä»¥ä½¿ç”¨ä¸¤ç§è¯­æ³•åœ¨HLSLä¸­åˆå§‹åŒ–å˜é‡ï¼švector u = {0.6f, 0.3f, 1.0f, 1.0f};vector v = {1.0f, 5.0f, 0.2f, 1.0f}; ä¹Ÿå¯ä»¥ï¼Œç­‰ä»·çš„ï¼Œä½¿ç”¨æ„é€ é£æ ¼çš„è¯­æ³•ï¼švector u = vector(0.6f, 0.3f, 1.0f, 1.0f);vector v = vector(1.0f, 5.0f, 0.2f, 1.0f); å…¶å®ƒä¸€äº›ä¾‹å­:float2x2 f2x2 = float2x2(1.0f, 2.0f, 3.0f, 4.0f);int2x2 m = {1, 2, 3, 4};int n = int(5);int a = {5};float3 x = float3(0, 0, 0); 16.3.4 æ•°ç»„æˆ‘ä»¬å¯ä»¥ç”¨ç±»ä¼¼C++çš„è¯­æ³•å£°æ˜ç‰¹å®šç±»å‹çš„ä¸€ä¸ªæ•°ç»„ã€‚ä¾‹å¦‚ï¼šfloat M[4][4];half p[4];vector v[12]; 16.3.5 ç»“æ„ç»“æ„çš„å®šä¹‰å’Œåœ¨C++é‡Œä¸€æ ·ã€‚ä½†æ˜¯ï¼ŒHLSLé‡Œçš„ç»“æ„ä¸èƒ½æœ‰æˆå‘˜å‡½æ•°ã€‚è¿™æ˜¯ä¸€ä¸ªHLSLé‡Œçš„ç»“æ„çš„ä¾‹å­ï¼šstruct MyStruct{ matrix T; vector n; float f; int x; bool b;};MyStruct s; // instantiates.f = 5.0f; // member access 16.3.6 typedefå…³é”®å­— HLSLçš„typedefå…³é”®å­—åŠŸèƒ½å’ŒC++é‡Œçš„å®Œå…¨ä¸€æ ·ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ç±»å‹vectorç”¨ä¸‹é¢çš„è¯­æ³•å‘½åï¼štypedef vector point;ç„¶åï¼Œä¸ç”¨å†™æˆï¼švector myPoint;â€¦â€¦æˆ‘ä»¬åªéœ€è¿™æ ·å†™ï¼špoint myPoint; è¿™é‡Œæ˜¯å¦å¤–ä¸¤ä¸ªä¾‹å­ï¼Œå®ƒå±•ç¤ºäº†å¦‚ä½•å¯¹å¸¸é‡å’Œæ•°ç»„ç±»å‹ä½¿ç”¨typedefå…³é”®å­—ï¼štypedef const float CFLOAT;typedef float point2[2]; 1.3.7 å˜é‡å‰ç¼€ä¸‹åˆ—å…³é”®å­—å¯ä»¥åšå˜é‡å£°æ˜çš„å‰ç¼€ï¼š staticâ€”â€”å¦‚æœå¸¦staticå…³é”®å­—å‰ç¼€ï¼Œé‚£å®ƒæ˜¯å…¨å±€å˜é‡ã€‚å°±è¡¨ç¤ºå®ƒä¸æ˜¯æš´éœ²äºç€è‰²å™¨ä¹‹å¤–çš„ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒæ˜¯ç€è‰²å™¨å±€éƒ¨çš„ã€‚å¦‚æœä¸€ä¸ªå±€éƒ¨å˜é‡ä»¥staticå…³é”®å­—ä¸ºå‰ç¼€ï¼Œå®ƒå°±å’ŒC++ä¸­staticå±€éƒ¨å˜é‡æœ‰ç›¸åŒçš„è¡Œä¸ºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥å˜é‡åœ¨å‡½æ•°é¦–æ¬¡æ‰§è¡Œæ—¶è¢«ä¸€æ¬¡æ€§åˆå§‹åŒ–ï¼Œç„¶ååœ¨æ‰€æœ‰å‡½æ•°è°ƒç”¨ä¸­ç»´æŒå…¶å€¼ã€‚å¦‚æœå˜é‡æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œå®ƒå°±è‡ªåŠ¨åˆå§‹åŒ–ä¸º0ã€‚static int x = 5; uniformâ€”â€”å¦‚æœå˜é‡ä»¥uniformå…³é”®å­—ä¸ºå‰ç¼€ï¼Œå°±æ„å‘³ç€æ­¤å˜é‡åœ¨ç€è‰²å™¨å¤–é¢è¢«åˆå§‹åŒ–ï¼Œæ¯”å¦‚è¢«C++åº”ç”¨ç¨‹åºåˆå§‹åŒ–ï¼Œç„¶åå†è¾“å…¥è¿›ç€è‰²å™¨ã€‚ externâ€”â€”å¦‚æœå˜é‡ä»¥externå…³é”®å­—ä¸ºå‰ç¼€ï¼Œå°±æ„å‘³ç€è¯¥å˜é‡å¯åœ¨ç€è‰²å™¨å¤–è¢«è®¿é—®ï¼Œæ¯”å¦‚è¢«C++åº”ç”¨ç¨‹åºã€‚ä»…å…¨å±€å˜é‡å¯ä»¥ä»¥externå…³é”®å­—ä¸ºå‰ç¼€ã€‚ä¸æ˜¯staticçš„å…¨å±€å˜é‡é»˜è®¤å°±æ˜¯externã€‚ sharedâ€”â€”å¦‚æœå˜é‡ä»¥sharedå…³é”®å­—ä¸ºå‰ç¼€ï¼Œå°±æç¤ºæ•ˆæœæ¡†æ¶ï¼ˆå‚è§19ç« ï¼‰ï¼šå˜é‡å°†åœ¨å¤šä¸ªæ•ˆæœé—´è¢«å…±äº«ã€‚ä»…å…¨å±€å˜é‡å¯ä»¥ä»¥sharedä¸ºå‰ç¼€ã€‚ volatileâ€”â€”å¦‚æœå˜é‡ä»¥volatileå…³é”®å­—ä¸ºå‰ç¼€ï¼Œå°±æç¤ºæ•ˆæœæ¡†æ¶ï¼ˆå‚è§19ç« ï¼‰ï¼šå˜é‡å°†è¢«æ—¶å¸¸ä¿®æ”¹ã€‚ä»…å…¨å±€å˜é‡å¯ä»¥ä»¥volatileä¸ºå‰ç¼€ã€‚ constâ€”â€”HLSLä¸­çš„constå…³é”®å­—å’ŒC++é‡Œçš„æ„æ€ä¸€æ ·ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå˜é‡ä»¥constä¸ºå‰ç¼€ï¼Œé‚£æ­¤å˜é‡å°±æ˜¯å¸¸é‡ï¼Œå¹¶ä¸”ä¸èƒ½è¢«æ”¹å˜ã€‚const float pi = 3.14f;16.4å…³é”®å­—ã€è¯­å¥å’Œå¼ºåˆ¶è½¬æ¢16.4.1 å…³é”®å­—ä¸ºä¾¿äºå‚è€ƒï¼Œè¿™é‡Œç»™å‡ºä¸€ä¸ªHLSLå®šä¹‰çš„å…³é”®å­—åˆ—è¡¨ï¼šasm bool compile const decl dodouble else extern false float forhalf if in inline inout intmatrix out pass pixelshader return samplershared static string struct technique texturetrue typedef uniform vector vertexshader voidvolatile while ä¸‹é¢çš„é›†åˆæ˜¾ç¤ºäº†è¢«ä¿ç•™å¹¶ä¸”æœªä½¿ç”¨ä½†æ˜¯å°†æ¥å¯èƒ½æˆä¸ºå…³é”®å­—çš„æ ‡è¯†ç¬¦ï¼šauto break case catch char classconst_cast continue default delete dynamic cast enumexplicit friend goto long mutable namespacenew operator private protected public registerreinterpret_cast short signed sizeof static_cast switchtemplate this throw try typename unionunsigned using virtual 16.4.2 åŸºæœ¬ç¨‹åºæµç¨‹HLSLæ”¯æŒå¾ˆå¤šä¸C++ç›¸ä¼¼çš„é€‰æ‹©ã€é‡å¤ã€å’Œä¸€èˆ¬ç¨‹åºæµç¨‹è¯­å¥ã€‚è¿™äº›è¯­å¥çš„è¯­æ³•å’ŒC++æä¸ºç›¸ä¼¼ã€‚returnè¯­å¥ï¼šreturn (expression);ifå’Œifâ€¦elseè¯­å¥ï¼šif( condition ){ statement(s);} if( condition ){ statement(s);}else{ statement(s);} forè¯­å¥ï¼šfor(initial; condition; increment){ statement(s);} whileè¯­å¥ï¼šwhile( condition ){ statement(s);} doâ€¦whileè¯­å¥ï¼šdo{ statement(s);}while( condition ); 16.4.3 å¼ºåˆ¶è½¬æ¢ï¼ˆcastingï¼‰ HLSLæ”¯æŒä¸€ç§éå¸¸è‡ªç”±çš„å¼ºåˆ¶è½¬æ¢è®¾è®¡ã€‚HLSLä¸­å¼ºåˆ¶è½¬æ¢çš„è¯­æ³•å’ŒCç¨‹åºè¯­è¨€ä¸­çš„ä¸€æ ·ã€‚ä¾‹å¦‚è¦æŠŠfloatè½¬æ¢åˆ°matrixï¼Œæˆ‘ä»¬å†™ï¼šfloat f = 5.0f;matrix m = (matrix)f; ä»æœ¬ä¹¦çš„ä¾‹å­ä¸­ï¼Œä½ å°±èƒ½æ¨æ–­å‡ºè¿™ä¸ªè½¬æ¢è¯­æ³•çš„æ„æ€ã€‚ä½†æ˜¯ï¼Œå¦‚æœæƒ³è¦å¾—åˆ°æ›´è¯¦ç»†çš„å—æ”¯æŒçš„è½¬æ¢çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆåœ¨DirectX SDKé‡Œï¼ŒContentï¼ˆå†…å®¹ï¼‰æ ‡ç­¾é¡µä¸‹ï¼Œçœ‹DirectX Graphics\Reference\Shader Reference\High Level Shading Language\Typeå°±å¯ä»¥äº†ã€‚ 16.5 æ“ä½œç¬¦ HLSLæ”¯æŒå¾ˆå¤šç±»ä¼¼C++çš„æ“ä½œç¬¦ã€‚é™¤äº†å¾ˆå°‘ä¸€äº›åº•ä¸‹æ³¨é‡Šçš„ä¾‹å¤–ä»¥å¤–ï¼Œä»–ä»¬çš„ç”¨æ³•å’ŒC++é‡Œçš„å®Œå…¨ä¸€æ ·ã€‚ä¸‹è¡¨åˆ—å‡ºäº†HLSLçš„æ“ä½œç¬¦ï¼š[]?&gt;&lt;&lt; = =! == =!&amp;&amp;??:+ =- = =//=%%= + +=()â€˜ è™½ç„¶æ“ä½œç¬¦çš„è¡Œä¸ºå’ŒC++å¾ˆç›¸ä¼¼ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›å·®å¼‚ã€‚ç¬¬ä¸€ï¼Œæ±‚æ¨¡%è¿ç®—ç¬¦å¯¹æ•´å‹å’Œæµ®ç‚¹å‹éƒ½èµ·ä½œç”¨ã€‚ä¸ºäº†ä½¿ç”¨æ±‚æ¨¡æ“ä½œç¬¦ï¼Œå·¦è¾¹çš„å€¼å’Œå³è¾¹çš„å€¼éƒ½å¿…é¡»æœ‰ç›¸åŒçš„æ­£è´Ÿå·ï¼ˆå¦‚ï¼šå·¦è¾¹å’Œå³è¾¹å¿…é¡»éƒ½æ˜¯æ­£æˆ–è€…è´Ÿï¼‰ã€‚ ç¬¬äºŒï¼Œè¦æ³¨æ„HLSLæ“ä½œæ˜¯ä»¥æ¯ä¸ªåˆ†é‡ä¸ºåŸºç¡€çš„ã€‚è¿™æ˜¯ç”±äºå®é™…ä¸Šå‘é‡å’ŒçŸ©é˜µæ˜¯è¯­è¨€å†…å»ºçš„ï¼Œå¹¶ä¸”è¿™äº›ç±»å‹æ˜¯ç”±è‹¥å¹²ä¸ªåˆ†é‡ç»„æˆã€‚é€šè¿‡å°†è¿™äº›æ“ä½œæ–½åŠ åœ¨åˆ†é‡çº§åˆ«ä¹‹ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥åƒä½¿ç”¨æ•°å€¼ç±»å‹ä¸€æ ·å®Œæˆè¯¸å¦‚å‘é‡/çŸ©é˜µçš„åŠ æ³•ï¼Œå‡æ³•å’Œç›¸ç­‰æµ‹è¯•è¿™äº›æ“ä½œï¼ˆï¼‰ï¼Œè§ä¸‹ä¾‹ï¼š æ³¨æ„ï¼šæ“ä½œç¬¦çš„è¡Œä¸ºæ­£å¦‚å¯¹æ•°å€¼æ“ä½œä¸€æ ·ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼ŒæŒ‰ä¸€èˆ¬C++çš„æ–¹å¼ï¼‰ã€‚vector u = {1.0f, 0.0f, -3.0f, 1.0f};vector v = {-4.0f, 2.0f, 1.0f, 0.0f};// adds corresponding componentsvector sum = u + v; // sum = (-3.0f, 2.0f, -2.0f, 1.0f) å¢é‡ä¸€ä¸ªå‘é‡å°±æ˜¯å¢é‡å…¶æ¯ä¸ªåˆ†é‡ï¼š// before increment: sum = (-3.0f, 2.0f, -2.0f, 1.0f)sum++; // after increment: sum = (-2.0f, 3.0f, -1.0f, 2.0f) å‘é‡ç›¸ä¹˜ä¹Ÿæ˜¯æŒ‰åˆ†é‡çš„ï¼švector u = {1.0f, 0.0f, -3.0f, 1.0f};vector v = {-4.0f, 2.0f, 1.0f, 0.0f}; // multiply corresponding componentsvector sum = u * v; // product = (-4.0f, 0.0f, -3.0f, 0.0f) æ¯”è¾ƒæ“ä½œä¹Ÿæ˜¯æŒ‰åˆ†é‡è¿›è¡Œçš„ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªæ¯ä¸ªåˆ†é‡éƒ½ä¸ºboolç±»å‹çš„å‘é‡æˆ–è€…æ•°ç»„ã€‚ä½œä¸ºç»“æœçš„â€œboolâ€å‘é‡åŒ…å«äº†æ¯ä¸ªåˆ†é‡æ¯”è¾ƒçš„ç»“æœã€‚ä¾‹å¦‚ï¼švector u = { 1.0f, 0.0f, -3.0f, 1.0f};vector v = {-4.0f, 0.0f, 1.0f, 1.0f};vector b = (u == v); // b = (false, true, false, true) æœ€åï¼Œæˆ‘ä»¬ä»¥è®¨è®ºäºŒå…ƒæ“ä½œçš„å˜é‡æå‡ï¼ˆpromotionï¼‰ä½œä¸ºç»“æŸï¼š å¯¹äºäºŒå…ƒæ“ä½œï¼Œå¦‚æœï¼ˆæ“ä½œç¬¦çš„ï¼‰å·¦è¾¹å’Œå³è¾¹ç»´æ•°ä¸åŒï¼Œåˆ™ç»´æ•°è¾ƒå°‘çš„ä¸€è¾¹æå‡ï¼ˆå¼ºåˆ¶è½¬æ¢ï¼‰åˆ°å…·æœ‰å’Œç»´æ•°è¾ƒå¤§çš„ä¸€è¾¹ç›¸åŒçš„ç»´æ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœxçš„ç±»å‹ä¸ºfloatï¼Œè€Œyçš„ç±»å‹ä¸ºfloat3ï¼Œåœ¨è¡¨è¾¾å¼(x + y)ä¸­å˜é‡xè¢«æå‡åˆ°float3ï¼Œå¹¶ä¸”è®¡ç®—å‡ºæ¥çš„è¡¨è¾¾å¼çš„å€¼çš„ç±»å‹ä¹Ÿä¸ºfloat3ã€‚æå‡ä½¿ç”¨å·²å®šä¹‰çš„è½¬æ¢å®Œæˆã€‚æ³¨æ„ï¼Œè‹¥è½¬æ¢æœªå®šä¹‰åˆ™æå‡ä¹Ÿæ˜¯æœªå®šä¹‰çš„ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¸èƒ½è½¬æ¢float2åˆ°float3ï¼Œå› ä¸ºæ²¡æœ‰å®šä¹‰è¿™ä¸ªè½¬æ¢ã€‚ å¯¹äºäºŒå…ƒæ“ä½œï¼Œå¦‚æœå·¦è¾¹å’Œå³è¾¹ç±»å‹ä¸åŒï¼Œé‚£ä¹ˆè¾ƒä½ç²¾åº¦çš„ç±»å‹ï¼ˆthe lower type resolutionï¼‰è¢«æå‡ï¼ˆå¼ºåˆ¶è½¬æ¢ï¼‰åˆ°å…·æœ‰åŒç±»å‹çš„è¾ƒé«˜ç²¾åº¦çš„ç±»å‹ï¼ˆthe higher type resolutionï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœxç±»å‹ä¸ºintï¼Œyç±»å‹ä¸ºhalfï¼Œåˆ™è¡¨è¾¾å¼(x + y)ä¸­çš„å˜é‡xè¢«æå‡åˆ°halfï¼Œå¹¶ä¸”è®¡ç®—å‡ºæ¥çš„è¡¨è¾¾å¼çš„å€¼çš„ç±»å‹ä¹Ÿä¸ºhalfã€‚ 16.6 ç”¨æˆ·å®šä¹‰å‡½æ•°HLSLä¸­çš„å‡½æ•°æœ‰ä¸‹ä¾‹å±æ€§ï¼š å‡½æ•°ä½¿ç”¨ç±»ä¼¼C++çš„è¯­æ³• å‚æ•°æ€»æ˜¯æŒ‰å€¼ä¼ é€’ é€’å½’ä¸è¢«æ”¯æŒ å‡½æ•°æ€»æ˜¯inlineçš„ æ­¤å¤–ï¼Œå‡½æ•°è¿˜åŠ ä¸Šäº†ä¸€äº›ç”¨äºå…¶ä¸Šçš„é¢å¤–çš„å…³é”®å­—ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªå†™åœ¨HLSLä¸­çš„ä¸‹é¢è¿™ä¸ªå‡½æ•°ï¼šbool foo(in const bool b, // input bool out int r1, // output int inout float r2) // input/output float{ if( b ) // test input value { r1 = 5; // output a value through r1 } else { r1 = 1; // output a value through r1 } // since r2 is inout we can use it as an input // value and also output a value through it r2 = r2 * r2 * r2; return true; } å‡½æ•°å‡ ä¹å’ŒC++å‡½æ•°æ˜¯ä¸€æ ·çš„ï¼Œé™¤äº†inï¼Œoutå’Œinoutå…³é”®å­—ï¼š inâ€”â€”æŒ‡å®šå‹å‚ï¼ˆargumentï¼Œç‰¹æŒ‡ä¼ é€’ç»™å®å‚çš„å˜é‡ï¼‰åº”è¯¥åœ¨å‡½æ•°å¼€å§‹å‰è¢«æ‹·è´ç»™å®å‚ã€‚ä¼ å…¥å‚æ•°ä¸å¿…å¼ºåˆ¶æŒ‡å®šï¼Œå› ä¸ºå®å‚é»˜è®¤æ˜¯inçš„ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢ä¸¤æ®µæ˜¯ç­‰ä»·çš„ï¼šfloat square(in float x){ return x * x;} ä¹Ÿå¯ä»¥ä¸å¼ºåˆ¶æŒ‡å®šinï¼šfloat square(float x){ return x * x;} outâ€”â€”æŒ‡å®šå®å‚åº”è¯¥åœ¨å‡½æ•°è¿”å›æ—¶è¢«æ‹·è´ç»™å‹å‚ã€‚è¿™æ ·å¯ä»¥é€šè¿‡å‚æ•°è¿”å›å€¼ã€‚outå…³é”®å­—æ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºHLSLä¸å…è®¸ä¼ é€’ä¸€ä¸ªå¼•ç”¨æˆ–ä¸€ä¸ªæŒ‡é’ˆã€‚æˆ‘ä»¬è¦æ³¨æ„ï¼šå¦‚æœå®å‚æ ‡è®°ä¸ºoutï¼Œåœ¨å‡½æ•°å¼€å§‹å‰ï¼Œå‹å‚å°±ä¸æ‹·è´ç»™å®å‚ã€‚æ¢å¥è¯è¯´ï¼Œoutå®å‚ä»…å¯ä»¥è¢«ç”¨äºè¾“å‡ºæ•°æ®â€”â€”å®ƒä¸èƒ½ç”¨äºè¾“å…¥ã€‚void square(in float x, out float y){ y = x * x;}è¿™é‡Œï¼Œæˆ‘ä»¬è¾“å…¥äº†è¦è¢«ä¹˜æ–¹çš„æ•°xï¼Œå¹¶ä¸”é€šè¿‡å‚æ•°yè¿”å›äº†xçš„ä¹˜æ–¹ã€‚ inoutâ€”â€”è¿™æ˜¯ä¸€ä¸ªæŒ‡ç¤ºå®å‚æ—¢ç”¨äºè¾“å…¥åˆç”¨äºè¾“å‡ºçš„å¿«æ·æ–¹æ³•ã€‚å¦‚æœè¦ä½¿ç”¨å®å‚åŒæ—¶ç”¨ä½œè¾“å…¥å’Œè¾“å‡ºï¼Œå°±æŒ‡å®šinoutã€‚void square(inout float x){ x = x * x;}è¿™é‡Œï¼Œæˆ‘ä»¬è¾“å…¥äº†è¦è¢«ä¹˜æ–¹çš„æ•°xï¼ŒåŒæ—¶åˆé€šè¿‡xè¿”å›äº†çš„xçš„ä¹˜æ–¹ã€‚ 16.7å†…å»ºå‡½æ•° HLSLæœ‰ä¸€ä¸ªä¸°å¯Œçš„å†…å»ºå‡½æ•°çš„é›†åˆï¼Œå®ƒä»¬å¯¹3Då›¾å½¢æ¥è¯´éå¸¸æœ‰ç”¨ã€‚ä¸‹è¡¨æ˜¯ä¸€ä¸ªåˆ å‡äº†çš„åˆ—è¡¨ã€‚åœ¨ä¸‹ä¸¤ç« ä¸­ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨è¿™äº›å‡½æ•°ä¸­çš„ä¸€äº›è¿›è¡Œå®è·µã€‚è€Œç°åœ¨ï¼Œç†Ÿæ‚‰å®ƒä»¬å°±å¤Ÿäº†ã€‚ æ³¨æ„ï¼šè¦å¾—åˆ°æ›´å¤šçš„å‚è€ƒï¼Œå¯ä»¥å‚çœ‹DirectXæ–‡æ¡£ä¸­å†…å»ºHLSLå‡½æ•°çš„å®Œæ•´åˆ—è¡¨ï¼Œåœ¨Contenté¡µä¸‹ï¼Œç„¶ååˆ°DirectX Graphics\Reference\Shader Reference\High Level Shader Language\Intrinsic Functionsã€‚ è¯‘è€…æ³¨ï¼šä»¥ä¸‹è¡¨æ ¼ä¸­ï¼Œ////è¡¨ç¤ºå˜é‡variableçš„æ¨¡ï¼ˆä¾‹å¦‚å‘é‡çš„ç»å¯¹å€¼ï¼‰ã€‚å‡½æ•°æè¿°abs(x)è¿”å› |x|ceil(x)è¿”å› â‰¥ x çš„æœ€å°æ•´æ•°clamp(x, a, b)clamp(x, a, b)clamp(x, a, b)clamp(x, a, b)cross(u, v)è¿”å› u Ã— vï¼ˆå‰ç§¯ï¼‰degrees(x)è½¬æ¢ x ä»å¼§åº¦åˆ°è§’åº¦determinant(M)è¿”å›çŸ©é˜µMçš„è¡Œåˆ—å¼det(M)distance(u, v)è¿”å›uç‚¹å’Œvç‚¹ä¹‹é—´çš„è·ç¦»||v - u||dot(u, v)è¿”å› u Â· vï¼ˆç‚¹ç§¯ï¼‰floor(x)è¿”å› â‰¤ x çš„æœ€å¤§æ•´æ•°length(v)è¿”å› ||v||lerp(u, v, t)åœ¨uå’Œvä¹‹é—´çº¿æ€§æ’å€¼ï¼Œæ ¹æ®å‚æ•° t ? [0, 1 ]log(x)è¿”å› ln(x)log10(x)è¿”å› log10(x)log2(x)è¿”å› log2(x)max(x, y)å¦‚æœx â‰¥ yï¼Œåˆ™è¿”å› xï¼›å¦åˆ™è¿”å› ymin(x, y)å¦‚æœ x â‰¤ yï¼Œè¿”å›xï¼›å¦åˆ™è¿”å› ymul(M, N)è¿”å›çŸ©é˜µä¹˜ç§¯ MN. æ³¨æ„ï¼šçŸ©é˜µä¹˜ç§¯å¿…é¡»æ˜¯å·²å®šä¹‰çš„. å¦‚æœMæ˜¯ä¸€ä¸ªå‘é‡ï¼Œå®ƒè¢«ä½œä¸ºä¸€ä¸ªè¡Œå‘é‡ï¼Œåˆ™å‘é‡ï¼çŸ©é˜µï¼ˆvector-matrixï¼‰ä¹˜æ³•æ˜¯å·²å®šä¹‰çš„ã€‚ç±»ä¼¼çš„,å¦‚æœN æ˜¯ä¸€ä¸ªå‘é‡ï¼Œä»–è¢«ä½œä¸ºä¸€ä¸ªåˆ—å‘é‡ï¼Œåˆ™çŸ©é˜µï¼å‘é‡ï¼ˆmatrix-vectorï¼‰ä¹˜æ³•æ˜¯å·²å®šä¹‰çš„normalize(v)è¿”å› v/âˆ¥vâˆ¥pow(b, n)è¿”å› bnradians(x)è½¬æ¢ x ä» è§’åº¦ åˆ° å¼§åº¦reflect(v, n)ç»™å®šå‘é‡vå’Œè¡¨é¢æ³•çº¿nï¼Œè®¡ç®—å…¶åå°„å‘é‡refract(v,n, eta)ç»™å®šå‘é‡vã€è¡¨é¢æ³•çº¿nå’Œä¸¤ç§æè´¨çš„ä¸¤ä¸ªç´¢å¼•çš„æ¯”ç‡etaï¼Œè®¡ç®—å…¶æŠ˜å°„å‘é‡. ç¿»çœ‹ä¸€ä¸‹ç‰©ç†ä¹¦ä¸­Snellçš„è§„åˆ™æˆ–è€…åœ¨äº’è”ç½‘ä¸Šæœç´¢ä¸€ä¸‹å…³äºrefractionï¼ˆåå°„ï¼‰çš„ä¿¡æ¯rsqrt(x)è¿”å›xçš„å¹³æ–¹æ ¹çš„å€’æ•°saturate(x)è¿”å›clamp(x, 0.0, 1.0)sin(x)è¿”å›xçš„æ­£å¼¦,å…¶ä¸­xå•ä½ä¸ºå¼§åº¦è¿”å›xçš„æ­£å¼¦,å…¶ä¸­xå•ä½ä¸ºå¼§åº¦è¿”å›xçš„æ­£å¼¦å’Œä½™å¼¦ï¼Œå…¶ä¸­xå•ä½ä¸ºå¼§åº¦sqrt(x)è¿”å›xçš„å¹³æ–¹æ ¹tan(x)è¿”å›xçš„æ­£åˆ‡,å…¶ä¸­ x å•ä½ä¸ºå¼§åº¦transpose(M)è¿”å›MTçš„è½¬ç½® å¤§å¤šæ•°å‡½æ•°å·²ç»é‡è½½ä»¥ä½¿å…¶å¯ä»¥å¯¹æ‰€æœ‰å†…å»ºç±»å‹æœ‰æ„ä¹‰ã€‚ä¾‹å¦‚ï¼Œabså¯¹æ‰€æœ‰æ•°å€¼ç±»å‹æœ‰æ„ä¹‰ï¼Œæ‰€ä»¥å®ƒä¸ºæ‰€æœ‰è¿™äº›æ•°å€¼ç±»å‹è¿›è¡Œäº†é‡è½½ã€‚åˆä¾‹å¦‚ï¼Œå‰ç§¯çš„å‰ä¹˜ä»…å¯¹3Då‘é‡æœ‰æ„ä¹‰ï¼Œæ‰€ä»¥å®ƒå¯¹æ‰€æœ‰ç±»å‹çš„3Då‘é‡ï¼ˆæ¯”å¦‚ï¼šintï¼Œfloatï¼Œdoubleçš„3Då‘é‡ï¼‰è¿›è¡Œäº†é‡è½½ã€‚å¦ä¸€æ–¹é¢ï¼Œçº¿æ€§æ’å€¼â€”â€”lerpï¼Œå¯¹äºæ•°å€¼ã€2Dã€3Då’Œ4Då‘é‡æœ‰æ„ä¹‰ï¼Œå› æ­¤é‡è½½äº†è¿™äº›ç±»å‹ã€‚ æ³¨æ„ï¼šå¦‚æœä½ ä¼ é€’è¿›å»ä¸€ä¸ªéæ•°å€¼ç±»å‹åˆ°ä¸€ä¸ªï¼ˆè¦æ±‚ï¼‰æ•°å€¼ç±»å‹çš„å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªä»…èƒ½å¯¹æ•°å€¼ç±»å‹è¿›è¡Œæ“ä½œçš„å‡½æ•°ï¼ˆæ¯”å¦‚ï¼šcos(x)ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°ä¼šå¯¹ä¼ è¿›å»çš„æ¯ä¸ªåˆ†é‡è¿›è¡Œæ“ä½œã€‚ä¾‹å¦‚ï¼Œä½ å†™ï¼šfloats v = float3 (0.0f, 0.0f, 0.0f);v = cos(v); é‚£ä¹ˆå‡½æ•°å°†ä¼šå¯¹æ¯ä¸ªåˆ†é‡è¿›è¡Œæ“ä½œï¼šv=(cos(x),cos(y),cos(z))ã€‚ä¸‹ä¾‹å±•ç¤ºäº†è¿™äº›å›ºæœ‰çš„å‡½æ•°å¯èƒ½è¢«è°ƒç”¨çš„æ–¹å¼ï¼šfloat x = sin(1.0f); // sine of 1.0f radian.float y = sqrt(4.0f); // square root of 4. vector u = {1.0f, 2.0f, -3.0f, 0.0f};vector v = {3.0f, -1.0f, 0.0f, 2.0f};float s = dot(u, v); // compute dot product of u and v. float3 i = {1.0f, 0.0f, 0.0f};float3 j = {0.0f, 1.0f, 0.0f};float3 k = cross(i, j); // compute cross product of i and j. matrix M = {1.0f, 2.0f, 3.0f, 4.0f};matrix T = transpose(M); // compute transpose 16.8 æ‘˜è¦ æˆ‘ä»¬åœ¨ASCIIæ–‡æœ¬æ–‡ä»¶ä¸­ç¼–å†™äº†HLSLç¨‹åºï¼Œå¹¶ä¸”åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨D3DXCompileShaderFromFileå‡½æ•°ç¼–è¯‘äº†å®ƒä»¬ã€‚ ID3DXConstantTableæ¥å£å…è®¸æˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºä¸­å¯¹ç€è‰²å™¨ç¨‹åºä¸­çš„å˜é‡è¿›è¡Œè®¾ç½®ã€‚è¿™ç§é€šä¿¡æ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºè¢«ç€è‰²å™¨ä½¿ç”¨çš„å˜é‡å¯ä»¥æŒ‰ä¸€å¸§ä¸€å¸§çš„å˜åŒ–è€Œæ”¹å˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºä¸­çš„è§†å›¾çŸ©é˜µå‘ç”Ÿäº†æ”¹å˜ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ–°çš„è§†å›¾çŸ©é˜µæ›´æ–°ç€è‰²å™¨çš„è§†å›¾çŸ©é˜µå˜é‡ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ID3DXConstantTableå®Œæˆè¿™ç§æ›´æ–°ã€‚ å¯¹äºæ¯ä¸ªç€è‰²å™¨ï¼Œæˆ‘ä»¬å¿…é¡»å®šä¹‰ä¸€ä¸ªè¾“å…¥å’Œä¸€ä¸ªè¾“å‡ºç»“æ„ï¼Œè¿™äº›ç»“æ„åˆ†åˆ«æè¿°äº†ç€è‰²å™¨ä¸­è¾“å…¥å’Œè¾“å‡ºæ•°æ®çš„æ ¼å¼ã€‚ æ¯ä¸ªç€è‰²å™¨æœ‰ä¸€ä¸ªå…¥å£ç‚¹å‡½æ•°ï¼Œå®ƒæœ‰ä¸€ä¸ªè¾“å…¥ç»“æ„å‚æ•°ç”¨äºä¼ é€’æ•°æ®è¿›ç€è‰²å™¨ã€‚æ­¤å¤–ï¼Œæ¯ä¸ªç€è‰²å™¨è¿”å›ä¸€ä¸ªè¾“å‡ºç»“æ„çš„å®ä¾‹ï¼Œå®ƒç”¨äºä»ç€è‰²å™¨è¾“å‡ºæ•°æ®ã€‚]]></content>
      <categories>
        <category>Direct3D</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬åäº”ç«  é€‰å–(Picking)]]></title>
    <url>%2F2019%2F04%2F11%2FPicking%2F</url>
    <content type="text"><![CDATA[æ¦‚è§ˆ(OVERVIEW) å¦‚æœç”¨æˆ·ç‚¹å‡»äº†å±å¹•ä¸Šçš„ç‚¹ s = (x, y)ã€‚ ä»å›¾15.1 æˆ‘ä»¬èƒ½çœ‹åˆ°ç”¨æˆ·é€‰å–äº†èŒ¶å£¶ã€‚ æ— è®ºå¦‚ä½•ï¼Œåº”ç”¨ç¨‹åºæ— æ³•æ ¹æ®ç»™å®šçš„sç‚¹å°±ç«‹å³ç¡®å®šèŒ¶å£¶æ˜¯è¢«é€‰å–ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¿…é¡»æ‹¿å‡ºè®¡ç®—è¿™ä¸ªåŠ¨ä½œæŠ€å·§æ¥ï¼Œå«åšé€‰å–æŠ€å·§ã€‚ å›¾15.1 ç”¨æˆ·æ­£åœ¨é€‰æ‹©èŒ¶å£¶ æˆ‘ä»¬çŸ¥é“ä¸€äº›çŸ¥è¯†ï¼šå…³äºèŒ¶å£¶å’Œå®ƒçš„å…³è”ç‚¹sï¼ŒèŒ¶å£¶æŠ•å½±åœ¨å›´ç»•sç‚¹çš„åŒºåŸŸï¼Œæ›´å‡†ç¡®çš„è¯´æ˜¯ï¼šå®ƒæŠ•å½±åˆ°æŠ•å½±çª—å£ä¸Šå›´ç»•pç‚¹çš„åŒºåŸŸï¼Œä¸å®ƒå¯¹åº”çš„å±å¹•ç‚¹æ˜¯sã€‚å› ä¸ºè¿™ä¸ªé—®é¢˜ä¾èµ–äº3Dç‰©ä½“ä¸å®ƒçš„æŠ•å½±ä¹‹é—´çš„å…³ç³»ï¼Œæˆ‘ä»¬çœ‹å›¾15.2å°±å¯ä»¥äº†è§£ã€‚ å›¾15.2æ”¾å°„çº¿ç©¿è¿‡ç‚¹pç‚¹å°†ä¼šç›¸äº¤äºå›´ç»•pç‚¹æŠ•å½±çš„å¯¹è±¡ã€‚ æ³¨æ„ï¼šåœ¨æŠ•å½±çª—å£ä¸Šçš„ç‚¹ pä¸è§å±ä¸Šè¢«æŒ‰ä¸‹äº†ç‚¹sç›¸å…³è”ã€‚ å›¾15.2æˆ‘ä»¬çœ‹åˆ°å¦‚æœæˆ‘ä»¬å‘å°„ä¸€æ¡é€‰å–å°„çº¿ï¼Œä»åŸç‚¹å‘å‡ºï¼Œç»è¿‡ç‚¹pï¼Œä¼šä¸å›´ç»•pç‚¹æŠ•å½±çš„å¯¹è±¡ç›¸äº¤ï¼Œå³èŒ¶å£¶ã€‚æ‰€ä»¥ä¸€æ—¦æˆ‘ä»¬è®¡ç®—é€‰å–å°„çº¿ï¼Œæˆ‘ä»¬å¯ä»¥éä¾‹åœºæ™¯ä¸­çš„æ¯ä¸ªå¯¹è±¡å¹¶æµ‹è¯•ï¼Œçœ‹å°„çº¿æ˜¯å¦ä¸å®ƒç›¸äº¤ã€‚ä¸å°„çº¿ç›¸äº¤çš„å¯¹è±¡å³æ˜¯ç”¨æˆ·é€‰æ‹©çš„å¯¹è±¡ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ç”¨æˆ·é€‰å–çš„å¯¹è±¡æ˜¯èŒ¶å£¶ã€‚ ä¸Šé¢çš„ä¾‹å­è®²è§£äº†ç‚¹sä¸èŒ¶å£¶çš„å…³ç³»ã€‚é€šå¸¸æˆ‘ä»¬ä»»æ„ç‚¹å‡»å±å¹•ä¸Šçš„ç‚¹ï¼Œæˆ‘ä»¬éä¾‹åœºæ™¯ä¸­çš„æ¯ä¸ªå¯¹è±¡ï¼Œå¦‚æœå¯¹è±¡ä¸å°„çº¿ç›¸äº¤ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°±æ˜¯ç”¨æˆ·é€‰å–çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œå›¾15.1ä¸­ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰ç‚¹å‡»5ä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªï¼Œè€Œæ˜¯ç‚¹å‡»äº†ç™½è‰²çš„èƒŒæ™¯åŒºåŸŸï¼Œå°„çº¿å°†ä¸èƒ½ç›¸äº¤ä»»ä½•å¯¹è±¡ã€‚å› æ­¤ï¼Œç»“è®ºæ˜¯ï¼šå¦‚æœå°„çº¿æ²¡æœ‰ä¸åœºæ™¯ä¸­çš„ä»»ä½•å¯¹è±¡ç›¸äº¤ï¼Œåˆ™ç”¨æˆ·æ²¡æœ‰ç‚¹å‡»ä»»ä½•ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶å®ƒçš„æˆ‘ä»¬ä¸å…³å¿ƒã€‚ â€œé€‰å–â€é€‚ç”¨äºæ‰€æœ‰ç§ç±»çš„æ¸¸æˆå’Œ3Dç¨‹åºã€‚ä¾‹å¦‚ï¼Œç©å®¶é€šè¿‡ç”¨é¼ æ ‡ç‚¹å‡»æ¥å½±å“3Dä¸–ç•Œä¸­çš„ä¸åŒå¯¹è±¡ï¼Œç©å®¶å¯èƒ½ç‚¹å‡»å‘æ•Œäººå°„å‡»ï¼Œæˆ–ç‚¹å‡»æ‹¾å–ç‰©å“ã€‚å¥½çš„ç¨‹åºä¼šé€‚å½“åšå‡ºååº”ï¼Œç¨‹åºéœ€è¦çŸ¥é“å“ªä¸ªå¯¹è±¡è¢«é€‰å–ï¼ˆæ˜¯æ•Œäººè¿˜æ˜¯ç‰©å“ï¼‰ï¼Œå’Œåœ¨3Dç©ºé—´ä¸­çš„ä½ç½®ï¼ˆå¼€æªä¼šå‡»ä¸­å“ªï¼Ÿæˆ–ç©å®¶å°†è¦ç§»åŠ¨åˆ°å“ªå»æ‹¾å–ç‰©å“ï¼Ÿï¼‰ã€‚é€‰å–å›ç­”äº†æˆ‘ä»¬è¿™äº›é—®é¢˜ã€‚ ç›®æ ‡å­¦ä¹ å¦‚ä½•è®¡ç®—é€‰å–ç®—æ³•å¹¶äº†è§£å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»¬å°†é€‰å–åˆ†è§£æˆå››æ­¥ï¼š1) ç»™ä¸€ä¸ªå±å¹•ç‚¹sï¼Œæ‰¾å‡ºå®ƒåœ¨æŠ•å½±çª—å£ä¸Šç›¸äº¤çš„ç‚¹ï¼Œå³pã€‚2) è®¡ç®—å°„çº¿ï¼Œå®ƒæ˜¯ä»åŸç‚¹å‡ºå‘å¹¶ç»è¿‡ç‚¹pã€‚3) è½¬æ¢å°„çº¿ä¸æ¨¡å‹åˆ°åŒä¸€ç©ºé—´ã€‚4) æµ‹è¯•ä¸å°„çº¿ç›¸äº¤çš„å¯¹è±¡ï¼Œç›¸äº¤çš„å¯¹è±¡å³æ˜¯å±å¹•ä¸Šç‚¹å‡»çš„å¯¹è±¡ã€‚15.1 å±å¹•åˆ°æŠ•å½±çª—å£çš„è½¬æ¢é¦–å…ˆï¼Œè½¬æ¢å±å¹•ç‚¹åˆ°æŠ•å½±çª—å£ï¼Œè§†å£å˜æ¢çŸ©é˜µæ˜¯ï¼š æ ¹æ®å±å¹•ä¸Šçš„ç‚¹s = (sx, sy)ï¼Œé€šè¿‡è§†å£è½¬æ¢ï¼Œå¾—åˆ°åœ¨æŠ•å½±çª—å£ä¸Šçš„ç‚¹p = (px, py, pz)ï¼š å›å¿†ä¸€ä¸‹2Då›¾å½¢éƒ¨åˆ†ï¼šè§†å£è½¬æ¢åzè½´æ˜¯ä¸ç”¨ä¿å­˜çš„ï¼Œè€Œè¢«ä¿å­˜åœ¨zç¼“å­˜ä¸­ã€‚ç»™å‡ºå±å¹•ç‚¹sï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°ç‚¹pï¼Œä½¿ç”¨ä¸‹åˆ—å…¬å¼ï¼š å‡å®šè§†å£æˆå‘˜xå’Œyéƒ½æ˜¯0ï¼Œé€šå¸¸æˆ‘ä»¬èƒ½è¿›ä¸€æ­¥å¾—åˆ°ï¼š å› ä¸ºå‰é¢çš„å®šä¹‰ï¼ŒæŠ•å½±çª—å£å°±æ˜¯z=1çš„å¹³é¢ï¼Œæ‰€ä»¥pz = 1ã€‚ å¯æ˜¯æˆ‘ä»¬è¿˜ä»€ä¹ˆéƒ½æ²¡åšï¼ŒæŠ•å½±çŸ©é˜µç¼©æ”¾æŠ•å½±çª—å£ä¸Šçš„ç‚¹ï¼Œæ¥æ¨¡æ‹Ÿä¸åŒçš„è§†è§’ã€‚ä¸ºäº†è¿”å›ç¼©æ”¾å‰çš„ç‚¹å€¼ï¼Œæˆ‘ä»¬å¿…é¡»ç”¨ä¸ç¼©æ”¾ç›¸åçš„æ“ä½œæ¥è½¬æ¢ç‚¹ã€‚Pæ˜¯æŠ•å½±çŸ©é˜µï¼Œå› ä¸ºP00 å’Œ P11è½¬æ¢è·é˜µç¼©æ”¾ç‚¹çš„xå’Œyåæ ‡ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š 15.2 è®¡ç®—å°„çº¿ å›å¿†ä¸€ä¸‹ï¼Œå°„çº¿èƒ½å¤Ÿæè¿°å‚æ•°æ–¹ç¨‹ï¼šp(t) = p0 + tuã€‚å…¶ä¸­p0æ˜¯å°„çº¿çš„èµ·ç‚¹ï¼Œç”¨æ¥æè¿°å®ƒçš„ä½ç½®ï¼Œuæ˜¯å‘é‡ï¼Œç”¨æ¥æè¿°å®ƒçš„æ–¹å‘ã€‚ å¦‚å›¾15.2ï¼Œæˆ‘ä»¬çŸ¥é“å°„çº¿çš„èµ·ç‚¹æ€»æ˜¯è§†å›¾ç©ºé—´çš„åŸç‚¹ï¼Œæ‰€ä»¥p0 = (0, 0, 0)ï¼Œå¦‚æœpæ˜¯å°„çº¿ç©¿è¿‡æŠ•å½±çª—å£ä¸Šçš„ç‚¹ï¼Œæ–¹å‘å‘é‡uç»™å‡ºï¼šu = p - p0 = (px, py, 1) - (0, 0, 0) = pã€‚ ä¸‹é¢çš„æ–¹æ³•ç”¨æ¥è®¡ç®—é€‰å–å°„çº¿ï¼ˆä»å±å¹•ç©ºé—´ç‚¹å‡»çš„ç‚¹æ‰€å¯¹åº”çš„è§†å›¾ç©ºé—´çš„ç‚¹xã€yåæ ‡ï¼‰ï¼šd3d::Ray CalcPickingRay(int x, int y){ float px = 0.0f; float py = 0.0f; D3DVIEWPORT9 vp; Device-&gt;GetViewport(&amp;vp); D3DXMATRIX proj; Device-&gt;GetTransform(D3DTS_PROJECTION, &amp;proj); px = ((( 2.0f*x) / vp.Width) - 1.0f) / proj(0, 0); py = (((-2.0f*y) / vp.Height) + 1.0f) / proj(1, 1); d3d::Ray ray; ray._origin = D3DXVECTOR3(0.0f, 0.0f, 0.0f); ray._direction = D3DXVECTOR3(px, py, 1.0f); return ray; }where Ray is defined as:struct Ray{ D3DXVECTOR3 _origin; D3DXVECTOR3 _direction;}; æˆ‘ä»¬æ›´æ–°d3dUtility.hæ–‡ä»¶ï¼Œåœ¨d3då‘½åç©ºé—´ä¸­åŠ å…¥é€‰å–å°„çº¿Rayã€‚ 15.3 å˜æ¢å°„çº¿ ä¸Šä¸€èŠ‚è®²åˆ°ï¼Œé€‰å–å°„çº¿çš„è®¡ç®—è¢«æè¿°åœ¨è§†å›¾ç©ºé—´ï¼Œä¸ºäº†å®Œæˆå°„çº¿çš„ç›¸äº¤çš„æµ‹è¯•ï¼Œå°„çº¿å’Œå¯¹è±¡å¿…é¡»åœ¨åŒä¸€ä¸ªåæ ‡ç³»ç»Ÿã€‚é€šå¸¸è½¬æ¢å°„çº¿åˆ°ä¸–ç•Œç©ºé—´ï¼ˆç”šè‡³å¯¹è±¡åœ¨æœ¬åœ°ç©ºé—´ï¼‰è¦å¥½äºå°†æ‰€æœ‰å¯¹è±¡è½¬æ¢åˆ°è§†å›¾ç©ºé—´ã€‚ æˆ‘ä»¬èƒ½å¤Ÿå°†ä¸€ä¸ªå˜æ¢çŸ©é˜µè½¬æ¢ä¸ºä¸€æ¡åŸç‚¹ä¸ºp0ï¼Œæ–¹å‘ä¸ºuçš„å°„çº¿r(t) = p0 + tuï¼Œæ³¨æ„ï¼šåŸç‚¹è½¬æ¢ä¸ºä¸€ä¸ªç‚¹ï¼Œæ–¹å‘è½¬æ¢ä¸ºä¸€ä¸ªå‘é‡ï¼Œåœ¨æœ¬ç« çš„é€‰å–ä¾‹å­ä¸­ï¼Œä¸‹åˆ—å‡½æ•°è½¬æ¢ä¸€æ¡å°„çº¿ï¼švoid TransformRay(d3d::Ray ray, D3DXMATRIX T){ // transform the rayâ€™s origin, w = 1. D3DXVec3TransformCoord( &amp;ray-&gt;_origin, &amp;ray-&gt;_origin, T); // transform the ray&#39;s direction, w = 0. D3DXVec3TransformNormal( &amp;ray-&gt;_direction, &amp;ray-&gt;_direction, T); // normalize the direction D3DXVec3Normalize(&amp;ray-&gt;_direction, &amp;ray-&gt;_direction); } D3DXVec3TransformCoordå’ŒD3DXVec3TransformNormalæ¥å—ä¸€ä¸ªRayç±»å‹å‚æ•°ï¼ˆåŒ…å«äºŒä¸ª3Då‘é‡æˆå‘˜ï¼‰ã€‚ D3DXVec3TransformCoordå‡½æ•°ä¸­ï¼Œå°„çº¿çš„åŸç‚¹ï¼ˆ_originï¼‰å‘é‡çš„ç¬¬å››éƒ¨åˆ†w = 1ã€‚ç›¸åï¼Œå‡½æ•°D3DXVec3TransformNormalä¸­ï¼Œå°„çº¿çš„æ–¹å‘ï¼ˆ_directionï¼‰å‘é‡çš„ç¬¬å››éƒ¨åˆ†w = 0ã€‚ è¿™æ ·ï¼Œå½“æˆ‘ä»¬å‘ä¸–ç•Œç©ºé—´è½¬æ¢æ—¶ï¼Œèƒ½å¤Ÿç”¨D3DXVec3TransformCoordè½¬æ¢ä¸€ä¸ªç‚¹ï¼Œç”¨D3DXVec3TransformNormalè½¬æ¢ä¸€ä¸ªå‘é‡ã€‚ 15.4 å°„çº¿ï¼å¯¹è±¡ äº¤ç‚¹ æˆ‘ä»¬å°†å°„çº¿å’Œå¯¹è±¡è½¬æ¢åˆ°åŒä¸€åæ ‡ç³»ç»Ÿåï¼Œå‡†å¤‡æµ‹è¯•å“ªä¸ªå¯¹è±¡ä¸å°„çº¿ç›¸äº¤ã€‚å› ä¸ºæˆ‘ä»¬å°†å¯¹è±¡æè¿°ä¸ºä¸‰è§’å½¢ç»„æˆçš„ç½‘ç»œï¼Œä¸‹é¢è¯¦ç»†è¯´æ˜è¿™ç§æ–¹æ³•ã€‚éä¾‹åœºæ™¯ä¸­æ¯ä¸ªå¯¹è±¡çš„ä¸‰è§’å½¢åˆ—è¡¨å¹¶æµ‹è¯•ï¼Œå¦‚æœå°„çº¿ç›¸äº¤äºä¸€ä¸ªä¸‰è§’å½¢ï¼Œå®ƒå°±ä¸ä¸‰è§’å½¢æ‰€åœ¨çš„å¯¹è±¡ç›¸äº¤ã€‚ ç„¶è€Œï¼Œé€šè¿‡éä¾‹åœºæ™¯ä¸­çš„æ¯ä¸ªä¸‰è§’å½¢æ¥å®ç°å°„çº¿ç›¸äº¤åœ¨è®¡ç®—ä¸Šä¼šå¢åŠ æ—¶é—´ï¼Œä¸€ç§æ¯”è¾ƒå¿«çš„æ–¹æ³•ï¼Œè™½ç„¶å‡†ç¡®æ€§ä¼šå·®ä¸€ç‚¹ã€‚å®ƒå°†æ¯ä¸ªå¯¹è±¡å›´æˆä¸€ä¸ªè¿‘ä¼¼çš„çƒå½¢ï¼ˆè¾¹ç•Œçƒï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½é€šè¿‡éä¾‹æ¯ä¸ªè¾¹ç•Œçƒæ¥æµ‹è¯•å°„çº¿ç›¸äº¤ã€‚ç”¨è¾¹ç•Œçƒæ¥æè¿°ç›¸äº¤çš„å¯¹è±¡ã€‚ æ³¨æ„ï¼šå°„çº¿å¯èƒ½ç›¸äº¤å¤šä¸ªå¯¹è±¡ï¼Œç„¶è€Œç¦»ç…§ç›¸æœºè¿‘çš„å¯¹è±¡ä¼šè¢«é€‰å–ã€‚å› ä¸ºè¿‘è·ç¦»å¯¹è±¡é®æŒ¡äº†åé¢çš„å¯¹è±¡ã€‚ ç»™å‡ºä¸€ä¸ªè¾¹ç•Œçƒçš„åœ†å¿ƒcå’ŒåŠå¾„rï¼Œä½¿ç”¨ä¸‹åˆ—æ’ç­‰å¼èƒ½å¤Ÿæµ‹è¯•ç‚¹pæ˜¯å¦åœ¨è¾¹ç•Œçƒä¸Šï¼š ||p-c||-r = 0 å¦‚æœæ’ç­‰å¼æ»¡è¶³ï¼Œåˆ™ç‚¹påœ¨è¾¹ç•Œçƒä¸Šã€‚å¦‚å›¾15.3 å›¾15.3 å‘é‡påˆ°cçš„é•¿åº¦è¡¨ç¤ºä¸ºï¼š||p - c||ï¼Œå¦‚æœç­‰äºåŠå¾„åˆ™è¡¨ç¤ºç‚¹påœ¨è¾¹ç•Œçƒä¸Šã€‚æ³¨æ„ï¼šæˆ‘ä»¬ä½¿ç”¨è¾¹ç•Œçƒæ˜¯ä¸ºäº†æ–¹ä¾¿ï¼Œä½†è¿™å°†æ‰©å±•å‡ºä¸‰ä¸ªç§æƒ…å†µã€‚ å‡å®šå°„çº¿p(t) = p0 + tuç›¸äº¤äºè¾¹ç•Œçƒï¼Œæˆ‘ä»¬å°†å°„çº¿ä»£å…¥çƒçš„æ’ç­‰å¼ä¸­ï¼Œä½¿å‚æ•°tæ»¡è¶³äº†çƒçš„æ’ç­‰å¼ï¼Œç»™å‡ºäº†æ»¡è¶³ç›¸äº¤ç‚¹çš„å‚æ•°ã€‚ å°†å°„çº¿p(t) = p0 + tuä»£å…¥çƒçš„æ’ç­‰å¼ï¼š||p(t) - c|| - r = 0 â€”&gt; ||p0 + tu - c|| - r = 0 é€šè¿‡ä»¥ä¸Šæ¨å¯¼ï¼Œæˆ‘ä»¬å¾—åˆ°äºŒæ¬¡æ–¹ç¨‹ï¼šAt2 + Bt + C = 0 å…¶ä¸­A = u Â· u, B = 2(u Â· (p0 - c))ï¼Œè€ŒC = (p0 - c) . (p0 - c) â€“ r 2ã€‚å¦‚æœuæ˜¯æ ‡å‡†åŒ–çš„ï¼Œé‚£ä¹ˆA = 1ã€‚å› ä¸ºuæ˜¯æ ‡å‡†åŒ–çš„ï¼Œæˆ‘ä»¬è§£t0 å’Œ t1ï¼š å›¾15.4æ˜¾ç¤ºå¯èƒ½è¿”å›çš„t0 å’Œ t1ï¼Œå¹¶æ˜¾ç¤ºäº†ä¸€äº›è¿”å›å€¼çš„å‡ ä½•æ„ä¹‰ï¼š å›¾15.4 (a)å°„çº¿ä»çƒè¾¹ä¸Šæ“¦è¿‡ï¼›(b)å°„çº¿åœ¨çƒå‰ï¼›(c)å°„çº¿åœ¨çƒçš„å†…éƒ¨ï¼›(d)å°„çº¿ç›¸äº¤äºçƒï¼›(e)å°„çº¿æ˜¯çƒçš„åˆ‡çº¿ã€‚ ä¸‹åˆ—æ–¹æ³•å°„çº¿é€šè¿‡å¹¶ä¸è¾¹ç•Œçƒç›¸äº¤ï¼Œè¿”å›trueï¼›å°„çº¿é”™è¿‡è¾¹ç•Œçƒï¼Œè¿”å›falseã€‚ bool PickApp::raySphereIntersectionTest(Ray ray, BoundingSphere sphere){ D3DXVECTOR3 v = ray-&gt;_origin - sphere-&gt;_center; float b = 2.0f D3DXVec3Dot(&amp;ray-&gt;_direction, &amp;v); float c = D3DXVec3Dot(&amp;v, &amp;v) - (sphere-&gt;_radius sphere-&gt; _radius); // find the discriminant float discriminant = (b * b) - (4.0f * c); // test for imaginary number if( discriminant &lt; 0.0f ) return false; discriminant = sqrtf(discriminant); float s0 = (-b + discriminant) / 2.0f; float s1 = (-b - discriminant) / 2.0f; // if a solution is &gt;= 0, then we intersected the sphere if( s0 &gt;= 0.0f || s1 &gt;= 0.0f ) return true; return false; } å½“ç„¶ï¼Œæˆ‘ä»¬å·²ç»å‡†å¤‡äº†ä¸€ä¸ªè¾¹ç•Œçƒï¼Œä¸ºäº†ä¾¿äºç†è§£æˆ‘ä»¬å†æ¬¡æ˜¾ç¤ºå®ƒçš„å®šä¹‰ï¼šbool PickApp::raySphereIntersectionTest(Ray ray, BoundingSphere sphere){struct BoundingSphere{ BoundingSphere(); D3DXVECTOR3 _center; float _radius; }; 15.5 ä¾‹å­ç¨‹åºï¼šé€‰å–å›¾15.5æ˜¾ç¤ºäº†æœ¬ç« ä¾‹å­ç¨‹åºçš„å±å¹•æˆªå›¾ï¼ŒèŒ¶å£¶ç»•ç€å±å¹•ç§»åŠ¨ï¼Œä½ å¯ä»¥ç”¨é¼ æ ‡è¯•ç€ç‚¹å‡»å®ƒã€‚å¦‚æœä½ ç‚¹å‡»åˆ°èŒ¶å£¶çš„è¾¹ç•Œçƒä¸Šï¼Œä¸€ä¸ªæ¶ˆæ¯æ¡†å°†å¼¹å‡ºï¼Œè¡¨ç¤ºä½ ç‚¹ä¸­äº†ã€‚æˆ‘ä»¬é€šè¿‡æµ‹è¯•WM_LBUTTONDOWNæ¶ˆæ¯æ¥å¤„ç†é¼ æ ‡ç‚¹å‡»äº‹ä»¶ï¼šcase WM_LBUTTONDOWN: // compute the ray in view space given the clicked screen pointd3d::Ray ray = CalcPickingRay(LOWORD(lParam), HIWORD(lParam)); // transform the ray to world spaceD3DXMATRIX view;Device-&gt;GetTransform(D3DTS_VIEW, &amp;view); D3DXMATRIX viewInverse;D3DXMatrixInverse(&amp;viewInverse, 0, &amp;view); TransformRay(&amp;ray, &amp;viewInverse); // test for a hitif( RaySphereIntTest(&amp;ray, &amp;BSphere) ) ::MessageBox(0, â€œHit!â€, â€œHITâ€, 0); break; å›¾15.5 è¿™ç« ä¾‹å­ç¨‹åºçš„å±å¹•æˆªå›¾ 15.6 æ‘˜è¦ é€‰å–æŠ€å·§é€šè¿‡é¼ æ ‡ç‚¹å‡»ï¼Œæ¥ç¡®å®šä¸3Då¯¹è±¡å¯¹åº”çš„å±å¹•ä¸Šæ˜¾ç¤ºçš„2DæŠ•å½±å¯¹è±¡ã€‚ é€‰å–çº¿æ˜¯ä¸€ä¸ªå°„çº¿ï¼Œæºè‡ªè§†å›¾ç©ºé—´çš„åŸç‚¹ï¼Œç©¿è¿‡æŠ•å½±çª—å£ä¸Šçš„ç‚¹å…³è”åˆ°å±å¹•ä¸Šç‚¹å‡»çš„ç‚¹ã€‚ æˆ‘ä»¬èƒ½å¤Ÿå˜æ¢ä¸€ä¸ªå°„çº¿r(t) = p0 + tuï¼Œé€šè¿‡å˜æ¢åŸç‚¹p0å’Œé€šè¿‡çŸ©é˜µå˜æ¢å¾—åˆ°æ–¹å‘uã€‚æ³¨æ„ï¼šåŸç‚¹å˜æ¢è‡ªä¸€ä¸ªï¼ˆw=1ï¼‰çš„ç‚¹ï¼Œæ–¹å‘æ˜¯ï¼ˆw=0ï¼‰çš„å‘é‡ã€‚ æµ‹è¯•å°„çº¿ä¸å¯¹è±¡ç›¸äº¤ï¼Œæˆ‘ä»¬èƒ½æµ‹è¯•å°„çº¿æ˜¯å¦ç›¸äº¤äºç»„æˆå¯¹è±¡çš„ä¸‰è§’å½¢ï¼Œæˆ–æµ‹è¯•å°„çº¿æ˜¯å¦ç›¸äº¤äºå›´ç»•å¯¹è±¡çš„ä¸€ä¸ªä½“ç§¯ï¼Œæ¯”å¦‚è¾¹ç•Œçƒã€‚]]></content>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬åå››ç«  ç²’å­ç³»ç»Ÿ(Particle Systems)]]></title>
    <url>%2F2019%2F04%2F11%2FParticle-System%2F</url>
    <content type="text"><![CDATA[è®¸å¤šè‡ªç„¶ç°è±¡æ˜¯ç”±å¾ˆå¤šå°çš„å°é¢—ç²’ç»„æˆçš„ï¼Œå®ƒä»¬æœ‰ç›¸ä¼¼çš„è¡Œä¸ºã€‚ï¼ˆä¾‹å¦‚ï¼Œé›ªèŠ±è½ä¸‹ï¼Œé—ªçƒçš„ç«ç„°ï¼Œå†²å‡ºæªç®¡çš„â€œå­å¼¹â€ï¼‰ï¼Œç²’å­ç³»ç»Ÿç”¨æ¥æ¨¡æ‹Ÿè¿™ç§ç°è±¡ã€‚ç›®æ ‡ï¼š å­¦ä¹ æˆ‘ä»¬ç»™å®šçš„ç²’å­å±æ€§ï¼Œå¦‚ä½•æè¿°D3Dä¸­çš„ç²’å­ã€‚ è®¾è®¡ä¸€ä¸ªçµæ´»çš„ç²’å­åŸºç³»ç»Ÿçš„åŸºç±»ï¼ŒåŒ…æ‹¬ä¸€èˆ¬çš„ç²’å­ç³»ç»Ÿéƒ½æœ‰çš„å±æ€§å’Œæ–¹æ³•ã€‚ æ¨¡æ‹Ÿ3ä¸ªå…·ä½“çš„ç²’å­ç³»ç»Ÿï¼Œé›ªã€çˆ†ç‚¸ã€ç²’å­æªã€‚14.1 ç²’å­å’Œç‚¹ç²¾çµï¼ˆPoint Spriteï¼‰ ç²’å­æ˜¯ä¸€ä¸ªå¾ˆå°çš„å¯¹è±¡ï¼Œå®ƒé€šå¸¸ç”¨æ¥æ¨¡æ‹Ÿæ•°å­¦ä¸­çš„ä¸€ä¸ªç‚¹ã€‚ç‚¹å…ƒæ˜¯ç”¨æ¥æ˜¾ç¤ºç²’å­çš„å¾ˆå¥½çš„æ–¹æ¡ˆã€‚å¯æ˜¯ç‚¹å…ƒè¢«å…‰æ …åŒ–æˆä¸€ä¸ªç®€å•çš„åƒç´ ã€‚è¿™æ²¡ç»™æˆ‘ä»¬å¤šå°‘çµæ´»æ€§ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³æœ‰å„ç§å¤§å°ä¸åŒçš„ç²’å­ï¼Œå¹¶ä¸”æŠŠæ•´ä¸ªçº¹ç†å¹³æ»‘æ˜ å°„åˆ°è¿™äº›ç²’å­ä¸Šã€‚åœ¨Direct3D 8.0,ä»¥å‰ï¼Œå› ä¸ºç‚¹å…ƒæ–¹æ³•çš„å±€é™æ€§è€Œå®Œå…¨ä¸ä½¿ç”¨ä»–ä»¬ã€‚ä»£æ›¿çš„æ–¹æ³•æ˜¯ï¼Œç¨‹åºå‘˜å°†ä½¿ç”¨å…¬å‘Šæ¿å»æ˜¾ç¤ºç²’å­ï¼Œä¸€ä¸ªæ¿æ˜¯ä¸€ä¸ªæ–¹æ ¼ï¼Œä¸–ç•ŒçŸ©é˜µç”¨å®ƒæ¥ç¡®å®šæ–¹å‘ï¼Œä½¿å®ƒæ€»æ˜¯æœå‘ç…§ç›¸æœºã€‚ Direct3D 8.0å¼•å…¥ä¸€ä¸ªç‰¹æ®Šçš„ç‚¹å…ƒå«ç‚¹ç²¾çµï¼Œå¤šæ•°æ—¶å€™è¢«åº”ç”¨åœ¨ç²’å­ç³»ç»Ÿä¸­ã€‚ä¸ä¸€èˆ¬çš„ç‚¹å…ƒä¸åŒçš„æ˜¯ï¼Œç‚¹ç²¾çµæœ‰çº¹ç†æ˜ å°„å¹¶èƒ½æ”¹å˜å¤§å°ã€‚ä¸å…¬å‘Šæ¿ä¸åŒçš„æ˜¯ï¼Œèƒ½ç”¨ä¸€ä¸ªç®€å•çš„ç‚¹æè¿°ä¸€ä¸ªç‚¹ç²¾çµï¼ŒèŠ‚çœå†…å­˜å’Œå¤„ç†æ—¶é—´ï¼Œå› ä¸ºæˆ‘ä»¬åªæ˜¯å¿…é¡»ä¿å­˜å’Œå¤„ç†ä¸€ä¸ªç‚¹ï¼Œè€Œå…¬å‘Šæ¿åˆ™æ˜¯å››ä¸ªã€‚ 14.1.1 ç»“æ„çš„æ ¼å¼ æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„é¡¶ç‚¹ç»“æ„æ¥æè¿°ç²’å­çš„ä½ç½®å’Œé¢œè‰²ï¼šstruct Particle{ D3DXVECTOR3 _position; D3DCOLOR _color; static const DWORD FVF;};const DWORD Particle::FVF = D3DFVF_XYZ | D3DFVF_DIFFUSE; è¿™ä¸ªç»“æ„åªä¿å­˜ç²’å­çš„ä½ç½®å’Œé¢œè‰²ï¼Œè¿™å–å†³äºä½ ç¨‹åºçš„éœ€è¦ï¼Œä½ èƒ½å¤Ÿç”¨åŒæ ·çš„ç»“æ„å»ä¿å­˜ä¸€å¥—çº¹ç†åæ ‡ï¼Œæˆ‘ä»¬åœ¨ä¸‹ä¸€èŠ‚è®¨è®ºç»™ç‚¹ç²¾çµèµ‹äºˆçº¹ç†ã€‚ å¢åŠ ä¸€ä¸ªæµ®ç‚¹å˜é‡ç»™Particleç»“æ„å»æŒ‡å®šç²’å­çš„å¤§å°æ˜¯å¯èƒ½çš„ã€‚æˆ‘ä»¬å¿…é¡»å¢åŠ ä¸€ä¸ªD3DFVF_PSIZEæ ‡è®°ç»™æˆ‘ä»¬çš„çµæ´»çš„é¡¶ç‚¹æ ¼å¼ï¼Œä»¥åæ˜ è¿™ä¸ªå˜åŒ–ã€‚æ¯ä¸ªç²’å­ç»´æŠ¤è‡ªå·±çš„å¤§å°å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸æˆ‘ä»¬ä»¥å…·ä½“æƒ…å†µæŒ‡å®šå¹¶æ”¹å˜ç²’å­çš„å¤§å°ã€‚å¯æ˜¯ï¼Œå¤§å¤šæ•°çš„å›¾å½¢å¡ä¸æ”¯æŒæ§åˆ¶ç²’å­çš„å¤§å°ï¼Œå› æ­¤æˆ‘ä»¬ä¸ä½¿ç”¨å®ƒã€‚ï¼ˆæ£€æŸ¥D3DFVFCAPS_PSIZEåœ¨D3 DCAPS9ç»“æ„çš„FVFCapsæˆå‘˜ï¼‰ä»£æ›¿çš„æ–¹æ³•æ˜¯ï¼šç”¨æ¸²æŸ“çŠ¶æ€ï¼ˆrender statesï¼‰å»æ§åˆ¶ç²’å­çš„å¤§å°ï¼Œå°±åƒä½ å¾ˆå¿«çœ‹åˆ°çš„ï¼Œæœ‰å°ºå¯¸æˆå‘˜çš„é¡¶ç‚¹ç»“æ„çš„ä¾‹å­ï¼šstrict Particle{ D3DXVECTOR3 _position; D3DCOLOR _color; float _size; static const DWORD FVF;};const DWORD Particle::FVF = D3DFVF XYZ | D3DFVF DIFFUSE | D3DFVF_PSIZE; æ³¨æ„ï¼šé€šè¿‡vertex shaderï¼Œèƒ½å¤Ÿè·å–æ¯ä¸ªç²’å­çš„å¤§å°ï¼Œå³ä½¿ä½ çš„ç¡¬ä»¶ä¸æ”¯æŒD3DFVFCAPS_PSIZEã€‚Vertex shadersçš„å†…å®¹åœ¨æœ¬ä¹¦çš„ç¬¬IVéƒ¨åˆ†ã€‚ 14.1.2ç‚¹ç²¾çµï¼ˆPoint Spriteï¼‰æ¸²æŸ“çŠ¶æ€ ç‚¹ç²¾çµçš„è¡Œä¸ºå¤§éƒ¨åˆ†ç”±æ¸²æŸ“çŠ¶æ€ï¼ˆrender statesï¼‰æ¥æ§åˆ¶ï¼Œç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™äº›æ¸²æŸ“çŠ¶æ€ï¼šD3DRS_POINTSPRITEENABLEâ€”A Boolean value. The default value is false.Trueè¡¨ç¤ºå°†å½“å‰çš„çº¹ç†å…¨éƒ¨æ˜ å°„åˆ°ç‚¹ç²¾çµä¸Šã€‚False è¡¨ç¤ºç”¨æŒ‡å®šçš„çº¹ç†åæ ‡æ˜ å°„åˆ°ç‚¹ç²¾çµçš„ç‚¹ï¼ˆå›¾ç´ ï¼‰ä¸Šã€‚_device-&gt;SetRenderState(D3DRS_POINTSPRITEENABLE, true); D3DRS_POINTSCALEENABLEâ€”A Boolean value. The default value is false.Trueè¡¨ç¤ºç”¨è§†å›¾ç©ºé—´å•ä½æ¥è§£é‡Šç‚¹çš„å¤§å°ã€‚è§†å›¾ç©ºé—´å•ä½çš„3Dç©ºé—´ç‚¹åœ¨ç…§ç›¸æœºä¸­ï¼Œç‚¹ç²¾çµå°†ä¼šè‡ªåŠ¨ç¼©æ”¾ï¼Œè¿™å–å†³åˆ°å®ƒæœ‰å¤šè¿œ, åƒå…¶ä»–å¯¹è±¡ä¸€æ ·ï¼Œç¦»ç…§ç›¸æœºè¿‘çš„ç²’å­æ¯”ç¦»ç…§ç›¸æœºè¿œçš„ç²’å­è¦å°ã€‚False è¡¨ç¤ºç‚¹çš„å¤§å°å°†ç”¨å±å¹•ç©ºé—´å•ä½æ¥è§£é‡Šã€‚å±å¹•ç©ºé—´å•ä½æ˜¯å±å¹•ä¸Šçš„åƒç´ å•ä½ã€‚. å› æ­¤å¦‚æœä½ æŒ‡å®šfalse, ä¾‹å¦‚, è®¾ç½®ç‚¹ç²¾çµçš„å°ºå¯¸ä¸º3, åˆ™ç‚¹ç²¾çµåœ¨å±å¹•åŒºåŸŸä¸­çš„å°ºå¯¸ä¸º3Ã—3åƒç´ ã€‚._device-&gt;SetRenderState(D3DRS_POINTSCALEENABLE, true); D3DRS_POINTSIZEâ€”è¡¨ç¤ºç‚¹ç²¾çµçš„å°ºå¯¸. è¿™ä¸ªå€¼å¯ä»¥ä»»æ„æŒ‡å®šè§†å›¾ç©ºé—´æˆ–å±å¹•ç©ºé—´çš„ç‚¹ç²¾çµçš„å°ºå¯¸, å–å†³äºD3DRS_POINTSCALEENABLE çŠ¶æ€å¦‚ä½•è®¾ç½®. ä¸‹é¢çš„ä»£ç æ®µè®¾ç½®ç‚¹çš„å°ºå¯¸ä¸º2.5ä¸ªå•ä½ã€‚:_device-&gt;SetRenderState( D3DRS_POINTSIZE, d3d::FtoDw(2.5f) ); d3d::FtoDw æ˜¯æˆ‘ä»¬æ–°åŠ è¿› d3dUtility.h/cpp æ–‡ä»¶ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå°†floatå‹è½¬æ¢ä¸º DWORDå‹ã€‚ æˆ‘ä»¬å¿…é¡»è¿™ä¹ˆåšæ˜¯å› ä¸ºæ‰€æœ‰çš„IDirect3DDevice9::SetRenderState éƒ½è¦ä¸€ä¸ª DWORD å‹çš„å€¼è€Œä¸æ˜¯floatå‹ã€‚DWORD d3d::FtoDw(float f){ return ((DWORD)&amp;f);} D3DRS_POINTSIZE_MINâ€”è¡¨ç¤ºç‚¹ç²¾çµçš„æœ€å°å°ºå¯¸ã€‚ä¾‹å­ï¼Œå°†è®¾ç½®æœ€å°å€¼ä¸º0.2ï¼š_device-&gt;SetRenderState(D3DRS_POINTSIZE_MIN, d3d::FtoDw(0.2f)); D3DRS_POINTSIZE_MAXâ€”è¡¨ç¤ºç‚¹ç²¾çµçš„æœ€å¤§å°ºå¯¸ã€‚ä¾‹å­ï¼Œå°†è®¾ç½®æœ€å¤§å€¼ä¸º5.0:_device-&gt;SetRenderState(D3DRS_POINTSIZE_MAX, d3d::FtoDw(5.0f)); D3DRS_POINTSCALE_A, D3DRS_POINTSCALE_B, D3DRS_POINTSCALE_Câ€”è¿™3ä¸ªå¸¸é‡è¡¨ç¤ºå¦‚ä½•æ ¹æ®è·ç¦»æ§åˆ¶ç‚¹ç²¾çµçš„å°ºå¯¸â€”è¿™ä¸ªè·ç¦»æ˜¯ç‚¹ç²¾çµåˆ°ç…§ç›¸æœºçš„è·ç¦»ã€‚ D3Dç”¨ä»¥ä¸‹çš„å…¬å¼å»è®¡ç®—ç‚¹ç²¾çµçš„æœ€ç»ˆå°ºå¯¸ï¼Œè¿™å–å†³äºè·ç¦»å’Œè¿™3ä¸ªå¸¸é‡ã€‚ å…¶ä¸­ï¼šFinalSizeï¼šè·ç¦»è®¡ç®—åï¼Œç‚¹ç²¾çµçš„æœ€åå°ºå¯¸ã€‚ViewportHeightï¼šè§†å£çš„é«˜åº¦ã€‚Sizeï¼šåˆ†åˆ«ä¸ºD3DRS_POINTSCALE_A, D3DRS_POINTSCALE_B, and D3DRS_POINTSCALE_Cå€¼ã€‚Dï¼šåœ¨è§†å›¾ç©ºé—´ä¸­ç‚¹ç²¾çµä¸ç…§ç›¸æœºçš„è·ç¦»ã€‚å› ä¸ºç…§ç›¸æœºè¢«æ”¾ç½®åœ¨è§†å›¾ç©ºé—´ä¸­çš„åŸç‚¹ï¼Œè¿™ä¸ªå€¼æ˜¯ï¼šï¼Œä¹Ÿæ˜¯ç‚¹ç²¾çµæ‰€åœ¨çš„ä½ç½®ã€‚ ä¸‹é¢ä»£ç è®¾ç½®ç‚¹ç²¾çµçš„è·ç¦»å¸¸é‡ï¼Œå› æ­¤è¿œå¤„çš„ç‚¹ç²¾çµå°†å˜å°ã€‚_device-&gt;SetRenderState(D3DRS_POINTSCALE_A, d3d::FtoDw(0.0f));_device-&gt;SetRenderState(D3DRS_POINTSCALE_B, d3d::FtoDw(0.0f));_device-&gt;SetRenderState(D3DRS_POINTSCALE_C, d3d::FtoDw(1.0f)); 14.1.3 ç²’å­å’Œä»–ä»¬çš„å±æ€§ ä¸€ä¸ªç²’å­ç³»ç»Ÿæ˜¯ç”±é™¤äº†ä½ç½®ã€é¢œè‰²ä»¥å¤–çš„æ›´å¤šçš„å±æ€§ç»„æˆï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªç²’å­æœ‰æŸäº›é€Ÿåº¦ã€‚ç„¶è€Œï¼Œè¿™äº›é¢å¤–çš„å±æ€§å¯¹äºæ¸²æŸ“ç²’å­æ¥è¯´ä¸æ˜¯å¿…é¡»çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨å•ç‹¬çš„ç»“æ„ä¸­ä¿å­˜æ¸²æŸ“ç²’å­æ‰€å¿…é¡»çš„æ•°æ®å’Œå±æ€§ã€‚å½“æˆ‘ä»¬åˆ›å»ºã€æ˜¾ç¤ºæˆ–æ›´æ–°ç²’å­æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨å±æ€§æ¥å·¥ä½œã€‚å½“æˆ‘ä»¬å‡†å¤‡æ¸²æŸ“æ—¶ï¼Œæˆ‘ä»¬ä»Particleï¼ˆç²’å­ï¼‰ç»“æ„ä¸­COPYä½ç½®å’Œé¢œè‰²ã€‚ å¯¹äºæˆ‘ä»¬æ¨¡æ‹Ÿçš„å…·ä½“ç²’å­ç³»ç»Ÿï¼Œç²’å­çš„å±æ€§ä¹Ÿæ˜¯ä¸åŒçš„ã€‚å› æ­¤æˆ‘ä»¬èƒ½å¤Ÿå½’çº³ä¸€äº›é€šç”¨çš„å±æ€§ï¼Œä¸€é¢çš„ç»“æ„ä¾‹å­ä¸­åŒ…å«ä¸€äº›é€šç”¨çš„å±æ€§ï¼Œå¤§å¤šæ•°ç³»ç»Ÿç”¨ä¸ä¸Šè¿™ä¹ˆå¤šï¼Œä¸€äº›ç³»ç»Ÿéœ€è¦çš„å±æ€§è¿™é‡Œå¯èƒ½è¿˜æ²¡æœ‰ã€‚struct Attribute{ D3DXVECTOR3 _position; D3DXVECTOR3 _velocity; D3DXVECTOR3 _acceleration; float _lifeTime; float _age; D3DXCOLOR _color; D3DXCOLOR _colorFade; bool _isAlive;};_positionâ€”ç²’å­åœ¨ä¸–ç•Œç©ºé—´ä¸­çš„ä½ç½®_velocityâ€”ç²’å­çš„é€Ÿåº¦ï¼Œæ¯ç§’å¤šå°‘ä¸ªå•ä½ã€‚_accelerationâ€”ç²’å­çš„åŠ é€Ÿåº¦, æ¯ç§’å¤šå°‘ä¸ªå•ä½ã€‚_lifeTimeâ€”ç²’å­çš„ç”Ÿå‘½å‘¨æœŸ. ä¾‹å¦‚,å½“ä¸€ä¸ªæ—¶é—´æ®µåï¼Œæˆ‘ä»¬å¯ä»¥æ€æ­»ä¸€ä¸ªæ¿€å…‰æŸ±çš„ç²’å­._ageâ€”ç²’å­çš„å½“å‰å¹´é¾„ã€‚_colorâ€”ç²’å­çš„é¢œè‰²ã€‚_colorFadeâ€”ç²’å­éšæ—¶é—´çš„å˜åŒ–è€Œè¤ªå»çš„é¢œè‰²ã€‚_isAliveâ€”True è¡¨ç¤ºç²’å­æ´»ç€;false è¡¨ç¤ºç²’å­æ­»äº†ã€‚ 14.2 ç²’å­ç³»ç»Ÿçš„ç»„æˆ ç²’å­ç³»ç»Ÿæ˜¯ç²’å­çš„é›†åˆï¼Œç”¨æ¥ä¿å­˜å’Œæ˜¾ç¤ºè¿™äº›ç²’å­ã€‚ç²’å­ç³»ç»Ÿç»´æŠ¤æ‰€æœ‰ç²’å­çš„å…¨éƒ¨å±æ€§ï¼Œå½±å“ç³»ç»Ÿä¸­çš„æ‰€æœ‰ç²’å­ï¼šç²’å­çš„å°ºå¯¸ï¼Œèµ·å§‹çš„ä½ç½®åŠåº”ç”¨åœ¨ç²’å­ä¸Šçš„çº¹ç†ç­‰ã€‚ç²’å­ç³»ç»Ÿçš„æ–¹æ³•è´Ÿè´£æ›´æ–°ã€æ˜¾ç¤ºã€æ€æ­»å’Œåˆ›å»ºç²’å­ã€‚ è™½ç„¶ä¸åŒçš„å…·ä½“ï¼ˆä¸æŠ½è±¡æ˜¯ç›¸å¯¹çš„ï¼‰ç²’å­ç³»ç»Ÿæœ‰ä¸åŒçš„è¡Œä¸ºï¼Œæˆ‘ä»¬å½’çº³å¹¶æ‰¾åˆ°ä¸€äº›æ‰€æœ‰çš„ç²’å­ç³»ç»Ÿå…±æœ‰çš„åŸºæœ¬å±æ€§ï¼Œæˆ‘ä»¬æŠŠè¿™äº›å…¬å…±çš„å±æ€§æ”¾åˆ°ä¸€ä¸ªæŠ½è±¡çš„PsystemåŸºç±»ï¼Œå®ƒæ˜¯æˆ‘ä»¬æ‰€æœ‰çš„å…·ä½“ç²’å­ç³»ç»Ÿçš„çˆ¶ç±»ï¼Œç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹Psystemç±»ï¼šclass PSystem{public: PSystem(); virtual ~PSystem(); virtual bool init(IDirect3DDevice9* device, char* texFileName); virtual void reset(); virtual void resetParticle(Attribute* attribute) = 0; virtual void addParticle(); virtual void update(float timeDelta) = 0; virtual void preRender(); virtual void render(); virtual void postRender(); bool isEmpty(); bool isDead(); protected: virtual void removeDeadParticles(); protected: IDirect3DDevice9 _device; D3DXVECTOR3 _origin; d3d::BoundingBox _boundingBox; float _emitRate; float _size; IDirect3DTexture9 _tex; IDirect3DVertexBuffer9* _vb; std::list _particles; int _maxParticles; DWORD _vbSize; DWORD _vbOffset; DWORD _vbBatchSize; }; ä¸€äº›æ•°æ®æˆå‘˜ï¼š _originâ€”ç²’å­ç³»ç»Ÿçš„åŸç‚¹ï¼Œ è¿™æ˜¯ç²’å­ç³»ç»Ÿäº§ç”Ÿæ—¶çš„ä½ç½®ã€‚ _boundingBoxâ€”åˆ›å»ºç²’å­ç³»ç»Ÿä½¿ç”¨çš„è¾¹ç•Œç›’ï¼Œç”¨äºé™åˆ¶ç²’å­çš„æ´»åŠ¨èŒƒå›´ã€‚ä¾‹å¦‚ï¼Œå‡å¦‚æˆ‘ä»¬è®©é›ªç³»ç»Ÿåªè½åœ¨ä¸€ä¸ªå›´ç»•é«˜å±±çš„å³°é¡¶çš„ä½“ç§¯å†…ï¼› æˆ‘ä»¬ä¼šå®šä¹‰ä¸€ä¸ªåŒ…æ‹¬è¿™ä¸ªä½“ç§¯çš„è¾¹ç•Œç›’, å‡ºç•Œçš„ç²’å­å°†ä¼šè¢«æ€æ­»ã€‚ _emitRateâ€”æ–°å¢åŠ åˆ°ç³»ç»Ÿä¸­çš„ç²’å­çš„é€Ÿåº¦ã€‚ é€šå¸¸çš„æ ‡å‡†æ˜¯æ¯ç§’ã€‚ _sizeâ€”ç³»ç»Ÿä¸­æ‰€æœ‰ç²’å­çš„å°ºå¯¸ã€‚ _particlesâ€”ç³»ç»Ÿä¸­ç²’å­å±æ€§çš„ä¸€ä¸ªåˆ—è¡¨ã€‚ æˆ‘ä»¬ç”¨è¿™ä¸ªåˆ—è¡¨åˆ›å»ºï¼Œé‡Šæ”¾åŠæ›´æ–°ç²’å­ã€‚ å½“æˆ‘ä»¬å‡†å¤‡ç”»ç²’å­æ—¶, æˆ‘ä»¬COPYåˆ—è¡¨èŠ‚ç‚¹çš„ä¸€éƒ¨åˆ†åˆ°é¡¶ç‚¹ç¼“å­˜å¹¶ç”»ç²’å­ã€‚ å½“æˆ‘ä»¬COPYå¦å¤–ä¸€æ‰¹æ—¶ç»˜åˆ¶è¿™æ‰¹ç²’å­ï¼Œç„¶åé‡å¤è¿™ä¸€è¿‡ç¨‹ç›´åˆ°ç»˜åˆ¶å®Œæ‰€æœ‰ç²’å­ã€‚ è¿™æœ‰ç‚¹å¤ªç®€å•äº†ï¼Œæˆ‘ä»¬å°†åœ¨section 14.2.1èŠ‚è¯¦ç»†çš„è§£é‡Šç»˜åˆ¶çš„è¿‡ç¨‹ã€‚ _maxParticlesâ€”åœ¨ç»™å®šçš„æ—¶é—´å†…ï¼Œç³»ç»Ÿä¸­å…è®¸çš„ç²’å­æœ€å¤§æ•°ã€‚ä¾‹å¦‚, å¦‚æœåˆ›å»ºç²’å­çš„é€Ÿåº¦æ¯”é‡Šæ”¾å¿«çš„è¯, éšç€æ—¶é—´çš„å¢é•¿ç²’å­çš„æ•°é‡å°†ä¼šæ˜¯å·¨å¤§çš„ï¼Œè¿™ä¸ªæˆå‘˜å°†é¿å…å‡ºç°è¿™æ ·çš„é—®é¢˜ã€‚ _vbSizeâ€”åœ¨ç»™å®šçš„æ—¶é—´å†…é¡¶ç‚¹ç¼“å­˜ä¸­èƒ½å¤Ÿä¿å­˜çš„ç²’å­çš„æ•°é‡ï¼Œè¿™ä¸ªå€¼ä¸å®é™…çš„ç²’å­ç³»ç»Ÿä¸­çš„ç²’å­æ•°é‡æ— å…³ã€‚æ³¨æ„ï¼šmember _vbOffsetå’Œ_vbBatchSizeæ•°æ®æˆå‘˜åœ¨æ¸²æŸ“ç²’å­ç³»ç»Ÿæ—¶ä½¿ç”¨ï¼Œæˆ‘ä»¬åœ¨ç¨åçš„section 14.2.1èŠ‚è®¨è®ºã€‚ æ–¹æ³•ï¼š PSystem/ ~PSystemâ€”ç”¨æ¥åˆå§‹åŒ–é»˜è®¤å€¼çš„æ„é€ å™¨/ç”¨æ¥é‡Šæ”¾è®¾å¤‡æ¥å£çš„ææ„å™¨ (vertex buffer, texture)ã€‚ initâ€”è¿™ä¸ªæ–¹æ³•åšä¸è®¾å¤‡æ— å…³çš„åˆå§‹åŒ–å·¥ä½œ, æ¯”å¦‚åˆ›å»ºç”¨æ¥ä¿å­˜ç‚¹ç²¾çµçš„é¡¶ç‚¹ç¼“å­˜æˆ–åˆ›å»ºçº¹ç†ã€‚ é¡¶ç‚¹ç¼“å­˜çš„åˆ›å»ºåŒ…æ‹¬ä¸€äº›æ ‡è®°ï¼Œç°åœ¨æˆ‘ä»¬éƒ½å·²ç»è®¨è®ºè¿‡äº†ï¼Œä½†è¿˜æ²¡æœ‰ç”¨:hr = device-&gt;CreateVertexBuffer( _vbSize * sizeof(Particle), D3DUSAGE DYNAMIC | D3DUSAGE POINTS | D3DUSAGE WRITEONLY, Particle::FVF, D3DPOOL_DEFAULT, &amp;_vb, 0) ; o æ³¨æ„ï¼š æˆ‘ä»¬ä½¿ç”¨åŠ¨æ€çš„é¡¶ç‚¹ç¼“å­˜ï¼ˆD3DUSAGE DYNAMICï¼‰ã€‚ å› ä¸ºæˆ‘ä»¬éœ€è¦åœ¨æ¯å¸§ä¸­æ›´æ–°æˆ‘ä»¬çš„ç²’å­,æ„æ€æ˜¯æˆ‘ä»¬å°†ä¼šå»å­˜å–é¡¶ç‚¹ç¼“å­˜çš„å†…å­˜ï¼Œå›æƒ³ä¸€ä¸‹ï¼Œè®¿é—®ä¸€ä¸ªé™æ€çš„é¡¶ç‚¹ç¼“å­˜æ…¢å¾—ä¸å¯æ¥å—ï¼Œ æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨åŠ¨æ€çš„é¡¶ç‚¹ç¼“å­˜ã€‚o æŸ¥çœ‹æˆ‘ä»¬ç”¨è¿‡çš„ D3DUSAGE_POINTS æ ‡è®°,å®ƒè¯´æ˜é¡¶ç‚¹ç¼“å­˜å°†ä¿å­˜ç‚¹ç²¾çµã€‚o é¡¶ç‚¹ç¼“å­˜çš„å°ºå¯¸æ˜¯ç”±_vbSizeé¢„å…ˆç¡®å®šçš„ï¼Œè€Œä¸”ä¸ç³»ç»Ÿä¸­ç²’å­çš„æ•°é‡æ— å…³ã€‚ ä¹Ÿå°±æ˜¯è¯´, _vbSize å°†å°äºç­‰äºç³»ç»Ÿä¸­ç²’å­çš„æ•°é‡ã€‚ è¿™æ˜¯å› ä¸ºæ¸²æŸ“ç²’å­ç³»ç»Ÿæ˜¯ä¸€æ‰¹ä¸€æ‰¹çš„ï¼Œä¸æ˜¯ä¸€æ¬¡æ¸²æŸ“å…¨éƒ¨ã€‚ æˆ‘ä»¬å°†åœ¨section 14.2.1èŠ‚ä¸­è§£é‡Šæ¸²æŸ“è¿‡ç¨‹ã€‚o æˆ‘ä»¬ä½¿ç”¨é»˜è®¤çš„å†…å­˜æ± (pool)ä»£æ›¿é€šå¸¸ä½¿ç”¨çš„æ‰˜ç®¡å†…å­˜æ± ï¼Œå› ä¸ºåŠ¨æ€é¡¶ç‚¹ç¼“å­˜ä¸èƒ½ç”¨åœ¨æ‰˜ç®¡å†…å­˜æ± ä¸­ã€‚ resetâ€”è¿™ä¸ªæ–¹æ³•é‡æ–°è®¾ç½®ç³»ç»Ÿä¸­æ¯ä¸ªç²’å­çš„å±æ€§:void PSystem::reset(){ std::list::iterator i; for(i = _particles.begin(); i != _particles.end(); i++) { resetParticle( &amp;(*i) ); }} resetParticleâ€”è¿™ä¸ªæ–¹æ³•é‡æ–°è®¾ç½®ç²’å­çš„å±æ€§ã€‚å¦‚ä½•é‡è®¾ç²’å­çš„å±æ€§ï¼Œè¿™ä¾èµ–äºå…·ä½“ç²’å­ç³»ç»Ÿçš„ç‰¹æ€§ã€‚å› æ­¤æˆ‘ä»¬å®šä¹‰è¿™ä¸ªæ–¹æ³•ä¸ºè™šæ‹Ÿçš„ï¼Œç­‰å¾…å­ç±»å»å®ç°ã€‚ addParticleâ€”è¿™ä¸ªæ–¹æ³•ç”¨æ¥åœ¨ç³»ç»Ÿä¸­å¢åŠ ä¸€ä¸ªç²’å­ã€‚åœ¨å¢åŠ å®ƒåˆ°ç²’å­åˆ—è¡¨ä¹‹å‰ï¼Œä½¿ç”¨resetParticle æ–¹æ³•å…ˆåˆå§‹åŒ–ç²’å­:void PSystem::addParticle(){ Attribute attribute; resetParticle(&amp;attribute); _particles.push_back(attribute);}void PSystem::addParticle() updateâ€”è¿™ä¸ªæ–¹æ³•æ›´æ–°ç³»ç»Ÿä¸­æ‰€æœ‰çš„ç²’å­ã€‚å› ä¸ºè¿™ä¸ªçš„æ–¹æ³•çš„æ‰§è¡Œå–å†³äºå…·ä½“ç²’å­ç³»ç»Ÿçš„ç‰¹æ€§, å› æ­¤æˆ‘ä»¬å®šä¹‰è¿™ä¸ªæ–¹æ³•ä¸ºæŠ½è±¡çš„ï¼Œç­‰å¾…å­ç±»å»å®ç°ã€‚ renderâ€”è¿™ä¸ªæ–¹æ³•ç”¨æ¥æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰çš„ç²’å­ã€‚ æ‰§è¡Œèµ·æ¥å¾ˆå¤æ‚ï¼Œæˆ‘ä»¬å°†åœ¨14.2.1 èŠ‚è®¨è®ºã€‚ preRenderâ€”ç”¨å®ƒæ¥åˆå§‹åŒ–æ¸²æŸ“çŠ¶æ€ï¼Œ åœ¨æ¸²æŸ“å‰è®¾ç½®ã€‚ å› ä¸ºç³»ç»Ÿä¸ç³»ç»Ÿä¹‹é—´æ˜¯ä¸åŒçš„,æ‰€ä»¥æˆ‘ä»¬å®šä¹‰å®ƒä¸ºè™šæ‹Ÿçš„ã€‚ é»˜è®¤å°†æ‰§è¡Œä¸‹åˆ—ä»£ç :void PSystem::preRender(){_device-&gt;SetRenderState(D3DRS_LIGHTING, false);_device-&gt;SetRenderState(D3DRS_POINTSPRITEENABLE, true);_device-&gt;SetRenderState(D3DRS_POINTSCALEENABLE, true);_device-&gt;SetRenderState(D3DRS_POINTSIZE, d3d::FtoDw( size));_device-&gt;SetRenderState(D3DRS_POINTSIZE MIN, d3d::FtoDw(0.0f)); // control the size of the particle relative to distance_device-&gt;SetRenderState(D3DRS_POINTSCALE A, d3d::FtoDw(0.0f));_device-&gt;SetRenderState(D3DRS_POINTSCALE B, d3d::FtoDw(0.0f));_device-&gt;SetRenderState(D3DRS_POINTSCALE C, d3d::FtoDw(1.0f)); // use alpha from texture_device-&gt;SetTextureStageState(0, D3DTSS_ALPHAARG1, D3DTA_ TEXTURE);_device-&gt;SetTextureStageState(0, D3DTSS_ALPHAOP, D3DTOP_ SELECTARG1); _device-&gt;SetRenderState(D3DRS_ALPHABLENDENABLE, true);_device-&gt;SetRenderState(D3DRS_SRCBLEND, D3DBLEND_SRCALPHA);_device-&gt;SetRenderState(D3DRS_DESTBLEND, D3DBLEND_INVSRCALPHA);} æ³¨æ„ï¼šæˆ‘ä»¬ä½¿ç”¨alphaæ··åˆæ¸²æŸ“ï¼Œä»¥ä¾¿è®¾ç½®çº¹ç†çš„alphaé€šé“ï¼Œæ¥è®¾ç½®çº¹ç†åƒç´ çš„é€æ˜åº¦ã€‚ ç”¨å®ƒäº§ç”Ÿå¤šç§æ•ˆæœï¼›ä¸€ç§ç‰¹æ®Šçš„æƒ…å†µæ˜¯ï¼šè·å¾—è±¡çº¹ç†é‚£æ ·çš„éçŸ©å½¢çš„ç²’å­ã€‚ä¾‹å¦‚ï¼Œ è·å¾—ä¸€ä¸ªåœ†å½¢â€œé›ªçƒå½¢â€çš„ç²’å­, æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å¸¦æœ‰alphaé€šé“çš„çº¹ç†ï¼Œ å®ƒçœ‹ä¸Šå»æ˜¯èƒŒæ™¯ä¸ºé»‘è‰²çš„å¸¦æœ‰ç™½è‰²åœ†å½¢çš„æ ·å­ã€‚å› æ­¤ï¼Œæ˜¾ç¤ºå‡ºæ¥æ—¶åªæ˜¯ä¸€ä¸ªç™½åœ†ï¼Œè¿™æ¯”ç™½è‰²çš„çŸ©å½¢çº¹ç†è¦å¥½ã€‚ postRenderâ€”ç”¨å®ƒå»ä¿å­˜æ‰€æœ‰æ¸²æŸ“çŠ¶æ€ï¼Œå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç²’å­ç³»ç»Ÿå¯èƒ½æœ‰çš„è®¾ç½®ã€‚å› ä¸ºç³»ç»Ÿä¸ç³»ç»Ÿé—´æ˜¯ä¸åŒçš„,æ‰€ä»¥æˆ‘ä»¬å®šä¹‰å®ƒä¸ºè™šæ‹Ÿçš„ã€‚é»˜è®¤å°†æ‰§è¡Œä¸‹åˆ—ä»£ç : 1234567void PSystem::postRender()&#123; _device-&gt;SetRenderState(D3DRS_LIGHTING, true); _device-&gt;SetRenderState(D3DRS_POINTSPRITEENABLE, false); _device-&gt;SetRenderState(D3DRS_POINTSCALEENABLE, false); _device-&gt;SetRenderState(D3DRS_ALPHABLENDENABLE, false);&#125; isEmptyâ€”å¦‚æœä¸ºTrue åˆ™åœ¨å½“å‰çš„ç³»ç»Ÿä¸­æ²¡æœ‰ç²’å­ï¼Œ å¦åˆ™ä¸ºfalse. isDeadâ€”å¦‚æœä¸ºTrue åˆ™ç³»ç»Ÿä¸­çš„æ‰€æœ‰ç²’å­éƒ½æ˜¯æ­»çš„ï¼Œå¦åˆ™ä¸ºfalseã€‚ æ³¨æ„ï¼š ç³»ç»Ÿä¸­æ‰€æœ‰ç²’å­çŠ¶æ€ä¸ºidDeadæ—¶å¹¶ä¸æ„å‘³ç€isEmpty. ç©ºæ„æ€ç€ç³»ç»Ÿä¸­æ²¡æœ‰ç²’å­ã€‚ Deadçš„æ„æ€æ˜¯ç³»ç»Ÿä¸­æœ‰ç²’å­ï¼Œä½†éƒ½æ˜¯æ­»çš„ã€‚. removeDeadParticlesâ€”æœç´¢å±_particleæ€§è¡¨ï¼Œä»è¡¨ä¸­æ€æ­»å¹¶åˆ é™¤ç²’å­ã€‚14.2.1 ç»˜åˆ¶ç²’å­ç³»ç»Ÿ å› ä¸ºç²’å­ç³»ç»Ÿæ˜¯åŠ¨æ€çš„ï¼Œåœ¨æ¯ä¸€ä¸ªå¸§ä¸­æˆ‘ä»¬éœ€è¦æ›´æ–°ç³»ç»Ÿä¸­çš„ç²’å­ï¼Œå¯¹äºæ¸²æŸ“ç²’å­ç³»ç»Ÿçš„ä¸€ç§ç›´è§‚ä½†æ•ˆç‡ä½ä¸‹çš„æ–¹æ³•å¦‚ä¸‹: åˆ›å»ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„é¡¶ç‚¹ç¼“å­˜ä¿å­˜æœ€å¤§æ•°é‡çš„ç²’å­ã€‚ æ¯ä¸€å¸§é‡Œæ‰§è¡Œï¼š A. æ›´æ–°æ‰€æœ‰ç²’å­ã€‚B. COPYæ‰€æœ‰æ´»ç€çš„ç²’å­åˆ°é¡¶ç‚¹ç¼“å­˜ã€‚C. ç»˜åˆ¶é¡¶ç‚¹ç¼“å­˜ã€‚ è¿™ä¸ªæ–¹æ³•æ­£ç¡®ï¼Œä¸è¿‡ä¸æ˜¯æœ€æœ‰æ•ˆç‡çš„ã€‚ç¬¬ä¸€ï¼Œé¡¶ç‚¹ç¼“å†²å¿…é¡»è¶³å¤Ÿå¤§ä»¥ä¿å­˜ç³»ç»Ÿä¸­æ‰€æœ‰ç²’å­ã€‚ä½†æ˜¯éå¸¸é‡è¦çš„æ˜¯ï¼Œå½“æˆ‘ä»¬ä»åˆ—è¡¨æ‹·è´æ‰€æœ‰ç²’å­åˆ°é¡¶ç‚¹ç¼“å†²ï¼ˆæ­¥éª¤Bï¼‰æ—¶ï¼Œæ˜¾å¡å´ä»€ä¹ˆä¹Ÿä¸åšã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬ç³»ç»Ÿæœ‰10,000ä¸ªç²’å­ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªèƒ½å®¹çº³10,000ä¸ªç²’å­çš„é¡¶ç‚¹ç¼“å†²ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„å†…å­˜ã€‚å¦å¤–æ˜¾å¡å°†åœç€ä»€ä¹ˆä¹Ÿä¸åšç›´åˆ°åˆ—è¡¨ä¸­çš„10,000ä¸ªç²’å­æ‹·åˆ°é¡¶ç‚¹ç¼“å†²ï¼Œå¹¶ä¸”æˆ‘ä»¬è°ƒç”¨DrawPrimitiveã€‚è¿™ä¸ªç‰¹å®šæƒ…å†µæ˜¯CPUä¸æ˜¾å¡ä¸åŒæ—¶å·¥ä½œçš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚ æ›´å¥½çš„åŠæ³•ï¼ˆSDKä¸­ç‚¹ç²¾çµä¾‹ç¨‹ä¸­ç”¨åˆ°çš„æ–¹æ³•ï¼‰å°±è±¡è¿™æ ·ï¼š æç¤ºï¼šè¿™æ˜¯ä¸€ä¸ªç®€å•çš„æè¿°ï¼Œä½†å®ƒè¯´æ˜äº†è¿™ä¸€æ€æƒ³ã€‚å®ƒå‡å®šæˆ‘ä»¬æ€»æ˜¯æœ‰500ä¸ªç²’å­ä»¥å¡«å……ä¸€ä¸ªç¼“å­˜ç‰‡æ®µï¼Œä½†æ˜¯è¿™æ˜¯ä¸å¯èƒ½å‘ç”Ÿçš„ï¼Œå› ä¸ºæˆ‘ä»¬ç»å¸¸æ€æ­»å¹¶åˆ›å»ºç²’å­ï¼Œæ‰€ä»¥ä»ä¸€å¸§åˆ°å¦ä¸€å¸§ç²’å­æ•°é‡æ˜¯å˜åŒ–çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬åªå‰©ä¸‹200ä¸ªç²’å­è¦åœ¨å½“å‰å¸§æ‹·è´å¹¶æ¸²æŸ“ã€‚å› ä¸º200ä¸ªç²’å­ä¸èƒ½å¡«å……æ•´ä¸ªç¼“å­˜ç‰‡æ®µï¼Œæˆ‘ä»¬ç”¨ä»£ç å¤„ç†è¿™ä¸ªç‰¹å®šæƒ…å½¢ã€‚è¿™ä¸ªç‰¹å®šæƒ…å½¢åªæœ‰åœ¨æœ€åçš„ç¼“å­˜ç‰‡æ®µä¸­æ‰ä¼šå‡ºç°ï¼Œå› ä¸ºå¦‚æœä¸æ˜¯æœ€åçš„ç‰‡æ–­ï¼Œå°±æ„å‘³ç€å¿…ç„¶æœ‰500ä¸ªç²’å­å°†è¢«ç§»åˆ°ä¸‹ä¸€ç¼“å­˜ç‰‡æ®µã€‚ åˆ›å»ºä¸€ä¸ªåˆé€‚å°ºå¯¸çš„é¡¶ç‚¹ç¼“å­˜ï¼ˆèƒ½å¤Ÿä¿å­˜2000ä¸ªç²’å­ï¼‰ï¼Œç„¶åæˆ‘ä»¬åˆ’åˆ†é¡¶ç‚¹ç¼“å­˜ä¸ºå‡ ä¸ªå°çš„å—ï¼Œå°±åƒè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬è®¾ç½®æ¯ä¸ªç¼“å­˜ç‰‡æ–­çš„å°ºå¯¸ä¸º500ä¸ªç²’å­ã€‚ ç„¶ååˆ›å»ºä¸€ä¸ªå…¨å±€å˜é‡ i = 0 ï¼Œç”¨æ¥è®°å½•ç‰‡æ®µã€‚ æ¯ä¸€å¸§é‡Œæ‰§è¡Œ: A. æ›´æ–°æ‰€æœ‰ç²’å­ã€‚B. ç›´åˆ°æ‰€æœ‰ç²’å­æ¸²æŸ“å®Œæ¯•ã€‚: å¦‚æœé¡¶ç‚¹ç¼“å­˜æ²¡æœ‰æ»¡ï¼ša ç”¨D3DLOCK_NOOVERWRITEæ ‡è®°é”å®šç¼“å­˜ç‰‡æ®µib COPY 500ä¸ªç²’å­åˆ°ç‰‡æ®µi å¦‚æœé¡¶ç‚¹ç¼“å­˜æ»¡äº†ï¼ša ä»èµ·å§‹çš„åœ°æ–¹å¼€å§‹é¡¶ç‚¹ç¼“å†²: i=0b ç”¨D3DLOCK_NOOVERWRITEæ ‡è®°é”å®šç¼“å­˜æ®µic COPY 500ä¸ªç²’å­åˆ°ç‰‡æ®µi æ¸²æŸ“ç‰‡æ®µi. ä¸‹ä¸€ç‰‡æ®µï¼š i+ +å¤‡æ³¨ï¼šé¡¶ç‚¹ç¼“å­˜æ˜¯åŠ¨æ€çš„ï¼Œ å› æ­¤æˆ‘ä»¬èƒ½åˆ©ç”¨åŠ¨æ€é”å®šæ ‡è®°D3DLOCK_NOOVERWRITE å’Œ D3DLOCK_DISCARDã€‚è¿™ä¸¤ä¸ªæ ‡è®°å…è®¸æˆ‘ä»¬é”å®šé¡¶ç‚¹ç¼“å­˜çš„æŸä¸€éƒ¨åˆ†ã€‚å½“é¡¶ç‚¹ç¼“å­˜ä¸­çš„å…¶ä»–éƒ¨åˆ†è¢«æ¸²æŸ“æ—¶ï¼Œå®ƒæ˜¯ä¸èƒ½æ¸²æŸ“çš„ã€‚ä¾‹å¦‚ï¼Œå‡å¦‚æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨D3DLOCK_NOOVERWRITEæ ‡è®°æ¸²æŸ“ç‰‡æ®µ0æ—¶ï¼Œ å½“æ¸²æŸ“ç‰‡æ®µ0çš„æ—¶å€™æˆ‘ä»¬èƒ½é”å®šå¹¶å¡«å……ç‰‡æ®µ1ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢æ¸²æŸ“çš„å»¶è¿Ÿã€‚ è¿™ä¸ªæ–¹æ³•æ›´æœ‰æ•ˆç‡ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å‡å°‘é¡¶ç‚¹ç¼“å­˜çš„å°ºå¯¸ï¼›ç„¶åï¼Œ CPUä¸æ˜¾å¡åœ¨åè°ƒçš„å·¥ä½œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬ç»˜åˆ¶ä¸€å°æ‰¹ç²’å­æ—¶(graphics card work)ï¼ŒåŒæ—¶æ‹·è´å¦ä¸€å°æ‰¹ç²’å­åˆ°é¡¶ç‚¹ç¼“å­˜ (CPU work)ã€‚è¿™ä¸ªåŠ¨ä½œæ˜¯è¿ç»­æ‰§è¡Œçš„ï¼Œç›´åˆ°æ‰€æœ‰çš„ç²’å­éƒ½è¢«æ¸²æŸ“å®Œæ¯•ï¼Œå°±åƒä½ äº†è§£çš„ä¸€æ ·ï¼Œ æ˜¾å¡åœ¨å…¨éƒ¨é¡¶ç‚¹ç¼“å­˜è¢«å¡«å……çš„æ—¶å€™æ˜¯ä¸ç”¨å¤„äºç©ºé—²çŠ¶æ€çš„ã€‚æˆ‘ä»¬ç°åœ¨å°†æ³¨æ„åŠ›è½¬å‘è¿™ä¸€ä¸ªæ¸²æŸ“æ–¹æ¡ˆçš„å®ç°ï¼Œä¸ºäº†æ–¹ä¾¿ä½¿ç”¨è¿™ä¸ªç²’å­ç³»ç»Ÿçš„æ¸²æŸ“æ–¹æ¡ˆ, æˆ‘ä»¬ä½¿ç”¨ PSystem ç±»ä¸­çš„ä¸‹åˆ—æ•°æ®æˆå‘˜: _vbSizeâ€”åœ¨ç»™å®šæ—¶é—´å†…æˆ‘ä»¬çš„é¡¶ç‚¹ç¼“å­˜èƒ½å¤Ÿä¿å­˜çš„ç²’å­æ•°é‡ã€‚è¿™ä¸ªå€¼ä¸å®é™…çš„ç²’å­ç³»ç»Ÿä¸­çš„ç²’å­æ•°æ— å…³ã€‚ _vbOffsetâ€”è¿™ä¸ªå˜é‡æ˜¯åœ¨é¡¶ç‚¹ç¼“å­˜ä¸­çš„åç§»ï¼Œåœ¨é¡¶ç‚¹ç¼“å­˜é‡Œæˆ‘ä»¬å°†ç”¨å®ƒå¼€å§‹COPYä¸‹ä¸€æ‰¹ç²’å­ï¼Œä¾‹å¦‚ï¼Œå¦‚æœç¬¬ä¸€æ‰¹åœ¨ç¼“å­˜ä¸­æ˜¯0åˆ°499ï¼Œåç§»åˆ°ç¬¬äºŒæ‰¹COPYçš„å¼€å§‹å¤„å°†æ˜¯500ã€‚ _vbBatchSizeâ€”å®šä¹‰ä¸€æ‰¹ç¼“å­˜ä¸­çš„ç²’å­æ•°é‡ã€‚ æˆ‘ä»¬ç°åœ¨ä»‹ç»æ¸²æŸ“æ–¹æ³•çš„ä»£ç ï¼švoid PSystem::render(){if( !_particles.empty() ){ // set render states preRender(); _device-&gt;SetTexture(0, _tex); _device-&gt;SetFVF(Particle::FVF); _device-&gt;SetStreamSource(0, _vb, 0, sizeof(Particle)); // start at beginning if weâ€™re at the end of the vb if(_vbOffset &gt;= _vbSize) _vbOffset = 0; Particle*v =0; _vb-&gt;Lock( _vbOffset * sizeof( Particle ), _vbBatchSize * sizeof( Particle ), (void**)&amp;v, _vbOffset ? D3DLOCK_NOOVERWRITE : D3DLOCK_DISCARD); DWORD numParticlesInBatch = 0; // // Until all particles have been rendered. // std::list&lt;Attribute&gt;::iterator i; for(i = _particles.begin(); i != _particles.end(); i++) { if( i-&gt;_isAlive ) { // // Copy a batch of the living particles to the // next vertex buffer segment // v-&gt;_position = i-&gt;_position; v-&gt;_color = (D3DCOLOR)i-&gt;_color; v++; // next element; numParticlesInBatch++; //increase batch counter // is this batch full? if(numParticlesInBatch == _vbBatchSize) { // // Draw the last batch of particles that was // copied to the vertex buffer. // _vb-&gt;Unlock(); _device-&gt;DrawPrimitive( D3DPT_POINTLIST, _vbOffset, _vbBatchSize); // // While that batch is drawing, start filling the // next batch with particles. // // move the offset to the start of the next batch _vbOffset += _vbBatchSize; // don&#39;t offset into memory thats outside the vb&#39;s // range. If we&#39;re at the end, start at the beginning. if(_vbOffset &gt;= _vbSize) _vbOffset = 0; _vb-&gt;Lock( _vbOffset * sizeof( Particle ), _vbBatchSize * sizeof( Particle ), (void**)&amp;v, _vbOffset ? D3DLOCK_NOOVERWRITE : D3DLOCK_DISCARD); numParticlesInBatch = 0; // reset for new batch }//end if }//end if }//end for _vb-&gt;Unlock(); // it&#39;s possible that the LAST batch being filled never // got rendered because the condition // (numParticlesInBatch == _vbBatchSize) would not have // been satisfied. We draw the last partially filled batch now. if( numParticlesInBatch ) { _device-&gt;DrawPrimitive( D3DPT_POINTLIST, _vbOffset, numParticlesInBatch); } // next block _vbOffset += _vbBatchSize; postRender(); }//end if }// end render() 14.2.2 éšæœº è¿™æœ‰ä¸€ä¸ªéšæœºçš„ç²’å­ç³»ç»Ÿã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æ¨¡æ‹Ÿé›ªèŠ±ï¼Œä¸èƒ½è®©æ‰€æœ‰é›ªèŠ±ä»¥å®Œå…¨ç›¸åŒçš„æ–¹å¼è½ä¸‹ã€‚æˆ‘ä»¬è¦è®©å®ƒä»¬æŒ‰ç›¸ä¼¼çš„æ–¹å¼è½ä¸‹è€Œä¸æ˜¯å®Œå…¨ç›¸åŒçš„æ–¹å¼ã€‚ä¸ºäº†ä½¿ç²’å­ç³»ç»Ÿçš„éšæœºåŠŸèƒ½æ›´ç®€å•ï¼Œæˆ‘ä»¬å¢åŠ äº†ä¸‹åˆ—ä¸¤ä¸ªå‡½æ•°åˆ°d3dUtility.h/cppæ–‡ä»¶ã€‚ ç¬¬ä¸€ä¸ªå‡½æ•°åœ¨[lowBound, highBound]åŒºé—´å†…éšæœºçš„è¿”å›ä¸€ä¸ªFloatç±»å‹å€¼ï¼šfloat d3d::GetRandomFloat(float lowBound, float highBound){ if( lowBound &gt;= highBound ) // bad input return lowBound; // get random float in [0, 1] interval float f = (rand() % 10000) * 0.0001f; // return float in [lowBound, highBound] interval. return (f * (highBound - lowBound)) + lowBound; } ç¬¬äºŒä¸ªå‡½æ•°åœ¨è¾¹ç•Œç›’çš„èŒƒå›´å†…ï¼Œè¾“å‡ºä¸€ä¸ªéšæœºçš„å‘é‡ã€‚void d3d::GetRandomVector( D3DXVECTOR3 out, D3DXVECTOR3 min, D3DXVECTOR3* max){ out-&gt;x = GetRandomFloat(min-&gt;x, max-&gt;x); out-&gt;y = GetRandomFloat(min-&gt;y, max-&gt;y); out-&gt;z = GetRandomFloat(min-&gt;z, max-&gt;z);} æ³¨æ„ï¼šè®°å¾—ç”¨srand()å»seedéšæœºæ•°ç”Ÿæˆå™¨ã€‚14.3 å…·ä½“çš„ç²’å­ç³»ç»Ÿï¼šé›ªã€ç«ã€ç²’å­æªç°åœ¨è®©æˆ‘ä»¬ç”¨Psystemç±»å¼€å§‹ä¸€ä¸ªå…·ä½“çš„ç²’å­ç³»ç»Ÿï¼Œä¸ºäº†è¯´æ˜ç”¨æ„ï¼Œè¿™äº›ç³»ç»Ÿçš„è®¾è®¡å¾ˆç®€å•ï¼Œæ²¡æœ‰ç”¨åˆ°Psystemç±»æ‰€æä¾›çš„æ‰€æœ‰çµæ´»æ€§ã€‚æˆ‘ä»¬å®ç°é›ªã€ç«ã€ç²’å­æªç³»ç»Ÿã€‚è¿™äº›ç³»ç»Ÿçš„åå­—åŸºæœ¬ä¸Šæ¦‚æ‹¬äº†ä»–ä»¬çš„æ¨¡å‹ã€‚é›ªç³»ç»Ÿæ¨¡æ‹Ÿä¸‹è½çš„é›ªèŠ±ï¼Œç«ç³»ç»Ÿæ¨¡æ‹Ÿçœ‹ä¸Šå»åƒç«ç„°çš„çˆ†ç‚¸ï¼Œç²’å­æªç³»ç»Ÿä»ç…§ç›¸æœºä½ç½®å‘å¯¹é¢å‘å°„å‡ºç²’å­ï¼ˆç”¨é”®ç›˜ï¼‰ã€‚æ³¨æ„ï¼šç…§ä¾‹ï¼Œç”¨å…¨éƒ¨çš„å·¥ç¨‹ä»£ç æ¥è¯´æ˜è¿™äº›ç³»ç»Ÿï¼Œä½ èƒ½å¤Ÿåœ¨æœ¬ç« æ‰¾åˆ°è¿™äº›æ–‡ä»¶ã€‚ 14.3.1 ä¾‹å­ç¨‹åºï¼šé›ª å›¾14.2 é›ªç³»ç»Ÿä¾‹å­çš„å±å¹•æˆªå›¾ é›ªç³»ç»Ÿç±»å®šä¹‰å¦‚ä¸‹ï¼šclass Snow : public PSystem{public: Snow(d3d::BoundingBox boundingBox, int numParticles); void resetParticle(Attribute attribute); void update(float timeDelta);};å¤‡æ³¨ï¼šå› ä¸ºçˆ¶ç±»åšäº†å¤§éƒ¨åˆ†çš„å·¥ä½œï¼Œæ‰€ä»¥é›ªç³»ç»Ÿçš„æ¥å£éå¸¸ç®€å•ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬åœ¨è¿™ä¸€èŠ‚ä¸­å®ç°çš„è¿™ä¸‰ä¸ªç²’å­ç³»ç»Ÿï¼Œæ¥å£ç®€å•å¹¶ç›¸å¯¹å®¹æ˜“å®ç°ã€‚ æ„é€ å™¨æä¾›ä¸€ä¸ªç‚¹ç»™è¾¹ç•Œç›’ç»“æ„ï¼Œè¾¹ç•Œç›’æ˜¯ç²’å­ç³»ç»Ÿçš„æˆå‘˜ã€‚è¾¹ç•Œç›’æè¿°é›ªèŠ±åœ¨å“ªä¸ªèŒƒå›´å†…ï¼ˆä½“ç§¯èŒƒå›´ï¼‰ä¸‹è½ï¼Œå¦‚æœé›ªèŠ±å‡ºäº†è¾¹ç•Œç›’ï¼Œå®ƒå°†è¢«æ€æ­»å¹¶å†ç”Ÿã€‚è¿™æ ·ï¼Œé›ªç³»ç»Ÿå§‹ç»ˆèƒ½ä¿å­˜æœ‰åŒæ ·æ•°é‡çš„æ¿€ç²’å­ï¼Œæ„é€ å™¨çš„å®ç°ï¼šSnow::Snow(d3d::BoundingBox boundingBox, int numParticles){ _boundingBox = boundingBox; _size = 0.8f; _vbSize = 2048; _vbOffset = 0; _vbBatchSize = 512; for(int i = 0; i &lt; numParticles; i++) addParticle();} åŒæ ·æ³¨æ„ï¼šæˆ‘ä»¬æŒ‡å®šé¡¶ç‚¹ç¼“å­˜çš„å°ºå¯¸ï¼Œæ¯ä¸€æ‰¹çš„å°ºå¯¸å’Œå¼€å§‹çš„åç§»ã€‚ ResetParticleæ–¹æ³•åˆ›å»ºä¸€ä¸ªé›ªèŠ±ï¼Œåœ¨xã€zè½´éšæœºçš„ä½ç½®å¹¶åœ¨è¾¹ç•Œç›’çš„èŒƒå›´å†…ã€‚è®¾ç½®yè½´é«˜åº¦ä¸ºè¾¹ç•Œç›’çš„é¡¶éƒ¨ã€‚å¦‚æœç»™é›ªèŠ±ä¸€ä¸ªé€Ÿåº¦ï¼Œä»¥ä¾¿è®©é›ªèŠ±ä¸‹è½æ—¶ç¨ç¨å‘å·¦å€¾æ–œã€‚é›ªèŠ±æ˜¯ç™½è‰²çš„ã€‚void Snow::resetParticle(Attribute* attribute){ attribute-&gt;_isAlive = true; // get random x, z coordinate for the position of the snowflake. d3d::GetRandomVector( &amp;attribute-&gt;_position, &amp;_boundingBox._min, &amp;_boundingBox._max); // no randomness for height (y-coordinate). Snowflake // always starts at the top of bounding box. attribute-&gt;_position.y = _boundingBox._max.y; // snowflakes fall downward and slightly to the left attribute-&gt;_velocity.x = d3d::GetRandomFloat(0.0f, 1.0f)*-3.0f; attribute-&gt;_velocity.y = d3d::GetRandomFloat(0.0f, 1.0f)*-10.0f; attribute-&gt;_velocity.z = 0.0f; // white snowflake attribute-&gt;_color = d3d::WHITE; } Updateæ–¹æ³•æ›´æ–°ç²’å­å’Œç²’å­é—´çš„ä½ç½®ï¼Œå¹¶ä¸”æµ‹è¯•ç²’å­æ˜¯å¦åœ¨ç³»ç»Ÿçš„è¾¹ç•Œç›’ä¹‹å¤–ï¼Œå¦‚æœå®ƒå·²ç»è·³å‡ºè¾¹ç•Œç›’ï¼Œå°±å†é‡æ–°åˆ›å»ºã€‚void Snow::update(float timeDelta){ std::list::iterator i; for(i = _particles.begin(); i != _particles.end(); i++) { i-&gt;_position += i-&gt;_velocity * timeDelta; // is the point outside bounds? if( _boundingBox.isPointInside( i-&gt;_position ) == false ) { // nope so kill it, but we want to recycle dead // particles, so respawn it instead. resetParticle( &amp;(*i) ); } } } 14.3.2 ä¾‹å­ç¨‹åºï¼šç« å›¾14.3 ç«ç²’å­ç³»ç»Ÿä¾‹å­çš„å±å¹•æˆªå›¾ç«ç³»ç»Ÿç±»å®šä¹‰å¦‚ä¸‹ï¼šclass Firework : public PSystem{public: Firework(D3DXVECTOR3 origin, int numParticles); void resetParticle(Attribute attribute); void update(float timeDelta); void preRender(); void postRender();}; æ„é€ å™¨éœ€è¦æä¾›ä¸€ä¸ªç‚¹ä½œä¸ºç²’å­ç³»ç»Ÿä¸­çš„åŸç‚¹ï¼Œå’Œç³»ç»Ÿä¸­çš„ç²’å­æ•°ï¼ŒåŸç‚¹æ˜¯ç«ç„°çˆ†å‘çš„é‚£ä¸ªç‚¹ã€‚ResetParticleæ–¹æ³•åœ¨åŸç‚¹ä½ç½®åˆå§‹åŒ–ç²’å­ç³»ç»Ÿï¼Œå¹¶åœ¨è¾¹ç•Œçƒå†…åˆ›å»ºä¸€ä¸ªéšæœºçš„é€Ÿåº¦ï¼Œç²’å­ç³»ç»Ÿä¸­çš„æ¯ä¸ªä¾‹å­æœ‰ä¸€ä¸ªéšæœºçš„é¢œè‰²ï¼Œæˆ‘ä»¬å®šä¹‰ç²’å­åªèƒ½å­˜æ´»2ç§’ã€‚void Firework::resetParticle(Attribute* attribute){ attribute-&gt;_isAlive = true; attribute-&gt;_position = _origin; D3DXVECTOR3 min = D3DXVECTOR3(-1.0f, -1.0f, -1.0f); D3DXVECTOR3 max = D3DXVECTOR3( 1.0f, 1.0f, 1.0f); d3d::GetRandomVector( &amp;attribute-&gt;_velocity, &amp;min, &amp;max); // normalize to make spherical D3DXVec3Normalize( &amp;attribute-&gt;_velocity, &amp;attribute-&gt;_velocity); attribute-&gt;_velocity *= 100.0f; attribute-&gt;_color = D3DXCOLOR( d3d::GetRandomFloat(0.0f, 1.0f), d3d::GetRandomFloat(0.0f, 1.0f), d3d::GetRandomFloat(0.0f, 1.0f), 1.0f); attribute-&gt;_age = 0.0f; attribute-&gt;_lifeTime = 2.0f; // lives for 2 seconds } Updateæ–¹æ³•æ›´æ–°æ¯ä¸ªç²’å­çš„ä½ç½®ï¼Œå¹¶åœ¨ç²’å­è¶…å‡ºè‡ªå·±çš„ç”Ÿæ´»å‘¨æœŸæ—¶æ€æ­»å®ƒã€‚æ³¨æ„ï¼šè¿™ä¸ªç³»ç»Ÿä¸èƒ½ç§»é™¤æ­»æ‰çš„ç²’å­ï¼Œè¿™ä¹ˆåšæ˜¯å› ä¸ºæˆ‘ä»¬æƒ³äº§ç”Ÿä¸€ä¸ªæ–°çš„ç«ç„°çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªè¦ç®€å•çš„é‡æ–°è®¾ç½®å·²ç»å­˜åœ¨çš„æ­»äº†çš„ç«ç„°ç³»ç»Ÿå°±å¯ä»¥äº†ã€‚è¿™æ ·ä¸ºæˆ‘ä»¬ä¸å¿…é¢‘ç¹çš„å»äº§ç”Ÿå’Œé‡Šæ”¾ç²’å­ã€‚void Firework::update(float timeDelta){ std::list::iterator i; for(i = _particles.begin(); i != _particles.end(); i++) { // only update living particles if( i-&gt;_isAlive ) { i-&gt;_position += i-&gt;_velocity * timeDelta; i-&gt;_age += timeDelta; if(i-&gt;_age &gt; i-&gt;_lifeTime) // kill i-&gt;_isAlive = false; } } }å½“æ¸²æŸ“æ—¶ï¼Œç«ç³»ç»Ÿä½¿ç”¨ä¸åŒçš„æ–¹æ³•æ¸²æŸ“åƒç´ ã€‚è¿›ä¸€æ­¥è®²ï¼Œå®ƒä¸å†™æ·±åº¦ç¼“å­˜ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„æ”¹å˜æ··åˆåƒç´ ï¼Œé€šè¿‡é‡å†™PSystem::preRenderæ–¹æ³•å’ŒPSystem::postRenderæ–¹æ³•ï¼Œä¸‹é¢æ˜¯é‡å†™çš„å®ç°ï¼švoid Firework::update(float timeDelta){ std::list::iterator i;void Firework::preRender(){ PSystem::preRender(); _device-&gt;SetRenderState(D3DRS_SRCBLEND, D3DBLEND_ONE); _device-&gt;SetRenderState(D3DRS_DESTBLEND, D3DBLEND_ONE); // read, but don&#39;t write particles to z-buffer _device-&gt;SetRenderState(D3DRS_ZWRITEENABLE, false); } void Firework::postRender(){ PSystem::postRender(); _device-&gt;SetRenderState(D3DRS_ZWRITEENABLE, true); }æ³¨æ„ï¼šè¿™ä¸¤ä¸ªæ–¹æ³•è°ƒç”¨çˆ¶ç±»ç‰ˆæœ¬ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬ä»èƒ½é‡æ–°ä½¿ç”¨çˆ¶ç±»çš„ä¸€äº›åŠŸèƒ½ï¼Œåšä¸€äº›å°çš„æ”¹å˜å°±å˜æˆäº†ç«ç„°ç³»ç»Ÿã€‚14.3.3 ä¾‹å­ç¨‹åºï¼šç²’å­æª å›¾14.4 æ¿€å…‰æªç³»ç»Ÿçš„æˆªå›¾ä¸‹é¢æ˜¯ç²’å­æªç³»ç»Ÿçš„å®šä¹‰ï¼šclass ParticleGun : public PSystem{public: ParticleGun(Camera camera); void resetParticle(Attribute attribute); void update(float timeDelta); private: Camera _camera;}; æ„é€ å™¨éœ€è¦æä¾›ä¸€ä¸ªç…§ç›¸æœºçš„ä½ç½®ç‚¹ï¼Œè¿™æ˜¯å› ä¸ºç³»ç»Ÿéœ€è¦çŸ¥é“ç…§ç›¸æœºçš„ä½ç½®åŠæœå‘ï¼Œä»¥å†³å®šåœ¨å“ªåˆ›å»ºä¸€ä¸ªç²’å­ã€‚ ResetParticleæ–¹æ³•è®¾ç½®ç²’å­çš„ä½ç½®ä¸ºå½“å‰ç…§ç›¸æœºçš„ä½ç½®ï¼Œå¹¶ä¸”è®¾ç½®æ–¹å‘ä¸Šçš„é€Ÿåº¦ï¼Œåœ¨ç…§åƒæœºè§†è§’çš„100ä¸ªå•ä½ã€‚è¿™æ ·ï¼Œå­å¼¹å°†å°„å‘æˆ‘ä»¬æ­£åœ¨çœ‹çš„æ–¹å‘ï¼Œç²’å­é¢œè‰²ä¸ºç»¿è‰²ã€‚void ParticleGun::resetParticle(Attribute attribute){ attribute-&gt;_isAlive = true; D3DXVECTOR3 cameraPos; _camera-&gt;getPosition(&amp;cameraPos); D3DXVECTOR3 cameraDir; _camera-&gt;getLook(&amp;cameraDir); // change to camera position attribute-&gt;_position = cameraPos; attribute-&gt;_position.y -= 1.0f; // slightly below camera so it&#39;s // like we&#39;re carrying gun // travels in the direction the camera is looking attribute-&gt;_velocity = cameraDir * 100.0f; // green attribute-&gt;_color = D3DXCOLOR(0.0f, 1.0f, 0.0f, 1.0f); attribute-&gt;_age = 0.0f; attribute-&gt;_lifeTime = 1.0f; // lives for 1 seconds } Updateæ–¹æ³•æ›´æ–°ç²’å­çš„ä½ç½®ï¼Œå¹¶ä¸”æ€æ­»è¶…è¿‡å…¶ç”Ÿå‘½å‘¨æœŸçš„ç²’å­ï¼Œç„¶åï¼Œæˆ‘ä»¬æœç´¢ç²’å­åˆ—è¡¨åˆ é™¤å·²ç»æ­»äº†çš„ç²’å­ã€‚{ std::list::iterator i; for(i = _particles.begin(); i != _particles.end(); i++) { i-&gt;_position += i-&gt;_velocity * timeDelta; i-&gt;_age += timeDelta; if(i-&gt;_age &gt; i-&gt;_lifeTime) // kill i-&gt;_isAlive = false; } removeDeadParticles(); } 14.4 æ‘˜è¦ ç”¨ç‚¹ç²¾çµæ¥æ˜¾ç¤ºä¸€ä¸ªç²’å­æ˜¯æ–¹ä¾¿ä¸”çµæ´»çš„ï¼Œå®ƒå¯èƒ½æ”¹å˜ç²’å­å°ºå¯¸ã€ç»™ç²’å­èµ‹äºˆçº¹ç†ã€‚æ­¤å¤–ï¼Œèƒ½å¤Ÿä½¿ç”¨ç®€å•çš„é¡¶ç‚¹ï¼ˆvertexï¼‰æ¥æè¿°å®ƒä»¬ã€‚ ç²’å­ç³»ç»Ÿç»´æŠ¤ä¸€ä¸ªç²’å­çš„é›†åˆï¼Œå¹¶è´Ÿè´£åˆ›å»ºã€é‡Šæ”¾ã€æ›´æ–°å’Œæ˜¾ç¤ºç²’å­ã€‚ è¿˜æœ‰ä¸€äº›å…¶ä»–ç²’å­ç³»ç»Ÿçš„æ¦‚å¿µï¼Œæ˜¯ä½ èƒ½å¤Ÿå®ç°çš„ï¼šçƒŸï¼Œç«ç®­çš„è½¨è¿¹ï¼Œå–·æ³‰/æ²³æ°´è½¦æ•ˆæœï¼Œç«ï¼Œå…‰ï¼Œçˆ†ç‚¸ï¼Œå’Œé›¨ã€‚]]></content>
      <categories>
        <category>Direct3D</category>
      </categories>
      <tags>
        <tag>Direct3D</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬åä¸‰ç«  åœ°å½¢æ¸²æŸ“åŸºç¡€(Basic Terrain Rendering)]]></title>
    <url>%2F2019%2F04%2F11%2FBasic-Terrain-Rendering%2F</url>
    <content type="text"><![CDATA[å®é™…ä¸Šï¼Œåœ°å½¢ç½‘æ ¼ä¸æ¯”ä¸‰è§’å½¢ç½‘æ ¼å¤æ‚ï¼Œå›¾13.1.(a)æ‰€ç¤ºï¼Œç½‘ç»œçš„æ¯ä¸ªé¡¶ç‚¹æŒ‡å®šäº†é«˜åº¦ï¼Œæ ¼å­æ¨¡å‹ç”¨è¿™ç§æ–¹å¼æ˜¾ç¤ºä»å±±è„‰åˆ°æ²³æµçš„å¹³æ»‘è¿‡æ¸¡ã€‚å›¾13.1 (b)ï¼Œæ¨¡æ‹Ÿè‡ªç„¶åœ°å½¢ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ¼‚äº®çš„çº¹ç†è¡¨ç°æ²™çŸ³åœ°ï¼Œç»¿è‰²çš„å±±ä¸˜ã€‚å›¾13.1.(c)é›ªå±±æ•ˆæœã€‚ å›¾ 13.1: (a) ä¸‰è§’ç½‘æ ¼. (b) å¹³æ»‘é«˜åº¦è¿‡æ¸¡çš„ä¸‰è§’ç½‘æ ¼. (c) å…‰å’Œçº¹ç†ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸€ç« èŠ‚ä¸­å†™çš„ä¾‹å­çš„ä¸€ä¸ªå±å¹•æˆªå›¾ã€‚ è¿™ä¸€ç« çš„å†…å®¹æ˜¯å®ç°ä¸€ä¸ªTerrainï¼ˆåœ°å½¢ï¼‰ç±»ã€‚è¿™ä¸ªç±»çš„åŠŸèƒ½å¾ˆå¼ºã€‚æˆ‘ä»¬çš„æ„æ€æ˜¯ï¼Œå®ƒåªæ˜¯å‚¨å­˜æ•´ä¸ªåœ°å½¢çš„é¡¶ç‚¹/ç´¢å¼•æ•°æ®ï¼Œç„¶åæ¸²æŸ“å®ƒã€‚å› ä¸ºå¦‚æœæ¸¸æˆéœ€è¦ä¸€ä¸ªå°çš„åœ°å½¢ï¼Œé‚£ä¹ˆå®ƒèƒ½å¤Ÿåœ¨ç°ä»£å›¾å½¢å¡æ”¯æŒçš„ç¡¬ä»¶é¡¶ç‚¹å¤„ç†ä¸‹å·¥ä½œã€‚ç„¶è€Œå®é™…ä¸Šï¼Œæ¸¸æˆéœ€è¦å¤§é‡çš„åœ°å½¢ï¼Œä½ å¿…é¡»å¯¹ç»†èŠ‚åšæŸç§ï¼ˆçº§åˆ«ï¼‰ç¨‹åº¦çš„æ¡é€‰ï¼Œå› ä¸ºæ¨¡å‹éœ€è¦å¤§é‡çš„å‡ ä½•æ•°æ®ï¼Œè¿™æ ·å¤§çš„åœ°å½¢å¯¹äºå†å¼ºå¤§çš„å¤„ç†æ–¹æ³•ä¹Ÿæ˜¯æ— æ³•å¤„ç†çš„ã€‚ ç›®æ ‡ å­¦ä¹ æ€æ ·ç”Ÿæˆåœ°å½¢çš„é«˜åº¦ä¿¡æ¯ï¼Œå®ƒèƒ½ä½¿å±±ä¸˜ã€æ²³æµç­‰åœ°å¸¦çš„å¹³æ»‘çš„è¿‡åº¦ï¼Œæ¨¡æ‹Ÿè‡ªç„¶ç•Œçš„åœ°å½¢ã€‚ äº†è§£æ€æ ·ç”Ÿæˆåœ°å½¢çš„é¡¶ç‚¹å’Œä¸‰è§’å½¢æ•°æ®ã€‚ å­¦ä¹ ä½¿ç”¨åœ°å½¢çš„çº¹ç†å’Œå…‰ç…§. æ‰¾åˆ°æ§åˆ¶åœ°å½¢ä¸Šç…§ç›¸æœºä½ç½®çš„æ–¹æ³•ï¼Œä»¥ä¾¿æ¨¡æ‹Ÿåœ¨åœ°å½¢ä¸Šèµ°åŠ¨ã€‚ 13.1 Heightmapsï¼ˆé«˜åº¦å›¾ï¼‰ æˆ‘ä»¬ä½¿ç”¨é«˜åº¦å›¾å»æè¿°åœ°å½¢ä¸Šçš„å±±ä¸˜ã€æ²³æµã€‚é«˜åº¦å›¾æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªæˆå‘˜æŒ‡å®šåœ°å½¢é¡¶ç‚¹æè¿°ä¸­çš„é«˜åº¦ä¿¡æ¯ã€‚æˆ‘ä»¬ç»å¸¸æŠŠé«˜åº¦å›¾æƒ³åƒæˆä¸€ä¸ªçŸ©é˜µï¼Œå› ä¸ºæ¯ä¸ªå…ƒç´ éƒ½ä¸€ä¸€å¯¹åº”äºæ¯ä¸ªåœ°å½¢ç½‘æ ¼ä¸­çš„é¡¶ç‚¹ã€‚ å½“æˆ‘ä»¬ä¿å­˜é«˜åº¦å›¾åˆ°ç£ç›˜ä¸Šæ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ºé«˜åº¦å›¾çš„æ¯ä¸ªå…ƒç´ åˆ†é…1ä¸ªbyteçš„å†…å­˜ï¼Œæ‰€ä»¥é«˜åº¦çš„èŒƒå›´æ˜¯0..255ï¼Œ0..255çš„èŒƒå›´å¯¹äºåœ°å½¢çš„é«˜åº¦ä¹‹é—´ä¿æŒå¹³æ»‘è¿‡æ¸¡æ˜¯è¶³å¤Ÿç”¨çš„ã€‚ä½†ä¸ºäº†åœ¨æˆ‘ä»¬çš„ç¨‹åºä¸­åŒ¹é…3Dä¸–ç•Œä¸­çš„ç‰©ä½“ï¼Œå¯èƒ½éœ€è¦çš„èŒƒå›´åœ¨0..255ä»¥å¤–ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨3Dä¸–ç•Œä¸­çš„æµ‹é‡å•ä½æ˜¯è‹±å°ºï¼Œé‚£ä¹ˆ0..255çš„èŒƒå›´å¯¹äºè¡¨ç°ä»»ä½•æœ‰è¶£çš„ä¸œè¥¿æ˜¯ä¸å¤Ÿçš„ã€‚å› æ­¤ï¼Œå½“æˆ‘ä»¬è¯»å–æ•°æ®è¿›åº”ç”¨ç¨‹åºæ—¶ï¼Œç»™æ¯ä¸ªé«˜åº¦å…ƒç´ åˆ†é…ä¸€ä¸ªæ•´å‹æ•°ï¼ˆæˆ–æµ®ç‚¹å‹ï¼‰ï¼Œå®ƒå…è®¸æˆ‘ä»¬å¾ˆå¥½çš„ç¼©æ”¾0..255èŒƒå›´ä¹‹å¤–çš„ä»»ä½•å¤§å°çš„ç‰©å“ã€‚ é«˜åº¦å›¾å›¾å½¢è¡¨ç¤ºæ³•è¿™ä¸€æ˜¯ç°åº¦å›¾(grayscale map)ã€‚è¾ƒé»‘çš„å€¼è¡¨ç¤ºåœ°å½¢ä¸­è¾ƒä½çš„åœ°æ–¹ï¼Œè¾ƒç™½çš„å€¼è¡¨ç°åœ°å½¢ä¸­è¾ƒé«˜çš„åœ°æ–¹ã€‚ å›¾13.2: é«˜åº¦å›¾çš„ç°åº¦å›¾è¡¨ç¤º 13.1.1 åˆ›å»ºé«˜åº¦å›¾ï¼ˆHeightmapï¼‰ é«˜åº¦å›¾ä¸æ˜¯ç”¨ç¨‹åºç”Ÿæˆå°±æ˜¯ç”¨å›¾åƒç¼–è¾‘å™¨ç”Ÿæˆï¼Œæ¯”å¦‚ï¼šAdobe Photoshopã€‚ä½¿ç”¨å›¾åƒç¼–è¾‘å™¨å¤§æ¦‚æ˜¯æœ€å®¹æ˜“çš„æ–¹æ³•äº†ã€‚å½“ä½ æƒ³ç”Ÿæˆåœ°å½¢æ—¶ï¼Œå¯ä»¥äº¤äº’å¼çš„å¯è§†åŒ–çš„åˆ›å»ºã€‚ä½ å¯ä»¥åˆ©ç”¨å›¾åƒç¼–è¾‘å™¨çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼šè¿‡æ»¤å™¨ï¼Œåˆ›å»ºä¸€ä¸ªæœ‰è¶£çš„é«˜åº¦å›¾ï¼Œå›¾13.3æ˜¾ç¤ºäº†ä¸€ä¸ªç”¨Adobe Photoshopå›¾åƒç¼–è¾‘å™¨çš„å·¥å…·åˆ›å»ºçš„é‡‘å­—å¡”å½¢çš„é«˜åº¦å›¾ã€‚æ³¨æ„ï¼šå½“åˆ›å»ºå›¾åƒæ—¶æˆ‘ä»¬æŒ‡å®šä¸€ä¸ªç°åº¦å›¾ç±»å‹ã€‚ å›¾13.3 ä¸€å¹…ç”¨Adobe Photoshopåˆ›å»ºçš„ç°åº¦å›¾ ä¸€ä½†ä½ ç”»å®Œäº†ä½ çš„é«˜åº¦å›¾ï¼Œä½ å¿…é¡»å°†å®ƒä¿å­˜ä¸ºä¸€ä¸ª8bitçš„RAWæ–‡ä»¶ã€‚RAWæ–‡ä»¶åªå›¾åƒçš„é€ä¸ªå­—èŠ‚ã€‚æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå¯ä»¥éå¸¸å®¹æ˜“çš„è¯»è¿™æ ·çš„å›¾åƒã€‚ä½ çš„è½¯ä»¶å¯èƒ½å‘Šè¯‰ä½ ä¿å­˜çš„RAWæ–‡ä»¶æ˜¯æœ‰æ–‡ä»¶å¤´çš„è¿˜æ˜¯æ²¡æœ‰æ–‡ä»¶å¤´çš„ã€‚ æ³¨æ„ï¼šç”¨RAWæ ¼å¼ä¿å­˜é«˜åº¦ä¿¡æ¯ä¸æ˜¯å¿…é¡»çš„ï¼›ä½ å¯ä»¥ç”¨ç¬¦åˆä½ éœ€è¦çš„ä»»ä½•æ ¼å¼ã€‚RAWæ ¼å¼æ˜¯æˆ‘ä»¬èƒ½ä½¿ç”¨çš„çš„æ ¼å¼ä¹‹ä¸€ã€‚æˆ‘å†³å®šä½¿ç”¨RAWæ ¼å¼æ˜¯å› ä¸ºå¾ˆå¤šæµè¡Œçš„å›¾åƒç¼–è¾‘å™¨æ”¯æŒå¯¼å‡ºè¿™ç§æ ¼å¼ï¼Œè€Œä¸”åº”ç”¨ç¨‹åºè¯»å–RAWæ–‡ä»¶çš„æ•°æ®éå¸¸ç®€å•ã€‚è¿™ç« ä¸­æœ‰ä½¿ç”¨8-bit RAWæ–‡ä»¶çš„ä¾‹å­ã€‚ 13.1.2 è¯»å–RAWæ–‡ä»¶ RAWæ–‡ä»¶ä¸ä¸€æ®µè¿ç»­çš„bitå†…å­˜å—æ²¡ä»€ä¹ˆåˆ†åˆ«ã€‚æˆ‘ä»¬èƒ½ç”¨å¾ˆç®€å•çš„æ–¹æ³•è¯»å–è¿™æ®µå†…å­˜å—ï¼Œæ³¨æ„ï¼šå˜é‡_heightmapæ˜¯Terrainç±»çš„ä¸€ä¸ªæˆå‘˜ï¼Œå®šä¹‰å¦‚ä¸‹ ï¼šstd::vector _heightmap;bool Terrain::readRawFile(std::string fileName){ // A height for each vertex std::vector in( numVertices ); std::ifstream inFile(fileName.c_str(), std::ios_base::binary); if( inFile == 0 ) return false; inFile.read( (char*)&amp;in[0], // buffer in.size());// number of bytes to read into buffer inFile.close(); // copy BYTE vector to int vector _heightmap.resize( _numVertices ); for(int i = 0; i &lt; in.size(); i++) _heightmap[i] = in[i]; return true; }æˆ‘ä»¬COPYä¸€ä¸ªbyteså‘é‡åˆ°ä¸€ä¸ªæ•´å½¢å‘é‡ï¼Œè¿™æ ·åšæˆ‘ä»¬èƒ½å¤Ÿç¼©æ”¾ [0,255]ä»¥å¤–çš„é«˜åº¦ã€‚è¿™ä¸ªæ–¹æ³•å”¯ä¸€é™åˆ¶æ˜¯ï¼šRAWæ–‡ä»¶å¿…é¡»è¯»å…¥è‡³å°‘ä¸åœ°å½¢çš„é¡¶ç‚¹æ•°ä¸€æ ·å¤šçš„é«˜åº¦ä¿¡æ¯ã€‚å› æ­¤ï¼Œå¦‚æœä½ è¯»å–ä¸€ä¸ª256x256 çš„RAWæ–‡ä»¶ï¼Œä½ çš„åœ°å½¢ä¹Ÿå¿…é¡»åŒ…å«256x256ä¸ªé¡¶ç‚¹ã€‚ 13.1.3 è®¿é—®ä¸ä¿®æ”¹Heightmap Terrainç±»æä¾›ä»¥ä¸‹2ä¸ªæ–¹æ³•è®¿é—®å’Œä¿®æ”¹Heightmapçš„å…¥å£ã€‚int Terrain::getHeightmapEntry(int row, int col){ return _heightmap[row * _numVertsPerRow + col];} void Terrain::setHeightmapEntry(int row, int col, int value){ _heightmap[row * _numVertsPerRow + col] = value;} è¿™äº›æ–¹æ³•å…è®¸æˆ‘ä»¬ä»¥è¡Œå’Œåˆ—æ¥è®¿é—®å…¥å£ï¼Œå¹¶ä¸”éšè—æ–¹æ³•ã€‚å½“ä½¿ç”¨å®ƒå»æè¿°çŸ©é˜µæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»å°†ä¸€ä¸ªçº¿æ€§æ•°ç»„ç¼–å…¥ç´¢å¼•ã€‚ï¼ˆThese methods allow us to refer to an entry by row and column and hide the way we must index a linear array when using it to describe a matrixï¼‰ 13.2 ç”Ÿæˆåœ°å½¢å‡ ä½•æ•°æ® å›¾13.4æ˜¾ç¤ºTerrainç±»çš„ä¸€äº›å±æ€§ã€è¯æ±‡å’Œæˆ‘ä»¬æåˆ°çš„ä¸€äº›å…³é”®ç‚¹ã€‚æˆ‘ä»¬å®šä¹‰åœ°å½¢çš„å¤§å°ï¼ŒæŒ‡å®šæ¯è¡Œã€æ¯åˆ—é¡¶ç‚¹çš„æ•°é‡ï¼Œå’Œå•å…ƒçš„é—´éš”ã€‚ä¼ é€’è¿™äº›å€¼åˆ°Terrainç±»çš„æ„é€ å™¨ä¸­ã€‚å¦å¤–ï¼Œä¹Ÿä¼ é€’åœ°å½¢æ‰€å…³è”çš„è®¾å¤‡ï¼Œä¸€ä¸ªåŒ…å«é«˜åº¦å›¾æ•°æ®çš„å­—ç¬¦ä¸²æ–‡ä»¶åï¼Œä¸€ä¸ªç”¨æ¥ç¼©æ”¾é«˜åº¦å›¾æˆå‘˜çš„é«˜åº¦ç¼©æ”¾å€¼ã€‚ å›¾13.4ï¼šä¸‰è§’å½¢ç½‘ç»œçš„å±æ€§ï¼Œå»¶ç€æ–¹æ ¼çº¿ä¸Šçš„ç‚¹æ˜¯åœ°å½¢çš„é¡¶ç‚¹ã€‚ class Terrain{public: Terrain( IDirect3DDevice9* device, std::string heightmapFileName, int numVertsPerRow, int numVertsPerCol, int cellSpacing, // space between cells float heightScale); // value to scale heights by ... methods snipped private: â€¦device/vertex buffer etc snipped int _numVertsPerRow; int _numVertsPerCol; int _cellSpacing; int _numCellsPerRow; int _numCellsPerCol; int _width; int _depth; int _numVertices; int _numTriangles; float _heightScale; };Terrainç±»å®šä¹‰çš„å…¨éƒ¨çš„æºä»£ç ï¼Œå®åœ¨æ˜¯å¤ªå¤šäº†ï¼Œæ— æ³•åœ¨è¿™é‡Œå…¨éƒ¨åŒ…å«è¿›æ¥ã€‚æ ¹æ®ä¼ é€’ç»™æ„é€ å™¨çš„å€¼ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè®¡ç®—Terrainç±»çš„å…¶ä»–å˜é‡ï¼š123456_numCellsPerRow = _numVertsPerRow - 1;_numCellsPerCol = _numVertsPerCol - 1;_width = _numCellsPerRow * _cellSpacing;_depth = _numCellsPerCol * _cellSpacing;_numVertices = _numVertsPerRow * _numVertsPerCol;_numTriangles = _numCellsPerRow * _numCellsPerCol * 2; Terrainç±»å®šä¹‰çš„é¡¶ç‚¹ç»“æ„ï¼š123456789101112struct TerrainVertex&#123; TerrainVertex()&#123;&#125; TerrainVertex(float x, float y, float z, float u, float v) &#123; _x = x; _y = y; _z = z; _u = u; _v = v; &#125; float _x, _y, _z; float _u, _v; static const DWORD FVF;&#125;; æ³¨æ„ï¼šTerrainVertexæ˜¯Terrainç±»å†…éƒ¨çš„ä¸€ä¸ªåµŒå¥—ç±»ï¼ˆè¯‘è€…ï¼šçœ‹æ ·å­æ˜¯ç»“æ„å•Šï¼Ÿï¼‰ï¼Œä¹‹æ‰€ä»¥è¿™ä¹ˆåšï¼Œæ˜¯å› ä¸ºå®ƒåœ¨Terrainç±»å¤–éƒ¨åŸºæœ¬æ²¡æœ‰ä»€ä¹ˆç”¨å¤„ã€‚13.2.1 è®¡ç®—é¡¶ç‚¹ åœ¨å›¾13.4ä¸­ï¼Œè®¡ç®—ä¸‰è§’å½¢ç½‘æ ¼ä¸Šçš„é¡¶ç‚¹ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨å¼€å§‹äº§ç”Ÿé¡¶ç‚¹çš„åœ°æ–¹ï¼Œä¸€è¡Œä¸€è¡Œçš„ç”Ÿæˆé¡¶ç‚¹æ•°æ®ï¼Œç›´åˆ°ç»“æŸä¸ºæ­¢ã€‚å•å…ƒæ ¼çš„é¡¶ç‚¹ä¸é¡¶ç‚¹ä¹‹é—´æœ‰ä¸€å—ç©ºç™½åŒºåŸŸï¼Œè¿™ä¼šè®©æˆ‘ä»¬å–å¾—xã€zåæ ‡ï¼Œä½†yåæ ‡æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¾—åˆ°yåæ ‡å¾ˆå®¹æ˜“ï¼Œå½“è¯»å–é«˜åº¦å›¾æ•°æ®ç»“æ„æ—¶ä¼šæ‰¾åˆ°å¯¹åº”çš„å…¥å£ã€‚ æ³¨æ„ï¼šè¿™ä¸ªæ“ä½œä½¿ç”¨ä¸€ä¸ªå·¨å¤§çš„é¡¶ç‚¹ç¼“å­˜å»ä¿å­˜æ‰€æœ‰åœ°å½¢ä¸Šçš„æ‰€æœ‰é¡¶ç‚¹ã€‚è¿™å¯èƒ½ä¼šå¼•èµ·ç¡¬ä»¶å±€é™æ€§çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼šä¸€ä¸ªåŸå§‹è®¡æ•°ç•Œé™çš„æœ€å¤§å€¼å’Œ3Dè®¾å¤‡è®¾å®šçš„æœ€å¤§çš„é¡¶ç‚¹ç´¢å¼•ç•Œé™ã€‚æ£€æŸ¥MaxPrimitiveCountå’ŒD3DCAPS9ç»“æ„çš„MaxVertexlndexæˆå‘˜ï¼ŒæŸ¥çœ‹ä½ çš„è®¾å¤‡çš„é™å®šå€¼ï¼Œåœ¨13.7èŠ‚è®¨è®ºï¼Œä½¿ç”¨é¡¶ç‚¹ç¼“å­˜æ—¶å­˜åœ¨é—®é¢˜å’Œè§£å†³æ–¹æ³•ã€‚ è®¡ç®—çº¹ç†åæ ‡ï¼Œçœ‹å›¾13.5ï¼Œç»™æˆ‘ä»¬ä¸€ä¸ªç®€å•çš„è®¾å®šï¼Œå…è®¸æˆ‘ä»¬ç”¨(u, v)çº¹ç†åæ ‡å»å¯¹åº”åœ°å½¢é¡¶ç‚¹åæ ‡ã€‚ å›¾13.5ï¼šåœ°å½¢é¡¶ç‚¹ä¸çº¹ç†é¡¶ç‚¹ä¹‹é—´ä¸€ä¸€å¯¹åº”ã€‚ u = j uCoordIncrementSize v = i vCoordIncrementSize And where: æœ€åï¼Œç”¨ä»£ç ç”Ÿæˆé¡¶ç‚¹ï¼šbool Terrain::computeVertices(){ HRESULT hr = 0; hr = _device-&gt;CreateVertexBuffer( _numVertices * sizeof(TerrainVertex), D3DUSAGE_WRITEONLY, TerrainVertex::FVF, D3DPOOL_MANAGED, &amp;_vb, 0); if(FAILED(hr)) return false; // å¯¹åº”ç¬¬ä¸€ä¸ªç”Ÿæˆçš„é¡¶ç‚¹åæ ‡ int startX = -_width / 2; int startZ = _depth / 2; // å¯¹åº”æœ€åä¸€ä¸ªç”Ÿæˆçš„é¡¶ç‚¹åæ ‡ int endX = _width / 2; int endZ = -_depth / 2; // compute the increment size of the texture coordinates // from one vertex to the next. float uCoordIncrementSize = 1.0f / (float)_numCellsPerRow; float vCoordIncrementSize = 1.0f / (float)_numCellsPerCol; TerrainVertex* v = 0; _vb-&gt;Lock(0, 0, (void**)&amp;v, 0); int i = 0; for(int z = startZ; z &gt;= endZ; z -= _cellSpacing) { int j = 0; for(int x = startX; x &lt;= endX; x += _cellSpacing) { // compute the correct index into the vertex buffer // and heightmap based on where we are in the nested // loop. int index = i * _numVertsPerRow + j; v[index] = TerrainVertex( (float)x, (float)_heightmap[index], (float)z, (float)j * uCoordIncrementSize, (float)i * vCoordIncrementSize); j++; // next column } i++; // next row } _vb-&gt;Unlock(); return true; } 13.2.2 è®¡ç®—ç´¢å¼•-å®šä¹‰ä¸‰è§’å½¢ è®¡ç®—ä¸‰è§’å½¢ç½‘æ ¼çš„ç´¢å¼•ï¼Œåªéœ€è¦å¾ªç¯è®¿é—®æ¯ä¸€ä¸ªæ ¼å­ï¼Œä»å·¦ä¸Šåˆ°å³ä¸‹ï¼Œå¦‚å›¾13.4ï¼Œå¹¶ä¸”è®¡ç®—ç»„æˆæ ¼å­çš„2ä¸ªä¸‰è§’å½¢ã€‚ è¿™é‡Œçš„æŠ€å·§æ˜¯ï¼šæå–å‡ºè®¡ç®—ç¬¬ijæ ¼å­çš„2ä¸ªä¸‰è§’å½¢çš„å…¬å¼ã€‚ç”¨å›¾13.6å»æ¨å¯¼å…¬å¼ï¼Œæ‰¾åˆ°ç¬¬ijçš„æ ¼å­ï¼š ?ABC = {i Â· numVertsPerRow + j iÂ·numVertsPerRow + j + 1 (i + 1). numVertsPerRow + j}?CBD = {(i + 1) numVertsPerRow + j iÂ·numVertsPerRow + j + 1 (iÂ·l) numVertsPerRow + j + 1} å›¾13.6 æ–¹æ ¼çš„é¡¶ç‚¹ ä»£ç ç”Ÿæˆç´¢å¼•ï¼šbool Terrain::computeIndices(){ HRESULT hr = 0; hr = _device-&gt;CreateIndexBuffer( _numTriangles * 3 * sizeof(WORD), // æ¯ä¸ªä¸‰è§’å½¢æœ‰3ä¸ªç´¢å¼• D3DUSAGE_WRITEONLY, D3DFMT_INDEX16, D3DPOOL_MANAGED, &amp;_ib, 0); if(FAILED(hr)) return false; WORD* indices = 0; _ib-&gt;Lock(0, 0, (void**)&amp;indices, 0); // å°†ç»„æˆä¸€ä¸ªæ–¹æ ¼çš„2ä¸ªä¸‰è§’å½¢çš„ä¸€ç»„6ä¸ªç´¢å¼•çš„å¼€å§‹ä½ç½®ç¼–å…¥ç´¢å¼• int baseIndex = 0; // ä»å¤´åˆ°å°¾è®¡ç®—æ¯ä¸€ä¸ªæ ¼å­ä¸­çš„ä¸‰è§’å½¢ for(int i = 0; i &lt; _numCellsPerCol; i++) //è¡Œå¾ªç¯ { for(int j = 0; j &lt; _numCellsPerRow; j++) //åˆ—å¾ªç¯ { indices[baseIndex] = i * _numVertsPerRow + j; indices[baseIndex + 1] = i * _numVertsPerRow + j + 1; indices[baseIndex + 2] = (i+1) * _numVertsPerRow + j; indices[baseIndex + 3] = (i+1) * _numVertsPerRow + j; indices[baseIndex + 4] = i * _numVertsPerRow + j + 1; indices[baseIndex + 5] = (i+1) * _numVertsPerRow + j + 1; // next quad baseIndex += 6; } } _ib-&gt;Unlock(); return true; }; çº¹ç†Terrainç±»æä¾›2ä¸ªæ–¹æ³•å»å¤„ç†åœ°å½¢çš„çº¹ç†ã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯ç®€å•åœ°è¯»å–ä¸€ä¸ªå·²ç»åˆ¶ä½œå¥½çš„çº¹ç†æ–‡ä»¶å¹¶ä½¿ç”¨å®ƒï¼Œä¸‹é¢çš„æ–¹æ³•ä½¿ç”¨Terrainç±»å®ç°å°†ä¸€ä¸ªæ–‡ä»¶è¯»å–çº¹ç†åˆ°_texæˆå‘˜ä¸­ï¼Œç„¶åæŒ‡å‘ä¸€ä¸ªIDirect3DTexture9æ¥å£çš„æŒ‡é’ˆã€‚å…³é”®æ˜¯ï¼Œåœ¨åœ°å½¢æ¸²æŸ“ä¹‹å‰å…ˆç”¨Terrain: :drawæ–¹æ³•è®¾ç½®_texã€‚12345678910111213bool Terrain::loadTexture(std::string fileName)&#123; HRESULT hr = 0; hr = D3DXCreateTextureFromFile( _device, fileName.c_str(), &amp;_tex); if(FAILED(hr)) return false; return true;&#125; 13.3.1 ç¨‹åºä¸Šçš„å¤„ç†æ–¹æ³• ä¸€ä¸ªå¯é€‰æ‹©çš„æ–¹æ³•æ˜¯ç”¨ç¨‹åºè®¡ç®—åœ°å½¢çš„çº¹ç†ï¼Œå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç©ºçº¹ç†ï¼Œæ ¹æ®å®šä¹‰çš„å‚æ•°ç”¨ä»£ç è®¡ç®—æ¯ä¸€ä¸ªéƒ¨åˆ†çš„é¢œè‰²ï¼Œåœ¨ä¾‹å­ä¸­ï¼Œå‚æ•°æ˜¯åœ°å½¢çš„é«˜åº¦ã€‚ æˆ‘ä»¬ç”¨Terrain::genTextureæ–¹æ³•ç”¨ç¨‹åºå»ç”Ÿæˆçº¹ç†ï¼Œé¦–å…ˆç”¨D3DXCreateTextureæ–¹æ³•åˆ›å»ºä¸€ä¸ªç©ºçš„çº¹ç†ï¼Œé”å®šé«˜åº¦çº§åˆ«ï¼ˆtop levelï¼Œçº¹ç†å›¾çš„ä¸€ä¸ªæˆå‘˜ï¼Œæœ‰å¤šä¸ªçº§åˆ«ï¼‰ï¼Œä¸æ–­çš„å¾ªç¯æ¯ä¸€ä¸ªtexelï¼ˆå›¾ç´ ï¼‰å¹¶ç»™å®ƒä¸Šè‰²ï¼Œtexelçš„é¢œè‰²å–å†³äºä¸æ–¹æ ¼å¯¹åº”çš„é«˜åº¦ï¼ˆè¿‘ä¼¼é«˜åº¦ï¼‰ã€‚æˆ‘ä»¬çš„æƒ³æ³•æ˜¯ï¼šåœ°å½¢ä¸­è¾ƒä½çš„åœ°æ–¹æ˜¯æ²™æ»©è‰²ï¼Œä¸­é—´çš„åœ°æ–¹åƒæ˜¯ç»¿è‰²çš„å°å±±ä¸˜ï¼Œè¾ƒé«˜çš„åœ°æ–¹é¢œè‰²å¥½åƒé›ªå±±ã€‚æˆ‘ä»¬å®šä¹‰çš„é«˜åº¦æ˜¯æ–¹æ ¼ä¸­å·¦ä¸Šè§’çš„è¿‘ä¼¼é«˜åº¦ã€‚ ä¸€æ—¦æ¯ä¸ªtexeléƒ½æœ‰äº†é¢œè‰²ï¼Œæˆ‘ä»¬æƒ³è®©æ¯ä¸€ä¸ªtexelå˜æš—æˆ–æ˜¯å˜äº®ï¼Œè¿™åŸºäºå…‰æ‰“åœ¨æ ¼å­ä¸­å¯¹åº”çš„texelä¸Šçš„è§’åº¦ï¼Œç”±Terrain::lightTerrainæ–¹æ³•å®ç°ã€‚ï¼ˆOnce we have a color for each texel, we want to darken or brighten each texel based on the angle at which sunlight (modeled by a directional light) strikes the cell to which the texel corresponds. This is done in the Terrain::lightTerrain methodï¼‰ Terrain::genTextureæ–¹æ³•é€šè¿‡è®¡ç®—lower mipmapçº§åˆ«çš„texelsæ¥å¾—å‡ºç»“è®ºï¼Œå®ƒæ˜¯é€šè¿‡D3DXFilterTextureå‡½æ•°å®ç°ã€‚ç”¨ä»£ç ç”Ÿæˆçº¹ç†ï¼šbool Terrain::genTexture(D3DXVECTOR3* directionToLight){ // Method fills the top surface of a texture procedurally. Then // lights the top surface. Finally, it fills the other mipmap // surfaces based on the top surface data using // D3DXFilterTexture. HRESULT hr = 0; // texel for each quad cell int texWidth = _numCellsPerRow; int texHeight = _numCellsPerCol; // create an empty texture hr = D3DXCreateTexture( _device, texWidth, texHeight, // dimensions 0, // create a complete mipmap chain 0, // usage - none D3DFMT_X8R8G8B8, // 32-bit XRGB format D3DPOOL_MANAGED, // memory pool &amp;_tex); if(FAILED(hr)) return false; D3DSURFACE DESC textureDesc; _tex-&gt;GetLevelDesc(0 /*level*/, &amp;textureDesc); // make sure we got the requested format because our code // that fills the texture is hard coded to a 32-bit pixel depth. if( textureDesc.Format != D3DFMT_X8R8G8B8 ) return false; D3DLOCKED_RECT lockedRect; _tex-&gt;LockRect(0/*lock top surface*/, &amp;lockedRect, 0 /* lock entire tex*/, 0/*flags*/); // fill the texture DWORD* imageData = (DWORD*)lockedRect.pBits; for(int i = 0; i &lt; texHeight; i++) { for(int j = 0; j &lt; texWidth; j++) { D3DXCOLOR c; // get height of upper-left vertex of quad. float height = (float)getHeightmapEntry(i, j)/_heightScale; // set the color of the texel based on the height // of the quad it corresponds to. if( (height) &lt; 42.5f ) c = d3d::BEACH SAND; else if( (height) &lt; 85.0f ) c = d3d::LIGHT YELLOW GREEN; else if( (height) &lt; 127.5f ) c = d3d::PUREGREEN; else if( (height) &lt; 170.0f ) c = d3d::DARK YELLOW GREEN; else if( (height) &lt; 212.5f ) c = d3d::DARKBROWN; else c = d3d::WHITE; // fill locked data, note we divide the pitch by four // because the pitch is given in bytes and there are // 4 bytes per DWORD. imageData[i * lockedRect.Pitch / 4 + j] = (D3DCOLOR)c; } } _tex-&gt;UnlockRect(0); // light the terrain if(!lightTerrain(directionToLight)) { ::MessageBox(0, &quot;lightTerrain() - FAILED&quot;, 0, 0); return false; } // fill mipmaps hr = D3DXFilterTexture( _tex,// texture to fill mipmap levels 0, // default palette 0, // use top level as source for lower levels D3DX_DEFAULT); // default filter if (FAILED (hr)) { ::MessageBox(0, &quot;D3DXFilterTexture() - FAILED&quot;, 0, 0); return false; } return true; } æ³¨æ„ï¼šé¢œè‰²å¸¸é‡BEACH_SANDç­‰å®šä¹‰åœ¨d3dUtility.h.æ–‡ä»¶ä¸­ã€‚ 13.4 å…‰ç…§ Terrain::genTextureæ–¹æ³•ä¼šè°ƒç”¨Terrain::lightTerrainï¼Œé¡¾åæ€ä¹‰ï¼Œå…‰ç…§ä½¿åœ°å½¢æ›´æ¥è¿‘äºç°å®ã€‚å½“æˆ‘ä»¬å·²ç»è®¡ç®—å®Œåœ°å½¢çº¹ç†ä»¥åï¼Œæˆ‘ä»¬åªéœ€è¦è®¡ç®—é˜´å½±ç³»æ•°ï¼ˆshade factorï¼‰ï¼Œä½¿ä¸€ä¸ªå®šä¹‰äº†å…‰æºçš„åœ°å½¢åŒºåŸŸå˜äº®æˆ–å˜æš—ã€‚åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ£€éªŒè¿™æ ·ä¸€ä¸ªæŠ€å·§ï¼Œä½ ä¼šæƒŠè®¶äºä¸ºä»€ä¹ˆæˆ‘ä»¬ç…§äº®åœ°å›¾å´æ²¡æœ‰è®©Direct3Dæ¥åšã€‚æˆ‘ä»¬è‡ªå·±æ¥è®¡ç®—æœ‰ä¸‰ä¸ªå¥½å¤„ï¼š å†…å­˜ä¸­ä¸å¿…ä¿å­˜é¡¶ç‚¹æ³•çº¿ã€‚ å› ä¸ºçº¹ç†æ˜¯é™æ€çš„ï¼Œæ‰€ä»¥ä¸èƒ½éšæ„çš„ç§»åŠ¨å…‰æºã€‚è™½ç„¶æˆ‘ä»¬å¯ä»¥é‡æ–°è®¡ç®—å…‰æºï¼Œä½†å› æ­¤é‡‡ç”¨Direct3Då®æ—¶çš„ç…§äº®åœ°å½¢æ˜¯å¾ˆè€—æ—¶çš„ã€‚ æˆ‘ä»¬è·å¾—äº†ä¸€äº›æ•°å­¦ä¸Šçš„ç»éªŒï¼Œç†Ÿæ‚‰äº†ä¸€äº›åŸºæœ¬çš„å…‰ç…§æ¦‚å¿µï¼Œå¹¶ä¸”æ˜¯ç”¨Direct3Då‡½æ•°å®è·µçš„ã€‚ 13.4.1æ¦‚è§ˆ(OVERVIEW) å…‰ç…§æ˜¯è®¡ç®—åœ°å½¢é˜´å½±ï¼ˆshadeï¼‰çš„ä¸€ä¸ªæœ€åŸºæœ¬çš„æŠ€å·§ä¹‹ä¸€ï¼Œä¸€èˆ¬è®¤ä¸ºçš„å…‰æ˜¯æ¼«å°„å…‰ï¼ˆdiffuse lightingï¼‰ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå¹³è¡Œå…‰æºï¼ŒæŒ‡å®šå…‰çš„æ–¹å‘ï¼Œå»¶ç€å…‰çº¿çš„ç›¸åæ–¹å‘æ˜¯æ•£å‘å¹³è¡Œå…‰çš„å…‰æºã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è®©å…‰çº¿ä»ç©ºä¸­ç¬”ç›´è½ä¸‹ï¼Œé‚£ä¹ˆlightRaysDirection = (0, -1, 0)ï¼ŒæŒ‰ç›¸åçš„æ–¹å‘ï¼šdirectionToLight = (0, 1, 0)ã€‚æ³¨æ„ï¼šåˆ›å»ºå…‰ç…§å‘é‡è¦ä½¿ç”¨å•ä½å‘é‡ã€‚ æ³¨æ„ï¼šè™½ç„¶æŒ‡å®šæ–¹å‘çš„å…‰æ˜¯ä»å…‰æºå‘å°„å‡ºæ¥çš„ï¼Œè¿™ä¹ˆè¯´æ›´ç›´æ¥ä¸€ç‚¹ï¼ŒæŒ‡å®šæ–¹å‘çš„å…‰åœ¨è®¡ç®—ä¸Šè¦æ¯”æ¼«è°¢å…‰æ›´åˆå¾—æ¥ã€‚ å¯¹äºåœ°å½¢ä¸­çš„æ¯ä¸ªæ–¹æ ¼ï¼Œæˆ‘ä»¬è®¡ç®—å…‰çš„å‘é‡ä¸æ–¹æ ¼çš„é¢æ³•çº¿ä¹‹é—´çš„è§’åº¦ã€‚ åœ¨å›¾13.7ä¸­æˆ‘ä»¬çœ‹åˆ°ï¼Œå½“è§’åº¦å˜å¾—æ¯”è¾ƒå¤§æ—¶ï¼Œæ–¹æ ¼çš„é¢ç¦»å…‰æºè¶Šæ¥è¶Šè¿œï¼Œæ¥æ”¶çš„å…‰è¶Šå°‘ã€‚åè¿‡æ¥è¯´ï¼Œè§’åº¦å˜å°ï¼Œæ–¹æ ¼çš„é¢åˆ™ç¦»å…‰æºè¶Šæ¥è¶Šè¿‘ï¼Œç›¸åº”çš„ä¼šæ¥æ”¶æ›´å¤šçš„å…‰ã€‚æ³¨æ„ï¼šä¸€æ—¦å…‰å‘é‡ä¸æ³•çº¿è§’åº¦å¤§äº90åº¦ï¼Œè¡¨é¢å°±æ¥æ”¶ä¸åˆ°å…‰ã€‚ å›¾13.7 å…‰å‘é‡ä¸å¹³é¢æ³•çº¿çš„å…³ç³»ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ›å»ºä¸€ä¸ªé˜´å½±ï¼ˆshadingï¼‰ æ ‡é‡ï¼Œç”¨0..1ä¹‹é—´çš„èŒƒå›´æ¥è¡¨ç¤ºè¡¨é¢èƒ½æ¥æ”¶åˆ°å…‰çš„å¤šå°‘ã€‚ä½¿ç”¨é˜´å½±æ ‡é‡ï¼Œè§’åº¦å¤§åˆ™æ ‡é‡æ¥è¿‘äº0ã€‚å½“é¢œè‰²ä¸ä¸€ä¸ªé˜´å½±æ ‡é‡æ¥è¿‘0çš„å€¼ç›¸ä¹˜æ—¶ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯ï¼šé¢œè‰²å˜æš—ã€‚ç›¸åï¼Œä¹˜ä»¥ä¸€ä¸ªé˜´å½±æ ‡é‡çš„å€¼æ¥è¿‘1çš„å€¼æ—¶ï¼Œé¢œè‰²åˆ™æ¥è¿‘äºåŸå§‹äº®åº¦ã€‚ 13.4.2 è®¡ç®—æ–¹æ ¼çš„é˜´å½±ï¼ˆShadeï¼‰ å…‰æºçš„æ–¹å‘æ˜¯ä¸€ä¸ªå•ä½å‘é‡ï¼Œä¸ºäº†è®¡ç®—å…‰æºæ–¹å‘ä¸é¢æ³•çº¿é—´çš„å¤¹è§’ï¼Œé¦–å…ˆéœ€è¦æ‰¾åˆ°é¢æ³•çº¿ï¼Œè¿™æ˜¯å‰ç§¯çš„ä¸€å°éƒ¨åˆ†åº”ç”¨ï¼Œä½†é¦–å…ˆå¿…é¡»åœ¨æ–¹æ ¼é‡Œæ‰¾åˆ°äºŒä¸ªå…±é¢çš„é0å¹¶ä¸”ä¸å¹³è¡Œçš„å‘é‡ã€‚çœ‹å›¾ 13.8æœ‰ä¸¤ä¸ªè¿™æ ·çš„å‘é‡ï¼š å›¾13.8: è®¡ç®—åœ¨åŒä¸€æ–¹æ ¼ä¸­çš„å…±é¢çš„äºŒä¸ªå‘é‡ u = (cellSpacing, by - ay, 0)v = (0, cy, -ay, -cellSpacing) å…³äºuå’Œvï¼Œæ–¹æ ¼çš„æ³•çº¿N = u Ã— vï¼Œå½“ç„¶è¦æŠŠNæ ‡å‡†åŒ–ï¼š æ‰¾åˆ°å…‰çº¿ä¸æ³•çº¿çš„å¤¹è§’ï¼Œå›å¿†ä¸€ä¸‹ç‚¹ç§¯ï¼Œæ˜¯äºŒä¸ª3ç»´ç©ºé—´ä¸­çš„å•ä½å‘é‡ç»„æˆçš„å¤¹è§’çš„ä½™å¼¦ã€‚ å®ƒçš„æ ‡é‡æ˜¯åœ¨-1..1çš„èŒƒå›´ï¼Œå› ä¸º-1..0çš„sinå€¼ç¬¦åˆå¤¹è§’è§’åº¦ä¸”å¤§äº90åº¦ï¼Œåœ¨å›¾13.7ä¸­æ¥å—ä¸åˆ°å…‰ç…§ï¼Œå¦‚æœå®ƒåœ¨-1..0ä¹‹é—´é‚£ä¹ˆå¤¹è§’æ˜¯0åº¦ã€‚float cosine = D3DXVec3Dot(&amp;n, directionToLight); if(cosine &lt; 0.0f) cosine = 0.0f; ç°åœ¨sçš„å¤¹è§’å¤§äº90åº¦ï¼Œsçš„é˜´å½±æ ‡é‡å°†åœ¨0..1ä¹‹é—´ã€‚å› ä¸ºå…‰çº¿ä¸æ³•çº¿çš„è§’åº¦ä»0å¢åŠ åˆ°90åº¦æ—¶ï¼Œsçš„å€¼å°†ä»1åˆ°é™åˆ°0ã€‚è¿™æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œå…·ä½“è®²è§£è¯·çœ‹13.4.1èŠ‚ã€‚ ç»™æŒ‡å®šçš„æ ¼å­è®¡ç®—é˜´å½±ç³»æ•°ç”¨Terrain::computeShadeæ–¹æ³•ï¼Œå®ƒéœ€è¦å‚æ•°ï¼šè¡Œå’Œåˆ—æ¥ç¡®å®šæ–¹æ ¼ï¼Œè¿˜æœ‰å¹³è¡Œæ–¹å‘å…‰çš„å…‰æºã€‚float Terrain::computeShade(int cellRow, int cellCol, D3DXVECTOR3* directionToLight){ // å–å¾—æ–¹æ ¼ä¸­ä¸‰ä¸ªé¡¶ç‚¹çš„é«˜åº¦ï¼ˆä»é«˜åº¦å›¾ä¸­ï¼‰ float heightA = getHeightmapEntry(cellRow, cellCol); float heightB = getHeightmapEntry(cellRow, cellCol+1); float heightC = getHeightmapEntry(cellRow+1, cellCol); // åˆ›å»ºæ–¹æ ¼ä¸­çš„äºŒä¸ªé¡¶ç‚¹ D3DXVECTOR3 u( cellSpacing, heightB - heightA, 0.0f); D3DXVECTOR3 v(0.0f, heightC - heightA, - cellSpacing); //ç”¨æ–¹æ ¼ä¸­çš„äºŒä¸ªå‘é‡çš„å‰ç§¯æ‰¾åˆ°é¢æ³•çº¿ D3DXVECTOR3 n; D3DXVec3Cross(&amp;n, &amp;u, &amp;v); D3DXVec3Normalize(&amp;n, &amp;n); float cosine = D3DXVec3Dot(&amp;n, directionToLight); if(cosine &lt; 0.0f) cosine = 0.0f; return cosine; } 13.4.3 åœ°å½¢é˜´å½±ï¼ˆShadingï¼‰ ä¸€æ—¦çŸ¥é“äº†å¦‚ä½•ç»™æŒ‡å®šçš„æ–¹æ ¼åŠ é˜´å½±ï¼Œæˆ‘ä»¬å°±èƒ½ç»™åœ°å½¢ä¸Šæ‰€æœ‰çš„æ–¹æ ¼åŠ é˜´å½±ã€‚åªè¦éä¾‹æ¯ä¸€ä¸ªæ–¹æ ¼ï¼Œè®¡ç®—æ–¹æ ¼çš„é˜´å½±å€¼ï¼Œå¹¶æµ‹é‡æ–¹æ ¼å¯¹åº”çš„texelé¢œè‰²ã€‚å…‰ç…§å°‘åˆ™æ–¹æ ¼ä¼šå˜æš—ã€‚ä¸‹é¢ä¸€æ®µä»£ç å±•ç¤ºäº†Terrain::lightTerrainæ–¹æ³•çš„é‡è¦éƒ¨åˆ†ï¼š DWORD imageData = (DWORD)lockedRect.pBits;for(int i = 0; i &lt; textureDesc.Height; i++){ for(int j = 0; j &lt; textureDesc.Width; j++) { int index = i * lockedRect.Pitch / 4 + j; // get current color of cell D3DXCOLOR c( imageData[index] ); // shade current cell c *= computeShade(i, j, lightDirection);; // save shaded color imageData[index] = (D3DCOLOR)c; } } 13.5 åœ¨åœ°å½¢ä¸Šâ€œè¡Œèµ°â€ æ„é€ äº†ä¸€ä¸ªåœ°å½¢ä»¥åï¼Œæˆ‘ä»¬æƒ³è¦æœ‰ç§»åŠ¨ç…§ç›¸æœºçš„èƒ½åŠ›ï¼Œä»¥ä¾¿æ¨¡æ‹Ÿåœ¨åœ°å½¢ä¸Šè¡Œèµ°çš„æ•ˆæœã€‚æˆ‘ä»¬éœ€è¦è°ƒæ•´ç…§ç›¸æœºçš„é«˜åº¦ï¼Œè¿™ä¾èµ–äºåœ°å½¢éƒ¨åˆ†çš„çŸ¥è¯†ï¼Œå¥½çš„ï¼Œæˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ã€‚æˆ‘ä»¬é¦–å…ˆéœ€è¦æ‰¾åˆ°ç…§ç›¸æœºæ‰€åœ¨çš„æ–¹æ ¼çš„ä½ç½®ï¼Œå¹¶ç»™å‡ºxè½´å’Œzè½´åæ ‡ï¼ŒTerrain::getHeightå‡½æ•°èƒ½åšåˆ°è¿™äº›ï¼Œå®ƒèƒ½æä¾›xè½´ã€yè½´åæ ‡å‚æ•°ï¼Œè¿”å›ç…§ç›¸æœºéœ€è¦è¢«è®¾ç½®åœ¨åœ°å½¢ä¸Šçš„é«˜åº¦å€¼ï¼Œç°åœ¨çœ‹å®ç°éƒ¨åˆ†ã€‚float Terrain::getHeight(float x, float z){ // Translate on xz-plane by the transformation that takes // the terrain START point to the origin. x = ((float) width / 2.0f) + x; z = ((float) depth / 2.0f) - z; // Scale down by the transformation that makes the // cellspacing equal to one. This is given by // 1 / cellspacing since cellspacing * 1 / cellspacing = 1. x /= (float) cellSpacing; z /= (float)_cellSpacing; æˆ‘ä»¬é¦–å…ˆè½¬æ¢åœ°å½¢çš„èµ·å§‹ç‚¹ä¸ºåŸç‚¹ï¼Œç„¶åï¼Œæˆ‘ä»¬æŒ‰åæ–¹å‘å»æµ‹é‡ç©ºé—´å˜é‡ï¼ˆwe scale by the inverse of the cell spacing variableï¼‰ï¼Œè®¾ç½®å•å…ƒç©ºé—´é—´éš”ä¸º1ã€‚æˆ‘ä»¬åˆ‡æ¢åˆ°ä¸€ä¸ªæ–°çš„å‚è€ƒæ¡†æ¶ï¼Œzè½´æ­£æ–¹å‘æ˜¯å‘ä¸‹çš„ã€‚å½“ç„¶ï¼Œæ²¡æœ‰ä»£ç è½¬æ¢å‚è€ƒæ¡†æ¶ï¼Œä½†ç°åœ¨æˆ‘ä»¬çŸ¥é“+zæ˜¯å‘ä¸‹çš„ã€‚å›¾13.9æ˜¾ç¤ºäº†è¿™äº›æ­¥éª¤ï¼š å›¾13.9ï¼šåœ°å½¢ç½‘æ ¼åœ¨è½¬æ¢å‰çš„ç¬¬ä¸€ä¸ªç‚¹ï¼Œè½¬æ¢åä¸ºåŸç‚¹ã€‚å•å…ƒæ ¼çš„ç©ºé—´ä¸º1ï¼Œè½¬æ¢zè½´ã€‚æˆ‘ä»¬çœ‹åˆ°æˆ‘ä»¬è½¬æ¢çš„åæ ‡ç³»ç»Ÿä¸çŸ©é˜µçš„è¡Œå’Œåˆ—ç›¸å¯¹åº”ï¼Œä¹Ÿå°±æ˜¯è¯´å·¦ä¸Šä¸ºåŸç‚¹ï¼Œåˆ—æ•°çš„å¢åŠ å‘å³ï¼Œè¡Œæ•°çš„å¢åŠ å‘ä¸‹ã€‚å› æ­¤ï¼Œåœ¨å›¾13.9ä¸­æˆ‘ä»¬çŸ¥é“äº†å•å…ƒæ ¼çš„ç©ºé—´æ˜¯1ï¼Œé€šè¿‡ä»¥ä¸‹çš„æ–¹æ³•æˆ‘ä»¬é©¬ä¸Šå°±èƒ½å¾—åˆ°å•å…ƒæ ¼è¡Œå’Œåˆ—ï¼šfloat col = ::floorf(x);float row = ::floorf(z); æ¢å¥è¯è¯´ï¼Œåœ¨xè½´éƒ¨åˆ†åˆ—æ˜¯æ•´æ•°ï¼Œzè½´éƒ¨åˆ†è¡Œä¹Ÿæ˜¯æ•´æ•°ã€‚å›å¿†floor(t)å‡½æ•°ï¼Œã€‚ç°åœ¨æˆ‘ä»¬å°†å–å¾—æ–¹æ ¼çš„å››ä¸ªé¡¶ç‚¹çš„é«˜åº¦ã€‚ // A B // â€” // | / | // â€” // C Dfloat A = getHeightmapEntry(row, col);float B = getHeightmapEntry(row, col+1);float C = getHeightmapEntry(row+1, col);float D = getHeightmapEntry(row+1, col+1); ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†æ–¹æ ¼çš„å››ä¸ªé¡¶ç‚¹çš„é«˜åº¦ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ç…§ç›¸æœºæ‰€åœ¨çš„ä½ç½®çš„æ–¹æ ¼çš„é«˜åº¦ï¼Œå› ä¸ºä¸€ä¸ªæ–¹æ ¼å¯èƒ½åŒæ—¶å‘å‡ ä¸ªæ–¹å‘å€¾æ–œï¼Œè¿™å¯èƒ½ä¼šç¨å¾®éš¾ä¸€ç‚¹ï¼Œè§å›¾ 13.10: å›¾13.10: ç…§ç›¸æœºæ‰€åœ¨çš„ä½ç½®çš„æ–¹æ ¼çš„é«˜åº¦ ä¸ºäº†æ‰¾åˆ°é«˜åº¦ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“æˆ‘ä»¬åœ¨æ–¹æ ¼ä¸­çš„å“ªä¸ªä¸‰è§’å½¢é‡Œã€‚æ–¹æ ¼æ˜¯ç”±äºŒä¸ªä¸‰è§’å½¢æ¸²æŸ“æˆçš„ï¼Œæ‰¾åˆ°æˆ‘ä»¬æ‰€åœ¨çš„ä¸‰è§’å½¢ï¼Œæˆ‘ä»¬è¦å–å¾—æˆ‘ä»¬æ‰€åœ¨çš„æ–¹æ ¼å¹¶ä¸”è½¬æ¢å®ƒï¼Œå®ƒçš„å·¦ä¸Šç‚¹æ˜¯åŸç‚¹ã€‚ è‡ªä»ç”¨è¡Œå’Œåˆ—æ¥æè¿°æˆ‘ä»¬æ‰€åœ¨çš„æ–¹æ ¼å·¦ä¸Šé¡¶ç‚¹çš„ä½ç½®ä»¥æ¥ï¼Œæˆ‘ä»¬å¿…é¡»è½¬æ¢åˆ—xè½´ä¸è¡Œzè½´ï¼Œè½¬æ¢xã€zåæ ‡ï¼š float dx = x - col; float dz = z - row; å›¾13.11: æˆ‘ä»¬æ‰€åœ¨çš„æ–¹æ ¼åœ¨è½¬æ¢å‰ä¸è½¬æ¢åï¼Œå·¦ä¸Šé¡¶ç‚¹å˜æˆäº†åŸç‚¹ã€‚ .ç°åœ¨è§£é‡Šå½“æˆ‘ä»¬åœ¨æ–¹æ ¼ä¸­çš„ä¸Šä¸‰è§’å½¢æ—¶å¦‚ä½•æ‰¾åˆ°é«˜åº¦ï¼Œè¿™å’Œåœ¨ä¸‹ä¸‰è§’å½¢æ˜¯ç›¸ä¼¼çš„ã€‚é©¬ä¸Šä½ ä¼šçœ‹åˆ°è¿™ä¸¤ç§æƒ…å†µçš„ä»£ç ã€‚åœ¨ä¸Šä¸‰è§’å½¢æ—¶ï¼Œæ„é€ 2ä¸ªå‘é‡ï¼šu = (cellSpacing, B -A, 0) and v = (0, C - A, - cellSpacing)ï¼Œä¸‰è§’å½¢çš„è¾¹ä¸Šå¹¶ä¸”åœ¨çŸ¢é‡q = (qx, A, qz)ç»ˆç‚¹ç‚¹å¼€å§‹çš„åœ°æ–¹ï¼Œå¦‚å›¾13.12(a)ã€‚ å›¾13.12 (a) è®¡ç®—ä¸‰è§’å½¢çš„é‚»è¾¹å’Œå¯¹è¾¹è¿™ä¸¤ä¸ªå‘é‡ã€‚ (b)ä½¿ç”¨çº¿æ€§å·®å€¼åˆ›å»ºé«˜åº¦ æ³¨æ„ï¼šæˆ‘ä»¬åªå…³å¿ƒæ”¹å˜çš„é«˜åº¦å€¼ï¼Œæˆ‘ä»¬åªä¿®æ”¹yå€¼ï¼Œå¿½è§†å…¶ä»–éƒ¨åˆ†ï¼Œå› æ­¤ï¼ŒHeight=sum A + dxuy + dzvy ä»¥ä¸‹æ˜¯Terrian::getHeightå‡½æ•°çš„å®ç°ä»£ç ï¼š ï¼ˆNote that since we are only concerned about the interpolated height value, we can just interpolate the y-components and ignore the other components. Thus, the height is obtained by the sum A + dxuy + dzvy.ï¼‰if(dz &lt; 1.0f - dx) // upper triangle ABC { float uy = B - A; // A-&gt;B float vy = C - A; // A-&gt;C height = A + d3d::Lerp(0.0f, uy, dx) + d3d::Lerp(0.0f, vy, dz) ; } else // lower triangle DCB { float uy = C - D; // D-&gt;C float vy = B - D; // D-&gt;B height = D + d3d::Lerp(0.0f, uy, 1.0f - dx) + d3d::Lerp(0.0f, vy, 1.0f - dz); } return height; } Lerpå‡½æ•°æ˜¯ä¸€ä¸ªæ²¿ç€ä¸€ç»´ç›´çº¿çš„åŸºæœ¬çº¿æ€§æ’å€¼ç®—æ³•ï¼Œå®ç°å¦‚ä¸‹ï¼šfloat d3d::Lerp(float a, float b, float t){ return a - (at) + (bt);} 13.6 ä¾‹å­ç¨‹åº: Terrain è¿™ç« çš„ä¾‹å­æ˜¯ç”¨ä¸€ä¸ªåŒ…å«é«˜åº¦ä¿¡æ¯çš„RAWæ–‡ä»¶åˆ›å»ºä¸€ä¸ªåœ°å½¢ï¼Œçº¹ç†å’Œå…‰æºã€‚ç”¨æ–¹å‘é”®åœ¨åœ°å½¢ä¸Šè¡Œèµ°ã€‚æ³¨æ„ï¼Œä¸‹åˆ—å‡½æ•°ä¸­ä¸ç›¸å…³çš„ä»£ç è¢«çœç•¥äº†ï¼Œè¢«çœç•¥çš„ä»£ç ç”¨(â€¦)è¡¨ç¤ºï¼Œä¾èµ–ä½ çš„ç¡¬ä»¶ï¼Œè¿™ä¸ªä¾‹å­å¯èƒ½è¿è¡Œå¾—å¾ˆæ…¢ï¼Œè¯·å¿è¯•è¿è¡Œä¸€ä¸ªå°åœ°å½¢ã€‚ é¦–å…ˆï¼Œå¢åŠ å…¨å±€å˜é‡ï¼šåœ°å½¢ã€ç…§ç›¸æœºã€æ¯ç§’å¸§æ•°ã€‚Terrain TheTerrain = 0;Camera TheCamera(Camera::LANDOBJECT);FPSCounter FPS = 0; ä¸‹é¢æ˜¯æ¡†æ¶å‡½æ•°ï¼šbool Setup(){ D3DXVECTOR3 lightDirection(0.0f, -1.0f, 0.0f); TheTerrain = new Terrain(Device, â€œcoastMountain256.rawâ€, 256, 256, 10, 1.0f); TheTerrain-&gt;genTexture(); TheTerrain-&gt;lightTerrain(&amp;directionToLight); â€¦ return true; } void Cleanup(){ d3d::Delete(TheTerrain); d3d::Delete(FPS);} bool Display(float timeDelta){ if( Device ) { // Update the scene: â€¦[snipped input checking] // Walking on the terrain: Adjust camera&#39;s height so we // are standing 5 units above the cell point we are // standing on. D3DXVECTOR3 pos; TheCamera.getPosition(&amp;pos); float height = TheTerrain-&gt;getHeight( pos.x, pos.z ); pos.y = height + 5.0f; TheCamera.setPosition(&amp;pos); D3DXMATRIX V; TheCamera.getViewMatrix(&amp;V); Device-&gt;SetTransform(D3DTS VIEW, &amp;V); // Draw the scene: Device-&gt;Clear(0, 0, D3DCLEAR TARGET | D3DCLEAR ZBUFFER, 0xff000000, 1.0f, 0); Device-&gt;BeginScene(); D3DXMATRIX I; D3DXMatrixIdentity(&amp;I); if( TheTerrain ) TheTerrain-&gt;draw(&amp;I, false); if( FPS ) FPS-&gt;render(0xffffffff, timeDelta); Device-&gt;EndScene(); Device-&gt;Present(0, 0, 0, 0); } return true; } 13.7 ä¸€äº›æ”¹è¿› Terrainè¯»å–é¡¶ç‚¹æ•°æ®åˆ°ä¸€ä¸ªå¾ˆå¤§çš„ç¼“å­˜ï¼Œåœ¨å¤šé‡çš„é¡¶ç‚¹ç¼“å­˜ä¸­åˆ’åˆ†åœ°å½¢ç»“æ„ï¼Œåœ¨é€Ÿåº¦å’Œå¯æµ‹é‡æ€§æ–¹é¢éƒ½ååˆ†æœ‰åˆ©ã€‚ä¸ºæˆ‘ä»¬æå‡ºä¸€ä¸ªé—®é¢˜ï¼šé¡¶ç‚¹ç¼“å­˜æœ€å¤§æ”¯æŒå¤šå¤§ï¼Ÿå›ç­”æ˜¯ï¼Œè¿™ä¾èµ–äºä½ çš„ç¡¬ä»¶ã€‚æ‰€ä»¥ä½ å¿…é¡»å…ˆæ£€æµ‹ã€‚ å°†åœ°å›¾åˆ’åˆ†ä¸ºè®¸å¤šå°çš„é¡¶ç‚¹ç¼“å­˜æ˜¯é‡è¦çš„ç»ƒä¹ ï¼Œç„¶åå°†ç±»ä¼¼çŸ©é˜µçš„æ•°æ®ç»“æ„ç¼–å…¥ç´¢å¼•ï¼Œå¹¶ä¸”ç®¡ç†æ•°æ®ï¼Œè¿™ä¸éœ€è¦å¼•å…¥æ–°çš„æ¦‚å¿µã€‚æˆ‘ä»¬ä¸å¿…è¯¦ç»†è®¨è®ºå®ƒã€‚ç®€å•çš„è¯´ï¼Œä½ åŸºæœ¬ä¸Šç«™åœ¨åœ°å½¢ä¸­ä¸€ä¸ªæˆ‘ä»¬å«åšâ€œblocksâ€çš„çŸ©é˜µä¸Š,æ¯ä¸ªblockæ˜¯åœ°å½¢çš„ä¸€ä¸ªçŸ©å½¢åŒºåŸŸã€‚å¦å¤–ï¼Œæ¯ä¸ªblockåŒºåŸŸï¼ˆåœ¨å®ƒè‡ªå·±çš„é¡¶ç‚¹ç´¢å¼•ç¼“å­˜ä¸­ï¼‰çš„ä¸‹æ–¹åŒ…å«åœ°å½¢ä¸­çš„å‡ ä½•ä¿¡æ¯ï¼Œä¸ºäº†ç”»å®ƒåœ¨åœ°å½¢ä¸­çš„ä½ç½®ã€‚ å¦å¤–ï¼Œä½ å¯ä»¥è¯»å–åœ°å½¢åˆ°ä¸€ä¸ªå¾ˆå¤§çš„ID3DXMeshæ¥å£ã€‚ä½¿ç”¨D3Då‡½æ•°D3DXSplitMeshåˆ’åˆ†åœ°å½¢ä¸ºè®¸å¤šå°çš„Mesh, ä»¥ä¸‹æ˜¯D3DXSplitMeshå‡½æ•°åŸå‹ï¼švoid D3DXSplitMesh( const LPD3DXMESH pMeshIn, const DWORD pAdjacencyIn, const DWORD MaxSize, const DWORD Options, DWORD pMeshesOut, LPD3DXBUFFER ppMeshArrayOut, LPD3DXBUFFER ppAdjacencyArrayOut, LPD3DXBUFFER ppFaceRemapArrayOut, LPD3DXBUFFER ppVertRemapArrayOut); è¿™ä¸ªå‡½æ•°å°†ä¸€ä¸ªæºMeshåˆ’åˆ†å¤šä¸ªå°çš„Mesh,ï¼ŒpMeshInå‚æ•°æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘æƒ³åˆ’åˆ†çš„Meshï¼ŒpAdjacencyInæŒ‡å‘ä¸€ä¸ªé‚»æ¥æ•°ç»„ï¼ŒMaxSizeå‚æ•°æŒ‡å®šä½œä¸ºç»“æœè¿”å›çš„æœ€å¤§é¡¶ç‚¹æ•°ï¼Œä¸ºè¿”å›çš„Mesheä½¿ç”¨æŒ‡å®šçš„åˆ›å»ºæ ‡è®°ï¼ŒpMeshesOutå‚æ•°è¿”å›ppMeshArrayOutæ•°ç»„ä¸­çš„Meshæ•°é‡ï¼Œæœ€å3ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼ˆå¯ä»¥æŒ‡å®šä¸ºnullï¼‰ï¼Œè¿”å›é‚»æ¥ä¿¡æ¯çš„æ•°ç»„ã€‚13.8 æ‘˜è¦ æˆ‘ä»¬èƒ½ç”¨ä¸‰è§’å½¢ç½‘æ ¼å’Œä¸åŒçš„é«˜åº¦å€¼æ¥æ¨¡æ‹Ÿåœ°å½¢ï¼Œåˆ›å»ºå±±ä¸˜ã€æ²³æµã€‚ Heightmapæ•°æ®åŒ…å«åœ°å½¢é¡¶ç‚¹çš„é«˜åº¦å€¼ã€‚ æˆ‘ä»¬èƒ½é€šè¿‡ç¨‹åºä½¿ç”¨ç£ç›˜ä¸Šçš„å›¾åƒæ–‡ä»¶ç”Ÿæˆåœ°å½¢ä¸Šçš„çº¹ç†ã€‚ æˆ‘ä»¬èƒ½ç…§äº®åœ°å½¢ï¼Œé€šè¿‡è®¡ç®—é˜´å½±ç³»æ•°æ¥ä½¿æ¯ä¸ªæ ¼å­å˜äº®æˆ–å˜æš—ï¼Œé˜´å½±ç³»æ•°æ˜¯ç”±å…‰ç…§åœ¨æ ¼å­ä¸Šçš„è§’åº¦å†³å®šçš„ã€‚ ä½¿ç…§ç›¸æœºåœ¨åœ°å½¢ä¸Šèµ°åŠ¨ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°æˆ‘ä»¬ç«™ç«‹çš„ä¸‰è§’å½¢ã€‚æˆ‘ä»¬è®¡ç®—ä¸‰è§’å½¢ä¸Šçš„é‚»è¾¹å’Œå¯¹è¾¹è¿™ä¸¤ä¸ªå‘é‡ï¼Œé«˜åº¦æ˜¯é€šè¿‡â€¦ï¼ˆçº¿æ€§æ’å€¼åœ¨è¿™äº›å‘é‡ä¸­æ¯ä¸ªä½¿ç”¨xã€zå¯¹åº”çš„å•ä½å‘é‡ï¼Œä»¥å·¦é«˜é¡¶ç‚¹ä¸ºåŸç‚¹ä¸ºå‚æ•°ã€‚ï¼‰æ‰¾åˆ°çš„ã€‚ï¼ˆThe height is then found by linearly interpolating on each of these vectors using the x- and z-coordinates in a normalized cell with an upper-left vertex at the origin as parameters.ï¼‰]]></content>
      <categories>
        <category>Direct3D</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬åä¸€ç«  ç½‘æ ¼æ¨¡å‹II(Building a Flexible Camera Class)]]></title>
    <url>%2F2019%2F04%2F11%2FBuilding-a-Flexible-Camera-Class%2F</url>
    <content type="text"><![CDATA[ID3DXBuffer å¯¹ID3DXBufferæ¥å£çš„ä¸€äº›å‚è€ƒæ˜¯åœ¨ä¸Šä¸€ç« ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸ä¼šè¯¦ç»†è®²è§£ã€‚åœ¨D3DXåº“ä¸­åˆ°å¤„éƒ½èƒ½çœ‹è§è¿™ä¸ªæ¥å£ï¼Œå› æ­¤å¤§æ¦‚ä»‹ç»ä¸€ä¸‹è¯¥æ¥å£è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚ ID3DXBufferæ¥å£æ˜¯ä¸€ä¸ªå¾ˆæ™®é€šçš„æ•°æ®ç»“æ„ï¼Œ D3DXç”¨å®ƒå°†æ•°æ®å­˜å‚¨åˆ°é‚»æ¥å†…å­˜å—ä¸­ã€‚å®ƒåªæœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š LPVOID GetBufferPointer()â€”â€”è¿”å›ä¸€ä¸ªæŒ‡å‘å¼€å§‹æ•°æ®çš„æŒ‡é’ˆã€‚ DWORD GetBufferSize()â€”â€”è¿”å›åœ¨ç¼“å­˜ä¸­çš„å­—èŠ‚å¤§å°ã€‚ ä¸ºäº†ä¿æŒç»“æ„ç‰¹æ€§ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªç©ºæŒ‡é’ˆã€‚ä¹Ÿå°±æ˜¯è¯´å®ƒè®©æˆ‘ä»¬çŸ¥é“è¢«å­˜å‚¨çš„æ•°æ®çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼ŒD3DXLoadMeshFromXä½¿ç”¨ä¸€ä¸ªID3DXBufferæ¥è¿”å›meshçš„é‚»æ¥ä¿¡æ¯ã€‚å› ä¸ºé‚»æ¥ä¿¡æ¯æ˜¯è¢«å­˜å‚¨åœ¨DWORDæ•°ç»„ä¸­çš„ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬å¸Œæœ›ä½¿ç”¨ç¼“å­˜ä¸­çš„é‚»æ¥ä¿¡æ¯æ—¶ï¼Œæˆ‘ä»¬ä¸å¾—ä¸å°†ç¼“å­˜è½¬æ¢ä¸ºDWORDæ•°ç»„ã€‚ ä¾‹å¦‚ï¼šDWORD info =(DWORD)adjacencyInfo-&gt;GetBufferPointer();D3DXMATERIAL mtrls = (D3DXMATERIAL)mtrlBuffer-&gt;GetBufferPointer(); å› ä¸ºID3DXBufferæ˜¯ä¸€ä¸ªCOMå¯¹è±¡ï¼Œå½“ä½ ä½¿ç”¨å®Œä»¥åå°±å¿…é¡»é‡Šæ”¾å®ƒä»¥é˜²æ­¢å†…å­˜æ³„æ¼ï¼šadjacencyInfo-&gt;Release();mtrlBuffer-&gt;Release(); æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªç©ºçš„ID3DXBufferï¼šHRESULT D3DXCreateBuffer( DWORD NumBytes, // Size of the buffer, in bytes. LPD3DXBUFFER ppBuffer // Returns the created buffer.); ä¸‹é¢çš„ä¾‹å­æ˜¯åˆ›å»ºä¸€ä¸ªèƒ½åŒ…å«4ä¸ªæ•´æ•°çš„ç¼“å­˜ï¼šID3DXBuffer buffer = 0;D3DXCreateBuffer( 4 sizeof(int), &amp;buffer );11.2 Xæ–‡ä»¶ è¿„ä»Šä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨è¿‡äº†ç®€å•çš„å‡ ä½•ç‰©ä½“ï¼Œå¦‚çƒä½“ï¼Œåœ†æŸ±ä½“ï¼Œç«‹æ–¹ä½“ç­‰ï¼Œå®ƒä»¬éƒ½æ˜¯ç”¨D3DXCreateå‡½æ•°æ¥åˆ›å»ºçš„ã€‚å‡å¦‚ä½ æƒ³é€šè¿‡æ‰‹å·¥æŒ‡å®šé¡¶ç‚¹æ¥åˆ›å»ºä½ è‡ªå·±çš„3Dç‰©ä½“ï¼Œä½ èƒ½ï¼Œä¸ç”¨æ€€ç–‘ï¼Œä¸è¿‡è¿™æ˜¯éå¸¸æ¯ç‡¥ä¹å‘³çš„äº‹æƒ…ã€‚ä¸ºäº†å‡è½»å»ºé€ 3Dç‰©ä½“æ•°æ®çš„å·¥ä½œï¼Œä¸“é—¨çš„åº”ç”¨ç¨‹åºå·²ç»è¢«å¼€å‘å‡ºæ¥äº†ï¼Œæˆ‘ä»¬æŠŠå®ƒä»¬å«åš3Då»ºæ¨¡å·¥å…·ã€‚å®ƒä»¬å…è®¸æˆ‘ä»¬åœ¨ä¸€ä¸ªè™šæ‹Ÿçš„æ‹¥æœ‰ä¸°å¯Œå·¥å…·çš„äº¤äº’ç¯å¢ƒä¸‹å»ºé€ å¤æ‚çš„çœŸå®çš„meshï¼Œåœ¨è¿™å»ºé€ è¿™äº›æ¨¡å‹éƒ½æ˜¯éå¸¸å®¹æ˜“çš„ã€‚ä¾‹å¦‚åœ¨æ¸¸æˆå¼€å‘ä¸­å¸¸ç”¨åˆ°çš„æœ‰3DSMaxï¼ˆwww.discreet.comï¼‰,LightWave 3Dï¼ˆwww.newtek.comï¼‰,ä»¥åŠMayaï¼ˆwww.aliaswavefront.comï¼‰ã€‚ è¿™äº›å·¥å…·ï¼Œå½“ç„¶èƒ½å¤Ÿè¾“å‡ºåˆ›å»ºå¥½çš„meshæ•°æ®åˆ°æ–‡ä»¶ä¸­ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å¤Ÿå†™ä¸€ä¸ªæ–‡ä»¶æ¥æå–åœ¨æˆ‘ä»¬çš„3Dåº”ç”¨ç¨‹åºä¸­è¦ç”¨åˆ°çš„meshæ•°æ®ã€‚è¿™çš„ç¡®æ˜¯ä¸€ç§å¯è¡Œçš„è§£å†³åŠæ³•ã€‚ä¸è¿‡ï¼Œè¿˜å­˜åœ¨ä¸€ä¸ªæ›´æ–¹ä¾¿çš„è§£å†³æ–¹æ¡ˆã€‚å®ƒæ˜¯ä¸€ç§å«åšXæ–‡ä»¶çš„ç‰¹æ®Šmeshæ–‡ä»¶æ ¼å¼ï¼ˆæ‰©å±•åä¸º.Xï¼‰ã€‚å¾ˆå¤š3Då»ºæ¨¡è½¯ä»¶éƒ½èƒ½è¾“å‡ºè¿™ç§æ ¼å¼ï¼Œå½“ç„¶è¿™é‡Œå­˜åœ¨ä¸€ä¸ªå°†å…¶ä»–æµè¡Œçš„meshæ–‡ä»¶è½¬æ¢ä¸ºXæ–‡ä»¶çš„è¿‡ç¨‹ã€‚æ˜¯ä»€ä¹ˆä½¿Xæ–‡ä»¶è¿™ä¹ˆä¾¿åˆ©å‘¢ï¼Ÿå› ä¸ºå®ƒæ˜¯DirectXå®šä¹‰çš„æ ¼å¼ï¼Œå¹¶ä¸”D3DXåº“å¾ˆå®¹æ˜“åœ°æ”¯æŒXæ–‡ä»¶ã€‚D3DXåº“æä¾›äº†è¯»å’Œå†™Xæ–‡ä»¶çš„å‡½æ•°ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨è¿™ç§æ ¼å¼å°±é¿å…äº†è¿˜è¦è‡ªå·±å†™ç¨‹åºæ–‡ä»¶æ¥è¯»/å†™æ¨¡å‹æ–‡ä»¶äº†ã€‚ æ³¨æ„ï¼šä½ èƒ½å¤Ÿä¸‹è½½DirectX9 SDK Extraâ€”â€”ä½ èƒ½ä»MSDNï¼ˆwww.msdn.microsoft.comï¼‰ä¸Šå¾—åˆ°ä¸€äº›å·²ç»å¼€å‘å¥½çš„é’ˆå¯¹3DMax,LightWave,Mayaè½¯ä»¶å¯¼å‡º.Xæ–‡ä»¶çš„Direct3Då·¥å…·åŒ…ã€‚11.2.1è¯»å–Xæ–‡ä»¶ æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„å‡½æ•°æ¥è¯»å–å­˜å‚¨åœ¨Xæ–‡ä»¶ä¸­çš„meshæ•°æ®ã€‚æ³¨æ„è¿™ä¸ªæ–¹æ³•åˆ›å»ºä¸€ä¸ªID3DXMeshå¯¹è±¡ï¼Œä¸”ä»Xæ–‡ä»¶ä¸­è¯»å–å‡ ä½•ä¿¡æ¯æ•°æ®å¡«å…¥å…¶ä¸­ã€‚HRESULT D3DXLoadMeshFromX( LPCSTR pFilename, DWORD Options, LPDIRECT3DDEVICE9 pDevice, LPD3DXBUFFER ppAdjacency, LPD3DXBUFFER ppMaterials, LPD3DXBUFFER ppEffectInstances, PDWORD pNumMaterials, LPD3DXMESH ppMesh); pFilename â€” è¯»å–çš„Xæ–‡ä»¶çš„æ–‡ä»¶åã€‚ Options â€” ç”¨æ¥åˆ›å»ºmeshçš„ä¸€ä¸ªæˆ–å¤šä¸ªåˆ›å»ºæ ‡å¿—ã€‚è¦äº†è§£æ‰€æœ‰æ ‡å¿—ä¿¡æ¯è¯·æŸ¥çœ‹sdkæ–‡æ¡£ã€‚ç°åœ¨åˆ—å‡ºä¸€éƒ¨åˆ†ï¼š D3DXMESH_32BIT â€” meshä½¿ç”¨32ä½ç´¢å¼•ã€‚ D3DXMESH_MANAGED â€” meshæ•°æ®å°†è¢«æ”¾åœ¨å—æ§çš„å†…å­˜ä¸­ã€‚ D3DXMESH_WRITEONLY â€” meshæ•°æ®åªèƒ½æ‰§è¡Œå†™æ“ä½œï¼Œä¸èƒ½æ‰§è¡Œè¯»æ“ä½œã€‚ D3DXMESH_DYNAMIC â€” meshç¼“å­˜å°†æ˜¯åŠ¨æ€çš„ã€‚ pDevice â€” ä¸å¤åˆ¶meshæœ‰å…³çš„è®¾å¤‡ã€‚ ppAdjacency â€” è¿”å›ä¸€ä¸ªID3DXBufferåŒ…å«ä¸€ä¸ªDWORDæ•°ç»„ï¼Œæè¿°meshçš„é‚»æ¥ä¿¡æ¯ã€‚ ppMaterials â€” è¿”å›ä¸€ä¸ªID3DXBufferåŒ…å«ä¸€ä¸ªD3DXMATERIALç»“æ„çš„æ•°ç»„ï¼Œå­˜å‚¨äº†meshçš„æè´¨æ•°æ®ã€‚æˆ‘ä»¬åœ¨ä¸‹ä¸€èŠ‚ä»‹ç»meshæè´¨ã€‚ ppEffectInstances â€” è¿”å›ä¸€ä¸ªID3DXBufferåŒ…å«ä¸€ä¸ªD3DXEFFECTINSTANCEç»“æ„çš„æ•°ç»„ã€‚æˆ‘ä»¬ç°åœ¨é€šè¿‡æŒ‡å®š0å€¼æ¥å¿½ç•¥è¿™ä¸ªå‚æ•°ã€‚ pNumMaterials â€” è¿”å›meshçš„æè´¨æ•°ã€‚ ppMesh â€” è¿”å›å¡«å……äº†Xæ–‡ä»¶å‡ ä½•ä¿¡æ¯çš„ID3DXMeshå¯¹è±¡ã€‚11.2.2 Xæ–‡ä»¶çš„æè´¨ D3DXLoadMeshFromXçš„ç¬¬ä¸ƒä¸ªå‚æ•°è¿”å›çš„æ˜¯meshåŒ…å«çš„æè´¨æ•°ï¼Œç¬¬äº”ä¸ªå‚æ•°è¿”å›çš„æ˜¯åŒ…å«ç€æè´¨æ•°æ®çš„ä¸€ä¸ªD3DXMATERIALç»“æ„æ•°ç»„ã€‚D3DXMATERIALç»“æ„çš„å®šä¹‰å¦‚ä¸‹ï¼štypedef struct D3DXMATERIAL { D3DMATERIAL9 MatD3D; LPSTR pTextureFilename;} D3DXMATERIAL; è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ç»“æ„ï¼›å®ƒåŒ…å«ä¸€ä¸ªåŸºæœ¬çš„D3DMATERAIL9ç»“æ„å’Œä¸€ä¸ªç”¨æ¥æŒ‡å®šä¸ä¹‹ç›¸å…³è”çš„çº¹ç†æ–‡ä»¶åçš„ä¸€ä¸ªä»¥nullç»“æŸçš„å­—ç¬¦ä¸²æŒ‡é’ˆã€‚ä¸€ä¸ªXæ–‡ä»¶æ˜¯ä¸èƒ½æ’å…¥çº¹ç†æ•°æ®çš„ï¼›å®ƒåªèƒ½æ’å…¥æ–‡ä»¶åã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨D3DXLoadMeshFromXè¯»å–ä¸€ä¸ªXæ–‡ä»¶ä»¥åï¼Œæˆ‘ä»¬è¿˜å¿…é¡»ä»çº¹ç†æ–‡ä»¶ä¸­è¯»å–çº¹ç†æ•°æ®ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­è¯´æ˜æ€æ ·å…·ä½“å®ç°ã€‚ D3DXLoadMeshFromXå‡½æ•°è¯»å–Xæ–‡ä»¶æ•°æ®ä»¥ä¾¿åœ¨è¿”å›çš„D3DXMATERIALæ•°ç»„ä¸­çš„ç¬¬ié¡¹ä¸ç¬¬iä¸ªå­é›†ç›¸å¯¹åº”ã€‚å› æ­¤ï¼Œå­é›†æ˜¯ä½¿ç”¨0ï¼Œ1ï¼Œ2ï¼Œâ€¦ï¼Œn-1æ ‡è®°çš„ï¼Œnæ˜¯å­é›†å’Œæè´¨çš„æ•°ç›®ã€‚è¿™ä¹Ÿå°±å…è®¸ä½¿ç”¨ç®€å•çš„å¾ªç¯æ¥æ¸²æŸ“meshäº†ã€‚11.2.3 å®ä¾‹ç¨‹åºï¼šXæ–‡ä»¶ æˆ‘ä»¬ç°åœ¨æ¼”ç¤ºæœ¬ç« ä¸­çš„ç¬¬ä¸€ä¸ªå®ä¾‹ï¼ˆXæ–‡ä»¶ï¼‰çš„ç›¸å…³ä»£ç ã€‚è¯¥ä¾‹å­è°ƒç”¨ä¸€ä¸ªå«åšbigship1.xçš„xæ–‡ä»¶ï¼Œä½ å¯ä»¥åœ¨DirectX SDKä¸‹çš„mediaæ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°å®ƒã€‚å®Œæ•´åŸä»£ç å¯ä»¥åœ¨ç›¸åº”çš„æ–‡ä»¶ä¸­æ‰¾åˆ°ã€‚å›¾11.1æ˜¯è¯¥å®ä¾‹çš„ä¸€ä¸ªæˆªå›¾ã€‚ å›¾11.1 è¯¥å®ä¾‹ä½¿ç”¨ä¸‹é¢çš„å…¨å±€å˜é‡ï¼šID3DXMesh Mesh = 0;std::vector Mtrls(0);std::vector&lt;IDirect3DTexture9&gt; Textures(0); è¿™é‡Œæœ‰ä¸€ä¸ªID3DXMeshå¯¹è±¡ï¼Œå®ƒè¢«ç”¨æ¥å­˜å‚¨ä»Xæ–‡ä»¶ä¸­è¯»å–çš„meshæ•°æ®ã€‚ä¹Ÿæœ‰ä¸€ä¸ªæè´¨vectorå’Œçº¹ç†vector,æˆ‘ä»¬ç”¨å®ƒä»¬æ¥åˆ†åˆ«å­˜å‚¨meshçš„æè´¨å’Œçº¹ç†ã€‚ æˆ‘ä»¬é¦–å…ˆåœ¨Setupå‡½æ•°ä¸­æ“ä½œã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è¯»å–Xæ–‡ä»¶ï¼šbool Setup(){ HRESULT hr = 0; // // Load the XFile data. // ID3DXBuffer adjBuffer = 0; ID3DXBuffer mtrlBuffer = 0; DWORD numMtrls = 0; hr = D3DXLoadMeshFromX( â€œbigship1.xâ€, D3DXMESH_MANAGED, Device, &amp;adjBuffer, &amp;mtrlBuffer, 0, &amp;numMtrls, &amp;Mesh); if(FAILED(hr)) { ::MessageBox(0, â€œD3DXLoadMeshFromX() - FAILEDâ€, 0, 0); return false; } è¯»å–å®ŒXæ–‡ä»¶æ•°æ®ä»¥åï¼Œæˆ‘ä»¬å¿…é¡»éå†D3DXMATERIALæ•°ç»„æ¥è¯»å–meshä¸­æ‰€ä½¿ç”¨çš„æ‰€æœ‰çº¹ç†ï¼š // // Extract the materials, and load textures. // if( mtrlBuffer != 0 &amp;&amp; numMtrls != 0 ) { D3DXMATERIAL mtrls = (D3DXMATERIAL)mtrlBuffer-&gt;GetBufferPointer(); for(int i = 0; i &lt; numMtrls; i++) { // the MatD3D property doesnâ€™t have an ambient value set // when its loaded, so set it now: mtrls[i].MatD3D.Ambient = mtrls[i].MatD3D.Diffuse; // save the ith material Mtrls.push_back( mtrls[i].MatD3D ); // check if the ith material has an associative texture if( mtrls[i].pTextureFilename != 0 ) { // yes, load the texture for the ith subset IDirect3DTexture9 tex = 0; D3DXCreateTextureFromFile( Device, mtrls[i].pTextureFilename, &amp;tex); // save the loaded texture Textures.push_back( tex ); } else { // no texture for the ith subset Textures.push_back( 0 ); } } } d3d::Release&lt;ID3DXBuffer&gt;(mtrlBuffer); // done w/ buffer . . // Snipped irrelevant code to this chapter (e.g., setting up lights, . // view and projection matrices, etc.) . return true;} // end Setup() åœ¨Displayå‡½æ•°ä¸­æˆ‘ä»¬è®©meshåœ¨æ¯ä¸€å¸§ä¸­éƒ½æ—‹è½¬ä¸€ä¸ªå°è§’åº¦ã€‚æˆ‘ä»¬ä½¿ç”¨ç®€å•çš„å¾ªç¯ï¼ŒMeshä¾¿èƒ½å¤Ÿè¢«æ¸²æŸ“äº†ï¼šbool Display(float timeDelta){ if( Device ) { // // Update: Rotate the mesh. // static float y = 0.0f; D3DXMATRIX yRot; D3DXMatrixRotationY(&amp;yRot, y); y += timeDelta; if( y &gt;= 6.28f ) y = 0.0f; D3DXMATRIX World = yRot; Device-&gt;SetTransform(D3DTS_WORLD, &amp;World); // // Render // Device-&gt;Clear(0, 0, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER, 0xffffffff, 1.0f, 0); Device-&gt;BeginScene(); for(int i = 0; i &lt; Mtrls.size(); i++) { Device-&gt;SetMaterial( &amp;Mtrls[i] ); Device-&gt;SetTexture(0, Textures[i]); Mesh-&gt;DrawSubset(i); } Device-&gt;EndScene(); Device-&gt;Present(0, 0, 0, 0); } return true; }11.2.4 äº§ç”Ÿé¡¶ç‚¹æ³•çº¿ ä¸€ä¸ªXæ–‡ä»¶ä¸åŒ…å«é¡¶ç‚¹æ³•çº¿æ•°æ®ï¼Œè¿™æ˜¯å¾ˆæœ‰å¯èƒ½çš„ã€‚å‡å¦‚æ˜¯è¿™ç§æƒ…å†µï¼Œé‚£ä¹ˆæ‰‹åŠ¨è®¡ç®—é¡¶ç‚¹æ³•çº¿ä»¥ä¾¿æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ç¯å…‰è¿™æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚åœ¨ç¬¬5ç« ä¸­æˆ‘ä»¬ç®€è¦çš„ä»‹ç»äº†ä¸€ä¸‹æ€ä¹ˆåšã€‚ç„¶è€Œï¼Œç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ID3DXMeshæ¥å£å’Œå®ƒçš„çˆ¶æ¥å£ID3DXBaseMeshï¼Œæˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ä¸‹é¢çš„å‡½æ•°æ¥äº§ç”Ÿä»»ä½•meshçš„é¡¶ç‚¹æ³•çº¿ï¼šHRESULT D3DXComputeNormals( LPD3DXBASEMESH pMesh, // Mesh to compute normals of. const DWORD pAdjacency // Input adjacency info.); è¿™ä¸ªå‡½æ•°é€šè¿‡ä½¿ç”¨å¹³å‡æ³•çº¿çš„æ–¹æ³•æ¥äº§ç”Ÿé¡¶ç‚¹æ³•çº¿ã€‚å‡å¦‚æœ‰é‚»æ¥ä¿¡æ¯ï¼Œé‚£ä¹ˆé‡å¤çš„é¡¶ç‚¹æ˜¯è¢«å¿½ç•¥çš„ã€‚å‡å¦‚æ²¡æœ‰é‚»æ¥ä¿¡æ¯ï¼Œé‚£ä¹ˆé‡å¤çš„é¡¶ç‚¹ä¹Ÿä¼šè¢«é‡å¤è®¡ç®—ã€‚äº†è§£è¿™äº›æ˜¯å¾ˆé‡è¦çš„ï¼Œæˆ‘ä»¬æ£€æŸ¥pMashå¿…é¡»æœ‰ä¸€ä¸ªåŒ…å«D3DFVF_NORMALæ ‡è®°çš„é¡¶ç‚¹æ ¼å¼ã€‚ æ³¨æ„å‡å¦‚Xæ–‡ä»¶ä¸åŒ…å«é¡¶ç‚¹æ³•çº¿æ•°æ®ï¼Œé‚£ä¹ˆé€šè¿‡D3DXLoadMeshFromXåˆ›å»ºçš„ID3DXMeshå¯¹è±¡åœ¨å®ƒçš„é¡¶ç‚¹æ ¼å¼ä¸­æ²¡æœ‰æŒ‡å®šçš„D3DFVF_NORMALæ ‡è®°ã€‚å› æ­¤ï¼Œåœ¨æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨D3DXComputeNormalsä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»å¤åˆ¶meshå¹¶ä¸”ä¸ºå…¶æŒ‡å®šåŒ…å«D3DFVF_NORMALçš„é¡¶ç‚¹æ ¼å¼ã€‚ä¸‹é¢å°±æ˜¯ç›¸åº”çš„ä»£ç ï¼š// does the mesh have a D3DFVF_NORMAL in its vertex format?if ( !(pMesh-&gt;GetFVF() &amp; D3DFVF_NORMAL) ){ // no, so clone a new mesh and add D3DFVF_NORMAL to its format: ID3DXMesh pTempMesh = 0; pMesh-&gt;CloneMeshFVF( D3DXMESH_MANAGED, pMesh-&gt;GetFVF() | D3DFVF_NORMAL, // add it here Device, &amp;pTempMesh ); // compute the normals: D3DXComputeNormals( pTempMesh, 0 ); pMesh-&gt;Release(); // get rid of the old mesh pMesh = pTempMesh; // save the new mesh with normals }11.3æ¸è¿›ç½‘æ ¼ï¼ˆProgressive Meshesï¼‰ æ¸è¿›ç½‘æ ¼ï¼Œå®ƒé€šè¿‡ID3DXPMeshæ¥å£æ¥è¡¨ç°ï¼Œå…è®¸æˆ‘ä»¬é€šè¿‡ç®€åŒ–è¾¹ç¼©å‡è½¬æ¢ï¼ˆedge collapse transformationsï¼ŒECTï¼‰æ¥ç®€åŒ–meshã€‚æ¯æ‰§è¡Œä¸€æ¬¡ECTå°±ç§»é™¤ä¸€ä¸ªé¡¶ç‚¹å’Œä¸€æˆ–2ä¸ªé¢ã€‚å› ä¸ºæ¯ä¸ªECTæ˜¯å¯é€†çš„ï¼ˆå®ƒçš„é€†è¿‡ç¨‹å«é¡¶ç‚¹åˆ†è£‚ï¼‰ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé€†è½¬ç®€åŒ–è¿‡ç¨‹å¹¶ä¸”æ¢å¤meshä¸ºå®ƒçš„åŸå§‹çŠ¶æ€ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¸å¯èƒ½å¾—åˆ°æ¯”åŸå§‹æƒ…å†µè¿˜è¦ç²¾ç»†çš„ç½‘æ ¼ã€‚æˆ‘ä»¬ä»…ä»…åªèƒ½ç®€åŒ–ç„¶åæ¢å¤ç®€åŒ–æ“ä½œã€‚å›¾11.2æ˜¾ç¤ºäº†åŒä¸€ä¸ªmeshçš„ä¸‰ç§ä¸åŒç²¾ç»†çº§åˆ«ï¼ˆlevels of detailï¼ŒLODï¼‰ï¼šé«˜ï¼Œä¸­ï¼Œä½ã€‚ å›¾11.2 æ¸è¿›ç½‘æ ¼å’Œmipmapsçº¹ç†éå¸¸ç›¸ä¼¼ã€‚å½“ä½¿ç”¨çº¹ç†æ—¶ï¼Œæˆ‘ä»¬å·²ç»æ³¨æ„åˆ°åœ¨ä¸€ä¸ªå°æˆ–è¿œçš„å›¾å…ƒä¸Šä½¿ç”¨é«˜åˆ†è¾¨ç‡çš„çº¹ç†ç®€ç›´å°±æ˜¯æµªè´¹ã€‚å¯¹äºmeshä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼›ä¸€ä¸ªå°æˆ–è¿œçš„meshä¸éœ€è¦å¤ªå¤šä¸‰è§’å½¢ï¼Œå¤šäº†ä¹Ÿæ˜¯æµªè´¹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸ä¼šèŠ±è´¹æ¸²æŸ“é«˜ä¸‰è§’å½¢æ¨¡å‹çš„æ—¶é—´æ¥æ¸²æŸ“ä¸€ä¸ªåªéœ€è¦è¡¨ç°å°çš„ä½ä¸‰è§’å½¢æ¨¡å‹ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¸è¿›ç½‘æ ¼æ¥æ ¹æ®æ¨¡å‹è·ç¦»æ‘„è±¡æœºçš„è·ç¦»æ¥è°ƒæ•´æ¨¡å‹çš„LODã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“è·ç¦»å‡å°‘æ—¶ï¼Œæˆ‘ä»¬å¢åŠ meshçš„ç»†èŠ‚ï¼Œå½“è·ç¦»å¢åŠ æ—¶æˆ‘ä»¬å‡å°‘meshçš„ç»†èŠ‚ã€‚ æ³¨æ„æˆ‘ä»¬è¿˜æ²¡æœ‰è®¨è®ºæ¸è¿›ç½‘æ ¼æ˜¯æ€æ ·è¢«å®ç°çš„ï¼›è¿™é‡Œæˆ‘ä»¬åªè®²è§£æ€æ ·ä½¿ç”¨ID3DXPMeshæ¥å£ã€‚å¯¹æ­¤æ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥åˆ°æ¸è¿›ç½‘æ ¼çš„åŸå§‹é¡µé¢Hoppeä¸ŠæŸ¥çœ‹ã€‚Hoppeçš„ç½‘å€ï¼šhttp://research.microsoft.com/~hoppe/ã€‚11.3.1 äº§ç”Ÿä¸€ä¸ªæ¸è¿›ç½‘æ ¼ æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ä¸‹é¢çš„å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªID3DXPMeshå¯¹è±¡ï¼šHRESULT D3DXGeneratePMesh( LPD3DXMESH pMesh, CONST DWORD pAdjacency, CONST LPD3DXATTRIBUTEWEIGHTS pVertexAttributeWeights, CONST FLOAT pVertexWeights, DWORD MinValue, DWORD Options, LPD3DXPMESH *ppPMesh); pMeshâ€” è¾“å…¥åŸå§‹meshï¼Œå®ƒåŒ…å«äº†æˆ‘ä»¬æƒ³è¦ç”Ÿæˆçš„æ¸è¿›ç½‘æ ¼çš„meshæ•°æ®ã€‚ pAdjacency â€” æŒ‡å‘ä¸€ä¸ªåŒ…å«pMeshé‚»æ¥ä¿¡æ¯çš„DWORDæ•°ç»„ã€‚ pVertexAttributeWeights â€” æŒ‡å‘ä¸€ä¸ªD3DXATTRIBUTEWEIGHTSæ•°ç»„ï¼Œå®ƒçš„å¤§å°æ˜¯pMesh-&gt;GetNumVerticesï¼ˆï¼‰ã€‚å®ƒçš„ç¬¬ié¡¹ä¸pMeshä¸­çš„ç¬¬iä¸ªé¡¶ç‚¹ç›¸å¯¹åº”å¹¶ä¸”æŒ‡å®šçš„æ˜¯å®ƒçš„å“è´¨æƒé‡ã€‚å“è´¨æƒé‡è¢«ç”¨æ¥ç¡®å®šä¸€ä¸ªé¡¶ç‚¹è¢«åˆ é™¤çš„å¯èƒ½æ€§å¤§å°ã€‚ä½ èƒ½å¤Ÿå°†æ­¤å‚æ•°è®¾ç½®ä¸ºnullï¼Œå¯¹äºæ¯ä¸ªé¡¶ç‚¹ä¸€ä¸ªé»˜è®¤çš„é¡¶ç‚¹å“è´¨æƒé‡å°†è¢«è®¾ç½®ã€‚åœ¨11.3.2èŠ‚ä¸­æœ‰å…³äºé¡¶ç‚¹å“è´¨æƒé‡å’ŒD3DXATTRIBUTEWEIGHTSç»“æ„çš„æ›´å¤šä¿¡æ¯ã€‚ pVertexWeights â€” æŒ‡å‘ä¸€ä¸ªfloatæ•°ç»„ï¼Œå®ƒçš„å¤§å°æ˜¯pMesh-&gt;GetNumVerticesï¼ˆï¼‰ï¼Œå®ƒçš„ç¬¬ié¡¹ä¸pMeshä¸­çš„ç¬¬iä¸ªé¡¶ç‚¹ç›¸å¯¹åº”å¹¶ä¸”æŒ‡å®šçš„æ˜¯å®ƒçš„é¡¶ç‚¹æƒé‡ã€‚é¡¶ç‚¹æƒé‡è¶Šé«˜è¢«åˆ é™¤çš„å¯èƒ½æ€§è¶Šå°ã€‚ä½ èƒ½å¤Ÿå°†æ­¤å‚æ•°è®¾ç½®ä¸ºnullï¼Œå¯¹äºæ¯ä¸ªé¡¶ç‚¹ä¸€ä¸ªé»˜è®¤çš„é¡¶ç‚¹å“è´¨æƒé‡1.0å°†è¢«è®¾ç½®ã€‚ MinValue â€” æˆ‘ä»¬æƒ³è¦ç®€åŒ–åˆ°çš„æœ€å°é¡¶ç‚¹æˆ–é¢æ•°ã€‚æ³¨æ„è¯¥å€¼æ˜¯å¿…é¡»çš„ï¼Œè€Œä¸”ä¸é¡¶ç‚¹/å“è´¨æƒé‡æœ‰å…³ï¼Œæœ€ç»ˆå¯èƒ½è¾¾ä¸åˆ°è¯¥å€¼ã€‚ Options â€” åªèƒ½å–D3DXMESHSIMPæšä¸¾ç±»å‹ä¸­çš„ä¸€ä¸ªå€¼ï¼š D3DXMESHSIMP_VERTEX â€” æŒ‡å®šåœ¨ä¸Šä¸€ä¸ªå‚æ•°MinValueä¸­æåˆ°çš„æ•°ä¸ºé¡¶ç‚¹æ•°ã€‚ D3DXMESHSIMP_FACE â€”æŒ‡å®šåœ¨ä¸Šä¸€ä¸ªå‚æ•°MinValueä¸­æåˆ°çš„æ•°ä¸ºé¢æ•°ã€‚ ppPMesh â€” è¿”å›ç”Ÿæˆå¥½çš„æ¸è¿›ç½‘æ ¼ã€‚11.3.2 é¡¶ç‚¹å“è´¨æƒé‡typedef struct _D3DXATTRIBUTEWEIGHTS { FLOAT Position; FLOAT Boundary; FLOAT Normal; FLOAT Diffuse; FLOAT Specular; FLOAT Texcoord[8]; FLOAT Tangent; FLOAT Binormal;} D3DXATTRIBUTEWEIGHTS; é¡¶ç‚¹æƒé‡ç»“æ„å…è®¸æˆ‘ä»¬ä¸ºæ¯ä¸ªé¡¶ç‚¹å±æ€§æŒ‡å®šä¸€ä¸ªæƒå€¼ã€‚0.0è¡¨ç¤ºè¯¥å±æ€§æ²¡æœ‰æƒé‡ã€‚é¡¶ç‚¹å±æ€§çš„æƒé‡è¶Šé«˜åœ¨ç®€åŒ–è¿‡ç¨‹ä¸­è¢«ç§»é™¤çš„å¯èƒ½æ€§è¶Šå°ã€‚é»˜è®¤çš„æƒå€¼å¦‚ä¸‹ï¼šD3DXATTRIBUTEWEIGHTS AttributeWeights;AttributeWeights.Position = 1.0;AttributeWeights.Boundary = 1.0;AttributeWeights.Normal = 1.0;AttributeWeights.Diffuse = 0.0;AttributeWeights.Specular = 0.0;AttributeWeights.Tex[8] = {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}; é»˜è®¤çš„æƒå€¼æ˜¯è¢«æ¨èçš„ï¼Œé™¤éä½ çš„åº”ç”¨ç¨‹åºæœ‰ä¸€ä¸ªé‡è¦çš„ç†ç”±è€Œä¸ä½¿ç”¨å®ƒã€‚11.3.3 ID3DXPMeshæ–¹æ³• ID3DXPMeshæ¥å£æ˜¯ç»§æ‰¿è‡ªID3DXBaseMeshæ¥å£ã€‚å› æ­¤å®ƒæ‹¥æœ‰ä»¥å‰æ‰€å­¦ä¹ è¿‡çš„ID3DXMeshçš„æ‰€æœ‰å‡½æ•°ï¼Œä¸‹é¢æ˜¯ä¸€äº›é¢å¤–çš„æ–¹æ³•ï¼šDWORD GetMaxFaces(VOID)â€”â€”è¿”å›æ¸è¿›ç½‘æ ¼èƒ½å¤Ÿè¢«è®¾ç½®çš„æœ€å¤§é¢æ•°ã€‚DWORD GetMaxVertices(VOID)â€”â€”è¿”å›æ¸è¿›ç½‘æ ¼èƒ½å¤Ÿè¢«è®¾ç½®çš„æœ€å¤§é¡¶ç‚¹æ•°ã€‚DWORD GetMinFaces(VOID)â€”â€”è¿”å›æ¸è¿›ç½‘æ ¼èƒ½å¤Ÿè¢«è®¾ç½®çš„æœ€å°é¢æ•°ã€‚DWORD GetMinVertices(VOID)â€”â€”è¿”å›æ¸è¿›ç½‘æ ¼èƒ½å¤Ÿè¢«è®¾ç½®çš„æœ€å°é¡¶ç‚¹æ•°ã€‚HRESULT SetNumFaces(DWORD Faces)â€”â€”è¿™ä¸ªæ–¹æ³•å…è®¸æˆ‘ä»¬è®¾ç½®é¢çš„ä¸ªæ•°ï¼Œä»¥ä¾¿è®©meshç®€åŒ–/å¤æ‚åŒ–ã€‚ä¾‹å¦‚ï¼Œå‡è®¾meshç›®å‰æœ‰50ä¸ªé¢ï¼Œæˆ‘ä»¬ç°åœ¨æƒ³å°†å®ƒç®€åŒ–åˆ°30ä¸ªé¢ï¼›æˆ‘ä»¬å°†å†™æˆï¼špmesh-&gt;SetNumFaces(30); æ³¨æ„è°ƒæ•´åçš„é¢æ•°å¯èƒ½å¹¶ä¸æ˜¯æˆ‘ä»¬è®¾å®šçš„é¢æ•°ã€‚å‡å¦‚é¢æ•°å°äºäº†GetMinFacesï¼ˆï¼‰ï¼Œé‚£ä¹ˆé¢æ•°å°†ä¸ºGetMinFacesï¼ˆï¼‰ã€‚åŒæ ·çš„ï¼Œå‡å¦‚é¢æ•°å¤§äºäº†GetMaxFacesï¼ˆï¼‰ï¼Œé‚£ä¹ˆé¢æ•°å°†ä¸ºGetMaxFacesï¼ˆï¼‰ã€‚HRESULT SetNumVertices(DWORD Vertices)â€”â€”è¿™ä¸ªæ–¹æ³•å…è®¸æˆ‘ä»¬è®¾ç½®é¡¶ç‚¹çš„ä¸ªæ•°ï¼Œä»¥ä¾¿è®©meshç®€åŒ–/å¤æ‚åŒ–ã€‚ä¾‹å¦‚ï¼Œå‡è®¾meshç›®å‰æœ‰20ä¸ªé¡¶ç‚¹ï¼Œæˆ‘ä»¬ç°åœ¨æƒ³å°†å®ƒå¢åŠ åˆ°40ä¸ªï¼›æˆ‘ä»¬å°†å†™æˆï¼špmesh-&gt;SetNumVertices(40); æ³¨æ„è°ƒæ•´åçš„é¡¶ç‚¹æ•°å¯èƒ½å¹¶ä¸æ˜¯æˆ‘ä»¬è®¾å®šçš„æ•°ã€‚å‡å¦‚é¡¶ç‚¹æ•°å°äºäº†GetMinVerticesï¼ˆï¼‰ï¼Œé‚£ä¹ˆé¡¶ç‚¹æ•°å°†ä¸ºGetMinVerticesï¼ˆï¼‰ã€‚åŒæ ·çš„ï¼Œå‡å¦‚é¡¶ç‚¹æ•°å¤§äºäº†GetMaxVerticesï¼ˆï¼‰ï¼Œé‚£ä¹ˆé¡¶ç‚¹æ•°å°†ä¸ºGetMaxVerticesï¼ˆï¼‰ã€‚HRESULT TrimByFaces(DWORD NewFacesMin,DWORD NewFacesMax,DWORD rgiFaceRemap, // Face remap info.DWORD rgiVertRemap // Vertex remap info.); è¿™ä¸ªæ–¹æ³•å…è®¸æˆ‘ä»¬è®¾ç½®æ–°çš„æœ€å°å’Œæœ€å¤§é¢æ•°ï¼Œåˆ†åˆ«é€šè¿‡NewFacesMinå’ŒNewFacesMaxæŒ‡å®šã€‚æ³¨æ„æ–°çš„æœ€å°å’Œæœ€å¤§å€¼å¿…é¡»åœ¨ç°æœ‰æœ€å°å’Œæœ€å¤§é¢æ•°ä¹‹é—´ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œå¿…é¡»åœ¨[GetMinFacesï¼ˆï¼‰ï¼ŒGetMaxFacesï¼ˆï¼‰]ä¹‹ä¸­ã€‚è¯¥å‡½æ•°ä¹Ÿè¿”å›é¢å’Œé¡¶ç‚¹çš„é‡å½±å°„ä¿¡æ¯ã€‚é‡å½±å°„ä¿¡æ¯å‚è§10.4èŠ‚ã€‚HRESULT TrimByVertices(DWORD NewVerticesMin,DWORD NewVerticesMax,DWORD rgiFaceRemap, // Face remap info.DWORD rgiVertRemap // Vertex remap info.); è¿™ä¸ªæ–¹æ³•å…è®¸æˆ‘ä»¬è®¾ç½®æ–°çš„æœ€å°å’Œæœ€å¤§é¡¶ç‚¹æ•°ï¼Œåˆ†åˆ«é€šè¿‡NewVerticesMinå’ŒNewVerticesMaxæŒ‡å®šã€‚æ³¨æ„æ–°çš„æœ€å°å’Œæœ€å¤§å€¼å¿…é¡»åœ¨ç°æœ‰æœ€å°å’Œæœ€å¤§é¡¶ç‚¹æ•°ä¹‹é—´ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œå¿…é¡»åœ¨[GetMinVerticesï¼ˆï¼‰ï¼ŒGetMaxVerticesï¼ˆï¼‰]ä¹‹ä¸­ã€‚è¯¥å‡½æ•°ä¹Ÿè¿”å›é¢å’Œé¡¶ç‚¹çš„é‡å½±å°„ä¿¡æ¯ã€‚é‡å½±å°„ä¿¡æ¯å‚è§10.4èŠ‚ã€‚11.3.4å®ä¾‹ç¨‹åºï¼šæ¸è¿›ç½‘æ ¼ æ¸è¿›ç½‘æ ¼ä¾‹å­ä¸Xæ–‡ä»¶ä¾‹å­å¾ˆç›¸ä¼¼ï¼Œé™¤äº†å®é™…ä¸Šæˆ‘ä»¬åˆ›å»ºå’Œæ¸²æŸ“çš„æ˜¯ä¸€ä¸ªæ¸è¿›ç½‘æ ¼ï¼Œé€šè¿‡ID3DXPMeshæ¥å£æ¥è¡¨ç°ã€‚æˆ‘ä»¬å…è®¸ç”¨æˆ·é€šè¿‡é”®ç›˜è¾“å…¥è¿›è¡Œäº¤äº’å¼åœ°æ”¹å˜æ¸è¿›ç½‘æ ¼ã€‚ä½ èƒ½é€šè¿‡æŒ‰Aé”®æ¥å¢åŠ meshçš„é¢æ•°ï¼ŒæŒ‰Sé”®æ¥å‡å°‘meshçš„é¢æ•°ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ä½¿ç”¨çš„å…¨å±€å˜é‡å’ŒXæ–‡ä»¶ä¾‹å­ä¸­çš„æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡æˆ‘ä»¬å¢åŠ äº†ä¸€ä¸ªç”¨æ¥å­˜å‚¨æ¸è¿›ç½‘æ ¼çš„å˜é‡ï¼šID3DXMesh SourceMesh = 0;ID3DXPMesh PMesh = 0; // progressive meshstd::vector Mtrls(0);std::vector Textures(0); å›æƒ³ä¸€ä¸‹ï¼Œä¸ºäº†å¾—åˆ°ä¸€ä¸ªæ¸è¿›ç½‘æ ¼æˆ‘ä»¬å¿…é¡»è¾“å…¥ä¸€ä¸ªåŒ…å«äº†æ•°æ®ä¿¡æ¯çš„æºmeshã€‚å› æ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆè¯»å–ä¸€ä¸ªXæ–‡ä»¶æ•°æ®åˆ°ID3DXMeshå¯¹è±¡SourceMeshä¹‹ä¸­ï¼Œç„¶åå†äº§ç”Ÿæ¸è¿›ç½‘æ ¼ï¼šbool Setup(){ HRESULT hr = 0; // â€¦Load XFile data into SourceMesh snipped. // // â€¦Extracting materials and textures snipped. å› ä¸ºè¿™ä¸€éƒ¨åˆ†ä»£ç å’ŒXæ–‡ä»¶ä¾‹å­ä¸­çš„æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°±æŠŠå®ƒçœç•¥äº†ã€‚ä¸€ä½†æœ‰äº†æºmeshï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿè±¡ä¸‹é¢ä¸€æ ·æ¥ç”Ÿæˆæ¸è¿›ç½‘æ ¼äº†ï¼š // // Generate the progressive mesh. // hr = D3DXGeneratePMesh( SourceMesh, (DWORD*)adjBuffer-&gt;GetBufferPointer(), // adjacency 0, // default vertex attribute weights 0, // default vertex weights 1, // simplify as low as possible D3DXMESHSIMP_FACE, // simplify by face count &amp;PMesh); d3d::Release(SourceMesh); // done w/ source mesh d3d::Release(adjBuffer); // done w/ buffer if(FAILED(hr)) { ::MessageBox(0, &quot;D3DXGeneratePMesh() - FAILED&quot;, 0, 0); return false; } æ³¨æ„ï¼Œå› ä¸ºé¡¶ç‚¹/å“è´¨æƒå€¼çš„ç¼˜æ•…ï¼Œå¾ˆéš¾å°†Meshç®€åŒ–åˆ°åªæœ‰ä¸€ä¸ªé¢ï¼Œä½†æ˜¯ï¼Œå¦‚æœå°†å…¶æŒ‡å®šä¸º1ï¼Œåˆ™å¯ä»¥å°†Meshç®€åŒ–åˆ°æœ€ä½ã€‚ åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæ¸è¿›ç½‘æ ¼å·²ç»è¢«äº§ç”Ÿäº†ï¼Œä½†æ˜¯å‡å¦‚ä½ ç°åœ¨å°±æ¸²æŸ“å®ƒï¼Œå®ƒå°†ä»¥æœ€ç®€åŒ–çš„æ–¹å¼æ¥æ¸²æŸ“ã€‚ä»¥ä¸ºæˆ‘ä»¬æƒ³å¼€å§‹æ¸²æŸ“æœ€é«˜ç²¾åº¦çš„meshï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾ç½®å®ƒä¸ºï¼š // set to original detail DWORD maxFaces = PMesh-&gt;GetMaxFaces(); PMesh-&gt;SetNumFaces(maxFaces); åœ¨Displayå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æµ‹è¯•Aé”®å’ŒSé”®å¹¶å°†ç»“æœè¾“å…¥ã€‚bool Display(float timeDelta){ if( Device ) { // // Update: Mesh resolution. // // Get the current number of faces the pmesh has. int numFaces = PMesh-&gt;GetNumFaces(); // Add a face, note the SetNumFaces() will automatically // clamp the specified value if it goes out of bounds. if( ::GetAsyncKeyState(&#39;A&#39;) &amp; 0x8000f ) { // Sometimes we must add more than one face to invert // an edge collapse transformation PMesh-&gt;SetNumFaces( numFaces + 1 ); if( PMesh-&gt;GetNumFaces() == numFaces ) PMesh-&gt;SetNumFaces( numFaces + 2 ); } // Remove a face, note the SetNumFaces() will automatically // clamp the specified value if it goes out of bounds. if( ::GetAsyncKeyState(&#39;S&#39;) &amp; 0x8000f ) PMesh-&gt;SetNumFaces( numFaces - 1 ); è¿™æ˜¯å¾ˆç®€å•çš„ï¼Œä½†æ˜¯è¦æ³¨æ„å½“å¢åŠ é¢æ—¶æˆ‘ä»¬æœ‰æ—¶å¿…é¡»å¢åŠ ä¸¤ä¸ªé¢æ¥å®ŒæˆECTã€‚ æœ€åï¼Œæˆ‘ä»¬å°±èƒ½è±¡æ¸²æŸ“ID3DXMeshå¯¹è±¡ä¸€æ ·æ¥æ¸²æŸ“ID3DXPMeshå¯¹è±¡ã€‚å¦å¤–ï¼Œä¸ºäº†æ›´åŠ ç›´è§‚çš„è§‚å¯Ÿç½‘æ ¼çš„ä¸‰è§’å½¢æ•°çš„å˜åŒ–æƒ…å†µï¼Œä½¿ç”¨é»„è‰²æè´¨åœ¨çº¿æ¡†æ¨¡å¼ï¼ˆWireframe Modeï¼‰ä¸‹æ¸²æŸ“Meshçš„ä¸‰è§’å½¢ã€‚ Device-&gt;Clear(0, 0, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER, 0xffffffff, 1.0f, 0); Device-&gt;BeginScene(); for(int i = 0; i &lt; Mtrls.size(); i++) { // draw pmesh Device-&gt;SetMaterial( &amp;Mtrls[i] ); Device-&gt;SetTexture(0, Textures[i]); PMesh-&gt;DrawSubset(i); // draw wireframe outline Device-&gt;SetMaterial(&amp;d3d::YELLOW_MTRL); Device-&gt;SetRenderState(D3DRS_FILLMODE, D3DFILL_WIREFRAME); PMesh-&gt;DrawSubset(i); Device-&gt;SetRenderState(D3DRS_FILLMODE, D3DFILL_SOLID); } Device-&gt;EndScene(); Device-&gt;Present(0, 0, 0, 0); } return true;} å›¾11.311.4 ç•Œçº¿å®¹ç§¯ï¼ˆBounding Volumesï¼‰ æœ‰æ—¶æˆ‘ä»¬éœ€è¦è®¡ç®—meshçš„ç•Œçº¿å®¹ç§¯ï¼ˆè¾¹ç•ŒèŒƒå›´ï¼‰ã€‚å¸¸ç”¨çš„æœ‰ä¸¤ç§ç±»å‹ï¼šç«‹æ–¹ä½“å’Œçƒã€‚ä¹Ÿæœ‰ä½¿ç”¨å…¶å®ƒæ–¹æ³•çš„ï¼Œå¦‚åœ†æŸ±ä½“ï¼Œæ¤­çƒä½“ï¼Œè±å½¢ä½“ï¼Œèƒ¶å›Šå½¢ã€‚å›¾11.4æ¼”ç¤ºäº†å¯¹åŒä¸€ä¸ªmeshåˆ†åˆ«ä½¿ç”¨ç«‹æ–¹ä½“å’Œçƒä½“ç±»å‹ã€‚è¿™ä¸€èŠ‚æˆ‘ä»¬åªè®¨è®ºç«‹æ–¹ä½“å’Œçƒä½“ä¸¤ç§è¾¹ç•Œå½¢å¼ã€‚ å›¾11.4 è¾¹ç•Œç›’/çƒå¸¸å¸¸è¢«ç”¨æ¥åŠ é€Ÿå¯è§æ€§æµ‹è¯•ï¼Œç¢°æ’æ£€æµ‹ç­‰ã€‚ä¾‹å¦‚ï¼Œå‡å¦‚ä¸€ä¸ªmeshçš„è¾¹ç•Œç›’/çƒä¸å¯è§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¯´meshä¸å¯è§ã€‚ä¸€ä¸ªç›’/çƒå¯è§æ€§æµ‹è¯•æ˜¯æ¯”åˆ†åˆ«æµ‹è¯•meshä¸­çš„æ¯ä¸ªä¸‰è§’å½¢è¦å»‰ä»·çš„å¤šã€‚å¯¹äºä¸€ä¸ªç¢°æ’æ£€æµ‹ä¾‹å­ï¼Œå¦‚æœä¸€æšå¯¼å¼¹ç‚¹ç«èµ·é£ï¼Œæˆ‘ä»¬éœ€è¦æ£€æµ‹å®ƒæ˜¯å¦å‡»ä¸­äº†åŒä¸€åœºæ™¯ä¸­çš„ç›®æ ‡ã€‚ç”±äºè¿™äº›ç‰©ä½“éƒ½æ˜¯ç”±å¤§é‡ä¸‰è§’å½¢æ„æˆï¼Œæˆ‘ä»¬å¯ä»¥ä¾æ¬¡æ£€æµ‹æ¯ä¸ªå¯¹è±¡çš„æ¯ä¸ªä¸‰è§’å½¢ï¼Œæ¥æµ‹è¯•å¯¼å¼¹ï¼ˆå¯ä»¥ç”¨å°„çº¿æ•°å­¦æ¨¡å‹ï¼‰æ˜¯å¦ç¢°æ’åˆ°äº†è¿™äº›ä¸‰è§’å½¢ã€‚è¿™ä¸ªæ–¹æ³•éœ€è¦è¿›è¡Œå¤šæ¬¡çš„å°„çº¿/ä¸‰è§’å½¢äº¤ç‚¹çš„è¿ç®—ã€‚ä¸€ä¸ªæ›´å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨è¾¹ç•Œç›’æˆ–è¾¹ç•Œçƒï¼Œè®¡ç®—å°„çº¿ä¸åœºæ™¯ä¸­çš„æ¯ä¸ªå¯¹è±¡çš„è¾¹ç•Œç›’/è¾¹ç•Œçƒçš„äº¤ç‚¹ã€‚å¦‚æœå°„çº¿ä¸å¯¹è±¡çš„è¾¹ç•ŒèŒƒå›´ç›¸äº¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥å¯¹è±¡è¢«å‡»ä¸­äº†ã€‚è¿™æ˜¯ä¸€ä¸ªå…¬å¹³çš„è¿‘ä¼¼æ–¹æ³•ï¼Œå¦‚æœéœ€è¦æ›´é«˜çš„ç²¾åº¦ï¼Œå¯ä»¥ç”¨è¾¹ç•ŒèŒƒå›´æ³•å…ˆå»é™¤é‚£äº›æ˜æ˜¾ä¸ä¼šç›¸æ’çš„å¯¹è±¡ï¼Œç„¶åç”¨æ›´ç²¾ç¡®åœ°æ–¹æ³•æ£€æµ‹å¾ˆå¯èƒ½ç›¸æ’çš„å¯¹è±¡ã€‚å¦‚æœè¾¹ç•ŒèŒƒå›´æ£€æµ‹å‘ç°ç›¸æ’ï¼Œåˆ™è¯¥å¯¹è±¡å°±å¾ˆæœ‰å¯èƒ½ç›¸æ’ã€‚ D3DXåº“æä¾›äº†è®¡ç®—meshçš„è¾¹ç•Œç›’å’Œè¾¹ç•Œçƒçš„å‡½æ•°ã€‚è¿™äº›å‡½æ•°ä½¿ç”¨é¡¶ç‚¹æ•°ç»„ä½œä¸ºè¾“å…¥è®¡ç®—è¾¹ç•Œç›’/çƒã€‚è¿™äº›å‡½æ•°æœ¬æ¥å°±æ˜¯è®¾è®¡çš„å¾ˆçµæ´»çš„ï¼Œå®ƒä»¬å¯ä»¥ä½¿ç”¨å„ç§é¡¶ç‚¹æ ¼å¼ï¼šHRESULT D3DXComputeBoundingSphere( LPD3DXVECTOR3 pFirstPosition, DWORD NumVertices, DWORD dwStride, D3DXVECTOR3 pCenter, FLOAT pRadius); pFirstPositionâ€”â€”æŒ‡å‘åœ¨é¡¶ç‚¹æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªé¡¶ç‚¹çš„å‘é‡ï¼Œæè¿°é¡¶ç‚¹ä½ç½®ã€‚ NumVerticesâ€”â€”åœ¨é¡¶ç‚¹æ•°ç»„ä¸­çš„çš„é¡¶ç‚¹æ•°ã€‚ dwStrideâ€”â€”æ¯ä¸ªé¡¶ç‚¹çš„å­—èŠ‚å¤§å°ã€‚è¿™æ˜¯å¾ˆéœ€è¦çš„ï¼Œå› ä¸ºé¡¶ç‚¹ç»“æ„å¯èƒ½æœ‰ä¸€äº›é¢å¤–ä¿¡æ¯å¦‚æ³•å‘é‡å’Œçº¹ç†åæ ‡ï¼Œè¿™äº›ä¿¡æ¯å¯¹è®¡ç®—è¾¹ç•Œåˆæ²¡æœ‰ç”¨ï¼Œå‡½æ•°éœ€è¦çŸ¥é“åº”è¯¥è·³è¿‡å¤šå°‘å­—èŠ‚æ¥å¾—åˆ°ä¸‹ä¸€ä¸ªé¡¶ç‚¹çš„ä½ç½®ã€‚ pCenterâ€”â€”è¿”å›è¾¹ç•Œçƒçš„ä¸­å¿ƒã€‚ pRadiusâ€”â€”è¿”å›è¾¹ç•Œçƒçš„åŠå¾„ã€‚HRESULT D3DXComputeBoundingBox( LPD3DXVECTOR3 pFirstPosition, DWORD NumVertices, DWORD dwStride, D3DXVECTOR3 pMin, D3DXVECTOR3 pMax);å‰ä¸‰ä¸ªå‚æ•°å’ŒD3DXComputeBoundingSphereçš„å‰ä¸‰ä¸ªå‚æ•°æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚æœ€åä¸¤ä¸ªå‚æ•°åˆ†åˆ«ç”¨æ¥è¿”å›è¾¹ç•Œç›’çš„æœ€å°å’Œæœ€å¤§ç‚¹ã€‚11.4.1ä¸€äº›æ–°çš„ç‰¹æ®Šå¸¸é‡è®©æˆ‘æ¥ä»‹ç»ä¸¤ä¸ªå¸¸é‡ï¼Œå®ƒä»¬åœ¨æœ¬ä¹¦ä¸­æ˜¯ç»å¸¸è¦ç”¨åˆ°çš„ã€‚æˆ‘ä»¬æŠŠå®ƒä»¬æ·»åŠ åˆ°d3dåç§°ç©ºé—´ä¸­ï¼šnamespace d3d{ â€¦ const float INFINITY = FLT_MAX; const float EPSILON = 0.001f;å¸¸é‡INFINITYæ˜¯ç”¨æ¥è¡¨ç¤ºä¸€ä¸ªæµ®ç‚¹æ•°æ‰€èƒ½å­˜å‚¨çš„æœ€å¤§æ•°ã€‚å› ä¸ºæˆ‘ä»¬æ‰¾ä¸åˆ°ä¸€ä¸ªæ¯”FLT_MAXè¿˜è¦å¤§çš„æµ®ç‚¹æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒè§†ä¸ºæ— ç©·å¤§ã€‚å¸¸é‡EPSILONæ˜¯ä¸€ä¸ªå¾ˆå°çš„å€¼ï¼Œæˆ‘ä»¬è¿™æ ·å®šä¹‰å®ƒï¼Œå‡¡æ˜¯æ¯”å®ƒå°çš„æ•°å°±è§†ä¸º0ã€‚è¿™ä¹Ÿæ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œå› ä¸ºå¾—åˆ°çš„æµ®ç‚¹æ˜¯ä¸ç²¾ç¡®çš„ï¼Œä¸€ä¸ªè¢«è¯»ä½œ0çš„æ•°å¯èƒ½æœ‰ä¸€ç‚¹ç‚¹å°åå·®ã€‚å› æ­¤ï¼Œè®©å®ƒå’Œ0æ¯”è¾ƒç›¸ç­‰è‚¯å®šä¼šå¤±è´¥ã€‚æˆ‘ä»¬å› æ­¤å¯ä»¥é€šè¿‡æŠŠè¯¥å€¼ä¸0çš„å·®å€¼ä¸EPSILONæ¯”è¾ƒæ¥ç¡®å®šæ˜¯å¦ç›¸ç­‰ï¼šbool Equals(float lhs, float rhs){ // if lhs == rhs their difference should be zero return fabs(lhs - rhs) &lt; EPSILON ? true : false;}11.4.2ç•Œçº¿å®¹ç§¯ç±»å‹ ä¸ºäº†æ›´å®¹æ˜“çš„ä½¿ç”¨è¾¹ç•Œç›’å’Œè¾¹ç•Œçƒï¼Œæˆ‘ä»¬å°†å®ƒä»¬åˆ†åˆ«å°è£…åˆ°ä¸¤ä¸ªç±»ä¸­ã€‚ç°åœ¨åœ¨d3dåç§°ç©ºé—´ä¸­å®šä¹‰ç±»ï¼šstruct BoundingBox{ BoundingBox(); bool isPointInside(D3DXVECTOR3&amp; p); D3DXVECTOR3 _min; D3DXVECTOR3 _max;};struct BoundingSphere{ BoundingSphere(); D3DXVECTOR3 _center; float _radius;};d3d::BoundingBox::BoundingBox(){ // infinite small bounding box _min.x = d3d::INFINITY; _min.y = d3d::INFINITY; _min.z = d3d::INFINITY; _max.x = -d3d::INFINITY; _max.y = -d3d::INFINITY; _max.z = -d3d::INFINITY;}bool d3d::BoundingBox::isPointInside(D3DXVECTOR3&amp; p){ // is the point inside the bounding box? if(p.x &gt;= _min.x &amp;&amp; p.y &gt;= _min.y &amp;&amp; p.z &gt;= _min.z &amp;&amp; p.x &lt;= _max.x &amp;&amp; p.y &lt;= _max.y &amp;&amp; p.z &lt;= _max.z) { return true; } else { return false; }}d3d::BoundingSphere::BoundingSphere(){ _radius = 0.0f;}11.4.3å®ä¾‹ç¨‹åºï¼šç•Œçº¿å®¹ç§¯ åœ¨è¿™ä¸€ç« ä¸­è¢«å«åšç•Œçº¿å®¹ç§¯çš„å®ä¾‹ç¨‹åºä¸»è¦æ˜¯æ¼”ç¤ºä½¿ç”¨D3DXComputeBoundingSphereå’ŒD3DXComputeBoundingBoxã€‚ç¨‹åºè¯»å–ä¸€ä¸ªXæ–‡ä»¶å¹¶ä¸”è®¡ç®—è¯¥meshçš„è¾¹ç•Œçƒã€‚å®ƒåˆ›å»ºä¸¤ä¸ªID3DXMeshå¯¹è±¡ï¼Œä¸€ä¸ªç”¨æ¥ä½œä¸ºè¾¹ç•Œçƒæ¨¡å‹ä¸€ä¸ªç”¨æ¥ä½œä¸ºè¾¹ç•Œç›’æ¨¡å‹ã€‚Xæ–‡ä»¶ç”Ÿæˆçš„meshè¢«æ¸²æŸ“ï¼Œå…¶ä¸­çš„è¾¹ç•Œçƒæˆ–è¾¹ç•Œç›’ä¸å¯è§ï¼ˆå¦‚å›¾11.5ï¼‰ã€‚ä½ èƒ½å¤Ÿé€šè¿‡æ•²ç©ºæ ¼é”®æ¥å†è¾¹ç•Œçƒå’Œè¾¹ç•Œç›’ä¹‹é—´åˆ‡æ¢ã€‚ å›¾11.5 è¿™ä¸ªä¾‹å­æ˜¯éå¸¸ç®€å•çš„ï¼Œæˆ‘ä»¬åˆ—å‡ºä½ è¦å­¦ä¹ çš„ä»£ç ã€‚æˆ‘ä»¬å®ç°çš„ä¸¤ä¸ªå‡½æ•°æ˜¯ç”¨æ¥è®¡ç®—ç½‘æ ¼çš„è¾¹ç•Œçƒå’Œè¾¹ç•Œç›’çš„ï¼šbool ComputeBoundingSphere( ID3DXMesh mesh, // mesh to compute bounding sphere for d3d::BoundingSphere sphere) // return bounding sphere{ HRESULT hr = 0; BYTE* v = 0; mesh-&gt;LockVertexBuffer(0, (void**)&amp;v); hr = D3DXComputeBoundingSphere( (D3DXVECTOR3*)v, mesh-&gt;GetNumVertices(), D3DXGetFVFVertexSize(mesh-&gt;GetFVF()), &amp;sphere-&gt;_center, &amp;sphere-&gt;_radius); mesh-&gt;UnlockVertexBuffer(); if( FAILED(hr) ) return false; return true; } bool ComputeBoundingBox( ID3DXMesh mesh, // mesh to compute bounding box for d3d::BoundingBox box) // return bounding box{ HRESULT hr = 0; BYTE* v = 0; mesh-&gt;LockVertexBuffer(0, (void**)&amp;v); hr = D3DXComputeBoundingBox( (D3DXVECTOR3*)v, mesh-&gt;GetNumVertices(), D3DXGetFVFVertexSize(mesh-&gt;GetFVF()), &amp;box-&gt;_min, &amp;box-&gt;_max); mesh-&gt;UnlockVertexBuffer(); if( FAILED(hr) ) return false; return true; } æ³¨æ„ï¼Œç±»å‹è½¬æ¢(D3DXVECTOR3*)vå‡å®šé¡¶ç‚¹ä½ç½®æˆå‘˜æ˜¯è¢«å­˜å‚¨åœ¨æˆ‘ä»¬æ‰€ä½¿ç”¨çš„é¡¶ç‚¹ç»“æ„çš„å¼€å§‹ä½ç½®ã€‚åŒæ ·è¦æ³¨æ„æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨D3DXGetFVFVertexSizeå‡½æ•°æ¥å¾—åˆ°é¡¶ç‚¹ç»“æ„çš„å¤§å°ã€‚11.5 æ‘˜è¦(ç•¥) ç¬¬åäºŒç«  åˆ›å»ºçµæ´»çš„æ‘„åƒæœºç±»(Building a Flexible Camera Class) è¿„ä»Šï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨è¿‡D3DXMatrixLookAtLHå‡½æ•°æ¥è®¡ç®—è§†å›¾ç©ºé—´å˜æ¢çŸ©é˜µã€‚è¿™ä¸ªå‡½æ•°å¯¹äºåœ¨å›ºå®šä½ç½®å¸ƒç½®å’Œå¯¹å‡†æ‘„åƒæœºæ˜¯éå¸¸å¥½ç”¨çš„ï¼Œä¸è¿‡å®ƒçš„ç”¨æˆ·æ¥å£å¯¹äºè¦å“åº”ç”¨æˆ·è¾“å…¥æ¥å®ç°æ‘„åƒæœºç§»åŠ¨å°±ä¸é‚£ä¹ˆå¥½ç”¨äº†ã€‚è¿™å°±æ¿€å‘æˆ‘ä»¬ç”¨æˆ‘ä»¬è‡ªå·±çš„æ–¹æ³•æ¥è§£å†³ã€‚åœ¨è¿™ä¸€ç« æˆ‘ä»¬å±•ç¤ºäº†æ€æ ·å®ç°ä¸€ä¸ªCameraç±»ï¼Œå®ƒä½¿æˆ‘ä»¬èƒ½å¤Ÿæ¯”D3DXMatrixLookAtLHå‡½æ•°æ›´å¥½åœ°æ“ä½œæ‘„åƒæœºï¼Œå¹¶ä¸”å¯ä»¥ç”¨æ¥ä½œä¸ºé£è¡Œæ¨¡æ‹Ÿæ‘„åƒæœºå’Œç¬¬ä¸€äººç§°è§†è§’æ‘„åƒæœºã€‚ç›®æ ‡ å­¦ä¹ æ€æ ·å®ç°ä¸€ä¸ªçµæ´»çš„æ‘„åƒæœºç±»ï¼Œå®ƒå¯ä»¥ç”¨ä½œé£è¡Œæ¨¡æ‹Ÿæ‘„åƒæœºå’Œç¬¬ä¸€äººç§°è§†è§’æ‘„åƒæœºã€‚12.1 æ‘„åƒæœºè®¾è®¡ æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç›¸å¯¹äºä¸–ç•Œåæ ‡ç³»çš„ä½ç½®å’Œæ‘„åƒæœºçš„æ–¹å‘ï¼Œè¿™é‡Œä½¿ç”¨å››ä¸ªæ‘„åƒæœºå‘é‡ï¼šright vector , up vector, look vector ä»¥åŠ position vector, å¦‚å›¾12.1æ‰€ç¤ºã€‚è¿™äº›å‘é‡ç”¨æ¥ä¸ºæ‘„åƒæœºå®šä¹‰ä¸€ä¸ªåæ ‡ç³»æ¥æè¿°åœ¨ä¸–ç•Œåæ ‡ä¸­çš„å¯¹åº”å…³ç³»ã€‚å› ä¸º right ï¼Œup å’Œ look å‘é‡å®šä¹‰äº†æ‘„åƒæœºåœ¨ä¸–ç•Œä¸­çš„æ–¹å‘ï¼Œæˆ‘ä»¬æœ‰æ—¶æŠŠå®ƒä»¬ä¸‰ä¸ªå‘é‡ä¸€èµ·ç§°ä¸ºæ–¹å‘å‘é‡ï¼ˆorientation vectorsï¼‰ã€‚æ–¹å‘å‘é‡å¿…é¡»è¢«æ ‡å‡†åŒ–ã€‚å‡å¦‚å½¼æ­¤äº’ç›¸å‚ç›´ä¸”éƒ½æ˜¯å•ä½é•¿åº¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç§°å®ƒä»¬æ˜¯æ­£äº¤æ ‡å‡†åŒ–å‘é‡ã€‚æˆ‘ä»¬åšè¿™äº›é™åˆ¶æ˜¯å› ä¸ºç­‰ä¸€ä¼šå„¿æˆ‘ä»¬è¦å°†æ–¹å‘å‘é‡æ’å…¥åˆ°ä¸€ä¸ªè¡ŒçŸ©é˜µä¸­ã€‚å› ä¸ºè¡Œå‘é‡æ˜¯æ­£äº¤æ ‡å‡†åŒ–çš„ï¼Œæ‰€ä»¥è¯¥çŸ©é˜µä¹Ÿå°±æ˜¯ç›´äº¤çŸ©é˜µã€‚å›å¿†ä¸€ä¸‹ï¼Œç›´äº¤çŸ©é˜µæœ‰ä¸€ä¸ªç‰¹æ€§å°±æ˜¯å®ƒçš„é€†çŸ©é˜µç­‰äºå®ƒçš„è½¬ç½®çŸ©é˜µã€‚è¿™åœ¨ç­‰ä¸€ä¸‹çš„12.2.1.2èŠ‚ä¸­æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚ å›¾12.1 æœ‰äº†è¿™å››ä¸ªå‘é‡æ¥æè¿°æ‘„åƒæœºï¼Œæˆ‘ä»¬çš„æ‘„åƒæœºå°±èƒ½å¤ŸæŒ‰ç…§ä¸‹é¢å…­ç§æ–¹å¼å˜åŒ–äº†ï¼š å›´ç»•rightå‘é‡æ—‹è½¬ï¼ˆpitchå€¾æ–œï¼‰ å›´ç»•upå‘é‡æ—‹è½¬ï¼ˆyaw åèˆªï¼‰ å›´ç»•lookå‘é‡æ—‹è½¬ï¼ˆroll æ»šè½¬ï¼‰ æ²¿ç€rightå‘é‡å¹³ç§»ï¼ˆstrafeï¼‰ æ²¿ç€upå‘é‡é£è¡Œï¼ˆflyï¼‰ æ²¿ç€lookå‘é‡ç§»åŠ¨ï¼ˆmoveï¼‰é€šè¿‡è¿™å…­ç§æ“ä½œï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ²¿ç€ä¸‰ä¸ªè½´ç§»åŠ¨ä»¥åŠé¥¶ç€ä¸‰ä¸ªè½´æ—‹è½¬ï¼Œè¿™ç»™äº†æˆ‘ä»¬ä¸€ä¸ªå…­åº¦çš„è‡ªç”±ã€‚ä¸‹é¢çš„Cameraç±»å®šä¹‰äº†æˆ‘ä»¬è¦çš„æè¿°æ•°æ®ä»¥åŠæƒ³è¦çš„æ–¹æ³•ï¼š1234567891011121314151617181920212223242526272829class Camera&#123;public: enum CameraType &#123; LANDOBJECT, AIRCRAFT &#125;; Camera(); Camera(CameraType cameraType); ~Camera(); void strafe(float units); // left/right void fly(float units); // up/down void walk(float units); // forward/backward void pitch(float angle); // rotate on right vector void yaw(float angle); // rotate on up vector void roll(float angle); // rotate on look vector void getViewMatrix(D3DXMATRIX* V); void setCameraType(CameraType cameraType); void getPosition(D3DXVECTOR3* pos); void setPosition(D3DXVECTOR3* pos); void getRight(D3DXVECTOR3* right); void getUp(D3DXVECTOR3* up); void getLook(D3DXVECTOR3* look);private: CameraType _cameraType; D3DXVECTOR3 _right; D3DXVECTOR3 _up; D3DXVECTOR3 _look; D3DXVECTOR3 _pos;&#125;; åœ¨ç±»ä¸­æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªè¿˜æ²¡æœ‰è®¨è®ºçš„CameraTypeæšä¸¾ç±»å‹ã€‚ç›®å‰ï¼Œæˆ‘ä»¬çš„æ‘„åƒæœºæ”¯æŒä¸¤ç§æ‘„åƒæœºæ¨¡å¼ï¼ŒLANDOBJECTæ¨¡å¼å’ŒAIRCRAFTæ¨¡å¼ã€‚AIRCRAFTæ¨¡å¼å…è®¸æˆ‘ä»¬åœ¨ç©ºé—´ä¸­å®Œå…¨è‡ªç”±çš„ç§»åŠ¨ã€‚ä¸è¿‡ï¼Œåœ¨æœ‰äº›æ¸¸æˆä¸­ï¼Œæ¯”å¦‚ç¬¬ä¸€äººç§°è®¾è®¡æ¸¸æˆï¼Œäººæ˜¯ä¸èƒ½é£çš„ï¼›å› æ­¤æˆ‘ä»¬å¿…é¡»é™åˆ¶å®ƒåœ¨æŸäº›è½´ä¸Šçš„è¿åŠ¨ã€‚æŒ‡å®šä¸ºLANDOBJECTæ¨¡å¼çš„æ‘„åƒæœºå°±é™åˆ¶äº†è¿™äº›ï¼Œä½ å¯ä»¥åœ¨ä¸‹ä¸€éƒ¨åˆ†çœ‹è§ã€‚12.2 æ‰§è¡Œè¯¦ç»†èµ„æ–™12.2.1è®¡ç®—è§†å›¾çŸ©é˜µ æˆ‘ä»¬ç°åœ¨æ¼”ç¤ºæ€æ ·æ ¹æ®æ‘„åƒæœºå‘é‡æ¥è®¡ç®—è§†å›¾çŸ©é˜µå˜æ¢çš„ã€‚è®© p = (px, py, pz), r = (rx, ry, rz), u = (ux, uy, uz) ä»¥åŠ d = (dx, dy, dz) åˆ†åˆ«è¡¨ç¤º position, right, up ä»¥åŠ look å‘é‡ã€‚ å›å¿†ç¬¬äºŒç« æˆ‘ä»¬æ‰€è¯´çš„ï¼Œè§†å›¾ç©ºé—´å˜æ¢æ˜¯æŒ‡åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­è¿›è¡Œå‡ ä½•å˜æ¢ä»¥ä¾¿å°†ç…§ç›¸æœºå¹³ç§»å˜æ¢åˆ°åæ ‡ç³»çš„æºç‚¹å¹¶æŠŠå®ƒçš„æ–¹å‘æ—‹è½¬è‡³æœå‘Zè½´çš„æ­£æ–¹å‘ï¼ˆå¦‚å›¾12.2ï¼‰ã€‚ å›¾12.2å› æ­¤ï¼Œæˆ‘ä»¬å¸Œæœ›æœ‰ä¸€ä¸ªè±¡è¿™æ ·çš„å˜æ¢çŸ©é˜µV ï¼š pV = (0, 0, 0)â€”çŸ©é˜µVèƒ½å°†æ‘„åƒæœºç§»åŠ¨åˆ°åŸç‚¹ã€‚ rV = (1, 0, 0)â€”çŸ©é˜µVèƒ½å°†æ‘„åƒæœºçš„rightå‘é‡ä¸ä¸–ç•Œåæ ‡ç³»ä¸­çš„xè½´å¯¹é½ã€‚ uV = (0, 1, 0)â€”çŸ©é˜µVèƒ½å°†æ‘„åƒæœºçš„upå‘é‡ä¸ä¸–ç•Œåæ ‡ç³»ä¸­çš„yè½´å¯¹é½ã€‚ dV = (0, 0, 1)â€”çŸ©é˜µVèƒ½å°†æ‘„åƒæœºçš„lookå‘é‡ä¸ä¸–ç•Œåæ ‡ç³»ä¸­çš„zè½´å¯¹é½ã€‚æˆ‘ä»¬èƒ½å°†å˜æ¢ä»»åŠ¡åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š1ï¼‰å¹³ç§»éƒ¨åˆ†ï¼Œå°†æ‘„åƒæœºçš„ä½ç½®ç§»åŠ¨åˆ°åŸç‚¹ï¼›2ï¼‰æ—‹è½¬éƒ¨åˆ†ï¼Œå°†æ‘„åƒæœºçš„æ–¹å‘å‘é‡ä¸ä¸–ç•Œåæ ‡ç³»çš„è½´å¯¹é½ã€‚12.2.1.1 ç¬¬ä¸€éƒ¨åˆ†ï¼šå¹³ç§» å¹³ç§»åªéœ€è¦åˆ©ç”¨ â€“p å°±å¯ç®€å•åœ°å°† p ç§»åŠ¨åˆ°åŸç‚¹ï¼Œå› ä¸º pâ€“p=0ã€‚å› æ­¤æˆ‘ä»¬èƒ½å¤Ÿç”¨ä¸‹é¢çš„çŸ©é˜µæ¥æè¿°è§†å›¾å˜æ¢ä¸­çš„å¹³ç§»éƒ¨åˆ†ï¼š 12.2.1.2 ç¬¬äºŒéƒ¨åˆ†ï¼šæ—‹è½¬ çŸ«æ­£æ‘„åƒæœºçš„ä¸‰ä¸ªæ–¹å‘å‘é‡ä½¿å…¶ä¸ä¸–ç•Œåæ ‡ç³»çš„è½´å¯¹é½éœ€è¦æ›´å¤šçš„å·¥ä½œã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ª33çš„æ—‹è½¬çŸ©é˜µA ï¼Œå®ƒèƒ½å°†rightï¼Œupå’Œlookåˆ†åˆ«ä¸x-ï¼Œy-ä»¥åŠzè½´å¯¹é½ã€‚è¿™ä¸ªçŸ©é˜µå°†æ»¡è¶³å¦‚ä¸‹ä¸‰ä¸ªç­‰å¼ï¼š æ³¨æ„ï¼šæˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨33çŸ©é˜µæ¥å·¥ä½œæ˜¯å› ä¸ºç°åœ¨ä¸éœ€è¦é¢å¤–çš„ä¿¡æ¯æ¥è¡¨ç°æ—‹è½¬ã€‚ç­‰ä¸€ä¸‹æˆ‘ä»¬å°†å®ƒå¢åŠ åˆ°å¸¸ç”¨çš„44çŸ©é˜µã€‚ å› ä¸ºè¿™ä¸‰ä¸ªç­‰å¼éƒ½æœ‰ä¸€ä¸ªç›¸åŒç³»æ•°çŸ©é˜µA ï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½å¤ŸæŠŠå®ƒä»¬åˆåœ¨ä¸€èµ·ã€‚æˆ‘ä»¬æŠŠå®ƒä»¬ä»æ–°å†™åˆ°ä¸€èµ·æ¥ï¼š æ±‚Aæœ‰å¾ˆå¤šæ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“Aæ˜¯Bé€†çŸ©é˜µå› ä¸ºBA = BB-1 = Iã€‚å› ä¸ºB æ˜¯ä¸€ä¸ªç›´äº¤çŸ©é˜µï¼ˆå®ƒçš„è¡Œå‘é‡æ˜¯æ­£äº¤æ ‡å‡†åŒ–çš„ï¼‰ï¼Œæˆ‘ä»¬çŸ¥é“å®ƒçš„é€†çŸ©é˜µå°±æ˜¯å®ƒçš„è½¬ç½®çŸ©é˜µã€‚å› æ­¤ï¼Œå°†æ–¹å‘å‘é‡å’Œä¸–ç•Œåæ ‡ç³»ä¸­çš„åæ ‡è½´å¯¹é½çš„å˜æ¢å¦‚ä¸‹ï¼š 12.2.1.3 å°†ä¸¤éƒ¨åˆ†åˆå¹¶ æœ€åï¼Œå°†Aå¢åŠ ä¸º44çŸ©é˜µï¼ŒåŒæ—¶å°†å¹³ç§»éƒ¨åˆ†åˆå¹¶åˆ°æ—‹è½¬éƒ¨åˆ†å½¢æˆçš„è§†å›¾å˜æ¢çŸ©é˜µVï¼š æˆ‘ä»¬åœ¨Camera::getViewMatrixæ–¹æ³•ä¸­å»ºç«‹è¿™ä¸ªçŸ©é˜µï¼švoid Camera::getViewMatrix(D3DXMATRIX* V){ // Keep cameraâ€™s axes orthogonal to eachother D3DXVec3Normalize(&amp;_look, &amp;_look); D3DXVec3Cross(&amp;_up, &amp;_look, &amp;_right); D3DXVec3Normalize(&amp;_up, &amp;_up); D3DXVec3Cross(&amp;_right, &amp;_up, &amp;_look); D3DXVec3Normalize(&amp;_right, &amp;_right); // Build the view matrix: float x = -D3DXVec3Dot(&amp;_right, &amp;_pos); float y = -D3DXVec3Dot(&amp;_up, &amp;_pos); float z = -D3DXVec3Dot(&amp;_look, &amp;_pos); (*V)(0,0) = _right.x; (*V)(0, 1) = _up.x; (*V)(0, 2) = _look.x; (*V)(0, 3) = 0.0f; (*V)(1,0) = _right.y; (*V)(1, 1) = _up.y; (*V)(1, 2) = _look.y; (*V)(1, 3) = 0.0f; (*V)(2,0) = _right.z; (*V)(2, 1) = _up.z; (*V)(2, 2) = _look.z; (*V)(2, 3) = 0.0f; (*V)(3,0) = x; (*V)(3, 1) = y; (*V)(3, 2) = z; (*V)(3, 3) = 1.0f; }ä½ å¯èƒ½æƒ³çŸ¥é“æ–¹æ³•ä¸­å‰é¢å‡ è¡Œä»£ç æ˜¯å¹²ä»€ä¹ˆçš„ã€‚åœ¨å‡ æ¬¡æ—‹è½¬åï¼Œæ‘„åƒæœºçš„æ–¹å‘å‘é‡å¯èƒ½å˜çš„ä¸ç›¸äº’å‚ç›´äº†ã€‚å› æ­¤ï¼Œæ¯å½“è¯¥å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œæˆ‘ä»¬æ ¹æ®lookå‘é‡ä»æ–°è®¡ç®—upå’Œrightå‘é‡ï¼Œä½¿å®ƒä»¬ä¿æŒç›¸äº’å‚ç›´ã€‚æ–°çš„upå‘é‡æ˜¯è¿™æ ·è®¡ç®—çš„up = look Ã— rightã€‚ æ¥ç€æ–°çš„rightå‘é‡æ˜¯è¿™æ ·è®¡ç®—çš„right = up Ã— lookã€‚12.2.2å›´ç»•ä»»æ„è½´æ—‹è½¬ä¸ºäº†å®ç°æˆ‘ä»¬çš„æ‘„åƒæœºæ—‹è½¬æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦èƒ½å¤Ÿç»•ç€ä»»æ„è½´æ—‹è½¬ã€‚D3DXåº“æä¾›ä¸‹é¢çš„å‡½æ•°æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼šD3DXMATRIX D3DXMatrixRotationAxis( D3DXMATRIX pOut, // returns rotation matrix CONST D3DXVECTOR3 *pV, // axis to rotate around FLOAT Angle // angle, in radians, to rotate); å›¾12.3ä¾‹å¦‚ï¼Œå‡å¦‚æˆ‘ä»¬æƒ³ç»•å‘é‡ï¼ˆ0.707, 0.707, 0ï¼‰è½´æ—‹è½¬Ï€/2è§’åº¦ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼šD3DXMATRIX R;D3DXVECTOR3 axis(0.707f, 0.707f, 0.0f);D3DXMatrixRotationAxis(&amp;R, &amp;axis, D3DX_PI / 2.0f);D3DXMatrixRotationAxisçš„å˜æ¢çŸ©é˜µçš„æ¥æºä½ å¯ä»¥åœ¨Eric Lengyelçš„ Mathematics for 3D Game Programming &amp;Computer Graphicsä¸­æ‰¾åˆ°ã€‚12.2.3 Pitchã€Yawå’ŒRollå› ä¸ºæ–¹å‘å‘é‡æè¿°äº†æ‘„åƒæœºç›¸å¯¹äºä¸–ç•Œåæ ‡ç³»çš„æ–¹å‘ï¼Œæˆ‘ä»¬å¿…é¡»è€ƒè™‘åœ¨ä½¿ç”¨å€¾æ–œï¼ˆpitchï¼‰ã€åèˆªï¼ˆyawï¼‰å’Œæ»šè½¬ï¼ˆrollï¼‰æ—¶åŠæ—¶æ›´æ–°æ–¹å‘å‘é‡ã€‚è¿™å…¶å®ä¹Ÿæ˜¯éå¸¸ç®€å•çš„ã€‚å›¾12.4ï¼Œ12.5ï¼Œ12.6åˆ†åˆ«æ˜¾ç¤ºäº†æ‘„åƒæœºçš„å€¾æ–œã€åèˆªå’Œæ»šè½¬æ“ä½œã€‚ å›¾12.4 å›¾12.5 å›¾12.6å½“å€¾æ–œï¼ˆpitchï¼‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†upå’Œlookå‘é‡ç»•ç€rightå‘é‡æ—‹è½¬ä¸€å®šè§’åº¦ã€‚åŒæ ·çš„ï¼Œå½“åèˆªï¼ˆyawï¼‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†lookå’Œrightå‘é‡ç»•ç€upå‘é‡æ—‹è½¬ä¸€å®šè§’åº¦ã€‚æœ€åï¼Œå½“æ»šè½¬ï¼ˆrollï¼‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†upå’Œrightå‘é‡ç»•ç€lookå‘é‡æ—‹è½¬ä¸€å®šè§’åº¦ã€‚ æˆ‘ä»¬ç°åœ¨æ˜ç™½äº†ä¸ºä»€ä¹ˆD3DXMatrixRotationAxiså‡½æ•°æ˜¯éå¸¸å¿…è¦çš„ï¼Œå› ä¸ºè¿™ä¸‰ä¸ªå‘é‡ä¸­çš„ä»»ä½•ä¸€ä¸ªéƒ½å¯èƒ½å›´ç»•ä¸–ç•Œåæ ‡ç³»ä¸­çš„ä»»æ„è½´æ—‹è½¬ã€‚ å¯¹äºå€¾æ–œï¼ˆpitchï¼‰ã€åèˆªï¼ˆyawï¼‰å’Œæ»šè½¬ï¼ˆrollï¼‰çš„æ‰§è¡Œæˆ‘ä»¬å·²ç»è®¨è®ºäº†ã€‚ç„¶è€Œï¼Œå¯¹äºLANDOBJECTæ¨¡å¼å°±æœ‰ä¸€äº›é™åˆ¶ã€‚æˆ‘ä»¬åœ¨åèˆªï¼ˆyawï¼‰æ–¹æ³•ä¸­åªå›´ç»•yè½´æ—‹è½¬ï¼Œæˆ‘ä»¬å®Œå…¨å±è”½æ»šè½¬ï¼ˆrollï¼‰ã€‚å½“ç„¶ä½ å¯ä»¥æ ¹æ®ä½ çš„ç¨‹åºéœ€è¦æ¥æ”¹å˜Cameraç±»ã€‚æˆ‘ä»¬è¿™é‡Œåªæ˜¯ä¸€ä¸ªç¤ºä¾‹è€Œå·²ã€‚å€¾æ–œï¼ˆpitchï¼‰ã€åèˆªï¼ˆyawï¼‰å’Œæ»šè½¬ï¼ˆrollï¼‰æ–¹æ³•ä»£ç çš„å…·ä½“å®ç°å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940void Camera::pitch(float angle)&#123; D3DXMATRIX T; D3DXMatrixRotationAxis(&amp;T, &amp;_right, angle); // rotate _up and _look around _right vector D3DXVec3TransformCoord(&amp;_up,&amp;_up, &amp;T); D3DXVec3TransformCoord(&amp;_look,&amp;_look, &amp;T);&#125;void Camera::yaw(float angle)&#123; D3DXMATRIX T; // rotate around world y (0, 1, 0) always for land object if( _cameraType == LANDOBJECT ) D3DXMatrixRotationY(&amp;T, angle); // rotate around own up vector for aircraft if( _cameraType == AIRCRAFT ) D3DXMatrixRotationAxis(&amp;T, &amp;_up, angle); // rotate _right and _look around _up or y-axis D3DXVec3TransformCoord(&amp;_right,&amp;_right, &amp;T); D3DXVec3TransformCoord(&amp;_look,&amp;_look, &amp;T);&#125;void Camera::roll(float angle)&#123; // only roll for aircraft type if( _cameraType == AIRCRAFT ) &#123; D3DXMATRIX T; D3DXMatrixRotationAxis(&amp;T, &amp;_look, angle); // rotate _up and _right around _look vector D3DXVec3TransformCoord(&amp;_right,&amp;_right, &amp;T); D3DXVec3TransformCoord(&amp;_up,&amp;_up, &amp;T); &#125;&#125; 12.2.4 Walkingã€Strafingå’ŒFlyingå½“æåˆ°walkingæ—¶ï¼Œæˆ‘ä»¬çš„æ„æ€æ˜¯åœ¨æˆ‘ä»¬è§‚å¯Ÿçš„æ–¹å‘ä¸Šç§»åŠ¨ä½ç½®ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæ²¿ç€lookå‘é‡ï¼‰ã€‚Strafingæ˜¯è¯´åœ¨æˆ‘ä»¬è§‚å¯Ÿæ–¹å‘çš„å·¦å³ç§»åŠ¨ï¼Œä¹Ÿå°±æ˜¯æ²¿ç€rightå‘é‡ç§»åŠ¨ã€‚æœ€åï¼Œæˆ‘ä»¬è¯´flyingå°±æ˜¯æ²¿ç€upå‘é‡ç§»åŠ¨ã€‚ä¸ºäº†æ²¿ç€è¿™äº›è½´ç§»åŠ¨ï¼Œæˆ‘ä»¬åªéœ€è¦ç®€å•åœ°åŠ ä¸€ä¸ªå‘é‡å°±å¯ä»¥äº†ï¼ˆå¦‚å›¾12.7ï¼‰ã€‚ å›¾12.7å°±è±¡æ—‹è½¬ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ç§»åŠ¨ä½œä¸€äº›é™åˆ¶ã€‚ä¾‹å¦‚ï¼ŒLANDOBJECTä¸å…è®¸é£èµ·æ¥ã€‚å› æ­¤æˆ‘ä»¬æŠŠç§»åŠ¨é™åˆ¶åœ¨xzå¹³é¢ã€‚ç„¶è€Œï¼Œå› ä¸ºLANDOBJECTèƒ½å¤Ÿå…è®¸çˆ¬æ¥¼æ¢¯å’Œç™»å±±ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬è®¾ç½®Camera::setPositionæ–¹æ³•ï¼Œå®ƒå…è®¸ä½ æ‰‹åŠ¨è®¾ç½®ä½ çš„æ‘„åƒæœºä½ç½®æ¥è¾¾åˆ°ä½ çš„é«˜åº¦å’Œä½ç½®ã€‚ ç§»åŠ¨ï¼ˆwalkï¼‰ã€å¹³ç§»ï¼ˆstrafeï¼‰å’Œé£è¡Œï¼ˆflyï¼‰æ–¹æ³•ä»£ç çš„å…·ä½“å®ç°å¦‚ä¸‹ï¼švoid Camera::walk(float units){ // move only on xz plane for land object if( _cameraType == LANDOBJECT ) _pos += D3DXVECTOR3(_look.x, 0.0f, _look.z) units; if( _cameraType == AIRCRAFT ) _pos += _look units;}void Camera::strafe(float units){ // move only on xz plane for land object if( _cameraType == LANDOBJECT ) _pos += D3DXVECTOR3(_right.x, 0.0f, _right.z) units; if( _cameraType == AIRCRAFT ) _pos += _right units;}void Camera::fly(float units){ // move only on y-axis for land object if( _cameraType == LANDOBJECT ) _pos.y += units; if( _cameraType == AIRCRAFT ) _pos += _up * units;}12.3å®ä¾‹ç¨‹åºï¼šæ‘„åƒæœº è¿™ä¸€ç« çš„å®ä¾‹ç¨‹åºæ˜¯åˆ›å»ºå’Œæ¸²æŸ“ä¸€ä¸ªå¦‚å›¾12.8æ‰€ç¤ºçš„åœºæ™¯ã€‚ä½ èƒ½å¤Ÿé€šè¿‡é”®ç›˜è¾“å…¥åœ¨åœºæ™¯ä¸­è‡ªç”±åœ°é£è¡Œã€‚ä¸‹é¢æ˜¯ç›¸åº”é”®ç›˜è®¾ç½®ï¼š W/Sâ€”å‘å‰/å‘åç§»åŠ¨ A/Dâ€”å‘å·¦/å‘å³å¹³ç§» R/Fâ€”å‘ä¸Š/å‘ä¸‹é£è¡Œ Up/Downæ–¹å‘é”®â€”å€¾æ–œ Left/Rightæ–¹å‘é”®â€”åèˆª N/Mâ€”æ»šè½¬ å›¾12.8 ä¾‹å­çš„æ‰§è¡Œæ˜¯éå¸¸ç®€å•çš„ï¼Œå› ä¸ºæ‰€æœ‰å·¥ä½œéƒ½åŒ…å«åœ¨æ‘„åƒæœºç±»ä¸­äº†ï¼Œè¿™äº›æˆ‘ä»¬éƒ½å·²ç»è®¨è®ºè¿‡äº†ã€‚æˆ‘ä»¬åœ¨Displayå‡½æ•°ä¸­è·å¾—é”®ç›˜çš„è¾“å…¥ã€‚è®°ä½ï¼Œæˆ‘ä»¬åœ¨å…¨å±€åŸŸä¸­å®ä¾‹åŒ–äº†ä¸€ä¸ªæ‘„åƒæœºç±»å¯¹è±¡TheCameraã€‚åŒæ ·æ³¨æ„æˆ‘ä»¬ä½¿ç”¨æ—¶é—´å˜åŒ–é‡æ¥æ§åˆ¶ç§»åŠ¨æ‘„åƒæœºï¼›è¿™å¯ä»¥æ’é™¤å¸§é€Ÿåº¦çš„å½±å“è€Œç¨³å®šåœ°ç§»åŠ¨ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849bool Display(float timeDelta)&#123; if( Device ) &#123; // // Update: Update the camera. // if( ::GetAsyncKeyState('W') &amp; 0x8000f ) TheCamera.walk(4.0f * timeDelta); if( ::GetAsyncKeyState('S') &amp; 0x8000f ) TheCamera.walk(-4.0f * timeDelta); if( ::GetAsyncKeyState('A') &amp; 0x8000f ) TheCamera.strafe(-4.0f * timeDelta); if( ::GetAsyncKeyState('D') &amp; 0x8000f ) TheCamera.strafe(4.0f * timeDelta); if( ::GetAsyncKeyState('R') &amp; 0x8000f ) TheCamera.fly(4.0f * timeDelta); if( ::GetAsyncKeyState('F') &amp; 0x8000f ) TheCamera.fly(-4.0f * timeDelta); if( ::GetAsyncKeyState(VK_UP) &amp; 0x8000f ) TheCamera.pitch(1.0f * timeDelta); if( ::GetAsyncKeyState(VK_DOWN) &amp; 0x8000f ) TheCamera.pitch(-1.0f * timeDelta); if( ::GetAsyncKeyState(VK_LEFT) &amp; 0x8000f ) TheCamera.yaw(-1.0f * timeDelta); if( ::GetAsyncKeyState(VK_RIGHT) &amp; 0x8000f ) TheCamera.yaw(1.0f * timeDelta); if( ::GetAsyncKeyState('N') &amp; 0x8000f ) TheCamera.roll(1.0f * timeDelta); if( ::GetAsyncKeyState('M') &amp; 0x8000f ) TheCamera.roll(-1.0f * timeDelta); // Update the view matrix representing the cameras // new position/orientation. D3DXMATRIX V; TheCamera.getViewMatrix(&amp;V); Device-&gt;SetTransform(D3DTS_VIEW, &amp;V); // // Render // Device-&gt;Clear(0, 0, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER, 0x00000000, 1.0f, 0); Device-&gt;BeginScene(); d3d::DrawBasicScene(Device, 1.0f); Device-&gt;EndScene(); Device-&gt;Present(0, 0, 0, 0); &#125; return true;&#125; æ³¨æ„ï¼šæˆ‘ä»¬å·²ç»ç”¨ä¸€ä¸ªæ–°çš„å‡½æ•°DrawBasicSceneæ›´æ–°äº†d3dåç§°ç©ºé—´ã€‚è¿™ä¸ªå‡½æ•°ç»˜åˆ¶äº†å¦‚å›¾12.8çš„åœºæ™¯ã€‚æˆ‘ä»¬å·²ç»å°†å…¶æ·»åŠ è¿›äº†d3dåç§°ç©ºé—´ï¼Œè¿™æ˜¯å› ä¸ºå¯¹äºå»ºç«‹ä¸€ä¸ªåŸºæœ¬çš„åœºæ™¯å®ƒæ˜¯ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„å‡½æ•°ã€‚ä»¥åçš„ä¾‹å­æˆ‘ä»¬å°±å¯ä»¥é›†ä¸­ç²¾åŠ›åœ¨ä¾‹å­ä»£ç ä¸­è€Œä¸éœ€è¦å…³æ³¨è¿™äº›ä¸ç›¸å…³çš„ç»˜åˆ¶åœºæ™¯çš„ä»£ç äº†ã€‚å®ƒæ˜¯åœ¨d3dUtility.hä¸­è¢«å£°æ˜çš„ï¼š12345// Function references "desert.bmp" internally. This file must// be in the working directory.bool DrawBasicScene( IDirect3DDevice9* device,// Pass in 0 for cleanup. float scale); // uniform scale å¦‚æœè¯¥å‡½æ•°ä¸èƒ½ä»»ä½•ä¸œè¥¿ä¹Ÿå°±æ˜¯ä»€ä¹ˆéƒ½æ˜¾ç¤ºä¸å‡ºæ¥ï¼Œä½ å°±éœ€è¦çœ‹çœ‹ç›¸åº”çš„ä»£ç äº†ã€‚ä½ å¯ä»¥åœ¨æœ¬ç« çš„ä»£ç ä¸­æ‰¾åˆ°å®ƒã€‚æ³¨æ„è¿™ä¸ªå‡½æ•°éœ€è¦è°ƒç”¨ä¸€å¼ desert.bmpå›¾ç‰‡ç”¨ä½œçº¹ç†ã€‚å½“ç„¶è¯¥æ–‡ä»¶ä¹Ÿå¯ä»¥åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°ã€‚12.4 æ‘˜è¦ æˆ‘ä»¬ä»¥å››ä¸ªå‘é‡æ¥æè¿°åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­ç…§ç›¸æœºçš„ä½ç½®å’Œæ–¹å‘ï¼šrightã€upã€lookã€positionå‘é‡ï¼Œè—‰ç”±è¿™ä¸ªæè¿°, æˆ‘ä»¬èƒ½è½»æ˜“çš„å®ç°ä¸€ä¸ªè‡ªç”±çš„å…­è§’åº¦ç…§ç›¸æœºï¼Œä¸ºæ¸¸æˆä¸­çš„æ¨¡æ‹Ÿé£è¡Œå™¨ã€ç¬¬ä¸€äººç§°è§†è§’çš„æ¸¸æˆç©å®¶æä¾›äº†ä¸€ä¸ªçµæ´»çš„ç…§ç›¸æœºæ¥å£ã€‚]]></content>
      <categories>
        <category>Direct3D</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬åç«  ç½‘æ ¼æ¨¡å‹I(Meshes Part I)]]></title>
    <url>%2F2019%2F04%2F11%2FMeshes-Part-I%2F</url>
    <content type="text"><![CDATA[å‡ ä½•ä¿¡æ¯ID3DXBaseMeshæ¥å£åŒ…å«ä¸€ä¸ªç”¨æ¥å­˜å‚¨ç½‘æ ¼é¡¶ç‚¹çš„é¡¶ç‚¹ç¼“å­˜å’Œä¸€ä¸ªç”¨æ¥å®šä¹‰è¿™äº›é¡¶ç‚¹æ€æ ·è¿æ¥åœ¨ä¸€èµ·ç»„æˆç½‘æ ¼ä¸‰è§’å½¢çš„ç´¢å¼•ç¼“å­˜ã€‚æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ¥å¾—åˆ°è¿™äº›ç¼“å­˜çš„æŒ‡é’ˆï¼š12HRESULT ID3DXMesh::GetVertexBuffer(LPDIRECT3DVERTEXBUFFER9* ppVB);HRESULT ID3DXMesh::GetIndexBuffer(LPDIRECT3DINDEXBUFFER9* ppIB); è¿™é‡Œæœ‰ä¸€äº›ä½¿ç”¨è¿™äº›æ–¹æ³•çš„ä¾‹å­ï¼š1234IDirect3DVertexBuffer9* vb = 0;Mesh-&gt;GetVertexBuffer( &amp;vb );IDirect3DIndexBuffer9* ib = 0;Mesh-&gt;GetIndexBuffer( &amp;ib ); å‡å¦‚æƒ³é”å®šè¿™äº›ç¼“å­˜æ¥è¯»å†™æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ã€‚æ³¨æ„è¿™äº›æ–¹æ³•é”å®šæ•´ä¸ªé¡¶ç‚¹/ç´¢å¼•ç¼“å­˜ã€‚HRESULT ID3DXMesh::LockVertexBuffer(DWORD Flags, BYTE ppData);HRESULT ID3DXMesh::LockIndexBuffer(DWORD Flags, BYTE ppData);Flagså‚æ•°æè¿°æ€æ ·é”å®šå®ƒã€‚è¿™äº›Flagså‚æ•°åœ¨ç¬¬ä¸‰ç« ä¸­æˆ‘ä»¬ä»‹ç»è¿‡ã€‚ppDataæ˜¯å‡½æ•°è¿”å›çš„æŒ‡å‘é”å®šå†…å­˜çš„æŒ‡é’ˆçš„åœ°å€ã€‚ å½“ç„¶åœ¨ä½ é”å®šä»¥åä¸€å®šè¦è®°å¾—è§£é”ï¼šHRESULT ID3DXMesh::UnlockVertexBuffer();HRESULT ID3DXMesh::UnlockIndexBuffer(); ä¸‹é¢æ˜¯å¦å¤–ä¸€äº›ä¸meshå‡ ä½•ç»“æ„æœ‰å…³çš„ID3DXMeshæ¥å£æ–¹æ³•ï¼š DWORD GetFVF() â€” è¿”å›é¡¶ç‚¹çš„æ ¼å¼ DWORD GetNumVertices() â€” è¿”å›é¡¶ç‚¹ç¼“å­˜ä¸­çš„é¡¶ç‚¹æ•° DWORD GetNumBytesPerVertex() â€” è¿”å›ä¸€ä¸ªé¡¶ç‚¹æ‰€å çš„å­—èŠ‚æ•° DWORD GetNumFaces() â€” è¿”å›åœ¨meshä¸­çš„é¢ï¼ˆä¸‰è§’å½¢ï¼‰æ•°10.2 å­é›†å’Œå±æ€§ç¼“å­˜ ä¸€ä¸ªmeshç”±ä¸€ä¸ªæˆ–æ•°ä¸ªå­é›†ç»„æˆã€‚ä¸€ä¸ªå­é›†ï¼ˆsubsetï¼‰æ˜¯åœ¨meshä¸­çš„ä½¿ç”¨ç›¸åŒå±æ€§æ¸²æŸ“çš„ä¸€ç»„ä¸‰è§’å½¢ã€‚è¿™é‡Œçš„å±æ€§æ˜¯æŒ‡æè´¨ï¼Œçº¹ç†å’Œæ¸²æŸ“çŠ¶æ€ã€‚å›¾10.1æ˜¾ç¤ºäº†ä¸€åº§æˆ¿å­meshå¯èƒ½è¢«åˆ†æˆçš„å‡ ä¸ªå­é›†ã€‚ å›¾10.1æˆ‘ä»¬é€šè¿‡ç»™æ¯ä¸ªå­é›†æŒ‡å®šä¸€ä¸ªå”¯ä¸€éè´Ÿæ•´æ•°æ¥æ ‡è¯†å­é›†ã€‚è¿™ä¸ªå€¼å¯ä»¥æ˜¯å­˜å‚¨åœ¨ä¸€ä¸ªDWORDä¸­çš„ä»»æ„æ•°å€¼ã€‚ä¾‹å¦‚ï¼Œåœ¨å›¾10.1ä¸­æˆ‘ä»¬ç”¨0ï¼Œ1ï¼Œ2å’Œ3æ¥æ ‡è¯†å­é›†ã€‚ åœ¨meshä¸­çš„æ¯ä¸ªä¸‰è§’å½¢éƒ½ä¸ä¸€ä¸ªå±æ€§IDç›¸å…³è”ï¼Œè¡¨ç¤ºè¯¥ä¸‰è§’å½¢å±äºè¯¥å­é›†ã€‚ä¾‹å¦‚ï¼Œå›¾10.1ä¸­ç»„æˆåœ°æ¿çš„ä¸‰è§’å½¢å…·æœ‰å±æ€§ID0ï¼Œå®ƒè¡¨ç¤ºè¿™äº›ä¸‰è§’å½¢å±äºå­é›†0ã€‚åŒæ ·ï¼Œç»„æˆå¢™çš„ä¸‰è§’å½¢å…·æœ‰å±æ€§ID1ï¼Œå®ƒè¡¨ç¤ºè¿™äº›ä¸‰è§’å½¢å±äºå­é›†1ã€‚ ä¸‰è§’å½¢çš„å±æ€§IDå­˜å‚¨åœ¨meshçš„å±æ€§ç¼“å­˜ä¸­ï¼Œå®ƒæ˜¯ä¸€ä¸ªDWORDæ•°ç»„ã€‚å› ä¸ºæ¯ä¸ªé¢å¯¹åº”å±æ€§ç¼“å­˜ä¸­çš„ä¸€é¡¹ï¼Œæ‰€ä»¥å±æ€§ç¼“å­˜ä¸­çš„é¡¹ç›®æ•°ç­‰äºmeshä¸­çš„é¢çš„ä¸ªæ•°ã€‚å±æ€§ç¼“å­˜ä¸­çš„é¡¹ç›®å’Œç´¢å¼•ç¼“å­˜ä¸­å®šä¹‰çš„ä¸‰è§’å½¢ä¸€ä¸€å¯¹åº”ã€‚å³ï¼Œå±æ€§ç¼“å­˜ä¸­çš„ç¬¬ié¡¹å’Œç´¢å¼•ç¼“å­˜ä¸­çš„ç¬¬iä¸ªä¸‰è§’å½¢ç›¸å¯¹åº”ã€‚ä¸‰è§’å½¢iç”±ä¸‹é¢ä¸‰ä¸ªç´¢å¼•ç¼“å­˜ä¸­çš„ç´¢å¼•é¡¹å®šä¹‰ï¼š A = i 3 B = i 3 + 1 C = i * 3 + 2å›¾10.2æ˜¾ç¤ºäº†è¿™ä¸ªå¯¹åº”å…³ç³»ï¼š å›¾10.2 æˆ‘ä»¬å¯ä»¥é”å®šå±æ€§ç¼“å­˜ï¼Œå°±è±¡ä¸‹é¢çš„ä»£ç ç‰‡æ®µï¼šDWORD* buffer = 0;Mesh-&gt;LockAttributeBuffer(lockingFlags, &amp;buffer);// Read or write to attribute bufferâ€¦Mesh-&gt;UnlockAttributeBuffer();10.3 ç»˜åˆ¶ ID3DXMeshæ¥å£æä¾›äº†DrawSubsetï¼ˆDWORD AttribIdï¼‰æ–¹æ³•æ¥ç»˜åˆ¶AttribIdæŒ‡ç¤ºçš„å­é›†ä¸­çš„å„ä¸ªä¸‰è§’å½¢ã€‚ä¾‹å¦‚ï¼Œè¦ç»˜åˆ¶å­é›†0ä¸­çš„æ‰€æœ‰ä¸‰è§’å½¢ï¼Œæˆ‘ä»¬å°†è¿™æ ·å†™ï¼šMesh-&gt;DrawSubset(0); ä¸ºäº†ç»˜åˆ¶æ•´ä¸ªmeshï¼Œæˆ‘ä»¬å¿…é¡»ç»˜åˆ¶meshçš„æ‰€æœ‰å­é›†ã€‚è¿™æ˜¯éå¸¸æ–¹ä¾¿çš„ç”¨0ï¼Œ1ï¼Œ2ï¼Œâ€¦ï¼Œn-1æ¥æ ‡è¯†å­é›†ï¼Œè¿™é‡Œçš„næ˜¯å­é›†çš„æ€»æ•°ã€‚ä¸”æœ‰ä¸€ä¸ªç›¸å¯¹åº”çš„æè´¨å’Œçº¹ç†æ•°ç»„ï¼Œå³å­é›†iä¸æè´¨å’Œçº¹ç†æ•°ç»„çš„ç¬¬ié¡¹å¯¹åº”ã€‚è¿™å°±ä½¿æˆ‘ä»¬èƒ½å¤Ÿç®€å•çš„ç”¨å¾ªç¯æ¥æ¸²æŸ“meshï¼š123456for(int i = 0; i &lt; numSubsets; i++)&#123; Device-&gt;SetMaterial( mtrls[i] ); Device-&gt;SetTexture( 0, textures[i] ); Mesh-&gt;DrawSubset(i);&#125; 10.4 ä¼˜åŒ– Meshçš„é¡¶ç‚¹å’Œç´¢å¼•èƒ½å¤Ÿè¢«é‡ç»„ä»¥ä¾¿èƒ½æ›´æœ‰æ•ˆçš„æ¸²æŸ“meshã€‚å½“æˆ‘ä»¬è¿™æ ·åšæ—¶ï¼Œæˆ‘ä»¬è¯´æˆ‘ä»¬ä¼˜åŒ–äº†ä¸€ä¸ªmeshã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ¥è¿›è¡Œä¼˜åŒ–ï¼šHRESULT ID3DXMesh::OptimizeInplace( DWORD Flags, CONST DWORD pAdjacencyIn, DWORD pAdjacencyOut, DWORD pFaceRemap, LPD3DXBUFFER ppVertexRemap); Flags â€” è¡¨ç¤ºæ‰§è¡Œä»€ä¹ˆç±»å‹çš„ä¼˜åŒ–æ–¹æ³•ã€‚å®ƒå¯ä»¥æ˜¯ä¸‹é¢çš„ä¸€ä¸ªæˆ–å‡ ä¸ªçš„ç»„åˆï¼š D3DXMESHOPT_COMPACT â€” ä»meshä¸­ç§»é™¤æ²¡æœ‰ç”¨çš„é¡¶ç‚¹å’Œç´¢å¼•é¡¹ã€‚ D3DXMESHOPT_ATTRSORT â€” æ ¹æ®å±æ€§ç»™ä¸‰è§’å½¢æ’åºå¹¶è°ƒæ•´å±æ€§è¡¨ï¼Œè¿™å°†ä½¿DrawSubsetæ‰§è¡Œæ›´æœ‰æ•ˆï¼ˆå‚è§10.5èŠ‚ï¼‰ã€‚ D3DXMESHOPT_VERTEXCACHE â€” å¢åŠ é¡¶ç‚¹ç¼“å­˜çš„å‘½ä¸­ç‡ã€‚ D3DXMESHOPT_STRIPREORDER â€” é‡ç»„é¡¶ç‚¹ç´¢å¼•ä½¿ä¸‰è§’å¸¦å°½å¯èƒ½çš„é•¿ã€‚ D3DXMESHOPT_IGNOREVERTS â€” åªä¼˜åŒ–ç´¢å¼•ä¿¡æ¯ï¼›å¿½ç•¥é¡¶ç‚¹ä¿¡æ¯ã€‚æ³¨æ„ï¼šD3DXMESHOPT_VERTEXCACHEå’ŒD3DXMESHOPT_STRIPREORDERä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚ pAdjacencyIn â€” æŒ‡å‘æ²¡æœ‰ä¼˜åŒ–çš„meshçš„é‚»æ¥æ•°ç»„ã€‚ pAdjacencyOut â€” æŒ‡å‘ä¸€ä¸ªDWORDæ•°ç»„ï¼Œå®ƒè¢«ç”¨æ¥å¡«å……ä¼˜åŒ–å¥½äº†çš„meshé‚»æ¥ä¿¡æ¯ã€‚è¯¥æ•°ç»„å¿…é¡»æœ‰ID3DXMesh::GetNumFaces() * 3ä¸ªå…ƒç´ ã€‚å¦‚æœä¸éœ€è¦è¯¥ä¿¡æ¯ï¼Œå¯ä»¥å°†å…¶è®¾ç½®ä¸º0ã€‚ pFaceRemap â€”æŒ‡å‘ä¸€ä¸ªDWORDæ•°ç»„ï¼Œå®ƒè¢«ç”¨æ¥å¡«å……é¢é‡å½±å°„ä¿¡æ¯ã€‚è¯¥æ•°ç»„å¿…é¡»ä¸å°äºID3DXMesh::GetNumFaces()ã€‚å½“ä¸€ä¸ªmeshè¢«ä¼˜åŒ–æ—¶ï¼Œç”±ç´¢å¼•ç¼“å­˜å®šä¹‰çš„é¢å¯èƒ½è¢«ç§»åŠ¨ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨pFaceRemapä¸­çš„ç¬¬ié¡¹è¡¨ç¤ºç¬¬iä¸ªåŸå§‹é¢è¢«ç§»åŠ¨åˆ°çš„é¢ç´¢å¼•å€¼ã€‚å¦‚æœä¸éœ€è¦è¯¥ä¿¡æ¯ï¼Œå¯ä»¥å°†å…¶è®¾ç½®ä¸º0ã€‚ ppVertexRemap â€” æŒ‡å‘ID3DXBufferæŒ‡é’ˆçš„åœ°å€ï¼ˆå‚è§11.1èŠ‚ï¼‰ï¼Œå®ƒè¢«ç”¨æ¥å¡«å……é¡¶ç‚¹é‡å½±å°„ä¿¡æ¯ã€‚è¿™ä¸ªç¼“å­˜åº”è¯¥åŒ…å«ID3DXMesh::GetNumVertices()ä¸ªé¡¶ç‚¹ã€‚å½“ä¸€ä¸ªmeshè¢«ä¼˜åŒ–åï¼Œé¡¶ç‚¹å¯èƒ½è¢«ç§»åŠ¨ã€‚é¡¶ç‚¹é‡å½±å°„ä¿¡æ¯ç”¨æ¥è¯´æ˜åŸæ¥çš„é¡¶ç‚¹è¢«ç§»åŠ¨åˆ°æ–°ä½ç½®ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ppVertexRemapä¸­çš„ç¬¬ié¡¹è¡¨ç¤ºåŸæ¥çš„ç¬¬iä¸ªé¡¶ç‚¹çš„æ–°ä½ç½®ã€‚å¦‚æœä¸éœ€è¦è¯¥ä¿¡æ¯ï¼Œå¯ä»¥å°†å…¶è®¾ç½®ä¸º0ã€‚ ä¾‹å­ï¼š123456789101112131415161718192021222324// Get the adjacency info of the non-optimized mesh.DWORD adjacencyInfo[Mesh-&gt;GetNumFaces() * 3];Mesh-&gt;GenerateAdjacency(0.0f, adjacencyInfo);// Array to hold optimized adjacency info.DWORD optimizedAdjacencyInfo[Mesh-&gt;GetNumFaces() * 3];Mesh-&gt;OptimizeInplace( D3DXMESHOPT_ATTRSORT | D3DXMESHOPT_COMPACT | D3DXMESHOPT_VERTEXCACHE, adjacencyInfo, optimizedAdjacencyInfo, 0, 0); ä¸€ä¸ªæ›´ç®€å•çš„æ–¹æ³•æ˜¯Optimizeæ–¹æ³•ï¼Œå®ƒè¾“å‡ºä¸€ä¸ªä¼˜åŒ–çš„meshï¼Œè€Œä¸æ˜¯åœ¨åŸæ¥meshçš„åŸºç¡€ä¸Šè¿›è¡Œä¼˜åŒ–ï¼šHRESULT ID3DXMesh::Optimize( DWORD Flags, CONST DWORD* pAdjacencyIn, DWORD* pAdjacencyOut, DWORD* pFaceRemap, LPD3DXBUFFER* ppVertexRemap, LPD3DXMESH* ppOptMesh // the optimized mesh to be output); 10.5 å±æ€§è¡¨ å½“ä¸€ä¸ªmeshè¢«ä½¿ç”¨D3DXMESHOPT_ATTRSORTå‚æ•°æ¥ä¼˜åŒ–åï¼Œmeshçš„å‡ ä½•ä¿¡æ¯å°†æŒ‰ç…§å±æ€§è¿›è¡Œæ’åºï¼Œè¿™æ ·å„ä¸ªå­é›†çš„é¡¶ç‚¹/ç´¢å¼•å°†ç»„æˆè¿ç»­çš„å—ï¼ˆå¦‚å›¾10.3ï¼‰ã€‚ å›¾10.3 é™¤äº†è¿›è¡Œå‡ ä½•ä¿¡æ¯çš„æ’åºå¤–ï¼ŒD3DXMESHOPT_ATTRSORTä¼˜åŒ–é¡¹è¿˜å°†åˆ›å»ºä¸€ä¸ªå±æ€§è¡¨ã€‚è¯¥è¡¨æ˜¯D3DXATTRIBUTERANGEç»“æ„çš„ä¸€ä¸ªæ•°ç»„ã€‚åœ¨å±æ€§è¡¨ä¸­çš„æ¯ä¸€é¡¹å¯¹åº”meshçš„ä¸€ä¸ªå­é›†å¹¶æŒ‡ç¤ºé¡¶ç‚¹/ç´¢å¼•ç¼“å­˜ä¸­çš„ä¸€ä¸ªè¿ç»­è¿ç»­å†…å­˜å—ï¼Œè¿™ä¸ªå­é›†çš„å‡ ä½•ä¿¡æ¯å°±åŒ…å«åœ¨è¿™ä¸ªå—ä¸­ã€‚D3DXATTRIBUTERANGEç»“æ„çš„å®šä¹‰å¦‚ä¸‹ï¼š1234567typedef struct _D3DXATTRIBUTERANGE &#123; DWORD AttribId; DWORD FaceStart; DWORD FaceCount; DWORD VertexStart; DWORD VertexCount;&#125; D3DXATTRIBUTERANGE; AttribId â€” å­é›†çš„IDã€‚ FaceStart â€” è¯¥å­é›†çš„é¢çš„èµ·å§‹å€¼ï¼ŒFaceStart*3å°±æ˜¯èµ·å§‹ä¸‰è§’å½¢åœ¨ç´¢å¼•ç¼“å­˜ä¸­çš„åºå·ã€‚ FaceCount â€” åœ¨å­é›†ä¸­çš„é¢ï¼ˆä¸‰è§’å½¢ï¼‰æ•°ã€‚ VertexStart â€” è¯¥å­é›†çš„èµ·å§‹é¡¶ç‚¹åœ¨é¡¶ç‚¹ç¼“å­˜ä¸­çš„åºå·ã€‚ VertexCount â€” åœ¨å­é›†ä¸­çš„é¡¶ç‚¹æ•°ã€‚ æˆ‘ä»¬èƒ½å¤Ÿå¾ˆå®¹æ˜“çš„æ˜ç™½D3DXATTRIBUTERANGEç»“æ„çš„å„ä¸ªæˆå‘˜ï¼Œå¦‚å›¾10.3ã€‚åœ¨å›¾10.3ä¸­meshçš„å±æ€§è¡¨æœ‰ä¸‰é¡¹â€”â€”å®ƒä»¬å’Œå„ä¸ªå­é›†ä¸€ä¸€å¯¹åº”ã€‚ å»ºç«‹äº†å±æ€§è¡¨ä»¥åï¼Œæ¸²æŸ“ä¸€ä¸ªå­é›†å°±å¾ˆå®¹æ˜“äº†ã€‚ä»…ä»…æŸ¥ä¸€ä¸‹å±æ€§è¡¨å°±èƒ½æ‰¾å‡ºè‡ªå·±çš„å‡ ä½•ä¿¡æ¯ã€‚æ³¨æ„å¦‚æœæ²¡æœ‰å±æ€§è¡¨ï¼Œæ¯æ¸²æŸ“ä¸€ä¸ªå­é›†å°±éœ€è¦å¯¹å±æ€§ç¼“å­˜è¿›è¡Œä¸€æ¬¡çº¿æ€§æœç´¢æ¥æ‰¾å‡ºå­é›†åŒ…å«çš„å‡ ä½•ä¿¡æ¯ã€‚ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ¥è®¿é—®meshçš„å±æ€§è¡¨ï¼šHRESULT ID3DXMesh::GetAttributeTable( D3DXATTRIBUTERANGE pAttribTable, DWORD pAttribTableSize); è¿™ä¸ªæ–¹æ³•èƒ½å¤Ÿåšä¸¤ä»¶äº‹æƒ…ï¼šå®ƒå¯ä»¥è¿”å›å±æ€§è¡¨çš„å±æ€§æ•°ï¼Œä¹Ÿå¯ä»¥ç”¨å±æ€§æ•°æ®æ¥å¡«å……ä¸€ä¸ªD3DXATTRIBUTERANGEç»“æ„æ•°ç»„ã€‚ è¦å¾—åˆ°å±æ€§è¡¨çš„å…ƒç´ ä¸ªæ•°ï¼Œå¯ä»¥å°±å°†ç¬¬ä¸€ä¸ªå‚æ•°è®¾ç½®ä¸º0ï¼šDWORD numSubsets = 0;Mesh-&gt;GetAttributeTable(0, &amp;numSubsets); ä¸€æ—¦æˆ‘ä»¬çŸ¥é“äº†å±æ€§è¡¨çš„å…ƒç´ ä¸ªæ•°ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿé€šè¿‡å†™å±æ€§è¡¨æ¥å¡«å……ä¸€ä¸ªD3DXATTRIBUTERANGEç»“æ„æ•°ç»„ï¼šD3DXATTRIBUTERANGE table = new D3DXATTRIBUTERANGE [numSubsets];Mesh-&gt;GetAttributeTable( table, &amp;numSubsets ); æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ID3DXMesh::SetAttributeTableæ–¹æ³•æ¥ç›´æ¥è®¾ç½®å±æ€§è¡¨ã€‚ä¸‹é¢çš„ä»£ç å°±æ˜¯è®¾ç½®ä¸€ä¸ªæœ‰12ä¸ªå­é›†çš„å±æ€§è¡¨ï¼šD3DXATTRIBUTERANGE attributeTable[12];// â€¦fill attributeTable array with dataMesh-&gt;SetAttributeTable( attributeTable, 12);10.6 é‚»æ¥ä¿¡æ¯ å¯¹äºmeshçš„æŸäº›æ“ä½œï¼Œå¦‚ä¼˜åŒ–ï¼Œæœ‰å¿…è¦äº†è§£çš„æ˜¯ä¸‰è§’å½¢ä¹‹é—´çš„é‚»æ¥ä¿¡æ¯ã€‚Meshçš„é‚»æ¥æ•°ç»„å­˜å‚¨äº†è¿™äº›ä¿¡æ¯ã€‚ é‚»æ¥æ•°ç»„æ˜¯ä¸€ä¸ªDWORDæ•°ç»„ï¼Œå…¶ä¸­çš„æ¯ä¸€é¡¹å¯¹åº”äº†meshä¸­çš„ä¸€ä¸ªä¸‰è§’å½¢ã€‚ä¾‹å¦‚ï¼Œç¬¬ié¡¹å¯¹åº”çš„ä¸‰è§’å½¢ç”±ä»¥ä¸‹ä¸‰ä¸ªç´¢å¼•å€¼å®šä¹‰ï¼šA = i ??3B = i ??3 + 1C = i ??3 + 2æ³¨æ„ï¼Œä½¿ç”¨ULONG_MAX = 4294967295è¡¨ç¤ºè¯¥è¾¹æ²¡æœ‰é‚»æ¥ä¸‰è§’å½¢ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨-1æ¥è¡¨ç¤ºï¼Œå› ä¸º-1è½¬æ¢æˆDWORDå°±æ˜¯ULONG_MAXã€‚å›æƒ³ä¸€ä¸‹ï¼ŒDWORDå°±æ˜¯ä¸€ä¸ªunsigned32-bitæ•´æ•°ã€‚ å› ä¸ºæ¯ä¸ªä¸‰è§’å½¢éƒ½æœ‰ä¸‰æ¡è¾¹ï¼Œæ‰€ä»¥ä»–å°±æœ‰ä¸‰ä¸ªé‚»æ¥ä¸‰è§’å½¢ï¼ˆå¦‚å›¾10.4ï¼‰ã€‚ å›¾10.4 å› æ­¤ï¼Œé‚»æ¥æ•°ç»„å¿…é¡»æœ‰ä¸‰é¡¹ï¼ˆID3DXBaseMesh::GetNumFaces()3ï¼‰â€”â€” åœ¨meshä¸­æ¯ä¸ªä¸‰è§’å½¢éƒ½å¯èƒ½æœ‰ä¸‰ä¸ªé‚»æ¥ä¸‰è§’å½¢ã€‚ å¾ˆå¤šD3Dxmeshåˆ›é€ å‡½æ•°éƒ½èƒ½è¾“å‡ºé‚»æ¥ä¿¡æ¯ï¼Œä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼šHRESULT ID3DXMesh::GenerateAdjacency( FLOAT fEpsilon, DWORD pAdjacency); fEpsilon â€” æŒ‡ç¤ºå½“ä¸¤ä¸ªç‚¹è·ç¦»æœ‰å¤šè¿‘æ—¶ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªç‚¹ã€‚å½“ä¸¤ç‚¹é—´çš„è·ç¦»å°äºepsilonæ—¶ï¼Œå¯è®¤ä¸ºå®ƒä»¬æ˜¯åŒä¸€ä¸ªç‚¹ã€‚ pAdjacency â€” ä¸€ä¸ªæŒ‡å‘å¡«å……äº†é‚»æ¥ä¿¡æ¯çš„DWORDæ•°ç»„æŒ‡é’ˆã€‚ ä¾‹å­ï¼šDWORD adjacencyInfo[Mesh-&gt;GetNumFaces() * 3];Mesh-&gt;GenerateAdjacency(0.001f, adjacencyInfo);10.7 å¤åˆ¶ æœ‰æ—¶æˆ‘ä»¬éœ€è¦å°†ä¸€ä¸ªmeshä¸­çš„æ•°æ®æ‹·è´åˆ°å¦ä¸€ä¸ªä¹‹ä¸­ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ID3DXBaseMesh::CloneMeshFVFæ–¹æ³•ã€‚ 123456HRESULT ID3DXMesh::CloneMeshFVF( DWORD Options, DWORD FVF, LPDIRECT3DDEVICE9 pDevice, LPD3DXMESH* ppCloneMesh); Options â€” ç”¨æ¥åˆ›å»ºmeshçš„ä¸€ä¸ªæˆ–å¤šä¸ªåˆ›å»ºæ ‡å¿—ã€‚è¦äº†è§£æ‰€æœ‰æ ‡å¿—ä¿¡æ¯è¯·æŸ¥çœ‹sdkæ–‡æ¡£ã€‚ç°åœ¨åˆ—å‡ºä¸€éƒ¨åˆ†ï¼š D3DXMESH_32BIT â€” meshä½¿ç”¨32ä½ç´¢å¼•ã€‚ D3DXMESH_MANAGED â€” meshæ•°æ®å°†è¢«æ”¾åœ¨å—æ§çš„å†…å­˜ä¸­ã€‚ D3DXMESH_WRITEONLY â€” meshæ•°æ®åªèƒ½æ‰§è¡Œå†™æ“ä½œï¼Œä¸èƒ½æ‰§è¡Œè¯»æ“ä½œã€‚ D3DXMESH_DYNAMIC â€” meshç¼“å­˜å°†æ˜¯åŠ¨æ€çš„ã€‚ FVF â€” åˆ›å»ºå¤åˆ¶meshçš„çµæ´»é¡¶ç‚¹æ ¼å¼ã€‚ pDevice â€” ä¸å¤åˆ¶meshæœ‰å…³çš„è®¾å¤‡ã€‚ ppCloneMesh â€” è¾“å‡ºå¤åˆ¶çš„meshã€‚ æ³¨æ„è¿™ä¸ªæ–¹æ³•å…è®¸æŒ‡å®šä¸åŸmeshä¸åŒçš„optionså’ŒFVFã€‚ä¾‹å¦‚æˆ‘ä»¬æœ‰é¡¶ç‚¹æ ¼å¼ä¸ºD3DFVF_XYZçš„meshï¼Œç°åœ¨æƒ³å¤åˆ¶ä¸€ä¸ªé¡¶ç‚¹æ ¼å¼ä¸ºD3DFVF_XYZ|D3DFVF_NORMALçš„meshã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š// å‡è®¾_meshå’Œdeviceæ˜¯æœ‰æ•ˆçš„1234567ID3DXMesh* clone = 0;Mesh-&gt;CloneMeshFVF( Mesh-&gt;GetOptions(), // ä½¿ç”¨ä¸æºæ¨¡å‹åŒæ ·çš„é€‰é¡¹ D3DFVF_XYZ | D3DFVF_NORMAL,// æŒ‡å®šå…‹éš†çš„FVF Device, &amp;clone); 10.8 åˆ›å»ºä¸€ä¸ªMeshï¼ˆD3DXCreateMeshFVFï¼‰ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨D3DXCreate*å‡½æ•°æ¥åˆ›å»ºmeshç‰©ä½“ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ D3DXCreateMeshFVFå‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªç©ºmeshã€‚æ‰€è°“ç©ºmeshæ˜¯æŒ‡æˆ‘ä»¬å·²ç»æŒ‡å®šäº†é¡¶ç‚¹æ•°å’Œé¢æ•°ï¼Œå‡½æ•°D3DXCreateMeshFVFä¹Ÿåˆ†é…äº†é€‚å½“å¤§å°çš„å†…å­˜ç»™é¡¶ç‚¹ã€é¡¶ç‚¹ç´¢å¼•ã€å±æ€§ç¼“å†²åŒºã€‚æœ‰äº†è¿™äº›ç¼“å†²åŒºåï¼Œå°±å¯ä»¥æ‰‹åŠ¨å¡«å†™ä¸Šä¸‹æ–‡æ•°æ®äº†ï¼ˆéœ€è¦åˆ†åˆ«å‘é¡¶ç‚¹ç¼“å­˜ï¼Œç´¢å¼•ç¼“å­˜ã€å±æ€§ç¼“å­˜æä¾›é¡¶ç‚¹ã€ç´¢å¼•ã€å±æ€§æ•°æ®ï¼‰ã€‚ æˆ‘ä»¬ä½¿ç”¨D3DXCreateMeshFVFå‡½æ•°æ¥åˆ›å»ºç©ºmeshï¼š12345678HRESULT D3DXCreateMeshFVF( DWORD NumFaces, DWORD NumVertices, DWORD Options, DWORD FVF, LPDIRECT3DDEVICE9 pDevice, LPD3DXMESH* ppMesh); NumFaces â€” meshå°†æ‹¥æœ‰çš„é¢æ•°ã€‚è¯¥å€¼å¿…é¡»å¤§äº0ã€‚ NumVertices â€” meshå°†æ‹¥æœ‰çš„é¡¶ç‚¹æ•°ã€‚è¯¥å€¼å¿…é¡»å¤§äº0ã€‚ Options â€”ç”¨æ¥åˆ›å»ºmeshçš„ä¸€ä¸ªæˆ–å¤šä¸ªåˆ›å»ºæ ‡å¿—ã€‚è¦äº†è§£æ‰€æœ‰æ ‡å¿—ä¿¡æ¯è¯·æŸ¥çœ‹sdkæ–‡æ¡£ã€‚ç°åœ¨åˆ—å‡ºä¸€éƒ¨åˆ†ï¼š D3DXMESH_32BIT â€” meshä½¿ç”¨32ä½ç´¢å¼•ã€‚ D3DXMESH_MANAGED â€” meshæ•°æ®å°†è¢«æ”¾åœ¨å—æ§çš„å†…å­˜ä¸­ã€‚ D3DXMESH_WRITEONLY â€” meshæ•°æ®åªèƒ½æ‰§è¡Œå†™æ“ä½œï¼Œä¸èƒ½æ‰§è¡Œè¯»æ“ä½œã€‚ D3DXMESH_DYNAMIC â€” meshç¼“å­˜å°†æ˜¯åŠ¨æ€çš„ã€‚ FVF â€” meshçš„é¡¶ç‚¹æ ¼å¼ã€‚ pDevice â€” ä¸meshç›¸å…³çš„è®¾å¤‡ã€‚ ppMesh â€” è¾“å‡ºåˆ›å»ºå¥½çš„meshã€‚ ä¸‹ä¸€èŠ‚å°†ç»™å‡ºå®ä¾‹ç¨‹åºï¼Œå®ƒæ¼”ç¤ºäº†ç”¨è¿™ä¸ªå‡½æ•°æ€æ ·åˆ›å»ºä¸€ä¸ªmeshä»¥åŠæ‰‹åŠ¨å¡«å……meshçš„æ•°æ®å†…å®¹ã€‚ å¦å¤–ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨D3DXCreateMeshæ¥åˆ›å»ºç©ºmeshã€‚å®ƒçš„åŸå‹æ˜¯ï¼š12345678HRESULT D3DXCreateMesh( DWORD NumFaces, DWORD NumVertices, DWORD Options, CONST LPD3DVERTEXELEMENT9* pDeclaration, LPDIRECT3DDEVICE9 pDevice, LPD3DXMESH* ppMesh); è¿™äº›å‚æ•°å’ŒD3DXCreateMeshFVFçš„å‚æ•°æ˜¯éå¸¸ç›¸ä¼¼çš„ï¼Œé™¤äº†ç¬¬å››ä¸ªã€‚ä½œä¸ºæ›¿ä»£æŒ‡å®šçš„FVFï¼Œæˆ‘ä»¬æŒ‡å®šä¸€ä¸ªD3DVERTEXELEMENT9ç»“æ„ï¼Œå®ƒæè¿°äº†é¡¶ç‚¹æ ¼å¼ã€‚1234HRESULT D3DXDeclaratorFromFVF( DWORD FVF, // input format D3DVERTEXELEMENT9 Declaration[MAX_FVF_DECL_SIZE]//output format); æ³¨æ„ï¼šD3DVERTEXELEMENT9å°†åœ¨ç¬¬17ç« ä¸­è®¨è®ºã€‚ è¿™ä¸ªå‡½æ•°é€šè¿‡è¾“å…¥ä¸€ä¸ªFVFè¿”å›ä¸€ä¸ªD3DVERTEXELEMENT9ç»“æ„çš„æ•°ç»„ã€‚æ³¨æ„MAX_FVF_DECL_SIZEçš„å®šä¹‰å¦‚ä¸‹ï¼štypedef enum { MAX_FVF_DECL_SIZE = 18} MAX_FVF_DECL_SIZE;10.9 å®ä¾‹ç¨‹åºï¼šåˆ›å»ºå’Œæ¸²æŸ“Meshè¿™ä¸€ç« çš„å®ä¾‹ç¨‹åºæ˜¯æ¸²æŸ“ä¸€ä¸ªç«‹æ–¹ä½“ï¼ˆå¦‚å›¾10.5ï¼‰ å›¾10.5å®ƒæ¼”ç¤ºäº†è¿™ä¸€ç« ä¸­çš„å¤§éƒ¨åˆ†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¦‚ä¸‹ä¸€äº›æ“ä½œï¼š åˆ›å»ºä¸€ä¸ªç©ºmeshã€‚ ç”¨ä¸€ä¸ªç«‹æ–¹ä½“å‡ ä½•ä¿¡æ¯æ¥å¡«å……meshã€‚ æ ¹æ®meshçš„æ¯ä¸ªé¢æŒ‡å®šå­é›†ã€‚ äº§ç”Ÿmeshçš„é‚»æ¥ä¿¡æ¯ã€‚ ä¼˜åŒ–meshã€‚ ç»˜åˆ¶meshã€‚ æ³¨æ„ï¼Œæˆ‘ä»¬å¿½ç•¥ä¸€äº›æ— å…³çš„ä»£ç æ¥è®¨è®ºæœ¬ä¾‹ã€‚ä½ èƒ½åœ¨å«åšD3DXCreateMeshFVFçš„ä¾‹å­ä¸­æ‰¾åˆ°å…¨éƒ¨çš„ä»£ç ã€‚ å¦å¤–ï¼Œä¸ºäº†æ›´å®¹æ˜“è°ƒè¯•å’Œç ”ç©¶meshçš„æ„æˆï¼Œæˆ‘ä»¬æ‰§è¡Œå¦‚ä¸‹çš„å‡½æ•°æ¥å°†å†…åœ¨å†…å®¹æ”¾è¿›æ–‡ä»¶ä¸­ï¼š12345void dumpVertices(std::ofstream&amp; outFile, ID3DXMesh* mesh);void dumpIndices(std::ofstream&amp; outFile, ID3DXMesh* mesh);void dumpAttributeBuffer(std::ofstream&amp; outFile, ID3DXMesh* mesh);void dumpAdjacencyBuffer(std::ofstream&amp; outFile, ID3DXMesh* mesh);void dumpAttributeTable(std::ofstream&amp; outFile, ID3DXMesh* mesh); è¿™äº›å‡½æ•°çš„åå­—å°±æ˜¾ç¤ºäº†å®ƒä»¬çš„åŠŸèƒ½ã€‚æ‰§è¡Œè¿™äº›å‡½æ•°æ˜¯éå¸¸ç®€å•çš„ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œè®¨è®ºæ—¶å¿½ç•¥å®ƒä»¬ï¼ˆå¯ä»¥çœ‹ç¨‹åºçš„åŸä»£ç ï¼‰ã€‚åœ¨è¿™ä¸€èŠ‚æˆ‘ä»¬åªå±•ç¤ºä¸€ä¸ªdumpAttributeTableå‡½æ•°ã€‚ æˆ‘ä»¬é¦–å…ˆæ¥æµè§ˆä¸€ä¸‹è¯¥ä¾‹å­ï¼Œçœ‹çœ‹å¦‚ä¸‹çš„ä¸€äº›å…¨å±€å˜é‡ï¼š1234ID3DXMesh* Mesh = 0;const DWORD NumSubsets = 3;IDirect3DTexture9* Textures[3] = &#123;0, 0, 0&#125;;// texture for each subsetstd::ofstream OutFile; // used to dump mesh data to file è¿™é‡Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªmeshå¯¹è±¡çš„æŒ‡é’ˆï¼Œæˆ‘ä»¬ä»¥åè¦åˆ›å»ºçš„ã€‚æˆ‘ä»¬ä¹Ÿå®šä¹‰äº†meshæ‹¥æœ‰çš„å­é›†æ•°â€”â€”ä¸‰ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¯ä¸ªå­é›†éƒ½ç”¨ä¸€ä¸ªä¸åŒçš„çº¹ç†æ¥æ¸²æŸ“ï¼›çº¹ç†æ•°ç»„åŒ…å«æ¯ä¸ªå­é›†çš„çº¹ç†ï¼Œå¦‚ç¬¬iä¸ªçº¹ç†å¯¹åº”meshçš„ç¬¬iä¸ªå­é›†ã€‚æœ€åï¼ŒOutfileå˜é‡è¢«ç”¨æ¥æŠŠmeshçš„å†…å®¹è¾“å‡ºä¸ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ã€‚ è¿™ä¸ªä¾‹å­çš„å¤§éƒ¨åˆ†å·¥ä½œæ˜¯åœ¨setupå‡½æ•°ä¸­è¿›è¡Œã€‚æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªç©ºçš„meshï¼š12345678910bool Setup()&#123; HRESULT hr = 0; hr = D3DXCreateMeshFVF( 12, 24, D3DXMESH_MANAGED, Vertex::FVF, Device, &amp;Mesh); è¿™é‡Œæˆ‘ä»¬åˆ†é…ä¸€ä¸ªæœ‰12ä¸ªé¢å’Œ24ä¸ªé¡¶ç‚¹çš„meshï¼Œè¿™æ˜¯æè¿°ä¸€ä¸ªç›’å­æ‰€å¿…é¡»çš„ã€‚ è¿™æ ·çš„è¯ï¼Œmeshæ˜¯ç©ºçš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†ç»„æˆç›’å­çš„é¡¶ç‚¹å’Œç´¢å¼•åˆ†åˆ«å†™å…¥é¡¶ç‚¹ç¼“å­˜å’Œç´¢å¼•ç¼“å­˜ã€‚é”å®šé¡¶ç‚¹/ç´¢å¼•ç¼“å­˜å¹¶æ‰‹åŠ¨å†™å…¥æ•°æ®è¿™æ˜¯å¾ˆå®¹æ˜“çš„ï¼š123456789101112131415161718192021// Fill in vertices of a boxVertex* v = 0;Mesh-&gt;LockVertexBuffer(0, (void**)&amp;v);// fill in the front face vertex datav[0] = Vertex(-1.0f, -1.0f, -1.0f, 0.0f, 0.0f, -1.0f, 0.0f, 0.0f);v[1] = Vertex(-1.0f, 1.0f, -1.0f, 0.0f, 0.0f, -1.0f, 0.0f, 1.0f);v[22] = Vertex( 1.0f, 1.0f, 1.0f, 1.0f, 0.0f, 0.0f, 1.0f, 1.0f);v[23] = Vertex( 1.0f, -1.0f, 1.0f, 1.0f, 0.0f, 0.0f, 1.0f, 0.0f);Mesh-&gt;UnlockVertexBuffer();// Define the triangles of the boxWORD* i = 0;Mesh-&gt;LockIndexBuffer(0, (void**)&amp;i);// fill in the front face index datai[0] = 0; i[1] = 1; i[2] = 2;i[3] = 0; i[4] = 2; i[5] = 3;// fill in the right face index datai[30] = 20; i[31] = 21; i[32] = 22;i[33] = 20; i[34] = 22; i[35] = 23;Mesh-&gt;UnlockIndexBuffer(); ä¸€æ—¦meshçš„å‡ ä½•ä¿¡æ¯è¢«å†™å…¥ï¼Œæˆ‘ä»¬å¿…é¡»æŒ‡å®šæ¯ä¸ªä¸‰è§’å½¢åœ¨å“ªä¸ªå­é›†ä¸­ã€‚å›æƒ³ä¸€ä¸‹å±æ€§ç¼“å­˜å°±æ˜¯å­˜å‚¨çš„åœ¨meshä¸­æ¯ä¸ªä¸‰è§’å½¢æ‰€å±çš„å­é›†ä¿¡æ¯ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®šç´¢å¼•ç¼“å­˜ä¸­çš„å‰å››ä¸ªä¸‰è§’å½¢å­é›†ä¸º0ï¼Œæ¥ç€çš„å››ä¸ªä¸‰è§’å½¢å­é›†ä¸º1ï¼Œæœ€åå››ä¸ªä¸‰è§’å½¢å­é›†ä¸º2ã€‚ä»£ç å¦‚ä¸‹ï¼šDWORD attributeBuffer = 0;Mesh-&gt;LockAttributeBuffer(0, &amp;attributeBuffer);for(int a = 0; a &lt; 4; a++) // triangles 1-4 attributeBuffer[a] = 0; // subset 0for(int b = 4; b &lt; 8; b++) // triangles 5-8 attributeBuffer[b] = 1; // subset 1for(int c = 8; c &lt; 12; c++) // triangles 9-12 attributeBuffer[c] = 2; // subset 2Mesh-&gt;UnlockAttributeBuffer(); ç°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«æœ‰æ•ˆæ•°æ®çš„meshã€‚åœ¨è¿™ä¸€å°éƒ¨åˆ†æˆ‘ä»¬å°†æ¸²æŸ“meshï¼Œä¸è¿‡é¦–å…ˆè¿˜æ˜¯å…ˆå°†å…¶ä¼˜åŒ–ä¸€ä¸‹ã€‚æ³¨æ„è™½ç„¶è¿™å¯¹äºä¸€ä¸ªç›’å­meshæ¥è¯´ï¼Œä¼˜åŒ–meshæ•°æ®æ²¡æœ‰çœŸæ­£çš„æ•ˆæœï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯ç”¨ID3DXMeshæ¥å£æ–¹æ³•æ¥å®è·µä¸€ä¸‹ã€‚ä¸ºäº†ä¼˜åŒ–ä¸€ä¸ªmeshï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦è®¡ç®—meshçš„é‚»æ¥ä¿¡æ¯ï¼šstd::vector adjacencyBuffer(Mesh-&gt;GetNumFaces() 3);Mesh-&gt;GenerateAdjacency(0.0f, &amp;adjacencyBuffer[0]); ç„¶åæˆ‘ä»¬å°±èƒ½å¤Ÿä¼˜åŒ–meshäº†ï¼šhr = Mesh-&gt;OptimizeInplace( D3DXMESHOPT_ATTRSORT | D3DXMESHOPT_COMPACT | D3DXMESHOPT_VERTEXCACHE, &amp;adjacencyBuffer[0], 0, 0, 0); è®¾ç½®å¥½äº†meshä»¥åï¼Œæˆ‘ä»¬å°±ä¸ºæ¸²æŸ“å®ƒåšå¥½äº†å‡†å¤‡ã€‚ä¸è¿‡åœ¨setupå‡½æ•°ä¸­è¿˜æœ‰æœ€åä¸€ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯åœ¨å‰é¢æˆ‘ä»¬è¯´çš„å°†meshçš„å†…åœ¨æ•°æ®å†…å®¹å†™å…¥æ–‡ä»¶çš„å‡½æ•°ã€‚è¿™èƒ½å¤Ÿæ£€æŸ¥meshçš„æ•°æ®ï¼Œå®ƒèƒ½å¸®åŠ©æˆ‘ä»¬è°ƒè¯•å’Œå­¦ä¹ meshçš„ç»“æ„ã€‚OutFile.open(â€œMesh Dump.txtâ€);dumpVertices(OutFile, Mesh);dumpIndices(OutFile, Mesh);dumpAttributeTable(OutFile, Mesh);dumpAttributeBuffer(OutFile, Mesh);dumpAdjacencyBuffer(OutFile, Mesh);OutFile.close();â€¦Texturing loading, setting render states, etc., snippedreturn true;} // end Setup() ä¾‹å¦‚ï¼ŒdumpAttributeTableå‡½æ•°å°†å±æ€§è¡¨çš„æ•°æ®å†™å…¥æ–‡ä»¶ã€‚å®ƒçš„å…·ä½“å®ç°å¦‚ä¸‹ï¼š12345678910111213141516171819202122void dumpAttributeTable(std::ofstream&amp; outFile, ID3DXMesh* mesh)&#123; outFile &lt;&lt; "Attribute Table:" &lt;&lt; std::endl; outFile &lt;&lt; "----------------" &lt;&lt; std::endl &lt;&lt; std::endl; // number of entries in the attribute table DWORD numEntries = 0; mesh-&gt;GetAttributeTable(0, &amp;numEntries); std::vector&lt;D3DXATTRIBUTERANGE&gt; table(numEntries); mesh-&gt;GetAttributeTable(&amp;table[0], &amp;numEntries); for(int i = 0; i &lt; numEntries; i++) &#123; outFile &lt;&lt; "Entry " &lt;&lt; i &lt;&lt; std::endl; outFile &lt;&lt; "------" &lt;&lt; std::endl; outFile &lt;&lt; "Subset ID: " &lt;&lt; table[i].AttribId &lt;&lt; std::endl; outFile &lt;&lt; "Face Start: " &lt;&lt; table[i].FaceStart &lt;&lt; std::endl; outFile &lt;&lt; "Face Count: " &lt;&lt; table[i].FaceCount &lt;&lt; std::endl; outFile &lt;&lt; "Vertex Start: " &lt;&lt; table[i].VertexStart &lt;&lt; std::endl; outFile &lt;&lt; "Vertex Count: " &lt;&lt; table[i].VertexCount &lt;&lt; std::endl; outFile &lt;&lt; std::endl; &#125; outFile &lt;&lt; std::endl &lt;&lt; std::endl;&#125; ä¸‹é¢çš„æ–‡æœ¬æ–‡ä»¶æ¥è‡ªäºé€šè¿‡dumpAttributeTableå‡½æ•°å¾—åˆ°çš„mesh Dump.txtæ–‡ä»¶ã€‚1234567891011121314151617181920212223Attribute Table:----------------Entry 0------------Subset ID: 0Face Start: 0Face Count: 4Vertex Start: 0Vertex Count: 8Entry 1------------Subset ID: 1Face Start: 4Face Count: 4Vertex Start: 8Vertex Count: 8Entry 2------------Subset ID: 2Face Start: 8Face Count: 4Vertex Start: 16Vertex Count: 8 æˆ‘ä»¬èƒ½å¤Ÿäº†è§£åˆ°æˆ‘ä»¬ä¸ºmeshæ‰€æŒ‡å®šçš„ç›¸åŒ¹é…çš„æ•°æ®â€”â€”æœ‰ä¸‰ä¸ªå­é›†ä¸”æ¯ä¸ªå­é›†æœ‰4ä¸ªä¸‰è§’å½¢ã€‚å»ºè®®ä½ å»çœ‹çœ‹æœ¬ä¾‹å­Dump.txtçš„å®Œæ•´ä¿¡æ¯ã€‚è¯¥æ–‡ä»¶åœ¨æœ¬ç¤ºä¾‹æ–‡ä»¶ç›®å½•ä¸‹ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„ä»£ç å°±èƒ½å¤Ÿéå¸¸å®¹æ˜“åœ°æ¸²æŸ“meshäº†ï¼›æˆ‘ä»¬åªéœ€è¦å¾ªç¯æ¯ä¸ªå­é›†ï¼Œè®¾ç½®ç›¸å…³è”çš„çº¹ç†ç„¶ååœ¨ç»˜åˆ¶å­é›†å³å¯ã€‚è¿™æ˜¯éå¸¸å®¹æ˜“çš„ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»ä¸ºæ¯ä¸ªå­é›†æŒ‡å®šçš„ä¸‹æ ‡å¦‚0ï¼Œ1ï¼Œ2ï¼Œâ€¦ï¼Œn-1ï¼Œè¿™é‡Œçš„nå°±æ˜¯å­é›†çš„ä¸ªæ•°ã€‚1234567891011121314151617bool Display(float timeDelta)&#123; if( Device ) &#123; //...update frame code snipped Device-&gt;Clear(0, 0, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER,0x00000000, 1.0f, 0); Device-&gt;BeginScene(); for(int i = 0; i &lt; NumSubsets; i++) &#123; Device-&gt;SetTexture( 0, Textures[i] ); Mesh-&gt;DrawSubset( i ); &#125; Device-&gt;EndScene(); Device-&gt;Present(0, 0, 0, 0); &#125; return true;&#125;]]></content>
      <categories>
        <category>Direct3D</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬ä¹ç«  å­—ä½“(Fonts)]]></title>
    <url>%2F2019%2F04%2F11%2FFonts%2F</url>
    <content type="text"><![CDATA[ID3DXFontåœ¨D3DXåº“ä¸­æä¾›äº†ä¸€ä¸ªID3DXFontæ¥å£ï¼Œå®ƒèƒ½è¢«ç”¨äºåœ¨Direct3Dåº”ç”¨ç¨‹åºä¸­ç»˜åˆ¶æ–‡å­—ã€‚è¿™ä¸ªæ¥å£æ˜¯ä½¿ç”¨GDIæ¥ç»˜åˆ¶æ–‡å­—çš„ï¼Œå› æ­¤æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨è¿™ä¸ªæ¥å£æ¥æ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚æ— è®ºå¦‚ä½•ï¼Œå› ä¸ºID3DXFontä½¿ç”¨çš„æ˜¯GUIï¼Œæ‰€ä»¥å®ƒèƒ½å¤Ÿè”åˆå­—ä½“å¥æŸ„å’Œæ ¼å¼åŒ–å­—ä½“ã€‚ åˆ›å»ºä¸€ä¸ªID3DXFont æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨D3DXCreateFontIndirectå‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªID3DXFontæ¥å£ã€‚HRESULT D3DXCreateFontIndirect( LPDIRECT3DDEVICE9 pDevice, // device to be associated with the font CONST LOGFONT pLogFont, // LOGFONT structure describing the font LPD3DXFONT ppFont // return the created font); ä¸‹é¢çš„ä»£ç ç‰‡æ®µæ˜¾ç¤ºäº†æ€æ ·ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼š1234567891011121314151617181920212223LOGFONT lf;ZeroMemory(&amp;lf, sizeof(LOGFONT));lf.lfHeight = 25; // in logical unitslf.lfWidth = 12; // in logical unitslf.lfWeight = 500; // boldness, range 0(light) - 1000(bold)lf.lfItalic = false;lf.lfUnderline = false;lf.lfStrikeOut = false;lf.lfCharSet = DEFAULT_CHARSET;strcpy(lf.lfFaceName, "Times New Roman"); // font styleID3DXFont* font = 0;D3DXCreateFontIndirect(Device, &amp;lf, &amp;font); æˆ‘ä»¬å¿…é¡»å¡«å……ä¸€ä¸ªLOGFONTç»“æ„æ¥æè¿°æƒ³åˆ›å»ºçš„å­—ä½“ç±»å‹ã€‚ æ³¨æ„ï¼šä½ ä¹Ÿèƒ½å¤Ÿä½¿ç”¨D3DXCreateFontå‡½æ•°æ¥è·å¾—ä¸€ä¸ªID3DXFontæ¥å£æŒ‡é’ˆã€‚9.1.2ç»˜åˆ¶æ–‡æœ¬ ä¸€æ—¦æˆ‘ä»¬è·å¾—äº†ID3DXFontæ¥å£æŒ‡é’ˆï¼Œç»˜åˆ¶æ–‡æœ¬å°±æ˜¯å¾ˆç®€å•çš„äº‹æƒ…äº†ï¼Œæˆ‘ä»¬åªè¦è°ƒç”¨ID3DXFont::DrawTextæ–¹æ³•å°±å¯ä»¥å®ç°äº†ã€‚INT ID3DXFont::DrawText( LPCSTR pString, INT Count, LPRECT pRect, DWORD Format, D3DCOLOR Color); pString â€” æŒ‡å‘è¦ç»˜åˆ¶çš„æ–‡å­—ã€‚ Count â€” å­—ç¬¦ä¸²ä¸­ç‰¹å¾å­—ç¬¦çš„æ•°é‡ã€‚å‡å¦‚å­—ç¬¦æ˜¯ä»¥nullç»“æŸçš„å­—ç¬¦ä¸²åˆ™å¯å°†å…¶æŒ‡å®šä¸º-1ã€‚ pRect â€” æŒ‡å‘ä¸€ä¸ªRECTç»“æ„ï¼Œå®ƒå®šä¹‰ä¸€ä¸ªæ–‡å­—è¢«ç»˜åˆ¶åœ¨å±å¹•ä¸Šçš„èŒƒå›´ã€‚ Format â€” å¯é€‰å‚æ•°ï¼ŒæŒ‡å®šæ–‡å­—æ€æ ·è¢«æ ¼å¼åŒ–ï¼›è¦è·å¾—æ›´è¯¦ç»†çš„ä¿¡æ¯è¯·æŸ¥çœ‹SDKæ–‡æ¡£ã€‚ Color â€” æ–‡å­—çš„é¢œè‰²ã€‚ ä¾‹å­ï¼š1234567Font-&gt;DrawText( "Hello World", // String to draw. -1, // Null terminating string. &amp;rect, // Rectangle to draw the string in. DT_TOP | DT_LEFT, // Draw in top-left corner of rect. 0xff000000 ); // Black. 9.1.3è®¡ç®—æ¯ç§’çš„æ¸²æŸ“å¸§æ•° è¿™ä¸€ç« çš„ID3DXFontå’ŒCfontä¾‹å­æ˜¯è®¡ç®—å’Œæ˜¾ç¤ºæ¯ç§’æ¸²æŸ“çš„å¸§æ•°ï¼ˆFPSï¼‰ã€‚è¿™ä¸€éƒ¨åˆ†è¯´æ˜æ€æ ·è®¡ç®—FPSã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰å¦‚ä¸‹ä¸‰ä¸ªå…¨å±€å˜é‡ï¼š123DWORD FrameCnt; // The number of frames that have occurred.float TimeElapsed; // The time that has elapsed so far.float FPS; // The frames rendered per second. æˆ‘ä»¬è®¡ç®—æ¯ä¸€ç§’çš„FPSï¼›å®ƒç»™æˆ‘ä»¬ä¸€ä¸ªå¾ˆå¥½çš„å¹³å‡ã€‚å¦å¤–ï¼Œåœ¨åŒä¸€ç§’ä¸­å†…åªä¿å­˜ä¸€ä¸ªFPSï¼Œè¿™ç»™äº†æˆ‘ä»¬è¶³å¤Ÿæ—¶é—´æ¥è¯»å–å®ƒï¼Œåœ¨å®ƒå†ä¸€æ¬¡æ”¹å˜ä¹‹å‰ã€‚ å› æ­¤æ¯ä¸€å¸§æˆ‘ä»¬å¢åŠ FrameCntå¹¶ä¸”æŠŠä»ä¸Šä¸€å¸§åˆ°ç°åœ¨æµé€çš„æ—¶é—´å†™è¿›TimeElapsedï¼šFrameCnt++;TimeElapsed += timeDelta;è¿™é‡ŒtimeDeltaæ˜¯ä¸¤å¸§ä¹‹é—´çš„æ—¶é—´ã€‚ åœ¨ä¸€ç§’ç§ç»“æŸä»¥åï¼Œæˆ‘ä»¬èƒ½å¤Ÿç”¨ä¸‹é¢çš„å…¬å¼æ¥è®¡ç®—FPSï¼šFPS = (float)FrameCnt / TimeElapsed;æˆ‘ä»¬ä»æ–°è®¾ç½®FrameCntå’ŒTimeElapsedä¸ºè®¡ç®—ä¸‹ä¸€ç§’çš„FPSåšå‡†å¤‡ã€‚ä¸‹é¢å°±æ˜¯åˆåœ¨ä¸€èµ·çš„ä»£ç ï¼švoid CalcFPS(float timeDelta){ FrameCnt++; TimeElapsed += timeDelta; if(TimeElapsed &gt;= 1.0f) { FPS = (float)FrameCnt / TimeElapsed; TimeElapsed = 0.0f; FrameCnt = 0; }}9.2 CD3DFont DirectX SDKç»™æˆ‘ä»¬æä¾›äº†ä¸€äº›å¾ˆæœ‰ç”¨çš„ä»£ç ï¼Œå®ƒä»¬åœ¨ä½ çš„DXSDKç›®å½•ä¸‹çš„\Samples\C++\Commondä¸‹ã€‚CD3DFontç±»ä»£ç æ˜¯ä½¿ç”¨çº¹ç†ä¸‰è§’å½¢å’ŒDirect3Dã€‚å› ä¸ºCD3DFontä½¿ç”¨Direct3Dä»£æ›¿GDIæ¥æ¸²æŸ“ï¼Œ è¿™æ¯”ID3DXFontå¿«çš„å¤šã€‚ç„¶è€Œï¼ŒCD3DFontä¸èƒ½å¤Ÿè”åˆå­—ä½“å¥æŸ„å’Œæ ¼å¼åŒ–ID3DXFontã€‚å‡å¦‚ä½ è¿½æ±‚é€Ÿåº¦å’Œåªéœ€è¦ä¸€äº›ç®€å•çš„å­—ä½“ï¼ŒCD3DFontç±»å°±èƒ½æ»¡è¶³ä½ çš„è¦æ±‚äº†ã€‚ ä½¿ç”¨CD3DFontç±»ï¼Œä½ éœ€è¦æ·»åŠ ä¸‹åˆ—æ–‡ä»¶åˆ°ä½ çš„ç¨‹åºä¸­ï¼šd3dfont.h, d3dfont.cpp, d3dutil.h, d3dutil.cpp, dxutil.hå’Œdxutil.cppã€‚è¿™äº›æ–‡ä»¶å¯ä»¥åœ¨åˆšæ‰æ‰€è¯´ç›®å½•ä¸‹çš„Includeå’ŒSrcç›®å½•ä¸‹ã€‚9.2.1åˆ›å»ºä¸€ä¸ªCD3DFont ä¸ºäº†åˆ›å»ºä¸€ä¸ªCD3DFontå®ä¾‹ï¼Œæˆ‘ä»¬åªéœ€è¦ç®€å•åœ°è±¡ä¸€èˆ¬çš„C++å¯¹è±¡é‚£æ ·å®ä¾‹åŒ–å°±å¯ä»¥äº†ï¼›ä¸‹é¢æ˜¯å®ƒçš„æ„é€ åŸå‹ï¼šCD3DFont(const TCHAR* strFontName, DWORD dwHeight, DWORD dwFlags=0L); strFontName â€” ä»¥nullç»“æŸçš„å­—ç¬¦ä¸²ï¼Œå®ƒæŒ‡å®šå­—ä½“ç±»å‹ã€‚ dwHeight â€” å­—ä½“çš„é«˜åº¦ã€‚ dwFlags â€” å¯é€‰å‚æ•°ï¼›ä½ èƒ½è®¾ç½®è¯¥å‚æ•°ä¸º0æˆ–è€…ç”¨ä¸‹é¢å‚æ•°ï¼›D3DFONT_BOLD, D3DFONT_ITALIC, D3DFONT_ZENABLEã€‚ å®ä¾‹åŒ–ä¸€ä¸ªCD3DFontå¯¹è±¡ä»¥åï¼Œæˆ‘ä»¬å¿…é¡»è°ƒç”¨ä¸‹é¢çš„æ–¹æ³•æ¥åˆå§‹åŒ–å­—ä½“ï¼šFont = new CD3DFont(â€œTimes New Romanâ€, 16, 0); // instantiateFont-&gt;InitDeviceObjects( Device );Font-&gt;RestoreDeviceObjects();9.2.2ç»˜åˆ¶æ–‡æœ¬ ç°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºå’Œåˆå§‹åŒ–äº†ä¸€ä¸ªCD3DFontå¯¹è±¡ï¼Œè¿™å·²ç»ä¸ºç»˜åˆ¶æ–‡å­—åšå¥½äº†å‡†å¤‡ã€‚ç»˜åˆ¶æ–‡å­—æ˜¯ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼šHRESULT CD3DFont::DrawText(FLOAT x, FLOAT y, DWORD dwColor, const TCHAR* strText, DWORD dwFlags=0L); x â€” æ–‡å­—åœ¨å±å¹•ä¸Šå¼€å§‹ç»˜åˆ¶çš„xåæ ‡ã€‚ y â€”æ–‡å­—åœ¨å±å¹•ä¸Šå¼€å§‹ç»˜åˆ¶çš„yåæ ‡ã€‚ dwColor â€” æ–‡å­—çš„é¢œè‰²ã€‚ strText â€” è¦ç»˜åˆ¶çš„æ–‡å­—ã€‚ dwFlags â€” å¯é€‰å‚æ•°ï¼›ä½ èƒ½è®¾ç½®è¯¥å‚æ•°ä¸º0æˆ–è€…ç”¨ä¸‹é¢å‚æ•°ï¼›D3DFONT_CENTERED, D3DFONT_TWOSIDED, D3DFONT_FILTEREDã€‚ ä¾‹å­ï¼š Font-&gt;DrawText(20, 20, 0xff000000, â€œHello, Worldâ€);9.2.3 æ¸…é™¤ åœ¨åˆ é™¤ä¸€ä¸ªCD3DFontå¯¹è±¡ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»é¦–å…ˆè°ƒç”¨ä¸€äº›æ¸…é™¤ç¨‹åºï¼Œå°±è±¡ä¸‹é¢åˆ—ä¸¾çš„ä»£ç ç‰‡æ®µï¼šFont-&gt;InvalidateDeviceObjects();Font-&gt;DeleteDeviceObjects();delete Font;9.3 D3DXCreateText æœ€åçš„å‡½æ•°æ˜¯è¢«ç”¨æ¥åˆ›å»ºä¸€ä¸ª3D æ–‡å­—ç½‘æ ¼ã€‚å›¾9.1æ˜¾ç¤ºäº†æœ¬ç« FontMes3Då®ä¾‹æ¸²æŸ“çš„3Dæ–‡å­—ç½‘æ ¼ã€‚ å›¾9.1 è¯¥å‡½æ•°çš„åŸå‹æ˜¯ï¼š12345678910HRESULT D3DXCreateText( LPDIRECT3DDEVICE9 pDevice, HDC hDC, LPCTSTR pText, FLOAT Deviation, FLOAT Extrusion, LPD3DXMESH* ppMesh, LPD3DXBUFFER* ppAdjacency, LPGLYPHMETRICSFLOAT pGlyphMetrics); è¿™ä¸ªå‡½æ•°å¦‚æœè°ƒç”¨æˆåŠŸåˆ™è¿”å›D3D_OKã€‚ pDevice â€” å’Œmeshå…³è”çš„deviceã€‚ hDC â€” æˆ‘ä»¬å°†è¦ç”¨æ¥äº§ç”Ÿmeshçš„åŒ…å«æè¿°å­—ä½“çš„è®¾å¤‡ç¯å¢ƒå¥æŸ„ã€‚ pText â€” æŒ‡å‘ä»¥nullç»“æŸçš„å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œæ­¤å­—ç¬¦ä¸²æ˜¯ç”¨æ¥æŒ‡å®šåˆ›å»ºä»€ä¹ˆæ–‡å­—meshã€‚ Deviation â€” å­—å‹è½®å»“æ®µæ•°é—´è·ã€‚è¯¥å€¼å¿…é¡»å¤§äºç­‰äº0ã€‚å½“å®ƒä¸º0æ—¶ï¼Œæ®µæ•°ç­‰äºå­—ä½“åŸå§‹è®¾è®¡å•ä½ï¼ˆè¯¥å€¼è¶Šæ¥è¿‘0ï¼Œé‚£ä¹ˆå­—ä½“å°±è¶Šå…‰æ»‘ï¼‰ã€‚ Extrusion â€” æ–‡å­—åœ¨zè½´æ–¹å‘çš„æ·±åº¦ã€‚ ppMesh â€” è¿”å›åˆ›å»ºçš„meshã€‚ ppAdjacency â€” è¿”å›åˆ›å»ºmeshçš„ç›¸å…³ä¿¡æ¯ã€‚å‡å¦‚ä½ ä¸éœ€è¦å®ƒå¯ä»¥å°†å…¶æŒ‡å®šä¸ºnullã€‚ pGlyphMetrics â€” ä¸€ä¸ªæŒ‡å‘LPGLYPHMETRICSFLOATç»“æ„æ•°ç»„çš„æŒ‡é’ˆï¼Œå®ƒåŒ…å«äº†å­—å‹ç±³æ•°æ®ã€‚å‡å¦‚ä½ ä¸å…³å¿ƒæ­¤æ•°æ®ï¼Œä½ å¯ä»¥æŠŠå®ƒè®¾ç½®ä¸º0ã€‚ ä¸‹é¢çš„ç¤ºä¾‹ä»£ç å±•ç¤ºçš„æ˜¯ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªæ–‡å­—3D ç½‘æ ¼æ¨¡å‹ã€‚123456789101112131415161718192021222324252627282930// Obtain a handle to a device context.HDC hdc = CreateCompatibleDC( 0 );// Fill out a LOGFONT structure that describes the fontâ€™s properties.LOGFONT lf;ZeroMemory(&amp;lf, sizeof(LOGFONT));lf.lfHeight = 25; // in logical unitslf.lfWidth = 12; // in logical unitslf.lfWeight = 500; // boldness, range 0(light) - 1000(bold)lf.lfItalic = false;lf.lfUnderline = false;lf.lfStrikeOut = false;lf.lfCharSet = DEFAULT_CHARSET;strcpy(lf.lfFaceName, "Times New Roman"); // font style// Create a font and select that font with the device context.HFONT hFont;HFONT hFontOld;hFont = CreateFontIndirect(&amp;lf);hFontOld = (HFONT)SelectObject(hdc, hFont);// Create the 3D mesh of text.ID3DXMesh* Text = 0;D3DXCreateText(_device, hdc, "Direct3D", 0.001f, 0.4f, &amp;Text, 0, 0);// Reselect the old font, and free resources.SelectObject(hdc, hFontOld);DeleteObject( hFont );DeleteDC( hdc ); ç°åœ¨ä½ ä¾¿èƒ½ç®€å•åœ°è°ƒç”¨meshçš„DrawSubsetæ–¹æ³•æ¥æ¸²æŸ“ä¸€ä¸ª3Dæ–‡å­—ï¼š1Text-&gt;DrawSubset(0);]]></content>
      <categories>
        <category>Direct3D</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[æ¨¡ç‰ˆ(Stenciling)]]></title>
    <url>%2F2019%2F04%2F11%2FStenciling%2F</url>
    <content type="text"><![CDATA[æ¨¡ç‰ˆç¼“å­˜æ˜¯ä¸€ä¸ªè¿œç¦»å±å¹•çš„ç¼“å­˜ï¼Œæˆ‘ä»¬èƒ½å¤Ÿç”¨å®ƒæ¥å®Œæˆä¸€äº›ç‰¹æ•ˆã€‚æ¨¡ç‰ˆç¼“å­˜ä¸åç¼“å­˜å’Œæ·±åº¦ç¼“å­˜æœ‰ç›¸åŒçš„å®šä¹‰ï¼Œå› æ­¤åœ¨æ¨¡ç‰ˆç¼“å­˜ä¸­çš„ijthåƒç´ ä¸åç¼“å­˜å’Œæ·±åº¦ç¼“å­˜ä¸­çš„ijthåƒç´ æ˜¯ç›¸åè°ƒçš„ã€‚å°±è±¡åå­—æ‰€è¯´ï¼Œæ¨¡ç‰ˆç¼“å­˜å°±è±¡ä¸€ä¸ªæ¨¡ç‰ˆå®ƒå…è®¸æˆ‘ä»¬å°åˆ·æ¸²æŸ“åç¼“å­˜çš„æŸä¸ªéƒ¨åˆ†ã€‚ä¸¾ä¾‹ï¼Œå½“è¦å®ç°ä¸€ä¸ªé•œå­æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦ç®€å•åœ°åå°„ä¸€ä¸ªç‰©ä½“ç»†èŠ‚åˆ°é•œå­å¹³é¢ä¸Šï¼›ç„¶è€Œï¼Œæˆ‘ä»¬ä»…ä»…æƒ³åªç»˜åˆ¶é•œå­é‡Œçš„åå°„ç»“æœã€‚æˆ‘ä»¬èƒ½ç”¨æ¨¡ç‰ˆç¼“å­˜æ¥å°åˆ¶æ¸²æŸ“å®ƒã€‚å›¾8.1æ¸…æ¥šçš„æ˜¾ç¤ºäº†è¿™ä¸€ç‚¹ã€‚ å›¾8.1æ¨¡ç‰ˆç¼“å­˜æ˜¯Direct3Dä¸­çš„ä¸€å°éƒ¨åˆ†ï¼Œå®ƒæ˜¯é€šè¿‡ä¸€ä¸ªç®€å•çš„è¡¨é¢è€Œè¢«çº¦æŸçš„ã€‚å°±è±¡æ··åˆï¼Œè¿™ä¸ªç®€å•çš„è¡¨é¢æä¾›äº†å¯å˜çš„å¼ºå¤§çš„è®¾ç½®èƒ½åŠ›ã€‚æœ‰æ•ˆåœ°å­¦ä¹ ä½¿ç”¨æ¨¡ç‰ˆç¼“å­˜æœ€å¥½çš„æ–¹æ³•æ˜¯é€šè¿‡å­¦ä¹ å®é™…çš„åº”ç”¨ç¨‹åºã€‚ä¸€æ—¦ä½ å­¦æ‡‚äº†ä¸€ç‚¹åº”ç”¨ç¨‹åºä¸­çš„æ¨¡ç‰ˆç¼“å­˜ï¼Œä½ å°†ä¼šå¾—åˆ°ä¸€ä¸ªæ›´å¥½çš„ç”¨äºä½ è‡ªå·±éœ€è¦ç‰¹æ•ˆçš„ä¸»æ„ã€‚æ­£å› ä¸ºè¿™ä¸ªåŸå› ï¼Œè¿™ä¸€ç« æˆ‘ä»¬ç‰¹åˆ«å®‰æ’å­¦ä¹ ä¸¤ä¸ªä½¿ç”¨æ¨¡ç‰ˆç¼“å­˜çš„åº”ç”¨ç¨‹åºã€‚ç›®æ ‡ ç†è§£æ¨¡ç‰ˆç¼“å­˜æ˜¯æ€æ ·å·¥ä½œçš„ï¼Œæ€æ ·åˆ›å»ºä¸€ä¸ªæ¨¡ç‰ˆç¼“å­˜ä»¥åŠæ€æ ·æ§åˆ¶å®ƒã€‚ å­¦ä¹ æ€æ ·å®ç°ä¸€ä¸ªé•œé¢æ•ˆæœï¼Œä½¿ç”¨æ¨¡ç‰ˆç¼“å­˜æ¥é˜²æ­¢ç»˜åˆ¶åå°„åˆ°ä¸åœ¨é•œå­è¡¨é¢ä¸Šçš„ç‰©ä½“ã€‚ åˆ©ç”¨æ¨¡ç‰ˆç¼“å­˜æ€æ ·æ¸²æŸ“é˜´å½±å’Œé˜²æ­¢â€œåŒå€æ··åˆâ€ã€‚8.1ä½¿ç”¨æ¨¡ç‰ˆç¼“å­˜ ä¸ºäº†ä½¿ç”¨æ¨¡ç‰ˆç¼“å­˜ï¼Œæˆ‘ä»¬åœ¨åˆå§‹åŒ–Direct3Dæ—¶å¿…é¡»é¦–å…ˆè¯·æ±‚ä¸€ä¸ªï¼Œç„¶åå¿…é¡»å¯ç”¨å®ƒã€‚æˆ‘ä»¬åœ¨8.1.1ä¸­è®²è¿°æ€æ ·è¯·æ±‚ä¸€ä¸ªæ¨¡ç‰ˆç¼“å­˜ã€‚ä¸ºäº†å¯ç”¨æ¨¡ç‰ˆç¼“å­˜ï¼Œæˆ‘ä»¬å¿…é¡»è®¾ç½®D3DRS_STENCILENABLEæ¸²æŸ“çŠ¶æ€å¹¶ä¸”æŒ‡å®šå®ƒä¸ºtrueï¼ˆå…³é—­å®ƒå³å¯æŒ‡å®šä¸ºfalseï¼‰ã€‚ä¸‹é¢çš„ä»£ç æ˜¯å¯ç”¨å’Œå…³é—­æ¨¡ç‰ˆç¼“å­˜çš„ä»£ç ï¼šDevice-&gt;SetRenderState(D3DRS_STENCILENABLE, true);â€¦ // do stencil workDevice-&gt;SetRenderState(D3DRS_STENCILENABLE, false);æˆ‘ä»¬å¯ä»¥ä½¿ç”¨IDirect3DDevice9::Clearæ–¹æ³•æ¥æ¸…é™¤æ¨¡ç‰ˆç¼“å­˜å¹¶è®©å…¶æ‹¥æœ‰é»˜è®¤å€¼ã€‚å›å¿†ä¸€ä¸‹ï¼ŒåŒæ ·çš„æ–¹æ³•è¢«ç”¨åœ¨æ¸…é™¤åç¼“å­˜å’Œæ·±åº¦ç¼“å­˜ä¸­ã€‚Device-&gt;Clear(0, 0, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER | D3DCLEAR_STENCIL, 0xff000000, 1.0f, 0 );æ³¨æ„æˆ‘ä»¬å·²ç»æ·»åŠ äº†D3DCLEAR_STENCILåˆ°ç¬¬ä¸‰ä¸ªå‚æ•°ä¸­ï¼Œå®ƒè¡¨ç¤ºæˆ‘ä»¬æƒ³æŠŠæ¨¡ç‰ˆç¼“å­˜å’Œç›®æ ‡ï¼ˆåç¼“å­˜ï¼‰ä»¥åŠæ·±åº¦ç¼“å­˜ä¸€èµ·æ¸…é™¤ã€‚æœ‰6ç§å€¼å¯ä»¥ç”¨æ¥æŒ‡å®šæ¸…é™¤åçš„æ¨¡ç‰ˆç¼“å­˜ï¼›åœ¨è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬å°†å®ƒæ¸…é™¤ä¸º0ã€‚8.1.1è¯·æ±‚ä¸€ä¸ªæ¨¡ç‰ˆç¼“å­˜ åœ¨æˆ‘ä»¬åˆ›å»ºæ·±åº¦ç¼“å­˜çš„åŒæ—¶ä¸€ä¸ªæ¨¡ç‰ˆç¼“å­˜èƒ½å¤Ÿè¢«åˆ›å»ºã€‚å½“æŒ‡å®šæ·±åº¦ç¼“å­˜æ ¼å¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬åŒæ—¶æŒ‡å®šæ¨¡ç‰ˆç¼“å­˜çš„æ ¼å¼ã€‚è¿™æ ·ï¼Œæ¨¡ç‰ˆç¼“å­˜å’Œæ·±åº¦ç¼“å­˜åˆ†äº«åŒä¸€ä¸ªç¦»å±è¡¨é¢ç¼“å­˜ï¼Œä½†æ˜¯æ¯ä¸ªåƒç´ è¢«æŒ‡å®šåˆ°å„è‡ªç¼“å­˜å†…å­˜ç‰‡æ®µä¸­ã€‚ä¸‹é¢åˆ—å‡ºäº†3ç§æ·±åº¦/æ¨¡ç‰ˆç¼“å­˜çš„æ ¼å¼ï¼š D3DFMT_D24S8â€”è¿™ç§æ ¼å¼æ˜¯è¯´åˆ›å»ºä¸€ä¸ª32ä½æ·±åº¦/æ¨¡ç‰ˆç¼“å­˜ï¼Œå…¶ä¸­24ä½ä¸ºæ·±åº¦ç¼“å­˜ï¼Œ8ä½ä¸ºæ¨¡ç‰ˆç¼“å­˜ã€‚ D3DFMT_D24X4S4â€”è¿™ç§æ ¼å¼æ˜¯è¯´åˆ›å»ºä¸€ä¸ª32ä½æ·±åº¦/æ¨¡ç‰ˆç¼“å­˜ï¼Œå…¶ä¸­24ä½ä¸ºæ·±åº¦ç¼“å­˜ï¼Œ4ä½ä¸ºæ¨¡ç‰ˆç¼“å­˜ï¼Œè¿˜æœ‰4ä½ç•™ç€ä¸ç”¨ã€‚ D3DFMT_D15S1â€”è¿™ç§æ ¼å¼æ˜¯è¯´åˆ›å»ºä¸€ä¸ª16ä½æ·±åº¦/æ¨¡ç‰ˆç¼“å­˜ï¼Œå…¶ä¸­15ä½ä¸ºæ·±åº¦ç¼“å­˜ï¼Œ1ä½ä¸ºæ¨¡ç‰ˆç¼“å­˜ã€‚æ³¨æ„ï¼Œè¿˜æœ‰ä¸€äº›æ ¼å¼æ²¡æœ‰åˆ†é…ä»»ä½•ä½ç»™æ¨¡ç‰ˆç¼“å­˜ã€‚ä¾‹å¦‚ï¼ŒD3DFMT_D32æ ¼å¼æ˜¯è¯´åªåˆ›å»ºä¸€ä¸ª32ä½æ·±åº¦ç¼“å­˜ã€‚ åŒæ ·ï¼Œä¸åŒç¡¬ä»¶å¯¹æ¨¡ç‰ˆç¼“å­˜çš„æ”¯æŒä¹Ÿæ˜¯ä¸åŒçš„ã€‚ä¾‹å¦‚æœ‰äº›æ˜¾å¡å°±ä¸æ”¯æŒ8ä½æ¨¡ç‰ˆç¼“å­˜ã€‚8.1.2æ¨¡ç‰ˆæµ‹è¯• å¦‚å‰æ‰€è¿°ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨æ¨¡ç‰ˆç¼“å­˜æ¥é˜»æ­¢æ¸²æŸ“åç¼“å­˜ä¸­çš„æŸäº›éƒ¨åˆ†ã€‚é˜»æ­¢ç‰¹æ®Šåƒç´ è¢«å†™æ˜¯é€šè¿‡æ¨¡ç‰ˆæµ‹è¯•ï¼ˆstencil testï¼‰æ¥å†³å®šçš„ï¼Œè¿™æ˜¯é€šè¿‡ä¸‹é¢çš„è¡¨è¾¾å¼æ¥å®Œæˆçš„ï¼š(ref &amp; mask) ComparisonOperation (value &amp; mask)æ¨¡ç‰ˆæµ‹è¯•æ˜¯å¯¹æ¯ä¸ªåƒç´ è¿›è¡Œçš„ï¼Œå‡è®¾æ¨¡ç‰ˆæ˜¯è¢«å…è®¸ã€‚å°†æœ‰ä¸¤ä¸ªæ“ä½œï¼š å·¦æ‰‹è¾¹æ“ä½œæ•°ï¼ˆLHS=ref&amp;maskï¼‰ å³æ‰‹è¾¹æ“ä½œæ•°ï¼ˆRHS=value&amp;maskï¼‰æ¨¡ç‰ˆæµ‹è¯•æ¯”è¾ƒLHSå’ŒRHSï¼Œé€šè¿‡æ¯”è¾ƒè¿ç®—æ¥æŒ‡å®šã€‚å…¨éƒ¨çš„è¿ç®—éƒ½å¾—åˆ°ä¸€ä¸ªå¸ƒå°”å€¼ï¼ˆtrue/falseï¼‰ã€‚å‡å¦‚æµ‹è¯•çš„ç»“æœæ˜¯trueï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠåƒç´ å†™å…¥åç¼“å­˜ã€‚å‡å¦‚æµ‹è¯•çš„ç»“æœæ˜¯false,æˆ‘ä»¬å°±é˜»æ­¢åƒç´ è¢«å†™å…¥åç¼“å­˜ã€‚å½“ç„¶ï¼Œå¦‚æœåƒç´ ä¸èƒ½è¢«å†™å…¥åç¼“å­˜ï¼Œé‚£ä¹ˆå®ƒä¹Ÿä¸èƒ½è¢«å†™å…¥æ·±åº¦ç¼“å­˜ã€‚æ§åˆ¶æ¨¡ç‰ˆæµ‹è¯•Direct3Då…è®¸æˆ‘ä»¬æ§åˆ¶å˜é‡ç”¨äºæ¨¡ç‰ˆæµ‹è¯•ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šå‚è€ƒå€¼ï¼ˆstencil referenceï¼‰å’Œæ©ç (mask value)ï¼Œä»¥ä¾¿è¿›è¡Œæ¯”è¾ƒè¿ç®—ã€‚è™½ç„¶æˆ‘ä»¬ä¸èƒ½æ˜ç¡®åœ°è®¾å®šæ¨¡ç‰ˆå€¼ï¼ˆstencil valueï¼‰,ä½†æ˜¯æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶å†™å…¥æ¨¡ç‰ˆç¼“å­˜çš„å€¼ã€‚æ¨¡ç‰ˆå‚è€ƒå€¼ï¼ˆReference Valueï¼‰æ¨¡ç‰ˆå‚è€ƒå€¼refçš„é»˜è®¤å€¼ä¸º0ï¼Œä½†æ˜¯æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡è®¾ç½®D3DRS_STENCILREFæ¸²æŸ“çŠ¶æ€æ¥æ”¹å˜å®ƒã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç å°±æ˜¯è®¾ç½®æ¨¡ç‰ˆå‚è€ƒå€¼ä¸º1ï¼š1Device-&gt;SetRenderState(D3DRS_STENCILREF, 0x1); æ³¨æ„æˆ‘ä»¬å¾€å¾€ä½¿ç”¨16è¿›åˆ¶ï¼Œå› ä¸ºè¿™è®©å®ƒçœ‹èµ·æ¥æ¯”æ•´æ•°æ›´å®¹æ˜“è±¡ä¸€ä¸ªä½é˜Ÿåˆ—ï¼Œå¹¶ä¸”å½“æˆ‘ä»¬åšä½æ“ä½œæ—¶è¿™æ ·çœ‹èµ·æ¥æ›´æœ‰ç”¨ï¼Œæ¯”å¦‚ç›¸åŠ ã€‚ æ¨¡ç‰ˆæ©ç æ¨¡ç‰ˆæ©ç å€¼maskæ˜¯è¢«ç”¨æ¥æ©é¥°ï¼ˆéšè—ï¼‰åœ¨refå’Œvalueå˜é‡ä¸­çš„ä½ã€‚å®ƒçš„é»˜è®¤å€¼æ˜¯0xffffffffï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰æ©é¥°ä»»ä½•ä½ã€‚æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡è®¾ç½®D3DRS_STENCILMASKæ¸²æŸ“çŠ¶æ€æ¥æ”¹å˜å®ƒã€‚ä¸‹é¢çš„ä¾‹å­å°±æ˜¯æ©é¥°é«˜16ä½ï¼š1Device-&gt;SetRenderState(D3DRS_STENCILMASK, 0x0000ffff); æ¨¡ç‰ˆå€¼ï¼ˆStencil Valueï¼‰ä½œä¸ºä»¥å‰çš„è§„å®šï¼Œåœ¨æ¨¡ç‰ˆç¼“å­˜ä¸­æˆ‘ä»¬è¿›è¡Œæ¨¡ç‰ˆæµ‹è¯•çš„å½“å‰åƒç´ ã€‚ä¾‹å¦‚ï¼Œå‡å¦‚æˆ‘ä»¬å¯¹ijthåƒç´ è¿›è¡Œæ¨¡ç‰ˆæµ‹è¯•ï¼Œé‚£ä¹ˆè¯¥å€¼å°†è¢«å†™å…¥ijthæ¨¡ç‰ˆç¼“å­˜ã€‚æˆ‘ä»¬ä¸èƒ½æ˜ç¡®åœ°è®¾ç½®ä¸ªåˆ«æ¨¡ç‰ˆå€¼ï¼Œä½†æ˜¯å¯ä»¥æ¸…é™¤æ¨¡ç‰ˆç¼“å­˜ã€‚æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨æ¨¡ç‰ˆæ¸²æŸ“çŠ¶æ€æ¥æ§åˆ¶å°†ä»€ä¹ˆå†™å…¥æ¨¡ç‰ˆç¼“å­˜ã€‚ æ¯”è¾ƒè¿ç®—æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡è®¾ç½®D3DRS_STENCILFUNCæ¸²æŸ“çŠ¶æ€æ¥è®¾ç½®æ¯”è¾ƒè¿ç®—ã€‚è¿™ä¸ªæ¯”è¾ƒè¿ç®—èƒ½å¤Ÿè¢«D3DCMPFUNCçš„ä»»ä½•æˆå‘˜ç±»å‹åˆ—ä¸¾ï¼š1234567891011typedef enum _D3DCMPFUNC &#123; D3DCMP_NEVER = 1, // æ¨¡ç‰ˆæµ‹è¯•æ°¸ä¸æˆåŠŸ D3DCMP_LESS = 2, // å‡å¦‚LHS &lt; RHSï¼Œé‚£ä¹ˆæ¨¡ç‰ˆæµ‹è¯•æˆåŠŸ D3DCMP_EQUAL = 3, // å‡å¦‚LHS = RHSï¼Œé‚£ä¹ˆæ¨¡ç‰ˆæµ‹è¯•æˆåŠŸ D3DCMP_LESSEQUAL = 4, // å‡å¦‚LHS &lt;= RHSï¼Œé‚£ä¹ˆæ¨¡ç‰ˆæµ‹è¯•æˆåŠŸ D3DCMP_GREATER = 5, // å‡å¦‚LHS &gt; RHSï¼Œé‚£ä¹ˆæ¨¡ç‰ˆæµ‹è¯•æˆåŠŸ D3DCMP_NOTEQUAL = 6, // å‡å¦‚LHS &lt;&gt; RHSï¼Œé‚£ä¹ˆæ¨¡ç‰ˆæµ‹è¯•æˆåŠŸ D3DCMP_GREATEREQUAL = 7, D3DCMP_ALWAYS = 8, D3DCMP_FORCE_DWORD = 0x7fffffff&#125; D3DCMPFUNC; D3DCMP_GREATEREQUALâ€”â€”å‡å¦‚LHS &gt;= RHSï¼Œé‚£ä¹ˆæ¨¡ç‰ˆæµ‹è¯•æˆåŠŸã€‚ D3DCMP_ALWAYSâ€”â€”æ¨¡ç‰ˆæµ‹è¯•æ€»æ˜¯æˆåŠŸã€‚æ›´æ–°æ¨¡ç‰ˆç¼“å­˜é™¤äº†å†³å®šæ˜¯å¦å†™æˆ–é˜»æ­¢ä¸€ä¸ªç‰¹æ®Šåƒç´ è¢«å†™å…¥åç¼“å­˜ä»¥å¤–ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå®šä¹‰æ¨¡ç‰ˆç¼“å­˜åŸºäºä¸‰ç§å¯èƒ½çš„æ¡ˆä¾‹æ€æ ·è¢«æ›´æ–°ï¼š å¯¹äºijthåƒç´ æ¨¡ç‰ˆæµ‹è¯•å¤±è´¥ã€‚æˆ‘ä»¬èƒ½å¤Ÿå®šä¹‰æ€æ ·æ›´æ–°åœ¨æ¨¡ç‰ˆç¼“å­˜ä¸­çš„ijthï¼Œé€šè¿‡è®¾ç½®D3DRS_STENCILFAILæ¸²æŸ“çŠ¶æ€æ¥é€‚åº”è¿™ç§æƒ…å½¢ï¼šDevice-&gt;SetRenderState(D3DRS_STENCILFAIL, StencilOperation); å¯¹äºijthåƒç´ æ·±åº¦æµ‹è¯•å¤±è´¥ã€‚æˆ‘ä»¬èƒ½å¤Ÿå®šä¹‰æ€æ ·æ›´æ–°åœ¨æ¨¡ç‰ˆç¼“å­˜ä¸­çš„ijthï¼Œé€šè¿‡è®¾ç½®D3DRS_STENCILZFAILæ¸²æŸ“çŠ¶æ€æ¥é€‚åº”è¿™ç§æƒ…å½¢ï¼šDevice-&gt;SetRenderState(D3DRS_STENCILZFAIL, StencilOperation); å¯¹äºijthåƒç´ æ¨¡ç‰ˆæµ‹è¯•å’Œæ·±åº¦æµ‹è¯•éƒ½æˆåŠŸã€‚æˆ‘ä»¬èƒ½å¤Ÿå®šä¹‰æ€æ ·æ›´æ–°åœ¨æ¨¡ç‰ˆç¼“å­˜ä¸­çš„ijthï¼Œé€šè¿‡è®¾ç½®D3DRS_STENCILPASSæ¸²æŸ“çŠ¶æ€æ¥é€‚åº”è¿™ç§æƒ…å½¢ï¼šDevice-&gt;SetRenderState(D3DRS_STENCILPASS, StencilOperation);å…¶ä¸­StencilOperationèƒ½å¤Ÿæ˜¯ä¸‹é¢é¢„å…ˆå®šä¹‰çš„å¸¸æ•°ï¼š D3DSTENCILOP_KEEPâ€”â€”æŒ‡å®šä¸æ”¹å˜æ¨¡ç‰ˆç¼“å­˜ã€‚ D3DSTENCILOP_ZEROâ€”â€”æŒ‡å®šè®¾ç½®æ¨¡ç‰ˆç¼“å­˜å…¥å£ä¸º0ã€‚ D3DSTENCILOP_REPLACEâ€”â€”æŒ‡å®šç”¨æ¨¡ç‰ˆå‚è€ƒå€¼ï¼ˆreference valueï¼‰æ¥æ›¿æ¢æ¨¡ç‰ˆç¼“å­˜å…¥å£ã€‚ D3DSTENCILOP_INCRSATâ€”â€”æŒ‡å®šå¢åŠ æ¨¡ç‰ˆç¼“å­˜å…¥å£ã€‚å‡å¦‚å¢åŠ çš„å€¼è¶…è¿‡äº†å…è®¸çš„æœ€å¤§å€¼ï¼Œæˆ‘ä»¬å°±è®¾ç½®å®ƒä¸ºæœ€å¤§å€¼ã€‚ D3DSTENCILOP_DECRSATâ€”â€”æŒ‡å®šå‡å°‘æ¨¡ç‰ˆç¼“å­˜å…¥å£ã€‚å‡å¦‚å‡å°‘åçš„å€¼å°äºäº†0ï¼Œæˆ‘ä»¬å°±è®¾ç½®å®ƒ0ã€‚ D3DSTENCILOP_INVERTâ€”â€”æŒ‡å®šæŒ‰ä½å–åæ¨¡ç‰ˆç¼“å­˜å…¥å£ã€‚ D3DSTENCILOP_INCRâ€”â€”æŒ‡å®šå¢åŠ æ¨¡ç‰ˆç¼“å­˜å…¥å£ã€‚å‡å¦‚å¢åŠ çš„å€¼è¶…è¿‡äº†å…è®¸çš„æœ€å¤§å€¼ï¼Œæˆ‘ä»¬å°±è®¾ç½®å®ƒä¸º0ã€‚ D3DSTENCILOP_DECRâ€”â€”æŒ‡å®šå‡å°‘æ¨¡ç‰ˆç¼“å­˜å…¥å£ã€‚å‡å¦‚å‡å°‘åçš„å€¼å°äºäº†0ï¼Œæˆ‘ä»¬å°±è®¾ç½®å®ƒä¸ºå…è®¸çš„æœ€å¤§å€¼ã€‚æ¨¡ç‰ˆå†™æ©ç  é™¤äº†å·²ç»æåŠçš„æ¨¡ç‰ˆæ¸²æŸ“çŠ¶æ€ä¹‹å¤–ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè®¾ç½®ä¸€ä¸ªå†™æ©ç ï¼ˆwrite maskï¼‰å®ƒå°†æ©é¥°æˆ‘ä»¬å†™è¿›æ¨¡ç‰ˆç¼“å­˜çš„ä»»ä½•å€¼çš„ä½ã€‚æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡D3DRS_STENCILWRITEMASKæ¸²æŸ“çŠ¶æ€æ¥è®¾ç½®å†™æ©ç ã€‚å®ƒçš„é»˜è®¤å€¼æ˜¯0xffffffffã€‚ä¸‹é¢çš„ä¾‹å­æ˜¯æ©é¥°é«˜16ä½ï¼šDevice-&gt;SetRenderState(D3DRS_STENCILWRITEMASK, 0x0000ffff);8.2å®ä¾‹ç¨‹åºï¼šé•œå­ åœ¨è‡ªç„¶ç•Œä¸­çš„å¾ˆå¤šè¡¨é¢è±¡é•œå­ä¸€æ ·å…è®¸æˆ‘ä»¬é€šè¿‡å®ƒçš„åå°„æ¥çœ‹ç‰©ä½“ã€‚è¿™ä¸€éƒ¨åˆ†è®²äº†æˆ‘ä»¬æ€æ ·ç”¨3Dåº”ç”¨ç¨‹åºæ¥æ¨¡æ‹Ÿé•œå­ã€‚æ³¨æ„ä¸ºäº†ç®€å•æˆ‘ä»¬åªæ¨¡æ‹Ÿå¹³é¢é•œã€‚ä¸¾ç‚¹ä¾‹å­ï¼Œä¸€è¾†æ“¦äº®çš„å°æ±½è½¦èƒ½å¤Ÿåå°„ï¼›ç„¶è€Œï¼Œå°è½¦çš„è½¦èº«æ˜¯å…‰æ»‘çš„ï¼Œåœ†çš„ï¼Œä¸æ˜¯ä¸€ä¸ªå¹³é¢ã€‚æˆ‘ä»¬æ¸²æŸ“åå°„æ˜¯è¿™äº›ï¼Œè±¡å…‰æ»‘çš„å¤§ç†çŸ³åœ°æ¿ã€æŒ‚åœ¨å¢™ä¸Šçš„é•œå­ã€‚æ¢å¥è¯è¯´å°±æ˜¯åœ¨ä¸€ä¸ªå¹³é¢çš„é•œå­ã€‚ å®ç°é•œå­çš„ç¨‹åºéœ€è¦æˆ‘ä»¬è§£å†³ä¸¤ä¸ªé—®é¢˜ã€‚ç¬¬ä¸€ï¼Œæˆ‘ä»¬å¿…é¡»å­¦ä¹ æ²¿ç€ä¸€ä¸ªé¢æ€æ ·åå°„ä¸€ä¸ªç‰©ä½“ä»¥ä¾¿èƒ½å¤Ÿæ­£ç¡®åœ°ç»˜åˆ¶åå°„ç»“æœã€‚ç¬¬äºŒï¼Œæˆ‘ä»¬å¿…é¡»åªèƒ½åœ¨ä¸€ä¸ªé•œå­èŒƒå›´å†…æ˜¾ç¤ºåå°„ç»“æœã€‚å³ï¼Œæˆ‘ä»¬å¿…é¡»æ©é¥°ä¸€ä¸ªè¡¨é¢ä½œä¸ºä¸€ä¸ªé•œå­ï¼Œä¸”åªæ¸²æŸ“é‚£äº›åœ¨é•œå­é‡Œç‰©ä½“ã€‚å›¾8.1å°±æ˜¯è¯´çš„è¿™ä¸ªå†…å®¹ã€‚ ç¬¬ä¸€ä¸ªé—®é¢˜åªéœ€è¦ç”¨ä¸€äº›å‡ ä½•å‘é‡å°±å¯ä»¥ç®€å•è§£å†³ã€‚æˆ‘ä»¬èƒ½å¤Ÿåˆ©ç”¨æ¨¡ç‰ˆç¼“å­˜è§£å†³ç¬¬äºŒä¸ªé—®é¢˜ã€‚ä¸‹ä¸¤å°èŠ‚åˆ†åˆ«ä»‹ç»æ€æ ·è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ã€‚ç¬¬ä¸‰å°èŠ‚æŠŠå®ƒä»¬æŸ”å’Œåœ¨ä¸€èµ·å¹¶ä¸”ä»‹ç»ä¸€ä¸‹æœ¬ç« çš„ç¬¬ä¸€ä¸ªåº”ç”¨ç¨‹åºå®ä¾‹ä»£ç â€”â€”é•œå­ã€‚8.2.1åå°„æ•°å­¦ æˆ‘ä»¬ç°åœ¨æ¼”ç¤ºæ€æ ·è®¡ç®—ç‚¹V=ï¼ˆVx, Vy, Vzï¼‰è¢«å¹³é¢np+d=0åå°„çš„ç‚¹Vâ€™=ï¼ˆVâ€™x, Vâ€™y, Vâ€™zï¼‰ã€‚å›¾8.2è´¯ç©¿æ•´ä¸ªè®¨è®ºã€‚ å›¾8.2 æ ¹æ®Part Iä¸­çš„â€œå¹³é¢â€éƒ¨åˆ†ï¼Œæˆ‘ä»¬èƒ½å¤ŸçŸ¥é“q=v-kn,è¿™é‡Œkæ˜¯æœ‰ç¬¦å·çš„ä»våˆ°å¹³é¢çš„è·ç¦»ã€‚ä¸‹é¢æ˜¯vç›¸å¯¹ä¸å¹³é¢ï¼ˆnï¼Œdï¼‰çš„åå°„æ¨å¯¼ï¼š æˆ‘ä»¬ç”¨ä¸‹é¢çš„çŸ©é˜µæ¥å®ç°ä»våˆ°vâ€™çš„è½¬æ¢ï¼š åœ¨D3DXåº“ä¸­ç”¨ä¸‹é¢çš„å‡½æ•°æ¥åˆ›å»ºåå°„çŸ©é˜µRã€‚D3DXMATRIX D3DXMatrixReflect( D3DXMATRIX pOut, // The resulting reflection matrix. CONST D3DXPLANE pPlane // The plane to reflect about.);ä¸€æ—¦æˆ‘ä»¬è¯´åˆ°åå°„å˜æ¢çš„è¯é¢˜ï¼Œå°±è®©æˆ‘ä»¬çœ‹çœ‹å…¶ä»–3ç§ç‰¹æ®Šçš„åå°„å˜æ¢ã€‚å®ƒä»¬æ˜¯å…³äºä¸‰ä¸ªåæ ‡å¹³é¢çš„åå°„â€”yzå¹³é¢ï¼Œxzå¹³é¢ï¼Œå’Œxyå¹³é¢â€”å®ƒä»¬åˆ†åˆ«é€šè¿‡ä¸‹é¢ä¸‰ä¸ªçŸ©é˜µæ¥è¡¨ç°ï¼š é€šè¿‡yzå¹³é¢åå°„ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬åªéœ€è¦ç®€å•çš„å°†xåˆ†é‡å–åå°±å¯ä»¥äº†ã€‚åŒæ ·çš„ï¼Œé€šè¿‡xzå¹³é¢åå°„ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬åªéœ€è¦ç®€å•çš„å°†yåˆ†é‡å–åã€‚é€šè¿‡xyå¹³é¢åå°„ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬åªéœ€è¦ç®€å•çš„å°†zåˆ†é‡å–åã€‚è¿™ç§åå°„æ˜¯éå¸¸å®¹æ˜“ç†è§£çš„ã€‚8.2.2é•œé¢å®ç°æµç¨‹å½“å®ç°ä¸€ä¸ªé•œé¢ï¼Œä¸€ä¸ªç‰©ä½“å‡å¦‚åœ¨ä¸€é¢é•œå­å‰é‚£ä¹ˆå®ƒå°±ä¼šè¢«åå°„ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä¸æƒ³æµ‹è¯•ç©ºé—´å‡å¦‚ä¸€ä¸ªç‰©ä½“åœ¨ä¸€é¢é•œå­å‰ï¼Œè¦åšå®ƒæ˜¯éå¸¸å¤æ‚çš„ã€‚å› æ­¤ï¼Œä¸ºäº†ç®€åŒ–äº‹æƒ…ï¼Œæˆ‘ä»¬æ€»æ˜¯åå°„ç‰©ä½“å¹¶ä¸”æ— é™åˆ¶åœ°æ¸²æŸ“å®ƒã€‚ä½†æ˜¯è¿™æ ·å°±æœ‰ä¸€ä¸ªè±¡æœ¬ç« å¼€å¤´çš„å›¾8.1ä¸€æ ·çš„é—®é¢˜ã€‚å³ï¼Œç‰©ä½“åå°„è¢«æ¸²æŸ“åˆ°äº†æ²¡æœ‰é•œå­çš„è¡¨é¢ã€‚æˆ‘ä»¬èƒ½å¤Ÿç”¨æ¨¡ç‰ˆç¼“å­˜æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºæ¨¡ç‰ˆç¼“å­˜å…è®¸æˆ‘ä»¬é˜»æ­¢æ¸²æŸ“åœ¨åç¼“å­˜ä¸­çš„ç‰¹å®šåŒºåŸŸã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¨¡ç‰ˆç¼“å­˜æ¥é˜»æ­¢æ¸²æŸ“è¢«åå°„çš„ä¸åœ¨é•œå­é‡Œçš„èŒ¶å£¶ã€‚ä¸‹é¢çš„æ­¥éª¤ç®€è¦çš„è¯´æ˜äº†æ€æ ·å®ç°ï¼š1ã€ æ­£å¸¸æ¸²æŸ“æ‰€æœ‰çš„åœºæ™¯â€”â€”åœ°æ¿ï¼Œå¢™ï¼Œé•œå­å’ŒèŒ¶å£¶â€”â€”ä¸åŒ…å«åå°„çš„èŒ¶å£¶ã€‚æ³¨æ„è¿™ä¸€æ­¥æ²¡æœ‰ä¿®æ”¹æ¨¡ç‰ˆç¼“å­˜ã€‚2ã€ æ¸…é™¤æ¨¡ç‰ˆç¼“å­˜ä¸º0ã€‚å›¾8.3æ˜¾ç¤ºäº†åç¼“å­˜å’Œæ¨¡ç‰ˆç¼“å­˜ã€‚ å›¾8.33ã€ æ¸²æŸ“åªæœ‰é•œå­éƒ¨åˆ†çš„å›¾å…ƒåˆ°æ¨¡ç‰ˆç¼“å­˜ä¸­ã€‚è®¾ç½®æ¨¡ç‰ˆæµ‹è¯•æ€»æ˜¯æˆåŠŸï¼Œå¹¶ä¸”å‡å¦‚æµ‹è¯•æˆåŠŸå°±æŒ‡å®šæ¨¡ç‰ˆç¼“å­˜å…¥å£ä¸º1ã€‚æˆ‘ä»¬ä»…ä»…æ¸²æŸ“é•œå­ï¼Œåœ¨æ¨¡ç‰ˆç¼“å­˜ä¸­çš„æ‰€æœ‰åƒç´ éƒ½å°†ä¸º0ï¼Œé™¤äº†é•œå­éƒ¨åˆ†ä¸º1ä»¥å¤–ã€‚å›¾8.4æ˜¾ç¤ºäº†æ›´æ–°ä»¥åçš„æ¨¡ç‰ˆç¼“å­˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åœ¨æ¨¡ç‰ˆç¼“å­˜ä¸­å¯¹é•œå­åƒç´ åšäº†æ ‡è®°ã€‚ å›¾8.44ã€ ç°åœ¨æˆ‘ä»¬æ¸²æŸ“è¢«åå°„çš„èŒ¶å£¶åˆ°åç¼“å­˜å’Œæ¨¡ç‰ˆç¼“å­˜ä¸­ã€‚ä½†æ˜¯å‡å¦‚æ¨¡ç‰ˆæµ‹è¯•é€šè¿‡ï¼Œæˆ‘ä»¬å°±åªæ¸²æŸ“åç¼“å­˜ã€‚å‡å¦‚åœ¨æ¨¡ç‰ˆç¼“å­˜ä¸­çš„å€¼ä¸º1ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®¾ç½®æ¨¡ç‰ˆæµ‹è¯•é€šè¿‡ã€‚è¿™æ ·ï¼ŒèŒ¶å£¶å°±ä»…ä»…è¢«æ¸²æŸ“åˆ°æ¨¡ç‰ˆç¼“å­˜ä¸º1çš„åœ°æ–¹äº†ã€‚å› ä¸ºåªæœ‰é•œå­å¯¹åº”çš„æ¨¡ç‰ˆç¼“å­˜å€¼ä¸º1ï¼Œæ‰€ä»¥åå°„çš„èŒ¶å£¶å°±åªèƒ½è¢«æ¸²æŸ“åˆ°é•œå­é‡Œã€‚8.2.3ä»£ç å’Œè§£é‡Š è¿™ä¸ªä¾‹å­çš„ç›¸å…³ä»£ç åœ¨RenderMirrorå‡½æ•°ä¸­ï¼Œå®ƒé¦–å…ˆæ¸²æŸ“é•œå­å›¾å…ƒåˆ°æ¨¡ç‰ˆç¼“å­˜ï¼Œç„¶åæ¸²æŸ“é‚£äº›èƒ½è¢«æ¸²æŸ“åˆ°é•œå­é‡Œçš„åå°„èŒ¶å£¶ã€‚æˆ‘ä»¬ç°åœ¨ä¸€è¡Œä¸€è¡Œçš„åˆ†æRenderMirrorå‡½æ•°çš„ä»£ç ï¼Œå¹¶è§£é‡Šä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšã€‚ å‡å¦‚ä½ æƒ³ä½¿ç”¨8.2.2éƒ¨åˆ†çš„æ­¥éª¤å®ç°ä»£ç ï¼Œæ³¨æ„æˆ‘ä»¬ä»ç¬¬3æ­¥å¼€å§‹ï¼Œå› ä¸ºå¯¹æ¨¡ç‰ˆç¼“å­˜æ¥è¯´1å’Œ2æ­¥å·²ç»æ²¡æœ‰ä»€ä¹ˆäº‹åšäº†ã€‚åŒæ ·æˆ‘ä»¬é€šè¿‡è¿™ä¸ªè§£é‡Šæ¥è®¨è®ºé€šè¿‡é•œå­æ¸²æŸ“çš„ä¿¡æ¯ã€‚ æ³¨æ„æˆ‘ä»¬å°†åˆ†æˆå‡ ä¸ªéƒ¨åˆ†æ¥è®¨è®ºå®ƒã€‚8.2.3.1ç¬¬ä¸€éƒ¨åˆ† æˆ‘ä»¬é€šè¿‡å…è®¸æ¨¡ç‰ˆç¼“å­˜å’Œè®¾ç½®æ¸²æŸ“çŠ¶æ€æ¥å¼€å§‹ï¼š12345678910void RenderMirror()&#123; Device-&gt;SetRenderState(D3DRS_STENCILENABLE, true); Device-&gt;SetRenderState(D3DRS_STENCILFUNC, D3DCMP_ALWAYS); Device-&gt;SetRenderState(D3DRS_STENCILREF, 0x1); Device-&gt;SetRenderState(D3DRS_STENCILMASK, 0xffffffff); Device-&gt;SetRenderState(D3DRS_STENCILWRITEMASK,0xffffffff); Device-&gt;SetRenderState(D3DRS_STENCILZFAIL, D3DSTENCILOP_KEEP); Device-&gt;SetRenderState(D3DRS_STENCILFAIL, D3DSTENCILOP_KEEP); Device-&gt;SetRenderState(D3DRS_STENCILPASS, D3DSTENCILOP_REPLACE); è¿™æ˜¯éå¸¸å®¹æ˜“ç†è§£çš„ã€‚æˆ‘ä»¬è®¾ç½®æ¨¡ç‰ˆæ¯”è¾ƒè¿ç®—ä¸ºD3DCMP_ALWAYS,è¿™å°±æ˜¯è¯´è®©æ‰€æœ‰æ¨¡ç‰ˆæµ‹è¯•éƒ½é€šè¿‡ã€‚ å‡å¦‚æ·±åº¦æµ‹è¯•å¤±è´¥äº†ï¼Œæˆ‘ä»¬æŒ‡å®šD3DSTENCILOP_KEEPï¼Œå®ƒè¡¨æ˜ä¸æ›´æ–°æ¨¡ç‰ˆç¼“å­˜å…¥å£ã€‚å³ï¼Œæˆ‘ä»¬ä¿å­˜å½“å‰å€¼ã€‚è¿™æ ·åšçš„åŸå› æ˜¯å‡å¦‚æ·±åº¦æµ‹è¯•å¤±è´¥äº†ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€åƒç´ è¢«â€œæ¨¡ç³Šâ€äº†ã€‚æˆ‘ä»¬ä¸æƒ³æ¸²æŸ“è¢«â€œæ¨¡ç³Šâ€çš„åå°„åƒç´ ã€‚ åŒæ ·å‡å¦‚æ¨¡ç‰ˆæµ‹è¯•å¤±è´¥äº†ï¼Œæˆ‘ä»¬ä¹ŸæŒ‡å®šD3DSTENCILOP_KEEPã€‚ä½†æ˜¯åœ¨è¿™é‡Œè¿™æ ·åšä¸æ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºæˆ‘ä»¬æŒ‡å®šçš„æ˜¯D3DCMP_ALWAYSï¼Œå½“ç„¶è¿™æ ·çš„æµ‹è¯•ä¹Ÿå°±æ°¸è¿œä¸ä¼šå¤±è´¥ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬åªæ”¹å˜æ¯”è¾ƒè¿ç®—çš„ä¸€ä½ï¼Œé‚£ä¹ˆè®¾ç½®æ¨¡ç‰ˆå¤±è´¥æ¸²æŸ“çŠ¶æ€æ˜¯å¿…é¡»çš„ã€‚æˆ‘ä»¬ç°åœ¨å°±è¿™æ ·åšã€‚ å‡å¦‚æ·±åº¦æµ‹è¯•å’Œæ¨¡ç‰ˆæµ‹è¯•éƒ½é€šè¿‡äº†ï¼Œæˆ‘ä»¬å°±æŒ‡å®šD3DSTENCILOP_REPLACEï¼Œæ›´æ–°æ¨¡ç‰ˆç¼“å­˜å…¥å£ï¼Œè®¾ç½®æ¨¡ç‰ˆå‚è€ƒå€¼ä¸º0x1ã€‚8.2.3.2ç¬¬äºŒéƒ¨åˆ† è¿™ä¸‹ä¸€æ­¥é˜»æ­¢æ¸²æŸ“é•œå­ä»£ç ï¼Œé™¤äº†æ¨¡ç‰ˆç¼“å­˜ã€‚æˆ‘ä»¬é€šè¿‡è®¾ç½®D3DRS_ZWRITEENABLEå¹¶æŒ‡å®šä¸ºfalseæ¥é˜»æ­¢å†™æ·±åº¦ç¼“å­˜ã€‚æˆ‘ä»¬èƒ½å¤Ÿé˜²æ­¢æ›´æ–°åç¼“å­˜ï¼Œæ··åˆå’Œè®¾ç½®æºæ··åˆè¦ç´ ä¸ºD3DBLEND_ZEROç›®çš„æ··åˆè¦ç´ ä¸ºD3DBLEND_ONEã€‚å°†è¿™äº›æ··åˆè¦ç´ ä»£å…¥æ··åˆç­‰å¼ï¼Œæˆ‘ä»¬å¾—åˆ°åç¼“å­˜æ˜¯ä¸ä¼šæ”¹å˜çš„ï¼š12345678910111213141516// disable writes to the depth and back buffersDevice-&gt;SetRenderState(D3DRS_ZWRITEENABLE, false);Device-&gt;SetRenderState(D3DRS_ALPHABLENDENABLE, true);Device-&gt;SetRenderState(D3DRS_SRCBLEND, D3DBLEND_ZERO);Device-&gt;SetRenderState(D3DRS_DESTBLEND, D3DBLEND_ONE);// draw the mirror to the stencil bufferDevice-&gt;SetStreamSource(0, VB, 0, sizeof(Vertex));Device-&gt;SetFVF(Vertex::FVF);Device-&gt;SetMaterial(&amp;MirrorMtrl);Device-&gt;SetTexture(0, MirrorTex);D3DXMATRIX I;D3DXMatrixIdentity(&amp;I);Device-&gt;SetTransform(D3DTS_WORLD, &amp;I);Device-&gt;DrawPrimitive(D3DPT_TRIANGLELIST, 18, 2);// re-enable depth writesDevice-&gt;SetRenderState(D3DRS_ZWRITEENABLE, true); 8.2.3.3ç¬¬ä¸‰éƒ¨åˆ† åœ¨æ¨¡ç‰ˆç¼“å­˜ä¸­ï¼Œç¬¦åˆé•œå­å¯è§†åƒç´ çš„ä¸º0x1ï¼Œå› æ­¤å¯¹å·²ç»æ¸²æŸ“çš„é•œå­åŒºåŸŸåšè®°å·ã€‚æˆ‘ä»¬ç°åœ¨å‡†å¤‡æ¸²æŸ“è¢«åå°„çš„èŒ¶å£¶ã€‚å›å¿†ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä»…ä»…æƒ³æ¸²æŸ“é•œå­èŒƒå›´å†…çš„åå°„åƒç´ ã€‚æˆ‘ä»¬ç°åœ¨å¯ä»¥å¾ˆå®¹æ˜“çš„åšåˆ°äº†ï¼Œå› ä¸ºåœ¨æ¨¡ç‰ˆç¼“å­˜ä¸­è¿™äº›åƒç´ å·²ç»è¢«åšäº†è®°å·ã€‚ æˆ‘ä»¬è®¾ç½®ä¸‹é¢çš„æ¸²æŸ“çŠ¶æ€ï¼š Device-&gt;SetRenderState(D3DRS_STENCILFUNC, D3DCMP_EQUAL); Device-&gt;SetRenderState(D3DRS_STENCILPASS, D3DSTENCILOP_KEEP); ç”¨ä¸€ä¸ªæ–°çš„æ¯”è¾ƒè¿ç®—è®¾ç½®ï¼Œæˆ‘ä»¬è¿›è¡Œä¸‹é¢çš„æ¨¡ç‰ˆæµ‹è¯•ï¼š (ref &amp; mask == (value &amp; mask) (0x1 &amp; 0xffffffff) == (value &amp; 0xffffffff) (0x1)== (value &amp; 0xffffffff) è¿™è¯´æ˜äº†åªæœ‰å½“value=0x1æ—¶æ¨¡ç‰ˆæµ‹è¯•æ‰æˆåŠŸã€‚å› ä¸ºåœ¨æ¨¡ç‰ˆç¼“å­˜ä¸­åªæœ‰é•œå­ç›¸åº”ä½ç½®çš„å€¼æ‰æ˜¯0x1ï¼Œè‹¥æˆ‘ä»¬æ¸²æŸ“è¿™äº›åœ°æ–¹é‚£ä¹ˆæµ‹è¯•å°†ä¼šæˆåŠŸã€‚å› æ­¤ï¼Œè¢«åå°„çš„èŒ¶å£¶åªä¼šåœ¨é•œå­é‡Œç»˜åˆ¶è€Œä¸ä¼šåœ¨é•œå­ä»¥å¤–çš„è¡¨é¢ä¸Šç»˜åˆ¶ã€‚ æ³¨æ„æˆ‘ä»¬å·²ç»å°†æ¸²æŸ“çŠ¶æ€ç”±D3DRS_STENCILPASSå˜ä¸ºäº†D3DSTENCILOP_KEEPï¼Œç®€å•çš„è¯´å°±æ˜¯å‡å¦‚æµ‹è¯•é€šè¿‡é‚£ä¹ˆå°±ä¿å­˜æ¨¡ç‰ˆç¼“å­˜çš„å€¼ã€‚å› æ­¤ï¼Œåœ¨ä¸‹ä¸€æ­¥çš„æ¸²æŸ“ä¸­ï¼Œæˆ‘ä»¬ä¸æ”¹å˜æ¨¡ç‰ˆç¼“å­˜çš„å€¼ã€‚æˆ‘ä»¬ä»…ä»…ä½¿ç”¨æ¨¡ç‰ˆç¼“å­˜æ¥å¯¹é•œå­ç›¸åº”ä½ç½®çš„åƒç´ åšæ ‡è®°ã€‚8.2.3.4ç¬¬å››éƒ¨åˆ† RenderMirrorå‡½æ•°çš„ä¸‹ä¸€éƒ¨åˆ†å°±æ˜¯è®¡ç®—åœ¨åœºæ™¯ä¸­åå°„ä½ç½®çš„çŸ©é˜µï¼š // position reflection D3DXMATRIX W, T, R; D3DXPLANE plane(0.0f, 0.0f, 1.0f, 0.0f); // xy plane D3DXMatrixReflect(&amp;R, &amp;plane); D3DXMatrixTranslation(&amp;T, TeapotPosition.x, TeapotPosition.y, TeapotPosition.z); W = T * R; æ³¨æ„æˆ‘ä»¬é¦–å…ˆç¡®å®šæ²¡æœ‰åå°„çš„èŒ¶å£¶ä½ç½®ï¼Œç„¶åå°±é€šè¿‡xyå¹³é¢æ¥åå°„ã€‚è¿™ç§å˜æ¢è§„åˆ™æ˜¯é€šè¿‡çŸ©é˜µç›¸ä¹˜æ¥æŒ‡å®šçš„ã€‚8.2.3.5ç¬¬äº”éƒ¨åˆ† æˆ‘ä»¬å·²ç»ä¸ºæ¸²æŸ“åå°„èŒ¶å£¶åšå¥½äº†å‡†å¤‡ã€‚ç„¶è€Œï¼Œå‡å¦‚æˆ‘ä»¬ç°åœ¨å°±æ¸²æŸ“å®ƒï¼Œå®ƒæ˜¯ä¸ä¼šè¢«æ˜¾ç¤ºçš„ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºè¢«åå°„çš„èŒ¶å£¶çš„æ·±åº¦æ¯”é•œå­çš„æ·±åº¦å¤§ï¼Œå› æ­¤é•œå­çš„å›¾å…ƒå°†æŠŠè¢«åå°„èŒ¶å£¶çš„å›¾å…ƒå¼„æ¨¡ç³Šã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬æ¸…é™¤æ·±åº¦ç¼“å­˜ï¼š Device-&gt;Clear(0, 0, D3DCLEAR_ZBUFFER, 0, 1.0f, 0); å¹¶ä¸æ˜¯æ‰€æœ‰é—®é¢˜éƒ½è§£å†³äº†ã€‚å‡å¦‚æˆ‘ä»¬ç®€å•çš„æ¸…é™¤æ·±åº¦ç¼“å­˜ï¼Œè¢«åå°„çš„èŒ¶å£¶ä¼šè¢«ç»˜åˆ¶åˆ°é•œå­çš„å‰é¢ï¼Œç‰©ä½“çœ‹èµ·æ¥å°±ä¸å¯¹äº†ã€‚æˆ‘ä»¬æƒ³åšçš„æ˜¯æ¸…é™¤æ·±åº¦ç¼“å­˜å¹¶ä¸”è¦æ··åˆè¢«åå°„çš„èŒ¶å£¶å’Œé•œå­ã€‚è¿™æ ·ï¼Œè¢«åå°„çš„èŒ¶å£¶çœ‹èµ·æ¥å°±è±¡åœ¨é•œå­é‡Œäº†ã€‚æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡ä¸‹é¢çš„æ··åˆç­‰å¼æ¥æ··åˆè¢«åå°„çš„èŒ¶å£¶å’Œé•œå­ï¼š å› ä¸ºåŸåƒç´ ï¼ˆsourcePixelï¼‰æ¥è‡ªè¢«åå°„çš„èŒ¶å£¶ï¼Œç›®çš„åƒç´ ï¼ˆDestPixelï¼‰æ¥è‡ªé•œå­ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡è¿™ä¸ªç­‰å¼æ˜ç™½å®ƒä»¬æ˜¯æ€ä¹ˆè¢«æ··åˆåˆ°ä¸€èµ·çš„ã€‚æˆ‘ä»¬æœ‰å¦‚ä¸‹çš„ä»£ç ï¼š Device-&gt;SetRenderState(D3DRS_SRCBLEND, D3DBLEND_DESTCOLOR); Device-&gt;SetRenderState(D3DRS_DESTBLEND, D3DBLEND_ZERO); æœ€åï¼Œæˆ‘ä»¬å‡†å¤‡ç»˜åˆ¶è¢«åå°„çš„èŒ¶å£¶ï¼š Device-&gt;SetTransform(D3DTS_WORLD, &amp;W); Device-&gt;SetMaterial(&amp;TeapotMtrl); Device-&gt;SetTexture(0, 0); Device-&gt;SetRenderState(D3DRS_CULLMODE, D3DCULL_CW); Teapot-&gt;DrawSubset(0); å›é¡¾ä¸€ä¸‹8.2.3.4éƒ¨åˆ†çš„Wï¼Œå®ƒèƒ½å¤Ÿæ­£ç¡®çš„å°†è¢«åå°„çš„èŒ¶å£¶å˜æ¢åˆ°åœºæ™¯ä¸­æ°å½“çš„ä½ç½®ã€‚åŒæ ·ï¼Œæˆ‘ä»¬ä¹Ÿè¦æ”¹å˜èƒŒé¢æ‹£é€‰æ¨¡å¼ã€‚å¿…é¡»è¿™æ ·åšçš„åŸå› æ˜¯å½“ä¸€ä¸ªç‰©ä½“è¢«åå°„ä»¥åï¼Œå®ƒçš„æ­£é¢å’ŒèƒŒé¢å°†ä¼šè¢«äº¤æ¢ã€‚å› æ­¤ä¸ºäº†æ”¹å˜è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¿…é¡»æ”¹å˜èƒŒé¢æ‹£é€‰æ¨¡å¼ã€‚ Device-&gt;SetRenderState(D3DRS_ALPHABLENDENABLE, false); Device-&gt;SetRenderState( D3DRS_STENCILENABLE, false); Device-&gt;SetRenderState(D3DRS_CULLMODE, D3DCULL_CCW);} // end RenderMirror()8.3å®ä¾‹ç¨‹åºï¼šå¹³é¢é˜´å½±åœ¨åœºæ™¯ä¸­è¢«ç¯å…‰ç…§å°„çš„åœ°æ–¹ä¼šäº§ç”Ÿé˜´å½±ï¼Œè¿™å°†ä½¿åœºæ™¯å˜çš„æ›´çœŸå®ã€‚åœ¨è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬å°†æ¼”ç¤ºæ€æ ·å®ç°å¹³é¢é˜´å½±ï¼Œå³åœ¨å¹³é¢ä¸Šçš„é˜´å½±ï¼ˆå¦‚å›¾8.5ï¼‰ã€‚ å›¾8.5æ³¨æ„è¿™ç§é˜´å½±æ˜¯â€œå¿«ç â€ï¼Œè™½ç„¶å®ƒä»¬å¢å¼ºäº†åœºæ™¯æ•ˆæœï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯ç°å®ä¸­çš„é˜´å½±ã€‚é˜´å½±å€¼æ˜¯ä¸€ä¸ªé«˜çº§çš„æ¦‚å¿µï¼Œè¦æ·±å…¥ç ”ç©¶å®ƒå·²ç»è¶…å‡ºäº†æœ¬ä¹¦çš„èŒƒå›´ã€‚ç„¶è€Œï¼Œç‰¹åˆ«å€¼å¾—æåŠçš„æ˜¯åœ¨DirectX SDKä¸­æœ‰ä¸€ä¸ªç¤ºä¾‹ç¨‹åºæ¼”ç¤ºäº†é˜´å½±å€¼ã€‚ ä¸ºäº†å®ç°å¹³é¢é˜´å½±ï¼Œæˆ‘ä»¬é¦–å…ˆå¿…é¡»æ‰¾åˆ°ç‰©ä½“æŠ•å°„åˆ°å¹³é¢ä¸Šçš„é˜´å½±å¹¶è¿›è¡Œå‡ ä½•å»ºæ¨¡ä»¥ä¾¿æˆ‘ä»¬èƒ½å¤Ÿæ¸²æŸ“å®ƒã€‚ç”¨ä¸€äº›3Dæ•°å­¦å°±èƒ½å¾ˆå®¹æ˜“çš„å®ç°å®ƒã€‚æˆ‘ä»¬ç„¶åç”¨50%é€æ˜åº¦çš„é»‘è‰²æè´¨æ¥æ¸²æŸ“æè¿°é˜´å½±çš„å¤šè¾¹å½¢ã€‚æ¸²æŸ“é˜´å½±æ—¶å¯èƒ½å‡ºç°â€œåŒå€æ··åˆâ€ï¼Œæˆ‘ä»¬å°†ç”¨ä¸€å°éƒ¨åˆ†è¿›è¡Œè§£é‡Šã€‚æˆ‘ä»¬ä½¿ç”¨æ¨¡ç‰ˆç¼“å­˜æ¥é˜²æ­¢åŒå€æ··åˆå‘ç”Ÿã€‚8.3.1å¹³è¡Œå…‰é˜´å½± å›¾8.6å›¾8.6æ˜¾ç¤ºäº†ç‰©ä½“åœ¨å¹³è¡Œå…‰ç…§å°„ä¸‹å¾—åˆ°çš„é˜´å½±ã€‚å…‰çº¿æ˜¯ä»å¹³è¡Œå…‰æºæ”¾å°„å‡ºçš„ï¼Œå®ƒçš„æ–¹å‘æ˜¯L,é€šè¿‡é¡¶ç‚¹på¾—åˆ°rï¼ˆtï¼‰ = p + tLã€‚å…‰çº¿rï¼ˆtï¼‰å’Œå¹³é¢n * p + d = 0 ç›¸äº¤å¾—åˆ° s ã€‚äº¤ç‚¹s é€šè¿‡å°„çº¿å’Œå¹³é¢ç›¸äº¤æµ‹è¯•æ˜¯éå¸¸å®¹æ˜“å¾—åˆ°çš„ï¼šæŠŠr(t)å¸¦è¿›å¹³é¢ç­‰å¼æ±‚è§£t é‚£ä¹ˆï¼š 8.3.2ç‚¹å…‰æºé˜´å½± å›¾8.7å›¾8.7æ˜¾ç¤ºäº†ç‰©ä½“åœ¨ç‚¹å…‰æºç…§å°„ä¸‹å¾—åˆ°çš„é˜´å½±ã€‚ç‚¹å…‰æºçš„ä½ç½®æ˜¯Lã€‚å…‰çº¿é€šè¿‡é¡¶ç‚¹pï¼Œåˆ™å¾—åˆ° r(t) = p + t ( p â€“ L )ã€‚å…‰çº¿rï¼ˆtï¼‰å’Œå¹³é¢n p + d = 0 ç›¸äº¤å¾—åˆ° s ã€‚ç”¨8.3.1åŒæ ·çš„æ–¹æ³•æˆ‘ä»¬å¯ä»¥å¾—åˆ°sã€‚æ³¨æ„ï¼šåœ¨ç‚¹å…‰æºå’Œå¹³è¡Œå…‰ä¸­çš„Læ˜¯ä¸åŒçš„ã€‚å¯¹äºç‚¹å…‰æºï¼Œæˆ‘ä»¬ç”¨Læ¥è¡¨ç¤ºç‚¹å…‰æºçš„ä½ç½®ã€‚è€Œå¯¹äºå¹³è¡Œå…‰ï¼Œæˆ‘ä»¬åˆ™æ˜¯ç”¨Læ¥è¡¨ç¤ºå¹³è¡Œå…‰çš„ç…§å°„æ–¹å‘ã€‚8.3.3é˜´å½±çŸ©é˜µ æ³¨æ„å›¾8.6ä¸­æ‰€ç¤ºçš„å¹³è¡Œå…‰ï¼Œå½±å­æœ¬è´¨ä¸Šæ˜¯æŠŠç‰©ä½“æŒ‰ç…§ç¯å…‰ç…§å°„æ–¹å‘å¹³è¡Œåœ°æŠ•å°„åˆ°å¹³é¢np+d=0ä¹‹ä¸Šã€‚åŒæ ·çš„ï¼Œå›¾8.7ä¸­æ‰€ç¤ºçš„ç‚¹å…‰æºï¼Œå½±å­æœ¬è´¨ä¸Šæ˜¯æŠŠç‰©ä½“æŒ‰ç…§é€è§†ç”»æ³•ä»å…‰æºæŠ•å°„åˆ°å¹³é¢np+d=0ä¹‹ä¸Šã€‚ æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ä¸€ä¸ªçŸ©é˜µæ¥è¡¨ç¤ºä»ä¸€ä¸ªé¡¶ç‚¹på˜æ¢åˆ°å¹³é¢np=d=0ä¸Šçš„sçš„å˜åŒ–ã€‚è€Œä¸”ï¼Œæˆ‘ä»¬èƒ½å¤Ÿç”¨åŒä¸€ä¸ªçŸ©é˜µæ¥è¡¨ç°æ­£äº¤æŠ•å½±å’Œé€è§†æŠ•å½±ã€‚ æˆ‘ä»¬ç”¨ä¸€ä¸ª4Då‘é‡ï¼ˆnx, ny, nz, dï¼‰æ¥è¡¨ç¤ºå°†è¦ç”¨äºæŠ•å°„é˜´å½±å¹³é¢çš„å¹³é¢ç­‰å¼ä¸­çš„å„ä¸ªç³»æ•°ã€‚è®©4Då‘é‡L=ï¼ˆLx, Ly, Lz, Lwï¼‰æ¥è¡¨ç¤ºå¹³è¡Œå…‰çš„ç…§å°„æ–¹å‘æˆ–ç‚¹å…‰æºçš„ä½ç½®ã€‚æˆ‘ä»¬ç”¨wæ¥åŒºåˆ«ï¼šï¼‘ï¼ å‡å¦‚wï¼ï¼ï¼Œé‚£ä¹ˆLè¡¨ç¤ºå¹³è¡Œå…‰çš„ç…§å°„æ–¹å‘ã€‚ï¼’ï¼ å‡å¦‚wï¼1 ï¼Œé‚£ä¹ˆLè¡¨ç¤ºç‚¹å…‰æºçš„ä½ç½®ã€‚è§„æ ¼åŒ–çš„å¹³é¢æ˜¯éå¸¸ä¸é€Šçš„ï¼Œæˆ‘ä»¬è®©kï¼ï¼ˆnx, ny, nz, dï¼‰*ï¼ˆLx, Ly, Lz, Lwï¼‰= nxLx+nyLy+nzLz+dLwé‚£ä¹ˆæˆ‘ä»¬å°±å¯å¾—åˆ°è¡¨ç¤ºç‚¹påˆ°ç‚¹sçš„å˜æ¢çŸ©é˜µï¼Œå³é˜´å½±çŸ©é˜µï¼š å› ä¸ºåœ¨å…¶ä»–åœ°æ–¹å·²ç»è¢«æ¨å¯¼å‡ºæ¥äº†ï¼Œå¯¹äºæˆ‘ä»¬æ¥è¯´æ¨å¯¼å®ƒå¹¶æ²¡æœ‰é‡å¤§çš„æ„ä¹‰ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°±ä¸å†æ¼”ç¤ºæ¨å¯¼æ€æ ·å¾—åˆ°è¿™ä¸ªçŸ©é˜µçš„è¿‡ç¨‹äº†ã€‚ä½†æ˜¯å¯¹ä¸æ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥è‡ªå·±åˆ°ç½‘ä¸ŠæŸ¥æ‰¾ç›¸åº”çš„ä¿¡æ¯ã€‚ åœ¨D3DXåº“ä¸­å·²ç»ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå»ºç«‹é˜´å½±çŸ©é˜µçš„å‡½æ•°ã€‚å…¶ä¸­å½“wï¼ï¼æ—¶è¡¨ç¤ºå¹³è¡Œå…‰ï¼Œå½“wï¼ï¼‘æ—¶è¡¨ç¤ºç‚¹å…‰æºï¼š12345D3DXMATRIX *D3DXMatrixShadow( D3DXMATRIX *pOut, CONST D3DXVECTOR4 *pLight, // L CONST D3DXPLANE *pPlane // plane to cast shadow onto); 8.3.4ç”¨æ¨¡ç‰ˆç¼“å­˜é˜²æ­¢åŒå€æ··åˆ å‡ ä½•å­¦ä¸Šï¼Œå½“æˆ‘ä»¬å°†ä¸€ä¸ªç‰©ä½“æŠ•å½±åˆ°ä¸€ä¸ªå¹³é¢ä¸Šæ—¶ï¼Œå¾ˆå¯èƒ½ä¼šæœ‰ä¸¤ä¸ªæˆ–è€…æ›´å¤šçš„æŠ•å½±ä¸‰è§’å½¢è¢«é‡å åˆ°ä¸€èµ·ã€‚è‹¥æˆ‘ä»¬å°±è¿™æ ·æ¸²æŸ“ï¼Œé‚£ä¹ˆæœ‰é‡å ä¸‰è§’å½¢çš„åœ°æ–¹å°±ä¼šè¢«å¤šæ¬¡æ··åˆä»¥è‡³è¿™äº›åœ°æ–¹å°†ä¼šå˜å¾—æ›´é»‘ã€‚å›¾8.8å°±æ˜¯è¿™ç§æƒ…å†µã€‚ å›¾8.8 æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨æ¨¡ç‰ˆç¼“å­˜æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬è®¾ç½®æ¨¡ç‰ˆæµ‹è¯•ä¸ºå…è®¸åƒç´ ç¬¬ä¸€æ¬¡è¢«æ¸²æŸ“ã€‚å³ï¼Œå½“æŠŠå½±å­åƒç´ æ¸²æŸ“åˆ°åç¼“å­˜æ—¶ï¼Œæˆ‘ä»¬åŒæ—¶åœ¨æ¨¡ç‰ˆç¼“å­˜ä¸­åšå¥½æ ‡è®°ã€‚ç„¶åï¼Œå¦‚æœè¯•å›¾æŠŠåƒç´ å‘ä¸€ä¸ªå·²ç»æ¸²æŸ“è¿‡çš„åœ°æ–¹å†™ï¼Œé‚£ä¹ˆæ¨¡ç‰ˆæµ‹è¯•å°†ä¼šå¤±è´¥ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±é˜²æ­¢äº†é‡å¤å†™åƒç´ ä¹Ÿå°±æ˜¯é˜²æ­¢äº†åŒå€æ··åˆçš„å‘ç”Ÿã€‚8.3.5ä»£ç å’Œè§£é‡Š ä¸‹é¢çš„ä»£ç å°±æ˜¯è®²è§£å½±å­ä¾‹å­ã€‚æœ¬ä¾‹çš„ç›¸å…³ä»£ç éƒ½åœ¨RenderShadowå‡½æ•°ä¸­ã€‚æ³¨æ„æˆ‘ä»¬å‡è®¾æ¨¡ç‰ˆç¼“å­˜éƒ½å·²ç»è¢«æ¸…é™¤ä¸ºï¼äº†ã€‚ é¦–å…ˆè®¾ç½®æ¨¡ç‰ˆæ¸²æŸ“çŠ¶æ€ã€‚å°†æ¨¡ç‰ˆæ¯”è¾ƒè¿ç®—è®¾ä¸ºD3DCMP_EQUALä¸”å°†D3DRS_STENCILREFæ¸²æŸ“çŠ¶æ€è®¾ç½®ä¸º0x0ï¼Œå› æ­¤å‡å¦‚åœ¨æ¨¡ç‰ˆç¼“å­˜ä¸­ç›¸åº”çš„å€¼ä¸º0x0ï¼Œé‚£ä¹ˆå°±æŒ‡å®šæ¸²æŸ“é˜´å½±åˆ°åç¼“å­˜ä¸­ã€‚ å› ä¸ºæ¨¡ç‰ˆç¼“å­˜æ˜¯è¢«æ¸…é™¤ä¸º0x0çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç¬¬ä¸€æ¬¡å°†å½±å­åƒç´ å†™å…¥çš„æ—¶å€™æ€»æ˜¯æ­£ç¡®çš„ï¼›ä¸è¿‡å› ä¸ºæˆ‘ä»¬è®¾ç½®D3DRS_STENCILPASSä¸ºD3DSTENCILOP_INCR,å‡å¦‚ä½ è¯•å›¾å°†å·²ç»å†™è¿‡çš„åƒç´ å†™å…¥çš„è¯ï¼Œè¿™ä¸ªæµ‹è¯•å°†ä¼šå¤±è´¥ã€‚åœ¨ç¬¬ä¸€æ¬¡å†™å…¥çš„æ—¶å€™æ¨¡ç‰ˆåƒç´ å·²ç»è¢«å†™æˆäº†0x1ï¼Œå› æ­¤å‡å¦‚ä½ å†ä¸€æ¬¡å†™å…¥ï¼Œæ¨¡ç‰ˆæµ‹è¯•å°†ä¼šå¤±è´¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é¿å…äº†é‡å¤å†™åƒç´ ï¼Œä¹Ÿé¿å…äº†åŒå€æ··åˆã€‚123456789101112131415161718192021void RenderShadow()&#123; Device-&gt;SetRenderState(D3DRS_STENCILENABLE, true); Device-&gt;SetRenderState(D3DRS_STENCILFUNC, D3DCMP_EQUAL); Device-&gt;SetRenderState(D3DRS_STENCILREF, 0x0); Device-&gt;SetRenderState(D3DRS_STENCILMASK, 0xffffffff); Device-&gt;SetRenderState(D3DRS_STENCILWRITEMASK, 0xffffffff); Device-&gt;SetRenderState(D3DRS_STENCILZFAIL, D3DSTENCILOP_KEEP); Device-&gt;SetRenderState(D3DRS_STENCILFAIL, D3DSTENCILOP_KEEP); Device-&gt;SetRenderState(D3DRS_STENCILPASS, D3DSTENCILOP_INCR); ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬è®¡ç®—é˜´å½±å˜æ¢å¹¶å°†å®ƒæ”¾ç½®åˆ°åœºæ™¯ä¸­é€‚å½“çš„ä½ç½®ã€‚ // compute the transformation to flatten the teapot into a shadow. D3DXVECTOR4 lightDirection(0.707f, -0.707f, 0.707f, 0.0f); D3DXPLANE groundPlane(0.0f, -1.0f, 0.0f, 0.0f); D3DXMATRIX S; D3DXMatrixShadow(&amp;S, &amp;lightDirection, &amp;groundPlane); D3DXMATRIX T; D3DXMatrixTranslation(&amp;T, TeapotPosition.x, TeapotPosition.y, TeapotPosition.z); D3DXMATRIX W = T * S; Device-&gt;SetTransform(D3DTS_WORLD, &amp;W); æœ€åï¼Œæˆ‘ä»¬è®¾ç½®ä¸€ä¸ª50%é€æ˜åº¦çš„é»‘è‰²æè´¨ï¼Œå…³é—­æ·±åº¦æµ‹è¯•ï¼Œæ¸²æŸ“é˜´å½±ï¼Œç„¶åå¼€å¯æ·±åº¦ç¼“å­˜åŒæ—¶å…³é—­alphaæ··åˆå’Œæ¨¡ç‰ˆæµ‹è¯•ã€‚æˆ‘ä»¬å…³é—­æ·±åº¦ç¼“å­˜æ¥é˜²æ­¢z-fightingï¼Œå®ƒæ˜¯å½“ä¸¤ä¸ªä¸åŒçš„è¡¨é¢åœ¨æ·±åº¦ç¼“å­˜ä¸­æœ‰åŒæ ·çš„æ·±åº¦å€¼æ—¶å‡ºç°çš„è™šæ‹Ÿç‰©ä½“ï¼›æ·±åº¦ç¼“å­˜ä¸çŸ¥é“é‚£ä¸€ä¸ªæ˜¯åœ¨å‰é¢ï¼Œæ­¤æ—¶å°±ä¼šäº§ç”Ÿè®¨åŒçš„é—ªåŠ¨ã€‚å› ä¸ºé˜´å½±å’Œåœ°æ¿æ˜¯åœ¨åŒä¸€ä¸ªå¹³é¢ä¸Šï¼Œz-fightingå¾ˆå¯èƒ½å°±ä¼šå‡ºç°ã€‚é€šè¿‡å…ˆæ¸²æŸ“åœ°æ¿ç„¶åç”¨æ·±åº¦æµ‹è¯•å±è”½é˜´å½±ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å¤Ÿä¿è¯é˜´å½±å°†ç»˜åˆ¶åœ¨åœ°é¢åªä¹‹ä¸Šã€‚ Device-&gt;SetRenderState(D3DRS_ALPHABLENDENABLE, true); Device-&gt;SetRenderState(D3DRS_SRCBLEND, D3DBLEND_SRCALPHA); Device-&gt;SetRenderState(D3DRS_DESTBLEND, D3DBLEND_INVSRCALPHA); D3DMATERIAL9 mtrl = d3d::InitMtrl(d3d::BLACK, d3d::BLACK, d3d::BLACK, d3d::BLACK, 0.0f); mtrl.Diffuse.a = 0.5f; // 50% transparency. // Disable depth buffer so that z-fighting doesnâ€™t occur when we // render the shadow on top of the floor. Device-&gt;SetRenderState(D3DRS_ZENABLE, false); Device-&gt;SetMaterial(&amp;mtrl); Device-&gt;SetTexture(0, 0); Teapot-&gt;DrawSubset(0); Device-&gt;SetRenderState(D3DRS_ZENABLE, true); Device-&gt;SetRenderState(D3DRS_ALPHABLENDENABLE, false); Device-&gt;SetRenderState(D3DRS_STENCILENABLE, false);}//end RenderShadow()]]></content>
      <categories>
        <category>Direct3D</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬ä¸ƒç«  æ··åˆ(Blending)]]></title>
    <url>%2F2019%2F04%2F11%2FBlending%2F</url>
    <content type="text"><![CDATA[æ··åˆå› ç´  è§‚å¯Ÿå›¾7.1ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªçº¢è‰²çš„èŒ¶å£¶ç»˜åˆ¶åœ¨ä¸€ä¸ªæœ¨è´¨èƒŒæ™¯ä¸Šã€‚ å›¾7.1 å‡è®¾æƒ³è®©èŒ¶å£¶æœ‰ä¸€ä¸ªé€æ˜åº¦ï¼Œä»¥ä¾¿æˆ‘ä»¬èƒ½å¤Ÿé€è¿‡èŒ¶å£¶çœ‹è§èƒŒæ™¯ï¼ˆå¦‚å›¾7.2ï¼‰ã€‚ å›¾7.2 æˆ‘ä»¬æ€æ ·æ‰èƒ½å®ç°è¿™ä¸ªæ•ˆæœå‘¢ï¼Ÿæˆ‘ä»¬åªéœ€è¦åœ¨æœ¨ç®±å­ä¸Šå…‰æ …åŒ–èŒ¶å£¶ä¸‰è§’å½¢ï¼Œæˆ‘ä»¬éœ€è¦ç»“åˆåƒç´ é¢œè‰²ï¼Œå°±è±¡é€šè¿‡èŒ¶å£¶æ˜¾ç¤ºæœ¨ç®±é‚£æ ·æ¥è®¡ç®—èŒ¶å£¶çš„åƒç´ é¢œè‰²ã€‚ç»“åˆåƒç´ å€¼çš„æ„æ€å°±æ˜¯ç”¨ä»¥å‰å†™è¿‡çš„ç›®æ ‡åƒç´ å€¼å»ä¼°ç®—æºåƒç´ å€¼è¿™è¢«å«åšæ··åˆã€‚æ³¨æ„æ··åˆçš„æ•ˆæœä¸ä»…ä»…è±¡æ˜¯ç»ç’ƒé€æ˜ä¸€æ ·ã€‚æˆ‘ä»¬æœ‰å¾ˆå¤šé€‰é¡¹æ¥æŒ‡å®šé¢œè‰²æ˜¯æ€æ ·è¢«æ··åˆçš„ï¼Œå°±è±¡7.2éƒ¨åˆ†ä¸­çœ‹åˆ°çš„ä¸€æ ·ã€‚ è¿™æ˜¯å¾ˆé‡è¦çš„ï¼Œè®¤è¯†ä¸‰è§’å½¢æ™®éåˆ©ç”¨ä»¥å‰å†™å…¥åç¼“å­˜ä¸­çš„åƒç´ æ¥ä¸ä¹‹æ··åˆæ¥å…‰æ …åŒ–ã€‚åœ¨ç¤ºä¾‹å›¾ç‰‡ä¸­ï¼Œæœ¨ç®±å›¾ç‰‡é¦–å…ˆè¢«ç”»å‡ºæ¥ä¸”å®ƒçš„åƒç´ åœ¨åç¼“å­˜ä¸­ã€‚æˆ‘ä»¬ç„¶åç»˜åˆ¶èŒ¶å£¶ï¼Œä»¥ä¾¿ç”¨æœ¨ç®±çš„åƒç´ æ¥æ··åˆèŒ¶å£¶çš„åƒç´ ã€‚å› æ­¤ï¼Œå½“ä½¿ç”¨æ··åˆæ—¶ï¼Œä¸‹é¢çš„è§„åˆ™å°†è¢«éµå¾ªï¼š è§„åˆ™ï¼šé¦–å…ˆä¸ä½¿ç”¨æ··åˆç»˜åˆ¶ç‰©ä½“ã€‚ç„¶åæ ¹æ®ç‰©ä½“ç¦»æ‘„è±¡æœºçš„è·ç¦»ä½¿ç”¨æ··åˆå¯¹ç‰©ä½“æ‹£é€‰ï¼›è¿™æ˜¯éå¸¸æœ‰æ•ˆçš„å¤„ç†ï¼Œå‡å¦‚ç‰©ä½“æ˜¯åœ¨è§†å›¾åæ ‡ä¸­ï¼Œé‚£ä¹ˆä½ èƒ½å¤Ÿåˆ©ç”¨zåˆ†é‡ç®€å•åœ°æ‹£é€‰ã€‚æœ€åä½¿ç”¨ä»ååˆ°å‰çš„é¡ºåºæ··åˆç»˜åˆ¶ç‰©ä½“ã€‚ ä¸‹é¢çš„å…¬å¼æ˜¯ç”¨æ¥æ··åˆä¸¤ä¸ªåƒç´ å€¼çš„ï¼š ä¸Šé¢çš„æ‰€æœ‰å˜é‡éƒ½æ˜¯ä¸€ä¸ª4Dé¢œè‰²å‘é‡ï¼ˆr,g,b,aï¼‰ï¼Œå¹¶ä¸”ç¬¦å·æ˜¯è¡¨ç¤ºåˆ†é‡ç›¸ä¹˜ã€‚ OutputPixelâ€”â€”æ··åˆåçš„åƒç´ ç»“æœã€‚ SourcePixelâ€”â€”é€šå¸¸è¢«è®¡ç®—çš„åƒç´ ï¼Œå®ƒæ˜¯åˆ©ç”¨åœ¨åç¼“å­˜ä¸­çš„åƒç´ æ¥è¢«æ··åˆçš„ã€‚ SourceBlendFactorâ€”â€”åœ¨[0ï¼Œ1]èŒƒå›´å†…çš„ä¸€ä¸ªå€¼ã€‚å®ƒæŒ‡å®šæºåƒç´ åœ¨æ··åˆä¸­çš„ç™¾åˆ†æ¯”ã€‚ DestPixelâ€”â€”åœ¨åç¼“å­˜ä¸­çš„åƒç´ ã€‚ DestBlendFactorâ€”â€”åœ¨[0ï¼Œ1]èŒƒå›´å†…çš„ä¸€ä¸ªå€¼ã€‚å®ƒæŒ‡å®šç›®çš„åƒç´ åœ¨æ··åˆä¸­çš„ç™¾åˆ†æ¯”ã€‚ æºå’Œç›®çš„æ··åˆè¦ç´ ä½¿æˆ‘ä»¬èƒ½å¤ŸæŒ‰ç…§å¤šç§é€”å¾„æ”¹å˜åŸå§‹æºå’Œç›®çš„åƒç´ ï¼Œå…è®¸å®ç°ä¸åŒçš„æ•ˆæœã€‚7.2èŠ‚åˆ—ä¸¾äº†èƒ½å¤Ÿè¢«ä½¿ç”¨çš„é¢„å…ˆç¡®å®šçš„å€¼ã€‚ æ··åˆé»˜è®¤æ˜¯è¢«å…³é—­çš„ï¼›ä½ èƒ½å¤Ÿé€šè¿‡è®¾ç½®D3DRS_ALPHABLENDENABLEæ¸²æŸ“çŠ¶æ€ä¸ºtrueæ¥å¼€å¯å®ƒï¼šDevice-&gt;SetRenderState(D3DRS_ALPHABLENDENABLE, true);7.2æ··åˆè¦ç´  é€šè¿‡è®¾ç½®ä¸åŒçš„æºå’Œç›®çš„è¦ç´ ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ›é€ å¾ˆå¤šä¸åŒçš„æ··åˆæ•ˆæœã€‚é€šè¿‡å®éªŒï¼Œä½¿ç”¨ä¸åŒçš„ç»„åˆçœ‹çœ‹å®ƒä»¬åˆ°åº•èƒ½å®ç°ä»€ä¹ˆæ•ˆæœã€‚ä½ èƒ½å¤Ÿé€šè¿‡è®¾ç½®D3DRS_SRCBLENDå’ŒD3DRS_DESTBLENDæ¸²æŸ“çŠ¶æ€æ¥åˆ†åˆ«è®¾ç½®æºæ··åˆè¦ç´ å’Œç›®çš„æ··åˆè¦ç´ ã€‚ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼šDevice-&gt;SetRenderState(D3DRS_SRCBLEND, Source);Device-&gt;SetRenderState(D3DRS_DESTBLEND, Destination); è¿™é‡ŒSourceå’ŒDestinationèƒ½å¤Ÿä½¿ç”¨ä¸‹é¢æ··åˆè¦ç´ ä¸­çš„ä¸€ä¸ªï¼š D3DBLEND_ZEROâ€”â€”blendFactor=(0, 0, 0, 0) D3DBLEND_ONEâ€”â€”blendFactor=(1, 1, 1, 1) D3DBLEND_SRCCOLORâ€”â€”blendFactor=(rs, gs, bs, as) D3DBLEND_INVSRCCOLORâ€”â€”blendFactor=(1-rs, 1-gs, 1-bs, 1-as) D3DBLEND_SRCALPHAâ€”â€”blendFactor=(as, as, as, as) D3DBLEND_INVSRCALPHAâ€”â€”blendFactor=(1-as, 1-as, 1-as, 1-as) D3DBLEND_DESTALPHAâ€”â€”blendFactor=(ad, ad, ad, ad) D3DBLEND_INVDESTALPHAâ€”â€”blendFactor=(1-ad, 1-ad, 1-ad, 1-ad) D3DBLEND_DESTCOLORâ€”â€”blendFactor=(rd, gd, bd, ad) D3DBLEND_INVDESTCOLORâ€”â€”blendFactor=(1-rd, 1-gd, 1-bd, 1-ad) D3DBLEND_SRCALPHASATâ€”â€”blendFactor=(f, f, f, 1) , f=min(as, 1 â€“ ad) D3DBLEND_BOTHINVSRCALPHAâ€”â€”è¿™ç§æ··åˆæ¨¡å¼è®¾ç½®æºæ··åˆè¦ç´ ä¸ºï¼ˆ1-as, 1-as, 1-as, 1-as,ï¼‰ä»¥åŠç›®çš„æ··åˆè¦ç´ ä¸ºï¼ˆas,as,as,asï¼‰ã€‚è¿™ç§æ··åˆæ¨¡å¼ä»…å¯¹D3DRS_SRCBLENDæœ‰æ•ˆã€‚ æºå’Œç›®çš„æ··åˆè¦ç´ çš„é»˜è®¤å€¼åˆ†åˆ«æ˜¯D3DBLEND_SRCALPHAå’ŒD3DBLEND_INVSRCALPHAã€‚7.3é€æ˜åº¦ åœ¨ä»¥å‰çš„ç« èŠ‚ä¸­æˆ‘ä»¬å¿½ç•¥äº†é¢œè‰²é¡¶ç‚¹å’Œæè´¨ä¸­çš„alphaéƒ¨åˆ†ï¼Œé‚£æ˜¯å› ä¸ºå½“æ—¶å®ƒå¹¶ä¸æ˜¯å¿…é¡»çš„ã€‚ç°åœ¨å®ƒé¦–å…ˆè¢«ç”¨åœ¨æ··åˆä¸­ã€‚ Alphaéƒ¨åˆ†ä¸»è¦æ˜¯ç”¨æ¥æŒ‡å®šåƒç´ çš„é€æ˜ç­‰çº§ã€‚æˆ‘ä»¬ä¸ºæ¯ä¸ªåƒç´ çš„alphaéƒ¨åˆ†ä¿ç•™8ä½ï¼Œalphaçš„æœ‰æ•ˆå€¼åœ¨[0,255]èŒƒå›´å†…ï¼Œ[0,255]ä»£è¡¨ä¸é€æ˜åº¦[0%,100%]ã€‚å› æ­¤ï¼Œåƒç´ çš„alphaä¸º0æ—¶ï¼Œè¡¨ç¤ºå®Œå…¨é€æ˜ï¼Œåƒç´ çš„alphaä¸º128æ—¶ï¼Œè¡¨ç¤º50%é€æ˜ï¼Œåƒç´ çš„alphaä¸º255æ—¶ï¼Œè¡¨ç¤ºå®Œå…¨ä¸é€æ˜ã€‚ ä¸ºäº†è®©alphaéƒ¨åˆ†æè¿°åƒç´ çš„é€æ˜ç­‰çº§ï¼Œæˆ‘ä»¬å¿…é¡»è®¾ç½®æºæ··åˆè¦ç´ ä¸ºD3DBLEND_SRCALPHAä»¥åŠç›®çš„æ··åˆè¦ç´ ä¸ºD3DBLEND_INVSRCALPHAã€‚è¿™äº›å€¼ç¢°å·§ä¹Ÿæ˜¯è¢«é»˜è®¤è®¾ç½®çš„ã€‚7.3.1Alphaé€šé“ ä»£æ›¿ä½¿ç”¨Alphaéƒ¨åˆ†æ¥è®¡ç®—é®å½±ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä»çº¹ç†çš„alphaé€šé“ä¸­å¾—åˆ°alphaä¿¡æ¯ã€‚Alphaé€šé“æ˜¯é¢å¤–çš„è®¾ç½®ä½ï¼Œç”¨å®ƒæ¥ä¿å­˜æ¯ä¸€ä¸ªç‚¹çš„alphaå€¼ã€‚å½“ä¸€ä¸ªçº¹ç†è¢«æ˜ å°„åˆ°ä¸€ä¸ªå›¾å…ƒä¸Šæ—¶ï¼Œåœ¨alphaé€šé“ä¸­çš„alphaä¿¡æ¯ä¹Ÿè¢«æ˜ å°„ï¼Œå¹¶ä¸”å®ƒä»¬åˆ©ç”¨alphaä¿¡æ¯ä¸ºæ¯ä¸ªåƒç´ èµ‹äºˆçº¹ç†ã€‚å›¾7.3æ˜¾ç¤ºäº†ä¸€ä¸ªå¸¦8ä½alphaé€šé“çš„å›¾ç‰‡ã€‚ å›¾7.3 å›¾7.4æ˜¾ç¤ºçš„æ˜¯ä¸€ä¸ªåˆ©ç”¨alphaé€šé“æŒ‡å®šé€æ˜åº¦æ¥æ¸²æŸ“çš„ä¸€ä¸ªçº¹ç†æ–¹å—ã€‚ å›¾7.47.3.2æŒ‡å®šAlphaèµ„æº é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡å¦‚è®¾ç½®ä¸€ä¸ªæœ‰alphaé€šé“çš„çº¹ç†ï¼Œalphaå€¼ä»åœ¨alphaé€šé“ä¸­è·å¾—ã€‚å‡å¦‚æ²¡æœ‰alphaé€šé“ï¼Œé‚£ä¹ˆalphaå€¼æ˜¯é€šè¿‡é¡¶ç‚¹é¢œè‰²è·å¾—ã€‚ç„¶è€Œï¼Œä½ èƒ½å¤Ÿé€šè¿‡ä¸‹é¢çš„æ¸²æŸ“çŠ¶æ€æ¥æŒ‡å®šä½¿ç”¨å“ªä¸€ä¸ªèµ„æºï¼š// compute alpha from diffuse colors during shadingDevice-&gt;SetTextureStageState(0, D3DTSS_ALPHAARG1, D3DTA_DIFFUSE);Device-&gt;SetTextureStageState(0, D3DTSS_ALPHAOP, D3DTOP_SELECTARG1);// take alpha from alpha channelDevice-&gt;SetTextureStageState(0, D3DTSS_ALPHAARG1, D3DTA_TEXTURE);Device-&gt;SetTextureStageState(0, D3DTSS_ALPHAOP, D3DTOP_SELECTARG1);7.4ä½¿ç”¨DirectXçº¹ç†å·¥å…·åˆ›å»ºAlphaé€šé“ ç»å¤§å¤šæ•°æ™®é€šå›¾è±¡æ–‡ä»¶æ ¼å¼æ²¡æœ‰å­˜å‚¨alphaä¿¡æ¯ã€‚åœ¨è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬ç»™ä½ æ¼”ç¤ºæ€æ ·ä½¿ç”¨DirectXçº¹ç†å·¥å…·æ¥åˆ›å»ºä¸€ä¸ªå¸¦alphaé€šé“çš„DDSæ–‡ä»¶ã€‚DDSæ–‡ä»¶æ˜¯ä¸€ä¸ªä¸ºDirectXåº”ç”¨ç¨‹åºå’Œçº¹ç†è®¾ç½®çš„å›¾è±¡æ ¼å¼ã€‚DDSæ–‡ä»¶èƒ½å¤Ÿåˆ©ç”¨D3DXCreateTextureFromFileè¢«è¯»è¿›çº¹ç†ä¸­ï¼Œå°±è±¡bmpå’Œjpgæ–‡ä»¶ä¸€æ ·ã€‚DirectXçº¹ç†å·¥å…·è¢«æ”¾åœ¨ä½ çš„DXSDKç›®å½•ä¸‹çš„\Bin\DXUtilsæ–‡ä»¶å¤¹ä¸‹ï¼ˆæˆ‘æ˜¯æ”¾åœ¨C:\Program Files\Microsoft DirectX 9.0 SDK (February 2005)\Utilities\Bin\x86ä¸‹çš„ï¼Œæ–‡ä»¶åæ˜¯DxTex.exeï¼‰ã€‚ æ‰“å¼€DirectXçº¹ç†å·¥å…·ï¼Œå¹¶ä¸”æŠŠæœ¬ç« ä¸­ç¤ºä¾‹æ–‡ä»¶å¤¹ä¸‹çš„crate.jpgæ–‡ä»¶ç”¨å·¥å…·æ‰“å¼€ã€‚æœ¨ç®±è¢«è‡ªåŠ¨çš„æŒ‰ç…§24ä½RGBçº¹ç†è¢«è¯»å–ã€‚å®ƒåŒ…å«8ä½çº¢è‰²ï¼Œ8ä½ç»¿è‰²ï¼Œä»¥åŠ8ä½è“è‰²ã€‚æˆ‘ä»¬éœ€è¦å°†è¯¥çº¹ç†å¢åŠ ä¸º32ä½ARGBçº¹ç†ï¼Œå¢åŠ çš„æ˜¯é¢å¤–çš„8ä½alphaé€šé“ã€‚ä»èœå•ä¸­é€‰æ‹©Formatï¼Œé€‰æ‹©Change Surface Formatã€‚ä¸€ä¸ªè±¡å›¾7.5çš„å¯¹è¯æ¡†å°†è¢«å¼¹å‡ºã€‚é€‰æ‹©A8R8G8B8æ ¼å¼ç‚¹å‡»OKã€‚ å›¾7.5 å®ƒåˆ›å»ºäº†ä¸€ä¸ª32ä½é¢œè‰²æ·±åº¦çš„å›¾è±¡ï¼Œå®ƒçš„æ¯ä¸ªè±¡ç´ éƒ½æœ‰8ä½alphaé€šé“ï¼Œ8ä½çº¢è‰²ï¼Œ8ä½ç»¿è‰²ï¼Œ8ä½è“è‰²ã€‚æˆ‘ä»¬ä¸‹ä¸€æ­¥æ˜¯å‘alphaé€šé“ä¸­å†™å…¥æ•°æ®ã€‚æˆ‘ä»¬å°†å›¾7.3ä¸­çš„8ä½ç°è‰²å›¾ç‰‡ä¿¡æ¯å†™è¿›alphaé€šé“ä¸­ã€‚é€‰æ‹©èœå•ä¸­çš„Fileï¼Œé€‰æ‹©Open Onto Alpha Channel Of This Textureã€‚ä¸€ä¸ªå¯¹è¯æ¡†å°†å¼¹å‡ºè®©ä½ é€‰æ‹©åŒ…å«ä½ æƒ³è¦å†™å…¥alphaé€šé“ä¸­æ•°æ®ä¿¡æ¯çš„å›¾ç‰‡ã€‚é€‰æ‹©alphachannel.bmpæ–‡ä»¶ã€‚å›¾7.6æ˜¾ç¤ºçš„æ˜¯ç¨‹åºå·²ç»æ’å…¥äº†alphaé€šé“æ•°æ®ã€‚ å›¾7.6 ç°åœ¨ç”¨ä½ é€‰æ‹©çš„æ–‡ä»¶åå­˜å‚¨çº¹ç†ï¼›æˆ‘ä»¬ä½¿ç”¨cratewalpha.ddsæ–‡ä»¶åã€‚7.5å®ä¾‹ç¨‹åºï¼šé€æ˜åº¦ è¿™ä¸ªå®ä¾‹ç¨‹åºæ˜¯åœ¨ä¸€ä¸ªæœ¨ç®±èƒŒæ™¯ä¸Šç»˜åˆ¶ä¸€ä¸ªé€æ˜çš„èŒ¶å£¶ï¼Œå°±è±¡å›¾7.2æ‰€æ˜¾ç¤ºçš„ä¸€æ ·ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­alphaå€¼æ˜¯ä»æè´¨ä¸­å¾—åˆ°ã€‚åº”ç”¨ç¨‹åºå…è®¸æˆ‘ä»¬é€šè¿‡æŒ‰Aæˆ–Sé”®æ¥å¢åŠ /å‡å°‘alphaçš„å€¼ã€‚ ä½¿ç”¨æ··åˆçš„å¿…è¦æ­¥éª¤æ˜¯ï¼š è®¾ç½®æ··åˆè¦ç´ D3DRS_SRCBLEND å’Œ D3DRS_DESTBLENDã€‚ å‡å¦‚ä½ ä½¿ç”¨alphaéƒ¨åˆ†ï¼ŒæŒ‡å®šèµ„æºï¼ˆæè´¨æˆ–alphaé€šé“ï¼‰ã€‚ å…è®¸alphaæ··åˆæ¸²æŸ“çŠ¶æ€ã€‚ å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å®šä¹‰ä¸‹é¢çš„å…¨å±€å˜é‡ï¼š123456ID3DXMesh* Teapot = 0; // the teapotD3DMATERIAL9 TeapotMtrl; // the teapotâ€™s materialIDirect3DVertexBuffer9* BkGndQuad = 0; // background quad - crateIDirect3DTexture9* BkGndTex = 0; // crate textureD3DMATERIAL9 BkGndMtrl; // background material Setupæ–¹æ³•è®¾ç½®å¾ˆå¤šä¸œè¥¿ï¼›æˆ‘ä»¬çœç•¥äº†å¾ˆå¤šä¸æœ¬ç« æ— å…³çš„ä»£ç ã€‚å…³å¿ƒæ··åˆï¼ŒSetupæ–¹æ³•æŒ‡å®šalphaå€¼çš„è·å–èµ„æºã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æè´¨æŒ‡å®šalphaå€¼ã€‚æ³¨æ„æˆ‘ä»¬è®¾ç½®èŒ¶å£¶çš„æè´¨alphaéƒ¨åˆ†ä¸º0.5ï¼Œä¹Ÿå°±æ˜¯è¯´èŒ¶å£¶å°†æŒ‰ç…§50%çš„é€æ˜åº¦è¢«æ¸²æŸ“ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä¹Ÿè¦è®¾ç½®æ··åˆè¦ç´ ã€‚è¦æ³¨æ„çš„æ˜¯åœ¨è¿™ä¸ªæ–¹æ³•ä¸­æˆ‘ä»¬ä¸èƒ½å°†alphaæ··åˆè®¾ç½®ä¸ºå¯ç”¨ã€‚ç†ç”±æ˜¯alphaæ··åˆè¦è¿›è¡Œé¢å¤–çš„å¤„ç†å¹¶ä¸”åº”è¯¥ä»…åœ¨éœ€è¦ç”¨æ—¶æ‰è¢«ä½¿ç”¨ã€‚ä¸¾ä¾‹ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­åªæœ‰èŒ¶å£¶éœ€è¦ç”¨å…è®¸alphaæ··åˆæ¥è¢«æ¸²æŸ“â€”â€”è€Œæ–¹å—ä¸éœ€è¦ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨Displayå‡½æ•°ä¸­å¯ç”¨alphaæ··åˆã€‚12345678910111213141516171819202122bool Setup()&#123; TeapotMtrl = d3d::RED_MTRL; TeapotMtrl.Diffuse.a = 0.5f; // set alpha to 50% opacity BkGndMtrl = d3d::WHITE_MTRL; D3DXCreateTeapot(Device, &amp;Teapot, 0); ...// Create background quad snipped ...// Light and texture setup snipped // use alpha in material's diffuse component for alpha Device-&gt;SetTextureStageState(0, D3DTSS_ALPHAARG1, D3DTA_DIFFUSE); Device-&gt;SetTextureStageState(0, D3DTSS_ALPHAOP, D3DTOP_SELECTARG1); // set blending factors so that alpha // component determines transparency Device-&gt;SetRenderState(D3DRS_SRCBLEND, D3DBLEND_SRCALPHA); Device-&gt;SetRenderState(D3DRS_DESTBLEND, D3DBLEND_INVSRCALPHA); ...// view/projection matrix setup snipped return true;&#125; åœ¨Displayå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æ£€æµ‹å‡å¦‚Aæˆ–Sé”®è¢«æŒ‰ä¸‹é‚£ä¹ˆå°±é€šè¿‡å¢åŠ æˆ–å‡å°‘æè´¨çš„alphaå€¼æ¥åé¦ˆã€‚æ³¨æ„è¿™ä¸ªæ–¹æ³•è¦ä¿è¯alphaå€¼ä¸ä¼šè¶…å‡º[0,1]çš„èŒƒå›´ã€‚æˆ‘ä»¬ç„¶åæ¸²æŸ“èƒŒæ™¯ã€‚æœ€åï¼Œæˆ‘ä»¬å¯ç”¨alphaæ··åˆï¼Œåˆ©ç”¨alphaæ··åˆæ¥æ¸²æŸ“èŒ¶å£¶ï¼Œå…³é—­alphaæ··åˆã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647bool Display(float timeDelta)&#123; if( Device ) &#123; // // Update // // increase/decrease alpha via keyboard input if( ::GetAsyncKeyState('A') &amp; 0x8000f ) TeapotMtrl.Diffuse.a += 0.01f; if( ::GetAsyncKeyState('S') &amp; 0x8000f ) TeapotMtrl.Diffuse.a -= 0.01f; // force alpha to [0, 1] interval if(TeapotMtrl.Diffuse.a &gt; 1.0f) TeapotMtrl.Diffuse.a = 1.0f; if(TeapotMtrl.Diffuse.a &lt; 0.0f) TeapotMtrl.Diffuse.a = 0.0f; // // Render // Device-&gt;Clear(0, 0, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER, 0xffffffff, 1.0f, 0); Device-&gt;BeginScene(); // Draw the background D3DXMATRIX W; D3DXMatrixIdentity(&amp;W); Device-&gt;SetTransform(D3DTS_WORLD, &amp;W); Device-&gt;SetFVF(Vertex::FVF); Device-&gt;SetStreamSource(0, BkGndQuad, 0, sizeof(Vertex)); Device-&gt;SetMaterial(&amp;BkGndMtrl); Device-&gt;SetTexture(0, BkGndTex); Device-&gt;DrawPrimitive(D3DPT_TRIANGLELIST, 0, 2); // Draw the teapot Device-&gt;SetRenderState(D3DRS_ALPHABLENDENABLE, true); D3DXMatrixScaling(&amp;W, 1.5f, 1.5f, 1.5f); Device-&gt;SetTransform(D3DTS_WORLD, &amp;W); Device-&gt;SetMaterial(&amp;TeapotMtrl); Device-&gt;SetTexture(0, 0); Teapot-&gt;DrawSubset(0); Device-&gt;SetRenderState(D3DRS_ALPHABLENDENABLE, false); Device-&gt;EndScene(); Device-&gt;Present(0, 0, 0, 0); &#125; return true;&#125; æ³¨æ„ï¼šåœ¨æœ¬ç« ä¸­æœ‰å¦ä¸€ä¸ªä½¿ç”¨çº¹ç†é€šé“æ¥æ¼”ç¤ºalphaæ··åˆçš„ä¾‹å­texAlphaã€‚ä¸ä¸Šè¾¹çš„ä»£ç ä¸åŒä¹‹å¤„ä»…ä»…åœ¨äºå¾—åˆ°alphaå€¼æ˜¯ä»çº¹ç†è€Œä¸æ˜¯ä»æè´¨ã€‚123// use alpha channel in texture for alphaDevice-&gt;SetTextureStageState(0, D3DTSS_ALPHAARG1, D3DTA_TEXTURE);Device-&gt;SetTextureStageState(0, D3DTSS_ALPHAOP, D3DTOP_SELECTARG1); è¿™ä¸ªåº”ç”¨ç¨‹åºè¯»å–çš„æ˜¯ä¸€ä¸ªåœ¨7.4èŠ‚ä¸­ç”¨DX Tex Toolå·¥å…·åˆ›å»ºçš„å¸¦æœ‰alphaé€šé“çš„DDSæ–‡ä»¶ã€‚]]></content>
      <categories>
        <category>Direct3D</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬å…­ç«  çº¹ç†(Texturing)]]></title>
    <url>%2F2019%2F04%2F11%2FTexturing%2F</url>
    <content type="text"><![CDATA[Direct3Dä½¿ç”¨ä¸€ä¸ªçº¹ç†åæ ‡ç³»ç»Ÿï¼Œå®ƒæ˜¯ç”±ç”¨æ°´å¹³æ–¹å‘çš„uè½´å’Œç«–ç›´æ–¹å‘vè½´æ„æˆã€‚ç”±u,våæ ‡å†³å®šçº¹ç†ä¸Šçš„å…ƒç´ ï¼Œå®ƒè¢«å«åštexelã€‚æ³¨æ„vè½´æ˜¯å‘ä¸‹çš„ï¼ˆå¦‚å›¾6.2ï¼‰ã€‚ å›¾6.2åŒæ ·ï¼Œæ³¨æ„è§„æ ¼åŒ–çš„åæ ‡é—´éš”ï¼Œ[0ï¼Œ1]ï¼Œå®ƒè¢«ä½¿ç”¨æ˜¯å› ä¸ºå®ƒç»™Direct3Dä¸€ä¸ªå›ºå®šçš„èŒƒå›´ç”¨äºåœ¨ä¸åŒå°ºå¯¸çš„çº¹ç†ä¸Šå·¥ä½œã€‚å¯¹æ¯ä¸€ä¸ª3Dä¸‰è§’å½¢ï¼Œæˆ‘ä»¬éƒ½å¸Œæœ›åœ¨ç»™å®ƒè´´å›¾çš„çº¹ç†ä¸Šå®šä¹‰ä¸€ä¸ªç”¨ç›¸åº”çš„ä¸‰è§’å½¢ã€‚ï¼ˆå¦‚å›¾6.3ï¼‰ã€‚ å›¾6.3 æˆ‘ä»¬å†ä¸€æ¬¡ä¿®æ”¹åŸæ¥çš„é¡¶ç‚¹ç»“æ„ï¼Œæ·»åŠ ä¸€ä¸ªç”¨äºåœ¨çº¹ç†ä¸Šå®šä½çš„çº¹ç†åæ ‡ã€‚struct Vertex{ float _x, _y, _z; float _nx, _ny, _nz; float _u, _v; // texture coordinates static const DWORD FVF;};const DWORD Vertex::FVF = D3DFVF_XYZ | D3DFVF_NORMAL | D3DFVF_TEX1; æˆ‘ä»¬åœ¨é¡¶ç‚¹æ ¼å¼ä¸­æ·»åŠ äº†ä¸€ä¸ªD3DFVF_TEX1ï¼Œå®ƒæ˜¯è¯´æˆ‘ä»¬çš„é¡¶ç‚¹ç»“æ„ä¸­åŒ…å«äº†ä¸€ä¸ªçº¹ç†åæ ‡ã€‚ ç°åœ¨æ¯ä¸ªä¸‰è§’å½¢éƒ½é€šè¿‡é¡¶ç‚¹çš„ä¸‰ä¸ªå¯¹è±¡æ¥å»ºç«‹ï¼ŒåŒæ—¶ä¹Ÿé€šè¿‡çº¹ç†åæ ‡å®šä¹‰äº†ä¸€ä¸ªç›¸åº”çš„çº¹ç†ä¸‰è§’å½¢ã€‚6.2åˆ›å»ºå¹¶èµ‹äºˆæè´¨ çº¹ç†æ•°æ®é€šå¸¸æ˜¯ä»å­˜å‚¨åœ¨ç£ç›˜ä¸­çš„å›¾ç‰‡æ–‡ä»¶ä¸­è¯»å–çš„ï¼Œä¸”è¢«è¯»è¿›IDirect3DTexture9å¯¹è±¡ä¸­ã€‚æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ä¸‹é¢çš„D3DXå‡½æ•°å®Œæˆè¿™é¡¹å·¥ä½œï¼šHRESULT D3DXCreateTextureFromFile( LPDIRECT3DDEVICE9 pDevice, // device to create the texture LPCSTR pSrcFile, // filename of image to load LPDIRECT3DTEXTURE9 ppTexture // ptr to receive the created texture);è¿™ä¸ªå‡½æ•°èƒ½å¤Ÿè¯»å–ä¸‹é¢å›¾ç‰‡æ ¼å¼ä¸­çš„ä»»æ„ä¸€ç§ï¼šBMP,DDS,DIB,JPG,PNG,TGAã€‚ ä¾‹å¦‚ï¼Œç”¨ä¸€ä¸ªåä¸ºstonewall.bmpçš„å›¾ç‰‡åˆ›å»ºä¸€ä¸ªçº¹ç†ï¼Œæˆ‘ä»¬å°†æŒ‰ç…§ä¸‹é¢çš„ä¾‹å­æ¥å†™ï¼šIDirect3Dtexture9 _stonewall;D3DXCreateTextureFromFile(_device, â€œstonewall.bmpâ€, &amp;_stonewall); è®¾ç½®å½“å‰çº¹ç†ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼šHRESULT IDirect3DDevice9::SetTexture( DWORD Stage, // A value in the range 0-7 identifying the texture // stage â€“ see note on Texture Stages IDirect3DBaseTexture9* pTexture // ptr to the texture to set); ä¾‹å­ï¼šDevice-&gt;SetTexture(0, _stonewall);æ³¨æ„ï¼šåœ¨Direct3Dä¸­ï¼Œä½ èƒ½å¤Ÿè®¾ç½®å…«ä¸ªçº¹ç†ï¼Œå®ƒä»¬èƒ½å¤Ÿç»„åˆèµ·æ¥åˆ›å»ºæ›´å¤šç»†èŠ‚çš„å›¾è±¡ã€‚è¿™åˆè¢«å«åšå¤šé‡çº¹ç†ã€‚åœ¨æœ¬ä¹¦çš„ç¬¬å››éƒ¨åˆ†ä»¥å‰æˆ‘ä»¬ä¸ä¼šä½¿ç”¨å¤šé‡çº¹ç†ï¼›å› æ­¤ç°åœ¨æˆ‘ä»¬æ€»æ˜¯è®¾ç½®stageä¸º0ã€‚ ä¸ºäº†é”€æ¯ä¸€ä¸ªçº¹ç†ï¼Œæˆ‘ä»¬è®¾ç½®pTextureä¸º0ã€‚ä¾‹å¦‚ï¼Œå‡å¦‚ä¸æƒ³ç”¨ä¸€ä¸ªçº¹ç†æ¥æ¸²æŸ“ç‰©ä½“ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¿™æ ·å†™ï¼šDevice-&gt;SetTexture(0, 0);renderObjectWithoutTexture();å‡å¦‚åœºæ™¯ä¸­æœ‰ä½¿ç”¨ä¸åŒçº¹ç†çš„ä¸‰è§’å½¢ï¼Œæˆ‘ä»¬å°±å¿…é¡»æ·»åŠ ä¸ä¸‹é¢ç±»ä¼¼çš„ä¸€äº›ä»£ç ï¼šDevice-&gt;SetTexture(0, _tex0);drawTrisUsingTex0(); Device-&gt;SetTexture(0, _tex1);drawTrisUsingTex1();6.3è¿‡æ»¤å™¨ å°±è±¡ä»¥å‰æåŠçš„ï¼Œçº¹ç†è¢«æ˜ å°„åˆ°å±å¹•ä¸­çš„ä¸‰è§’å½¢ä¸Šã€‚é€šå¸¸çº¹ç†ä¸‰è§’å½¢å’Œå±å¹•ä¸‰è§’å½¢æ˜¯ä¸ä¸€æ ·å¤§çš„ã€‚å½“çº¹ç†ä¸‰è§’å½¢æ¯”å±å¹•ä¸‰è§’å½¢å°æ—¶ï¼Œçº¹ç†ä¸‰è§’å½¢ä¼šè¢«é€‚å½“æ”¾å¤§ã€‚å½“çº¹ç†ä¸‰è§’å½¢æ¯”å±å¹•ä¸‰è§’å½¢å¤§æ—¶ï¼Œçº¹ç†ä¸‰è§’å½¢ä¼šè¢«é€‚å½“ç¼©å°ã€‚è¿™ä¸¤ç§æƒ…å†µï¼Œå˜å½¢éƒ½å°†ä¼šå‡ºç°ã€‚è¿‡æ»¤ï¼ˆFilteringï¼‰æ˜¯ä¸€ç§Direct3Dç”¨å®ƒæ¥å¸®åŠ©è¿™äº›å˜å½¢å˜çš„å¹³æ»‘çš„æŠ€æœ¯ã€‚ Direct3Dæä¾›äº†ä¸‰ç§ä¸åŒçš„è¿‡æ»¤å™¨ï¼›æ¯ç§éƒ½æä¾›äº†ä¸€ä¸ªä¸åŒçš„å“è´¨çº§åˆ«ã€‚è¶Šå¥½çš„å“è´¨è¶Šæ…¢ï¼Œå› æ­¤ä½ å¿…é¡»åœ¨å“è´¨ä¸é€Ÿåº¦ä¹‹é—´å–å¾—ä¸€ä¸ªå¹³è¡¡ã€‚çº¹ç†è¿‡æ»¤å™¨æ˜¯ç”¨IDirect3DDevice9::SetSamplerStateæ–¹æ³•æ¥è®¾ç½®çš„ã€‚ Nearest point samplingâ€”â€”è¿™æ˜¯é»˜è®¤çš„è¿‡æ»¤æ–¹æ³•ä¸”è¿”å›æœ€å·®çš„æ•ˆæœï¼Œä½†æ˜¯å®ƒçš„è®¡ç®—æ˜¯æœ€å¿«çš„ã€‚ä¸‹é¢çš„ä»£ç å°±æ˜¯è®¾ç½®Nearest point samplingä½œä¸ºç¼©å°æ”¾å¤§çš„è¿‡æ»¤å™¨ï¼šDevice-&gt;SetSamplerState(0, D3DSAMP_MAGFILTER, D3DTEXF_POINT);Device-&gt;SetSamplerState(0, D3DSAMP_MINFILTER, D3DTEXF_POINT); Linear filteringâ€”â€”è¿™ç§è¿‡æ»¤äº§ç”Ÿè¿˜ç®—æ¯”è¾ƒå¥½çš„æ•ˆæœï¼Œåœ¨ä»Šå¤©çš„ç¡¬ä»¶ä¸Šå¤„ç†å®ƒè¿˜æ˜¯éå¸¸å¿«çš„ã€‚å®ƒæ˜¯è¢«æ¨èä½¿ç”¨çš„ã€‚ä¸‹é¢çš„ä»£ç å°±æ˜¯è®¾ç½®Linear filteringä½œä¸ºç¼©å°æ”¾å¤§çš„è¿‡æ»¤å™¨ã€‚Device-&gt;SetSamplerState(0, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR);Device-&gt;SetSamplerState(0, D3DSAMP_MINFILTER, D3DTEXF_LINEAR); Anisotropic filteringâ€”â€”è¿™ç§è¿‡æ»¤äº§ç”Ÿæœ€å¥½çš„æ•ˆæœï¼Œä½†æ˜¯å¤„ç†æ—¶é—´ä¹Ÿæ˜¯æœ€é•¿çš„ã€‚ä¸‹é¢çš„ä»£ç å°±æ˜¯è®¾ç½®Anisotropic filteringä½œä¸ºç¼©å°æ”¾å¤§çš„è¿‡æ»¤å™¨ã€‚Device-&gt;SetSamplerState(0, D3DSAMP_MAGFILTER, D3DTEXF_ANISOTROPIC);Device-&gt;SetSamplerState(0, D3DSAMP_MINFILTER, D3DTEXF_ANISOTROPIC);å½“ä½¿ç”¨Anisotropic filteringæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»è®¾ç½®D3DSAMP_MAXANISOTROPYç­‰çº§ï¼Œå®ƒå†³å®šå¤„ç†çš„è´¨é‡ã€‚è¯¥å€¼è¶Šé«˜å¤„ç†çš„æ•ˆæœè¶Šå¥½ã€‚æ£€æŸ¥D3DCAPS9ç»“æ„ç¡®è®¤ä½ çš„æ˜¾å¡æ˜¯å¦æ”¯æŒæ­¤åŠŸèƒ½ã€‚ä¸‹é¢çš„ä»£ç è®¾ç½®è¯¥å€¼ä¸º4ï¼šDevice-&gt;SetSamplerState(0, D3DSAMP_MAXANISOTROPY, 4);6.4 Mipmaps å°±è±¡6.3èŠ‚æ‰€è¯´çš„ï¼Œåœ¨å±å¹•ä¸Šçš„ä¸‰è§’å½¢å’Œçº¹ç†ä¸‰è§’å½¢é€šå¸¸æ˜¯ä¸ä¸€æ ·å¤§çš„ã€‚ä¸ºäº†ä½¿è¿™ä¸ªå¤§å°å·®å¼‚å˜å°ï¼Œæˆ‘ä»¬ä¸ºçº¹ç†åˆ›å»ºmipmapsé“¾ã€‚ä¹Ÿå°±æ˜¯è¯´å°†ä¸€ä¸ªçº¹ç†åˆ›å»ºæˆè¿ç»­çš„å˜å°çš„çº¹ç†ï¼Œä½†æ˜¯å¯¹å®ƒä»¬ç­‰çº§è¿›è¡Œå®šåˆ¶è¿‡æ»¤ï¼Œå› æ­¤å¯¹æˆ‘ä»¬æ¥è¯´ä¿å­˜ç»†èŠ‚æ˜¯å¾ˆé‡è¦çš„ï¼ˆå¦‚å›¾6.4ï¼‰ã€‚ å›¾6.46.4.1 Mipmapsè¿‡æ»¤å™¨ mipmapè¿‡æ»¤å™¨æ˜¯è¢«ç”¨æ¥æ§åˆ¶Direct3Dä½¿ç”¨mipmapsçš„ã€‚è®¾ç½®mipmapè¿‡æ»¤å™¨ï¼Œä½ å¯ä»¥è¿™æ ·å†™ï¼šDevice-&gt;SetSamplerState(0, D3DSAMP_MIPFILTER, Filter);åœ¨Filterå¤„ä½ èƒ½ç”¨ä¸‹é¢ä¸‰ä¸ªé€‰é¡¹ä¸­çš„ä¸€ä¸ªï¼š D3DTEXF_NONEâ€”â€”ä¸ä½¿ç”¨mipmapã€‚ D3DTEXF_POINTâ€”â€”é€šè¿‡ä½¿ç”¨è¿™ä¸ªè¿‡æ»¤å™¨ï¼ŒDirect3Då°†é€‰æ‹©ä¸å±å¹•ä¸‰è§’å½¢å¤§å°æœ€æ¥è¿‘çš„mipmapç­‰çº§ã€‚ä¸€æ—¦ç­‰çº§é€‰å®šäº†ï¼ŒDirect3Då°±å°†æŒ‰ç…§æŒ‡å®šçš„è¿‡æ»¤å™¨è¿›è¡Œç¼©å°å’Œæ”¾å¤§è¿‡æ»¤ã€‚ D3DTEXF_LINEARâ€”â€”é€šè¿‡ä½¿ç”¨è¿™ä¸ªè¿‡æ»¤å™¨ï¼ŒDirect3Då°†é€‰æ‹©ä¸¤ä¸ªæœ€æ¥è¿‘çš„mipmapç­‰çº§ï¼Œç¼©å°å’Œæ”¾å¤§è¿‡æ»¤æ¯ä¸ªç­‰çº§ï¼Œç„¶åçº¿æ€§è”åˆè®¡ç®—å®ƒä»¬ä¸¤ä¸ªç­‰çº§æ¥å¾—åˆ°æœ€ç»ˆçš„é¢œè‰²å€¼ã€‚6.4.2 Direct3Dä¸­ä½¿ç”¨Mipmaps åœ¨Direct3Dä¸­ä½¿ç”¨Mipmapsæ˜¯å¾ˆç®€å•çš„ã€‚å‡å¦‚ä½ çš„æ˜¾å¡æ”¯æŒMipmapsï¼Œé‚£ä¹ˆä½¿ç”¨D3DXCreateTextureFromFileå°†ä¸ºä½ äº§ç”Ÿä¸€ä¸ªMipmapé“¾ã€‚Direct3Dè‡ªåŠ¨é€‰æ‹©ä¸å±å¹•ä¸‰è§’å½¢æœ€åŒ¹é…çš„Mipmapã€‚å› æ­¤Mipmapæœ‰éå¸¸å¹¿æ³›çš„åº”ç”¨ï¼Œä¸”å®ƒèƒ½è¢«è‡ªåŠ¨è®¾ç½®ã€‚6.5 å¯»å€æ¨¡å¼ ä»¥å‰ï¼Œæˆ‘ä»¬è§„å®šçº¹ç†åæ ‡å¿…é¡»æŒ‡å®šåœ¨[0ï¼Œ1]ä¹‹é—´ã€‚ä»æŠ€æœ¯ä¸Šæ¥è¯´è¿™æ˜¯ä¸æ­£ç¡®çš„ï¼›ä»–ä»¬èƒ½å¤Ÿè¶…å‡ºè¿™ä¸ªèŒƒå›´ã€‚çº¹ç†åæ ‡ä¹Ÿå¯ä»¥åœ¨[0ï¼Œ1]çš„èŒƒå›´ä¹‹å¤–ï¼Œå®ƒé€šè¿‡Direct3Dçš„å¯»å€æ¨¡å¼æ¥å®šä¹‰ã€‚è¿™é‡Œæœ‰å››ç§å¯»å€æ¨¡å¼ï¼šç¯ç»•çº¹ç†å¯»å€æ¨¡å¼ã€è¾¹æ¡†é¢œè‰²çº¹ç†å¯»å€æ¨¡å¼ã€æˆªå–çº¹ç†å¯»å€æ¨¡å¼ã€é•œåƒçº¹ç†å¯»å€æ¨¡å¼ï¼Œè¿™é‡Œåˆ†åˆ«ç»™å‡ºäº†å®ƒä»¬çš„ç¤ºæ„å›¾6.5ï¼Œ6.6ï¼Œ6.7ï¼Œ6.8ã€‚ å›¾6.5ï¼ˆç¯ç»•ï¼‰ å›¾6.6ï¼ˆè¾¹æ¡†ï¼‰ å›¾6.7ï¼ˆæˆªå–ï¼‰ å›¾6.8ï¼ˆé•œåƒï¼‰åœ¨è¿™äº›å›¾ç‰‡ä¸­ï¼Œçº¹ç†åæ ‡é€šè¿‡ï¼ˆ0,0ï¼‰ï¼ˆ0,3ï¼‰ï¼ˆ3,0ï¼‰ï¼ˆ3,3ï¼‰é¡¶ç‚¹æ¥å®šä¹‰ã€‚åœ¨uè½´å’Œvè½´ä¸Šæ–¹å—åˆè¢«åˆ†æˆå­å—æ”¾è¿›3Ã—3çš„çŸ©é˜µä¸­ã€‚å‡å¦‚ï¼Œä½ æƒ³è®©çº¹ç†æŒ‰5Ã—5çš„æ–¹æ ¼æ¥å¹³é“ºï¼Œä½ å°±åº”è¯¥æŒ‡å®šç¯ç»•çº¹ç†å¯»å€æ¨¡å¼å¹¶ä¸”çº¹ç†åæ ‡å› è¯¥è®¾ç½®ä¸ºï¼ˆ0,0ï¼‰ï¼ˆ0,5ï¼‰ï¼ˆ5,0ï¼‰ï¼ˆ5,5ï¼‰ã€‚ ä¸‹é¢çš„ä»£ç ç‰‡æ®µåˆ—ä¸¾çš„æ˜¯æ€æ ·è®¾ç½®è¿™å››ç§å¯»å€æ¨¡å¼ï¼š// set wrap address modeif( ::GetAsyncKeyState(â€˜Wâ€™) &amp; 0x8000f ){ Device-&gt;SetSamplerState(0, D3DSAMP_ADDRESSU, D3DTADDRESS_WRAP); Device-&gt;SetSamplerState(0, D3DSAMP_ADDRESSV, D3DTADDRESS_WRAP);}// set border color address modeif( ::GetAsyncKeyState(â€˜Bâ€™) &amp; 0x8000f ){ Device-&gt;SetSamplerState(0, D3DSAMP_ADDRESSU, D3DTADDRESS_BORDER); Device-&gt;SetSamplerState(0, D3DSAMP_ADDRESSV, D3DTADDRESS_BORDER); Device-&gt;SetSamplerState(0, D3DSAMP_BORDERCOLOR, 0x000000ff);}// set clamp address modeif( ::GetAsyncKeyState(â€˜Câ€™) &amp; 0x8000f ){ Device-&gt;SetSamplerState(0, D3DSAMP_ADDRESSU, D3DTADDRESS_CLAMP); Device-&gt;SetSamplerState(0, D3DSAMP_ADDRESSV, D3DTADDRESS_CLAMP);}// set mirror address modeif( ::GetAsyncKeyState(â€˜Mâ€™) &amp; 0x8000f ){ Device-&gt;SetSamplerState(0, D3DSAMP_ADDRESSU, D3DTADDRESS_MIRROR); Device-&gt;SetSamplerState(0, D3DSAMP_ADDRESSV, D3DTADDRESS_MIRROR);}6.6å®ä¾‹ç¨‹åºï¼šæœ‰çº¹ç†çš„æ–¹å— è¿™ä¸ªä¾‹å­æ˜¯æ€æ ·ä¸ºæ–¹å—åŠ ä¸Šçº¹ç†ä»¥åŠè®¾ç½®ä¸€ä¸ªçº¹ç†è¿‡æ»¤å™¨ï¼ˆå¦‚å›¾6.9ï¼‰ã€‚å‡å¦‚ä½ çš„æ˜¾å¡æ”¯æŒï¼Œé€šè¿‡D3DXCreateTextureFromFileå‡½æ•°ä¸€ä¸ªmipmapé“¾å°†è¢«è‡ªåŠ¨åˆ›å»ºã€‚ å›¾6.9æ³¨æ„ï¼šè¿˜æä¾›äº†å…¶ä»–ä¸¤ä¸ªä¾‹å­å¤§å®¶å°±è‡ªå·±çœ‹çœ‹äº†ã€‚ä¸ºä¸€ä¸ªåœºæ™¯å¢åŠ çº¹ç†çš„å¿…è¦æ­¥éª¤æ˜¯ï¼š ç”¨çº¹ç†åæ ‡æŒ‡å®šçš„ï¼Œåˆ›å»ºç‰©ä½“çš„é¡¶ç‚¹ã€‚ ç”¨D3DXCreateTextureFromFileå‡½æ•°è¯»å–ä¸€ä¸ªçº¹ç†åˆ°IDirect3DTexture9æ¥å£ä¸­ã€‚ è®¾ç½®ç¼©å°å€æ•°ï¼Œæ”¾å¤§å€æ•°ä»¥åŠmipmapè¿‡æ»¤å™¨ã€‚ åœ¨ä½ ç»˜åˆ¶ä¸€ä¸ªç‰©ä½“å‰ï¼Œç”¨IDirect3DDevice9::SetTextureè®¾ç½®ä¸ç‰©ä½“å…³è”çš„çº¹ç†ã€‚æˆ‘ä»¬å…ˆå®šä¹‰å‡ ä¸ªå…¨å±€å˜é‡ï¼›ä¸€ä¸ªæ˜¯é¡¶ç‚¹ç¼“å­˜ï¼Œå®ƒå­˜å‚¨æ–¹å—çš„é¡¶ç‚¹ã€‚å¦å¤–ä¸€ä¸ªæ˜¯æˆ‘ä»¬ä¸ºæ–¹å—æ˜ å°„çš„çº¹ç†ï¼šIDirect3DVertexBuffer9 Quad = 0;IDirect3DTexture9 Tex = 0;Setupç¨‹åºæ˜¯å¾ˆå®¹æ˜“è¯»æ‡‚çš„ï¼›æˆ‘ä»¬ç”¨å·²ç»å®šä¹‰äº†çº¹ç†åæ ‡çš„ä¸¤ä¸ªä¸‰è§’å½¢åˆ›å»ºä¸€ä¸ªæ–¹å—ã€‚ç„¶åæŠŠæ–‡ä»¶dx5_logo.bmpè¯»è¿›IDirect3DTexture9æ¥å£ä¸­ã€‚æ¥ç€ä½¿ç”¨SetTextureæ–¹æ³•èµ‹äºˆçº¹ç†ã€‚æœ€åè®¾ç½®ç¼©å°å’Œæ”¾å¤§è¿‡æ»¤å™¨è¿›è¡Œçº¿æ€§è¿‡æ»¤ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è®¾ç½®mipmapè¿‡æ»¤å™¨æ¥è¿›è¡ŒD3DTEXF_POINT: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364bool Setup()&#123; // // Create the quad vertex buffer and fill it with the // quad geoemtry. // Device-&gt;CreateVertexBuffer( 6 * sizeof(Vertex), D3DUSAGE_WRITEONLY, Vertex::FVF, D3DPOOL_MANAGED, &amp;Quad, 0); Vertex* v; Quad-&gt;Lock(0, 0, (void**)&amp;v, 0); // quad built from two triangles, note texture coordinates: v[0] = Vertex(-1.0f, -1.0f, 1.25f, 0.0f, 0.0f, -1.0f, 0.0f, 1.0f); v[1] = Vertex(-1.0f, 1.0f, 1.25f, 0.0f, 0.0f, -1.0f, 0.0f, 0.0f); v[2] = Vertex( 1.0f, 1.0f, 1.25f, 0.0f, 0.0f, -1.0f, 1.0f, 0.0f); v[3] = Vertex(-1.0f, -1.0f, 1.25f, 0.0f, 0.0f, -1.0f, 0.0f, 1.0f); v[4] = Vertex( 1.0f, 1.0f, 1.25f, 0.0f, 0.0f, -1.0f, 1.0f, 0.0f); v[5] = Vertex( 1.0f, -1.0f, 1.25f, 0.0f, 0.0f, -1.0f, 1.0f, 1.0f); Quad-&gt;Unlock(); // // Create the texture and set filters. // D3DXCreateTextureFromFile( Device, "dx5_logo.bmp", &amp;Tex); Device-&gt;SetTexture(0, Tex); Device-&gt;SetSamplerState(0, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR); Device-&gt;SetSamplerState(0, D3DSAMP_MINFILTER, D3DTEXF_LINEAR); Device-&gt;SetSamplerState(0, D3DSAMP_MIPFILTER, D3DTEXF_POINT); // // Don't use lighting for this sample. // Device-&gt;SetRenderState(D3DRS_LIGHTING, false); // // Set the projection matrix. // D3DXMATRIX proj; D3DXMatrixPerspectiveFovLH( &amp;proj, D3DX_PI * 0.5f, // 90 - degree (float)Width / (float)Height, 1.0f, 1000.0f); Device-&gt;SetTransform(D3DTS_PROJECTION, &amp;proj); return true;&#125; æˆ‘ä»¬ç°åœ¨å¯ä»¥æ¸²æŸ“æ–¹å—äº†ï¼Œä¸”é€šå¸¸å·²ç»ä¸ºå®ƒèµ‹äºˆäº†çº¹ç†ï¼š12345678910111213141516bool Display(float timeDelta)&#123; if( Device ) &#123; Device-&gt;Clear(0, 0, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER, 0xffffffff, 1.0f, 0); Device-&gt;BeginScene(); Device-&gt;SetStreamSource(0, Quad, 0, sizeof(Vertex)); Device-&gt;SetFVF(Vertex::FVF); Device-&gt;DrawPrimitive(D3DPT_TRIANGLELIST, 0, 2); Device-&gt;EndScene(); Device-&gt;Present(0, 0, 0, 0); &#125; return true;&#125;]]></content>
      <categories>
        <category>Direct3D</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬äº”ç«  ç¯å…‰(Lighting)]]></title>
    <url>%2F2019%2F04%2F11%2FLighting%2F</url>
    <content type="text"><![CDATA[ç¯å…‰çš„ç»„æˆåœ¨Direct3Dç¯å…‰æ¨¡å‹ä¸­ï¼Œç¯å…‰æ˜¯é€šè¿‡ç¯å…‰èµ„æºçš„ä¸‰ä¸ªæˆå‘˜ä¹‹ä¸€æ¥ç…§å°„çš„ï¼Œå³æœ‰ä¸‰ç§ç¯å…‰ã€‚ ç¯å¢ƒå…‰ï¼ˆAmbient Lightï¼‰â€”â€”è¿™ç§ç±»å‹çš„ç¯å…‰å°†è¢«å…¶ä»–æ‰€æœ‰è¡¨é¢åå°„ä¸”è¢«ç”¨åœ¨ç…§äº®æ•´ä¸ªåœºæ™¯ã€‚ä¾‹å¦‚ï¼Œç‰©ä½“çš„å„éƒ¨åˆ†éƒ½è¢«ç…§äº®ï¼Œå¯¹äºä¸€ä¸ªè§’åº¦ï¼Œç”šè‡³ç©¿è¿‡ä¸åœ¨å…‰æºç›´æ¥ç…§å°„çš„åœ°æ–¹ä»–ä»¬éƒ½èƒ½è¢«ç…§äº®ã€‚ç¯å¢ƒå…‰çš„ä½¿ç”¨æ˜¯ç²—ç•¥çš„ï¼Œä¾¿å®œçš„ï¼Œå®ƒæ¨¡ä»¿åå°„å…‰ã€‚ æ¼«åå°„ï¼ˆDiffuse Reflectionï¼‰â€”â€”è¿™ç§ç¯å…‰æŒ‰ç…§ç‰¹æ®Šæ–¹å‘ä¼ æ’­ã€‚å½“å®ƒç…§å°„åˆ°ä¸€ä¸ªè¡¨é¢ï¼Œå®ƒå°†åœ¨æ‰€æœ‰æ–¹å‘ä¸Šå‡åŒ€çš„åå°„ã€‚å› ä¸ºæ¼«å°„å…‰åœ¨æ‰€æœ‰æ–¹å‘ä¸Šéƒ½å‡åŒ€çš„åå°„ï¼Œè¢«åå°„çš„å…‰çº¿å°†åˆ°è¾¾çœ¼ç›è€Œä¸è§‚å¯Ÿç‚¹æ— å…³ï¼Œå› æ­¤æˆ‘ä»¬ä¸å¿…ä¸ºè§‚å¯Ÿè€…è€ƒè™‘ã€‚å› è€Œï¼Œæ¼«å°„å…‰ä»…ä»…éœ€è¦è€ƒè™‘ç¯å…‰æ–¹å‘å’Œè¡¨é¢çš„å§¿æ€ã€‚è¿™ç§ç¯å…‰å°†æˆä¸ºä½ çš„èµ„æºä¸­ç…§å°„çš„æ™®é€šç¯å…‰ã€‚ é•œé¢åå°„ï¼ˆSpecular Reflectionï¼‰â€”â€”è¿™ç§ç¯å…‰æŒ‰ç…§ç‰¹æ®Šæ–¹å‘ä¼ æ’­ã€‚å½“å®ƒç…§å°„åˆ°ä¸€ä¸ªè¡¨é¢æ—¶ï¼Œå®ƒä¸¥æ ¼åœ°æŒ‰ç…§ä¸€ä¸ªæ–¹å‘åå°„ã€‚è¿™å°†äº§ç”Ÿä¸€ä¸ªæ˜äº®çš„å…‰æ³½ï¼Œå®ƒèƒ½åœ¨æŸè§’åº¦è¢«çœ‹è§ã€‚å› ä¸ºè¿™ç§ç¯å…‰åœ¨ä¸€ä¸ªæ–¹å‘åå°„ã€‚æ˜æ˜¾çš„è§‚å¯Ÿç‚¹ï¼Œå¿…é¡»è€ƒè™‘ç¯å…‰çš„æ–¹å‘å’Œè¡¨é¢å§¿æ€ï¼Œä¸”å¿…é¡»æŒ‰ç…§é•œé¢ç¯å…‰ç­‰å¼æ¥è€ƒè™‘ã€‚é•œé¢ç¯å…‰è¢«ç”¨åœ¨ç‰©ä½“ä¸Šäº§ç”Ÿé«˜å…‰çš„åœ°æ–¹ï¼Œè¿™ç§å…‰æ³½åªæœ‰åœ¨ç¯å…‰ç…§å°„åœ¨ç£¨å…‰çš„è¡¨é¢ä¸Šæ‰ä¼šäº§ç”Ÿã€‚ é•œé¢å…‰æ¯”å…¶ä»–ç¯å…‰ç±»å‹è¦æ±‚æ›´å¤šçš„è®¡ç®—ï¼›å› æ­¤ï¼ŒDirect3Dæä¾›äº†ä¸€ä¸ªå¼€å…³é€‰æ‹©ã€‚å®é™…ä¸Šï¼Œå®ƒé»˜è®¤æ˜¯è¢«å…³é—­çš„ï¼›è¦ä½¿ç”¨é•œé¢å…‰ä½ å¿…é¡»è®¾ç½®D3DRS_SPECULARENABLEæ¸²æŸ“çŠ¶æ€ã€‚1Device-&gt;SetRenderState(D3DRS_SPECULARENABLE, true); æ¯ä¸€ç§ç¯å…‰éƒ½æ˜¯é€šè¿‡D3DCOLORVALUEç»“æ„æˆ–è€…æè¿°ç¯å…‰é¢œè‰²çš„D3DXCOLORæ¥æç»˜çš„ã€‚è¿™é‡Œæœ‰å‡ ä¸ªç¯å…‰é¢œè‰²çš„ä¾‹å­ï¼š123D3DXCOLOR redAmbient(1.0f, 0.0f, 0.0f, 1.0f);D3DXCOLOR blueDiffuse(0.0f, 0.0f, 1.0f, 1.0f);D3DXCOLOR whiteSpecular(1.0f, 1.0f, 1.0f, 1.0f); æ³¨æ„ï¼šåœ¨D3DXCOLORç±»ä¸­çš„alphaå€¼ç”¨åœ¨æè¿°ç¯å…‰é¢œè‰²æ—¶æ˜¯è¢«å¿½ç•¥çš„ã€‚ æè´¨åœ¨ç°å®ä¸–ç•Œä¸­æˆ‘ä»¬çœ‹åˆ°çš„ç‰©ä½“é¢œè‰²å°†ç”±ç‰©ä½“åå°„å›æ¥çš„ç¯å…‰é¢œè‰²æ¥å†³å®šã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªçº¢è‰²çš„çƒæ˜¯çº¢è‰²çš„ï¼Œå› ä¸ºå®ƒå¸æ”¶æ‰€æœ‰çš„ç¯å…‰é¢œè‰²é™¤äº†çº¢è‰²å…‰ã€‚çº¢è‰²å…‰æ˜¯è¢«çƒåå°„å›æ¥è¿›å…¥æˆ‘ä»¬çœ¼ç›çš„ï¼Œå› æ­¤æˆ‘ä»¬çœ‹åˆ°çš„çƒæ˜¯çº¢è‰²çš„ã€‚Direct3Dé€šè¿‡æˆ‘ä»¬å®šä¹‰çš„ç‰©ä½“æè´¨æ¥æ¨¡æ‹Ÿè¿™äº›æ‰€æœ‰çš„ç°è±¡ã€‚æè´¨å…è®¸æˆ‘ä»¬å®šä¹‰è¡¨é¢åå°„ç¯å…‰çš„ç™¾åˆ†æ¯”ã€‚åœ¨ä»£ç ä¸­é€šè¿‡D3DMATERIAL9ç»“æ„æè¿°ä¸€ä¸ªæè´¨ã€‚1234typedef struct _D3DMATERIAL9 &#123; D3DCOLORVALUE Diffuse, Ambient, Specular, Emissive; float Power;&#125; D3DMATERIAL9; Diffuseâ€”â€”æŒ‡å®šæ­¤è¡¨é¢åå°„çš„æ¼«å°„å…‰æ•°é‡ã€‚ Ambientâ€”â€”æŒ‡å®šæ­¤è¡¨é¢åå°„çš„ç¯å¢ƒå…‰æ•°é‡ã€‚ Specularâ€”â€”æŒ‡å®šæ­¤è¡¨é¢åå°„çš„é•œé¢å…‰æ•°é‡ Emissiveâ€”â€”è¿™ä¸ªæ˜¯è¢«ç”¨æ¥ç»™è¡¨é¢æ·»åŠ é¢œè‰²ï¼Œå®ƒä½¿å¾—ç‰©ä½“çœ‹èµ·æ¥å°±è±¡æ˜¯å®ƒè‡ªå·±å‘å‡ºçš„å…‰ä¸€æ ·ã€‚ Powerâ€”â€”æŒ‡å®šé”åˆ©çš„é•œé¢é«˜å…‰ï¼›å®ƒçš„å€¼æ˜¯é«˜å…‰çš„é”åˆ©å€¼ã€‚ ä¸¾ä¾‹ï¼Œæƒ³å¾—åˆ°ä¸€ä¸ªçº¢è‰²çš„çƒã€‚æˆ‘ä»¬å°†å®šä¹‰çƒçš„æè´¨æ¥åªåå°„çº¢å…‰å¸æ”¶å…¶ä»–é¢œè‰²çš„æ‰€æœ‰å…‰ï¼š1234567D3DMATERIAL9 red;::ZeroMemory(&amp;red, sizeof(red));red.Diffuse = D3DXCOLOR(1.0f, 0.0f, 0.0f, 1.0f); // redred.Ambient = D3DXCOLOR(1.0f, 0.0f, 0.0f, 1.0f); // redred.Specular = D3DXCOLOR(1.0f, 0.0f, 0.0f, 1.0f); // redred.Emissive = D3DXCOLOR(0.0f, 0.0f, 0.0f, 1.0f); // no emissionred.Power = 5.0f; è¿™é‡Œæˆ‘ä»¬è®¾ç½®ç»¿è‰²å’Œè“è‰²çš„å€¼ä¸º0ï¼Œè¿™è¡¨æ˜æè´¨åå°„0%æ­¤é¢œè‰²çš„å…‰ã€‚æˆ‘ä»¬è®¾ç½®çº¢è‰²ä¸º1ï¼Œè¡¨ç¤ºæè´¨åå°„100%çš„çº¢å…‰ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶æ¯ç§ç¯å…‰åå°„çš„é¢œè‰²ï¼ˆç¯å¢ƒã€æ¼«å°„å’Œé•œé¢å…‰ï¼‰ã€‚ åŒæ ·å‡å¦‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåªå‘å‡ºè“è‰²å…‰çš„å…‰æºï¼Œå¯¹çƒçš„å…‰ç…§å°†å¤±è´¥å› ä¸ºè“è‰²å…‰å°†è¢«å…¨éƒ¨å¸æ”¶è€Œæ²¡æœ‰çº¢å…‰è¢«åå°„ã€‚å½“ç‰©ä½“å¸æ”¶äº†æ‰€æœ‰å…‰ä»¥åï¼Œç‰©ä½“çœ‹èµ·æ¥å°±ä¸ºé»‘è‰²ã€‚åŒæ ·çš„ï¼Œå½“ç‰©ä½“åå°„100%çš„çº¢ã€ç»¿å’Œè“å…‰ï¼Œç‰©ä½“å°±å°†å‘ˆç°ä¸ºç™½è‰²ã€‚ å› ä¸ºæ‰‹å·¥å¡«å……ä¸€ä¸ªæè´¨ç»“æ„å°†æ˜¯ä¹å‘³çš„å·¥ä½œï¼Œæˆ‘ä»¬æ·»åŠ ä¸‹åˆ—æœ‰ç”¨çš„å‡½æ•°å’Œå…¨å±€æè´¨å¸¸æ•°åˆ°d3dUtility.h/cppæ–‡ä»¶ä¸­ï¼š12345678910111213141516171819202122232425D3DMATERIAL9 d3d::InitMtrl(D3DXCOLOR a, D3DXCOLOR d,D3DXCOLOR s, D3DXCOLOR e, float p)&#123; D3DMATERIAL9 mtrl; mtrl.Ambient = a; mtrl.Diffuse = d; mtrl.Specular = s; mtrl.Emissive = e; mtrl.Power = p; return mtrl;&#125;namespace d3d&#123; D3DMATERIAL9 InitMtrl(D3DXCOLOR a, D3DXCOLOR d, D3DXCOLOR s, D3DXCOLOR e, float p); const D3DMATERIAL9 WHITE_MTRL = InitMtrl(WHITE, WHITE, WHITE, BLACK, 8.0f); const D3DMATERIAL9 RED_MTRL = InitMtrl(RED, RED, RED, BLACK, 8.0f); const D3DMATERIAL9 GREEN_MTRL = InitMtrl(GREEN, GREEN, GREEN, BLACK, 8.0f); const D3DMATERIAL9 BLUE_MTRL = InitMtrl(BLUE, BLUE, BLUE, BLACK, 8.0f); const D3DMATERIAL9 YELLOW_MTRL = InitMtrl(YELLOW, YELLOW, YELLOW, BLACK, 8.0f);&#125; é¡¶ç‚¹ç»“æ„æ²¡æœ‰æè´¨å±æ€§ï¼›ä¸€ä¸ªé€šç”¨çš„æè´¨å¿…é¡»è¢«è®¾ç½®ã€‚è®¾ç½®å®ƒæˆ‘ä»¬ä½¿ç”¨IDirect3DDevice9::SetMaterial(CONST D3DMATERIAL9 * pMaterial)æ–¹æ³•ã€‚å‡è®¾æˆ‘ä»¬æƒ³æ¸²æŸ“å‡ ä¸ªä¸åŒæè´¨çš„ç‰©ä½“ï¼›æˆ‘ä»¬å°†æŒ‰ç…§å¦‚ä¸‹çš„å†™æ³•å»åšï¼š12345678D3DMATERIAL9 blueMaterial, redMaterial;// set up material structuresDevice-&gt;SetMaterial(&amp;blueMaterial);drawSphere(); // blue sphereDevice-&gt;SetMaterial(&amp;redMaterial);drawSphere(); // red sphere é¡¶ç‚¹æ³•çº¿é¢æ³•çº¿ï¼ˆface normalï¼‰æ˜¯æè¿°å¤šè¾¹å½¢è¡¨é¢æ–¹å‘çš„ä¸€ä¸ªå‘é‡ï¼ˆå¦‚å›¾5.1ï¼‰ã€‚ å›¾5.1 é¡¶ç‚¹æ³•çº¿ï¼ˆVertex normalsï¼‰ä¹Ÿæ˜¯åŸºäºåŒæ ·çš„æ¦‚å¿µï¼Œä½†æ˜¯æˆ‘ä»¬ä¸å…¶æŒ‡å®šæ¯ä¸ªå¤šè¾¹å½¢çš„æ³•çº¿ï¼Œè¿˜ä¸å¦‚ä¸ºæ¯ä¸ªé¡¶ç‚¹æŒ‡å®šï¼ˆå¦‚å›¾5.2ï¼‰ã€‚ å›¾5.2 Direct3Déœ€è¦çŸ¥é“é¡¶ç‚¹æ³•çº¿ä»¥ä¾¿å®ƒèƒ½å¤Ÿç¡®å®šç¯å…‰ç…§å°„åˆ°ç‰©ä½“è¡¨é¢çš„è§’åº¦ï¼Œå¹¶ä¸”ä¸€æ—¦è®¡ç®—äº†æ¯ä¸ªé¡¶ç‚¹çš„ç¯å…‰ï¼ŒDirect3Déœ€è¦çŸ¥é“æ¯ä¸ªé¡¶ç‚¹çš„è¡¨é¢æ–¹å‘ã€‚æ³¨æ„é¡¶ç‚¹æ³•çº¿ä¸ä¸€å®šå’Œé¢æ³•çº¿ç›¸åŒã€‚çƒä½“/ç¯å½¢ç‰©å°±æ˜¯å¾ˆå¥½çš„å®ç‰©ä¾‹å­ï¼Œå®ƒä»¬çš„é¡¶ç‚¹æ³•çº¿å’Œä¸‰è§’å½¢æ³•çº¿æ˜¯ä¸ç›¸åŒçš„ï¼ˆå¦‚å›¾5.3ï¼‰ã€‚ å›¾5.3ä¸ºäº†æè¿°é¡¶ç‚¹çš„é¡¶ç‚¹æ³•çº¿ï¼Œæˆ‘ä»¬å¿…é¡»æ›´æ–°åŸæ¥çš„é¡¶ç‚¹ç»“æ„1234567struct Vertex&#123; float _x, _y, _z; float _nx, _ny, _nz; static const DWORD FVF;&#125;const DWORD Vertex::FVF = D3DFVF_XYZ | D3DFVF_NORMAL; æ³¨æ„ï¼Œæˆ‘ä»¬å·²ç»å°†ä¸Šä¸€ç« ä¸­ä½¿ç”¨çš„é¢œè‰²æˆåˆ†å»é™¤äº†ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬å°†ä½¿ç”¨ç¯å…‰æ¥è®¡ç®—é¡¶ç‚¹çš„é¢œè‰²ã€‚ ä½œä¸ºä¸€ä¸ªç®€å•çš„ç‰©ä½“æ¯”å¦‚ç«‹æ–¹ä½“å’Œçƒä½“ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡è§‚å¯Ÿçœ‹è§é¡¶ç‚¹æ³•çº¿ã€‚å¯¹äºæ›´å¤šå¤æ‚çš„ç½‘æ ¼ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ›´å¤šçš„æœºæ¢°æ–¹æ³•ã€‚å‡è®¾ä¸€ä¸ªç”±p0,p1,p2æ„æˆçš„ä¸‰è§’å½¢ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—æ¯ä¸ªé¡¶ç‚¹çš„æ³•çº¿n0,n1,n2ã€‚ ç®€å•çš„æ­¥éª¤ï¼Œæˆ‘ä»¬åˆ—ä¸¾å®ƒæ˜¯ä¸ºäº†æ‰¾åˆ°ç”±ä¸‰ä¸ªç‚¹æ„æˆçš„ä¸‰è§’å½¢çš„é¢æ³•çº¿ï¼ŒåŒæ—¶ä½¿ç”¨é¢æ³•çº¿ä½œä¸ºé¡¶ç‚¹æ³•çº¿ã€‚é¦–å…ˆè®¡ç®—ä¸‰è§’å½¢ä¸Šçš„ä¸¤ä¸ªå‘é‡ï¼š é‚£ä¹ˆé¢æ³•çº¿æ˜¯ï¼š æ¯ä¸ªé¡¶ç‚¹çš„æ³•çº¿å’Œé¢æ³•çº¿æ˜¯ç›¸ç­‰çš„ï¼š ä¸‹é¢æ˜¯ä¸€ä¸ªCå‡½æ•°ï¼Œå®ƒé€šè¿‡ä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹è®¡ç®—ä¸‰è§’å½¢çš„é¢æ³•çº¿ã€‚æ³¨æ„è¿™ä¸ªå‡½æ•°çš„ä¸‰ä¸ªé¡¶ç‚¹æ˜¯æŒ‰ç…§é¡ºæ—¶é’ˆæ–¹å‘æŒ‡å®šçš„ã€‚å‡å¦‚ä¸æ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆæ³•çº¿æ–¹å‘å°†æ˜¯ç›¸åçš„ã€‚12345678910void ComputeNormal(D3DXVECTOR3* p0, D3DXVECTOR3* p1, D3DXVECTOR3* p2, D3DXVECTOR3* out)&#123; D3DXVECTOR3 u = *p1 - *p0; D3DXVECTOR3 v = *p2 - *p0; D3DXVec3Cross(out, &amp;u, &amp;v); D3DXVec3Normalize(out, out);&#125; å½“ç”¨ä¸‰è§’å½¢è¿‘ä¼¼è¡¨ç¤ºæ›²é¢æ—¶ï¼Œä½¿ç”¨é¢æ³•çº¿ä½œä¸ºé¡¶ç‚¹æ³•çº¿ä¸èƒ½è¡¨ç°ä¸€ä¸ªå¹³æ»‘çš„ç»“æœã€‚ä¸€ä¸ªæ›´å¥½çš„æ–¹æ³•æ˜¯æ‰¾åˆ°é¡¶ç‚¹æ³•çº¿çš„å¹³å‡æ³•çº¿ã€‚ä¸ºäº†æ‰¾åˆ°é¡¶ç‚¹vçš„é¡¶ç‚¹æ³•çº¿vnï¼Œæˆ‘ä»¬æ‰¾åˆ°ç½‘æ ¼æ¨¡å‹ä¸­æ‰€æœ‰ä¸‰è§’å½¢çš„é¢æ³•çº¿è®°ä¸ºé¡¶ç‚¹vã€‚vnæ˜¯é€šè¿‡è®¡ç®—ä»–ä»¬çš„å¹³å‡é¢æ³•çº¿å¾—åˆ°çš„ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾æœ‰3ä¸ªä¸‰è§’å½¢å®ƒä»¬çš„é¢æ³•çº¿åˆ†åˆ«æ˜¯n0ï¼Œn1ï¼Œn2ï¼ŒæŒ‡å®šä¸ºé¡¶ç‚¹vã€‚é‚£ä¹ˆvnçš„å¹³å‡æ³•çº¿å°±æ˜¯ï¼š é€šè¿‡æ”¹å˜â€œèˆå°â€ï¼ŒæŠŠé¡¶ç‚¹æ³•çº¿å˜ä¸ºnon-normal,è¿™æ˜¯æœ‰å¯èƒ½çš„ã€‚å› æ­¤è¿™æ ·æœ€å¥½æ˜¯å®‰å…¨çš„ä¸”åœ¨é€šè¿‡D3DRS_NORMALIZENORMALSè®¾ç½®æ¸²æŸ“çŠ¶æ€æ¥æ”¹å˜â€œèˆå°â€åï¼ŒDirect3Dä»æ–°è§„æ ¼åŒ–æ‰€æœ‰æ³•çº¿ã€‚Device-&gt;SetRenderState(D3DRS_NORMALIZENORMALS, true);5.4å…‰æº Direct3Dæ”¯æŒä¸‰ç§ç±»å‹çš„å…‰æºã€‚ ç‚¹å…‰æºâ€”â€”è¿™ç§å…‰æºåœ¨ä¸–ç•Œåæ ‡ä¸­æœ‰ä¸€ä¸ªä½ç½®ä¸”å‘æ‰€æœ‰æ–¹å‘ä¸Šéƒ½ç…§å°„å…‰çº¿ã€‚ å›¾5.4 æ–¹å‘å…‰æºâ€”â€”è¿™ç§å…‰æºæ²¡æœ‰ä½ç½®ä½†æ˜¯å‘æŒ‡å®šæ–¹å‘å‘å‡ºå¹³è¡Œå…‰çº¿ã€‚ å›¾5.5 èšå…‰ç¯â€”â€”è¿™ç§ç±»å‹çš„å…‰æºå’Œæ‰‹ç”µç­’çš„å…‰ç±»ä¼¼ï¼›å®ƒæœ‰ä½ç½®å¹¶ä¸”å‘å‡ºçš„å…‰åœ¨æŒ‡å®šæ–¹å‘ä¸ŠæŒ‰ç…§åœ†é”¥å½¢ç…§å°„ã€‚è¿™ä¸ªåœ†é”¥å½¢æœ‰ä¸¤ä¸ªè§’åº¦ï¼ŒÎ¸å’ŒÏ†ã€‚è§’åº¦Î¸æè¿°å†…åœ†é”¥ï¼ŒÏ†æè¿°å¤–åœ†é”¥ã€‚ å›¾5.6 åœ¨ä»£ç ä¸­ä¸€ä¸ªç¯å…‰èµ„æºæ˜¯é€šè¿‡D3DLIGHT9ç»“æ„æ¥è¡¨ç°çš„ã€‚typedef struct _D3DLIGHT9 { D3DLIGHTTYPE Type; D3DCOLORVALUE Diffuse; D3DCOLORVALUE Specular; D3DCOLORVALUE Ambient; D3DVECTOR Position; D3DVECTOR Direction; float Range; float Falloff; float Attenuation0; float Attenuation1; float Attenuation2; float Theta; float Phi;} D3DLIGHT9; Typeâ€”â€”å®šä¹‰ç¯å…‰ç±»å‹ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ä¸‹é¢ä¸‰ç§ç±»å‹ä¹‹ä¸€ï¼šD3DLIGHT_POINT, D3DLIGHT_SPOT, D3DLIGHT_DIRECTIONAL Diffuseâ€”â€”æ­¤å…‰æºå‘å‡ºçš„æ¼«å°„å…‰é¢œè‰²ã€‚ Specularâ€”â€”æ­¤å…‰æºå‘å‡ºçš„é•œé¢å…‰é¢œè‰²ã€‚ Ambientâ€”â€”æ­¤å…‰æºå‘å‡ºçš„ç¯å¢ƒå…‰é¢œè‰²ã€‚ Positionâ€”â€”ç”¨ä¸€ä¸ªå‘é‡æ¥æè¿°çš„å…‰æºä¸–ç•Œåæ ‡ä½ç½®ã€‚è¿™ä¸ªå€¼å¯¹äºç¯å…‰çš„æ–¹å‘æ˜¯æ— æ„ä¹‰çš„ã€‚ Directionâ€”â€”ç”¨ä¸€ä¸ªå‘é‡æ¥æè¿°çš„å…‰æºä¸–ç•Œåæ ‡ç…§å°„æ–¹å‘ã€‚è¿™ä¸ªå€¼ä¸èƒ½ç”¨åœ¨ç‚¹å…‰æºä¸Šã€‚ Rangeâ€”â€”ç¯å…‰èƒ½å¤Ÿä¼ æ’­çš„æœ€å¤§èŒƒå›´ã€‚è¿™ä¸ªå€¼ä¸èƒ½æ¯”å¤§ã€‚ä¸”ä¸èƒ½ç”¨äºæ–¹å‘å…‰æºã€‚ Falloffâ€”â€”è¿™ä¸ªå€¼åªèƒ½ç”¨åœ¨èšå…‰ç¯ä¸Šã€‚å®ƒå®šä¹‰ç¯å…‰åœ¨ä»å†…åœ†é”¥åˆ°å¤–åœ†é”¥ä¹‹é—´çš„å¼ºåº¦è¡°å‡ã€‚å®ƒçš„å€¼é€šå¸¸è®¾ç½®ä¸º1.0fã€‚ Attenuation0, Attenuation1, Attenuation2â€”â€”è¿™äº›è¡°å‡å˜é‡è¢«ç”¨æ¥å®šä¹‰ç¯å…‰å¼ºåº¦çš„ä¼ æ’­è·ç¦»è¡°å‡ã€‚å®ƒä»¬åªè¢«ç”¨äºç‚¹å…‰æºå’Œèšå…‰ç¯ä¸Šã€‚Attenuation0å®šä¹‰æ’å®šè¡°å‡ï¼ŒAttenuation1å®šä¹‰çº¿æ€§è¡°å‡ï¼ŒAttenuation2å®šä¹‰äºŒæ¬¡è¡°å‡ã€‚é€‚å½“çš„ä½¿ç”¨è¿™ä¸ªå…¬å¼ï¼ŒDæ˜¯ä»£è¡¨åˆ°å…‰æºçš„è·ç¦»ï¼ŒA0,A1,A2ä¸Attenuation0ï¼Œ1ï¼Œ2ç›¸åŒ¹é…ã€‚ Thetaâ€”â€”åªç”¨äºèšå…‰ç¯ï¼›æŒ‡å®šå†…åœ†é”¥çš„è§’åº¦ï¼Œå•ä½æ˜¯å¼§åº¦ã€‚ Phiâ€”â€”åªç”¨äºèšå…‰ç¯ï¼›æŒ‡å®šå¤–åœ†é”¥çš„è§’åº¦ï¼Œå•ä½æ˜¯å¼§åº¦ã€‚ å°±è±¡åˆå§‹åŒ–D3DMATERIAL9ç»“æ„ä¸€æ ·ï¼Œåˆå§‹åŒ–D3DLIGHT9ç»“æ„æ˜¯ä¸€ä»¶å•è°ƒä¹å‘³çš„å·¥ä½œã€‚æˆ‘ä»¬æ·»åŠ ä¸‹é¢çš„å‡½æ•°åˆ°d3dUtility.h/cppæ–‡ä»¶ä¸­ç”¨äºåˆå§‹åŒ–ç®€å•ç¯å…‰ã€‚namespace d3d{ â€¦ â€¦ D3DLIGHT9 InitDirectionalLight(D3DXVECTOR3 direction, D3DXCOLOR color); D3DLIGHT9 InitPointLight(D3DXVECTOR3 position, D3DXCOLOR color); D3DLIGHT9 InitSpotLight(D3DXVECTOR3 position, D3DXVECTOR3 direction, D3DXCOLOR color);} ä½¿ç”¨è¿™äº›å‡½æ•°æ˜¯éå¸¸ç®€å•çš„ã€‚æˆ‘ä»¬ç°åœ¨åªæ˜¯æ¼”ç¤ºæ€æ ·ä½¿ç”¨InitDirectionalLightã€‚å…¶ä»–çš„ä¹Ÿå¾ˆç±»ä¼¼ï¼šD3DLIGHT9 d3d::InitDirectionalLight(D3DXVECTOR3 direction, D3DXCOLOR color){ D3DLIGHT9 light; ::ZeroMemory(&amp;light, sizeof(light)); light.Type = D3DLIGHT_DIRECTIONAL; light.Ambient = color 0.4f; light.Diffuse = color; light.Specular = color 0.6f; light.Direction = *direction; return light;} ç„¶ååˆ›å»ºä¸€ä¸ªæ–¹å‘å…‰æºï¼Œå®ƒæ²¿ç€xè½´æ­£æ–¹å‘ç…§å°„ç™½è‰²ç¯å…‰ã€‚æˆ‘ä»¬æŒ‰ç…§ä¸‹é¢çš„æ–¹æ³•æ¥åšï¼šD3DXVECTOR3 dir(1.0f, 0.0f, 0.0f);D3DXCOLOR c = d3d::WHITE;D3DLIGHT9 dirLight = d3d::InitDirectionalLight(&amp;dir, &amp;c); åœ¨æŠŠD3DLIGHT9åˆå§‹åŒ–å¥½ä»¥åï¼Œæˆ‘ä»¬éœ€è¦ç”¨Direct3Då†…åœ¨æ”¯æŒçš„ç¯å…‰æ¥æ³¨å†Œã€‚å°±è±¡è¿™æ ·åšï¼šDevice-&gt;SetLight( 0, // element in the light list to set, range is 0-maxlights &amp;light);// address of the D3DLIGHT9 structure to set ä¸€æ—¦ç¯å…‰æ³¨å†Œäº†ï¼Œæˆ‘ä»¬å°±èƒ½ä½¿ç”¨ä¸‹é¢çš„åˆ—ä¸¾çš„ä¾‹å­æ¥å¼€æˆ–å…³ç¯å…‰äº†ï¼šDevice-&gt;LightEnable( 0, // the element in the light list to enable/disable true); // true = enable, false = disable5.5å®ä¾‹ç¨‹åºï¼šç¯å…‰ è¿™ä¸€ç« çš„ä¾‹å­æ˜¯åˆ›å»ºå¦‚å›¾5.7æ‰€æ˜¾ç¤ºçš„åœºæ™¯ã€‚å®ƒç¤ºèŒƒäº†æ€æ ·æŒ‡å®šé¡¶ç‚¹æ³•çº¿ï¼Œæ€æ ·åˆ›å»ºæè´¨ï¼Œä»¥åŠæ€æ ·åˆ›å»ºå’Œä½¿ç”¨ä¸€ä¸ªæ–¹å‘ç¯å…‰ã€‚æ³¨æ„åœ¨è¿™ä¸ªç¤ºä¾‹ç¨‹åºä¸­æˆ‘ä»¬ä¸ä¼šä½¿ç”¨åœ¨æ–‡ä»¶d3dUtility.h/cppä¸­çš„æè´¨å’Œç¯å…‰å‡½æ•°ã€‚å› ä¸ºæˆ‘ä»¬æƒ³å±•ç¤ºæ€æ ·æ‰‹åŠ¨æ¥åšè¿™äº›è®¾ç½®ã€‚ å›¾5.7 ç»™åœºæ™¯å¢åŠ ç¯å…‰çš„æ­¥éª¤æ˜¯ï¼š1ã€ å…è®¸ä½¿ç”¨ç¯å…‰ã€‚2ã€ ä¸ºæ¯ä¸ªç‰©ä½“åˆ›å»ºæè´¨å¹¶ä¸”åœ¨æ¸²æŸ“ç›¸åº”ç‰©ä½“å‰åº”å°†æè´¨é™„äºˆç‰©ä½“ã€‚3ã€ åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªå…‰æºï¼Œè®¾ç½®å®ƒä»¬ï¼ŒæŠŠå®ƒä»¬è®¾ä¸ºå¯ç”¨ã€‚4ã€ å°†å…¶ä»–é™„åŠ å…‰æºè®¾ä¸ºå¯ç”¨ï¼Œæ¯”å¦‚é•œé¢é«˜å…‰ã€‚ é¦–å…ˆæˆ‘ä»¬åˆå§‹åŒ–ä¸€ä¸ªå…¨å±€é¡¶ç‚¹ç¼“å­˜ç”¨ä»–æ¥å­˜å‚¨â€œé‡‘å­—å¡”â€çš„é¡¶ç‚¹ï¼šIDirect3DVertexBuffer9* Pyramid = 0; Setupå‡½æ•°åŒ…å«æœ¬ç« çš„æ‰€æœ‰ä»£ç ï¼Œå› æ­¤æˆ‘ä»¬å¿½ç•¥å…¶ä»–å‡½æ•°ã€‚å®ƒæ‰§è¡Œåˆšæ‰è®¨è®ºçš„æ­¥éª¤æ¥ç»™åœºæ™¯åŠ å…¥ç¯å…‰ã€‚Setupæ–¹æ³•é¦–å…ˆå…è®¸ä½¿ç”¨ç¯å…‰ï¼Œå½“ç„¶è¿™ä¸æ˜¯å¿…é¡»çš„å› ä¸ºé»˜è®¤è®¾ç½®å°±æ˜¯å…è®¸ä½¿ç”¨ç¯å…‰çš„ã€‚bool Setup(){ Device-&gt;SetRenderState(D3DRS_LIGHTING, true); ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬åˆ›å»ºé¡¶ç‚¹ç¼“å­˜ï¼Œé”å®šï¼Œå¹¶ä¸”æŠŠâ€œé‡‘å­—å¡”â€çš„ä¸‰è§’å½¢é¡¶ç‚¹æ”¾å…¥å…¶ä¸­ã€‚é¡¶ç‚¹æ³•çº¿æ˜¯åˆ©ç”¨5.3èŠ‚ä¸­çš„è¿ç®—æ³•åˆ™é¢„å…ˆè®¡ç®—å¥½çš„ã€‚æ³¨æ„ä¸‰è§’å½¢å…±äº«é¡¶ç‚¹ï¼Œä½†å®ƒä»¬çš„æ³•çº¿ä¸èƒ½å…±äº«ï¼›å› æ­¤å¯¹è¿™ä¸ªç‰©ä½“ä½¿ç”¨ç´¢å¼•åˆ—è¡¨å¹¶ä¸æ˜¯æœ€æœ‰åˆ©çš„ã€‚ä¾‹å¦‚ï¼Œæ‰€æœ‰ä¸‰è§’å½¢éƒ½å…±äº«é¡¶ç‚¹ï¼ˆ0,1,0ï¼‰ï¼›ç„¶è€Œï¼Œå¯¹æ¯ä¸ªä¸‰è§’å½¢ï¼Œå®ƒä»¬çš„é¡¶ç‚¹æ³•çº¿æ˜¯ä¸ç›¸åŒçš„ã€‚1234567891011121314151617181920212223242526272829303132Device-&gt;CreateVertexBuffer( 12 * sizeof(Vertex), D3DUSAGE_WRITEONLY, Vertex::FVF, D3DPOOL_MANAGED, &amp;Pyramid, 0);// fill the vertex buffer with pyramid dataVertex* v;Pyramid-&gt;Lock(0, 0, (void**)&amp;v, 0);// front facev[0] = Vertex(-1.0f, 0.0f, -1.0f, 0.0f, 0.707f, -0.707f);v[1] = Vertex( 0.0f, 1.0f, 0.0f, 0.0f, 0.707f, -0.707f);v[2] = Vertex( 1.0f, 0.0f, -1.0f, 0.0f, 0.707f, -0.707f);// left facev[3] = Vertex(-1.0f, 0.0f, 1.0f, -0.707f, 0.707f, 0.0f);v[4] = Vertex( 0.0f, 1.0f, 0.0f, -0.707f, 0.707f, 0.0f);v[5] = Vertex(-1.0f, 0.0f, -1.0f, -0.707f, 0.707f, 0.0f);// right facev[6] = Vertex( 1.0f, 0.0f, -1.0f, 0.707f, 0.707f, 0.0f);v[7] = Vertex( 0.0f, 1.0f, 0.0f, 0.707f, 0.707f, 0.0f);v[8] = Vertex( 1.0f, 0.0f, 1.0f, 0.707f, 0.707f, 0.0f);// back facev[9] = Vertex( 1.0f, 0.0f, 1.0f, 0.0f, 0.707f, 0.707f);v[10] = Vertex( 0.0f, 1.0f, 0.0f, 0.0f, 0.707f, 0.707f);v[11] = Vertex(-1.0f, 0.0f, 1.0f, 0.0f, 0.707f, 0.707f);Pyramid-&gt;Unlock(); ä¸ºç‰©ä½“äº§ç”Ÿäº†é¡¶ç‚¹æ•°æ®ä»¥åï¼Œæˆ‘ä»¬æè¿°åˆ©ç”¨ç¯å…‰è¡¨ç°å„è‡ªæè´¨çš„ç‰©ä½“é—´æ˜¯æ€æ ·ç›¸äº’å½±å“çš„ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œâ€œé‡‘å­—å¡”â€åå°„å‡ºç™½å…‰ï¼Œè‡ªèº«ä¸å‘å…‰ï¼Œä¸”ä¼šäº§ç”Ÿä¸€äº›é«˜å…‰ã€‚D3DMATERIAL9 mtrl;mtrl.Ambient = d3d::WHITE;mtrl.Diffuse = d3d::WHITE;mtrl.Specular = d3d::WHITE;mtrl.Emissive = d3d::BLACK;mtrl.Power = 5.0f;Device-&gt;SetMaterial(&amp;mtrl); æ¥ç€ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–¹å‘å…‰å¹¶å°†å…¶è®¾ä¸ºå¯ç”¨ã€‚æ–¹å‘å…‰æ˜¯æ²¿ç€xè½´çš„æ­£æ–¹å‘ç…§å°„çš„ã€‚ç¯å…‰ç…§å°„æœ€å¼ºçš„ç™½è‰²æ¼«å°„å…‰ï¼ˆdir.Diffuse = WHITEï¼‰ï¼Œè¾ƒå¼±çš„ç™½è‰²é•œé¢å…‰ï¼ˆdir.Specular = WHITE 0.3fï¼‰ä»¥åŠä¸€ä¸ªä¸­ç­‰å¼ºåº¦çš„ç™½è‰²ç¯å¢ƒå…‰ï¼ˆdir.Ambient = WHITE 0.6fï¼‰ã€‚123456789101112131415D3DLIGHT9 dir;::ZeroMemory(&amp;dir, sizeof(dir));dir.Type = D3DLIGHT_DIRECTIONAL;dir.Diffuse = d3d::WHITE;dir.Specular = d3d::WHITE * 0.3f;dir.Ambient = d3d::WHITE * 0.6f;dir.Direction = D3DXVECTOR3(1.0f, 0.0f, 0.0f);Device-&gt;SetLight(0, &amp;dir);Device-&gt;LightEnable(0, true);//æœ€åï¼Œæˆ‘ä»¬è®¾ç½®çŠ¶æ€ä½¿æ³•çº¿ä»æ–°è§„æ ¼åŒ–ä¸”æŠŠé•œé¢é«˜å…‰è®¾ç½®ä¸ºå¯ç”¨ã€‚Device-&gt;SetRenderState(D3DRS_NORMALIZENORMALS, true);Device-&gt;SetRenderState(D3DRS_SPECULARENABLE, true);// ... code to set up the view matrix and projection matrix// omittedreturn true; 5.6é™„åŠ å®ä¾‹ è¿™ä¸€ç« ä¸­è¿˜æœ‰ä¸‰ä¸ªé™„åŠ çš„ä¾‹å­ã€‚å®ƒä»¬ä½¿ç”¨D3DXCreateå‡½æ•°æ¥åˆ›å»ºç»„æˆåœºæ™¯çš„3Dç‰©ä½“ã€‚D3DXCreateå‡½æ•°åˆ›å»ºçš„é¡¶ç‚¹æ•°æ®æ˜¯D3DFVF_XYZ | D3DFVF_NORMALæ ¼å¼ã€‚åœ¨å¢åŠ çš„å‡½æ•°ä¸­ä¸ºæˆ‘ä»¬çš„ç½‘æ ¼æ¨¡å‹çš„æ¯ä¸ªé¡¶ç‚¹è®¡ç®—äº†é¡¶ç‚¹æ³•çº¿ã€‚è¿™äº›å®ä¾‹æ¼”ç¤ºäº†æ€æ ·ä½¿ç”¨æ–¹å‘å…‰ï¼Œç‚¹å…‰æºï¼Œä»¥åŠèšå…‰ç¯ã€‚å›¾5.8æ˜¾ç¤ºçš„æ˜¯æ–¹å‘å…‰å®ä¾‹ä¸­çš„ä¸€ä¸ªåœºæ™¯å›¾ã€‚ å›¾5.8]]></content>
      <categories>
        <category>Direct3D</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[è‰²å½©(Color)]]></title>
    <url>%2F2019%2F04%2F11%2Fcolor%2F</url>
    <content type="text"><![CDATA[é¢œè‰²è¡¨ç¤ºæ³• åœ¨Direct3Dä¸­ï¼Œé¢œè‰²æ˜¯ä½¿ç”¨RGBä¸‰éƒ¨åˆ†æ¥æè¿°çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¦åˆ†åˆ«æŒ‡å®šçº¢ã€ç»¿å’Œè“ä¸‰ç§é¢œè‰²çš„å€¼ã€‚æ··åˆè¿™ä¸‰ä¸ªé¢œè‰²å†³å®šæœ€ç»ˆçš„é¢œè‰²ã€‚åˆ©ç”¨è¿™ä¸‰ç§é¢œè‰²æˆ‘ä»¬èƒ½å¤Ÿè¡¨ç°æ•°ä¸‡ç§é¢œè‰²ã€‚ æˆ‘ä»¬ä½¿ç”¨ä¸¤ç§ä¸åŒçš„ç»“æ„æ¥å­˜å‚¨RGBæ•°æ®ã€‚è¿™ç¬¬ä¸€ç§æ˜¯D3DCOLORï¼Œå®ƒå®é™…ä¸Šä¸€ä¸ªDWORDå³32ä½ã€‚åœ¨D3DCOLORç±»å‹ä¸­çš„è¿™äº›ä½æŒ‰ç…§8-bitè¢«åˆ†ä¸º4ä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸€éƒ¨åˆ†å­˜å‚¨çš„æ˜¯è¯¥è‰²çš„äº®åº¦å€¼ã€‚å¦‚å›¾4.1æ‰€ç¤ºã€‚ å›¾4.1 æ¯ç§é¢œè‰²å ç”¨å†…å­˜çš„ä¸€ä¸ªå­—èŠ‚ï¼Œå„é¢œè‰²äº®åº¦å€¼çš„å–å€¼èŒƒå›´æ˜¯0-255ã€‚è¿™ä¸ªå€¼è¶Šæ¥è¿‘0å°±è¶Šæš—ï¼Œè¶Šæ¥è¿‘255å°±è¶Šäº®ã€‚æ³¨æ„ï¼šç°åœ¨ä¸è¦ç®¡alphaéƒ¨åˆ†ï¼›å®ƒè¢«ç”¨åœ¨alphaæ··åˆä¸­â€”â€”åœ¨ç¬¬7ç« ä¸­ä¼šè®²è§£ã€‚ æŒ‡å®šå…¶ä¸­çš„æ¯ä¸€éƒ¨åˆ†å¹¶ä¸”æŠŠå®ƒæ”¾åˆ°D3DCOLORä¸­é€‚å½“çš„ä½ç½®éœ€è¦ä½¿ç”¨åˆ°ä¸€äº›ä½æ“ä½œã€‚Direct3Dä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå®Œæˆè¿™ä¸ªä»»åŠ¡çš„å®D3DCOLOR_ARGB.å®ƒä½¿ç”¨åŒ…å«æ¯ç§é¢œè‰²ä»¥åŠalphaä½ä¸€å…±4ä¸ªå‚æ•°ã€‚æ¯ä¸€ä¸ªå‚æ•°çš„å–å€¼å¿…é¡»åœ¨0-255ä¹‹é—´ï¼Œå¦‚ï¼šD3DCOLOR brightRed = D3DCOLOR_ARGB(255, 255, 0, 0);D3DCOLOR someColor = D3DCOLOR_ARGB(255, 144, 87, 201); å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½ä½¿ç”¨D3DCOLOR_XRGBå®ï¼Œå®ƒä¸åˆšæ‰çš„å®ç±»ä¼¼åªä¸è¿‡ä¸å¿…æŒ‡å®šalphaéƒ¨åˆ†ï¼›ä¸è¿‡æˆ‘ä»¬æœ€å¥½è¿˜æ˜¯æŠŠalphaæŒ‡å®šä¸º0xffï¼ˆ255ï¼‰ã€‚ define D3DCOLOR_XRGB(r,g,b) D3DCOLOR_ARGB(0xff,r,g,b) åœ¨Direct3Dä¸­å¦å¤–ä¸€ç§å­˜å‚¨é¢œè‰²çš„ç»“æ„æ˜¯D3DCOLORVALUEã€‚åœ¨è¿™ä¸ªç»“æ„ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«ä½¿ç”¨ä¸€ä¸ªæµ®ç‚¹æ•°æ¥è¡¨ç¤ºæ¯ä¸€éƒ¨åˆ†çš„äº®åº¦å€¼ã€‚å…¶å–å€¼èŒƒå›´æ˜¯0-1ï¼Œ0è¡¨ç¤ºæ²¡æœ‰äº®åº¦ï¼Œ1è¡¨ç¤ºæœ€å¤§äº®åº¦ã€‚123456typedef struct _D3DCOLORVALUE &#123; float r; // the red component, range 0.0-1.0 float g; // the green component, range 0.0-1.0 float b; // the blue component, range 0.0-1.0 float a; // the alpha component, range 0.0-1.0&#125; D3DCOLORVALUE; å¦å¤–ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨D3DXCOLORç»“æ„ï¼Œå°±è±¡D3DCOLORVALUEåŒ…å«åŒæ ·çš„æ•°æ®æˆå‘˜ä¸€æ ·ã€‚åŒæ—¶æä¾›æœ‰ç”¨çš„æ„é€ å‡½æ•°å’Œé‡è½½æ“ä½œç¬¦ï¼Œè¿™å°†è®©é¢œè‰²å¤„ç†æ›´å®¹æ˜“ã€‚D3DXCOLORçš„å®šä¹‰å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344typedef struct D3DXCOLOR&#123; #ifdef __cplusplus public: D3DXCOLOR() &#123;&#125; D3DXCOLOR( DWORD argb ); D3DXCOLOR( CONST FLOAT * ); D3DXCOLOR( CONST D3DXFLOAT16 * ); D3DXCOLOR( CONST D3DCOLORVALUE&amp; ); D3DXCOLOR( FLOAT r, FLOAT g, FLOAT b, FLOAT a ); // casting operator DWORD () const; operator FLOAT* (); operator CONST FLOAT* () const; operator D3DCOLORVALUE* (); operator CONST D3DCOLORVALUE* () const; operator D3DCOLORVALUE&amp; (); operator CONST D3DCOLORVALUE&amp; () const; // assignment operators D3DXCOLOR&amp; operator += ( CONST D3DXCOLOR&amp; ); D3DXCOLOR&amp; operator -= ( CONST D3DXCOLOR&amp; ); D3DXCOLOR&amp; operator *= ( FLOAT ); D3DXCOLOR&amp; operator /= ( FLOAT ); // unary operators D3DXCOLOR operator + () const; D3DXCOLOR operator - () const; // binary operators D3DXCOLOR operator + ( CONST D3DXCOLOR&amp; ) const; D3DXCOLOR operator - ( CONST D3DXCOLOR&amp; ) const; D3DXCOLOR operator * ( FLOAT ) const; D3DXCOLOR operator / ( FLOAT ) const; friend D3DXCOLOR operator * (FLOAT, CONST D3DXCOLOR&amp; ); BOOL operator == ( CONST D3DXCOLOR&amp; ) const; BOOL operator != ( CONST D3DXCOLOR&amp; ) const; #endif //__cplusplus FLOAT r, g, b, a;&#125; D3DXCOLOR, *LPD3DXCOLOR; æ³¨æ„ï¼šD3DCOLORVALUEå’ŒD3DXCOLORç»“æ„éƒ½æœ‰4ä¸ªæµ®ç‚¹æ•°æˆå‘˜ã€‚è¿™ä½¿æˆ‘ä»¬çš„é¢œè‰²å¤„ç†ç¬¦å·èƒ½è±¡4Då‘é‡ä¸€æ ·ã€‚é¢œè‰²å‘é‡èƒ½è¢«åŠ ï¼Œå‡ä»¥åŠç¼©æ”¾ã€‚å¦ä¸€æ–¹é¢ç‚¹ç§¯å’Œå‰ç§¯ä¸èƒ½ç”¨äºé¢œè‰²å‘é‡ï¼Œä½†æ˜¯é¢œè‰²æˆå‘˜ç›¸ä¹˜æ˜¯å¯ä»¥çš„ã€‚å› æ­¤åœ¨D3DXCOLORç±»ä¸­æ‰§è¡Œçš„ä¹˜æ³•å°±æ˜¯æˆå‘˜ç›¸ä¹˜ã€‚å®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š ç°åœ¨ä½¿ç”¨ä¸‹é¢å…¨å±€é¢œè‰²å¸¸é‡æ›´æ–°æˆ‘ä»¬çš„d3dUtility.hæ–‡ä»¶ï¼š 1234567891011namespace d3d&#123; const D3DXCOLOR WHITE( D3DCOLOR_XRGB(255, 255, 255) ); const D3DXCOLOR BLACK( D3DCOLOR_XRGB( 0, 0, 0) ); const D3DXCOLOR RED( D3DCOLOR_XRGB(255, 0, 0) ); const D3DXCOLOR GREEN( D3DCOLOR_XRGB( 0, 255, 0) ); const D3DXCOLOR BLUE( D3DCOLOR_XRGB( 0, 0, 255) ); const D3DXCOLOR YELLOW( D3DCOLOR_XRGB(255, 255, 0) ); const D3DXCOLOR CYAN( D3DCOLOR_XRGB( 0, 255, 255) ); const D3DXCOLOR MAGENTA( D3DCOLOR_XRGB(255, 0, 255) );&#125; é¡¶ç‚¹é¢œè‰²å›¾å…ƒçš„é¢œè‰²æ˜¯ç”±æ„æˆå®ƒçš„é¡¶ç‚¹çš„é¢œè‰²å†³å®šçš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»æŠŠä¸€ä¸ªé¢œè‰²æˆå‘˜åŠ å…¥åˆ°æˆ‘ä»¬çš„é¡¶ç‚¹æ•°æ®ç»“æ„ä¸­ã€‚æ³¨æ„D3DCOLORVALUEç±»å‹ä¸èƒ½ç”¨åœ¨è¿™é‡Œï¼Œå› ä¸ºDirect3Då¸Œæœ›ç”¨ä¸€ä¸ª32ä½çš„å€¼æ¥æè¿°é¡¶ç‚¹çš„é¢œè‰²ã€‚ï¼ˆé€šè¿‡ä½¿ç”¨é¡¶ç‚¹ç€è‰²å™¨æˆ‘ä»¬èƒ½ä¸ºé¡¶ç‚¹é¢œè‰²ä½¿ç”¨4Dé¢œè‰²å‘é‡ï¼Œå®ƒèƒ½æä¾›ä¸€ä¸ª128ä½çš„é¢œè‰²ï¼Œä½†æ˜¯å¯¹äºæˆ‘ä»¬ç°åœ¨çš„æ°´å¹³æ¥è¯´é‚£å¤ªè¶…å‰äº†ã€‚é¡¶ç‚¹ç€è‰²å™¨å°†åœ¨17ç« ä¸­ä»‹ç»ã€‚ï¼‰123456struct ColorVertex&#123; float _x, _y, _z; D3DCOLOR _color; static const DWORD FVF;&#125; const DWORD ColorVertex::FVF = D3DFVF_XYZ | D3DFVF_DIFFUSE; ç€è‰²å¤„ç†ç€è‰²å¤„ç†å‘ç”Ÿåœ¨å…‰æ …åŒ–å’ŒæŒ‡å®šå›¾å…ƒä¸Šçš„é¡¶ç‚¹é¢œè‰²æ€æ ·è¢«è®¡ç®—æˆåƒç´ é¢œè‰²ä¹‹é—´ã€‚ç›®å‰è¿™é‡Œæœ‰2ç§ç€è‰²å¤„ç†æ¨¡å¼å¯ç”¨ï¼šå¹³é¢ç€è‰²ï¼ˆflat shadingï¼‰å’Œé«˜æ´›å¾·ç€è‰²ï¼ˆGouraud shadingï¼‰ã€‚å¹³é¢ç€è‰²ï¼Œå›¾å…ƒåƒç´ çš„é¢œè‰²æ˜¯å‡åŒ€çš„ï¼Œä¸”å°±æ˜¯æŒ‡å®šå›¾å…ƒç¬¬ä¸€ä¸ªé¡¶ç‚¹çš„é¢œè‰²ã€‚å› æ­¤ä¸€æ—¦ä¸‰è§’å½¢çš„ç¬¬ä¸€ä¸ªé¡¶ç‚¹è¢«æŒ‡å®šæˆçº¢è‰²ï¼Œé‚£ä¹ˆå®ƒçš„å…¶ä»–ä¸‰ä¸ªé¡¶ç‚¹ä¹Ÿå°†ä¼šæ˜¯çº¢è‰²ã€‚é€šè¿‡ä½¿ç”¨å¹³é¢ç€è‰²æ¥ä¸ºç¬¬äºŒå’Œç¬¬ä¸‰ä¸ªé¡¶ç‚¹ç€è‰²ã€‚1234ColorVertex t[3];t[0]._color = D3DCOLOR_XRGB(255, 0, 0);t[1]._color = D3DCOLOR_XRGB(0, 255, 0);t[2]._color = D3DCOLOR_XRGB(0, 0, 255); å¹³é¢ç€è‰²ä½¿ç‰©ä½“å‘ˆç°æ˜¯æ–‘é©³çš„ï¼Œå› ä¸ºæ²¡æœ‰ä»ä¸€ä¸ªé¢œè‰²åˆ°å¦ä¸€ä¸ªé¢œè‰²çš„å¹³æ»‘è¿‡æ¸¡ã€‚ä¸€ä¸ªæ›´å¥½çš„ç€è‰²æ¨¡å¼å«åšé«˜æ´›å¾·ç€è‰²ï¼ˆä¹Ÿè¢«å«åšå¹³æ»‘ç€è‰²ï¼‰ã€‚é«˜æ´›å¾·ç€è‰²ï¼Œå›¾å…ƒè¡¨é¢çš„é¢œè‰²æ˜¯ç”±æ¯ä¸ªé¡¶ç‚¹é€šè¿‡çº¿æ€§æ’å€¼æ¥èµ‹äºˆã€‚å›¾4.2æ˜¾ç¤ºäº†åˆ†åˆ«ä½¿ç”¨å¹³é¢ç€è‰²å’Œé«˜æ´›å¾·ç€è‰²å¤„ç†çš„çº¢è‰²ä¸‰è§’å½¢ã€‚ å›¾4.2å°±è±¡Direct3Dä¸­å¾ˆå¤šä¸œè¥¿ä¸€æ ·ï¼Œç€è‰²å¤„ç†æ¨¡å¼æ˜¯å—Direct3Dè®¾ç½®çŠ¶æ€å†³å®šçš„ã€‚// set flat shadingDevice-&gt;SetRenderState(D3DRS_SHADEMODE, D3DSHADE_FLAT);// set Gouraud shadingDevice-&gt;SetRenderState(D3DRS_SHADEMODE, D3DSHADE_GOURAUD); å®ä¾‹ç¨‹åºï¼šå½©è‰²ä¸‰è§’å½¢è¿™ä¸ªå®ä¾‹ç¨‹åºå±•ç¤ºäº†åˆ†åˆ«ä½¿ç”¨æœ¬ç« ä¸­çš„å¹³é¢ç€è‰²å’Œé«˜æ´›å¾·ç€è‰²å¤„ç†çš„ä¸‰è§’å½¢ã€‚æ¸²æŸ“å‡ºçš„å›¾ç‰‡å¦‚å›¾4.2æ‰€ç¤ºã€‚é¦–å…ˆæˆ‘ä»¬å®šä¹‰å¦‚ä¸‹çš„å…¨å±€å˜é‡ï¼šD3DXMATRIX World;IDirect3DVertexBuffer9* Triangle = 0; æˆ‘ä»¬åŒ…å«ä¸€ä¸ªD3DXMATRIXï¼Œå®ƒå°†å­˜å‚¨æˆ‘ä»¬å°†è¦ç»˜åˆ¶çš„ä¸‰è§’å½¢åœ¨ä¸–ç•Œåæ ‡ä¸­çš„å˜æ¢ä¿¡æ¯ã€‚Triangleå˜é‡æ˜¯å­˜å‚¨ä¸‰è§’å½¢é¡¶ç‚¹æ•°æ®çš„é¡¶ç‚¹ç¼“å­˜ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬åªéœ€è¦å­˜å‚¨ä¸€ä¸ªä¸‰è§’å½¢ï¼Œå› ä¸ºæˆ‘ä»¬èƒ½ç”¨å®ƒåœ¨ä¸–ç•Œåæ ‡ç³»ä¸­ä¸åŒä½ç½®ç»˜åˆ¶è‹¥å¹²æ¬¡ã€‚ Setupæ–¹æ³•åˆ›å»ºé¡¶ç‚¹ç¼“å­˜åŒæ—¶å¡«å……ä¸Šå¸¦é¢œè‰²ä¿¡æ¯çš„ä¸‰è§’å½¢é¡¶ç‚¹æ•°æ®ã€‚ä¸‰è§’å½¢çš„ç¬¬ä¸€ä¸ªé¡¶ç‚¹å¡«å……ä¸ºå…¨äº®åº¦çº¢è‰²ï¼ˆ255ï¼‰ç¬¬äºŒä¸ªå¡«å……å…¨äº®åº¦ç»¿è‰²ï¼ˆ255ï¼‰ï¼Œç¬¬ä¸‰ä¸ªå¡«å……å…¨äº®åº¦è“è‰²ï¼ˆ255ï¼‰ã€‚æœ€åï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬å±è”½æ‰ç¯å…‰ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯è¯¥ä¾‹å­ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªæ–°çš„ColorVertexç»“æ„ï¼Œå°±è±¡åœ¨4.2èŠ‚ä¸­è¯´æ˜çš„ä¸€æ ·ã€‚123456789101112131415161718192021222324252627282930313233343536bool Setup()&#123; // create vertex buffer Device-&gt;CreateVertexBuffer( 3 * sizeof(ColorVertex), D3DUSAGE_WRITEONLY, ColorVertex::FVF, D3DPOOL_MANAGED, &amp;Triangle, 0); // fill the buffers with the triangle data ColorVertex* v; Triangle-&gt;Lock(0, 0, (void**)&amp;v, 0); v[0] = ColorVertex(-1.0f, 0.0f, 2.0f, D3DCOLOR_XRGB(255, 0, 0)); v[1] = ColorVertex( 0.0f, 1.0f, 2.0f, D3DCOLOR_XRGB( 0, 255, 0)); v[2] = ColorVertex( 1.0f, 0.0f, 2.0f, D3DCOLOR_XRGB( 0, 0, 255)); Triangle-&gt;Unlock(); // set projection matrix D3DXMATRIX proj; D3DXMatrixPerspectiveFovLH( &amp;proj, D3DX_PI * 0.5f, // 90 - degree (float)Width / (float)Height, 1.0f, 1000.0f); Device-&gt;SetTransform(D3DTS_PROJECTION, &amp;proj); // set the render states Device-&gt;SetRenderState(D3DRS_LIGHTING, false); return true;&#125; Displayå‡½æ•°ä½¿ç”¨ä¸åŒçš„ç€è‰²æ¨¡å¼åœ¨ä¸¤ä¸ªä¸åŒçš„åœ°æ–¹åˆ†åˆ«ç»˜åˆ¶2ä¸ªTriangleã€‚æ¯ä¸ªä¸‰è§’å½¢çš„ä½ç½®ç”±ä¸–ç•ŒçŸ©é˜µWorldæ¥å†³å®šã€‚1234567891011121314151617181920212223242526272829bool Display(float timeDelta)&#123; if( Device ) &#123; Device-&gt;Clear(0, 0, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER, 0xffffffff, 1.0f, 0); Device-&gt;BeginScene(); Device-&gt;SetFVF(ColorVertex::FVF); Device-&gt;SetStreamSource(0, Triangle, 0, sizeof(ColorVertex)); // draw the triangle to the left with flat shading D3DXMatrixTranslation(&amp;World, -1.25f, 0.0f, 0.0f); Device-&gt;SetTransform(D3DTS_WORLD, &amp;World); Device-&gt;SetRenderState(D3DRS_SHADEMODE, D3DSHADE_FLAT); Device-&gt;DrawPrimitive(D3DPT_TRIANGLELIST, 0, 1); // draw the triangle to the right with gouraud shading D3DXMatrixTranslation(&amp;World, 1.25f, 0.0f, 0.0f); Device-&gt;SetTransform(D3DTS_WORLD, &amp;World); Device-&gt;SetRenderState(D3DRS_SHADEMODE, D3DSHADE_GOURAUD); Device-&gt;DrawPrimitive(D3DPT_TRIANGLELIST, 0, 1); Device-&gt;EndScene(); Device-&gt;Present(0, 0, 0, 0); &#125; return true;&#125;]]></content>
  </entry>
  <entry>
    <title><![CDATA[Drawing in Direct3D]]></title>
    <url>%2F2019%2F04%2F11%2Fdrawing-in-direct3d%2F</url>
    <content type="text"><![CDATA[é¡¶ç‚¹/ç´¢å¼•ç¼“å­˜é¡¶ç‚¹å’Œç´¢å¼•ç¼“å­˜æœ‰ç›¸ä¼¼çš„æ¥å£å¹¶ä¸”å…±äº«ç›¸ä¼¼çš„æ–¹æ³•ï¼›ä¸€ä¸ªé¡¶ç‚¹ç¼“å­˜æ˜¯ä¸€å—è¿ç»­çš„å­˜å‚¨äº†é¡¶ç‚¹æ•°æ®çš„å†…å­˜ã€‚åŒæ ·çš„ï¼Œä¸€ä¸ªç´¢å¼•ç¼“å­˜æ˜¯ä¸€å—è¿ç»­çš„å­˜å‚¨äº†ç´¢å¼•æ•°æ®çš„å†…å­˜ã€‚æˆ‘ä»¬ä½¿ç”¨é¡¶ç‚¹å’Œç´¢å¼•ç¼“å­˜ä¿å­˜æˆ‘ä»¬çš„æ•°æ®æ˜¯å› ä¸ºå®ƒä»¬èƒ½è¢«æ”¾ç½®åœ¨æ˜¾å­˜ä¸­ã€‚æ¸²æŸ“æ˜¾å­˜ä¸­çš„æ•°æ®è¦æ¯”æ¸²æŸ“ç³»ç»Ÿå†…å­˜ä¸­çš„æ•°æ®å¿«çš„å¤šã€‚åœ¨ä»£ç ä¸­ï¼Œä¸€ä¸ªé¡¶ç‚¹ç¼“å­˜æ˜¯é€šè¿‡IDirect3DVertexBuffer9æ¥å£æ¥å®šä¹‰çš„ã€‚ç±»ä¼¼çš„ï¼Œä¸€ä¸ªç´¢å¼•ç¼“å­˜æ˜¯é€šè¿‡IDirect3DIndexBuffer9æ¥å£æ¥å®šä¹‰ã€‚ åˆ›å»ºä¸€ä¸ªé¡¶ç‚¹å’Œç´¢å¼•ç¼“å­˜æˆ‘ä»¬èƒ½ä½¿ç”¨ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•åˆ›å»ºä¸€ä¸ªé¡¶ç‚¹ç¼“å­˜å’Œç´¢å¼•ç¼“å­˜ï¼š1234567891011121314151617HRESULT IDirect3DDevice9::CreateVertexBuffer( UINT Length, DWORD Usage, DWORD FVF, D3DPOOL Pool IDirect3DVertexBuffer9** ppVertexBuffer, HANDLE* pSharedHandle);HRESULT IDirect3DDevice9::CreateIndexBuffer( UINT Length, DWORD Usage, D3DFORMAT Format, D3DPOOL Pool, IDirect3DIndexBuffer9** ppIndexBuffer, HANDLE* pSharedHandle); è¿™ä¸¤ä¸ªæ–¹æ³•å¤§éƒ¨åˆ†å‚æ•°æ˜¯ç›¸åŒçš„ï¼Œå› æ­¤æˆ‘ä»¬ä¸€èµ·ä»‹ç»å®ƒä»¬ã€‚ Length â€”â€” åˆ†é…ç»™ç¼“å­˜çš„å­—èŠ‚å¤§å°ã€‚å‡å¦‚æƒ³å¾—åˆ°ä¸€ä¸ªèƒ½å­˜å‚¨8ä¸ªé¡¶ç‚¹çš„é¡¶ç‚¹ç¼“å­˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦åœ¨é¡¶ç‚¹ç»“æ„ä¸­è®¾ç½®è¿™ä¸ªå‚æ•°ä¸º 8 * sizeof ( Vertex ) ã€‚ Usage â€”â€” æŒ‡å®šå…³äºæ€æ ·ä½¿ç”¨ç¼“å­˜çš„é¢å¤–ä¿¡æ¯ã€‚è¿™ä¸ªå€¼å¯ä»¥æ˜¯0ï¼Œæ²¡æœ‰æ ‡è®°ï¼Œæˆ–è€…æ˜¯ä¸‹é¢æ ‡è®°çš„ä¸€ä¸ªæˆ–å¤šä¸ªçš„ç»„åˆï¼š D3DUSAGE_DYNAMICâ€”â€”è®¾ç½®è¿™ä¸ªå‚æ•°å¯ä»¥ä½¿ç¼“å­˜æ˜¯åŠ¨æ€çš„ã€‚åœ¨ä¸‹ä¸€é¡µè¯´æ˜é™æ€å’ŒåŠ¨æ€ç¼“å­˜ã€‚ D3DUSAGE_POINTSâ€”â€”è¿™ä¸ªå‚æ•°æŒ‡å®šç¼“å­˜å­˜å‚¨åŸå§‹ç‚¹ã€‚åŸå§‹ç‚¹å°†åœ¨ç¬¬14ç« ç²’å­ç³»ç»Ÿä¸­ä»‹ç»ã€‚è¿™ä¸ªå‚æ•°ä»…ä»…ç”¨åœ¨é¡¶ç‚¹ç¼“å†²ä¸­ã€‚ D3DUSAGE_SOFTWAREPROCESSINGâ€”â€”ä½¿ç”¨è½¯ä»¶é¡¶ç‚¹å¤„ç† D3DUSAGE_WRITEONLYâ€”â€”æŒ‡å®šåº”ç”¨ç¨‹åºåªèƒ½å†™ç¼“å­˜ã€‚å®ƒå…è®¸é©±åŠ¨ç¨‹åºåˆ†é…æœ€é€‚åˆçš„å†…å­˜åœ°å€ä½œä¸ºå†™ç¼“å­˜ã€‚æ³¨æ„å¦‚æœä»åˆ›å»ºå¥½çš„è¿™ç§ç¼“å­˜ä¸­è¯»æ•°æ®ï¼Œå°†ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ã€‚ FVF â€”â€” å­˜å‚¨åœ¨ç¼“å­˜ä¸­çš„é¡¶ç‚¹æ ¼å¼ Pool â€”â€” ç¼“å­˜æ”¾ç½®åœ¨å“ªä¸€ä¸ªå†…å­˜æ± ä¸­ ppVertexBuffer â€”â€”è¿”å›åˆ›å»ºå¥½çš„é¡¶ç‚¹ç¼“å­˜çš„æŒ‡é’ˆã€‚ pSharedHandle â€”â€”æ²¡æœ‰ä½¿ç”¨ï¼›è®¾ç½®ä¸º0ã€‚ Format â€”â€”æŒ‡å®šç´¢å¼•çš„å¤§å°ï¼›ä½¿ç”¨D3DFMT_INDEX16è®¾ç½®16ä½ç´¢å¼•ï¼Œä½¿ç”¨D3DFMT_INDEX32è®¾ç½®32ä½ç´¢å¼•ã€‚æ³¨æ„å¹¶éæ‰€æœ‰è®¾å¤‡éƒ½æ”¯æŒ32ä½ç´¢å¼•ï¼›è¯·æ£€æŸ¥è®¾å¤‡èƒ½åŠ›ã€‚ ppIndexBuffer â€”â€”è¿”å›åˆ›å»ºå¥½çš„ç´¢å¼•ç¼“å­˜çš„æŒ‡é’ˆã€‚ æ³¨æ„ï¼šä¸ä½¿ç”¨D3DUSAGE_DYNAMICå‚æ•°åˆ›å»ºçš„ç¼“å­˜è¢«å«åšé™æ€ç¼“å­˜ã€‚é™æ€ç¼“å­˜é€šå¸¸è¢«æ”¾ç½®åœ¨æ˜¾å­˜ä¸­ï¼Œåœ¨å…¶ä¸­çš„æ•°æ®èƒ½è¢«å¾ˆæœ‰æ•ˆçš„å¤„ç†ã€‚ç„¶è€Œï¼Œå¯¹äºé™æ€ç¼“å­˜ï¼Œä»ä¸­è¯»å–å’Œå†™å…¥æ•°æ®æ˜¯å¾ˆæ…¢çš„ï¼Œå› ä¸ºè®¿é—®æ˜¾å­˜æ˜¯å¾ˆæ…¢çš„ã€‚å› ä¸ºè¿™ä¸ªåŸå› æˆ‘ä»¬ç”¨é™æ€ç¼“å­˜å­˜å‚¨é™æ€æ•°æ®ï¼ˆä¸éœ€è¦è¢«ç»å¸¸æ”¹å˜çš„æ•°æ®ï¼‰ã€‚å¯¹äºé™æ€ç¼“å­˜åœ°å½¢å’Œå»ºç­‘ç‰©æ˜¯å¾ˆå¥½çš„åé€‰ä¾‹å­ï¼Œå› ä¸ºåœ¨åº”ç”¨ç¨‹åºä¸­ä»–ä»¬é€šå¸¸ä¸éœ€è¦è¢«æ”¹å˜ã€‚é™æ€ç¼“å­˜åº”è¯¥åœ¨åº”ç”¨ç¨‹åºåˆå§‹è¯çš„æ—¶å€™å°±è¢«å¡«å……å¥½ï¼Œè€Œä¸æ˜¯åœ¨è¿è¡Œæ—¶æ‰åšã€‚ æ³¨æ„ï¼šä½¿ç”¨D3DUSAGE_DYNAMICå‚æ•°åˆ›å»ºçš„ç¼“å­˜è¢«å«åšåŠ¨æ€ç¼“å­˜ã€‚åŠ¨æ€ç¼“å­˜é€šå¸¸è¢«æ”¾åœ¨AGPå†…å­˜ä¸­ï¼Œè¿™ç§å†…å­˜ä¸­çš„æ•°æ®èƒ½è¢«å¾ˆå¿«çš„æ›´æ–°ã€‚å¤„ç†åŠ¨æ€ç¼“å­˜ä¸­çš„æ•°æ®ä¸ä¼šæ¯”å¤„ç†é™æ€ç¼“å­˜ä¸­çš„æ•°æ®å¿«ï¼Œå› ä¸ºè¿™äº›æ•°æ®å¿…é¡»åœ¨æ¸²æŸ“å‰è¢«è½¬ç§»åˆ°æ˜¾å­˜ä¸­ï¼ŒåŠ¨æ€ç¼“å­˜çš„å¥½å¤„æ˜¯å®ƒä»¬èƒ½å¤Ÿè¢«ç¨å¾®å¿«ç‚¹åœ°è¢«æ›´æ–°ï¼ˆæ¯”CPUå†™å¿«ï¼‰ã€‚å› æ­¤ï¼Œå‡å¦‚ä½ éœ€è¦ç»å¸¸æ›´æ–°ç¼“å­˜ä¸­çš„æ•°æ®ï¼Œé‚£ä¹ˆä½ å°±åº”è¯¥ä½¿ç”¨åŠ¨æ€ç¼“å­˜ã€‚å¯¹äºåŠ¨æ€ç¼“å­˜ç²’å­ç³»ç»Ÿæ˜¯å¾ˆå¥½çš„ä¸€ä¸ªåº”ç”¨ï¼Œå› ä¸ºå®ƒä»¬æ˜¯åŠ¨æ€çš„ï¼Œå¹¶ä¸”ä»–ä»¬é€šå¸¸æ¯ä¸€å¸§éƒ½ä¼šè¢«æ›´æ–°ã€‚ æ³¨æ„ï¼šåœ¨ç¨‹åºä¸­è¯»å–æ˜¾å­˜å’ŒAGPå†…å­˜éƒ½æ˜¯éå¸¸æ…¢çš„ã€‚å› æ­¤ï¼Œå‡å¦‚ä½ åœ¨è¿è¡Œæ—¶éœ€è¦è¯»å–ä½ çš„å‡ ä½•ç‰©ä½“ï¼Œæœ€å¥½çš„æ–¹æ¡ˆæ˜¯æŒ‡å®šä¸€å—ç³»ç»Ÿå†…å­˜ï¼Œéƒ½åœ¨å…¶ä¸­æ‹·è´å¹¶ä¸”è¯»å–æ•°æ®ã€‚ ä¸‹è¾¹æ˜¯åˆ›å»ºä¸€ä¸ªé™æ€é¡¶ç‚¹ç¼“å­˜çš„ä¾‹å­ï¼Œè¯¥ç¼“å­˜èƒ½å­˜å‚¨8ä¸ªé¡¶ç‚¹ã€‚12345678IDirect3DVertexBuffer9* vb;device-&gt;CreateVertexBuffer( 8 * sizeof( Vertex ), 0, D3DFVF_XYZ, D3DPOOL_MANAGED, &amp;vb, 0); è®¿é—®ç¼“å†²å†…å­˜ ä¸ºäº†è®¿é—®ä¸€ä¸ªé¡¶ç‚¹/ç´¢å¼•ç¼“å­˜ï¼Œæˆ‘ä»¬éœ€è¦å¾—åˆ°ä¸€ä¸ªæŒ‡é’ˆã€‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæŒ‡é’ˆè·å¾—ç¼“å­˜æ•°æ®å¿…é¡»ä½¿ç”¨Lockæ–¹æ³•ã€‚å½“æˆ‘ä»¬è®¿é—®å®Œç¼“å­˜åå¿…é¡»å¯¹å®ƒè§£é”ã€‚ä¸€æ—¦æœ‰ä¸€ä¸ªæŒ‡å‘å†…å­˜çš„æŒ‡é’ˆï¼Œæˆ‘ä»¬å°±èƒ½å¯¹å®ƒè¿›è¡Œè¯»å†™ã€‚123456789101112HRESULT IDirect3DVertexBuffer9::Lock( UINT OffsetToLock, UINT SizeToLock, BYTE** ppbData, DWORD Flags);HRESULT IDirect3DIndexBuffer9::Lock( UINT OffsetToLock, UINT SizeToLock, BYTE** ppbData, DWORD Flags); å›¾3.1 è¿™ä¸¤ä¸ªæ–¹æ³•çš„å‚æ•°éƒ½æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚ OffsetToLock â€”â€” åç§»é‡ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œä»ç¼“å­˜å¼€å§‹ä½ç½®åˆ°é”å®šå¼€å§‹ä½ç½®çš„è·ç¦»ã€‚å¦‚å›¾3.1ã€‚ SizeToLock â€”â€” é”å®šçš„å­—èŠ‚æ•°ã€‚ ppbData â€”â€” ä¸€ä¸ªæŒ‡å‘é”å®šå†…å­˜å¼€å§‹ä½ç½®çš„æŒ‡é’ˆã€‚ Flags â€”â€” æ ‡è®°æè¿°æ€æ ·é”å®šå†…å­˜ã€‚å®ƒå¯èƒ½æ˜¯0æˆ–è€…æ˜¯ä¸‹é¢å‚æ•°ä¸­çš„1ä¸ªæˆ–å¤šä¸ªçš„ç»„åˆï¼š D3DLOCK_DISCARDâ€”â€”è¿™ä¸ªå‚æ•°ä»…ä»…ä¼šåœ¨åŠ¨æ€ç¼“å­˜æ—¶è¢«ä½¿ç”¨ã€‚å®ƒæŒ‡ç¤ºç¡¬ä»¶ä¸¢å¼ƒç¼“å­˜å¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘æ–°åˆ†é…çš„ç¼“å­˜çš„æŒ‡é’ˆã€‚è¿™æ˜¯å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå½“æˆ‘ä»¬å­˜å–ä¸€ä¸ªæ–°åˆ†é…çš„ç¼“å­˜æ—¶å®ƒå…è®¸ç¡¬ä»¶ç»§ç»­ä»ä¸¢å¼ƒçš„ç¼“å­˜æ¸²æŸ“ã€‚è¿™é˜²æ­¢äº†ç¡¬ä»¶å»¶è¿Ÿã€‚ D3DLOCK_NOOVERWRITEâ€”â€”è¿™ä¸ªå‚æ•°ä»…ä»…ä¼šåœ¨åŠ¨æ€ç¼“å­˜æ—¶è¢«ä½¿ç”¨ã€‚å®ƒå£°æ˜ä½ å°†å‘ç¼“å­˜ä¸­æ·»åŠ æ•°æ®ã€‚å³ï¼Œä½ ä¸èƒ½å‘å·²ç»æ¸²æŸ“çš„å†…å­˜ä¸­å†™æ•°æ®ã€‚è¿™æ˜¯æœ‰å¥½å¤„çš„å› ä¸ºä»–å…è®¸ä½ åœ¨æ·»åŠ æ–°æ•°æ®åˆ°ç¼“å­˜çš„åŒæ—¶è®©ç¡¬ä»¶ç»§ç»­æ¸²æŸ“ã€‚ D3DLOCK_READONLYâ€”â€”è¿™ä¸ªå‚æ•°å£°æ˜ä½ é”å®šçš„ç¼“å­˜åªèƒ½ä»ä¸­è¯»å–æ•°æ®è€Œä¸èƒ½å†™æ•°æ®ã€‚è¿™å…è®¸ä¸€äº›å†…åœ¨çš„ä¼˜åŒ–ã€‚ ç”¨å‚æ•°D3DLOCK_DISCARDå’ŒD3DLOCK_NOOVERWRITEçš„åœ°å€å®é™…ä¸Šå°±æ˜¯ç¼“å­˜çš„ä¸€éƒ¨åˆ†è¢«ä½¿ç”¨ï¼ˆæ­£åœ¨æ¸²æŸ“ï¼‰æ—¶å®ƒè¢«é”å®šã€‚å‡å¦‚æƒ…å†µå…è®¸è¿™äº›æ ‡è®°è¢«ä½¿ç”¨ï¼Œå½“åœ¨é”å®šæ—¶ä»–ä»¬é˜²æ­¢æ¸²æŸ“åœæ­¢ã€‚ ä¸‹è¾¹çš„ä¾‹å­å±•ç¤ºäº†é€šå¸¸æ€æ ·ä½¿ç”¨Lockæ–¹æ³•ã€‚æ³¨æ„å½“æˆ‘ä»¬ä½¿ç”¨å®Œä»¥åè¦è°ƒç”¨Unlockæ–¹æ³•ã€‚Vertex vertices;_vb-&gt;Lock(0, 0, (void*)&amp;vertices, 0); // é”å®šæ•´ä¸ªç¼“å­˜vertices[0] = Vertex(-1.0f, 0.0f, 2.0f); // å‘ç¼“å­˜é‡Œå†™é¡¶ç‚¹vertices[1] = Vertex( 0.0f, 1.0f, 2.0f);vertices[2] = Vertex( 1.0f, 0.0f, 2.0f);_vb-&gt;Unlock(); // å½“ä½ è®¿é—®å®Œç¼“å­˜æ—¶ï¼Œè§£é”ç¼“å­˜3.1.3 æ‰¾å›é¡¶ç‚¹å’Œç´¢å¼•ç¼“å­˜ä¿¡æ¯æœ‰æ—¶æˆ‘ä»¬éœ€è¦å¾—åˆ°é¡¶ç‚¹/ç´¢å¼•ç¼“å­˜ä¿¡æ¯ã€‚ä¸‹é¢çš„ä¾‹å­ç¤ºèŒƒäº†ç”¨äºè·å¾—è¿™äº›ä¿¡æ¯çš„æ–¹æ³•ï¼šD3DVERTEXBUFFER_DESC vbDescription;_vertexBuffer-&gt;GetDesc(&amp;vbDescription); // å–å¾—é¡¶ç‚¹ç¼“å­˜ä¿¡æ¯ D3DINDEXBUFFER_DESC ibDescription;_indexBuffer-&gt;GetDesc(&amp;ibDescription); //å–å¾—ç´¢å¼•ç¼“å­˜ä¿¡æ¯ D3DVERTEXBUFFER_DESCå’ŒD3DINDEXBUFFER_DESCç»“æ„çš„å®šä¹‰å¦‚ä¸‹ï¼štypedef struct _D3DVERTEXBUFFER_DESC { D3DFORMAT Format; D3DRESOURCETYPE Type; DWORD Usage; D3DPOOL Pool; UINT Size; DWORD FVF;} D3DVERTEXBUFFER_DESC; typedef struct _D3DINDEXBUFFER_DESC { D3DFORMAT Format; D3DRESOURCETYPE Type; DWORD Usage; D3DPOOL Pool; UINT Size;} D3DINDEXBUFFER_DESC;3.2 æ¸²æŸ“çŠ¶æ€ Direct3Dæä¾›äº†å¤šç§æ¸²æŸ“çŠ¶æ€ï¼Œå®ƒå½±å“å‡ ä½•ç‰©ä½“æ€æ ·è¢«æ¸²æŸ“ã€‚æ¸²æŸ“çŠ¶æ€æœ‰é»˜è®¤å€¼ï¼Œå› æ­¤å‡å¦‚ä½ çš„åº”ç”¨ç¨‹åºéœ€è¦ä¸åŒäºé»˜è®¤è®¾ç½®çš„æ¸²æŸ“æ—¶ï¼Œä½ ä»…ä»…æ”¹å˜å®ƒå³å¯ã€‚ä¸€ç§æ¸²æŸ“æ•ˆæœä¼šä¸€ç›´èµ·ä½œç”¨ï¼Œç›´åˆ°ä½ ä¸‹ä¸€æ¬¡æ”¹å˜æ¸²æŸ“çŠ¶æ€ä¸ºæ­¢ã€‚ä¸ºäº†è®¾ç½®ä¸€ä¸ªæ¸²æŸ“çŠ¶æ€ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼šHRESULT IDirect3DDevice9::SetRenderState( D3DRENDERSTATETYPE State, // æ›´æ”¹çš„æ¸²æŸ“çŠ¶æ€ DWORD Value // æ–°çš„çŠ¶æ€å€¼); ä¾‹å¦‚ï¼Œåœ¨è¿™ä¸€ç« çš„ä¾‹å­ä¸­æˆ‘ä»¬å°†ä½¿ç”¨çº¿æ¡†æ¨¡å¼æ¸²æŸ“æˆ‘ä»¬çš„ç‰©ä½“ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è®¾ç½®å¦‚ä¸‹çš„æ¸²æŸ“çŠ¶æ€ï¼š_device-&gt;SetRenderState(D3DRS_FILLMODE, D3DFILL_WIREFRAME);æ³¨æ„ï¼šæŸ¥çœ‹DirectX SDKä¸­å…³äºD3DRENDERSTATETYPEçš„ä¿¡æ¯ã€‚å…¶ä¸­è¯¦ç»†ä»‹ç»äº†æ‰€æœ‰çš„æ¸²æŸ“çŠ¶æ€ã€‚3.3 ç»˜åˆ¶å‡†å¤‡ ä¸€æ—¦æˆ‘ä»¬åˆ›å»ºå¥½ä¸€ä¸ªé¡¶ç‚¹ç¼“å­˜ä»¥åŠä¸€ä¸ªç´¢å¼•ç¼“å­˜ï¼ˆå¯é€‰çš„ï¼‰åï¼Œæˆ‘ä»¬å°±ä¸ºæ¸²æŸ“å…¶ä¸­çš„å†…å®¹å‡†å¤‡å¾—å·®ä¸å¤šäº†ï¼Œä½†æ˜¯åœ¨æ¸²æŸ“å‰æˆ‘ä»¬è¿˜æœ‰3ä¸ªæ­¥éª¤å¿…é¡»å…ˆåšã€‚1ã€ è®¾ç½®èµ„æºæµã€‚è®¾ç½®èµ„æºæµä¸ä¸€ä¸ªé¡¶ç‚¹ç¼“å­˜æŒ‚é’©ï¼Œæ­¤æµå°±æ˜¯ä¸€ä¸ªæµå…¥æ¸²æŸ“ç®¡çº¿çš„å‡ ä½•ä¿¡æ¯çš„æµã€‚ ä¸‹é¢çš„æ–¹æ³•æ˜¯ç”¨äºè®¾ç½®ä¸€ä¸ªèµ„æºæµï¼šHRESULT IDirect3DDevice9::SetStreamSource( UINT StreamNumber, IDirect3DVertexBuffer9* pStreamData, UINT OffsetInBytes, UINT Stride); StreamNumberâ€”â€”ç¡®å®šæˆ‘ä»¬çš„é¡¶ç‚¹ç¼“å­˜ä¸å“ªä¸€ä¸ªèµ„æºæµæŒ‚é’©ã€‚åœ¨è¿™æœ¬ä¹¦ä¸­æˆ‘ä»¬ä¸ä½¿ç”¨å¤šé‡æµï¼›å› æ­¤æˆ‘ä»¬æ€»æ˜¯ä½¿ç”¨0å·æµã€‚ pStreamDataâ€”â€”ä¸€ä¸ªæŒ‡å‘æˆ‘ä»¬æƒ³ä¸æµæŒ‚é’©çš„é‚£ä¸ªé¡¶ç‚¹ç¼“å­˜çš„æŒ‡é’ˆã€‚ OffsetInBytesâ€”â€”ç›¸å¯¹æµå¼€å§‹å¤„çš„åç§»é‡ã€‚ä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œå®ƒæŒ‡å®šè¢«å¡«å…¥æ¸²æŸ“ç®¡çº¿çš„é¡¶ç‚¹æ•°æ®çš„å¼€å§‹ä½ç½®ã€‚é€šè¿‡æ£€æŸ¥D3DCAPS9ç»“æ„ä¸­çš„D3DDEVCAPS2_STREAMOFFSETæ ‡å¿—ï¼Œå‡å¦‚ä½ çš„è®¾å¤‡æ”¯æŒï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°å°±æœ‰ä¸€äº›é0å€¼ã€‚ Strideâ€”â€”æˆ‘ä»¬åœ¨é¡¶ç‚¹ç¼“å­˜ä¸­æ“ä½œçš„æ¯ä¸ªéƒ¨åˆ†çš„æµçš„å­—èŠ‚å¤§å°ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾vbæ˜¯ä¸€ä¸ªå·²ç»å¡«å……äº†é¡¶ç‚¹ä¿¡æ¯çš„é¡¶ç‚¹ç¼“å­˜ï¼š_device-&gt;SetStreamSource( 0, vb, 0, sizeof( Vertex ) ); 2ã€ è®¾ç½®é¡¶ç‚¹æ ¼å¼ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬æŒ‡å®šåé¢ç”¨æ¥ç»˜å›¾è°ƒç”¨çš„é¡¶ç‚¹çš„é¡¶ç‚¹æ ¼å¼ã€‚_device-&gt;SetFVF( D3DFVF_XYZ | D3DFVF_DIFFUSE | D3DFVF_TEX1 ); 3ã€ è®¾ç½®ç´¢å¼•ç¼“å­˜ã€‚å‡å¦‚æˆ‘ä»¬ä½¿ç”¨äº†ç´¢å¼•ç¼“å­˜ï¼Œæˆ‘ä»¬å¿…é¡»è®¾ç½®åé¢è¦ç”¨äºç»˜åˆ¶æ“ä½œçš„ç´¢å¼•ç¼“å­˜ã€‚æ¯æ¬¡æˆ‘ä»¬åªèƒ½ä½¿ç”¨ä¸€ä¸ªç´¢å¼•ç¼“å­˜ï¼›å› æ­¤å‡å¦‚ä½ éœ€è¦ç”¨ä¸€ä¸ªä¸åŒçš„ç´¢å¼•ç¼“å­˜ç»˜åˆ¶ä¸€ä¸ªç‰©ä½“æ—¶ï¼Œä½ å¿…é¡»è½¬æ¢åˆ°å¦ä¸€ä¸ªä¸Šã€‚ä¸‹é¢çš„ä»£ç è®¾ç½®ä¸€ä¸ªç´¢å¼•ç¼“å­˜ï¼š_device-&gt;SetIndices( _ib ); // ä¼ é€’ä¸€ä¸ªç´¢å¼•ç¼“å­˜æŒ‡é’ˆçš„æ‹·è´3.4ç”¨é¡¶ç‚¹/ç´¢å¼•ç¼“å­˜ç»˜åˆ¶ åœ¨æˆ‘ä»¬åˆ›å»ºå¥½é¡¶ç‚¹/ç´¢å¼•ç¼“å­˜ä»¥åŠåšå¥½å‡†å¤‡å·¥ä½œä»¥åï¼Œæˆ‘ä»¬å°±èƒ½ç»˜åˆ¶æˆ‘ä»¬çš„å‡ ä½•ç‰©ä½“äº†ã€‚è¿™æ˜¯é€šè¿‡ä½¿ç”¨DrawPrimitiveæˆ–è€…DrawIndexedPrimitiveä¼ é€å‡ ä½•ä¿¡æ¯åˆ°è¾¾æ¸²æŸ“ç®¡çº¿ã€‚è¿™äº›æ–¹æ³•ä»é¡¶ç‚¹æµä¸­è·å¾—é¡¶ç‚¹ä¿¡æ¯ä»¥åŠä»ç´¢å¼•ç¼“å­˜ä¸­è·å¾—ç´¢å¼•ä¿¡æ¯ã€‚3.4.1 IDirect3DDevice9::DrawPrimitive è¿™ä¸ªæ–¹æ³•ä¸ä½¿ç”¨ç´¢å¼•ä¿¡æ¯ç»˜åˆ¶å›¾å…ƒã€‚HRESULT IDirect3DDevice9::DrawPrimitive( D3DPRIMITIVETYPE PrimitiveType, UINT StartVertex, UINT PrimitiveCount); PrimitiveTypeâ€”â€”æˆ‘ä»¬ç»˜åˆ¶çš„å›¾å…ƒç±»å‹ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬èƒ½ç»˜åˆ¶ç‚¹å’Œçº¿ä»¥åŠä¸‰è§’å½¢ã€‚ä»¥åæˆ‘ä»¬ä½¿ç”¨ä¸‰è§’å½¢ï¼Œç”¨D3DPT_TRIANGLELISTå‚æ•°ã€‚ StartVertexâ€”â€”ç´¢å¼•åˆ°åœ¨é¡¶ç‚¹æµä¸­çš„ä¸€ä¸ªå…ƒç´ ã€‚è®¾ç½®æ¸²æŸ“é¡¶ç‚¹ä¸­çš„å¼€å§‹ç‚¹ã€‚è¿™ä¸ªå‚æ•°ç»™äºˆæˆ‘ä»¬ä¸€å®šçš„æœºåŠ¨æ€§ï¼Œå¯ä»¥ç»˜åˆ¶ä¸€ä¸ªé¡¶ç‚¹ç¼“å­˜ä¸­çš„æŸéƒ¨åˆ†ã€‚ PrimitiveCountâ€”â€”ç»˜åˆ¶å›¾å…ƒçš„ä¸ªæ•°ã€‚ ä¾‹å­ï¼š// ç»˜åˆ¶4ä¸ªä¸‰è§’å½¢_device-&gt;DrawPrimitive( D3DPT_TRIANGLELIST, 0, 4);3.4.2 IDirect3DDevice9::DrawIndexedPrimitive è¿™ä¸ªæ–¹æ³•ä½¿ç”¨ç´¢å¼•ä¿¡æ¯æ¥ç»˜åˆ¶å›¾å…ƒã€‚HRESULT IDirect3DDevice9::DrawIndexedPrimitive( D3DPRIMITIVETYPE Type, INT BaseVertexIndex, UINT MinIndex, UINT NumVertices, UINT StartIndex, UINT PrimitiveCount); Typeâ€”â€”æˆ‘ä»¬ç»˜åˆ¶çš„å›¾å…ƒç±»å‹ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬èƒ½ç»˜åˆ¶ç‚¹å’Œçº¿ä»¥åŠä¸‰è§’å½¢ã€‚ä»¥åæˆ‘ä»¬ä½¿ç”¨ä¸‰è§’å½¢ï¼Œç”¨D3DPT_TRIANGLELISTå‚æ•°ã€‚ BaseVertexIndexâ€”â€”ä¸€ä¸ªåŸºæœ¬æ•°å­—ï¼Œåœ¨è°ƒç”¨ä¸­ç”¨å®ƒå»åŠ ä¸Šç´¢å¼•ã€‚å‚çœ‹ä¸‹é¢çš„è¯´æ˜ã€‚ MinIndexâ€”â€”å°†è¢«å¼•ç”¨çš„æœ€å°ç´¢å¼•å€¼ã€‚ NumVerticesâ€”â€”åœ¨æ­¤è°ƒç”¨ä¸­å°†è¢«å¼•ç”¨çš„é¡¶ç‚¹æ•°ã€‚ StartIndexâ€”â€”ç´¢å¼•åˆ°ç´¢å¼•ç¼“å­˜ä¸­çš„æŸä¸ªä½ç½®ï¼Œå®ƒæ ‡è®°å¼€å§‹æ¸²æŸ“çš„å¼€å§‹ç´¢å¼•ç‚¹ã€‚ PrimitiveCountâ€”â€”ç»˜åˆ¶å›¾å…ƒçš„ä¸ªæ•°ã€‚ ä¾‹å­ï¼š_device-&gt;DrawIndexedPrimitive(D3DPT_TRIANGLELIST, 0, 0, 8, 0, 12);æ³¨æ„ï¼šBaseVertexIndexå‚æ•°éœ€è¦ä¸€äº›ç‰¹åˆ«çš„è§£é‡Šã€‚åœ¨è§£é‡Šè¿‡ç¨‹ä¸­å°†ä¼šç”¨åˆ°çš„å›¾3.2ã€‚ å›¾3.2 åœ¨ç´¢å¼•ç¼“å­˜ä¸­å®šä½é¡¶ç‚¹ç›¸åº”çš„ä¹Ÿå°±åœ¨é¡¶ç‚¹ç¼“å­˜ä¸­å®šä½äº†ã€‚ç„¶è€Œï¼Œå‡è®¾æˆ‘ä»¬æƒ³å°†çƒï¼Œç›’å­ï¼Œåœ†æŸ±ä½“çš„é¡¶ç‚¹æ”¾ç½®åˆ°ä¸€ä¸ªå…¬å…±çš„é¡¶ç‚¹ç¼“å­˜ä¸­ã€‚å¯¹äºæ¯ä¸€ä¸ªç‰©ä½“ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸å†è®¡ç®—åœ¨å…¬å…±é¡¶ç‚¹ç¼“å­˜ä¸­çš„ç´¢å¼•ã€‚è¿™ä¸ªæ–°çš„ç´¢å¼•å€¼æ˜¯é€šè¿‡ä¸ä¸€ä¸ªåç§»é‡ç›¸åŠ å¾—åˆ°ã€‚æ³¨æ„è¿™ä¸ªåç§»é‡æ˜¯æ ‡å‡†çš„é¡¶ç‚¹ï¼Œè€Œä¸æ˜¯å­—èŠ‚ã€‚ æˆ‘ä»¬éœ€è¦è®¡ç®—ç‰©ä½“åœ¨å…¬å…±é¡¶ç‚¹ç¼“å­˜ä¸­çš„ç´¢å¼•å€¼ã€‚Direct3Då…è®¸æˆ‘ä»¬é€šè¿‡è®¾ç½®BaseVertexIndexå‚æ•°å¾—åˆ°ä¸€ä¸ªé¡¶ç‚¹åç§»é‡ï¼ŒéšåDirect3Då°±èƒ½åˆ©ç”¨é¡¶ç‚¹è‡ªèº«çš„ç´¢å¼•é‡æ–°è®¡ç®—æ–°çš„ç´¢å¼•ã€‚3.4.3 å¼€å§‹/ç»“æŸåœºæ™¯ æœ€åä¸€ç‚¹å°±æ˜¯æ‰€æœ‰ç»˜åˆ¶æ–¹æ³•éƒ½å¿…é¡»åœ¨IDirect3DDevice9::BeginSceneå’ŒIDirect3DDevice9::EndSceneæ–¹æ³•ä¹‹é—´è¢«è°ƒç”¨ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†è¿™æ ·å†™ï¼š_device-&gt;BeginScene(); // ç»˜åˆ¶åœºæ™¯ _device-&gt;DrawPrimitive(â€¦);_device-&gt;EndScene();3.5 D3DXå‡ ä½•ç‰©ä½“ é€šè¿‡åœ¨ä»£ç ä¸­å»ºé€ æ¯ä¸ªä¸‰è§’å½¢æ¥å»ºé€ 3Dç‰©ä½“æ˜¯ä¸€ä»¶éå¸¸æ¯ç‡¥çš„äº‹ã€‚å¹¸è¿çš„æ˜¯ï¼ŒD3DXåº“å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€äº›æ–¹æ³•æ¥äº§ç”Ÿç®€å•3Dç‰©ä½“çš„ç½‘æ ¼æ•°æ®ã€‚ D3DXåº“æä¾›å¦‚ä¸‹6ç§ç½‘æ ¼ç”Ÿæˆå‡½æ•°ã€‚ D3DXCreateBox D3DXCreateSphere D3DXCreateCylinder D3DXCreateTeapot D3DXCreatePolygon D3DXCreateTorus å›¾3.3 è¿™6ç§å‡½æ•°çš„ä½¿ç”¨éƒ½å¾ˆç±»ä¼¼ï¼Œå¹¶ä¸”ä½¿ç”¨D3DXç½‘æ ¼æ•°æ®ç»“æ„ID3DXMeshå°±è±¡ä½¿ç”¨ID3DXBufferæ¥å£ä¸€æ ·ã€‚è¿™äº›æ¥å£å›åœ¨ç¬¬10ç« å’Œ11ç« ä¸­è®²è§£ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¿½è§†å®ƒä»¬çš„è¯¦ç»†ä¿¡æ¯ï¼Œåªéœ€ç®€å•ä½¿ç”¨å®ƒä»¬å³å¯ã€‚HRESULT D3DXCreateTeapot( LPDIRECT3DDEVICE9 pDevice, // ä¸meshå…³è”çš„è®¾å¤‡ LPD3DXMESH ppMesh, // è¿”å›çš„mesh LPD3DXBUFFER ppAdjacency // ç°åœ¨è®¾æˆ0); ä¸€ä¸ªä½¿ç”¨D3DXCreateTeapotå‡½æ•°çš„ä¾‹å­ï¼šID3DXMesh mesh = 0;D3DXCreateTeapot(_device, &amp;mesh, 0); ä¸€æ—¦ç”Ÿæˆäº†ç½‘æ ¼æ•°æ®ï¼Œæˆ‘ä»¬å°±èƒ½ä½¿ç”¨ID3DXMesh::DrawSubsetæ–¹æ³•ç»˜åˆ¶å›¾å½¢äº†ã€‚è¿™ä¸ªæ–¹æ³•æœ‰ä¸€ä¸ªå‚æ•°ï¼Œå®ƒç”¨æ¥è¯†åˆ«ç½‘æ ¼çš„ä¸€ä¸ªå­é›†ã€‚è¿™ä¸ªç½‘æ ¼æ˜¯é€šè¿‡ä¸Šé¢çš„D3DXCreateå‡½æ•°ä¸­çš„ä¸€ä¸ªå­é›†åˆ›å»ºçš„ï¼Œå› æ­¤å¯ä»¥ç»™è¿™ä¸ªå‚æ•°æŒ‡å®š0å€¼ã€‚ä¸€ä¸ªæ¸²æŸ“ç½‘æ ¼çš„ä¾‹å­ï¼š_device-&gt;BeginScene(); mesh-&gt;DrawSubset(0);_device-&gt;EndScene(); ä½¿ç”¨äº†ç½‘æ ¼ä»¥åï¼Œå¿…é¡»é‡Šæ”¾ï¼ˆreleaseï¼‰å®ƒï¼šmesh-&gt;Release();_mesh = 0;3.6 å®ä¾‹ç¨‹åºï¼šä¸‰è§’å½¢ã€ç«‹æ–¹ä½“ã€èŒ¶å£¶ã€D3DXCreate* è¿™é‡Œæœ‰4ä¸ªä¾‹å­ã€‚ ä¸‰è§’å½¢â€”â€”è¿™æ˜¯éå¸¸ç®€å•çš„åº”ç”¨ç¨‹åºï¼Œå®ƒç¤ºèŒƒäº†åœ¨çº¿æ¡†æ¨¡å¼ä¸‹æ€æ ·åˆ›å»ºå¹¶æ¸²æŸ“ä¸€ä¸ªä¸‰è§’å½¢ã€‚ ç«‹æ–¹ä½“â€”â€”åªæ¯”ä¸‰è§’å½¢ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œè¿™ä¸ªç¨‹åºæ¸²æŸ“ä¸€ä¸ªçº¿æ¡†ç«‹æ–¹ä½“ã€‚ èŒ¶å£¶â€”â€”è¿™ä¸ªç¨‹åºä½¿ç”¨D3DXCreateTeapotå‡½æ•°åˆ›å»ºå¹¶æ¸²æŸ“ä¸€ä¸ªçººçº±èŒ¶å£¶ã€‚ D3DXCreateâ€”â€”è¿™ä¸ªç¨‹åºåˆ›å»ºå¹¶æ¸²æŸ“å‡ ç§ä¸åŒçš„èƒ½å¤Ÿä½¿ç”¨D3DXCreate*å‡½æ•°åˆ›å»ºçš„3Dç‰©ä½“ã€‚è®©æˆ‘ä»¬ç®€å•è®¨è®ºä¸€ä¸‹åˆ›å»ºç«‹æ–¹ä½“çš„ä¾‹å­ã€‚é€šè¿‡å¯¹å®ƒçš„å­¦ä¹ ä½ è‡ªå·±å°±èƒ½å¾ˆå¿«åœ°ç†è§£å…¶ä»–ä¾‹å­ã€‚ è¿™ä¸ªç®€å•çš„ç»˜åˆ¶å’Œæ¸²æŸ“ç«‹æ–¹ä½“çš„ç¨‹åºçš„è¿è¡Œç»“æœå¦‚å›¾3.4ã€‚ å›¾3.4 é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸‹è¾¹ä¸¤ä¸ªå…¨å±€å˜é‡æ¥ä¿å­˜ç«‹æ–¹ä½“çš„é¡¶ç‚¹å’Œç´¢å¼•æ•°æ®ï¼šIDirect3DVertexBuffer9 VB = 0;IDirect3DIndexBuffer9 IB = 0; ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å®šä¹‰ä¸¤ä¸ªå…¨å±€å¸¸é‡ï¼Œç”±å®ƒä»¬æ¥æŒ‡å®šæˆ‘ä»¬çš„å±å¹•å¤§å°ï¼šconst int Width = 800;const int Height = 600; æ¥ä¸‹æ¥å®šä¹‰æˆ‘ä»¬çš„é¡¶ç‚¹ç»“æ„ä»¥åŠç»“æ„ä¸­é¡¶ç‚¹çš„æ ¼å¼ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­é¡¶ç‚¹ç»“æ„åªä¿å­˜é¡¶ç‚¹çš„ä½ç½®ä¿¡æ¯ï¼š1234567891011struct Vertex&#123; Vertex()&#123;&#125; Vertex(float x, float y, float z) &#123; _x = x; _y = y; _z = z; &#125; float _x, _y, _z; static const DWORD FVF;&#125;;const DWORD Vertex::FVF = D3DFVF_XYZ; è®©æˆ‘ä»¬æŠŠå®ƒè¿ç§»åˆ°æ¡†æ¶ç¨‹åºï¼ˆè§1.53èŠ‚ï¼‰ä¸Šã€‚Setupå‡½æ•°åˆ›å»ºé¡¶ç‚¹å’Œç´¢å¼•ç¼“å­˜ï¼Œé”å®šå®ƒä»¬ï¼ŒæŠŠæ„æˆç«‹æ–¹ä½“çš„é¡¶ç‚¹å†™å…¥é¡¶ç‚¹ç¼“å­˜ï¼Œä»¥åŠæŠŠå®šä¹‰ç«‹æ–¹ä½“çš„ä¸‰è§’å½¢çš„ç´¢å¼•å†™å…¥ç´¢å¼•ç¼“å­˜ã€‚ç„¶åæŠŠæ‘„è±¡æœºå‘åç§»åŠ¨å‡ ä¸ªå•ä½ä»¥ä¾¿æˆ‘ä»¬èƒ½å¤Ÿçœ‹è§åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­åŸç‚¹å¤„è¢«æ¸²æŸ“çš„ç«‹æ–¹ä½“ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889bool Setup()&#123; // åˆ›å»ºé¡¶ç‚¹ã€ç´¢å¼•ç¼“å­˜ Device-&gt;CreateVertexBuffer( 8 * sizeof(Vertex), D3DUSAGE_WRITEONLY, Vertex::FVF, D3DPOOL_MANAGED, &amp;VB, 0); Device-&gt;CreateIndexBuffer( 36 * sizeof(WORD), D3DUSAGE_WRITEONLY, D3DFMT_INDEX16, D3DPOOL_MANAGED, &amp;IB, 0); // å‘ç«‹æ–¹ä½“çš„é¡¶ç‚¹ç¼“å­˜å¡«å……æ•°æ® Vertex* vertices; VB-&gt;Lock(0, 0, (void**)&amp;vertices, 0); // vertices of a unit cube vertices[0] = Vertex(-1.0f, -1.0f, -1.0f); vertices[1] = Vertex(-1.0f, 1.0f, -1.0f); vertices[2] = Vertex( 1.0f, 1.0f, -1.0f); vertices[3] = Vertex( 1.0f, -1.0f, -1.0f); vertices[4] = Vertex(-1.0f, -1.0f, 1.0f); vertices[5] = Vertex(-1.0f, 1.0f, 1.0f); vertices[6] = Vertex( 1.0f, 1.0f, 1.0f); vertices[7] = Vertex( 1.0f, -1.0f, 1.0f); VB-&gt;Unlock(); // å®šä¹‰ç«‹æ–¹ä½“çš„ä¸‰è§’å½¢ WORD* indices = 0; IB-&gt;Lock(0, 0, (void**)&amp;indices, 0); // å‰é¢ indices[0] = 0; indices[1] = 1; indices[2] = 2; indices[3] = 0; indices[4] = 2; indices[5] = 3; // èƒŒé¢ indices[6] = 4; indices[7] = 6; indices[8] = 5; indices[9] = 4; indices[10] = 7; indices[11] = 6; // å·¦é¢ indices[12] = 4; indices[13] = 5; indices[14] = 1; indices[15] = 4; indices[16] = 1; indices[17] = 0; // å³é¢ indices[18] = 3; indices[19] = 2; indices[20] = 6; indices[21] = 3; indices[22] = 6; indices[23] = 7; // é¡¶éƒ¨ indices[24] = 1; indices[25] = 5; indices[26] = 6; indices[27] = 1; indices[28] = 6; indices[29] = 2; // åº•éƒ¨ indices[30] = 4; indices[31] = 0; indices[32] = 3; indices[33] = 4; indices[34] = 3; indices[35] = 7; IB-&gt;Unlock(); // ç…§ç›¸æœºä½ç½®ï¼ˆè§†å›¾çŸ©é˜µï¼‰ D3DXVECTOR3 position(0.0f, 0.0f, -5.0f); D3DXVECTOR3 target(0.0f, 0.0f, 0.0f); D3DXVECTOR3 up(0.0f, 1.0f, 0.0f); D3DXMATRIX V; D3DXMatrixLookAtLH(&amp;V, &amp;position, &amp;target, &amp;up); Device-&gt;SetTransform(D3DTS_VIEW, &amp;V); // æŠ•å½±çŸ©é˜µ D3DXMATRIX proj; D3DXMatrixPerspectiveFovLH( &amp;proj, D3DX_PI * 0.5f, // 90 - degree (float)Width / (float)Height, 1.0f, 1000.0f); Device-&gt;SetTransform(D3DTS_PROJECTION, &amp;proj); // æ¸²æŸ“çŠ¶æ€ï¼ˆå¡«å……æ¨¡å¼ï¼šæ¡†æ¶å¡«å……ï¼‰ Device-&gt;SetRenderState(D3DRS_FILLMODE, D3DFILL_WIREFRAME); return true;&#125; Displayæ–¹æ³•æœ‰ä¸¤ä¸ªä»»åŠ¡ï¼›å®ƒå¿…é¡»æ›´æ–°åœºæ™¯å¹¶ä¸”ç´§æ¥ç€æ¸²æŸ“å®ƒã€‚æ—¢ç„¶æƒ³æ—‹è½¬ç«‹æ–¹ä½“ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å¯¹æ¯ä¸€å¸§å¢åŠ ä¸€ä¸ªè§’åº¦ä½¿ç«‹æ–¹ä½“èƒ½åœ¨è¿™ä¸€å¸§æ—‹è½¬ã€‚å¯¹äºè¿™æ¯ä¸€å¸§ï¼Œç«‹æ–¹ä½“å°†è¢«æ—‹è½¬ä¸€ä¸ªå¾ˆå°çš„è§’åº¦ï¼Œè¿™æ ·æˆ‘ä»¬çœ‹èµ·æ¥æ—‹è½¬å°±ä¼šæ›´å¹³æ»‘ã€‚æ¥ç€æˆ‘ä»¬ä½¿ç”¨IDirect3DDevice9::DrawIndexedPrimitiveæ–¹æ³•æ¥ç»˜åˆ¶ç«‹æ–¹ä½“ã€‚123456789101112131415161718192021222324252627282930313233343536373839bool Display(float timeDelta)&#123; if( Device ) &#123; // æ—‹è½¬ç«‹æ–¹ä½“ D3DXMATRIX Rx, Ry; // xè½´æ—‹è½¬45å¼§åº¦ D3DXMatrixRotationX(&amp;Rx, 3.14f / 4.0f); // æ¯ä¸€å¸§ä¸­å¢åŠ yè½´çš„å¼§åº¦ static float y = 0.0f; D3DXMatrixRotationY(&amp;Ry, y); y += timeDelta; //å½“yè½´æ—‹è½¬2å‘¨æ—¶ï¼Œé‡æ–°å›åˆ°0å¼§åº¦ if( y &gt;= 6.28f ) y = 0.0f; // ç»“åˆxè½´ä¸yè½´çš„æ—‹è½¬çŸ©é˜µ D3DXMATRIX p = Rx * Ry; Device-&gt;SetTransform(D3DTS_WORLD, &amp;p); // æ¸…ç©ºç›®æ ‡ç¼“å­˜å’Œæ·±åº¦ç¼“å­˜ï¼ˆç”¨0xffffffff, 1.0fï¼‰ Device-&gt;Clear(0, 0, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER, 0xffffffff, 1.0f, 0); Device-&gt;BeginScene(); // å¼€å§‹ç»˜åˆ¶åœºæ™¯ Device-&gt;SetStreamSource(0, VB, 0, sizeof(Vertex)); // è®¾ç½®èµ„æºæµ Device-&gt;SetIndices(IB); // è®¾ç½®ç´¢å¼•ç¼“å­˜ Device-&gt;SetFVF(Vertex::FVF); // è®¾ç½®é¡¶ç‚¹æ ¼å¼ // åˆ©ç”¨ç´¢å¼•ç¼“å­˜ç»˜åˆ¶ Device-&gt;DrawIndexedPrimitive(D3DPT_TRIANGLELIST, 0, 0, 8, 0, 12); Device-&gt;EndScene(); // ç»“æŸç»˜åˆ¶åœºæ™¯ Device-&gt;Present(0, 0, 0, 0); // ç¿»è½¬è¡¨é¢ &#125; return true;&#125; æœ€åï¼Œæˆ‘ä»¬é‡Šæ”¾ä½¿ç”¨è¿‡çš„æ‰€æœ‰å†…å­˜ã€‚è¿™æ„å‘³ç€é‡Šæ”¾é¡¶ç‚¹å’Œç´¢å¼•ç¼“å­˜æ¥å£ï¼š12345void Cleanup()&#123; d3d::Release&lt;IDirect3DVertexBuffer9*&gt;(VB); d3d::Release&lt;IDirect3DIndexBuffer9*&gt;(IB);&#125;]]></content>
      <categories>
        <category>Direct3D</category>
      </categories>
      <tags>
        <tag>å›¾å½¢å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å›¾å½¢å­¦ä¹ æ­¥éª¤]]></title>
    <url>%2F2019%2F04%2F11%2Fgraphics-learn-step%2F</url>
    <content type="text"><![CDATA[3Då›¾å½¢å­¦åˆ†3å¤§å—çš„å­¦ä¹ å†…å®¹:a.ç©ºé—´å‡ ä½•æ•°å­¦: ç©ºé—´å‡ ä½•å˜æ¢, åŠ é€Ÿç®—æ³•, å¤šè¾¹å½¢æŠ€æœ¯, æ›²çº¿å’Œæ›²é¢, ç›¸äº¤æµ‹è¯•, ç¢°æ’æµ‹è¯•ã€‚b.å…‰ç…§ç€è‰²ç³»ç»Ÿ: å…‰ç…§, çº¹ç†è´´å›¾, é«˜çº§è±¡ç´ ç€è‰²å…‰ç…§, è‰ºæœ¯æ€§æ¸²æŸ“.c.ç¨‹åºæŠ€æœ¯æ€§åº”ç”¨: å…¬å‘Šæ¿, ç²¾çµ, å¤©ç©ºç›’, ä½“ç»˜åˆ¶, æè´¨ç³»ç»Ÿ, åœºæ™¯å›¾, æ¸²æŸ“é˜Ÿåˆ— åœ¨å®é™…å­¦ä¹ è¿‡ç¨‹ä¸­,3ä¸ªéƒ¨åˆ†ç›¸äº’åˆ¶çº¦,æ•…ä¸èƒ½å•æ–¹é¢çªè¿›,åº”ä¿æŒä¸€ç§å¹³è¡¡å‘å±•,ä½¿å¾—ç›¸äº’ä¿ƒè¿›,æ·±åŒ–ç†è§£,è¾¾åˆ°æ¯”è¾ƒæµç•…çš„å­¦ä¹ æ›²çº¿. ç›¸å¯¹é‡è¦æ€§ä»¥a,b,cåºå‡(æ—¶é—´å°†æ— æƒ…æ·˜æ±°ç°æœ‰çš„ç¨‹åºæŠ€æœ¯æ€§åº”ç”¨),æ·±åˆ»æŒæ¡å›¾å½¢å­¦åŸºç¡€æ‰æ˜¯ç‹é“ã€‚ 3ä¸ªéƒ¨åˆ†éƒ½ç•¥æœ‰å°æˆå,å¤§é‡å¿«é€Ÿé˜…è¯»ç½‘ä¸Šå„æ–¹é¢çš„æ‚å®¶èµ„æ–™,åº”ç”¨åŸºç¡€çŸ¥è¯†å»åˆ†æç†è§£,åœ¨çŸ­æ—¶é—´å†…æŒæ¡å„ç§ç¨‹åºæ€§æŠ€å·§ã€‚ å†æ¬¡é€šè§‚å…¨å±€åŸºç¡€,éè§ˆæ‰€æœ‰ç»†èŠ‚,ä»¥å›¾æœ‰æ›´æ·±çš„ç†è§£. å¦‚ä½•å­¦ä¹ API (OpenGL/Direct3Dç­‰)é¦–å…ˆï¼Œæˆ‘è®¤ä¸ºAPIæ˜¯å·¥å…·ï¼Œä¸æ˜¯æœ¬è´¨ï¼ŒOpenGL/Direct3Dçš„æœ¬è´¨æ˜¯å›¾å½¢å­¦,è€Œä¸æ˜¯OpenGL/Direct3Dçš„æœ¬èº«,APIçš„æœ¬èº«åªæ˜¯ä¸€äº›Interfaceè€Œå·².å¦‚æœä½ æ˜ç™½å›¾å½¢å­¦çš„åŸç†.é‚£ä¹ˆä½ å¾ˆå®¹æ˜“è¿™äº›æ¥å£çš„ä½œç”¨,ä»¥åŠä¸ºä»€ä¹ˆè¦æœ‰è¿™äº›æ¥å£çš„å­˜åœ¨.æ‰€ä»¥,æˆ‘è¦è¯´çš„ç¬¬ä¸€ç‚¹æ˜¯:ä½ è¦å­¦ä¹ 3Dç¼–ç¨‹,ä¸æ˜¯å­¦ä¼šäº†OpenGL/Direct3Då°±å¯ä»¥äº†ã€‚ç”šè‡³ä¼šä¸ä¼šè¿™äº›APIéƒ½ä¸æ˜¯é‚£ä¹ˆçš„é‡è¦(è™½ç„¶è¿™ä¹ˆè¯´,æˆ–è®¸å¾ˆå¤šäººä¸å¤ªèµåŒ).æœ€é‡è¦çš„,æœ€æ ¹æœ¬çš„æ˜¯,ä½ è¦æ˜ç™½è¿™äº›APIèƒŒåçš„å›¾å½¢å­¦çš„åŸç†â€”-å› ä¸ºé‚£æ‰æ˜¯æ ¹æœ¬ä¸­çš„æ ¹æœ¬. ä¸‹é¢æˆ‘æ¥ä»‹ç»æˆ‘å¯¹APIå­¦ä¹ çš„çœ‹æ³•. æˆ‘è®¤ä¸ºAPIçš„å­¦ä¹ æœ‰ä¸¤ç§æ–¹æ³•:ä¸€æ˜¯æ­£å‘å­¦ä¹ .äºŒæ˜¯åå‘å­¦ä¹ . ä¸€:æ­£å‘å­¦ä¹ ,æ‰€è°“çš„æ­£å‘å­¦ä¹ ,å°±æ˜¯å­¦ä¹ APIçš„æœ¬èº«.æˆ‘è§‰å¾—è¿™ç§æ–¹æ³•æ˜¯ä¸€ç§Brute Forceè¡Œä¸º.ä¸æ˜¯å¾ˆå¥½.æˆ‘ä»¬åªè¦çœ‹çœ‹APIçš„ç‰¹æ€§,æœ‰é‚£äº›éƒ¨åˆ†.å°±å¯ä»¥äº†ã€‚æ¯”å¦‚å­¦ä¹ Direct3Dçš„æ—¶å€™,æˆ‘ä»¬è¦çŸ¥é“å®ƒå¦‚ä½•åˆå§‹åŒ–,ä»¥åŠå®ƒå’Œæ“ä½œç³»ç»Ÿçš„ç»“åˆ.å®ƒåœ¨Direct3D8é‡Œå¼•å…¥äº†VS/PS.æœ€åå°±æ˜¯åˆ›å»ºä¸€ä¸ªDirect3Dåº”ç”¨çš„æ­¥éª¤å’Œæ–¹æ³•.è¿™äº›å°±è¶³å¤Ÿäº†ã€‚è¦ä¸ç„¶.Direct3Dé‚£ä¹ˆå¤šçš„å‡½æ•°,ä¸€ä¸ªå‡ åä¸ªå‚æ•°ã€‚æ¯ä¸€ä¸ªéƒ½ä¼šè¦äº†æˆ‘çš„å‘½. æ­£å‘å­¦ä¹ çš„ç¬¬äºŒä¸ªä½œç”¨å°±æ˜¯ä½ åœ¨ç†Ÿæ‚‰äº†å›¾å½¢å­¦å’Œå¤§æ¦‚äº†è§£äº†APIå,æœ‰ç©ºå°±æ¥çœ‹çœ‹APIçš„ç»†èŠ‚,ç„¶åæ€ç´¢ä¸€ä¸‹APIé‡Œæä¾›çš„ä¸€äº›ç‰¹æ€§å¯¹ä½ çš„ç¨‹åºæœ‰ä»€ä¹ˆä½œç”¨.æ¯”å¦‚Direct3Dé‡Œçš„Two Side Stencil.OpenGLé‡Œçš„TextureCombineç­‰ã€‚ äºŒ:é€†å‘å­¦ä¹ .è¿™æ˜¯æ ¹æœ¬çš„æ–¹æ³•,åˆ°äº†è¿™ä¸€æ­¥,ä½ å°±å¯ä»¥çœŸæ­£çš„ç®—æ˜¯å›¾å½¢å­¦å…¥é—¨äº†ã€‚è¿™è¦æ±‚ä½ è¦æœ‰ä¸€å®šçš„å›¾å½¢å­¦åŸºç¡€.æ¯”å¦‚,ä½ ç°åœ¨å¼€å§‹åšä¸€ä¸ªdemo.ä½ é¢„è®¡ä½ çš„demoé‡Œæœ‰ä¸€å †çœ©çœ©çš„æ•ˆæœ,å½“ç„¶ä½ ä¹Ÿè¦æ˜ç™½ä½ çš„è¿™äº›çœ©çœ©çš„æ•ˆæœè¦æ€ä¹ˆå®ç°çš„.ç„¶åä½ å»æ‰¾APIé‡Œå¯¹åº”çš„åŠŸèƒ½,æˆ‘æƒ³å¦‚æœä½ çš„æƒ³æ³•æ­£å¸¸,ä¸€èˆ¬çš„åŠŸèƒ½åœ¨Direct3D/OpenGLé‡Œåº”è¯¥éƒ½ä¼šæœ‰çš„.å½“ç„¶ä½ ä¹Ÿä¼šç¢°åˆ°ä½ æƒ³è¦çš„åŠŸèƒ½åœ¨è¿™äº›APIé‡Œæ²¡æœ‰,ä½†æ˜¯è¿™ä¸é‡è¦,é‡è¦çš„æ˜¯ä½ åˆå­¦åˆ°æ–°ä¸œè¥¿äº†â€”-è¿™ä¸ªç‰¹æ€§åœ¨XX APIé‡Œä¸æ”¯æŒã€‚ é€šå¸¸æˆ‘æ˜¯é‡‡ç”¨å…ˆæ­£å‘,å†é€†å‘,åŒæ—¶å†è¿›è¡Œæ­£å‘å­¦ä¹ çš„æ–¹æ³•.å¸Œæœ›ä»¥ä¸Šçš„å»ºè®®,å¯¹å„ä½åˆå­¦è€…æœ‰ä¸€å®šçš„å¸®åŠ©. å…³äºè®¡ç®—æœºå›¾å½¢å­¦çš„å­¦ä¹ å¼•è¨€ä»€ä¹ˆæ˜¯è®¡ç®—æœºå›¾å½¢å­¦ï¼Ÿ æœ¬æ–‡å°½é‡é¿å…ç»™å®ƒåšä¸¥æ ¼çš„å®šä¹‰ï¼Œä½†æ˜¯é€šå¸¸æ¥è¯´ï¼Œè®¡ç®—æœºå›¾å½¢å­¦æ˜¯æ•°å­—å›¾è±¡å¤„ç†çš„é€†è¿‡ç¨‹ï¼Œè¿™åªæ˜¯ä¸€ä¸ªä¸ç¡®åˆ‡çš„å®šä¹‰ï¼Œåé¢æˆ‘ä»¬ä¼šçœ‹åˆ°ï¼Œå®é™…ä¸Šï¼Œè®¡ç®—æœºå›¾å½¢å­¦ã€æ•°å­—å›¾è±¡å¤„ç†å’Œè®¡ç®—æœºè§†è§‰åœ¨å¾ˆå¤šåœ°æ–¹çš„åŒºåˆ«ä¸æ˜¯éå¸¸æ¸…æ™°çš„ï¼Œå¾ˆå¤šæ¦‚å¿µæ˜¯ç›¸é€šçš„ã€‚è®¡ç®—æœºå›¾å½¢å­¦æ˜¯ç”¨è®¡ç®—æœºæ¥ç”»ä¸œè¥¿çš„å­¦ç§‘ï¼Œæ•°å­—å›¾è±¡å¤„ç†æ˜¯æŠŠå¤–ç•Œè·å¾—çš„å›¾è±¡ç”¨è®¡ç®—æœºè¿›è¡Œå¤„ç†çš„å­¦ç§‘ã€‚å¦‚ä½•å­¦ä¹ è®¡ç®—æœºå›¾å½¢å­¦å‘¢ï¼Ÿé™¤äº†è®¡ç®—æœºå›¾å½¢å­¦çš„åŸºç¡€çŸ¥è¯†ä»¥å¤–ï¼Œä½ è¿˜éœ€è¦æœ‰ä»¥ä¸‹çš„çŸ¥è¯†ã€‚ è‹±è¯­ï¼Œ ä½ ä¸€å®šè¦æŠŠè‹±è¯­å­¦å¥½ï¼Œå¦‚æœä½ æƒ³å­¦ä¹ è®¡ç®—æœºå›¾å½¢å­¦çš„è¯ï¼Œå°½é‡çœ‹è‹±æ–‡çš„ä¹¦ç±å’Œèµ„æ–™ æ•°å­¦ï¼Œ è®¡ç®—æœºå›¾å½¢å­¦é‡Œé¢çš„æ•°å­¦ç”¨çš„æ¯”è¾ƒå¤šï¼Œï¼Œæˆ‘ä»¬å¯ä»¥åˆ—ä¸¾ä¸€äº›å¸¸ç”¨çš„ï¼šé«˜ç­‰æ•°å­¦ï¼Œæ•°å€¼åˆ†æï¼Œå¾®åˆ†å‡ ä½•ï¼Œæ‹“æ‰‘ï¼Œæ¦‚ç‡ï¼Œ æ’å€¼ç†è®ºï¼Œï¼ˆåï¼‰å¾®åˆ†æ–¹ç¨‹â€¦ ç‰©ç†ï¼Œ å¦‚æœä½ è¦è¿›è¡ŒåŸºäºç‰©ç†çš„å»ºæ¨¡ï¼Œä¸€äº›ç‰©ç†ç†è®ºæ˜¯è¦å­¦ä¹ çš„ï¼šåŠ›å­¦ï¼ˆè¿åŠ¨å­¦ï¼ŒåŠ¨åŠ›å­¦ï¼Œæµä½“åŠ›å­¦â€¦ï¼‰ï¼Œå…‰å­¦ï¼Œæœ‰é™å…ƒâ€¦ ç¼–ç¨‹è¯­è¨€ï¼š Cæˆ–C++æ˜¯è®¡ç®—æœºå›¾å½¢å­¦æœ€é€šç”¨çš„â€˜æ™®é€šè¯â€™ï¼Œ æ•°æ®ç»“æ„ï¼š ä½ éœ€è¦æ•°æ®ç»“æ„æ¥æè¿°ä½ çš„å›¾å½¢å¯¹è±¡ï¼Œé™¤äº†é€šç”¨çš„é“¾è¡¨ã€æ ‘ç­‰æ•°æ®ç»“æ„å¤–ï¼Œå›¾å½¢å­¦è¿˜æœ‰è‡ªå·±ç‰¹æ®Šçš„æ•°æ®ç»“æ„ å…¶ä»–ç±»åˆ«ï¼š æœ‰çš„æ—¶å€™ä½ éœ€è¦å…¶ä»–å­¦ç§‘çš„çŸ¥è¯†ï¼Œæ ¹æ®ä½ çš„éœ€è¦å»å­¦ä¹ å§ ä¸Šé¢åˆ—ä¸¾çš„ä¸æ˜¯ä½ å¿…é¡»å­¦ä¹ çš„ä¸œè¥¿ï¼Œè€Œæ˜¯è®¡ç®—æœºå›¾å½¢å­¦å¯èƒ½ä¼šç”¨åˆ°çš„ä¸œè¥¿ï¼Œä¸€å®šè¦è®°ä½ï¼Œä¸è¦æŒ‡æœ›é€šè¿‡ä¸€æœ¬æ•™æå°±å­¦ä¼šè®¡ç®—æœºå›¾å½¢å­¦ï¼Œå®ƒæ¯”ä½ æƒ³è±¡çš„è¦å¤æ‚çš„å¤šã€‚ å›¾å½¢å­¦çš„é—®é¢˜æ¯ä¸ªå­¦ç§‘éƒ½æœ‰è‡ªå·±å­¦ç§‘çš„ç‰¹å®šé—®é¢˜ï¼Œå›¾å½¢å­¦è¦è§£å†³çš„æ˜¯å¦‚ä½•ç”»å‡ºå›¾æ¥ï¼Œå¾—åˆ°éœ€è¦çš„æ•ˆæœï¼Œå½“ç„¶è¿™æ˜¯å›¾å½¢å­¦æœ€å¤§çš„ä¸€ä¸ªé—®é¢˜ã€‚åœ¨å¼€å§‹å­¦ä¹ è®¡ç®—æœºå›¾å½¢å­¦çš„æ—¶å€™ï¼Œæ‰¾ä¸€æœ¬ç®€å•çš„ä¹¦çœ‹ï¼Œå¯¹è®¡ç®—æœºå›¾å½¢å­¦æœ‰ä¸ªå¤§æ¦‚çš„è®¤è¯†ï¼Œä½ å°±å¯ä»¥å¼€å§‹å›¾å½¢å­¦ä¹‹æ—…äº†ï¼š OpenGL Programming Guide: The Official Guide to Learning OpenGL, Version 1.4, Fourth EditionOpenGL SuperBible (3rd Edition) æ˜¯æ¯”è¾ƒå¥½çš„å­¦ä¹ è®¡ç®—æœºå›¾å½¢å­¦çš„å…¥é—¨æ•™æï¼Œåœ¨ç»ƒä¸­å»å­¦ï¼Œä¸€å¼€å§‹å°±å»å•ƒ Foleyçš„Computer Graphics: Principles and Practice, Second Edition in Cä¸æ˜¯å¥½ä¸»æ„ï¼Œä¼šçœ‹çš„ä¸€å¤´é›¾æ°´ï¼Œä¸€æœ¬ä»€ä¹ˆéƒ½è®²çš„ä¹¦çš„ç»“æœå¾€å¾€æ˜¯ä»€ä¹ˆéƒ½æ²¡è®²æ¸…æ¥šã€‚å½“ä½ æŠŠOpenGLçš„åŸºæœ¬å†…å®¹æŒæ¡ä¹‹åï¼Œä½ å¯¹å›¾å½¢å­¦å°±æœ‰äº†å¤§æ¦‚çš„äº†è§£äº† é‚£ä¹ˆä¸‹é¢ä½ å¯ä»¥æ¥å­¦ä¹ ä¸€ä¸‹è®¡ç®—æœºå›¾å½¢å­¦çš„æ•°æ®ç»“æ„å’Œç®—æ³•ï¼Œä¸‹é¢çš„ä¹¦æ¯”è¾ƒé€‚åˆJoseph Oâ€™Rourke çš„Computational Geometry in Cï¼Œä¹¦é‡Œé¢æœ‰Cçš„æºä»£ç ï¼Œè®²è¿°ç®€å•ï¼Œæ¸…æ™°ï¼Œé€‚åˆç¨‹åºå‘˜å­¦ä¹  æ€»çš„æ¥è¯´ï¼Œè®¡ç®—æœºå›¾å½¢å­¦æ¶‰åŠåˆ°2å¤§éƒ¨åˆ†ï¼šå»ºæ¨¡å’Œæ¸²æŸ“ å»ºæ¨¡ä½ æƒ³ç”»ä¸€ä¸ªä¸œè¥¿ï¼Œé¦–å…ˆè¦æœ‰å®ƒçš„å‡ ä½•æ¨¡å‹ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡ ä½•æ¨¡å‹ä»ä»€ä¹ˆåœ°æ–¹æ¥å‘¢ï¼Ÿä¸‹é¢çš„ä¹¦å¾ˆä¸é”™çš„ï¼šGerald Farin çš„Curves and Surfaces for CAGD: A Practical Guide è¿™æœ¬ä¹¦ç®—æ˜¯CAGD (è®¡ç®—æœºè¾…åŠ©å‡ ä½•è®¾è®¡)çš„ç»å…¸å›¾ä¹¦ï¼ŒCAGDæ–¹é¢çš„å…¨è²Œï¼Œè¿˜æœ‰2æœ¬å¾ˆå¥½çš„è®²è¿°æ›²é¢çš„ä¹¦Bezierå’ŒNurbsçš„ä¹¦ Les A. Piegl, Wayne Tiller çš„The Nurbs Bookä¹¦é‡Œé¢æœ‰NURBSæ›²çº¿ã€æ›²é¢çš„ç¨‹åºä¼ªä»£ç ï¼Œå¾ˆå®¹æ˜“æ”¹æˆCçš„ï¼Œä¹¦è®²çš„é€šä¿—ã€æ˜“æ‡‚ï¼Œä½†æ˜¯ä½ è¦æœ‰è€å¿ƒçœ‹çš„ï¼šï¼‰ æ›²çº¿ä¸æ›²é¢çš„æ•°å­¦è¿™æœ¬ä¹¦æ˜¯æ³•å›½äººå†™çš„ä¸­æ–‡ç¿»è¯‘ç‰ˆï¼Œé‡Œé¢è¿˜æœ‰Bezieæœ¬äººå†™çš„åºJï¼Œç¿»è¯‘çš„å¾ˆä¸é”™çš„ï¼Œçœ‹äº†ä½ å°±æŒæ¡Bezieræ›²é¢æŠ€æœ¯äº†æ³¨æ„ï¼šåœ¨åé¢ä¼šæœ‰è¿™æ ·çš„ç« èŠ‚ï¼Œæ ‡æ˜é‡Œé¢æ˜¯æˆ‘è®¤ä¸ºçš„ä¸€äº›é«˜çº§è¯é¢˜ï¼Œè·³è¿‡ä»–ä»¬ä¸å½±å“ä½ å­¦ä¹ è®¡ç®—æœºå›¾å½¢å­¦ï¼Œä½†æ˜¯è¦å­¦å¥½å°±è¦æ³¨æ„äº†ï¼Œå‘µå‘µè¿˜æœ‰å…¶ä»–çš„ä¸€äº›é€ å‹æŠ€æœ¯ï¼Œæ¯”å¦‚ï¼šéšå¼æ›²é¢(Implicit Surface)çš„é€ å‹ï¼šå°±æ˜¯ç”¨å‡½æ•°å½¢å¼ä¸ºF( x ,y ,z ) = 0çš„æ›²é¢è¿›è¡Œé€ å‹ï¼Œè¿™æ ·çš„é€ å‹æŠ€æœ¯é€‚åˆæè¿°åŠ¨ç‰©å™¨å®˜ä¸€æ ·çš„è‚‰ä¹ä¹çš„ä¸œè¥¿ï¼Œæœ‰2æœ¬ä¹¦æ¨èå¤§å®¶Jules Bloomenthalç¼–è¾‘çš„Introduction to Implicit Surfacesï¼Œæ˜¯ä¸€æœ¬ä¸“è‘—ï¼Œè®²è¿°äº†Implicit Surfaceå»ºæ¨¡å‹(Modeling)ï¼Œé¢ç‰‡åŒ–(Polygonization)ï¼Œæ¸²æŸ“(Rendering)çš„é—®é¢˜Luiz Velho çš„ Implicit Objects Computer Graphics ä¹Ÿæ˜¯ä¸€æœ¬ä¸“è‘—ï¼Œè®²è¿°ä¸ªæ›´æ–°çš„ä¸€äº›è¿›å±• ç»†åˆ†æ›²é¢ï¼ˆSubdivision Surfaceï¼‰é€ å‹å½“ç”¨NURBSåšé€ å‹çš„æ—¶å€™ï¼Œæ›²é¢æ‹¼æ¥æ˜¯å¤æ‚çš„é—®é¢˜ï¼Œåœ¨åŠ¨ç”»çš„æ—¶å€™ï¼Œå¯èƒ½äº§ç”Ÿæ’•è£‚æˆ–è€…è¤¶çš±ï¼ŒSubdivision Surfaceç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜Joe Warrençš„Subdivision Methods for Geometric Design: A Constructive Approachå°±æ˜¯è¿™æ–¹é¢çš„ä¸“è‘— ä»å®é™…ç‰©ä½“ä¸­å¾—åˆ°é€ å‹ï¼Œç°åœ¨çš„æŠ€æœ¯å¯ä»¥ç”¨ä¸‰ç»´æ‰«æä»ªå¾—åˆ°ç‰©ä½“è¡¨é¢çš„ç‚¹ï¼Œç„¶åæ ¹æ®è¿™äº›ç‚¹æŠŠç‰©ä½“çš„è¡¨é¢è®¡ç®—å‡ºæ¥ï¼Œç§°ä¸ºé‡å»º(Reconstruction)ï¼Œå› ä¸ºè¿™äº›æŠ€æœ¯ä¹‹åœ¨æ–‡ç« ä¸­è®ºè¿°ï¼Œæ‰€ä»¥æˆ‘ä»¬çœç•¥å¯¹å®ƒçš„æè¿°ä¸‹é¢è¿˜æ˜¯ä¸€ä¸ªé«˜çº§è¯é¢˜åœ¨ä½ çš„å‡ ä½•æ¨¡å‹åšå¥½ä¹‹åï¼Œæœ‰ä¸€äº›é—®é¢˜éœ€è¦å¯¹è¿™ä¸ªæ¨¡å‹è¿›ä¸€æ­¥å¤„ç†ï¼Œå¾—åˆ°é€‚åˆçš„æ¨¡å‹ï¼Œå½“é¢ç‰‡å¾ˆå¤šçš„æ—¶å€™ï¼Œæˆ–è€…æ¨¡å‹å¾ˆå¤æ‚çš„æ—¶å€™ï¼Œéœ€è¦å¯¹å‡ ä½•æ¨¡å‹è¿›è¡Œç®€åŒ–ï¼Œæ‰å¯ä»¥æ»¡è¶³ä¸€äº›å®æ—¶ç»˜åˆ¶çš„éœ€è¦ï¼Œè¿™ä¸ªæŠ€æœ¯å«åšå±‚æ¬¡ç»†èŠ‚ï¼ˆLOD-Level of Detailï¼‰ã€‚ä¸‹é¢çš„ä¹¦å°±æ˜¯è®²è¿™ä¸ªçš„ï¼šDavid Luebkeç¼–è‘—çš„ Level of Detail for 3D Graphics æ¸²æŸ“æœ‰äº†æ¨¡å‹ï¼Œæ€ä¹ˆæŠŠè¿™ä¸ªå‡ ä½•æ¨¡å‹ç”»å‡ºæ¥å‘¢ï¼Ÿè¿™ä¸ªæ­¥éª¤å°±æ˜¯æ¸²æŸ“å¦‚æœä½ çœ‹äº†ä¸Šé¢çš„OpenGLçš„ä¹¦ï¼Œé‚£ä¹ˆä½ å°±çŸ¥é“ä¸€äº›æ¸²æŸ“çš„çŸ¥è¯†äº†ï¼Œä½†æ˜¯åˆ«é«˜å…´çš„å¤ªæ—©ï¼ŒOpenGLä½¿ç”¨çš„æ˜¯å±€éƒ¨å…‰ç…§æ¨¡å‹ï¼ˆLocal Illumination Modelï¼‰ï¼Œä¸è¦è¢«è¿™ä¸ªè¯å“ä½äº† Local illumination ModelæŒ‡çš„æ˜¯åœ¨åšæ¸²æŸ“çš„æ—¶å€™åªè€ƒè™‘å…‰æºå’Œç‰©ä½“ä¹‹é—´çš„ç›¸äº’ä½œç”¨ï¼Œä¸è€ƒè™‘ç‰©ä½“å’Œç‰©ä½“ä¹‹é—´çš„å½±å“ï¼Œæ‰€ä»¥OpenGLä¸æ”¯æŒé˜´å½±ï¼Œä¸€ä¸ªï¼ˆåŠï¼‰é€æ˜ç‰©ä½“çš„æ•ˆæœ..ï¼Œè¿™äº›éœ€è¦è€ƒè™‘ç‰©ä½“ä¹‹é—´çš„å½±å“æ‰å¯ä»¥å®ç°ã€‚ OpenGLæœ¬èº«ä¸æ”¯æŒï¼Œä½†æ˜¯é€šè¿‡ä¸€äº›æ–¹æ³•å¯ä»¥å®ç°çš„ï¼Œç”¨Googleæœç´¢ä¸€ä¸‹Shadow Volume, OpenGLå°±æ‰¾åˆ°ç­”æ¡ˆå•¦ Global Illumination Model è¿™ç±»æ¨¡å‹è€ƒè™‘çš„å°±æ¯”è¾ƒå…¨å•¦ã€‚ç°åœ¨å…³äºGlobal Illuminationçš„æŠ€æœ¯æœ‰3å¤§ç±»ï¼Œå…·ä½“çš„æŠ€æœ¯å°±ä¸åœ¨è¿™é‡Œä»‹ç»äº†ï¼Œå¦‚æœæƒ³äº†è§£ï¼Œå¯ä»¥è”ç³»æˆ‘ï¼Œå¤§å®¶ä¸€èµ·è®¨è®ºï¼š å…‰çº¿è¿½è¸ª(Ray Tracing)å…³äºRay Tracingçš„å¥½ä¹¦æœ‰2æœ¬ï¼šAndrew Glassner çš„An Introduction to Ray tracingGlasseræ˜¯å›¾å½¢ç•Œçš„åäººï¼Œè¿™æœ¬ä¹¦ä¹Ÿæ˜¯Ray Tracingçš„ç»å…¸R. Keith Morley, Peter Shirley çš„Realistic Ray Tracing, Second Editionè¿™æœ¬ä¹¦ç¬¬ä¸€ç‰ˆæ˜¯ä¼ªä»£ç ï¼Œç¬¬äºŒç‰ˆæ˜¯Cä»£ç ã€‚å®ƒçš„ç»“æ„ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œè™å¤´è›‡å°¾çš„æ„Ÿè§‰ã€‚è¾å°„åº¦(Radiosity)å…³äºRadiosityçš„å¥½ä¹¦æœ‰4æœ¬ï¼šMichael Cohen çš„Radiosity and Realistic Image Synthesis ï¼Œ Cohenè·å¾—SIGGRAPH 1998è®¡ç®—æœºå›¾å½¢å­¦æˆå°±å¥–ï¼Œä»–æŠŠRadiosityå˜æˆå®é™…å¯ç”¨ï¼Œç°åœ¨Cohenåœ¨MSRå›¾å½¢ http://research.microsoft.com/~cohen/CohenSmallBW2.jpg Francois X. Sillionçš„Radiosity and Global Illumination ï¼Œ Sillionæ˜¯æ³•å›½äººï¼Œä»–çš„ä¸»è¦ç ”ç©¶æ–¹å‘æ˜¯Radiosityï¼Œè¿™æœ¬ä¹¦å†™çš„å¾ˆä¸é”™çš„ï¼Œéå¸¸æ¸…æ™° Philip Dutre çš„æ–°ä¹¦Advanced Global Illumination ï¼Œçœ‹èµ·æ¥è¿˜ä¸é”™ï¼Œåˆšæ‹¿åˆ°æ‰‹ï¼Œè¿˜æ²¡çœ‹ï¼Œå‘µå‘µï¼Œæ‰€ä»¥ä¸å¥½è¯„ä»· Ian Ashdownçš„Radiosity: A Programmerâ€™s Perspective Photon mappingHenrik Wann Jensençš„Realistic Image Synthesis Using Photon MappingHenrik Wann Jensenæ˜¯Photon mappingæŠ€æœ¯çš„å‘æ˜è€… è¿™äº›ä¹Ÿæ˜¯å›¾å½¢å­¦å—ï¼Ÿ å›¾å½¢å’Œå›¾è±¡çš„åŒºåˆ«æ¨¡ç³Šäº†éçœŸå®æ€§å›¾å½¢å­¦ï¼ˆNon-Photorealistic Graphicsï¼‰çœŸå®æ€§ä¸æ˜¯è®¡ç®—æœºå›¾å½¢å­¦çš„å”¯ä¸€è¦æ±‚ï¼Œæ¯”å¦‚ï¼šä½ ç»™æˆ‘ç”»ä¸€ä¸ªå¡é€šæ•ˆæœçš„å›¾å‡ºæ¥ï¼Œæˆ–è€…æˆ‘è¦ç”¨è®¡ç®—æœºç”»æ°´å½©ç”»æ€ä¹ˆåŠï¼Ÿæˆ–è€…ï¼šæŠŠå›¾è±¡ç”¨æ–‡å­—æ‹¼å‡ºæ¥æ€ä¹ˆåšï¼Ÿï¼Œè§£å†³è¿™äº›é—®é¢˜è¦ç”¨åˆ°éçœŸå®æ€§å›¾å½¢å­¦ï¼Œ å¥½ä¹¦ç»§ç»­æ¨èï¼ï¼ï¼Bruce Gooch, Amy Ashurst Goochçš„ Non-Photorealistic Rendering ä½“å›¾å½¢å­¦(Volume Graphics)ç”¨CTæœºåšå¾ˆå¤šåˆ‡ç‰‡ï¼ˆæ¯”å¦‚å¤´éª¨ï¼‰ï¼Œé‚£ä¹ˆèƒ½é€šè¿‡è¿™äº›åˆ‡ç‰‡å¾—åˆ°3Dçš„å¤´éª¨å—ï¼ŸVolume Graphicså°±æ˜¯è§£å†³è¿™æ ·çš„é—®é¢˜çš„Min Chen ç¼–è‘—çš„Volume Graphicsä¸Šé¢çš„2ä¸ªå›¾å½¢å­¦æŠ€æœ¯å°±å’Œå›¾è±¡çš„ç•Œé™ä¸æ˜æ˜¾äº†ï¼Œå®é™…ä¸Šä»–ä»¬æ˜¯å›¾å½¢å›¾è±¡çš„ç»¼åˆ è¿˜æœ‰å…¶ä»–çš„ä¹¦å—Graphics Gems I ~ Vï¼Œä¸€å¤§å¸®å­äººå†™çš„ä¹¦ï¼ŒåŒ…æ‹¬ç ”ç©¶äººå‘˜ï¼Œç¨‹åºå‘˜â€¦æœ‰è®¡ç®—æœºå›¾å½¢å­¦çš„å„ç§æ•°æ®ç»“æ„ï¼Œç¼–ç¨‹æŠ€å·§ Tomas Akenine-Moller ç­‰äººç¼–è‘—çš„Real-Time Rendering (2nd Edition)è®¸å¤šæœ€æ–°çš„è®¡ç®—æœºå›¾å½¢å­¦è¿›å±• David Ebertç­‰äººçš„Texturing &amp; Modeling: A Procedural Approach, Third Editionè®²è¿°å¦‚ä½•é€šè¿‡ç¨‹åºå®ç°çº¹ç†ã€å±±ã€åœ°å½¢ç­‰å›¾å½¢å­¦è¦ç´ F. Kenton Musgraveå·ç§°åˆ†å½¢ç‹‚(Fractal Mania)Ken Perlinå°±æ˜¯Perlinå™ªå£°çš„å‘æ˜è€…ï¼Œç”¨è¿‡3dè½¯ä»¶çš„äººå¯¹Perlin Noiseä¸ä¼šé™Œç”Ÿçš„ å…³äºå›¾å½¢å­¦çš„ç‰¹å®šå¯¹è±¡ï¼Œæœ‰ç‰¹å®šçš„ä¸“é¢˜å›¾ä¹¦ï¼ŒEvan Pipho Focus On 3D Models,å¯¹äºå›¾å½¢å­¦çš„å¸¸ç”¨æ¨¡å‹æ ¼å¼ï¼Œè¿›è¡Œäº†è®²è§£Trent Polackçš„ Focus On 3D Terrain Programming ï¼Œè®²åœ°å½¢çš„Donald H. House çš„Cloth Modeling and Animation ï¼Œè®²å¸ƒæ–™çš„Nik Leverçš„Real-time 3D Character Animation with Visual C++ ï¼Œè®²è§’è‰²åŠ¨ç”»çš„ Richard Parentçš„ Computer Animation: Algorithms and Techniquesï¼Œå½“ç„¶æ˜¯è®²åŠ¨ç”»çš„å•¦ï¼Œå‘µå‘µã€‚David H. Eberlyçš„3D Game Engine Design : A Practical Approach to Real-Time Computer Graphics ï¼Œæœ‰ä»£ç çš„å•Šï¼å‘µå‘µï¼šï¼‰ æœ€åï¼Œæ²¡äº‹æƒ…çš„æ—¶å€™ï¼Œçœ‹çœ‹ä¸‹é¢çš„ä¹¦å§Alan H. Wattï¼Œ 3D Computer Graphics (3rd Edition) James D. Foleyç­‰äººçš„ Computer Graphics: Principles and Practice in C (2nd Edition) ï¼Œè¿™æœ¬åœ£ç»æ²¡äº‹çš„æ—¶å€™å†çœ‹å§ï¼Œå‘µå‘µ æ¸¸æˆç¨‹åºå‘˜å…»æˆè®¡åˆ’ä¸ç©æ¸¸æˆç›¸æ¯”,å†™æ¸¸æˆè¦å¤æ‚ä¸Šåƒä¸‡å€,é™¤äº†éœ€è¦æŒæ¡é€šç”¨çš„ç¼–ç¨‹æŠ€å·§ä»¥å¤–ï¼Œè¿˜è¦æœ‰ç›¸å½“çš„å›¾å½¢å­¦ï¼Œç‰©ç†ï¼Œæ•°å­¦åŸºç¡€ï¼Œç‰¹åˆ«æ˜¯åœ¨å›½å†…ï¼Œç”±äºç›¸å…³èµ„æ–™çš„ç¼ºä¹ï¼Œæ›´æ˜¯è®©åˆå­¦è€…æ— ä»ä¸‹æ‰‹ã€‚ä¸‹é¢æ€»ç»“äº†ä¸€äº›å…¥é—¨æ–¹æ³•å’Œæ¯”è¾ƒå®¹æ˜“å…¥æ‰‹çš„èµ„æ–™ã€‚ é¦–å…ˆä½ è¦ç²¾é€šä¸€é—¨é«˜çº§è¯­è¨€ï¼Œæ¯”å¦‚C++æˆ–è€…C#ï¼Œå…¶æ¬¡ï¼Œè¦æœ‰è‰¯å¥½çš„è‹±æ–‡é˜…è¯»èƒ½åŠ›ã€‚å¯¹æ¸¸æˆå¼€å‘è€…æ¥è¯´è‹±æ–‡é˜…è¯»èƒ½åŠ›æ˜¯æœ€é‡è¦ä¹Ÿæ˜¯æœ€åŸºæœ¬çš„å·¥å…·ä¹‹ä¸€ï¼Œå› ä¸ºä½ é‡åˆ°çš„å¤§éƒ¨åˆ†èµ„æºéƒ½å°†æ˜¯è‹±æ–‡çš„ï¼Œä¸è¦æ€»ç­‰ç€åˆ«äººä¸ºä½ ç¿»è¯‘ã€‚æ…¢æ…¢å°è¯•ç€é˜…è¯»è‹±æ–‡èµ„æ–™ï¼Œä½ ä¼šå‘ç°å…¶å®ä¹Ÿå¹¶æ²¡æœ‰é‚£ä¹ˆéš¾:) åˆšå¼€å§‹ï¼Œä½ è¦åšçš„å°±æ˜¯é€‰æ‹©ä¸€é—¨å›¾å½¢APIï¼Œä¸€èˆ¬å°±æ˜¯DirectXæˆ–è€…OpenGLä¹‹é—´é€‰ä¸€ä¸ªã€‚å¦‚æœè€ƒè™‘åˆ°è·¨å¹³å°ï¼Œé‚£ä¹ˆOGLæ˜¯é¦–é€‰. å¦‚æœåªåœ¨msçš„å¹³å°ï¼Œåˆ™DXæ˜¯é¦–é€‰ã€‚æˆ‘å¯¹OGLå¹¶ä¸æ˜¯å¾ˆäº†è§£ï¼Œæ‰€ä»¥ä¸‹é¢å¤§éƒ¨é—¨èµ„æ–™éƒ½æ˜¯å’ŒDXç›¸å…³çš„ã€‚ å½“ç„¶ï¼Œä½œä¸ºå‡†å¤‡å·¥ä½œä¹‹ä¸€ï¼Œä½ é¦–å…ˆè¦åˆ°DirectX Develop Centerä¸‹è½½æœ€æ–°ç‰ˆçš„DirectX SDKã€‚ å…¥é—¨ä¹¦ç±éå¸¸é‡è¦ï¼Œæ¨è&lt;&gt;ï¼ˆå¥½åƒå»å¹´å‡ºäº†ä¸­æ–‡ç‰ˆï¼‰ä¹Ÿå°±æ˜¯ä¼ è¯´ä¸­çš„é¾™ä¹¦ï¼Œè¿™å¯ä»¥è¯´æ˜¯æœ€å¥½çš„DXå…¥é—¨æ•™æï¼ŒFrank Lunaä»æµ…å…¥æ·±ï¼Œè®¨è®ºäº†DXçš„æ–¹æ–¹é¢é¢ã€‚å¦å¤–å†é…ä¸Š&lt;&lt; Advanced 3D Game Programming With DirectX 9.0&gt;&gt;ï¼Œä¹¦åè™½ç„¶æ˜¯advancedï¼Œä½†å®é™…ä¸Šæ²¡æœ‰å¤šå°‘advancedçº§åˆ«çš„å†…å®¹ã€‚çœ‹å®Œè¿™ä¸¤æœ¬ä¹¦ï¼Œä½ åŸºæœ¬ä¸Šå·²ç»å¯¹DirectXæ¯”è¾ƒç†Ÿæ‚‰äº†ã€‚å¦‚æœä½ å¸Œæœ›å­¦ä¹ XNAï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæ¯•ç«ŸXNAæ˜¯ä»¥DXä¸ºåŸºç¡€ã€‚ ä¸è¦ä¸€å¼€å§‹å°±çœ‹å›¾å½¢å­¦çš„ä¹¦ï¼Œè¿™ä¸ªæ—¶å€™ä½ å¯¹å›¾å½¢ç¼–ç¨‹è¿˜æ²¡æœ‰ä¸€ä¸ªåŸºæœ¬çš„æ„Ÿæ€§è®¤è¯†ï¼Œå› æ­¤å…«æˆçœ‹çš„äº‘é‡Œé›¾é‡Œã€‚ä¸è¦ä»¥ç½‘ä¸Šçš„æ•™ç¨‹å’Œè®ºå›æé—®ä½œä¸ºä¸»è¦å­¦ä¹ é€”å¾„ï¼Œæ‰¾ä¸€æœ¬å¥½ä¹¦ï¼Œç³»ç»Ÿå­¦ä¹ ï¼Œæ•ˆç‡æ‰æœ€é«˜ã€‚ä¸è¦é©¬ä¸Šçœ‹SDKé‡Œçš„ä¾‹å­ï¼Œå¾ˆå¤šå›¾å½¢å­¦çš„åŸºæœ¬åŸç†ä»…ä»…é€šè¿‡è¯»ä»£ç æ˜¯ä¸ä¼šæ˜ç™½çš„ã€‚æŸäº›å¹´ä»£å¤ªè¿‡ä¹…è¿œçš„ä¹¦å°±ä¸è¦çœ‹äº†ï¼Œæ¯”å¦‚ã€Šwindowsæ¸¸æˆç¼–ç¨‹å¤§å¸ˆæŠ€å·§ã€‹ï¼ˆæ€»çœ‹åˆ°æœ‰äººåœ¨æ‰¾è¿™æœ¬ä¹¦ï¼‰ã€‚æœ‰äººè¯´åŸºæœ¬çš„æ€æƒ³æ€»æ˜¯ä¸å˜çš„ï¼Œå¯æƒœå¯¹äºç°ä»£GPUæ¥è¯´ï¼Œå¾ˆå¤šæ—©æœŸçš„æŠ€æœ¯å’Œä¼˜åŒ–æŠ€å·§æ—©å°±è¿‡æ—¶äº†ã€‚å›¾å½¢ç¼–ç¨‹æ˜¯å‘å±•çš„éå¸¸å¿«çš„æŠ€æœ¯ï¼Œçœ‹çœ‹GPUçš„å‘å±•é€Ÿåº¦ï¼Œ1~2å¹´å°±æ˜¯ä¸€ä»£äº§å“çš„é©æ–°ã€‚ å¥½äº†ï¼Œå…¥é—¨ä¹‹åï¼Œæ˜¯ä½ å·©å›ºå’Œæ‹“å±•è§†é‡çš„é˜¶æ®µã€‚ç°åœ¨çœ‹è®¡ç®—æœºå›¾å½¢å­¦å°±æ¯”è¾ƒåˆé€‚äº†ã€‚åè¡€æ¨è&lt;&gt;,è¿™æœ¬ä¹¦ç®—å¾—ä¸Šæ˜¯æ‰€æœ‰å›¾å½¢ç¨‹åºå‘˜çš„å¿…è¯»ä¹¦ç±å’Œå‚è€ƒæ‰‹å†Œäº†ã€‚æœ€è¿‘åˆšå‡ºäº†ç¬¬ä¸‰ç‰ˆã€‚å¯æƒœå›½å†…åªæœ‰ç¬¬äºŒç‰ˆï¼Œç¨å¾®æœ‰ç‚¹è€ï¼Œå¦‚æœå®åœ¨æ‰¾ä¸åˆ°ç¬¬ä¸‰ç‰ˆï¼Œè¿˜æ˜¯å€¼å¾—ä¸€è¯»ã€‚å›½å†…å…¶ä»–æ‰€æœ‰ä»¥å›¾å½¢å­¦å‘½åçš„ä¹¦éƒ½æœ‰ä¸€ä¸ªå…±åŒç‚¹ï¼šæ¯ç‡¥ï¼Œè¿‡æ—¶ã€‚åªéœ€çœ‹çœ‹å…¶ä¸­äºŒç»´ä¸‰ç»´å˜æ¢å’Œæ›²çº¿æ›²é¢è¡¨ç¤ºçš„éƒ¨åˆ†å³å¯ã€‚å¦‚æœè¿™ä¸ªæ—¶å€™å‘ç°ä½ å½“å¹´æ•°å­¦æ²¡æœ‰å­¦å¥½ï¼Œé‚£ä¹ˆæœ‰ä¸‰æœ¬æ•°å­¦ä¹¦æ˜¯ä¸ºæ¸¸æˆç¨‹åºå‘˜é‡èº«å®šåˆ¶çš„ï¼š&lt;&gt;, &lt;&gt;å’Œ&lt;&gt;ï¼Œç¬¬ä¸€æœ¬ä¹¦æœ‰ä¸­æ–‡ç‰ˆï¼Œæœ€åä¸€æœ¬åˆ™æ˜¯08å¹´æ‰å‡ºçš„æ–°ä¹¦ã€‚ å…¶å®å…¥é—¨ä¹‹åï¼Œå°±æ²¡æœ‰å›ºå®šçš„å­¦ä¹ è·¯çº¿äº†ï¼Œæœ€å¥½æ ¹æ®ä½ æ„Ÿå…´è¶£çš„æ–¹å‘æ¥å­¦ä¹ ã€‚ Shaderæ–¹é¢ï¼šã€ŠCg_tutorialã€‹å’Œã€ŠThe Complete Effect and HLSL Guideã€‹éƒ½æ˜¯ä¸é”™çš„å…¥é—¨ææ–™ï¼Œå½“ç„¶è¿˜æœ‰SDKæ–‡æ¡£ã€‚&lt;&gt;æœ‰å¤§é‡å…¥é—¨çš„ä¾‹å­ã€‚&lt;&gt;è¯¦ç»†ä»‹ç»äº†å„ç§å…‰ç…§æ¨¡å‹å’ŒæŠ€æœ¯ã€‚&lt;&gt; 1~3å†Œè‚¯å®šæ˜¯å¿…è¯»çš„ï¼Œè™½ç„¶æœ‰1ï¼Œ2æœ‰ä¸­æ–‡ç‰ˆï¼Œä½†æŸäº›ç¿»è¯‘å¹¶ä¸æ˜¯å¾ˆç†æƒ³ï¼Œå¼ºçƒˆå»ºè®®ç›´æ¥çœ‹è‹±æ–‡ç‰ˆã€‚ShaderXç³»åˆ—ä¹Ÿæ˜¯å¾ˆç»å…¸çš„ç³»åˆ—ï¼Œæ¯å¹´å‡ºç‰ˆä¸€æœ¬ï¼ŒåŒ…å«äº†æœ€æ–°çš„å®æ—¶æ¸²æŸ“æŠ€æœ¯ï¼Œå¦‚ä»Šå·²ç»å‡ºäº†ç¬¬6å†Œäº†ã€‚ä¸è¿‡ç½‘ç»œä¸Šåªèƒ½æ‰¾åˆ°1~3å†Œã€‚1ï¼Œ2å†Œå¤§éƒ¨åˆ†shaderéƒ½æ˜¯ç”¨asmå†™çš„ï¼Œä¸è¿‡çœ‹æ‡‚åŸç†ï¼Œè½¬æ¢ä¸ºHLSLä¹Ÿå¹¶ä¸éš¾ã€‚å¦å¤–Nvidia SDKå’ŒATI SDKä¹Ÿæ˜¯å­¦ä¹ shaderçš„é‡è¦èµ„æºã€‚æœ€åè¿˜æœ‰åˆšå‡ºçš„&lt;&lt; Programming Vertex, Geometry, and Pixel Shaders&gt;&gt; åœ°å½¢ï¼š&lt;&gt;éå¸¸å…¨é¢çš„è®¨è®ºäº†å…³äºåœ°å½¢æ¸²æŸ“çš„å„ç§æŠ€æœ¯ï¼Œè‡³å°‘åº”è¯¥æŠŠç¬¬5~9ç« éƒ½æµè§ˆä¸€éã€‚ä¹‹åä¾¿å¯ä»¥ åˆ°virtual terrainæŸ¥é˜…è¿‘æœŸçš„åœ°å½¢æ¸²æŸ“æŠ€æœ¯ã€‚ æ¨¡å‹å¯¼å…¥å’ŒåŠ¨ç”»ï¼š&lt;&gt;ï¼Œä»…æ­¤ä¸€æœ¬è¶³ä»¥ã€‚ ç‰©ç†ï¼š&lt;&gt;å’Œ&lt;&gt;éƒ½ä¸é”™ã€‚&lt;&gt;æ˜¯ç¢°æ’æ£€æµ‹æ–¹é¢æœ€å¥½çš„ä¹¦ï¼Œå¯æƒœç›®å‰è¿˜æ²¡æœ‰ç”µå­ç‰ˆã€‚LODï¼š&lt;&gt;Ray tracing:&lt;&lt; Physical-Based Rendering - From Theory to Implementation&gt;&gt;å¼•æ“è®¾è®¡ï¼šè¯´å®è¯ï¼Œè¿™æ–¹é¢è¿˜æ²¡æœ‰ç‰¹åˆ«å¥½çš„ä¹¦ï¼Œå¤§æ¦‚è¶Šæ˜¯æ ¸å¿ƒçš„å†…å®¹ï¼Œè¶Šå°‘æœ‰äººæ„¿æ„å†™å§ã€‚&lt;&gt;åªæœ‰ç¬¬ä¸‰ç« å€¼å¾—ä¸€è¯»ã€‚&lt;&gt;å¯ä»¥é€‰éƒ¨åˆ†æ„Ÿå…´è¶£çš„ç« èŠ‚çœ‹çœ‹ï¼Œä¸è¿‡æ€»çš„æ¥è¯´ï¼Œè®²çš„æ¯”è¾ƒæµ…ã€‚AIï¼š&lt;&gt;éå¸¸ä¸é”™ï¼Œå¥½åƒè¿˜æœ‰ä¸­æ–‡ç‰ˆï¼Œå¤‡é€‰&lt;&gt;ã€‚å½“ç„¶&lt;&gt;ç³»åˆ—ä¹Ÿæ˜¯å¿…è¯»ä½œå“ï¼Œä¸è¿‡ç›®å‰ç½‘ç»œä¸Šåªæœ‰1ï½2å†Œã€‚ç»¼åˆï¼š&lt;&gt;ç³»åˆ—ï¼Œä¸è¿‡ç”±äºå†…å®¹æ¶‰åŠçš„è¿‡äºå¹¿æ³›ï¼Œæ–‡ç« è´¨é‡å‚å·®ä¸é½ï¼Œé€‰æ‹©æ€§é˜…è¯»å°±å¯ä»¥äº†ã€‚å†å¹´GDC, Gamefest t,Siggraphç­‰å¤§å‹ä¼šè®®çš„paperä¹Ÿæ˜¯åº”è¯¥å…³æ³¨çš„ã€‚é™¤äº†ä¹¦ä»¥å¤–ï¼Œå†æ¨èä¸€äº›ä¸é”™çš„ç½‘ç»œèµ„æºï¼šwww.GameDev.NET é™¤äº†å¤§é‡æ•™ç¨‹ä»¥å¤–ï¼Œè®ºå›é‡Œå¤šå¹´ç´¯è®¡ä¸‹æ¥çš„å†…å®¹ä¿ç½—ä¸‡è±¡ã€‚å¥½å¥½åˆ©ç”¨è®ºå›æœç´¢ï¼Œä½ ä¼šå‘ä¸ç®¡ä½ å¤šå‰å®³ï¼Œé‚£é‡Œæ€»æœ‰ä¸€äº›æ¯”ä½ å¼ºå¤§çš„äººåœ¨å¾ˆä¹…ä»¥å‰å°±é‡åˆ°äº†å’Œä½ åŒæ ·çš„é—®é¢˜ï¼Œå¹¶ä¸”ç»™å‡ºäº†è§£å†³æ–¹æ¡ˆã€‚Nvidiaå’ŒATIçš„å¼€å‘è€…ä¸­å¿ƒcreators.xna.com XNAå®˜æ–¹ç½‘ç«™www.gamasutra.com ä¸GameDevç±»ä¼¼www.beyond3d.com è¿™é‡Œçš„é™¤äº†è®¨è®ºè½¯ä»¶ä»¥å¤–ï¼Œè¿˜èƒ½çœ‹åˆ°å¯¹ç¡¬ä»¶æ„æ¶çš„åˆ†æwww.ziggyware.com æœ€å¥½çš„XNAæ•™ç¨‹ç½‘ç«™www.gameres.com å›½å†…å”¯ä¸€æ¯”è¾ƒä¸“ä¸šçš„æ¸¸æˆç¼–ç¨‹ç½‘ç«™ï¼Œå¯æƒœå’ŒGameDevç›¸æ¯”å°±æ˜¾å¾—å¤ªå¯’ç¢œäº†http://imgtec.eetrend.com/www.alanzucconi.com/category/shader/http://shaderbits.com/blog/tiling-within-subuv-or-volume-textureshttp://www.iquilezles.org/www/index.htmhttp://www.opengpu.org/forum.php?mod=forumdisplay&amp;fid=21https://www.gamedev.net/http://www.flipcode.com/archives/Light_Mapping_Theory_and_Implementation.shtmlhttp://www.realtimerendering.com/http://kesen.realtimerendering.com/]]></content>
      <categories>
        <category>å›¾å½¢å­¦</category>
      </categories>
      <tags>
        <tag>å›¾å½¢å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ ‡å‡†å…‰ç…§æ¨¡å‹]]></title>
    <url>%2F2019%2F04%2F10%2Fdiffuse%2F</url>
    <content type="text"><![CDATA[åŸºæœ¬å…‰ç…§æ¨¡å‹ä¸­æ¼«åå°„éƒ¨åˆ†çš„è®¡ç®—å…¬å¼ï¼š$c_{diffuse}=(c_{light} \cdot m_{diffuse})max(0, \vec{n} \cdot I)$ä»å…¬å¼å¯ä»¥çœ‹å‡ºï¼Œè¦è®¡ç®—æ¼«åå°„éœ€è¦çŸ¥é“4ä¸ªå‚æ•°ï¼šå…¥å°„å…‰çº¿çš„é¢œè‰²å’Œå¼ºåº¦$c_{light}$ï¼Œè¡¨é¢å‘ç°$\vec{n}$ä»¥åŠå…‰æºæ–¹å‘$I$ã€‚ä¸ºäº†é˜²æ­¢ç‚¹å‡»ç»“æœä¸ºèµ‹å€¼ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨maxæ“ä½œï¼Œè€ŒCGæä¾›äº†è¿™æ ·çš„å‡½æ•°ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œä½¿ç”¨CGçš„å¦ä¸€ä¸ªå‡½æ•°å¯ä»¥è¾¾åˆ°åŒæ ·çš„ç›®çš„ï¼Œå³saturateå‡½æ•°ã€‚å‡½æ•°ï¼šsaturate(x)å‚æ•°ï¼šxï¼šç”¨äºæ“ä½œçš„æ ‡é‡æˆ–çŸ¢é‡ï¼Œå¯ä»¥æ˜¯floatã€float2ã€float3ç­‰ç±»å‹ã€‚æè¿°ï¼šæŠŠxæˆªå–åœ¨[0,1]èŒƒå›´å†…ï¼Œå¦‚æœxæ˜¯ä¸€ä¸ªçŸ¢é‡ï¼Œé‚£ä¹ˆä¼šå¯¹å®ƒçš„æ¯ä¸€ä¸ªåˆ†é‡è¿›è¡Œè¿™æ ·çš„æ“ä½œã€‚ é€é¡¶ç‚¹å…‰ç…§123456789101112131415161718192021222324252627282930313233343536373839Shader "Unity/Diffuse Vertex"&#123; Properties &#123; _Diffuse ("Diffuse", Color)=(1,1,1,1) // æè´¨çš„æ¼«åå°„ç³»æ•° _Specular("Specular", Color)=(1,1,1,1) // é«˜å…‰ç³»æ•° &#125; SubShader&#123; Pass&#123; Tasg&#123;"LightMode"="ForwardBase"&#125; // å‰å‘æ¸²æŸ“ï¼Œæ‰€æœ‰å…‰æºéƒ½åœ¨ä¸€ä¸ªç€è‰²å™¨ä¸­è¿›è¡Œ &#125; CGPROGRAM #pragma vertex vert #pragma fragment frag #include "Lighting.cginc" fixed4 _Diffuse; struct a2v&#123; float4 vertex : POSITION; float3 normal : NORMAL; &#125;; struct v2f &#123; float4 pos : SV_POSITION; fixed3 color : COLOR; &#125;; v2f vert(a2v v)&#123; v2f o; o.pos = UnityObjectToClipPos(v.vertex); float3 ambient = UNITY_LIGHTMODEL_AMBIENT.xyz; // ç¯å¢ƒå…‰ float3 worldNormal = normalize(mul(v.normal, (float3x3)_World2Object)); // ä¸–ç•Œæ³•çº¿ float3 lightNormal = normalize(_WorldSpaceLightPos0.xyz); // å…‰çš„æ–¹å‘ float3 diffuse = _LightColor0.rgb * _Diffuse.rgb * saturate(dot(worldNormal, lightNormal)); o.color = diffuse + ambient; return o; &#125; fixed4 frag(v2f o) : COLOR &#123; return fixed4(o.color,1); &#125; &#125; Fallback "Diffuse"&#125; é¡¶ç‚¹ç€è‰²å™¨æœ€åŸºæœ¬çš„ä»»åŠ¡å°±æ˜¯æŠŠé¡¶ç‚¹ä½ç½®ä»æ¨¡å‹ç©ºé—´è½¬æ¢åˆ°è£å‰ªç©ºé—´ä¸­ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨Unityå†…ç½®çš„æ¨¡å‹*ä¸–ç•Œ*æŠ•å½±çŸ©é˜µUNITY_MATRIX_MVPæ¥å®Œæˆè¿™æ ·çš„åæ ‡è½¬æ¢ã€‚é€šè¿‡Unityçš„å†…ç½®å˜é‡UNITY_LIGHTMODEL_AMBIENTå¾—åˆ°äº†ç¯å¢ƒå…‰éƒ¨åˆ†ã€‚ç„¶åï¼Œå°±æ˜¯çœŸæ­£è®¡ç®—æ¼«åå°„å…‰ç…§çš„éƒ¨åˆ†ã€‚ä¸ºäº†è®¡ç®—æ…¢åå°„å…‰ç…§æˆ‘ä»¬éœ€è¦çŸ¥é“4ä¸ªå‚æ•°ã€‚åœ¨å‰é¢çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†æè´¨çš„æ¼«åå°„é¢œè‰²_Diffuseä»¥åŠé¡¶ç‚¹å‘ç°v.normalã€‚æˆ‘ä»¬è¿˜éœ€çŸ¥é“å…‰æºçš„é¢œè‰²å’Œå¼ºåº¦ä¿¡æ¯ä»¥åŠå…‰æºæ–¹å‘ã€‚Unityæä¾›ç»™æˆ‘ä»¬ä¸€ä¸ªå†…ç½®å˜é‡_LightColor0æ¥è®¿é—®è¯¥Passå¤„ç†çš„å…‰æºçš„é¢œè‰²å’Œå¼ºåº¦ä¿¡æ¯ï¼ˆæ³¨æ„ï¼Œæƒ³è¦å¾—åˆ°æ­£ç¡®çš„å€¼éœ€è¦å®šä¹‰åˆé€‚çš„LightModeæ ‡ç­¾ï¼‰ï¼Œè€Œå…‰æºæ–¹å‘å¯ä»¥ç”±_WorldSpaceLightPos0æ¥å¾—åˆ°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œå¯¹å…‰æºæ–¹å‘çš„è®¡ç®—å¹¶ä¸å…·æœ‰é€šç”¨æ€§ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾åœºæ™¯ä¸­åªæœ‰ä¸€ä¸ªå…‰æºä¸”è¯¥å…‰æºçš„ç±»å‹æ˜¯å¹³è¡Œå…‰ã€‚ä½†å¦‚æœåœºæ™¯ä¸­æœ‰å¤šä¸ªå…‰æºå¹¶ä¸”ç±»å‹å¯èƒ½æ˜¯ç‚¹å…‰æºç­‰å…¶ä»–ç±»å‹ï¼Œç›´æ¥ä½¿ç”¨_WorldSpaceLightPos0å°±ä¸èƒ½å¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚ åŠå…°ä¼¯ç‰¹å…‰ç…§æ¨¡å‹$c_{diffuse}=(c_{light}\cdot m_{diffuse})(\alpha (\vec {n}\cdot I)+\beta)$å¯ä»¥çœ‹å‡ºï¼Œä¸åŸå…°ä¼¯ç‰¹æ¨¡å‹ç›¸æ¯”ï¼ŒåŠå…°ä¼¯ç‰¹å…‰ç…§æ¨¡å‹æ²¡æœ‰ä½¿ç”¨maxæ“ä½œæ¥é˜²æ­¢$\vec {n}$ Blinn-Phongå…‰ç…§æ¨¡å‹Blinnæ¨¡å‹è®¡ç®—é«˜å…‰åå°„çš„å…¬å¼å¦‚ä¸‹ï¼š $c_{specular}=(c_{light} \cdot m_{specular})max(0,\vec{n} \cdot \vec{h})^{m_{glass}}$]]></content>
      <categories>
        <category>Unity Shader</category>
      </categories>
      <tags>
        <tag>Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[new delete malloc free]]></title>
    <url>%2F2019%2F04%2F10%2Fnew-delete-malloc-free%2F</url>
    <content type="text"><![CDATA[æ­£æ–‡æ¯ä¸ªç¨‹åºåœ¨æ‰§è¡Œæ—¶éƒ½ä¼šå ç”¨ä¸€å—å¯ç”¨çš„å†…å­˜ç©ºé—´ï¼Œç”¨äºå­˜æ”¾åŠ¨æ€åˆ†é…çš„å¯¹è±¡ï¼Œæ­¤å†…å­˜ç©ºé—´æˆä¸ºè‡ªç”±å­˜å‚¨åŒºæˆ–å †ã€‚ newå’Œdeleteç”¨æ³•å¦‚ä¸‹å‡ è¡Œä»£ç ï¼š 123int *pi = new int;int *pi = new int();int *pi = new int(1024); ç¬¬ä¸€è¡Œè¿™ä¸ªnewè¡¨è¾¾å¼åœ¨è‡ªç”±å­˜å‚¨åŒºä¸­åˆ†é…åˆ›å»ºäº†ä¸€ä¸ªæ•´å‹å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥å¯¹è±¡çš„åœ°å€æ¥åˆå§‹åŒ–æŒ‡é’ˆpiã€‚ç¬¬äºŒè¡Œå°†æŒ‡é’ˆpiæŒ‡å‘çš„åœ°å€çš„å€¼è¿›è¡Œäº†åˆå§‹åŒ–ä¸º0ã€‚ç¬¬ä¸‰è¡Œåˆå§‹åŒ–ä¸º1024.å½“åŠ¨æ€åˆ›å»ºçš„å¯¹è±¡ç”¨å®Œåå¿…é¡»é‡Šæ”¾å†…å­˜ï¼Œé¿å…é€ æˆå†…å­˜æ³„æ¼ï¼Œå¯ä»¥ç”¨deleteæ¥å®Œæˆï¼Œnewå’Œdeleteæ˜¯æˆå¯¹ä½¿ç”¨çš„ï¼Œå¦‚ä¸‹å‘½ä»¤é‡Šæ”¾piæŒ‡å‘çš„intå‹å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ç©ºé—´ï¼š1delete pi; æ­¤æ—¶piå°½ç®¡æ²¡æœ‰å®šä¹‰ï¼Œä½†ä»ç„¶å­˜æ”¾äº†å‘ƒå®ƒæ‰€æŒ‡å‘å¯¹è±¡çš„åœ°å€ï¼Œç„¶è€Œpiæ‰€æŒ‡å‘çš„å†…å­˜å·²ç»è¢«é‡Šæ”¾ï¼Œå› æ­¤piä¸å†æœ‰æ•ˆã€‚å»ºè®®ä¸€æ—¦åˆ é™¤æŒ‡é’ˆæ‰€æŒ‡å‘çš„å¯¹è±¡ï¼Œç«‹å³å°†æŒ‡é’ˆç½®ä¸º0ï¼Œè¿™æ ·å°±æ¸…æ¥šçš„è¡¨æ˜æŒ‡é’ˆä¸å†æŒ‡å‘ä»»ä½•å¯¹è±¡ã€‚1p = NULL; å€¼å¾—æ³¨æ„çš„æ˜¯å½“æ‰§è¡Œä¸‹åˆ—è¡¨è¾¾å¼ï¼š12int pi = &amp;i;delete pi; ç¼–è¯‘å™¨ä¸€èˆ¬ä¸ä¼šæŠ¥é”™ï¼Œå› ä¸ºç¼–è¯‘å™¨é€šå¸¸ä¸èƒ½æ–­å®šä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ä»€ä¹ˆç±»å‹çš„å¯¹è±¡ï¼Œæ‰€ä»¥å°½ç®¡è¿™ä¸ªè¯­å¥æ˜¯é”™è¯¯çš„ï¼Œä½†åœ¨å¤§å¤šæ•°ç¼–è¯‘å™¨ä¸Šä»ç„¶èƒ½é€šè¿‡ã€‚C++ä¸­å…è®¸åŠ¨æ€åˆ›å»ºconstå¯¹è±¡ï¼š1const int *pi = new const int(1024); åŠ¨æ€åˆ›å»ºçš„constå¯¹è±¡å¿…é¡»è¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶ä¸”è¿›è¡Œåˆå§‹åŒ–åçš„å€¼ä¸èƒ½åœ¨æ”¹å˜ã€‚å½“åˆ›å»ºä¸€ä¸ªåŠ¨æ€æ•°ç»„å¯¹è±¡å’Œè¿›è¡Œå†…å­˜é‡Šæ”¾æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹è¯­å¥ï¼š1234int *pi = new int[]; // piæ‰€æŒ‡å‘çš„æ•°ç»„æœªåˆå§‹åŒ–int *pi = new int[n]; // piæŒ‡å‘é•¿åº¦ä¸ºnçš„æ•°ç»„ï¼Œæœªåˆå§‹åŒ–int *pi = new int[](); // æŒ‡é’ˆpiæ‰€æŒ‡å‘çš„åœ°å€åˆå§‹åŒ–ä¸º0delete [] pi; // å›æ”¶piæ‰€æŒ‡å‘çš„æ•°ç»„ mallocå’Œfreeçš„ç”¨æ³•ä¸¤ä¸ªå‡½æ•°çš„åŸå‹å¦‚ä¸‹ï¼Œä»–ä»¬éƒ½åœ¨å¤´æ–‡ä»¶stdlib.hä¸­å£°æ˜ã€‚12void *malloc(size_t size);void free(void *pointer); ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š12int *p = (int *)malloc(100); // æŒ‡å‘æ•´å‹çš„æŒ‡é’ˆpæŒ‡å‘ä¸€ä¸ªå¤§å°ä¸º100å­—èŠ‚çš„å†…å­˜çš„åœ°å€int *p = (int *)malloc(25*sizeof(int)); // æŒ‡å‘æ•´å‹çš„æŒ‡é’ˆpæŒ‡å‘ä¸€ä¸ª25ä¸ªintæ•´å‹ç©ºé—´çš„åœ°å€ å› ä¸ºmalloc()å‡½æ•°çš„è¿”å›å€¼ç±»å‹ä¸ºvoid *ï¼Œæ‰€ä»¥éœ€è¦åœ¨å‡½æ•°å‰é¢è¿›è¡Œç›¸åº”çš„å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚å½“intå 4ä¸ªå­—èŠ‚å†…å­˜æ—¶ï¼Œä¸Šè¿°çš„ä¸¤ä¸ªè¯­å¥ä»£ç è·å¾—çš„å†…å­˜ç©ºé—´å¤§å°æ˜¯ç›¸åŒçš„ã€‚åˆ†é…å†…å­˜åéœ€è¦éªŒè¯å†…å­˜æ˜¯å¦åˆ†é…æˆåŠŸï¼Œå®Œæˆåfree()é‡Šæ”¾å†…å­˜ï¼Œå®Œæ•´è¯­å¥å¦‚ä¸‹ã€‚1234int *p = (int *)malloc(int);if (pi == NULL) printf("Out of memory!\n");free(p); å¦å¤–ä¸¤ä¸ªåˆ†é…å†…å­˜çš„å‡½æ•°ï¼šcallocå’Œreallocï¼Œä»–ä»¬çš„åŸå‹å¦‚ä¸‹ï¼š12void *calloc(size_t num_elements, size_t element_size);void realloc(void *tr, size_t new_size); mallocå’Œcallocé—´çš„ä¸»è¦åŒºåˆ«åœ¨äºåè€…åœ¨è¿”å›æŒ‡å‘å†…å­˜çš„æŒ‡é’ˆä¹‹å‰æŠŠå®ƒåˆå§‹åŒ–ä¸º0ã€‚å¦ä¸€ä¸ªåŒºåˆ«æ˜¯callocçš„å‚æ•°åŒ…æ‹¬æ‰€éœ€çš„å…ƒç´ çš„æ•°é‡å’Œæ¯ä¸ªå…ƒç´ çš„å­—èŠ‚æ•°ã€‚rellocå‡½æ•°ç”¨äºä¿®æ”¹ä¸€ä¸ªåŸå…ˆå·²ç»åˆ†é…çš„å†…å­˜å—å¤§å°ã€‚å¯ä»¥ä½¿ä¸€å—å†…å­˜æ‰©å¤§æˆ–ç¼©å°ï¼Œå¦‚æœæ‰©å¤§å†…å­˜ï¼Œåˆ™åŸæ¥çš„å†…å­˜å—ä¿æŒä¸å˜ï¼Œåœ¨å†…å­˜å°¾éƒ¨å¢åŠ æ–°çš„å†…å­˜å—ï¼Œåˆ‡ä¸è¿›è¡Œåˆå§‹åŒ–ã€‚å¦‚æœç¼©å°å†…å­˜ï¼Œåˆ™åŸæ¥å†…å­˜å—ä»å°¾éƒ¨è¿›è¡Œåˆ å‡ã€‚å¦‚æœåŸå…ˆçš„å†…å­˜å—æ— æ³•æ‰©å……ï¼Œåˆ™æ–°å¼€è¾Ÿä¸€å—å†…å­˜ï¼Œå¹¶å¤åˆ¶åŸå…ˆçš„å†…å­˜çš„å†…å®¹ï¼ŒåŸå…ˆå†…å­˜å—å¤±æ•ˆæ— æ³•å†è¿›è¡Œè®¿é—®ã€‚ newå’Œmallocçš„åŒºåˆ«å±æ€§new/deleteæ˜¯C++å…³é”®å­—ï¼Œéœ€è¦ç¼–è¯‘å™¨æ”¯æŒã€‚malloc/freeæ˜¯åº“å‡½æ•°ï¼Œéœ€è¦å¤´æ–‡ä»¶æ”¯æŒcã€‚ å‚æ•°ä½¿ç”¨newæ“ä½œç¬¦ç”³è¯·å†…å­˜åˆ†é…æ—¶æ— é¡»æŒ‡å®šå†…å­˜çš„å¤§å°ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®ç±»å‹ä¿¡æ¯è‡ªè¡Œè®¡ç®—ã€‚è€Œmallocåˆ™éœ€è¦æ˜¾å¼åœ°æŒ‡å‡ºæ‰€éœ€å†…å­˜çš„å°ºå¯¸ã€‚ è¿”å›ç±»å‹newæ“ä½œç¬¦å†…å­˜åˆ†é…æˆåŠŸæ—¶ï¼Œè¿”å›çš„æ˜¯å¯¹è±¡ç±»å‹çš„æŒ‡é’ˆï¼Œç±»å‹ä¸¥æ ¼ä¸å¯¹è±¡åŒ¹é…ï¼Œæ— é¡»è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ•…newæ˜¯ç¬¦å·ç±»å‹å®‰å…¨çš„æ“ä½œç¬¦ã€‚è€Œmallocå†…å­˜åˆ†é…æˆåŠŸåˆ™è¿”å›void ï¼Œéœ€è¦é€šè¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢å°†void æŒ‡é’ˆè½¬æ¢æˆæˆ‘ä»¬éœ€è¦çš„ç±»å‹ã€‚ åˆ†é…å¤±è´¥newå†…å­˜åˆ†é…å¤±è´¥æ—¶ï¼Œä¼šæŠ›å‡ºbac_allocå¼‚å¸¸ã€‚mallocåˆ†é…å†…å­˜å¤±è´¥æ—¶ä¼šè¿”å›NULLã€‚ è‡ªå®šä¹‰ç±»å‹newä¼šå…ˆè°ƒç”¨operator newå‡½æ•°ï¼Œç”³è¯·è¶³å¤Ÿçš„å†…å­˜ï¼ˆé€šå¸¸åº•å±‚ä½¿ç”¨mallocå®ç°ï¼‰ã€‚ç„¶åè°ƒç”¨ç±»å‹çš„æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–æˆå‘˜å˜é‡ï¼Œæœ€åè¿”å›è‡ªå®šä¹‰ç±»å‹æŒ‡é’ˆã€‚deleteå…ˆè°ƒç”¨ææ„å‡½æ•°ï¼Œç„¶åè°ƒç”¨operator deleteå‡½æ•°é‡Šæ”¾å†…å­˜ï¼ˆé€šå¸¸åº•å±‚ä½¿ç”¨freeå®ç°ï¼‰ã€‚malloc/freeæ˜¯åº“å‡½æ•°ï¼Œåªèƒ½åŠ¨æ€çš„ç”³è¯·å’Œé‡Šæ”¾å†…å­˜ï¼Œæ— æ³•å¼ºåˆ¶è¦æ±‚å…¶åšè‡ªå®šä¹‰ç±»å‹å¯¹è±¡æ„é€ å’Œææ„å·¥ä½œã€‚ é‡è½½C++å…è®¸é‡è½½new/deleteæ“ä½œç¬¦ï¼Œmallocä¸å…è®¸é‡è½½ã€‚ å†…å­˜åŒºåŸŸnewæ“ä½œç¬¦ä»è‡ªç”±å­˜å‚¨åŒºï¼ˆfree storeï¼‰ä¸Šä¸ºå¯¹è±¡åŠ¨æ€åˆ†é…å†…å­˜ç©ºé—´ï¼Œè€Œmallocå‡½æ•°ä»å †ä¸ŠåŠ¨æ€åˆ†é…å†…å­˜ã€‚è‡ªç”±å­˜å‚¨åŒºæ˜¯C++åŸºäºnewæ“ä½œç¬¦çš„ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œå‡¡æ˜¯é€šè¿‡newæ“ä½œç¬¦è¿›è¡Œå†…å­˜ç”³è¯·ï¼Œè¯¥å†…å­˜å³ä¸ºè‡ªç”±å­˜å‚¨åŒºã€‚è€Œå †æ˜¯æ“ä½œç³»ç»Ÿä¸­çš„æœ¯è¯­ï¼Œæ˜¯æ“ä½œç³»ç»Ÿé”ç»´æŠ¤çš„ä¸€å—ç‰¹æ®Šå†…å­˜ï¼Œç”¨äºç¨‹åºçš„å†…å­˜åŠ¨æ€åˆ†é…ï¼ŒCè¯­è¨€ä½¿ç”¨mallocä»å †ä¸Šåˆ†é…å†…å­˜ï¼Œä½¿ç”¨freeé‡Šæ”¾å·²åˆ†é…çš„å¯¹åº”å†…å­˜ã€‚è‡ªç”±å­˜å‚¨åŒºä¸ç­‰äºå †ï¼Œå¦‚ä¸Šæ‰€è¿°ï¼Œå¸ƒå±€newå°±å¯ä»¥ä¸ä½äºå †ä¸­ã€‚ åœ¨C++/C#ä¸­ï¼Œå†…å­˜åŒºåˆ†ä¸º5ä¸ªåŒºï¼Œåˆ†åˆ«æ˜¯å †ã€æ ˆã€è‡ªç”±å­˜å‚¨åŒºã€å…¨å±€/é™æ€å­˜å‚¨åŒºã€å¸¸é‡å­˜å‚¨åŒºï¼›åœ¨Cä¸­ï¼Œå†…å­˜åŒºåˆ†ä¸ºå †ã€æ ˆã€å…¨å±€/é™æ€å­˜å‚¨åŒºã€å¸¸é‡å­˜å‚¨åŒºï¼›]]></content>
      <categories>
        <category>C++</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Google Protocol Buffer]]></title>
    <url>%2F2019%2F04%2F09%2Fprotocol-buffer%2F</url>
    <content type="text"><![CDATA[å®šä¹‰ä¸€ä¸ªæ¶ˆæ¯ç±»å‹123456message SearchRequest&#123; required string query = 1; optional int32 page_number = 2; optional int32 result_per_page = 3;&#125; è¯¥æ¶ˆæ¯å®šä¹‰äº†ä¸‰ä¸ªå­—æ®µï¼Œä¸¤ä¸ªint32ç±»å‹å’Œä¸€ä¸ªstringç±»å‹çš„å­—æ®µï¼Œæ¯ä¸ªå­—æ®µç”±å­—æ®µé™åˆ¶ï¼Œå­—æ®µç±»å‹ï¼Œå­—æ®µåå’ŒTagå››éƒ¨åˆ†ç»„æˆï¼Œå¯¹äºC++ï¼Œæ¯ä¸€ä¸ª.protoæ–‡ä»¶ç»è¿‡ç¼–è¯‘ä¹‹åéƒ½ä¼šå¯¹åº”çš„ç”Ÿæˆä¸€ä¸ª.hå’Œä¸€ä¸ª.ccæ–‡ä»¶ å­—æ®µé™åˆ¶å­—æ®µé™åˆ¶å…±æœ‰3ç±»required:å¿…é¡»èµ‹å€¼çš„å­—æ®µoptional:å¯æœ‰å¯æ— çš„å­—æ®µrepeated:å¯é‡å¤å­—æ®µï¼ˆå˜é•¿å­—æ®µï¼‰ï¼Œç±»ä¼¼äºæ•°ç»„ç”±äºä¸€äº›å†å²åŸå› ï¼Œrepeatedå­—æ®µå¹¶æ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆé«˜æ•ˆï¼Œæ–°ç‰ˆæœ¬ä¸­å…è®¸ä½¿ç”¨ç‰¹æ®Šçš„é€‰é¡¹æ¥è·å¾—æ›´é«˜æ•ˆçš„ç¼–ç ï¼š repeated int32 samples = 4 [packet=true]; Tagsæ¶ˆæ¯ä¸­çš„æ¯ä¸€ä¸ªå­—æ®µéƒ½ç”±ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„æ•°å€¼ç±»å‹çš„Tag.1åˆ°15ä½¿ç”¨ä¸€ä¸ªå­—èŠ‚ç¼–ç ï¼Œ16åˆ°2047ä½¿ç”¨2ä¸ªå­—èŠ‚ç¼–ç ï¼Œæ‰€ä»¥åº”è¯¥å°†Tags 1åˆ°15ç•™ä¸ªé¢‘ç¹ä½¿ç”¨çš„å­—æ®µã€‚å¯ä»¥æŒ‡å®šçš„æœ€å°çš„Tagä¸º1ï¼Œæœ€å¤§ä½$2^29$-1æˆ–536,870,911ï¼Œä½†ä¸èƒ½ä½¿ç”¨19000åˆ°19999ä¹‹é—´çš„å€¼ï¼Œè¿™äº›å€¼æ˜¯é¢„ç•™ç»™protocol bufferçš„ã€‚ Google Protocol Bufferçš„EncodingProtobufåºåˆ—åŒ–æ‰€ç”Ÿæˆçš„äºŒè¿›åˆ¶æ¶ˆæ¯éå¸¸ç´§å‡‘ï¼Œè¿™å¾—ç›ŠäºProtobufé‡‡ç”¨çš„éå¸¸å·§å¦™çš„Encodingæ–¹æ³•ã€‚è€ƒæ“¦æ¶ˆæ¯ç»“æ„ä¹‹å‰ï¼Œè®©æˆ‘é¦–å…ˆè¦ä»‹ç»ä¸€ä¸ªå«Varintçš„æœ¯è¯­ã€‚Varintæ˜¯ä¸€ç§ç´§å‡‘çš„è¡¨ç¤ºæ•°å­—çš„æ–¹æ³•ã€‚å®ƒç”¨ä¸€ä¸ªæˆ–è¿™ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºä¸€ä¸ªæ•°å­—ï¼Œå€¼è¶Šå°çš„æ•°å­—ä½¿ç”¨è¶Šå°çš„å­—èŠ‚æ•°ã€‚è¿™èƒ½å‡å°‘ç”¨æ¥è¡¨ç¤ºæ•°å­—çš„å­—èŠ‚æ•°ã€‚æ¯”å¦‚å¯¹äºint32ç±»å‹çš„æ•°å­—ï¼Œä¸€èˆ¬éœ€è¦4ä¸ªbyteæ¥è¡¨ç¤ºã€‚ä½†æ˜¯é‡‡ç”¨Varintï¼Œå¯¹äºå¾ˆå°çš„int32ç±»å‹çš„æ•°å­—ï¼Œåˆ™å¯ä»¥ç”¨1ä¸ªbyteæ¥è¡¨ç¤ºã€‚å¤§çš„æ•°å­—åˆ™éœ€è¦5ä¸ªbyteè¡¨ç¤ºã€‚ä»ç»Ÿè®¡çš„è§’åº¦æ¥è¯´ï¼Œä¸€èˆ¬ä¸ä¼šæ‰€æœ‰çš„æ¶ˆæ¯ä¸­çš„æ•°å­—éƒ½æ˜¯å¤§æ•°ï¼Œå› æ­¤å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œé‡‡ç”¨Varintåï¼Œå¯ä»¥ç”¨æ›´å°‘çš„å­—èŠ‚æ•°æ¥å§iaoshiæ•°å­—ä¿¡æ¯ã€‚ä¸‹é¢å°±è¯¦ç»†ä»‹ç»ä¸€ä¸‹Varintã€‚Varintä¸­çš„æ¯ä¸ªbyteçš„æœ€é«˜ä½bitæœ‰ç‰¹æ®Šçš„å«ä¹‰ï¼Œå¦‚æœè¯¥ä½ä¸º1ï¼Œè¡¨ç¤ºåç»­çš„byteä¹Ÿæ˜¯è¯¥æ•°å­—çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æœè¯¥ä½ä¸º0ï¼Œåˆ™ç»“æŸã€‚å…¶ä»–çš„7ä¸ªbitéƒ½ç”¨æ¥è¡¨ç¤ºæ•°å­—ã€‚å› æ­¤å°äº128çš„æ•°å­—éƒ½å¯ä»¥ç”¨ä¸€ä¸ªbyteè¡¨ç¤ºã€‚å¤§äº128çš„æ•°å­—ï¼Œæ¯”å¦‚300ï¼Œä¼šç”¨ä¸¤ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºï¼š1010 1100 0000 0010ä¸‹å›¾æ¼”ç¤ºäº†Google Protocol Bufferå¦‚ä½•è§£æä¸¤ä¸ªbytesã€‚æ³¨æ„åˆ°æœ€ç»ˆè®¡ç®—å‰å°†ä¸¤ä¸ªbyteçš„ä½ç½®ç›¸äº’äº¤æ¢è¿‡ä¸€æ¬¡ï¼Œè¿™æ˜¯å› ä¸ºGoogle Protocol Bufferå­—èŠ‚åºé‡‡ç”¨little-endiançš„æ–¹å¼ã€‚ æ¶ˆæ¯ç»è¿‡åºåˆ—åŒ–ä¼šæˆä¸ºä¸€ä¸ªäºŒè¿›åˆ¶æ•°æ®æµï¼Œè¯¥æµä¸­çš„æ•°æ®ä¸ºä¸€ç³»åˆ—çš„Key-Valueå¯¹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šé‡‡ç”¨è¿™ç§Key-Pairç»“æ„æ— éœ€ä½¿ç”¨åˆ†éš”ç¬¦æ¥åˆ†å‰²ä¸é€šçš„Fieldã€‚å¯¹äºå¯é€‰çš„Fieldï¼Œå¦‚æœæ¶ˆæ¯ä¸­ä¸å­˜åœ¨è¯¥Fieldï¼Œé‚£ä¹ˆåœ¨æœ€ç»ˆçš„Message Bufferä¸­å°±æ²¡æœ‰è¯¥fieldï¼Œè¿™äº›ç‰¹æ€§éƒ½æœ‰åŠ©äºèŠ‚çº¦æ¶ˆæ¯æœ¬èº«çš„å¤§å°ã€‚å‡å¦‚æˆ‘ä»¬ç”Ÿæˆå¦‚ä¸‹çš„ä¸€ä¸ªæ¶ˆæ¯Test1ï¼š Test1.id = 10; Test1.str = &quot;hello&quot;; åˆ™æœ€ç»ˆçš„Message Bufferä¸­æœ‰ä¸¤ä¸ªKey-Valueå¯¹ï¼Œä¸€ä¸ªå¯¹åº”æ¶ˆæ¯ä¸­çš„idï¼›å¦ä¸€ä¸ªå¯¹åº”strã€‚Keyç”¨æ¥æ ‡è¯†å…·ä½“çš„fieldï¼Œåœ¨è§£åŒ…çš„æ—¶å€™ï¼ŒProtocol Bufferæ ¹æ®Keyå°±å¯ä»¥çŸ¥é“ç›¸åº”çš„Valueåº”è¯¥å¯¹åº”äºæ¶ˆæ¯ä¸­é‚£ä¸€ä¸ªFieldã€‚Keyçš„å®šä¹‰å¦‚ä¸‹ï¼š (field_number&lt;&lt;3)|wire_type å¯ä»¥çœ‹åˆ°Keyç”±ä¸¤éƒ¨åˆ†ç»„æˆã€‚ç¬¬ä¸€éƒ¨åˆ†æ˜¯field_numberï¼Œæ¯”å¦‚æ¶ˆæ¯Im.helloworldä¸­çš„field idçš„field_numberä¸º1.ç¬¬äºŒéƒ¨åˆ†ä¸ºwire_typeã€‚è¡¨ç¤ºValueçš„ä¼ è¾“ç±»å‹ã€‚ Wire Typeå¯èƒ½çš„ç±»å‹å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š Type Meaning Used For 0 Varint int32,int64,uint32,uint64,sint32,sint64,bool,enum 1 64-bit fixed64,sfixed64,double åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œfield idæ‰€é‡‡ç”¨çš„æ•°æ®ç±»å‹ä¸ºint32ï¼Œå› æ­¤å¯¹åº”çš„wire typeä¸º0ã€‚å¯ä»¥çœ‹åˆ°Type 0æ‰€èƒ½è¡¨ç¤ºçš„æ•°æ®ç±»å‹ä¸­æœ‰int32å’Œsint32è¿™ä¸¤ä¸ªéå¸¸ç±»ä¼¼çš„æ•°æ®ç±»å‹ã€‚Google Protocol BufferåŒºåˆ«å®ƒä»¬çš„ä¸»è¦æ„å›¾ä¹Ÿæ˜¯ä¸ºäº†å‡å°‘encodingåçš„å­—èŠ‚æ•°ã€‚åœ¨è®¡ç®—å†…ï¼Œä¸€ä¸ªè´Ÿæ•°ä¸€èˆ¬ä¼šè¢«è¡¨ç¤ºä¸ºä¸€ä¸ªå¾ˆå¤§çš„æ•´æ•°ï¼Œå› ä¸ºè®¡ç®—æœºå®šä¹‰è´Ÿæ•°çš„ç¬¦å·ä½ä¸ºæ•°å­—çš„æœ€é«˜ä½ã€‚å¦‚æœé‡‡ç”¨Varintè¡¨ç¤ºä¸€ä¸ªè´Ÿæ•°ï¼Œé‚£ä¹ˆä¸€å®šéœ€è¦5ä¸ªbyteã€‚ä¸ºæ­¤Google Protocol Bufferå®šä¹‰äº†sint32è¿™ç§ç±»å‹ï¼Œé‡‡ç”¨zigzagç¼–ç ã€‚Zigzagç¼–ç ç”¨æ— ç¬¦å·æ•°æ¥è¡¨ç¤ºæœ‰ç¬¦å·æ•°å­—ï¼Œæ­£æ•°å’Œè´Ÿæ•°äº¤é”™ï¼Œè¿™å°±æ˜¯zigzagè¿™ä¸ªè¯çš„å«ä¹‰äº†ã€‚å¦‚å›¾æ‰€ç¤ºï¼š ä½¿ç”¨zigzagç¼–ç ï¼Œç»å¯¹å€¼å°çš„æ•°å­—ï¼Œæ— è®ºæ­£è´Ÿéƒ½å¯ä»¥é‡‡ç”¨è¾ƒå°‘çš„byteæ¥è¡¨ç¤ºï¼Œå……åˆ†åˆ©ç”¨äº†Varintè¿™ç§æŠ€æœ¯ã€‚å…¶ä»–çš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²åˆ™é‡‡ç”¨ç±»ä¼¼æ•°æ®åº“ä¸­çš„varcharçš„è¡¨ç¤ºæ–¹æ³•ï¼Œå³ç”¨ä¸€ä¸ªvarintè¡¨ç¤ºé•¿åº¦ï¼Œç„¶åå°†å…¶ä½™éƒ¨åˆ†ç´§è·Ÿåœ¨è¿™ä¸ªé•¿åº¦éƒ¨åˆ†ä¹‹åå³å¯ã€‚é€šè¿‡ä»¥ä¸Šå¯¹protobuf Encodingæ–¹æ³•çš„ä»‹ç»ï¼Œæƒ³å¿…å·²ç»å‘ç°protobufæ¶ˆæ¯çš„å†…å®¹æ•ˆï¼Œé€‚åˆç½‘ç»œä¼ è¾“ã€‚å¯¹äºæ¶ˆæ¯Test1ï¼Œç”¨Protobufåºåˆ—åŒ–åçš„å­—èŠ‚åºä¸ºï¼š08 65 12 06 48 65 6C 6C 6F 77è€Œå¦‚æœç”¨XMLï¼Œåˆ™ç±»ä¼¼è¿™æ ·31 30 31 3C 2F 69 64 3E 3C 6E 61 6D 65 3E 68 656C 6C 6F 3C 2F 6E 61 6D 65 3E 3C 2F 68 65 6C 6C6F 77 6F 72 6C 64 3Eä¸€å…±55ä¸ªå­—èŠ‚ï¼Œè¿™äº›å¥‡æ€ªçš„æ•°å­—éœ€è¦ç¨å¾®è§£é‡Šä¸€ä¸‹ï¼Œå…¶å«ä¹‰ç”¨ASCIIè¡¨ç¤ºå¦‚ä¸‹ï¼š 101 hello å°è§£åŒ…çš„é€Ÿåº¦é¦–å…ˆæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹XMLçš„å°è§£åŒ…è¿‡ç¨‹ã€‚XMLéœ€è¦ä»æ–‡ä»¶ä¸­è¯»å–å‡ºå­—ç¬¦ä¸²ï¼Œåœ¨è½¬æ¢ä¸ºXMLæ–‡æ¡£å¯¹è±¡ç»“æ„æ¨¡å‹ã€‚ä¹‹åï¼Œåœ¨ä»XMLæ–‡æ¡£å¯¹è±¡ç»“æ„æ¨¡å‹ä¸­è¯»å–æŒ‡å®šèŠ‚ç‚¹çš„å­—ç¬¦ä¸²ï¼Œæœ€åå†å°†è¿™ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆæŒ‡å®šç±»å‹çš„å˜é‡ã€‚è¿™ä¸ªè¿‡ç¨‹éå¸¸å¤æ‚ï¼Œå…¶ä¸­å°†XMLæ–‡ä»¶è½¬æ¢ä¸ºæ–‡æ¡£å¯¹è±¡ç»“æ„æ¨¡å‹çš„è¿‡ç¨‹é€šå¸¸éœ€è¦å®Œæˆè¯æ³•æ–‡æ³•åˆ†ç­‰å¤§é‡æ¶ˆè€—CPUçš„å¤æ‚è®¡ç®—ã€‚åè§‚Protobufï¼Œå®ƒåªéœ€è¦ç®€å•åœ°å°†ä¸€ä¸ªäºŒè¿›åˆ¶åºåˆ—ï¼ŒæŒ‰ç…§æŒ‡å®šçš„æ ¼å¼è¯»å–åˆ°C++å¯¹åº”çš„ç»“æ„ç±»å‹ä¸­å°±å¯ä»¥äº†ã€‚]]></content>
      <categories>
        <category>Server</category>
      </categories>
      <tags>
        <tag>Server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Lua hash]]></title>
    <url>%2F2019%2F04%2F09%2Flua-hash%2F</url>
    <content type="text"><![CDATA[ä¸€èˆ¬å“ˆå¸Œè¡¨å¤„ç†å†²çªæœ‰ä¸¤ç§æ–¹å¼ï¼Œæ‹‰é“¾æ³•å’Œå¼€æ”¾åœ°å€æ³•ã€‚æ‹‰é“¾æ³•å°±æ˜¯å“ˆå¸Œè¡¨çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œå¦‚æœæœ‰å†²çªçš„é”®å°±æ”¾åœ¨é“¾è¡¨é‡Œé¢ã€‚è€Œå¼€æ”¾åœ°å€æ³•æ˜¯å¦‚æœé‡åˆ°äº†å†²çªï¼Œå°±åœ¨è®¡ç®—ä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œç›´åˆ°æ²¡æœ‰å†²çªä½ç½®ã€‚æ‹‰é“¾æ³•çš„ä¼˜ç‚¹å°±æ˜¯å®ç°ç®€å•ï¼Œç¼ºç‚¹ä¹Ÿæ˜¯æœ‰çš„ï¼šé“¾è¡¨ä¼šå¯¼è‡´ä½çš„ç¼“å­˜å‘½ä¸­ç‡ï¼Œå¹¶ä¸”åˆ†é…é“¾è¡¨èŠ‚ç‚¹æœ¬èº«ä¹Ÿä¼šå¯¹å†…å­˜åˆ†é…å™¨äº§ç”Ÿå‹åŠ›ï¼ˆä¸»è¦æ˜¯å¤§é‡å°å—å†…å­˜åˆ†é…ä¼šå¯¼è‡´ç¢ç‰‡ï¼‰ï¼Œè€Œä¸”æœ‰ä¸ªæ›´ä¸¥é‡çš„é—®é¢˜ï¼šä¸å¤ªå¥½ä¼°è®¡å“ˆå¸Œè¡¨çš„è£…è½½å› å­ï¼Œå› æ­¤ä¸å¤ªå®¹æ˜“åˆ¤æ–­å•¥æ—¶å€™éœ€è¦æ‰©å……å“ˆå¸Œè¡¨ã€‚è€Œå¼€æ”¾åœ°å€æ³•é¿å…äº†è¿™äº›é—®é¢˜ï¼Œé¦–å…ˆå› ä¸ºæ‰€æœ‰èŠ‚ç‚¹éƒ½å­˜åœ¨å“ˆå¸Œè¡¨é‡Œé¢ï¼Œå› æ­¤å¾ˆå®¹æ˜“å°±èƒ½ä¼°è®¡è£…è½½å› å­ï¼Œå…¶æ¬¡ä¹Ÿä¸ä¼šæœ‰å†…å­˜åˆ†é…çš„é—®é¢˜ï¼Œé¿å…äº†é›¶æ•£ç¢ç‰‡æˆ–è€…å®ç°å†…å­˜æ± çš„å¿…è¦ã€‚ä¸è¿‡é—®é¢˜æ˜¯è¦æ‰¾åˆ°ä¸€ä¸ªæ–°çš„åœ°å€å°±éœ€è¦é‡æ–°è®¡ç®—å“ˆå¸Œï¼Œæ˜¯ä¸€ä¸ªè´Ÿæ‹…ï¼Œè€Œä¸”å¦‚æœåœ¨å¯¹åº”å“ˆå¸ŒæŸ¥ä¸åˆ°å…ƒç´ ä¹Ÿå¯èƒ½å¹¶ä¸æ˜¯æ²¡æœ‰å…ƒç´ ï¼Œè€Œåªæ˜¯ä¹‹å‰çš„å†²çªå¯¼è‡´å…ƒç´ ä¸å†å®ƒçš„â€ä¸»ä½ç½®â€ï¼Œè¿™æ ·å°±éœ€è¦æ›´å¤šå¤æ‚çš„åˆ¤æ–­ã€‚è§£å†³ä¸»ä½ç½®çš„é—®é¢˜å…¶å®å¾ˆç®€å•ï¼šå¯ä»¥è®¾ç½®ä¸€ä¸ªâ€å¢“ç¢‘â€ï¼Œåˆ é™¤çš„æ—¶å€™å¹¶ä¸æ˜¯ç›´æ¥åˆ é™¤ï¼Œè€Œæ˜¯è®¾ç½®ä¸€ä¸ªâ€å¢“ç¢‘â€å½“å‘ç°æ˜¯å¢“ç¢‘çš„æ—¶å€™ï¼Œè¯æ˜è¯¥ä½ç½®æ›¾ç»æ˜¯æœ‰å…ƒç´ çš„ï¼Œè¿™æ—¶æŒ‰ç…§å†²çªçš„æ–¹å¼ç»§ç»­æŸ¥æ‰¾ã€‚æ€»çš„æ¥è¯´ï¼Œå¦‚æœä¸è€ƒè™‘è£…è½½å› å­ï¼Œå› ä¸ºè¦é‡å¤æœç´¢å“ˆå¸Œè¡¨ï¼Œå¼€æ”¾åœ°å€æ³•çš„æŸ¥æ‰¾æ˜¯ä¼šæ¯”è¾ƒæ…¢çš„ã€‚Luaæ˜¯å°†æ‹‰é“¾æ³•å’Œå¼€æ”¾åœ°å€æ³•ç»“åˆåœ¨äº†ä¸€èµ·ã€‚å…·ä½“çš„åšæ³•æ˜¯è¿™æ ·çš„ï¼šLuaçš„å“ˆå¸Œè¡¨ä¸»ä½“æ˜¯å¼€æ”¾åœ°å€æ³•ï¼Œå³æ‰€æœ‰å…ƒç´ éƒ½è¢«å­˜æ”¾åœ¨è¡¨ä¸­ï¼Œè€Œä¸æ˜¯åœ¨é“¾è¡¨é‡Œã€‚ä½†æ˜¯ï¼Œæ¯ä¸ªå…ƒç´ ä¹Ÿçš„ç¡®æœ‰ä¸€ä¸ªé“¾è¡¨èŠ‚ç‚¹ã€‚åœ¨å¼€å§‹çš„æ—¶å€™ï¼ŒLuaç»´æŠ¤ä¸€ä¸ªâ€ç©ºé—²æ§½æŒ‡é’ˆâ€è¿™ä¸ªæŒ‡é’ˆä¹‹åçš„ä½ç½®ä¸€å®šéƒ½æ˜¯æœ‰å…ƒç´ çš„ã€‚å½“å‘ç°å†²çªçš„æ—¶å€™ï¼Œä¼šå°†ç©ºé—²æ§½æŒ‡é’ˆè¿ç§»ï¼Œä»¥æ‰¾åˆ°ä¸€ä¸ªç©ºé—²çš„æ§½ä½ï¼Œç„¶åå…ƒç´ ä¼šè¢«æ”¾åœ¨è¿™ä¸ªæ§½ä½é‡Œï¼Œå¹¶åœ¨ä¸»ä½ç½®é€šè¿‡é“¾è¡¨çš„æ–¹å¼é“¾æ¥è¿›æ¥ï¼å³å¯¹æ’å…¥è€Œè¨€ï¼ŒLuaçš„å“ˆå¸Œè¡¨é‡‡ç”¨å®é™…ä¸Šæ˜¯ä¸è®¡ç®—å“ˆå¸Œçš„å¼€æ”¾åœ°å€æ³•ï¼ˆéšæ„æ‰¾ä¸€ä¸ªæ§½ä½ï¼‰ï¼Œè€Œå¯¹äºæŸ¥æ‰¾è€Œè¨€ï¼Œå› ä¸ºæœ‰é“¾è¡¨èŠ‚ç‚¹çš„å­˜åœ¨ï¼Œæ˜¯æŒ‰ç…§æ‹‰é“¾æ³•çš„æ–¹å¼è¿›è¡ŒæŸ¥æ‰¾çš„ã€‚è¿™ç§æ–¹æ³•åˆ©ç”¨äº†ä¸¤è€…çš„ä¼˜ç‚¹ï¼Œåˆè§„é¿äº†ç¼ºé™·ã€‚è¿™é‡Œé¢å…¶å®è¿˜æ˜¯æœ‰ä¸€äº›å…¶å®ƒå¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ã€‚æ¯”å¦‚å¢“ç¢‘è¿˜æ˜¯éœ€è¦çš„ï¼Œè¿™ç”¨äºåœ¨ä¸»ä½ç½®æ‰¾ä¸åˆ°ä»¥åï¼Œå¾—å¾—åˆ°åç»­èŠ‚ç‚¹çš„ä¸€ä¸ªç´¢å¼•ã€‚ä½†æ˜¯é€šè¿‡åœ¨æ’å…¥/åˆ é™¤èŠ‚ç‚¹æ—¶ï¼ŒæŒªåŠ¨åç»­çš„èŠ‚ç‚¹çš„æ–¹æ³•ï¼Œå°±å¯ä»¥çœç•¥æ‰å¢“ç¢‘å’Œå¯¹åº”çš„éå†æ“ä½œã€‚å¦å¤–è¿™ç§å“ˆå¸Œè¡¨åˆ¤æ–­è£…è½½å› å­çš„æ–¹å¼ä¹Ÿå¾ˆç®€å•â€”åªè¦ç©ºé—²æ§½æŒ‡é’ˆæŒ‡å‘è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå°±æ„å‘³ç€è¡¨å·²ç»æ»¡äº†ï¼Œè¿™æ—¶å°±éœ€è¦rehashäº†ã€‚Luaçš„å“ˆå¸Œå‡½æ•°ä½¿ç”¨çš„æ˜¯é€šå¸¸çš„DJBæ³•ï¼Œä¹Ÿå«times33ï¼Œè®¡ç®—ç®€å•ï¼Œä¸è¿‡å¯èƒ½æ•ˆæœä¸å¤ªå¥½ï¼Œå¯¹éšæœºçš„å­—ç¬¦è¿™ç§æ–¹å¼äº§ç”Ÿçš„å“ˆå¸Œæ˜¯æ¯”è¾ƒå¹³å‡çš„ã€‚]]></content>
      <categories>
        <category>Lua</category>
      </categories>
      <tags>
        <tag>Lua</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Dictionary]]></title>
    <url>%2F2019%2F04%2F09%2Fdictionary%2F</url>
    <content type="text"><![CDATA[Entryç»“æ„ä½“è¿™æ˜¯Dictionaryå­˜æ”¾æ•°æ®çš„æœ€å°å•ä½ï¼Œè°ƒç”¨Add(Key,Value)æ–¹æ³•æ·»åŠ çš„å…ƒç´ éƒ½ä¼šè¢«å°è£…åœ¨è¿™æ ·çš„ä¸€ä¸ªç»“æ„ä½“ä¸­ã€‚1234567private struct Entry&#123; public int hashCode; // é™¤ç¬¦å·ä½ä»¥å¤–çš„31ä½hashCodeå€¼ï¼Œå¦‚æœè¯¥Entryæ²¡æœ‰è¢«ä½¿ç”¨ï¼Œé‚£ä¹ˆä¸º-1 public int next; // ä¸‹ä¸€ä¸ªå…ƒç´ çš„ä¸‹æ ‡ç´¢å¼•ï¼Œå¦‚æœæ²¡æœ‰ä¸‹ä¸€ä¸ªå°±ä¸º-1 public TKey key; // å­˜æ”¾å…ƒç´ çš„é”® public TValue value; // å­˜æ”¾å…ƒç´ çš„å€¼&#125; å…¶å®ƒå…³é”®ç§æœ‰å˜é‡123456789private int[] buckets; // Hashæ¡¶private Entry[] entries; // Entryæ•°ç»„ï¼Œå­˜æ”¾å…ƒç´ private int count; // å½“å‰entriesçš„indexä½ç½®private int version; // å½“å‰ç‰ˆæœ¬ï¼Œé˜²æ­¢è¿­ä»£è¿‡ç¨‹ä¸­é›†åˆè¢«æ›´æ”¹private int freeList; // è¢«åˆ é™¤Entryåœ¨entriesä¸­ä¸‹æ ‡indexï¼Œè¿™ä¸ªä½ç½®æ˜¯ç©ºé—²çš„private int freeCount; // æœ‰å¤šå°‘ä¸ªè¢«åˆ é™¤çš„Entryï¼Œæœ‰å¤šå°‘ä¸ªç©ºé—²çš„ä½ç½®private IEqualityComparer&lt;TKey&gt; comparer; // æ¯”è¾ƒå™¨private KeyCollection keys; // å­˜æ”¾keyçš„é›†åˆprivate ValueCollection values; // å­˜æ”¾Valueçš„é›†åˆ Addæ“ä½œé¦–å…ˆæˆ‘ä»¬ç”¨å›¾çš„å½¢å¼æ¥æè¿°ä¸€ä¸ªDictionaryçš„æ•°æ®ç»“æ„ï¼Œå…¶ä¸­åªç”»å‡ºäº†å…³é”®çš„åœ°æ–¹ã€‚æ¡¶å¤§å°ä¸º4ä»¥åŠEntryå¤§å°ä¹Ÿä¸º4çš„ä¸€ä¸ªæ•°æ®ç»“æ„ã€‚å‡è®¾éœ€è¦æ‰§è¡Œä¸€ä¸ªAddæ“ä½œï¼Œdictionary.Add(â€œaâ€,â€bâ€)ï¼Œå…¶ä¸­key=â€aâ€ï¼Œvalue=â€bâ€ã€‚ æ ¹æ®keyçš„å€¼ï¼Œè®¡ç®—å‡ºå®ƒçš„hashCodeã€‚æˆ‘ä»¬å‡è®¾â€aâ€çš„hashå€¼ä¸º6(GetHashCode(â€œaâ€)=6)ã€‚ é€šè¿‡å¯¹hashCodeå–ä½™è¿ç®—ï¼Œè®¡ç®—å‡ºè¯¥hashCodeè½åœ¨å“ªä¸€ä¸ªbucketsæ¡¶ä¸­ã€‚ç°åœ¨æ¡¶çš„é•¿åº¦(buckets.Length)ä¸º4ï¼Œé‚£ä¹ˆå°±æ˜¯6%4æœ€åè½åœ¨indexä¸º2çš„æ¡¶ä¸­ï¼Œä¹Ÿå°±æ˜¯buckets[2]ã€‚ æ¥ä¸‹æ¥å°†hashCodeã€keyã€valueç­‰ä¿¡æ¯å­˜å…¥entries[count]ä¸­ï¼Œå› ä¸ºcountä½ç½®æ˜¯ç©ºé—²çš„ï¼›ç»§ç»­count++æŒ‡å‘ä¸‹ä¸€ä¸ªç©ºé—²ä½ç½®ã€‚ä¸Šå›¾ä¸­ç¬¬ä¸€ä¸ªä½ç½®ï¼Œindex=0å°±æ˜¯ç©ºé—²çš„ï¼Œæ‰€ä»¥å°±å­˜æ”¾åœ¨entries[0]çš„ä½ç½®ã€‚ å°†Entryçš„ä¸‹æ ‡entryIndexèµ‹å€¼ç»™bucketsä¸­å¯¹åº”ä¸‹æ ‡çš„bucketã€‚æ­¥éª¤3ä¸­å­˜æ”¾åœ¨entries[0]çš„ä½ç½®ï¼Œæ‰€ä»¥buckets[2]=0ã€‚ æœ€åversion++ï¼Œé›†åˆå‘ç”Ÿäº†å˜åŒ–ï¼Œæ‰€ä»¥ç‰ˆæœ¬éœ€è¦+1ã€‚åªæœ‰å¢åŠ ã€æ›¿æ¢å’Œåˆ é™¤å…ƒç´ æ‰ä¼šæ›´æ–°ç‰ˆæœ¬ã€‚ å®Œæˆä¸Šé¢Addæ“ä½œåï¼Œæ•°æ®ç»“æ„æ›´æ–°æˆäº†ä¸‹å›¾è¿™æ ·çš„å½¢å¼ã€‚è¿™æ ·æ˜¯ç†æƒ³æƒ…å†µä¸‹çš„æ“ä½œï¼Œä¸€ä¸ªbucketä¸­åªæœ‰ä¸€ä¸ªhashCodeæ²¡æœ‰ç¢°æ’çš„äº§ç”Ÿï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯ä¼šç»å¸¸äº§ç”Ÿç¢°æ’ï¼›é‚£ä¹ˆDictionaryç±»ä¸­åˆæ˜¯å¦‚ä½•è§£å†³ç¢°æ’çš„å‘¢ã€‚æˆ‘ä»¬ç»§ç»­æ‰§è¡Œä¸€ä¸ªAddæ“ä½œï¼Œdictionary.Add(â€œcâ€,â€dâ€)ï¼Œå‡è®¾GetHashCode(â€œcâ€)=6ï¼Œæœ€å6%4=2ã€‚æœ€åæ¡¶çš„indexä¹Ÿæ˜¯2ï¼ŒæŒ‰ç…§ä¹‹å‰çš„æ­¥éª¤1~3æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œæ‰§è¡Œå®Œåæ•°æ®ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å¦‚æœç»§ç»­æ‰§è¡Œæ­¥éª¤4é‚£ä¹ˆbucket[2] = 1ï¼Œç„¶ååŸæ¥çš„buckets[2]=&gt;entries[0]çš„å…³ç³»å°±ä¼šä¸¢å¤±ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸æ„¿æ„çœ‹åˆ°çš„ã€‚ç°åœ¨Entryä¸­çš„nextå°±å‘æŒ¥å¤§ä½œç”¨äº†ã€‚ å¦‚æœå¯¹åº”çš„buckets[index]æœ‰å…¶å®ƒå…ƒç´ å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆä¼šæ‰§è¡Œä»¥ä¸‹ä¸¤æ¡è¯­å¥ï¼Œè®©æ–°çš„entry.nextæŒ‡å‘ä¹‹å‰çš„å…ƒç´ ï¼Œè®©buckets[index]æŒ‡å‘ç°åœ¨çš„æ–°å…ƒç´ ï¼Œå°±æ„æˆäº†ä¸€ä¸ªå•é“¾è¡¨ã€‚123entries[index].next = buckets[targetBucket];...buckets[targetBucket] = index; å®é™…ä¸Šæ­¥éª¤4ä¹Ÿå°±æ˜¯åšä¸€ä¸ªè¿™æ ·çš„æ“ä½œï¼Œå¹¶ä¸ä¼šå»åˆ¤æ–­æ˜¯ä¸æ˜¯æœ‰å…¶å®ƒå…ƒç´ ï¼Œå› ä¸ºbucketsä¸­æ¡¶åˆå§‹å€¼å°±æ˜¯-1ï¼Œä¸ä¼šé€ æˆé—®é¢˜ã€‚ ç»è¿‡ä¸Šé¢çš„æ­¥éª¤ä»¥åï¼Œæ•°æ®ç»“æ„å°±æ›´æ–°æˆäº†ä¸‹å›¾è¿™ä¸ªæ ·å­ Findæ“ä½œ]]></content>
      <categories>
        <category>CSharp</category>
      </categories>
      <tags>
        <tag>CSharp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å“ˆå¸Œè¡¨]]></title>
    <url>%2F2019%2F04%2F09%2Fhash%2F</url>
    <content type="text"><![CDATA[æ•£åˆ—è¡¨ï¼ˆHash tableï¼Œä¹Ÿå«å“ˆå¸Œè¡¨ï¼‰ï¼Œæ˜¯æ ¹æ®å…³é”®ç å€¼ï¼ˆkey valueï¼‰è€Œç›´æ¥è¿›è¡Œè®¿é—®çš„æ•°æ®ç»“æ„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒé€šè¿‡æŠŠå…³é”®ç å€¼æ˜ å°„åˆ°è¡¨ä¸­ä¸€ä¸ªä½ç½®æ¥è®¿é—®ï¼Œä»¥åŠ å¿«æŸ¥æ‰¾çš„é€Ÿåº¦ã€‚è¿™ä¸ªæ˜ å°„å‡½æ•°å«åšæ•£åˆ—å‡½æ•°ï¼Œå­˜æ”¾è®°å½•çš„æ•°ç»„å«åšæ•£åˆ—è¡¨ã€‚ç»™å®šè¡¨Mï¼Œå­˜åœ¨å‡½æ•°f(key)ï¼Œå¯¹ä»»æ„ç»™å®šçš„å…³é”®å€¼keyï¼Œä»£å…¥å‡½æ•°åè‹¥èƒ½å¾—åˆ°åŒ…å«è¯¥å…³é”®å­—çš„è®°å½•åœ¨è¡¨ä¸­çš„åœ°å€ï¼Œåˆ™ç§°è¡¨Mä¸ºå“ˆå¸Œï¼ˆHashï¼‰è¡¨ï¼Œå‡½æ•°fï¼ˆkeyï¼‰ä¸ºå“ˆå¸Œï¼ˆHashï¼‰å‡½æ•°ã€‚ åŸºæœ¬æ¦‚å¿µ è‹¥å…³é”®å­—ä¸ºkï¼Œåˆ™å…¶å€¼å­˜æ”¾åœ¨f(k)çš„å­˜å‚¨ä½ç½®ä¸Šã€‚ç”±æ­¤ï¼Œä¸éœ€æ¯”è¾ƒä¾¿å¯ç›´æ¥å–å¾—æ‰€æŸ¥è®°å½•ã€‚ç§°è¿™ä¸ªå¯¹åº”å…³ç³»fä¸ºæ•£åˆ—å‡½æ•°ï¼ŒæŒ‰è¿™ä¸ªæ€æƒ³å»ºç«‹çš„è¡¨ä¸ºæ•£åˆ—è¡¨ã€‚ å¯¹ä¸åŒçš„å…³é”®å­—å¯èƒ½å¾—åˆ°åŒä¸€æ•£åˆ—åœ°å€ï¼Œå³$k1 \neq k2$ï¼Œè€Œf(k1)=f(k2)ï¼Œè¿™ç§ç°è±¡ç§°ä¸ºå†²çªï¼ˆCollisionï¼‰ã€‚å…·æœ‰ç›¸åŒå‡½æ•°å€¼çš„å…³é”®å­—å¯¹è¯¥æ•£åˆ—å‡½æ•°æ¥è¯´ç§°ä½œåŒä¹‰è¯ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œæ ¹æ®æ•£åˆ—å‡½æ•°f(k)å’Œå¤„ç†å†²çªçš„æ–¹æ³•å°†ä¸€ç»„å…³é”®å­—æ˜ å°„åˆ°ä¸€ä¸ªæœ‰é™çš„è¿ç»­çš„åœ°å€é›†ï¼ˆåŒºé—´ï¼‰ä¸Šï¼Œå¹¶ä»¥å…³é”®å­—åœ¨åœ°å€é›†ä¸­çš„â€œåƒâ€ä½œä¸ºè®°å½•åœ¨è¡¨ä¸­çš„å­˜å‚¨ä½ç½®ï¼Œè¿™ç§è¡¨ä¾¿æˆä¸ºæ•£åˆ—è¡¨ï¼Œè¿™ä¸€æ˜ å°„è¿‡ç¨‹ç§°ä¸ºæ•£åˆ—é€ è¡¨æˆ–æ•£åˆ—ï¼Œæ‰€å¾—çš„å­˜å‚¨ä½ç½®æˆæ•£åˆ—åœ°å€ã€‚ è‹¥å¯¹äºå…³é”®å­—é›†åˆä¸­çš„ä»»ä¸€ä¸ªå…³é”®å­—ï¼Œç»æ•£åˆ—å‡½æ•°æ˜ å°„åˆ°åœ°å€é›†åˆä¸­ä»»ä½•ä¸€ä¸ªåœ°å€çš„æ¦‚ç‡æ˜¯ç›¸ç­‰çš„ï¼Œåˆ™ç§°æ­¤ç±»æ•£åˆ—å‡½æ•°ä¸ºå‡åŒ€æ•£åˆ—å‡½æ•°ï¼ˆUniform Hash functionï¼‰ï¼Œè¿™å°±æ˜¯å…³é”®å­—ç»è¿‡æ•£åˆ—å‡½æ•°å¾—åˆ°ä¸€ä¸ªâ€œéšæœºçš„åœ°å€â€ï¼Œä»è€Œå‡å°‘å†²çªã€‚ å¸¸ç”¨æ–¹æ³•æ•£åˆ—å‡½æ•°èƒ½ä½¿å¯¹ä¸€ä¸ªæ•°æ®åºåˆ—çš„è®¿é—®è¿‡ç¨‹æ›´åŠ è¿…é€Ÿæœ‰æ•ˆï¼Œé€šè¿‡æ•£åˆ—å‡½æ•°ï¼Œæ•°æ®å…ƒç´ å°†è¢«æ›´å¿«åœ°å®šä½ã€‚å®é™…å·¥ä½œéœ€è§†ä¸é€šçš„æƒ…å†µé‡‡ç”¨ä¸åŒçš„å“ˆå¸Œå‡½æ•°ï¼Œé€šå¸¸è€ƒè™‘çš„å› ç´ æœ‰ï¼š è®¡ç®—å“ˆå¸Œå‡½æ•°æ‰€éœ€æ—¶é—´ å…³é”®å­—çš„é•¿åº¦ å“ˆå¸Œè¡¨çš„å¤§å° å…³é”®å­—çš„åˆ†å¸ƒæƒ…å†µ è®°å½•çš„æŸ¥æ‰¾é¢‘ç‡ ç›´æ¥å¯»å€æ³•ï¼šå–å…³é”®å­—æˆ–å…³é”®å­—çš„æŸä¸ªçº¿æ€§å‡½æ•°å€¼ä¸ºæ•£åˆ—åœ°å€ã€‚å³H(key)=keyæˆ–H(key)=aÂ·key + bï¼Œå…¶ä¸­aå’Œbä¸ºå¸¸æ•°ï¼ˆè¿™ç§æ•£åˆ—å‡½æ•°å«åšè‡ªèº«å‡½æ•°ï¼‰ã€‚è‹¥å…¶ä¸­H(key)ä¸­å·²ç»æœ‰å€¼äº†ï¼Œå°±å¾€ä¸‹ä¸€ä¸ªæ‰¾ï¼Œç›´åˆ°H(key)ä¸­æ²¡æœ‰å€¼äº†ï¼Œå°±æ”¾è¿›å»ã€‚ æ•°å­—åˆ†ææ³•ï¼šåˆ†æä¸€ç»„æ•°æ®ï¼Œæ¯”å¦‚ä¸€ç»„å‘˜å·¥çš„å‡ºç”Ÿå¹´æœˆæ—¥ï¼Œè¿™æ—¶æˆ‘ä»¬å‘ç°å‡ºç”Ÿå¹´æœˆæ—¥çš„å‰å‡ ä½æ•°å­—å¤§ä½“ç›¸åŒï¼Œè¿™æ ·çš„è¯ï¼Œå‡ºç°å†²çªçš„å‡ ç‡å°±ä¼šå¾ˆå¤§ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°å¹´æœˆæ—¥çš„åå‡ ä½è¡¨ç¤ºæœˆä»½å’Œå…·ä½“æ—¥æœŸçš„æ•°å­—å·®åˆ«å¾ˆå¤§ï¼Œå¦‚æœç”¨åé¢çš„æ•°å­—æ¥æ„å»ºæ•£åˆ—åœ°å€ï¼Œåˆ™å†²çªçš„å‡ ç‡å°±ä¼šæ˜æ˜¾é™ä½ã€‚å› æ­¤æ•°å­—åˆ†ææ³•å°±æ˜¯æ‰¾å‡ºæ•°å­—çš„è§„å¾‹ï¼Œå°½å¯èƒ½åˆ©ç”¨è¿™äº›æ•°æ®æ¥æ„é€ å†²çªå‡ ç‡è¾ƒä½çš„æ•£åˆ—åœ°å€ã€‚ å¹³æ–¹å–ä¸­æ³•ï¼šå½“æ— æ³•ç¡®å®šå…³é”®å­—ä¸­å“ªå‡ ä½åˆ†å¸ƒè¾ƒå‡åŒ€æ—¶ï¼Œå¯ä»¥å…ˆæ±‚å‡ºå…³é”®å­—çš„å¹³æ–¹å€¼ï¼Œç„¶åæŒ‰éœ€è¦å–å¹³æ–¹å€¼çš„ä¸­é—´å‡ ä½ä½œä¸ºå“ˆå¸Œåœ°å€ã€‚è¿™æ˜¯å› ä¸ºï¼šå¹³æ–¹åä¸­é—´å‡ ä½å’Œå…³é”®å­—ä¸­æ¯ä¸€ä½éƒ½ç›¸å…³ï¼Œæ•…ä¸åŒå…³é”®å­—ä¼šä»¥è¾ƒé«˜çš„æ¦‚ç‡äº§ç”Ÿä¸åŒçš„å“ˆå¸Œåœ°å€ã€‚ä¾‹ï¼šæˆ‘ä»¬æŠŠè‹±æ–‡å­—æ¯åœ¨å­—æ¯è¡¨ä¸­çš„ä½ç½®åºå·ä½œä¸ºè¯¥è‹±æ–‡å­—æ¯çš„å†…éƒ¨ç¼–ç ã€‚ä¾‹å¦‚Kçš„å†…éƒ¨ç¼–ç ä¸º11ï¼ŒEçš„å†…éƒ¨ç¼–ç ä¸º05ï¼ŒYçš„å†…éƒ¨ç¼–ç ä¸º25ï¼ŒAçš„å†…éƒ¨ç¼–ç ä¸º01ï¼ŒBçš„å†…éƒ¨ç¼–ç ä¸º02ã€‚ç”±æ­¤ç»„æˆå…³é”®å­—â€œKEYAâ€çš„å†…éƒ¨ä»£ç ä¸º1105201ï¼ŒåŒç†æˆ‘ä»¬å¯ä»¥å¾—åˆ°å…³é”®å­—â€œKYABâ€ã€â€œAKEYâ€ã€â€œBKEYâ€çš„å†…éƒ¨ç¼–ç ã€‚ä¹‹åå¯¹å…³é”®å­—è¿›è¡Œå¹³æ–¹è¿ç®—åï¼Œå–å‡ºç¬¬7ä½åˆ°ç¬¬9ä½ä½œä¸ºè¯¥å…³é”®å­—å“ˆå¸Œåœ°å€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º å…³é”®å­— å†…éƒ¨ç¼–ç  å†…éƒ¨ç¼–ç çš„å¹³æ–¹å€¼ H(k)å…³é”®å­—çš„å“ˆå¸Œåœ°å€ KEYA 11052501 122157778355001 778 KEYB 11250102 126564795010404 795 AKEY 01110525 001233265775625 265 BKEY 02110525 004454315775625 315 æŠ˜å æ³•ï¼šå°†å…³é”®å­—åˆ†å‰²æˆä½æ•°ç›¸åŒçš„å‡ éƒ¨åˆ†ï¼Œæœ€åä¸€éƒ¨åˆ†ä½æ•°å¯ä»¥ä¸åŒï¼Œç„¶åå–è¿™å‡ éƒ¨åˆ†çš„å åŠ å’Œï¼ˆå»é™¤è¿›ä½ï¼‰ä½œä¸ºæ•£åˆ—åœ°å€ã€‚æ•°ä½å åŠ å¯ä»¥æœ‰ç§»ä½å åŠ å’Œé—´ç•Œå åŠ ä¸¤ç§æ–¹æ³•ã€‚ç§»ä½å åŠ æ˜¯å°†åˆ†å‰²åçš„æ¯ä¸€éƒ¨åˆ†çš„æœ€ä½ä½å¯¹é½ï¼Œç„¶åç›¸åŠ ï¼›é—´ç•Œå åŠ æ˜¯ä»ä¸€ç«¯å‘å¦ä¸€ç«¯åˆ†å‰²ç•Œæ¥å›æŠ˜å ï¼Œç„¶åå¯¹é½ç›¸åŠ ã€‚ éšæœºæ•°æ³•ï¼šé€‰æ‹©ä¸€éšæœºå‡½æ•°ï¼Œå–å…³é”®å­—çš„éšæœºå€¼ä½œä¸ºæ•£åˆ—åœ°å€ï¼Œé€šå¸¸ç”¨äºå…³é”®å­—é•¿åº¦ä¸åŒçš„åœºåˆã€‚ é™¤ç•™ä½™æ•°æ³•ï¼šå–å…³é”®å­—è¢«æŸä¸ªä¸å¤§äºæ•£åˆ—è¡¨è¡¨é•¿mçš„æ•°pé™¤åæ‰€å¾—çš„ä½™æ•°ä¸ºæ•£åˆ—åœ°å€ã€‚å³H(key)=key MOD p,p &lt;= mã€‚ä¸ä»…å¯ä»¥å¯¹å…³é”®å­—ç›´æ¥å–æ¨¡ï¼Œä¹Ÿå¯åœ¨æŠ˜å ã€å¹³æ–¹å–ä¸­ç­‰è¿ç®—ä¹‹åå–æ¨¡ã€‚å¯¹pçš„é€‰æ‹©å¾ˆé‡è¦ï¼Œä¸€èˆ¬å–ç´ æ•°æˆ–mï¼Œè‹¥pé€‰çš„ä¸å¥½ï¼Œå®¹æ˜“äº§ç”ŸåŒä¹‰è¯ã€‚ Hashæ¡¶ç®—æ³•è¯´åˆ°Hashç®—æ³•å°±ä¼šæƒ³åˆ°hashè¡¨ï¼Œä¸€ä¸ªkeyé€šè¿‡hashå‡½æ•°è¿ç®—åå¯å¿«é€Ÿå¾—åˆ°hashCodeï¼Œé€šè¿‡hashCodeçš„æ˜ å°„å¯ç›´æ¥è·å–Valueï¼Œä½†æ˜¯hashCodeä¸€èˆ¬å–å€¼éƒ½æ˜¯éå¸¸å¤§çš„ï¼Œç»å¸¸æ˜¯$2^32$ä»¥ä¸Šï¼Œä¸å¯èƒ½å¯¹æ¯ä¸ªhashCodeéƒ½æŒ‡å®šä¸€ä¸ªæ˜ å°„ã€‚å› ä¸ºè¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥å°†hashCodeä»¥åˆ†æ®µçš„å½¢å¼æ¥æ˜ å°„ï¼ŒæŠŠæ¯ä¸€æ®µç§°ä¹‹ä¸ºä¸€ä¸ªBucket(æ¡¶)ï¼Œä¸€èˆ¬å¸¸è§çš„Hashæ¡¶å°±æ˜¯ç›´æ¥å°†ç»“æœå–ä½™ã€‚ å¤„ç†å†²çª å¼€æ”¾å¯»å€æ³•ï¼šHi=(H(key)+di)MOD m,i=1,2,â€¦,k(k&lt;=m-1)ï¼Œå…¶ä¸­H(key)ä¸ºæ•£åˆ—å‡½æ•°ï¼Œmä¸ºæ•£åˆ—è¡¨é•¿ï¼Œdiä¸ºå¢é‡åºåˆ—ï¼Œå¯æœ‰ä¸‹åˆ—3ç§å–æ³•ï¼š1.1. di=1,2,3,â€¦,m-1ï¼Œç§°çº¿æ€§æ¢æµ‹åœ¨æ•£åˆ—ï¼›1.2. $di=1^2,-1^2,2^2,-2^2,â€¦,k^2,-k^2(k&lt;=m/2)$ç§°ä¸ºäºŒæ¬¡æ¢æµ‹åœ¨æ•£åˆ—ï¼›1.3. di=ä¼ªéšæœºæ•°åºåˆ—ï¼Œç§°ä¼ªéšæœºæ¢æµ‹åœ¨æ•£åˆ—ã€‚ å†æ•£åˆ—æ³•ï¼šHi=RHi(key),i\1,2,â€¦,k RHiå‡æ˜¯ä¸é€šçš„æ•£åˆ—å‡½æ•°ï¼Œå³åœ¨åŒä¹‰è¯äº§ç”Ÿåœ°å€å†²çªæ—¶è®¡ç®—å¦ä¸€ä¸ªæ•£åˆ—å‡½æ•°åœ°å€ï¼Œç›´åˆ°å†²çªä¸å†å‘ç”Ÿï¼Œè¿™ç§æ–¹æ³•ä¸æ˜“äº§ç”Ÿâ€œèšé›†â€ï¼Œä½†å¢åŠ äº†è®¡ç®—æ—¶é—´ã€‚ é“¾åœ°å€æ³•ï¼ˆæ‹‰é“¾æ³•ï¼‰ï¼šè¿™ç§æ–¹æ³•çš„æ€è·¯æ˜¯å°†äº§ç”Ÿå†²çªçš„å…ƒç´ å»ºç«‹ä¸€ä¸ªå•é“¾è¡¨ï¼Œå¹¶å°†å¤´æŒ‡é’ˆåœ°å€å­˜å‚¨åˆ°hashè¡¨å¯¹åº”æ¡¶çš„ä½ç½®ã€‚è¿™æ ·å®šä½åˆ°Hashè¡¨æ¡¶çš„ä½ç½®åå¯é€šè¿‡éå†å•é“¾è¡¨çš„å½¢å¼æŸ¥æ‰¾å…ƒç´ ã€‚ å»ºç«‹ä¸€ä¸ªå…¬å…±æº¢å‡ºåŒº æŸ¥æ‰¾æ€§èƒ½æ•£åˆ—è¡¨çš„æŸ¥æ‰¾è¿‡ç¨‹åŸºæœ¬ä¸Šå’Œé€ è¡¨è¿‡ç¨‹ç›¸åŒã€‚ä¸€äº›å…³é”®ç å¯é€šè¿‡æ•£åˆ—å‡½æ•°è½¬æ¢çš„åœ°å€ç›´æ¥æ‰¾åˆ°ï¼Œå¦ä¸€äº›å…³é”®ç åœ¨æ•£åˆ—å‡½æ•°å¾—åˆ°çš„åœ°å€ä¸Šäº§ç”Ÿäº†å†²çªï¼Œéœ€è¦æŒ‰å¤„ç†å†²çªçš„æ–¹æ³•è¿›è¡ŒæŸ¥æ‰¾ã€‚åœ¨ä»‹ç»çš„ä¸‰ç§å¤„ç†å†²çªçš„æ–¹æ³•ä¸­ï¼Œäº§ç”Ÿå†²çªåçš„æŸ¥æ‰¾ä»ç„¶æ˜¯ç»™å®šå€¼ä¸å…³é”®ç è¿›è¡Œæ¯”è¾ƒçš„è¿‡ç¨‹ã€‚æ‰€ä»¥ï¼Œå¯¹æ•£åˆ—è¡¨æŸ¥æ‰¾æ•ˆç‡çš„é‡åº¦ï¼Œä¾ç„¶ç”¨å¹³å‡æŸ¥æ‰¾é•¿åº¦æ¥è¡¡é‡ã€‚æŸ¥æ‰¾è¿‡ç¨‹ä¸­ï¼Œå…³é”®ç çš„æ¯”è¾ƒæ¬¡æ•°ï¼Œå–å†³äºäº§ç”Ÿå†²çªçš„å¤šå°‘ï¼Œäº§ç”Ÿçš„å†²çªå°‘ï¼ŒæŸ¥æ‰¾æ•ˆç‡å°±é«˜ï¼Œäº§ç”Ÿçš„å†²çªå¤šï¼ŒæŸ¥æ‰¾æ•ˆç‡å°±ä½ã€‚å› æ­¤ï¼Œå½±å“äº§ç”Ÿå†²çªå¤šå°‘çš„å› ç´ ï¼Œä¹Ÿå°±æ˜¯å½±å“æŸ¥æ‰¾æ•ˆç‡çš„å› ç´ ã€‚å½±å“äº§ç”Ÿå†²çªå¤šå°‘æœ‰ä»¥ä¸‹3ä¸ªå› ç´ ï¼š æ•£åˆ—å‡½æ•°æ˜¯å¦å‡åŒ€ï¼› å¤„ç†å†²çªçš„æ–¹æ³•ï¼› æ•£åˆ—è¡¨çš„è£…å¡«å› å­ï¼›æ•£åˆ—è¡¨çš„è£…å¡«å› å­å®šä¹‰ä¸ºï¼š$\alpha$=å¡«å…¥è¡¨ä¸­çš„å…ƒç´ ä¸ªæ•°/æ•£åˆ—è¡¨çš„é•¿åº¦$\alpha$æ˜¯æ•£åˆ—è¡¨è£…æ»¡ç¨‹åº¦çš„æ ‡å¿—å› å­ã€‚ç”±äºè¡¨é•¿æ˜¯å®šå€¼ï¼Œ$\alpha$ä¸â€œå¡«å…¥è¡¨ä¸­çš„å…ƒç´ ä¸ªæ•°â€æˆæ­£æ¯”ï¼Œæ‰€ä»¥ï¼Œ$\alpha$è¶Šå¤§ï¼Œå¡«å…¥è¡¨ä¸­çš„å…ƒç´ è¾ƒå¤šï¼Œäº§ç”Ÿå†²çªçš„å¯èƒ½æ€§å°±è¶Šå¤§ï¼›$\alpha$è¶Šå°ï¼Œå¡«å…¥è¡¨ä¸­çš„å…ƒç´ è¾ƒå°‘ï¼Œäº§ç”Ÿå†²çªçš„å¯èƒ½æ€§å°±è¶Šå°ã€‚å®é™…ä¸Šï¼Œæ•£åˆ—è¡¨çš„å¹³å‡æŸ¥æ‰¾é•¿åº¦æ˜¯è£…å¡«å› å­$\alpha$çš„å‡½æ•°ï¼Œåªæ˜¯ä¸åŒå¤„ç†å†²çªçš„æ–¹æ³•æœ‰ä¸åŒçš„å‡½æ•°ã€‚ å¸¸è§çš„hashå‡½æ•°MD4MD4(RFC 1320)æ˜¯MITçš„Ronald L.Riveståœ¨1990å¹´è®¾è®¡çš„ï¼ŒMDæ˜¯Message Digestçš„ç¼©å†™ã€‚å®ƒé€‚ç”¨åœ¨32ä½å­—é•¿çš„å¤„ç†å™¨ä¸Šç”¨é«˜é€Ÿè½¯ä»¶å®ç°ï¼Œå®ƒæ˜¯åŸºäº32ä½æ“ä½œæ•°çš„ä½æ“ä½œæ¥å®ç°çš„ã€‚ MD5MD5(RFC 1321)æ˜¯Rivestäº1991å¹´å¯¹MD4çš„æ”¹è¿›ç‰ˆæœ¬ã€‚å®ƒå¯¹è¾“å…¥ä»ä»¥512ä½åˆ†ç»„ï¼Œå…¶è¾“å‡ºæ˜¯4ä¸ª32ä½å­—çš„çº§è”ï¼Œä¸MD4ç›¸åŒã€‚MD5æ¯”MD4æ¥çš„å¤æ‚ï¼Œå¹¶ä¸”é€Ÿåº¦è¾ƒä¹‹è¦æ…¢ä¸€ç‚¹ï¼Œä½†æ›´å®‰å…¨ï¼Œåœ¨æŠ—åˆ†æå’ŒæŠ—å·®åˆ†æ–¹é¢è¡¨ç°æ›´å¥½ SHA-1SHA1æ˜¯ç”±NIST NSAè®¾è®¡ä¸ºåŒDSAä¸€èµ·ä½¿ç”¨çš„ï¼Œå®ƒå¯¹é•¿åº¦å°äº264çš„è¾“å…¥ï¼Œäº§ç”Ÿé•¿åº¦ä¸º160bitçš„æ•£åˆ—å€¼ï¼Œå› æ­¤æŠ—ç©·ä¸¾ï¼ˆbruteforceï¼‰æ€§æ›´å¥½ã€‚SHA-1è®¾è®¡æ—¶åŸºäºå’ŒMD4ç›¸åŒåŸç†ï¼Œå¹¶ä¸”æ¨¡ä»¿äº†è¯¥ç®—æ³•ã€‚ ç”¨é€”æ–‡ä»¶æ ¡éªŒæˆ‘ä»¬æ¯”è¾ƒç†Ÿæ‚‰çš„æ ¡éªŒç®—æ³•æœ‰å¥‡å¶æ ¡éªŒå’ŒCRCæ ¡éªŒï¼Œè¿™ä¸¤ç§æ ¡éªŒå¹¶æ²¡æœ‰æŠ—æ•°æ®ç¯¡æ”¹çš„èƒ½åŠ›ï¼Œå®ƒä»¬ä¸€å®šç¨‹åº¦ä¸Šèƒ½æ£€æµ‹å‡ºæ•°æ®ä¼ è¾“ä¸­ä¿¡é“è¯¯ç ï¼Œä½†å´ä¸èƒ½é˜²æ­¢å¯¹æ•°æ®çš„æ¶æ„ç ´åã€‚MD5 Hashç®—æ³•çš„â€œæ•°å­—æŒ‡çº¹â€ç‰¹æ€§ï¼Œä½¿å®ƒæˆä¸ºç›®å‰åº”ç”¨æœ€å¹¿å‘çš„ä¸€ç§æ–‡ä»¶å®Œæ•´æ€§æ ¡éªŒå’Œï¼ˆChecksumï¼‰ç®—æ³•ï¼Œä¸å°‘Unixç³»ç»Ÿæœ‰æä¾›è®¡ç®—md5 checksumçš„å‘½ä»¤ã€‚ æ•°å­—ç­¾åHashç®—æ³•ä¹Ÿæ˜¯ç°ä»£å¯†ç ä½“ç³»ä¸­çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ã€‚ç”±äºéå¯¹ç§°ç®—æ³•çš„è¿ç®—é€Ÿåº¦è¾ƒæ…¢ï¼Œæ‰€ä»¥åœ¨æ•°å­—ç­¾ååè®®ä¸­ï¼Œå•å‘æ•£åˆ—å‡½æ•°æ‰®æ¼”äº†ä¸€ä¸ªé‡è¦çš„è§’è‰²ã€‚å¯¹hashå€¼ï¼Œåˆç§°â€œæ•°å­—æ‘˜è¦â€è¿›è¡Œæ•°å­—ç­¾åï¼Œåœ¨ç»Ÿè®¡ä¸Šå¯ä»¥è®¤ä¸ºä¸å¯¹æ–‡ä»¶æœ¬èº«è¿›è¡Œæ•°å­—ç­¾åæ˜¯ç­‰æ•ˆçš„ã€‚ é‰´æƒåè®®å¦‚ä¸‹çš„é‰´æƒåè®®åˆè¢«ç§°ä½œæŒ‘æˆ˜â€”è®¤è¯æ¨¡å¼ï¼šåœ¨ä¼ è¾“ä¿¡é“æ˜¯å¯è¢«ä¾¦å¬ï¼Œä½†ä¸å¯è¢«ç¯¡æ”¹çš„æƒ…å†µä¸‹ï¼Œè¿™æ˜¯ä¸€ç§ç®€å•è€Œå®‰å…¨çš„æ–¹æ³•ã€‚ MD5ã€SHA1çš„ç ´è§£2004å¹´8æœˆ17æ—¥ï¼Œåœ¨ç¾å›½å›½é™…å¯†ç å¤§ä¼šä¸ŠMD5ã€HAVAL-128ã€MD4å’ŒRIPEMDç­‰å››ä¸ªè‘—åå¯†ç ç®—æ³•çš„ç ´è¯‘ç»“æœã€‚2005å¹´å®£å¸ƒç ´è§£SHA-1å¯†ç ã€‚ å­—ç¬¦ä¸²ï¼ˆELFhashç®—æ³•ï¼‰12345678910111213int ELFhash(char* key)&#123; unsigned long h = 0; while(*key) &#123; h = (h&lt;&lt;4)+*key++; unsigned long g = h &amp; 0xF0000000L; if (g) h ^= g &gt;&gt; 24; h &amp;= ~g; &#125; return h % MOD;&#125;]]></content>
      <categories>
        <category>æ•°æ®ç»“æ„</category>
      </categories>
      <tags>
        <tag>æ•°æ®ç»“æ„</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é€æ˜ç‰©ä½“çš„æ·±åº¦å†™å…¥é—®é¢˜]]></title>
    <url>%2F2019%2F04%2F09%2Falpha-depth-write%2F</url>
    <content type="text"><![CDATA[é€šå¸¸æ¥è¯´ï¼Œé€æ˜ç‰©ä½“æ˜¯ä¸éœ€è¦å†™æ·±åº¦çš„ï¼Œä¾‹å¦‚ï¼š é€æ˜ç‰©ä½“ä¸éé€æ˜ç‰©ä½“é—´çš„æ¸²æŸ“ä¸ä¼šæœ‰é—®é¢˜ï¼Œå› ä¸ºæ‰€æœ‰é€æ˜ç‰©ä½“ä¼šåœ¨æ‰€æœ‰éé€æ˜ç‰©ä½“ä¹‹åæ¸²æŸ“ã€‚ å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œé€æ˜ç‰©ä½“ä¹‹é—´çš„æ¸²æŸ“ä¹Ÿä¸ä¼šæœ‰é—®é¢˜ï¼Œå› ä¸ºï¼Œæ‰€æœ‰é€æ˜ç‰©ä½“æŒ‰ç”±è¿œåŠè¿‘çš„é¡ºåºæ¸²æŸ“ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°å‰é¢çš„é€æ˜ç‰©ä½“æŒ¡ä½åé¢çš„é€æ˜ç‰©ä½“ï¼Œå¯¼è‡´åé¢çš„é€æ˜ç‰©ä½“ä¸æ˜¾ç¤ºã€‚ ä½†æœ‰äº›æƒ…å†µä¸‹ï¼Œé€æ˜ç‰©ä½“å¿…é¡»è¦å†™æ·±åº¦ï¼Œä¾‹å¦‚ï¼š ä¸¤ä¸ªé€æ˜æ— é—´æœ‰äº¤å‰ï¼Œå¦‚æœä¸å†™æ·±åº¦ï¼Œæ·±åº¦åˆ™æ— æ³•æ­£ç¡®æ¯”è¾ƒï¼Œå°±ä¼šå‡ºç°é®æŒ¡å…³ç³»é”™è¯¯çš„ç°è±¡ã€‚ å›¾1ä¸ºä¿¯è§†è§’åº¦çœ‹ä¸¤é¢ç‰‡]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AssetBundleåŸºæœ¬åŸç†]]></title>
    <url>%2F2019%2F04%2F09%2Fassetbundle-fundamentals%2F</url>
    <content type="text"><![CDATA[æ¦‚è¿°AssetBundleç³»ç»Ÿæä¾›äº†å°†ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶å­˜å‚¨åˆ°Unityèƒ½å¤Ÿè¿›è¡Œç´¢å¼•å’Œåºåˆ—åŒ–çš„æ¡£æ¡ˆæ ¼å¼çš„æ–¹æ³•ï¼Œå®ƒæ˜¯Unityç”¨æ¥åœ¨åº”ç”¨ç¨‹åºå®‰è£…ä¹‹åè¿›è¡Œåˆ†å‘å’Œæ›´æ–°éä»£ç å†…å®¹çš„é¦–é€‰å·¥å…·ã€‚é€šè¿‡AssetBundleï¼Œå¼€å‘è€…å¯ä»¥æäº¤æ›´å°çš„ç¨‹åºå®‰è£…åŒ…ã€æœ€å°åŒ–è¿è¡Œæ—¶å†…å­˜å‹åŠ›ä»¥åŠæ ¹æ®ç»ˆç«¯ç”¨æˆ·è®¾å¤‡é€‰æ‹©æ€§åœ°åŠ è½½ä¼˜åŒ–å†…å®¹ã€‚ AssetBundleå¸ƒå±€ç®€å•æ¥è¯´ï¼Œä¸€ä¸ªAssetBundleä¸­åŒ…å«ä¸¤éƒ¨åˆ†ï¼šæ•°æ®å¤´å’Œæ•°æ®æ®µã€‚æ•°æ®å¤´ä¸­å«æœ‰AssetBundleçš„ç›¸å…³ä¿¡æ¯ï¼Œä¾‹å¦‚æ ‡å¿—ç¬¦ï¼ˆIdentifierï¼‰ã€å‹ç¼©ç±»å‹ï¼ˆCompression Typeï¼‰å’Œé…ç½®æ–‡ä»¶ï¼ˆManifestï¼‰ã€‚é…ç½®æ–‡ä»¶æ˜¯ä¸€ä¸ªä»¥Objectåç§°ä¸ºé”®çš„æŸ¥æ‰¾è¡¨ï¼Œè¡¨ä¸­çš„æ¯ä¸ªæ¡ç›®å¤´æä¾›äº†ä¸€ä¸ªç”¨äºæ ‡è¯†Objectåœ¨æ•°æ®æ®µä¸­çš„ä½ç½®çš„byteç´¢å¼•ã€‚åœ¨å¤§å¤šæ•°å¹³å°ä¸Šï¼Œè¿™ä¸ªæŸ¥æ‰¾è¡¨æ˜¯ç”¨å¹³è¡¡æŸ¥æ‰¾æ ‘å®ç°çš„ï¼Œåœ¨Windowså’ŒOSXè¡ç”Ÿå¹³å°ï¼ˆåŒ…æ‹¬IOSï¼‰ä¸Šçš„æŸ¥æ‰¾è¡¨æ˜¯ä½¿ç”¨çº¢é»‘æ ‘å®ç°çš„ã€‚å› æ­¤ï¼Œæ„å»ºé…ç½®æ–‡ä»¶æ‰€éœ€çš„æ—¶é—´éšç€AssetBundleä¸­çš„Assetæ•°é‡è€Œå¢é•¿çš„é€Ÿåº¦å¤§äºçº¿æ€§å¢é•¿ã€‚ æ•°æ®æ®µä¸­å«æœ‰ç”±åºåˆ—åŒ–AsseBundleä¸­çš„Assetè€Œç”Ÿæˆçš„åŸå§‹æ•°æ®ã€‚å¦‚æœæŒ‡å®šäº†å‹ç¼©æ–¹æ¡ˆä¸ºLZMAï¼Œæ‰€æœ‰åºåˆ—åŒ–çš„Assetä¼šè¢«å‹ç¼©æˆä¸€ä¸ªå­—èŠ‚æ•°ç»„ä¸­ï¼›å¦‚æœæŒ‡å®šäº†å‹ç¼©æ–¹æ¡ˆä¸ºLZ4ï¼Œä¸åŒçš„Assetçš„å­—èŠ‚æ•°æ®ä¼šè¢«å•ç‹¬å‹ç¼©ï¼›å¦‚æœæ²¡æœ‰ä½¿ç”¨ä»»ä½•å‹ç¼©ï¼Œæ•°æ®æ®µä¼šä¿ç•™åŸå§‹çš„å­—èŠ‚æµæ•°æ®ã€‚ åœ¨Unity5.3ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼ŒAssetBundleä¸­çš„Objectä¸èƒ½è¢«å•ç‹¬å‹ç¼©ã€‚å› æ­¤ï¼Œåœ¨5.3ä¹‹å‰çš„ç‰ˆæœ¬çš„Unityä¸­ï¼Œå¦‚æœè¦ä»å·²å‹ç¼©çš„AssetBundleä¸­è¯»å–Objectï¼Œå¼•æ“å¿…é¡»å‹ç¼©æ•´ä¸ªAssetBundleã€‚é€šå¸¸æƒ…å†µä¸‹ï¼ŒUnityä¼šç¼“å­˜ä¸€ä»½è§£å‹åçš„AssetBundleå‰¯æœ¬ï¼Œä»¥æ­¤æ¥æé«˜åŠ è½½æ€§èƒ½ã€‚ åŠ è½½AssetBundleAssetBundleå¯ä»¥é€šè¿‡ä¸åŒçš„APIæ¥åŠ è½½ï¼Œè¿™äº›APIä¼šå—ä¸‹é¢çš„ä¸¤ç§å› ç´ çš„å½±å“è€Œäº§ç”Ÿä¸åŒçš„è¡Œä¸ºï¼› AssetBundleä½¿ç”¨äº†LZMAå‹ç¼©æ–¹å¼æˆ–è€…LZ4å‹ç¼©æ–¹å¼æˆ–è€…æ²¡æœ‰è¿›è¡Œå‹ç¼© è¿›è¡ŒåŠ è½½AssetBundleçš„å¹³å° è¿™äº›APIæ˜¯ï¼š AssetBundle.LoadFromMemoryï¼ˆå¯é€‰æ‹©å¼‚æ­¥æ¨¡å¼ï¼‰Unityä¸æ¨èä½¿ç”¨è¿™ä¸ªAPI AssetBundle.LoadFromFileï¼ˆå¯é€‰æ‹©å¼‚æ­¥æ¨¡å¼ï¼‰ AssetBundle.LoadFromStreamï¼ˆå¯é€‰æ‹©å¼‚æ­¥æ¨¡å¼ï¼‰ UnityWebRequestçš„DownloadHandlerAssetBundle é€šè¿‡è¿™äº›APIè·å–çš„AssetBundleå¼•ç”¨å¯ä»¥éšæ„æ··ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡UnityWebRequeståŠ è½½çš„AssetBundleå¯ä»¥å…¼å®¹é€šè¿‡AssetBundle.LoadFromFileæˆ–è€…AssetBundle.LoadFromMemoryAsyncåŠ è½½çš„AssetBundleã€‚ AssetBundle.LoadFromMemoryAsyncä»æ‰˜ç®¡ä»£ç çš„å­—èŠ‚æ•°ç»„ï¼ˆC#ä¸­çš„byte[]ï¼‰ä¸­åŠ è½½AssetBundleã€‚è¯¥æ–¹æ³•æ€»æ˜¯å°†æ‰˜ç®¡ä»£ç ä¸­çš„æºæ•°æ®èµ‹å€¼åˆ°æ–°åˆ†é…çš„è¿ç»­çš„å†…å­˜å—ä¸­ã€‚å¦‚æœAssetBundleä½¿ç”¨äº†LZMå‹ç¼©ï¼Œåœ¨èµ‹å€¼è¿‡ç¨‹ä¸­AssetBundleä¼šè¢«è§£å‹ï¼›å¦‚æœä½¿ç”¨äº†LZ4å‹ç¼©æˆ–è€…æ²¡æœ‰å‹ç¼©ï¼ŒAssetBundleä¼šè¢«é€å­—å¤åˆ¶ï¼ˆbe copied verbatimï¼‰ã€‚ è¿™ä¸ªAPIå ç”¨å†…å­˜çš„å³°å€¼è‡³å°‘æ˜¯ä»–å¤„ç†çš„AssetBundleå¤§å°çš„ä¸¤å€ï¼šä¸€ä»½ç”±æ­¤APIåˆ›å»ºåœ¨æœ¬æœºå†…å­˜ä¸­çš„å‰¯æœ¬å’Œä¸€ä»½ä¼ é€’ç»™æ­¤APIçš„ä½äºæ‰˜ç®¡å­—èŠ‚æ•°ç»„çš„å‰¯æœ¬ã€‚é€šè¿‡æ­¤APIä»AssetBundleåŠ è½½çš„Assetä¼šåœ¨å†…å­˜ä¸­å¤åˆ¶3æ¬¡ï¼›åœ¨æ‰˜ç®¡ä»£ç ä¸­çš„å­—èŠ‚æ•°ç»„ã€æœ¬æœºå†…å­˜ä¸­çš„å‰¯æœ¬ä»¥åŠåœ¨GPUæˆ–ç³»ç»Ÿå†…å­˜ä¸­çš„Assetæœ¬ä½“ã€‚]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity UIä¼˜åŒ–ï¼ˆä¸€ï¼‰-Unity UIçš„åŸºæœ¬åŸç†]]></title>
    <url>%2F2019%2F04%2F09%2Ffundamentals-unity-ui%2F</url>
    <content type="text"><![CDATA[æœ¯è¯­ç”»å¸ƒï¼ˆCanvasï¼‰æ˜¯ä»¥åŸç”Ÿä»£ç ç¼–å†™çš„Unityç»„ä»¶ï¼Œå®ƒç»™Unityçš„æ¸²æŸ“ç³»ç»ŸæŒ‰å±‚åˆ’åˆ†çš„å‡ ä½•ç³»ç»Ÿï¼Œå¯ä»¥åœ¨å…¶å†…éƒ¨æˆ–å…¶ä¸Šå±‚ç»˜åˆ¶å…¶ä»–å‡ ä½•å½¢çŠ¶ã€‚ç”»å¸ƒè´Ÿè´£å°†å…¶å†…éƒ¨çš„å‡ ä½•å½¢çŠ¶åˆå¹¶åˆ°æ‰¹å¤„ç†ã€ç”Ÿæˆåˆé€‚çš„æ¸²æŸ“æŒ‡ä»¤å¹¶å‘é€åˆ°Unityå›¾å½¢ç³»ç»Ÿã€‚è¿™äº›æ“ä½œéƒ½æ˜¯ç”±åŸç”ŸC++ä»£ç å®Œæˆï¼Œè¿™æ¯æˆä¸ºé‡æ–°æ‰¹å¤„ç†ï¼ˆrebatchï¼‰æˆ–æ‰¹å¤„ç†æ„å»ºï¼ˆbatch buildï¼‰ã€‚å½“ä¸€ä¸ªç”»å¸ƒè¢«æ ‡è®°ä¸ºå«æœ‰éœ€è¦é‡æ–°æ‰¹å¤„ç†çš„å‡ ä½•å½¢çŠ¶æ—¶ï¼Œç§°è¿™ä¸ªç”»å¸ƒä¸ºè„ï¼ˆdirtyï¼‰ç”»å¸ƒã€‚ç”±CanvasRendererç»„ä»¶å‘ç”»å¸ƒæä¾›å‡ ä½•å½¢çŠ¶ã€‚å­ç”»å¸ƒï¼ˆSub-canvasï¼‰æ˜¯åµŒå¥—åœ¨å…¶ä»–ç”»å¸ƒç»„ä»¶å†…éƒ¨çš„ç”»å¸ƒç»„ä»¶ã€‚å­ç”»å¸ƒèƒ½å¤Ÿå°†å…¶å­©å­èŠ‚ç‚¹ä¸å…¶ç”»å¸ƒéš”ç¦»å¼€ï¼Œä¸€ä¸ªè¢«æ ‡è®°ä¸ºè„çš„å­èŠ‚ç‚¹ä¸ä¼šè¿«ä½¿å…¶çˆ¶ç”»å¸ƒé‡æ–°æ„å»ºå‡ ä½•å†…å®¹ï¼Œåä¹‹äº¦ç„¶ã€‚æœ‰å‡ ç§ç‰¹æ®Šæƒ…å†µä¼šä½¿ä¸Šè¿°æƒ…å½¢å¤±æ•ˆï¼Œæ¯”å¦‚ï¼Œæ”¹å˜çˆ¶ç”»å¸ƒå¯¼è‡´å­ç”»å¸ƒæ”¹å˜å°ºå¯¸ã€‚Graphicç±»æ˜¯ç”±Unity UIç³»ç»Ÿçš„C#åº“æä¾›çš„åŸºç±»ï¼Œæ‰€æœ‰çš„ç”»å¸ƒç³»ç»Ÿæä¾›å¯ç»˜åˆ¶å‡ ä½•å†…å®¹çš„UIç³»ç»ŸC#ç±»éƒ½ç»§æ‰¿å®ƒã€‚å¤§å¤šæ•°å†…ç½®çš„UIç³»ç»Ÿç»˜åˆ¶ç±»éƒ½æ˜¯é€šè¿‡MaskableGraphicå­ç±»å®ç°çš„ï¼Œè¿™ä¸ªå­ç±»å®ç°äº†IMaskableæ¥å£ï¼Œå¯ä»¥è¢«é®ç½©ã€‚Drawableç±»çš„ä¸»è¦å­ç±»æ˜¯Imageå’ŒTextï¼Œå®ƒä»¬èƒ½æä¾›ä¸å…¶åç§°ç›¸å¯¹åº”çš„å†…å®¹ã€‚ Layoutç»„ä»¶æ§åˆ¶RectTransformçš„å°ºå¯¸å’Œä½ç½®ï¼Œå®ƒé€šå¸¸ç”¨äºåˆ›å»ºå…·æœ‰å¤æ‚å¸ƒå±€å¹¶ä¸”å†…éƒ¨ç»„ä»¶éœ€è¦ç›¸å¯¹å°ºå¯¸æˆ–è€…ç›¸å¯¹ä½ç½®çš„UIã€‚Layoutç»„ä»¶åªä¾èµ–RectTransformå¹¶ä¸”åªå½±å“ä¸å…¶å…³è”çš„RectTransformçš„å±æ€§ã€‚ä»–ä»¬ä¸ä¾èµ–Graphicç±»ï¼Œå¹¶ä¸”å¯ä»¥ç‹¬ç«‹äºUIç³»ç»Ÿçš„Graphicç±»ä½¿ç”¨ã€‚Graphicå’ŒLayoutç»„ä»¶éƒ½ä¾èµ–]]></content>
  </entry>
  <entry>
    <title><![CDATA[Unityæ€§èƒ½ä¼˜åŒ–-å›¾å½¢æ¸²æŸ“ä¼˜åŒ–]]></title>
    <url>%2F2019%2F04%2F09%2Foptimizing-graphics-rendering-unity-games%2F</url>
    <content type="text"></content>
      <categories>
        <category>æ¸²æŸ“ä¼˜åŒ–</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity-Asset-Bundle-Browser-tool]]></title>
    <url>%2F2019%2F04%2F08%2FUnity-Asset-Bundle-Browser-tool%2F</url>
    <content type="text"></content>
  </entry>
  <entry>
    <title><![CDATA[æ‰˜ç®¡å †ä¸éæ‰˜ç®¡å †çš„é‡Šæ”¾]]></title>
    <url>%2F2019%2F04%2F04%2Fmemory-release%2F</url>
    <content type="text"><![CDATA[æ‰˜ç®¡å †åƒåœ¾å›æ”¶å™¨æ¯éš”ä¸€æ®µæ—¶é—´.netå°±ä¼šæ£€æŸ¥æ‰˜ç®¡å †ï¼Œå½“æ£€æŸ¥åˆ°éœ€è¦æ¸…ç†å †æ—¶ï¼Œ.netå°±è°ƒç”¨åƒåœ¾å›æ”¶å™¨ã€‚åƒåœ¾å›æ”¶å™¨ä¼šæ‰«æå †ä¸Šçš„å¯¹è±¡çš„å¼•ç”¨ï¼Œä¸å†æœ‰å¼•ç”¨çš„å¯¹è±¡å°±è¢«åˆ é™¤ã€‚åƒåœ¾å›æ”¶å™¨è°ƒç”¨çš„æ—¶é—´æ˜¯ä¸ç¡®å®šçš„ï¼Œé™¤éä»£ç ä¸­æœ‰è°ƒç”¨åƒåœ¾å›æ”¶å™¨ï¼ˆSystem.GC.Collect()ï¼‰ã€‚ å†…å­˜ç¢ç‰‡çš„å¤„ç†ç”±äºå †çš„é‡Šæ”¾æ—¶åˆ»æ˜¯ç”±å †ä¸Šå¯¹è±¡çš„ç”Ÿå­˜å‘¨æœŸå†³å®šçš„ï¼Œè¿™å°±å†³å®šäº†å †çš„é‡Šæ”¾é¡ºåºæ˜¯ä¸å®šçš„ï¼Œå¿…ç„¶äº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚å°±åƒæ“ä½œç³»ç»Ÿçš„ç£ç›˜åˆ†é…æœºåˆ¶ä¸€æ ·ï¼Œè‹¥éœ€è¦ç»™ä¸€ä¸ªæ–°çš„å¯¹è±¡åˆ†é…ç©ºé—´ï¼ŒCLRéœ€è¦æœç´¢å †ï¼Œç›´åˆ°æ‰¾åˆ°è¶³å¤Ÿå¤§çš„ç©ºé—´æ¥å­˜å‚¨æ–°å¯¹è±¡ã€‚å®é™…ä¸Šåƒåœ¾å›æ”¶å™¨ä¼šé¿å…å †å‡ºç°ç¢ç‰‡çš„ç°è±¡ã€‚å›æ”¶å™¨åœ¨ä¸€æ¬¡é‡Šæ”¾åŠ¨ä½œç»“æŸä¼šå°†å †ä¸Šå‰©ä½™çš„å¯¹è±¡åœ¨å †é¡¶ç§»åŠ¨ï¼Œå›æ”¶å™¨ä¼šæ›´æ–°è¢«ç§»åŠ¨å¯¹è±¡çš„å­˜å‚¨åœ°å€ã€‚è¿™å°±åˆå½¢æˆäº†æ•´å—çš„æœªåˆ†é…çš„ç©ºé—´ã€‚è™½ç„¶ç§»åŠ¨å¯¹è±¡å¹¶æ›´æ–°åœ°å€ä¼šæ¶ˆè€—ä¸€å®šçš„æ€§èƒ½ï¼Œä½†æ˜¯ç”±äºåˆ†é…é€Ÿåº¦å’Œè®¿é—®é€Ÿåº¦ä¼šå¿«å¾ˆå¤šï¼Œè¶³ä»¥å¼¥è¡¥æ¶ˆè€—ã€‚ éæ‰˜ç®¡å †å›æ”¶å™¨ä¸çŸ¥é“å¦‚ä½•é‡Šæ”¾éæ‰˜ç®¡èµ„æºï¼Œå¦‚æ–‡ä»¶å¥æŸ„ï¼Œç½‘ç»œè¿æ¥ã€æ•°æ®åº“è¿æ¥ç­‰ã€‚å½“éæ‰˜ç®¡å¯¹è±¡è¢«æ‰˜ç®¡å¯¹è±¡å¼•ç”¨æ—¶ï¼Œæ‰˜ç®¡å¯¹è±¡è¢«é‡Šæ”¾æ—¶åº”ç¡®ä¿å…¶ç›¸å…³çš„éæ‰˜ç®¡å¯¹è±¡è¢«é‡Šæ”¾ã€‚ä»¥ä¸‹ä¸¤ç§æ–¹æ³•å¯è§£å†³é‡Šæ”¾éæ‰˜ç®¡èµ„æºçš„é—®é¢˜ï¼š åœ¨å®šä¹‰ç±»æ—¶ï¼Œå£°æ˜ä¸€ä¸ªææ„å‡½æ•° åœ¨ç±»ä¸­å®ç°System.IDisposableæ¥å£1234567class MyClass:IDispose&#123; public void Dispose() &#123; // é‡Šæ”¾éæ‰˜ç®¡èµ„æº &#125;&#125; ä¸¤ç§è°ƒç”¨æ–¹å¼ usingå…³é”®å­—æ–¹å¼ï¼Œå¯¹è±¡å£°æ˜å‘¨æœŸç»“æŸæ—¶ä¼šè‡ªåŠ¨è°ƒç”¨Disposeå‡½æ•°ã€‚æ­¤usingä¸å‘½åç©ºé—´æ— å…³ 1234using (MyClass classA = new MyClass())&#123; // do something&#125;// å¯¹è±¡çš„å£°æ˜å‘¨æœŸç»“æŸ ä¸»åŠ¨è°ƒç”¨ 123456789try&#123; MyClass classA = new MyClass(); // do something&#125;finally&#123; classA.Dispose();//æ˜¾ç¤ºè°ƒç”¨&#125;]]></content>
      <categories>
        <category>CSharp</category>
      </categories>
      <tags>
        <tag>CSharp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HideFlags]]></title>
    <url>%2F2019%2F04%2F03%2FHideFlags%2F</url>
    <content type="text"><![CDATA[DontSave ä¿ç•™å¯¹è±¡åˆ°æ–°åœºæ™¯ å¦‚æœGameObjectå¯¹è±¡è¢«HideFlags.DontSaveæ ‡è¯†ï¼Œåˆ™åœ¨æ–°Sceneä¸­GameObjectçš„æ‰€æœ‰ç»„ä»¶å°†è¢«ä¿ç•™ä¸‹æ¥ï¼Œä½†å…¶å­ç±»GameObjectå¯¹è±¡ä¸ä¼šè¢«ä¿ç•™åˆ°æ–°Sceneä¸­ã€‚ ä¸å¯ä»¥å¯¹GameObjectå¯¹è±¡çš„æŸä¸ªç»„ä»¶å¦‚Transformè¿›è¡ŒHideFlags.DontSaveæ ‡è¯†ï¼Œå¦åˆ™æ— æ•ˆã€‚ å³ä½¿ç¨‹åºå·²ç»é€€å‡ºï¼Œè¢«HideFlags.DontSaveæ ‡è¯†çš„å¯¹è±¡ä¼šä¸€ç›´å­˜åœ¨äºç¨‹åºä¸­ï¼Œé€ æˆå†…å­˜æ³„æ¼ï¼Œå¯¹HideFlags.DontSaveæ ‡è¯†çš„å¯¹è±¡åœ¨ä¸éœ€è¦æˆ–ç¨‹åºé€€å‡ºæ—¶éœ€è¦ä½¿ç”¨DestroyImmediateæ‰‹åŠ¨é”€æ¯ã€‚ HideAndDontSave 61The GameObject is not shown in the Hierarchy,not saved to to Scenens,and not unloaded by Resources.UnloadUnusedAssets.]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŠé€æ˜æ¸²æŸ“]]></title>
    <url>%2F2019%2F04%2F03%2Ftransparent%2F</url>
    <content type="text"><![CDATA[åŠé€æ˜ç‰©ä½“çš„ç‰¹å¾æ˜¯ä»€ä¹ˆï¼ŸåŠé€æ˜ç‰©ä½“éœ€è¦æ˜¾ç¤ºè¢«å®ƒé®æŒ¡çš„ç‰©ä½“ã€‚åœºæ™¯ä¸­ç‰©ä½“å¤§è‡´å°±åˆ†ä¸ºæœ¬é€æ˜ç‰©ä½“å’Œä¸é€æ˜ç‰©ä½“ã€‚åœ¨shaderä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®æ¸²æŸ“ç±»å‹ï¼Œè®¾ç½®æ¸²æŸ“é˜Ÿåˆ—å€¼ï¼Œæ¸²æŸ“é˜Ÿåˆ—å€¼è¡¨ç¤ºè¯¥ç‰©ä½“çš„ç»˜åˆ¶é¡ºåºã€‚å¼•æ“åœ¨æ¸²æŸ“æ—¶æœ‰ä¸€ä¸ªè§„åˆ™ï¼Œ]]></content>
      <categories>
        <category>Shader</category>
      </categories>
      <tags>
        <tag>Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[C++ä¸­å †æ ˆçš„åŒºåˆ«]]></title>
    <url>%2F2019%2F04%2F02%2Fcplusplus-stack-heap%2F</url>
    <content type="text"><![CDATA[ç®¡ç†æ–¹å¼å †ä¸­èµ„æºç”±ä»£ç æ§åˆ¶ï¼ˆé€šè¿‡malloc/freeã€new/deleteï¼Œå®¹æ˜“äº§ç”Ÿmemory leakï¼‰ï¼Œæ ˆèµ„æºç”±ç¼–è¯‘å™¨è‡ªåŠ¨ç®¡ç†ã€‚ ç³»ç»Ÿå“åº”å¯¹äºå †ï¼Œç³»ç»Ÿæœ‰ä¸€ä¸ªè®°å½•ç©ºé—²å†…å­˜åœ°å€çš„é“¾è¡¨ï¼Œå½“ç³»ç»Ÿæ”¶åˆ°ç¨‹åºç”³è¯·æ—¶ï¼Œéå†è¯¥é“¾è¡¨ï¼Œå¯»æ‰¾ç¬¬ä¸€ä¸ªå¤§äºæ‰€ç”³è¯·ç©ºé—´çš„å †ç»“ç‚¹ï¼Œåˆ é™¤ç©ºé—²é“¾è¡¨ä¸­çš„è¯¥ç»“ç‚¹ï¼Œå¹¶å°†è¯¥ç»“ç‚¹ç©ºé—´åˆ†é…ç»™ç¨‹åºï¼ˆå¤§å¤šæ•°ç³»ç»Ÿä¼šåœ¨è¿™å—å†…å­˜ç©ºé—´é¦–åœ°å€è®°å½•æœ¬æ¬¡åˆ†é…çš„å¤§å°ï¼Œè¿™æ ·deleteæ‰èƒ½æ­£ç¡®é‡Šæ”¾æœ¬å†…å­˜ç©ºé—´ï¼Œå¦å¤–ï¼Œç³»ç»Ÿä¼šå°†å¤šä½™çš„æƒ…å†µé‡æ–°æ”¾å…¥ç©ºé—²é“¾è¡¨ä¸­ï¼‰ã€‚å¯¹äºæ ˆï¼Œåªè¦å å¾—å‰©ä½™ç©ºé—´å¤§äºæ‰€ç”³è¯·ç©ºé—´ï¼Œç³»ç»Ÿå°±ä¼šä¸ºç¨‹åºåˆ†é…å†…å­˜ï¼Œå¦åˆ™æŠ¥å¼‚å¸¸å‡ºç°æ ˆæº¢å‡ºã€‚ ç©ºé—´å¤§å°å †æ˜¯ä¸è¿ç»­çš„å†…å­˜åŒºåŸŸï¼ˆå› ä¸ºç³»ç»Ÿä½¿ç”¨é“¾è¡¨æ¥å­˜å‚¨ç©ºé—²å†…å­˜åœ°å€çš„ï¼Œè‡ªç„¶ä¸æ˜¯è¿ç»­ï¼‰ï¼Œå †çš„å¤§å°å—é™äºè®¡ç®—æœºç³»ç»Ÿä¸­æœ‰æ•ˆçš„è™šæ‹Ÿå†…å­˜ï¼ˆ32ä½æœºå™¨ç†è®ºä¸Šæ˜¯4Gå¤§å°ï¼‰ï¼Œæ‰€ä»¥å †çš„ç©ºé—´æ¯”è¾ƒçµæ´»ï¼Œæ¯”è¾ƒå¤§ã€‚æ ˆæ˜¯ä¸€å—è¿ç»­çš„å†…å­˜åŒºåŸŸï¼Œå¤§å°æ˜¯æ“ä½œç³»ç»Ÿé¢„å®šå¥½çš„ï¼Œwindowsä¸‹æ ˆå¤§å°æ˜¯2Mï¼ˆä¹Ÿæœ‰æ˜¯1Mï¼Œåœ¨ç¼–è¯‘æ—¶ç¡®å®šï¼ŒVCä¸­å¯è®¾ç½®ï¼‰ã€‚ ç¢ç‰‡é—®é¢˜å¯¹äºå †ï¼Œé¢‘ç¹çš„new/deleteä¼šé€ æˆå¤§é‡å†…å­˜ç¢ç‰‡åŒ–ï¼Œé™ä½ç¨‹åºæ•ˆç‡ï¼Œå¯¹äºæ ˆï¼Œå®ƒæ˜¯ä¸€ä¸ªå…ˆè¿›åå‡ºï¼ˆfirst-in-last-outï¼‰ç»“æ„ï¼Œè¿›å‡ºä¸€ä¸€å¯¹åº”ï¼Œä¸ä¼šäº§ç”Ÿç¢ç‰‡åŒ–ã€‚ ç”Ÿé•¿æ–¹å‘å †å‘ä¸Šï¼Œç”±é«˜åœ°å€æ–¹å‘å¢é•¿ï¼›æ ˆå‘ä¸‹ï¼Œå‘ä½åœ°å€æ–¹å‘å¢é•¿ã€‚ åˆ†é…æ–¹å¼å †æ˜¯åŠ¨æ€åˆ†é…ï¼ˆæ²¡æœ‰é™æ€åˆ†é…çš„å †ï¼‰ã€‚æ ˆæœ‰é™æ€åˆ†é…å’ŒåŠ¨æ€åˆ†é…ï¼Œé™æ€åˆ†é…ç”±ç¼–è¯‘å™¨å®Œæˆï¼ˆå¦‚å‡½æ•°å±€éƒ¨å˜é‡ï¼‰ï¼ŒåŠ¨æ€åˆ†é…ç”±allocalå‡½æ•°åˆ†é…ï¼Œä½†æ ˆçš„åŠ¨æ€åˆ†é…èµ„æºç”±ç¼–è¯‘å™¨è‡ªåŠ¨é‡Šæ”¾ï¼Œæ— éœ€ç¨‹åºå‘˜å®ç°ã€‚ åˆ†é…æ•ˆç‡å †ç”±C/C++å‡½æ•°åº“æä¾›ï¼Œæœºåˆ¶å¾ˆå¤æ‚ï¼Œå› æ­¤å †çš„æ•ˆç‡æ¯”æ ˆä½å¾ˆå¤šã€‚æ ˆæ˜¯æœºå™¨ç³»ç»Ÿæä¾›çš„æ•°æ®ç»“æ„ï¼Œè®¡ç®—æœºåœ¨åº•å±‚å¯¹æ ˆæä¾›æ”¯æŒï¼Œåˆ†é…ä¸“é—¨çš„å¯„å­˜å™¨å­˜æ”¾æ ˆåœ°å€ï¼Œæä¾›æ ˆæ“ä½œä¸“é—¨çš„æŒ‡ä»¤ã€‚]]></content>
      <categories>
        <category>C++</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Overdraw]]></title>
    <url>%2F2019%2F04%2F02%2Foverdraw%2F</url>
    <content type="text"><![CDATA[Overdrawåœ¨æŸä¸ªèƒŒæ™¯ä¸Šæœ‰ä¸ªæŒ‰é’®ï¼Œè¦å°†æŒ‰é’®ç»˜åˆ¶åœ¨èƒŒæ™¯ä¸Šï¼Œè¿™ä¸ªå°±æ˜¯Overdrawï¼ŒOverdrawæ— æ³•é¿å…ï¼Œåªèƒ½ä¼˜åŒ–é™ä½ æ€§èƒ½å‚æ•° æ€»å¡«å……æ•°å³°å€¼ï¼šå•å¸§æ€»å¡«å……åƒç´ æ•°é‡æœ€å¤§å€¼ å¡«å……å€æ•°å³°å€¼ï¼šå•å¸§æœ€å¤§å¡«å……å€æ•°ï¼ˆ10.0Xå°±æ˜¯è¯¥å¸§åˆ·æ–°10éï¼‰ å•å¸§å¡«å……å€æ•°ï¼šè¯¥å¸§æ€»å¡«å……æ•°/è¯¥å¸§æ¸²æŸ“ç›¸æœºåˆ†è¾¨ç‡ ä¼˜åŒ–æ–¹æ¡ˆ æ§åˆ¶ç»˜åˆ¶é¡ºåºï¼šPCä¸Šèµ„æºæ— é™ï¼Œä¸€èˆ¬éƒ½æ˜¯ä»åå¾€å‰ç»˜åˆ¶ï¼Œä½†åœ¨ç§»åŠ¨ä¸Šï¼Œå°½é‡ä»å‰å¾€åç»˜åˆ¶ã€‚åœ¨Unityä¸­ï¼Œé‚£äº›Shaderä¸­è¢«è®¾ç½®ä¸ºâ€œGeometryâ€é˜Ÿåˆ—çš„å¯¹è±¡æ€»æ˜¯ä»å‰å¾€åç»˜åˆ¶çš„ï¼Œè€Œå…¶ä»–å›ºå®šé˜Ÿåˆ—ï¼ˆå¦‚â€Transparentâ€ï¼Œâ€Overlayâ€ï¼‰çš„ç‰©ä½“ï¼Œåˆ™éƒ½æ˜¯ä»åå¾€å‰ç»˜åˆ¶çš„ã€‚è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬å¯ä»¥å°½é‡æŠŠç‰©ä½“çš„é˜Ÿåˆ—è®¾ç½®ä¸ºâ€Geometryâ€ã€‚ å°½é‡å‡å°‘è¿‡åº¦ç»˜åˆ¶åŒºåŸŸï¼šå®åœ¨éœ€è¦å¤šå±‚ç»˜åˆ¶çš„åœ°æ–¹ï¼Œè¦å°½é‡å‡å°‘å„éƒ¨åˆ†è¿‡åº¦ç»˜åˆ¶åŒºåŸŸï¼Œä½¿é‡åˆåŒºå°ï¼Œç»˜åˆ¶çš„åƒç´ ç‚¹ä¹Ÿå°±å°‘ä¸€ç‚¹ã€‚ è¿‡å¤§çš„ä¸å¿…è¦çš„ç»˜åˆ¶å°½é‡ä»£ç å®ç°ï¼šä¾‹å¦‚ç‚¹å‡»å±å¹•ç©ºç™½åŒºåŸŸè¿”å›åŠŸèƒ½ï¼ŒåŠ é€æ˜imageä¼šå¢åŠ å¾ˆå¤š UIè®¾è®¡ä¸Šå°½å¯èƒ½å‡å°‘é‡å  æ–‡å­—éƒ¨åˆ†ä¸»è¦åŸå› æ˜¯ä½¿ç”¨äº†Outlineï¼ŒOutlineå®ç°æ–¹å¼æ˜¯å°†Textçš„å››ä¸ªé¡¶ç‚¹ä¼ è¿‡å»å¤åˆ¶4ä»½ï¼Œè®¾ç½®4ä»½åç§»é‡å®ç°æ•ˆæœï¼Œå°†åç§»é‡è®¾ç½®å¾ˆå¤§ä¹‹åï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªTextå‘¨å›´æœ‰4ä¸ªç›¸åŒçš„Text 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152public class Outline : Shadow&#123; protected Outline() &#123;&#125; public override void ModifyVertices(List&lt;UIVertex&gt; verts) &#123; if (!IsActive()) return; var start = 0; var end = verts.Count; ApplyShadow(verts, effectColor, start, verts.Count, effectDistance.x, effectDistance.y);// å³ä¸Š start = end; end = verts.Count; ApplyShadow(verts, effectColor, start, verts.Count, effectDistance.x, -effectDistance.y); // å³ä¸‹ start = end; end = verts.Count; ApplyShadow(verts, effectColor, start, verts.Count, -effectDistance.x, effectDistance.y); // å·¦ä¸Š start = end; end = verts.Count; ApplyShadow(vertx, effectColor, start, verts.Count, -effectDistance.x, -effectDistance.y); // å·¦ä¸‹ &#125; protected void ApplyShadow(List&lt;UIVertex&gt; verts, Color32 color, int start, int end, float x, float y) &#123; UIVertex vt; var neededCpacity = verts.Count * 2; if (verts.Capacity &lt; neededCapacity) verts.Capacity = neededCapacity; for (int i = start; i &lt; end; ++i) &#123; vt = verts[i]; verts.Add(vt); Vector3 v = vt.position; v.x += x; v.y += y; vt.position = v; var newColor = color; if (m_UseGrahpicAlpha) newColor.a = (byte)((newColor.a * verts[i].color.a) / 255); vt.color = newColor; verts[i] = vt; &#125; &#125;&#125; è§£å†³æ–¹æ³• ä¸ä½¿ç”¨æˆ–è€…ä½¿ç”¨Shadow(Shadowé€šè¿‡ä¸ºå›¾åƒæˆ–è€…æ–‡å­—çš„meshæ·»åŠ é¡¶ç‚¹å®ç°é˜´å½±æ•ˆæœï¼ŒOutlineç»§æ‰¿Shadowï¼Œåœ¨å¯¹è±¡å››ä¸ªè§’ä¸ªæ·»åŠ ä¸€ä¸ªShadow) ä½¿ç”¨Textmesh Pro(Unity5.5)éœ€è¦åˆ¶ä½œç›¸åº”çš„å­—ä½“æ–‡ä»¶ï¼Œå¯¹äºåŠ¨æ€ç”Ÿæˆçš„æ–‡å­—æ•ˆæœä¸å¥½ï¼Œå›ºå®šå­—ä½“å¾ˆå¥½ã€‚ ä¿®æ”¹Meshçš„UVåæ ‡ï¼Œæå–æ–‡å­—åŸå§‹UVåæ ‡ï¼Œæ‰©å¤§æ–‡å­—ç»˜å›¾åŒºåŸŸï¼Œå¯¹æ–‡å­—çº¹ç†å‘¨å›´åƒç´ ç‚¹é‡‡æ ·ï¼Œæ–°æ—§é¢œè‰²èåˆ Maskç»„ä»¶Unityçš„Maskç»„ä»¶ä¼šå¢åŠ ä¸€å±‚Overdrawï¼Œè¿˜ä¼šå¢åŠ 4ä¸ªDrawCallè§£å†³æ–¹æ³•ï¼š ä½¿ç”¨RectMask2Dä»£æ›¿ï¼Œç¼ºç‚¹æ˜¯åªèƒ½ç”¨äºçŸ©å½¢ å¯¹äºå¤šè¾¹å½¢ï¼Œç”¨MeshMaskï¼Œçº¢è‰²ä¸ºUnityMaskï¼Œè“è‰²æ˜¯MeshMaskï¼ŒUnityMaskæ¶ˆè€—15ä¸ªDrawCallï¼ŒOverdraw2æ¬¡ï¼ŒMeshMaskæ¶ˆè€—1ä¸ªDrawCallï¼Œ1å±‚OverDraw Imageçš„slideå±æ€§å¯¹äºslideä¹å®«æ ¼å›¾ç‰‡ï¼Œå¯ä»¥çœ‹æƒ…å†µå–æ¶ˆfill centerå±æ€§ï¼Œé‚£æ ·ä¸­å¿ƒåŒºåŸŸä¸ä¼šæ¸²æŸ“ï¼Œä¸­å¿ƒåŒºåŸŸä¹Ÿå°±é•‚ç©ºï¼Œé‡åˆé¢ç§¯ä¹Ÿä¼šå°ã€‚ æ— ç”¨çš„Image]]></content>
      <categories>
        <category>ä¼˜åŒ–</category>
      </categories>
      <tags>
        <tag>ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Perlinå™ªå£°]]></title>
    <url>%2F2019%2F04%2F01%2Fperlin%2F</url>
    <content type="text"><![CDATA[Perlinå™ªå£°Ken Perlinåœ¨1993å¹´æå‡ºäº†ä¸€ç§æ¸å˜å™ªå£°ï¼ŒPerlinåœ¨1985å¹´çš„SIGGRAPHæœ‰è¯¥ç®—æ³•çš„æè¿°ï¼Œç§°ä¹‹ä¸ºç»å…¸Perlinå™ªå£°ï¼ˆClassical Perlin Noiseï¼‰ã€‚ä¸ºäº†ç®€åŒ–è®¡ç®—ï¼Œæ–¹ä¾¿ä½¿ç”¨ç¡¬ä»¶å®ç°ï¼Œå¹¶è§£å†³ç»å…¸Perlinå™ªå£°ä¸­å­˜åœ¨çš„é”™è¯¯ï¼Œåˆ°2001å¹´ï¼ŒKen Perlinå†æ¬¡å¯¹åŸå§‹çš„å™ªå£°ç®—æ³•è¿›è¡Œäº†æ”¹è¿›ï¼Œç§°ä¹‹ä¸ºSimplexå™ªå£°ï¼ˆSimplex Noiseï¼‰ï¼Œè¿™ä¸¤ç§ç®—æ³•éƒ½å¯ä»¥æˆä¸ºPerlinå™ªå£°ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™ä¹ŸæŠŠåˆ†å½¢å™ªå£°æˆä¸ºPerlinå™ªå£°ï¼Œç”šè‡³åœ¨ä¸¥è‚ƒçš„å­¦æœ¯è®ºæ–‡ä¸­éƒ½æœ‰è¿™ç§å«æ³•ã€‚ä¸ºäº†é¿å…æ­§ä¹‰ï¼Œæœ¬æ–‡æŒ‡çš„Perlinå™ªå£°ç‰¹æŒ‡ç»å…¸çš„Perlinå™ªå£°å’ŒSimplexå™ªå£°ã€‚ Stefan GustavsonæŒ‡å‡ºï¼šSimplexå™ªå£°æœ‰æ›´å°çš„ç®—æ³•å¤æ‚åº¦ï¼Œè¦æ±‚æ›´å°‘çš„ä¹˜æ³•ï¼Œåœ¨Nç»´ç©ºé—´ä¸Šï¼Œç»å…¸Perlinå™ªå£°çš„ç®—æ³•å¤æ‚åº¦ä¸º$log(2^N)$ï¼Œä½†æ˜¯Simplexå™ªå£°çš„ç®—æ³•å¤æ‚åº¦ä¸º$log(N^2)$ã€‚ ç»å…¸Perlinå™ªå£°ç»å…¸Perlinå™ªå£°æ˜¯Ken Perlinåœ¨1983å¹´æå‡ºçš„å™ªå£°ï¼ŒKen Perlinæä¾›äº†ä¸€ç»´ã€äºŒç»´ã€ä¸‰ç»´ç®—æ³•çš„Cå®ç°ã€‚ä»£ç å¦‚ä¸‹ï¼š 12345678910111213#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;math.h&gt;#define B 0x100#define BM 0xff#define N 0x1000#define NP 12 /* 2^M */#define NM 0xfffstatic p[B + B + 2];static float g3[]]]></content>
      <categories>
        <category>å›¾å½¢å­¦</category>
      </categories>
      <tags>
        <tag>å›¾å½¢å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[shadertoy]]></title>
    <url>%2F2019%2F04%2F01%2Fshadertoy%2F</url>
    <content type="text"><![CDATA[12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879Shader "Shadertoy/Template" &#123; Properties &#123; iMouse ("Mouse Pos", Vector) = (100, 100, 0, 0) iChannel0("iChannel0", 2D) = "white" &#123;&#125; iChannelResolution0 ("iChannelResolution0", Vector) = (100, 100, 0, 0) &#125; CGINCLUDE #include "UnityCG.cginc" #pragma target 3.0 #define vec2 float2 #define vec3 float3 #define vec4 float4 #define mat2 float2x2 #define mat3 float3x3 #define mat4 float4x4 #define iGlobalTime _Time.y #define mod fmod #define mix lerp #define fract frac #define texture2D tex2D // å±å¹•åˆ†è¾¨ç‡ #define iResolution _ScreenParams // å½’ä¸€åŒ–å±å¹•åæ ‡ #define gl_FragCoord ((_iParam.scrPos.xy/_iParam.scrPos.w) * _ScreenParams.xy) #define PI2 6.28318530718 #define pi 3.14159265358979 #define halfpi (pi * 0.5) #define oneoverpi (1.0 / pi) fixed4 iMouse; sampler2D iChannel0; fixed4 iChannelResolution0; struct v2f &#123; float4 pos : SV_POSITION; float4 scrPos : TEXCOORD0; &#125;; v2f vert(appdata_base v) &#123; v2f o; o.pos = UnityObjectToClipPos (v.vertex); o.scrPos = ComputeScreenPos(o.pos); return o; &#125; vec4 main(vec2 fragCoord); fixed4 frag(v2f _iParam) : COLOR0 &#123; vec2 fragCoord = gl_FragCoord; return main(gl_FragCoord); &#125; vec4 main(vec2 fragCoord) &#123; return vec4(1, 1, 1, 1); &#125; ENDCG SubShader &#123; Pass &#123; CGPROGRAM #pragma vertex vert #pragma fragment frag // ä½¿ç”¨ä½ç²¾åº¦æ¥æå‡ç‰‡æ®µç€è‰²å™¨çš„è¿è¡Œé€Ÿåº¦ #pragma fragmentoption ARB_precision_hint_fastest ENDCG &#125; &#125; FallBack Off &#125;]]></content>
  </entry>
  <entry>
    <title><![CDATA[å‰§æƒ…ç¼–è¾‘å™¨]]></title>
    <url>%2F2019%2F04%2F01%2Fcinema%2F</url>
    <content type="text"></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å›¾å½¢å­¦-å™ªå£°]]></title>
    <url>%2F2019%2F04%2F01%2Fgraphics-noise%2F</url>
    <content type="text"><![CDATA[ç”±ç¨‹åºäº§ç”Ÿå™ªå£°çš„æ–¹æ³•å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸¤ç±» ç±»åˆ« åç§° åŸºäºæ™¶æ ¼çš„æ–¹æ³•ï¼ˆLattice basedï¼‰ åˆå¯ç»†åˆ†ä¸ºä¸¤ç§ï¼šç¬¬ä¸€ç§æ˜¯æ¢¯åº¦å™ªå£°ï¼ˆGradient noiseï¼‰ï¼ŒåŒ…æ‹¬Perlinå™ªå£°ï¼ŒSimplexå™ªå£°ï¼ŒWaveletå™ªå£°ç­‰ï¼›ç¬¬äºŒç§æ˜¯Valueå™ªå£°ï¼ˆValue noiseï¼‰ã€‚ åŸºäºç‚¹çš„æ–¹æ³•ï¼ˆPoint basedï¼‰ Worleyå™ªå£° ç™½å™ªå£°å™ªå£°çš„åŸºç¡€æ˜¯éšæœºæ•°ï¼Œå¦‚æœç»™å±å¹•ä¸Šçš„æ¯ä¸ªåƒç´ ç‚¹èµ‹äºˆä¸€ä¸ª0å’Œ1ä¹‹é—´çš„éšæœºæ•°æ¥è¡¨ç¤ºåƒç´ ç‚¹çš„äº®åº¦ï¼Œå°±ä¼šå¾—åˆ°ä¸€å‰¯æ‚ä¹±æ— ç« çš„å›¾ç‰‡ã€‚è¿™å°±æ˜¯ç™½å™ªå£°ï¼Œ Perlinå™ªå£°å®ç°æ­¥éª¤ï¼š å®šä¹‰ä¸€ä¸ªæ™¶æ ¼ç»“æ„ï¼Œæ¯ä¸ªæ™¶æ ¼çš„é¡¶ç‚¹æœ‰ä¸€ä¸ªâ€œä¼ªéšæœºâ€çš„æ¢¯åº¦å‘é‡ã€‚å¯¹äºäºŒç»´çš„Perlinå™ªå£°æ¥è¯´ï¼Œæ™¶æ ¼ç»“æ„å°±æ˜¯ä¸€ä¸ªå¹³é¢ç½‘ç»œï¼Œä¸‰ç»´çš„å°±æ˜¯ä¸€ä¸ªç«‹æ–¹ä½“ç½‘æ ¼ã€‚ è¾“å…¥ä¸€ä¸ªç‚¹ï¼ˆäºŒç»´çš„è¯å°±æ˜¯äºŒç»´åæ ‡ï¼Œä¸‰ç»´å°±æ˜¯ä¸‰ç»´åæ ‡ï¼‰ï¼Œæˆ‘ä»¬æ‰¾åˆ°å’Œå®ƒç›¸é‚»çš„é‚£äº›æ™¶æ ¼é¡¶ç‚¹ï¼ˆäºŒç»´ä¸‹æœ‰4ä¸ªï¼Œä¸‰ç»´ä¸‹æœ‰8ä¸ªï¼Œnç»´ä¸‹æœ‰$2^n$ä¸ªï¼‰ï¼Œè®¡ç®—è¯¥ç‚¹åˆ°å„ä¸ªæ™¶æ ¼é¡¶ç‚¹çš„è·ç¦»å‘é‡ï¼Œåœ¨åˆ†åˆ«ä¸é¡¶ç‚¹ä¸Šçš„æ¢¯åº¦å‘é‡åšç‚¹ä¹˜ï¼Œå¾—åˆ°$2^n$ä¸ªç‚¹ä¹˜ç»“æœã€‚ ä½¿ç”¨ç¼“å’Œæ›²çº¿ï¼ˆease curvesï¼‰æ¥è®¡ç®—å®ƒä»¬çš„æƒé‡å’Œã€‚åœ¨åŸå§‹çš„Perlinå™ªå£°å®ç°ä¸­ï¼Œç¼“å’Œæ›²çº¿æ˜¯$s(t) = 3t^2 - 2t^2$ï¼Œåœ¨2002å¹´è®ºæ–‡ä¸­ï¼ŒPerlinæ”¹è¿›ä¸º$s(t) = 6t^5 - 15t^4 + 10t^3$ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114Shader "Shadertoy/Template" &#123; Properties &#123; iMouse ("Mouse Pos", Vector) = (100, 100, 0, 0) iChannel0("iChannel0", 2D) = "white" &#123;&#125; iChannelResolution0 ("iChannelResolution0", Vector) = (100, 100, 0, 0) &#125; CGINCLUDE #include "UnityCG.cginc" #pragma target 3.0 #define vec2 float2 #define vec3 float3 #define vec4 float4 #define mat2 float2x2 #define mat3 float3x3 #define mat4 float4x4 #define iTime _Time.y #define mod fmod #define mix lerp #define fract frac #define texture2D tex2D #define iResolution _ScreenParams #define gl_FragCoord ((_iParam.scrPos.xy/_iParam.scrPos.w) * _ScreenParams.xy) #define PI2 6.28318530718 #define pi 3.14159265358979 #define halfpi (pi * 0.5) #define oneoverpi (1.0 / pi) fixed4 iMouse; sampler2D iChannel0; fixed4 iChannelResolution0; struct v2f &#123; float4 pos : SV_POSITION; float4 scrPos : TEXCOORD0; &#125;; v2f vert(appdata_base v) &#123; v2f o; o.pos = UnityObjectToClipPos (v.vertex); o.scrPos = ComputeScreenPos(o.pos); return o; &#125; vec4 main(vec2 fragCoord); fixed4 frag(v2f _iParam) : COLOR0 &#123; vec2 fragCoord = gl_FragCoord; return main(gl_FragCoord); &#125; vec3 hash3(vec2 p) &#123; vec3 q = vec3(dot(p, vec2(127.1,311.7)),dot(p,vec2(269.5,183.3)),dot(p,vec2(419.2,317.9))); return fract(sin(q)*43758.5453); &#125; float iqnoise(in vec2 x, float u, float v) &#123; vec2 p = floor(x); vec2 f = fract(x); float k = 1.0+63.0*pow(1.0-v,4.0); float va = 0.0; float wt = 0.0; for (int j = 0; j &lt; 3; ++j) &#123; for (int i = 0; i &lt; 3; ++i) &#123; vec2 g = vec2(float(i),float(j)); vec3 o = hash3(p + g)*vec3(u,u,1.0); vec2 r = g - f + o.xy; float d = dot(r,r); float ww = pow(1.0-smoothstep(0.0,1.414,sqrt(d)),k); va += o.z*ww; wt += ww; &#125; &#125; return va/wt; &#125; vec4 main(vec2 fragCoord) &#123; vec2 uv = fragCoord.xy / iResolution.xx; vec2 p = 0.5 - 0.5*sin(iTime*vec2(1.01,1.71)); if (iMouse.w &gt; 0.001) p = vec2(0.0, 1.0) + vec2(1.0, -1.0)*iMouse.xy/iResolution.xy; p = p*p*(3.0-2.0*p); p = p*p*(3.0-2.0*p); p = p*p*(3.0-2.0*p); float f = iqnoise(24.0*uv,p.x,p.y); return vec4(f, f, f, 1); &#125; ENDCG SubShader &#123; Pass &#123; CGPROGRAM #pragma vertex vert #pragma fragment frag #pragma fragmentoption ARB_precision_hint_fastest ENDCG &#125; &#125; FallBack Off &#125;]]></content>
      <categories>
        <category>å›¾å½¢å­¦</category>
      </categories>
      <tags>
        <tag>å›¾å½¢å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æº¶è§£]]></title>
    <url>%2F2019%2F03%2F31%2FDissolveEffect%2F</url>
    <content type="text"><![CDATA[æº¶è§£ï¼Œä¹Ÿå°±æ˜¯è®©è¿™ä¸ªæ¨¡å‹é€æ¸æ¶ˆå¤±ã€‚é‚£ä¹ˆï¼Œæœ€ç®€å•çš„ï¼Œç›´æ¥è®©è¿™ä¸ªåƒç´ çš„Fragment Shaderæ“ä½œdiscardï¼Œè¿™ä¸ªåƒç´ å°±æ¶ˆå¤±äº†ã€‚ç„¶åï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯è®©è¿™ä¸ªæº¶è§£çš„å¯¹è±¡ä¸€éƒ¨åˆ†æ¶ˆå¤±ï¼Œå¦ä¸€éƒ¨åˆ†å­˜åœ¨ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªMaskå›¾è¿›è¡Œæ§åˆ¶ï¼Œç„¶åç”¨è¿™ä¸ªMaskå€¼ä¸æˆ‘ä»¬è®¾å®šçš„ä¸€ä¸ªé˜€å€¼æ¥è¿›è¡Œæ¯”è¾ƒï¼Œå°äºé˜€å€¼çš„éƒ¨åˆ†discardï¼Œå¤§äºçš„éƒ¨åˆ†æ­£å¸¸è®¡ç®—ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬å°†è¿™ä¸ªé˜€å€¼ä»0é€æ¸å¢åŠ åˆ°1ï¼Œå°±å¯ä»¥å®ç°æ¨¡å‹çš„ä¸€éƒ¨åˆ†åƒç´ å…ˆæ¶ˆå¤±ï¼Œç›´è‡³æ•´ä¸ªæ¨¡å‹å®Œå…¨æ¶ˆå¤±çš„æ•ˆæœã€‚]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity Shader åå¤„ç†ï¼šBloomå…¨å±æ³›å…‰]]></title>
    <url>%2F2019%2F03%2F30%2FShader-Bloom%2F</url>
    <content type="text"><![CDATA[å…¨å±Bloomæ•ˆæœï¼Œä¹Ÿå«Glowæ•ˆæœï¼Œä¸­æ–‡ç§°ä½œâ€œå…¨å±æ³›å…‰â€ï¼Œè¿™æ˜¯ä¸€ç§å¯ä»¥æ¨¡æ‹Ÿå‡ºHDRçš„å…¨å±åå¤„ç†æ•ˆæœï¼Œä½†æ˜¯å®ç°åŸç†å’ŒHDRç›¸å·®å¾ˆè¿œï¼Œæ•ˆæœæ¯”HDRæŸ¥ä¸€ä¸‹ï¼Œä½†æ˜¯æ€§èƒ½é«˜å¾ˆå¤šã€‚ HDRHDR(High Dynamic Range)ï¼Œé«˜åŠ¨æ€èŒƒå›´ã€‚Highå€¼å¾—æ˜¯äº®åº¦çš„èŒƒå›´æ›´é«˜ã€‚æ­£å¸¸å±å¹•ä¸Šä¸€ä¸ªåƒç´ æ˜¯ç”±RGBä¸‰åŸè‰²ç»„æˆçš„ï¼Œæ¯ä¸ªé€šé“ç”¨å…«ä½äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯0-255ï¼Œè€ŒçœŸå®ä¸–ç•Œçš„äº®åº¦çš„æœ€å¤§å€¼è¦è¿œè¿œè¶…è¿‡å±å¹•ä¸Šèƒ½å¤Ÿæ˜¾ç¤ºçš„æœ€å¤§äº®åº¦å€¼ï¼Œæ¯”å¦‚å¤ªé˜³çš„äº®åº¦ä¼šæ˜¯å±å¹•äº®åº¦çš„å‡ ä¸‡å€ï¼Œè¿™ä¸ªå°±æ˜¯æ‰€è°“çš„Highã€‚HDRå¯ä»¥æ¨¡æ‹Ÿé«˜èŒƒå›´çš„äº®åº¦åˆ†å¸ƒã€‚å®ç°è¿™æ ·åŠŸèƒ½çš„æŠ€æœ¯å«åšToneMappingï¼Œç¿»è¯‘ä¸ºè‰²è°ƒæ˜ å°„æŠ€æœ¯ã€‚è¿™ç§æŠ€æœ¯ä¼šè®©ç”»é¢å¯¹æ¯”åº¦æ›´åŠ æŸ”å’Œï¼Œå°†é«˜çš„äº®åº¦èŒƒå›´æ›´åŠ å¹³æ»‘åœ°ç¼©æ”¾åˆ°0-255è¿™ä¸€ä½å…‰ç…§èŒƒå›´ï¼Œä¸»è¦è¿ç”¨çš„åŸç†æ˜¯å±€éƒ¨é€‚åº”æ€§ã€‚äººçœ¼åœ¨æ¯”è¾ƒæš—çš„åœ°æ–¹ï¼Œä¹Ÿèƒ½çœ‹æ¸…ä¸œè¥¿ï¼Œä½†æ˜¯çªç„¶åˆ°äº†ä¸€ä¸ªæ¯”è¾ƒäº®çš„åœ°æ–¹ï¼Œå°±ä¼šæ„Ÿè§‰æ¨¡ç³Šï¼Œéœ€è¦ä¸€ä¼šå„¿æ‰èƒ½é€‚åº”å½“å‰çš„äº®åº¦æ°´å¹³ã€‚ BloomBloomå¯ä»¥æ¨¡æ‹Ÿå‡ºHDRçš„æ•ˆæœï¼Œä½†æ˜¯åŸç†ä¸Šå’ŒHDRæ˜¯æˆªç„¶ä¸åŒçš„ã€‚HDRå®é™…ä¸Šæ˜¯é€šè¿‡æ˜ å°„æŠ€æœ¯ï¼Œæ¥è¾¾åˆ°æ•´ä½“è°ƒæ•´å…¨å±€äº®åº¦å±æ€§çš„ï¼Œè¿™ç§è°ƒæ•´æ˜¯é¢œè‰²ã€å¼ºåº¦ç­‰éƒ½å¯ä»¥è¿›è¡Œè°ƒæ•´ï¼Œè€ŒBloomä»…ä»…æ˜¯èƒ½å¤Ÿå°†å…‰ç…§èŒƒå›´è°ƒé«˜è¾¾åˆ°è¿‡é¥±å’Œï¼Œä¹Ÿå°±æ˜¯è®©äº®çš„åœ°æ–¹æ›´äº®ã€‚ä¸è¿‡Bloomæ•ˆæœå®ç°èµ·æ¥ç®€å•ï¼Œæ€§èƒ½æ•ˆæœä¹Ÿå°ï¼Œå´å¯ä»¥è¾¾åˆ°ä¸é”™çš„æ•ˆæœã€‚ å®ç°åŸç†ï¼šé¦–å…ˆéœ€è¦è®¾ç½®ä¸€ä¸ªæ³›å…‰çš„äº®åº¦é˜€å€¼ï¼Œç¬¬ä¸€éå¤„ç†æ—¶ï¼Œéœ€è¦å¯¹åŸåœºæ™¯å›¾è¿›è¡Œå¸…é€‰ï¼Œæ‰€æœ‰å°äºè¿™ä¸ªé˜€å€¼çš„åƒç´ éƒ½è¢«ç­›æ‰ï¼Œæ‰€æœ‰å¤§äºè¯¥å€¼çš„åƒç´ éƒ½è¢«ç•™ä¸‹ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€å¼ åªåŒ…å«éœ€è¦æ³›å…‰éƒ¨åˆ†çš„è´´å›¾ï¼Œå…¶ä½™éƒ¨åˆ†æ˜¯é»‘è‰²çš„ï¼›æ³›å…‰æ•ˆæœæ˜¯ç”±è¡å°„æ•ˆæœäº§ç”Ÿçš„ï¼Œæˆ‘ä»¬ç°å®ä¸–ç•Œä¸­çœ‹åˆ°çš„æ³›å…‰æ•ˆæœï¼Œæœ€äº®çš„åœ°æ–¹å®é™…ä¸Šæ˜¯ä¼šå‘æš—çš„åœ°æ–¹æ‰©æ•£çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨äº®çš„åœ°æ–¹ï¼Œè¾¹ç•Œæ˜¯ä¸æ˜æ˜¾çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦å¯¹æ³›å…‰ä¹Ÿå°±æ˜¯ä¸Šä¸€æ­¥æ“ä½œçš„ç»“æœå›¾ç‰‡è¿›è¡Œæ¨¡ç³Šæ“ä½œï¼Œè¾¾åˆ°å…‰ç§»é™¤çš„æ•ˆæœï¼Œæœ€åï¼Œæˆ‘ä»¬å°†å¤„ç†è¿‡çš„å›¾åƒå’ŒåŸå›¾åƒç´§æ€¥æ€§å åŠ ï¼Œå°±å¾—åˆ°äº†æœ€ç»ˆçš„æ•ˆæœã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647using UnityEngine;[ExecuteAlways]public class RenderImage : MonoBehaviour&#123; // åˆ†è¾¨ç‡ public int downSample = 1; public float grayScaleAmout = 1.0f; public Material curMaterial; // é«˜äº®éƒ¨åˆ†æå–é˜€å€¼ public Color colorThreshold = Color.gray; // é‡‡æ ·ç‡ public int samplerScale = 1; // Bloomæ³›å…‰é¢œè‰² public Color bloomColor = Color.white; // Bloomæƒå€¼ [Range(0.0f, 1.0f)] public float bloomFactor = 0.5f; void OnRenderImage(RenderTexture src, RenderTexture dest) &#123; // ç”³è¯·ä¸¤å—RTï¼Œå¹¶ä¸”åˆ†è¾¨ç‡æŒ‰ç…§downSampleé™ä½ RenderTexture temp1 = RenderTexture.GetTemporary(src.width &gt;&gt; downSample, src.height &gt;&gt; downSample); RenderTexture temp2 = RenderTexture.GetTemporary(src.width &gt;&gt; downSample, src.height &gt;&gt; downSample); // ç›´æ¥å°†åœºæ™¯å›¾æ‹·è´åˆ°ä½åˆ†è¾¨ç‡çš„RTä¸Šè¾¾åˆ°é™åˆ†è¾¨ç‡çš„æ•ˆæœ Graphics.Blit(src, temp1); // æ ¹æ®é˜€å€¼æå–é«˜äº®éƒ¨åˆ†ï¼Œä½¿ç”¨pass0è¿›è¡Œé«˜äº®æå– curMaterial.SetVector("_colorThresshold", colorThreshold); Graphics.Blit(temp1, temp2, curMaterial, 0); // é«˜æ–¯æ¨¡ç³Šï¼Œä¸¤æ¬¡æ¨¡ç³Šï¼Œæ¨ªå‘çºµå‘ï¼Œä½¿ç”¨pass1è¿›è¡Œé«˜æ–¯æ¨¡ç³Š curMaterial.SetVector("_offsets", new Vector4(0, samplerScale, 0, 0)); Graphics.Blit(temp2, temp1, curMaterial, 1); curMaterial.SetVector("_offset", new Vector4(samplerScale, 0, 0, 0)); Graphics.Blit(temp1, temp2, curMaterial, 1); // Bloomï¼Œå°†æ¨¡ç³Šåçš„å›¾ä½œä¸ºMaterialçš„Blurå›¾å‚æ•° curMaterial.SetTexture("_BlurTex", temp2); curMaterial.SetVector("_bloomColor", bloomColor); curMaterial.SetFloat("_bloomFactor", bloomFactor); // ä½¿ç”¨pass2è¿›è¡Œæ™¯æ·±æ•ˆæœè®¡ç®—ï¼Œæ¸…æ™°åœºæ™¯å›¾ç›´æ¥ä»sourceè¾“å…¥åˆ°shaderçš„_MainTexä¸­ Graphics.Blit(src, dest, curMaterial, 2); // é‡Šæ”¾ç”³è¯·çš„RT RenderTexture.ReleaseTemporary(temp1); RenderTexture.ReleaseTemporary(temp2); &#125;&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161Shader "Hidden/BloomEffect"&#123; Properties &#123; _MainTex ("Texture", 2D) = "white" &#123;&#125; _BlurTex("BlurTex", 2D) = "white" &#123;&#125; &#125; CGINCLUDE #include "UnityCG.cginc" // ç”¨äºé˜€å€¼æå–äº®åº¦éƒ¨åˆ† struct v2f_threshold &#123; float4 pos : SV_POSITION; float2 uv : TEXCOORD0; &#125;; // ç”¨äºblur struct v2f_blur &#123; float4 pos : SV_POSITION; float2 uv : TEXCOORD0; float4 uv01 : TEXCOORD1; float4 uv23 : TEXCOORD2; float4 uv45 : TEXCOORD3; &#125;; // ç”¨äºbloom struct v2f_bloom &#123; float4 pos : SV_POSITION; float2 uv : TEXCOORD0; float2 uv1 : TEXCOORD1; &#125;; sampler2D _MainTex; float4 _MainTex_TexelSize; sampler2D _BlurTex; float4 _BlurTex_TexelSize; float4 _offsets; float4 _colorThreshold; float4 _bloomColor; float _bloomFactor; // é«˜äº®éƒ¨åˆ†æå–shader v2f_threshold vert_threshold(appdata_img v) &#123; v2f_threshold o; o.pos = UnityObjectToClipPos(v.vertex); o.uv = v.texcoord.xy; //dxä¸­çº¹ç†ä»å·¦ä¸Šè§’ä¸ºåˆå§‹åæ ‡ï¼Œéœ€è¦åå‘#if UNITY_UV_STARTS_AT_TOP if (_MainTex_TexelSize.y &lt; 0) o.uv.y = 1 - o.uv.y;#endif return o; &#125; fixed4 frag_threshold(v2f_threshold i) : SV_Target &#123; fixed4 color = tex2D(_MainTex, i.uv); // ä»…å½“colorå¤§äºè®¾ç½®é˜€å€¼çš„æ—¶å€™æ‰è¾“å‡º return saturate(color - _colorThreshold); &#125; // é«˜æ–¯æ¨¡ç³Š vert shader v2f_blur vert_blur(appdata_img v) &#123; v2f_blur o; _offsets *= _MainTex_TexelSize.xyxy; o.pos = UnityObjectToClipPos(v.vertex); o.uv = v.texcoord.xy; o.uv01 = v.texcoord.xyxy + _offsets.xyxy * float4(1,1,-1,-1); o.uv23 = v.texcoord.xyxy + _offsets.xyxy * float4(1,1,-1,-1)*2.0; o.uv45 = v.texcoord.xyxy + _offsets.xyxy * float4(1,1,-1,-1)*3.0; return o; &#125; // é«˜æ–¯æ¨¡ç³Š pixel shader fixed4 frag_blur(v2f_blur i) :SV_Target &#123; fixed4 color = fixed4(0,0,0,0); color += 0.40 * tex2D(_MainTex, i.uv); color += 0.15 * tex2D(_MainTex, i.uv01.xy); color += 0.15 * tex2D(_MainTex, i.uv01.zw); color += 0.10 * tex2D(_MainTex, i.uv23.xy); color += 0.10 * tex2D(_MainTex, i.uv23.zw); color += 0.05 * tex2D(_MainTex, i.uv45.xy); color += 0.05 * tex2D(_MainTex, i.uv45.zw); return color; &#125; // Bloomæ•ˆæœ vertex shader v2f_bloom vert_bloom(appdata_img v) &#123; v2f_bloom o; o.pos = UnityObjectToClipPos(v.vertex); o.uv.xy = v.texcoord.xy; o.uv1.xy = o.uv.xy;#if UNITY_UV_STARTS_AT_TOP if (_MainTex_TexelSize.y &lt; 0) o.uv.y = 1 - o.uv.y;#endif return o; &#125; fixed4 frag_bloom(v2f_bloom i) : SV_Target &#123; // å–åŸå§‹æ¸…æ™°å›¾ç‰‡è¿›è¡Œuvé‡‡æ · fixed4 ori = tex2D(_MainTex, i.uv1); // å–æ¨¡ç³Šå›¾ç‰‡è¿›è¡Œuvé‡‡æ · fixed4 blur = tex2D(_BlurTex, i.uv); // è¾“å‡º = åŸå§‹å›¾åƒå åŠ bloomæƒå€¼*bloomé¢œè‰²*æ³›å…‰é¢œè‰² fixed4 final = ori + _bloomFactor * blur * _bloomColor; return final; &#125; ENDCG SubShader &#123; // pass 0: æå–é«˜å…‰éƒ¨åˆ† Pass &#123; ZTest Off Cull Off ZWrite Off Fog&#123; Mode Off &#125; CGPROGRAM #pragma vertex vert_threshold #pragma fragment frag_threshold ENDCG &#125; // pass 1: é«˜æ–¯æ¨¡ç³Š Pass &#123; ZTest Off Cull Off ZWrite Off Fog&#123; Mode Off &#125; CGPROGRAM #pragma vertex vert_blur #pragma fragment frag_blur ENDCG &#125; // pass 2: æ³›å…‰é¢œè‰² Pass &#123; ZTest Off Cull Off ZWrite Off Fog &#123; Mode Off &#125; CGPROGRAM #pragma vertex vert_bloom #pragma fragment frag_bloom ENDCG &#125; &#125;&#125;]]></content>
      <categories>
        <category>Shader</category>
      </categories>
      <tags>
        <tag>Unity</tag>
        <tag>åå¤„ç†</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity2018ç…§æ˜æµç¨‹]]></title>
    <url>%2F2019%2F03%2F30%2FUnity-2018-Lighting%2F</url>
    <content type="text"><![CDATA[ç›®å‰Unityæä¾›äº†å¤šç§æ¸²æŸ“ç®¡é“ï¼Œä¸¤ç§å…¨å±€ç…§æ˜ç³»ç»Ÿï¼Œå››ç§ç…§æ˜æ¨¡å¼ï¼Œä¸‰ç§ç¯å…‰æ¨¡å¼ï¼Œä»¥åŠä¸¤ç§Shadowmaskæ¨¡å¼ï¼Œä¸ºå¼€å‘è€…åœ¨åˆ›å»ºé¢å‘é«˜é…PCï¼Œä¸»æœºï¼Œç§»åŠ¨å’ŒXRè®¾å¤‡é¡¹ç›®çš„è¿‡ç¨‹ä¸­æä¾›äº†é«˜åº¦çµæ´»æ€§ã€‚ æ¸²æŸ“ç®¡çº¿å†³å®šå¯¹è±¡å¦‚ä½•åœ¨åœºæ™¯ä¸­å‘ˆç°å‡ºæ¥ï¼Œåˆ†ä¸ºä»¥ä¸‹ä¸‰ä¸ªé˜¶æ®µç¬¬ä¸€é˜¶æ®µï¼šå‰”é™¤ï¼ˆCullingï¼‰ã€‚åœ¨æ­¤é˜¶æ®µåˆ—å‡ºéœ€è¦è¢«æ¸²æŸ“çš„å¯¹è±¡ï¼Œä¼˜å…ˆå‘ˆç°æ‘„åƒæœºå¯è§çš„èŒƒå›´ï¼Œä»¥åŠæœªè¢«å…¶å®ƒç‰©ä½“é®æŒ¡çš„å¯¹è±¡ã€‚ç¬¬äºŒé˜¶æ®µï¼šæ¸²æŸ“ï¼ˆrenderingï¼‰ã€‚åœ¨æ­¤é˜¶æ®µï¼Œæ ¹æ®å…‰ç…§è®¾ç½®ä»¥åŠç›¸å…³çš„ç¯å…‰å±æ€§ï¼Œå°†å¯¹è±¡ç»˜åˆ¶åˆ°åŸºäºåƒç´ çš„ç¼“å†²åŒºç§ã€‚ç¬¬ä¸‰é˜¶æ®µï¼šåå¤„ç†ï¼ˆpost-processingï¼‰ã€‚ä¸€èˆ¬åœ¨ç¼“å†²åŒºä¸Šæ‰§è¡Œæ“ä½œï¼Œæ¯”å¦‚åº”ç”¨ColorGradingã€Bloomã€Depth of Fieldç­‰æ•ˆæœï¼Œå°†æœ€ç»ˆè¾“å‡ºåˆ°æ¯ä¸€å¸§ã€‚]]></content>
      <categories>
        <category>Unity-2018</category>
      </categories>
      <tags>
        <tag>Unity-2018</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity-2018]]></title>
    <url>%2F2019%2F03%2F30%2FUnity-2018%2F</url>
    <content type="text"><![CDATA[Shaderä¸­ä½¿ç”¨â€UsePassâ€å¼•ç”¨åŒä¸€ä¸ªShaderçš„å¦å¤–ä¸€ä¸ªSubShaderçš„Passä¼šå¯¼è‡´å´©æºƒï¼Œè¿™ä¸ªæ˜¯Bugè¿˜æ˜¯å°±æ˜¯ä¸èƒ½è¿™ä¹ˆå†™ï¼Ÿæˆ‘ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯2017.4.6f1ã€‚ä¾‹å¦‚è¿™æ ·ï¼š12345678910111213141516171819Shader "Unlit/NewUnlitShader 1"&#123; Properties &#123; _MainTex("Texture". 2D) = "white"&#123;&#125; &#125; SubShader &#123; Tags&#123;"RenderType"="Oparque"&#125; LOD 100 UsePass "Unlit/NewUnlitShader 1/TEST" Pass &#123; Name "test" &#125; &#125;&#125; UsePassä¸»è¦æ˜¯ç”¨æ¥å®ç°ä¸åŒçš„Shaderä¸­çš„ä»£ç å¤ç”¨çš„ï¼ŒæŸ¥çœ‹æ–‡æ¡£çš„è¯ä¹Ÿå¯ä»¥çœ‹åˆ°ç›¸å…³æè¿°ï¼šSome of the shaders conld reuse existing passes from other shaders, reducing code duplicationæ‰€ä»¥ä¸è¦ç”¨UsePasså¼•ç”¨åŒä¸€ä¸ªShaderä¸­çš„Pass]]></content>
      <categories>
        <category>Unity2018</category>
      </categories>
      <tags>
        <tag>Unity2018</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity GI LightMap]]></title>
    <url>%2F2019%2F03%2F30%2FUnity-GI-LightMap%2F</url>
    <content type="text"><![CDATA[å…¨å±€å…‰ç…§å…¨å±€å…‰ç…§ï¼ˆGIï¼‰æ˜¯ä¸€ç§ç³»ç»Ÿï¼Œç”¨äºæ¨¡æ‹Ÿå…‰å¦‚ä½•ä»è¡¨é¢åå°„åˆ°å…¶ä»–è¡¨é¢ï¼ˆé—´æ¥å…‰ï¼‰ï¼Œè€Œä¸ä»…é™äºç›´æ¥ä»å…‰æºå‡»ä¸­è¡¨é¢çš„å…‰ï¼ˆç›´æ¥å…‰ï¼‰ã€‚ç›¸åï¼Œç‰©ä½“çš„å…‰ç…§é¢œè‰²è®¡ç®—åªé™äºè‡ªèº«ï¼Œç›´æ¥ä»å…‰æºå‡»ä¸­è¡¨é¢çš„å…‰ï¼ˆç›´æ¥å…‰ï¼‰å³ä½¿å±€éƒ¨å…‰ç…§ï¼ˆlocal illuminationï¼‰ã€‚ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯â€œå½©è‰²æ¸—è‰²â€ï¼Œä¾‹å¦‚ï¼Œé˜³å…‰å‡»ä¸­çº¢è‰²æ²™å‘ä¼šå¯¼è‡´çº¢ç¯åå¼¹åˆ°å…¶åé¢çš„å¢™ä¸Šã€‚å¦ä¸€ä¸ªæ˜¯å½“é˜³å…‰åœ¨æ´ç©´çš„å¼€å£å¤„æ’å‡»åœ°æ¿å¹¶ä¸”åœ¨å†…éƒ¨å¼¹èµ·æ—¶ï¼Œæ´ç©´çš„å†…éƒ¨éƒ¨åˆ†ä¹Ÿè¢«ç…§äº®ã€‚ä¼ ç»Ÿä¸Šï¼Œè§†é¢‘æ¸¸æˆå’Œå…¶å®ƒå®æ—¶å›¾å½¢åº”ç”¨ä»…é™äºç›´æ¥ç…§æ˜ï¼Œè€Œé—´æ¥ç…§æ˜æ‰€éœ€è®¡ç®—å¤ªæ…¢ï¼Œå› æ­¤å®ƒä»¬åªèƒ½ç”¨äºéå®æ—¶åœºæ™¯ï¼Œå¦‚CGåŠ¨ç”»ç”µå½±ã€‚è§£å†³è¿™ä¸ªé™åˆ¶çš„æ¸¸æˆæ–¹æ³•æ˜¯è®¡ç®—é—´æ¥å…‰ï¼Œåªèƒ½ç”¨äºæå‰çŸ¥é“çš„ç‰©ä½“å’Œè¡¨é¢ï¼Œä¸èƒ½ç§»åŠ¨ï¼ˆé™æ€ï¼‰ã€‚è¿™æ ·ï¼Œæ…¢çš„è®¡ç®—å¯ä»¥æå‰å®Œæˆï¼Œä½†æ˜¯ç”±äºå¯¹è±¡ä¸ç§»åŠ¨ï¼Œæ‰€ä»¥ä»¥è¿™ç§æ–¹å¼é¢„å…ˆè®¡ç®—çš„é—´æ¥å…‰åœ¨è¿è¡Œæ—¶ä»ç„¶æ˜¯æ­£ç¡®çš„ã€‚Unityæ”¯æŒè¿™ç§ç§°ä¸ºçƒ˜çƒ¤GIï¼ˆä¹Ÿç§°ä¸ºçƒ˜çƒ¤å…‰å›¾ï¼‰çš„æŠ€æœ¯ï¼Œä»¥â€œçƒ˜çƒ¤â€å‘½å-é—´æ¥å…‰è¢«é¢„å…ˆè®¡ç®—å’Œå­˜å‚¨çš„è¿‡ç¨‹ï¼ˆçƒ˜çƒ¤ï¼‰ã€‚é™¤é—´æ¥å…‰ä¹‹å¤–ï¼Œçƒ˜çƒ¤GIè¿˜å¯ä»¥åˆ©ç”¨æ›´å¤šçš„è®¡ç®—æ—¶é—´ï¼Œä»åŒºåŸŸç¯å’Œé—´æ¥å…‰äº§ç”Ÿæ¯”é€šå¸¸å¯ä»¥é€šè¿‡å®æ—¶æŠ€æœ¯å®ç°çš„æ›´çœŸå®çš„è½¯é˜´å½±ã€‚çƒ˜çƒ¤GIå’Œé¢„è®¡ç®—å®æ—¶GIéƒ½æœ‰é™åˆ¶ï¼Œåªæœ‰é™æ€å¯¹è±¡å¯ä»¥åŒ…å«åœ¨çƒ˜åŸ¹/é¢„è®¡ç®—ä¸­ï¼Œæ‰€ä»¥ç§»åŠ¨ç‰©ä½“ä¸èƒ½å°†å…‰åå°„åˆ°å…¶å®ƒç‰©ä½“ä¸Šï¼Œåä¹‹äº¦ç„¶ã€‚ å…‰ç…§å›¾å¯¹ä¸€äº›é™æ€çš„ç‰©ä½“å’Œå…‰ï¼Œé¢„å…ˆè®¡ç®—å­˜å‚¨ï¼Œä¸å¿…å®æ—¶è®¡ç®—ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšbakingã€‚bakingçš„ç»“æœå°±æ˜¯ä¸€å¼ lightmappingè´´å›¾ã€‚é’ˆå¯¹å…‰ç…§ç¨³å®šçš„é™æ€ç‰©ä½“ã€‚ çƒ˜åŸ¹Lightmappingåœºæ™¯åŒ…å«å¤§é‡ç‰©ä½“æ—¶ï¼Œå®æ—¶å…‰ç…§çš„é˜´å½±å¯¹æœ‰æˆæ€§èƒ½æœ‰å¾ˆå¤§çš„å½±å“ã€‚ä½¿ç”¨çƒ˜åŸ¹æŠ€æœ¯ï¼Œå¯ä»¥å°†å…‰çº¿æ•ˆæœé¢„æ¸²æŸ“æˆè´´å›¾å†ä½œç”¨åˆ°ç‰©ä½“ä¸Šæ¨¡æ‹Ÿå…‰å½±ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚æ­¥éª¤1ï¼š æ¸¸æˆç‰©ä½“åŠåœ°é¢è®¾ç½®ä¸ºStaticï¼› é€‰æ‹©Window-&gt;Lightmapping-&gt;Bake Sceneé™æ€ç‰©ä½“çš„å½±å­åªèƒ½çƒ˜åŸ¹åœ¨é™æ€ç‰©ä½“ä¸Š]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[NetworkStream]]></title>
    <url>%2F2019%2F03%2F30%2FNetworkStream%2F</url>
    <content type="text"><![CDATA[ä½œç”¨ï¼šå¦‚æœæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´åŸºäºTCPè¿æ¥çš„ï¼Œä»–ä»¬ä¹‹é—´èƒ½å¤Ÿä¾é ä¸€ä¸ªç¨³å®šçš„å­—èŠ‚æµè¿›è¡Œç›¸äº’ä¼ è¾“ä¿¡æ¯ã€‚å‘½åç©ºé—´ï¼šSystem.Net.Socketsæ³¨æ„äº‹é¡¹ï¼š NetworkSteamåªèƒ½ç”¨åœ¨å…·æœ‰TCP/IPåè®®ä¹‹ä¸­ï¼Œå¦‚æœç”¨åœ¨UDPä¸­ç¼–è¯‘ä¸æŠ±é”™ï¼Œä¼šæœ‰å¼‚å¸¸ NetworkStreamæ˜¯é¢å‘è¿æ¥çš„ åœ¨ç½‘ç»œä¸­åˆ©ç”¨æµçš„å½¢å¼ä¼ é€’ä¿¡æ¯ å¿…é¡»å€ŸåŠ©Socketï¼ˆä¹Ÿç§°ä¸ºæµå¤±Socketï¼‰ï¼Œæˆ–ä½¿ç”¨ä¸€äº›è¿”å›çš„è¿”å›å€¼ ç”¨æ³•å’Œæ™®é€šæµæ–¹å¼å‡ ä¹ä¸€æ¨¡ä¸€æ ·ï¼Œä½†å…·æœ‰ç‰¹æ®Šæ€§ TCP/IPï¼ˆTransmission Control Protocol/Internet Protocolï¼‰ï¼ˆä¼ è¾“æ§åˆ¶åè®®/å› ç‰¹ç½‘äº’è”åè®®ï¼‰ IPAddresså‘½åç©ºé—´:System.Net1IPAddress ip = IPAddress.Parse("192.168.1.1");]]></content>
      <categories>
        <category>CSharp</category>
      </categories>
      <tags>
        <tag>CSharp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç®€å†]]></title>
    <url>%2F2019%2F03%2F30%2Fresume%2F</url>
    <content type="text"><![CDATA[åŸºæœ¬ä¿¡æ¯ å§“å æå½¦å³° å¹´é¾„ 27 æ¯•ä¸šé™¢æ ¡ å“ˆå°”æ»¨ç†å·¥å¤§å­¦ ä¸“ä¸š ç½‘ç»œå·¥ç¨‹ å­¦å† æœ¬ç§‘ åº”è˜èŒä½ Unityå®¢æˆ·ç«¯å¼€å‘å·¥ç¨‹å¸ˆ æœŸæœ›è–ªèµ„ 30K ç¦»èŒæ—¶è–ªèµ„ 20K ç±è´¯ å±±è¥¿ æ˜¯å¦å¯ä»¥æ¥å—åŠ ç­ å¯ä»¥æ¥å— ç”µè¯/å¾®ä¿¡ 17610496306 QQ 363476658 é‚®ç®± 363476658@qq.com å±…ä½åœ°å€ æ·±åœ³å—å±±åŒºå—å¤´å¤åŸ æŠ€èƒ½ä¸“é•¿è¯­è¨€èƒ½åŠ›ï¼šç†Ÿç»ƒæŒæ¡C/C++ã€C#ã€Luaè½¯ä»¶èƒ½åŠ›ï¼šUnityã€Visual Studioã€Svnã€Git å·¥ä½œç»å†2014å¹´12æœˆ-2018å¹´8æœˆå°±èŒäºåŒ—äº¬åƒç´ è½¯ä»¶å…¬å¸2018å¹´8æœˆ-2019å¹´3æœˆå°±èŒäºæ·±åœ³çŒ«å§ç§‘æŠ€ é¡¹ç›®ç»å†å¯»ä»™æ‰‹æ¸¸ä»»èŒï¼šå®¢æˆ·ç«¯å¼€å‘é¡¹ç›®ä»‹ç»ï¼šè¯¥é¡¹ç›®å®¢æˆ·ç«¯ä½¿ç”¨Unity5.3.8åŠ uLuaï¼ŒæœåŠ¡å™¨ä½¿ç”¨C++åŠ Luaï¼Œæ•°æ®åº“ä½¿ç”¨Mysqlå¼€å‘ï¼Œæ˜¯ä¸€æ¬¾MMORPGæ‰‹æ¸¸ç±»å‹çš„é¡¹ç›®ã€‚å®¢æˆ·ç«¯ï¼š UIæ¨¡å—ç”±NGUIå’Œluaè¿›è¡Œé€»è¾‘å¼€å‘ æ›´æ–°æ¨¡å— èµ„æºåŠ è½½æ¨¡å— æˆ˜æ–—æ¨¡å— åœºæ™¯æ¨¡å—è‡ªå®šä¹‰åŠ è½½ ç½‘ç»œæ¨¡å—å¤šçº¿ç¨‹Tcpä½¿ç”¨NetworkStreamï¼ŒUdpä½¿ç”¨C++ è¡¨æ ¼æ¨¡å—åˆ†ä¸ºLuaè¡¨æ ¼å’ŒC#è¡¨æ ¼ Luaæ¨¡å— è´Ÿè´£åŠŸèƒ½æ¨¡å—ï¼š æŒ‚æœºå‰¯æœ¬ é•‡å¦–å¡”å‰¯æœ¬ ç»„é˜Ÿ å›¢é˜Ÿ ç”±ä¸¤ä¸ªé˜Ÿä¼ç»„æˆä¸€ä¸ªå›¢é˜Ÿ é£ç‰©å¿— ç§°å· ä»™é˜¶ æˆ˜é˜Ÿèµ› æˆ˜é˜Ÿèµ›æ˜¯ä¸€ä¸ªè·¨æœPVPæ´»åŠ¨ï¼Œå°†ä¸åŒçš„å°åŒºç©å®¶é€šè¿‡åœ¨è·¨æœçš„åŒ¹é…æœºåˆ¶æ‹‰åˆ°åŒä¸€ä¸ªè·¨æœæˆ˜åœºçš„ç©æ³•ã€‚ å¯¹æ¥pandoraï¼ˆå•†åŸã€ç¤¼åŒ…ä¹‹ç±»çš„è¿è¥ä»˜è´¹ç³»ç»Ÿï¼‰ åŒæ—¶å‚ä¸C++æœåŠ¡å™¨è´Ÿè´£é€»è¾‘æ¨¡å—å¼€å‘ é¡¹ç›®æˆå°±ï¼šè¯¥é¡¹ç›®äº2017å¹´ä¸Šçº¿ï¼Œè¾¾åˆ°é¦–æœˆæµæ°´3äº¿ï¼Œå¹´ç»ˆæµæ°´è¿‘6äº¿çš„æˆç»©ã€‚ è‘«èŠ¦å¨ƒæ‰‹æ¸¸ä»»èŒï¼šå®¢æˆ·ç«¯å¼€å‘é¡¹ç›®ä»‹ç»ï¼šè¯¥é¡¹ç›®å®¢æˆ·ç«¯ä½¿ç”¨Unity5.6åŠ uLuaï¼ŒæœåŠ¡å™¨ä½¿ç”¨C++ï¼Œæ•°æ®åº“ä½¿ç”¨Mysqlå¼€å‘ï¼Œæ˜¯ä¸€æ¬¾MMORPGæ‰‹æ¸¸ç±»å‹çš„é¡¹ç›®ã€‚å®¢æˆ·ç«¯ï¼š UIæ¨¡å— æˆ˜æ–—æ¨¡å— åœºæ™¯æ¨¡å— ç½‘ç»œæ¨¡å—å¤šçº¿ç¨‹ Luaæ¨¡å— è´Ÿè´£åŠŸèƒ½æ¨¡å—ï¼š ä»»åŠ¡ç³»ç»Ÿ å…³å¡ç¼–è¾‘å™¨ æ–¹ä¾¿ç­–åˆ’é…ç½®å…³å¡çš„ä¸€æ¬¾ç¼–è¾‘å™¨ã€‚ å‰§æƒ…ç¼–è¾‘å™¨ åŸºäºCinemaå®ç°çš„ä½¿ç¾æœ¯å¯åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹é¢„è§ˆå’Œç¼–è¾‘çš„ä¸€æ¬¾ç¼–è¾‘å™¨ã€‚ luaæ¡†æ¶æ­å»ºä¸ç»´æŠ¤ ä½¿ç”¨uLuaè¿›è¡Œæ­å»ºã€‚ UIç³»ç»Ÿç»´æŠ¤ è¡¨æ ¼ç®¡ç† xmlä½œä¸ºè¡¨ç»“æ„ï¼Œexcelä½œä¸ºæ•°æ®ï¼Œæœ€åè¾“å‡ºæˆäºŒè¿›åˆ¶æ–‡ä»¶ åŒæ—¶å‚ä¸C++æœåŠ¡å™¨è´Ÿè´£é€»è¾‘æ¨¡å—å¼€å‘ è‡ªæˆ‘è¯„ä»·è®¤çœŸè´Ÿè´£ã€ä¸ç­–åˆ’ç¾æœ¯å¯ä»¥è‰¯å¥½çš„åä½œå¼€å‘ã€å–œæ¬¢ä¸“ç ”æŠ€æœ¯ã€‚]]></content>
      <categories>
        <category>é¢è¯•</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆ¤æ–­ç‚¹å’Œå¤šè¾¹å½¢å…³ç³»]]></title>
    <url>%2F2019%2F03%2F29%2Fpoint-polygon%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡è®¨è®ºå¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç‚¹æ˜¯åœ¨å¤šè¾¹å½¢å†…éƒ¨ï¼Œè¾¹ä¸Šè¿˜æ˜¯åœ¨å¤–éƒ¨ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œè¿™é‡Œçš„å¤šè¾¹å½¢é»˜è®¤ä¸ºæœ‰å‘å¤šè¾¹å½¢ï¼Œè§„å®šæ²¿å¤šè¾¹å½¢çš„æ­£å‘ï¼Œè¾¹çš„å·¦ä¾§ä¸ºå¤šè¾¹å½¢çš„å†…æµ‹åŸŸï¼Œå³å¤šè¾¹å½¢æŒ‰é€†æ—¶é’ˆæ–¹å‘éå†ï¼Œä¸è€ƒäº†è‡ªäº¤ç­‰å¤æ‚æƒ…å†µã€‚ æ¯”è¾ƒå¸¸è§çš„åˆ¤æ–­ç‚¹ä¸å¤šè¾¹å½¢å…³ç³»çš„ç®—æ³•æœ‰å°„çº¿æ³•ã€é¢ç§¯æ³•ã€ç‚¹çº¿åˆ¤æ–­æ³•å’Œå¼§é•¿æ³•ç­‰ï¼Œç®—æ³•å¤æ‚åº¦éƒ½ä¸ºO(n)ï¼Œä¸è¿‡åªæœ‰å°„çº¿æ³•å¯ä»¥æ­£ç¡®ç”¨äºå‡¹å¤šè¾¹å½¢ï¼Œå…¶ä»–3ä¸ªåªå¯ä»¥ç”¨äºå‡¸å¤šè¾¹å½¢ã€‚ å°„çº¿æ³•å°„çº¿æ³•æ˜¯ä½¿ç”¨æœ€å¹¿æ³›çš„ç®—æ³•ï¼Œè¿™æ˜¯ç”±äºç›¸æ¯”è¾ƒå…¶ä»–ç®—æ³•è€Œè¨€ï¼Œå®ƒä¸ä½†å¯ä»¥æ­£ç¡®ä½¿ç”¨åœ¨å‡¹å¤šè¾¹å½¢ä¸Šï¼Œè€Œä¸”ä¸éœ€è¦è€ƒè™‘ç²¾åº¦è¯¯å·®é—®é¢˜ã€‚è¯¥ç®—æ³•æ€æƒ³æ˜¯ä»ç‚¹å‡ºå‘å‘å³æ°´å¹³åšä¸€æ¡å°„çº¿ï¼Œè®¡ç®—è¯¥å°„çº¿ä¸å¤šè¾¹å½¢çš„è¾¹çš„ç›¸äº¤ä¸ªæ•°ï¼Œå½“ç‚¹ä¸åœ¨å¤šè¾¹å½¢ä¸Šæ—¶ï¼Œå¦‚æœæ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆç‚¹å°±ä¸€å®šåœ¨å¤šè¾¹å½¢å†…éƒ¨ï¼Œå¦åˆ™ï¼Œåœ¨å¤–éƒ¨ã€‚123456789101112131415for (int i = 0; i &lt; nCount; ++i)&#123; Vector3 p1 = mNodes[i]; Vector3 p2 = mNodes[(i + 1) % nCount]; if (p1.z == p2.z) //p1p2ä¸y=p0.yå¹³è¡Œ; continue; if (pt.z &lt; Mathf.Min(p1.z, p2.z)) // äº¤ç‚¹åœ¨p1p2å»¶é•¿çº¿ä¸Š; continue; if (pt.z &gt;= Mathf.Max(p1.z, p2.z)) // äº¤ç‚¹åœ¨p1p2å»¶é•¿çº¿ä¸Š; continue; // æ±‚äº¤ç‚¹çš„Xåæ ‡; float x = (pt.z - p1.z) * (p2.x - p1.x) / (p2.z - p1.z) + p1.x; if (x &gt; pt.x) // åªç»Ÿè®¡å•è¾¹äº¤ç‚¹; ++nCross;&#125; ä¸Šé¢ä»£ç åˆ©ç”¨ä¸‰è§’å½¢åŸç†ï¼Œp1å’Œp2çš„ç»„æˆçš„ç›´è§’ä¸‰è§’å½¢å’Œp1å’Œpç»„æˆç›´è§’ä¸‰è§’å½¢ é¢ç§¯æ³•é¢ç§¯æ³•çš„æ€æƒ³æ˜¯å¦‚æœç‚¹åœ¨å¤šè¾¹å½¢å†…éƒ¨æˆ–è€…è¾¹ä¸Šï¼Œé‚£ä¹ˆç‚¹ä¸å¤šè¾¹å½¢æ‰€ç»„æˆçš„ä¸‰è§’å½¢é¢ç§¯å’Œç­‰äºå¤šè¾¹å½¢é¢ç§¯ã€‚å¤šè¾¹å½¢çš„é¢ç§¯å…¬å¼å¯ä»¥ä½¿ç”¨å‰ç§¯è®¡ç®—ï¼Œä¸è¿‡è®¡ç®—é¢ç§¯æ˜¯ä¼šæœ‰ä¸€å®šè¯¯å·®çš„ï¼Œéœ€è¦è®¾ç½®ç²¾åº¦çš„è¯¯å·®èŒƒå›´ã€‚ ç‚¹çº¿åˆ¤æ–­æ³•å¯¹äºå¤šè¾¹å½¢ï¼Œå¦‚æœä¸€ä¸ªç‚¹åœ¨å®ƒæ‰€æœ‰è¾¹çš„å·¦è¾¹ï¼Œé‚£ä¹ˆè¿™ä¸ªç‚¹ä¸€å®šåœ¨å¤šè¾¹å½¢å†…éƒ¨ã€‚åˆ©ç”¨å‰ç§¯æ­£å¥½å¯ä»¥åˆ¤æ–­ç‚¹ä¸ç»™å®šè¾¹çš„å…³ç³»ï¼Œå³ç‚¹åœ¨è¾¹çš„å·¦è¾¹å³è¾¹è¿˜æ˜¯è¾¹ä¸Šã€‚ å¼§é•¿æ³•]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[C#ä¸­é™æ€å­—æ®µå’Œç±»æˆå‘˜çš„æ‰§è¡Œé¡ºåº]]></title>
    <url>%2F2019%2F03%2F29%2FCSharpClassFieldSort%2F</url>
    <content type="text"><![CDATA[å…ˆè¿›è¡Œç»†åˆ†ï¼šç±»çš„æˆå‘˜åˆ†ä¸ºï¼šå­—æ®µã€å±æ€§ã€æ–¹æ³•ã€æ„é€ æ–¹æ³•æˆå‘˜çš„ä¿®é¥°ç¬¦ï¼šé™æ€æˆå‘˜ã€å®ä¾‹æˆå‘˜å±‚æ¬¡ç»“æ„ï¼šçˆ¶ç±»ã€å­ç±» å…ˆä¸è€ƒè™‘ç»§æ‰¿å…³ç³»ï¼Œæ‰§è¡Œé¡ºåºä¸ºï¼š é™æ€å­—æ®µ é™æ€æ„é€ æ–¹æ³• å®ä¾‹å­—æ®µ å®ä¾‹æ„é€ æ–¹æ³• åœ¨è€ƒè™‘ç»§æ‰¿å…³ç³»ï¼Œæ‰§è¡Œé¡ºåºä¸ºï¼š å­ç±»çš„é™æ€å­—æ®µ å­ç±»çš„é™æ€æ„é€ æ–¹æ³• å­ç±»çš„å®ä¾‹å­—æ®µ çˆ¶ç±»çš„é™æ€å­—æ®µ çˆ¶ç±»çš„é™æ€æ„é€ æ–¹æ³• çˆ¶ç±»çš„å®ä¾‹å­—æ®µ çˆ¶ç±»çš„å®ä¾‹æ„é€ æ–¹æ³• å­ç±»çš„å®ä¾‹æ„é€ æ–¹æ³• ç±»çš„é™æ€å­—æ®µå˜é‡åˆå§‹å€¼è®¾å®šé¡¹å¯¹åº”äºä¸€ä¸ªèµ‹å€¼åºåˆ—ï¼Œè¿™äº›èµ‹å€¼æŒ‰ç…§ä»–ä»¬åœ¨ç›¸å…³çš„ç±»å£°æ˜ä¸­å‡ºç°çš„æ–‡æœ¬é¡ºåºæ‰§è¡Œã€‚å¦‚æœç±»ä¸­å­˜åœ¨é™æ€æ„é€ å‡½æ•°ï¼Œåˆ™é™æ€å­—æ®µåˆå§‹å€¼è®¾å®šé¡¹çš„æ‰§è¡Œåœ¨è¯¥æ„é€ å‡½æ•°å³å°†æ‰§è¡Œå‰å‘ç”Ÿã€‚å¦åˆ™ï¼Œé™æ€å­—æ®µåˆå§‹å€¼è®¾å®šé¡¹åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨è¯¥ç±»çš„é™æ€å­—æ®µä¹‹å‰è¢«æ‰§è¡Œï¼Œä½†å®é™…æ‰§è¡Œæ—¶é—´ä¾èµ–äºå…·ä½“çš„å®ç°ã€‚]]></content>
      <categories>
        <category>CSharp</category>
      </categories>
      <tags>
        <tag>CSharp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é¢è¯•è§£æ]]></title>
    <url>%2F2019%2F03%2F29%2Finterview-parse%2F</url>
    <content type="text"><![CDATA[å†°å·ç½‘ç»œ ç‰›è›™äº’åŠ¨ ç‚¹å’Œå¤šè¾¹å½¢ç›¸äº¤ï¼ˆæ›²çº¿ç›¸äº¤ï¼‰ï¼Ÿ ç¼–è¯‘ä¼šç›´æ¥è¿‡ä¸å»ï¼Œæç¤ºå­—æ®µåˆå§‹å€¼è®¾å®šæ— æ³•å¼•ç”¨éé™æ€å­—æ®µã€æ–¹æ³•æˆ–å±æ€§å°†b = a + 10ï¼Œæ”¹ä¸ºb = c + 10ï¼Œè¾“å‡ºå¦‚ä¸‹ç»“æœa = 10, b = 20, c = 10, d = 10è€ƒç‚¹ï¼šC#æ‰§è¡Œé¡ºåº è®¾è®¡ä¸€ç§å­˜å‚¨ç»“æ„å®ç°å­—å…¸æŸ¥æ‰¾ã€‚]]></content>
      <categories>
        <category>é¢è¯•</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Gamma]]></title>
    <url>%2F2019%2F03%2F29%2FGamma%2F</url>
    <content type="text"><![CDATA[Unityåœ¨UnityCG.cgincå¤´æ–‡ä»¶ä¸­æä¾›äº†GammaToLinearSpaceå’ŒLinearToGammaSpaceè¿›è¡Œç©ºé—´è½¬åŒ–ï¼Œå…¶ä¸­çš„ç®—æ³•æ˜¯è¿‘ä¼¼ç®—æ³•ï¼Œæ•ˆç‡æ¯”è¾ƒé«˜1234567891011121314151617181920inline half3 GammaToLinearSpace(half3 sRGB)&#123; return sRGB * (sRGB * (sRGB * 0.305306011h + 0.682171111h) + 0.012522878h); // ç²¾ç¡®ç‰ˆï¼Œç”¨æ¥è°ƒè¯• // return half3(GammToLinearSpaceExact(sRGB.r), GammaToLinearSpaceExact(sRGB.g), GammaToLinearSpaceExact(sRGB.b));&#125;inline half3 LinearToGammaSpace(half3 linRGB)&#123; linRGB = max(linRGB, half3(0h,0h,0h)); return max(1.055h*pow(linRGB,0.416666667h) - 0.055h, 0h);&#125;inline bool IsGammaSpace()&#123;#if defined(UNITY_NO_LINEAR_COLORSPACE) return true;#else return unity_ColorSpaceLuminance.w == 0;#endif&#125;]]></content>
      <categories>
        <category>æ¸²æŸ“</category>
      </categories>
      <tags>
        <tag>Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[NGUI]]></title>
    <url>%2F2019%2F03%2F28%2FNGUI%2F</url>
    <content type="text"><![CDATA[UIDrawCallUpdateGeometry()é€šè¿‡é¡¶ç‚¹ï¼ŒUVï¼Œé¢œè‰²ï¼Œè´´å›¾ç­‰ä¿¡æ¯ç»˜åˆ¶UIå›¾å½¢ã€‚ å¡«å……é¡¶ç‚¹UIBasicSprite12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152protected void Fill(BetterList&lt;Vector3) verts, BetterList&lt;Vector2&gt; uvs, BetterList&lt;Color32&gt; cols, Rect outer, Rect inner)&#123; switch(type) &#123; case Type.Simple: SimpleFill(verts, uvs, cols, outer, inner); break; case Type.Sliced: SlicedFitt(verts, uvs, cols, outer, inner); break; case Type.Filled: FilledFill(verts, uvs, cols, outer, inner); break; case Type.Tiled: TiledFill(verts, uvs, cols, outer, inner); break; case Type.Advanced: AdvancedFill(verts, uvs, cols, outer, inner); break; &#125;&#125;void SimpleFill(BetterList&lt;Vector3&gt; verts, BetterList&lt;Vector2&gt; uvs, BetterList&lt;Color32&gt; cols, Rect mOuterUV, Rect mInnerUV)&#123; Vector4 v = drawingDimensions; Vector4 u = MakeDrawingUVs(mOuterUV, mInnerUV); verts.Add(new Vector3(v.x, v.y)); verts.Add(new Vector3(v.x, v.w)); verts.Add(new Vector3(v.z, v.w)); verts.Add(new Vector3(v.z, v.y)); uvs.Add(new Vector2(u.x, u.y)); uvs.Add(new Vector2(u.x, u.w)); uvs.Add(new Vector2(u.z, u.w)); uvs.Add(new Vector2(u.z, u.y)); if (!mApplyGradient) &#123; Color32 c = drawingColor; cols.Add(c); cols.Add(c); cols.Add(c); cols.Add(c); &#125; else &#123; AddVertexColours(cols, 1, 1); AddVertexColours(cols, 1, 2); AddVertexColours(cols, 2, 2); AddVertexColours(cols, 2, 1); &#125;&#125; UIWidgetæ’åºå‡½æ•°ï¼Œå¤§äº0çš„è¦äº¤æ¢1234567891011121314static public int PanelCompareFunc(UIWidget left, UIWidget right)&#123; if (left.mDepth &lt; right.mDepth) return -1; if (left.mDepth &gt; right.mDepth) return 1; Material leftMat = left.material; Material rightMat = right.material; if (leftMat == rightMat) return 0; if (leftMat == null) return 1; if (rightMat == null) return -1; return (leftMat.GetInstanceID() &lt; rightMat.GetInstanceID()) ? -1 : 1;&#125;]]></content>
      <categories>
        <category>NGUI</category>
      </categories>
      <tags>
        <tag>NGUI</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Mesh.SetTriangles]]></title>
    <url>%2F2019%2F03%2F28%2FMesh-SetTriangles%2F</url>
    <content type="text"><![CDATA[1public void SetTriangle(int[] triangles, int submesh, bool calculateBounds = true, int baseVertex = 0);]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Cå’ŒC++æ··åˆç¼–ç¨‹ï¼ˆ__cplusplusä¸external "c"çš„ä½¿ç”¨ï¼‰]]></title>
    <url>%2F2019%2F03%2F28%2Fcplusplus%2F</url>
    <content type="text"><![CDATA[ç¬¬ä¸€ç§ç†è§£æ¯”å¦‚è¯´ä½ ç”¨C++å¼€å‘äº†ä¸€ä¸ªDLLåº“ï¼Œä¸ºäº†èƒ½å¤Ÿè®©Cè¯­è¨€ä¹Ÿèƒ½å¤Ÿè°ƒç”¨ä½ çš„DLLè¾“å‡ºï¼ˆExportï¼‰çš„å‡½æ•°ï¼Œä½ éœ€è¦ç”¨extern â€œCâ€æ¥å¼ºåˆ¶ç¼–è¯‘å™¨ä¸è¦ä¿®æ”¹ä½ çš„å‡½æ•°åã€‚é€šå¸¸ï¼Œåœ¨Cè¯­è¨€çš„å¤´æ–‡ä»¶ä¸­ç»å¸¸å¯ä»¥çœ‹åˆ°ç±»ä¼¼ä¸‹é¢è¿™ç§å½¢å¼çš„ä»£ç ï¼š1234567#ifdef __cplusplusextern "C" &#123;#endif/*some declaration or so*/#ifdef __cplusplus&#125;#endif é‚£ä¹ˆè¿™ç§å†™æ³•æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿå®é™…ä¸Šï¼Œè¿™æ˜¯ä¸ºäº†è®©CPPèƒ½å¤Ÿåœ¨Cç¯å¢ƒä¸‹ä½¿ç”¨è€Œé‡‡å–çš„ä¸€ç§è¯­æ³•å½¢å¼ã€‚ä¹‹æ‰€ä»¥é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œæ˜¯å› ä¸ºä¸¤ç§è¯­è¨€ä¹‹é—´çš„ä¸€äº›å·®å¼‚ã€‚ç”±äºCPPæ”¯æŒå¤šæ€æ€§ï¼Œä¹Ÿå°±æ˜¯å…·æœ‰ç›¸åŒå‡½æ•°åçš„å‡½æ•°å¯ä»¥å®Œæˆä¸åŒçš„åŠŸèƒ½ï¼ŒCPPé€šå¸¸æ˜¯é€šè¿‡å‚æ•°åŒºåˆ†å…·ä½“è°ƒç”¨çš„æ˜¯å“ªä¸€ä¸ªå‡½æ•°ã€‚åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼ŒCPPç¼–è¯‘å™¨ä¼šå°†å‚æ•°ç±»å‹å’Œå‡½æ•°åè¿æ¥å†ä¹Ÿä¸€èµ·ï¼Œäºæ˜¯åœ¨ç¨‹åºç¼–è¯‘æˆä¸ºç›®æ ‡æ–‡ä»¶ä»¥åï¼ŒCPPç¼–è¯‘å™¨å¯ä»¥ç›´æ¥æ ¹æ®ç›®æ ‡æ–‡ä»¶ä¸­çš„ç¬¦å·åï¼Œå°†å¤šä¸ªç›®æ ‡æ–‡ä»¶è¿æ¥æˆä¸€ä¸ªç›®æ ‡æ–‡ä»¶æˆ–è€…å¯æ‰§è¡Œæ–‡ä»¶ã€‚ä½†æ˜¯åœ¨Cè¯­è¨€ä¸­ï¼Œç”±äºå®Œå…¨æ²¡æœ‰å¤šæ€æ€§çš„æ¦‚å¿µï¼ŒCç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶é™¤äº†ä¼šåœ¨å‡½æ•°åé’±æ·»åŠ ä¸€ä¸ªä¸‹åˆ’çº¿ä¹‹å¤–ï¼Œä»€ä¹ˆä¹Ÿä¸ä¼šåšã€‚ç”±äºè¿™ç§åŸå› ï¼Œå½“é‡‡ç”¨CPPä¸Cæ··åˆç¼–ç¨‹çš„æ—¶å€™ï¼Œå°±å¯èƒ½å‡ºç°é—®é¢˜ã€‚å‡è®¾ä¸€ä¸ªå¤´æ–‡ä»¶å®šä¹‰äº†è¿™æ ·çš„å‡½æ•°ï¼š1int foo(int a,int b);]]></content>
      <categories>
        <category>C++</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Lua GC çš„æºç å‰–æï¼ˆ1ï¼‰]]></title>
    <url>%2F2019%2F03%2F27%2Flua-gc-1%2F</url>
    <content type="text"><![CDATA[Luaé‡‡ç”¨ä¸€ä¸ªç®€å•æ ‡è®°æ¸…æ¥šç®—æ³•çš„GCç³»ç»Ÿã€‚åœ¨Luaä¸­ï¼Œä¸€å…±åªæœ‰9å°±æ•°æ®ç±»å‹ï¼Œåˆ†åˆ«ä¸ºnilã€booleanã€lightuserdataã€numberã€stringã€tableã€functionã€userdataå’Œthreadã€‚å…¶ä¸­ï¼Œåªæœ‰string table function threadå››ç§åœ¨vmä¸­ä»¥å¼•ç”¨æ–¹å¼å…±äº«ï¼Œæ˜¯éœ€è¦è¢«GCç®¡ç†å›æ”¶çš„å¯¹è±¡ã€‚å…¶å®ƒç±»å‹éƒ½ä»¥å€¼å½¢å¼å­˜åœ¨ã€‚ä½†åœ¨Luaçš„å®ç°ä¸­ï¼Œè¿˜æœ‰ä¸¤ç§ç±»å‹çš„å¯¹è±¡éœ€è¦è¢«GCç®¡ç†ã€‚åˆ†åˆ«æ˜¯protoï¼ˆå¯ä»¥çœ‹ä½œæœªç»‘å®šupvalueçš„å‡½æ•°ï¼‰ï¼Œupvalueï¼ˆå¤šä¸ªupvalueä¼šå¼•ç”¨åŒä¸€ä¸ªå€¼ï¼‰ã€‚Luaæ˜¯ä»¥union+typeçš„å½¢å¼ä¿å­˜å€¼ã€‚å…·ä½“å®šä¹‰å¯è§lobject.hçš„100-107è¡Œï¼š123456789101112131415161718/*** Union of all Lua values*/typedef union Value&#123; GCObject *gc; /* collectable objects */ void *p; /* light userdata */ int b; /* booleans */ lua_CFunction f; /* light C functions */ lua_Integer i; /* integer numbers */ lua_Number n; /* float numbers */&#125;Value;#define TValuefields Value valua_; int tt_typedef struct lua_TValue &#123; TValuefields;&#125;TValue; æˆ‘ä»¬çœ‹åˆ°ï¼ŒValueä»¥unionæ–¹å¼å®šä¹‰ã€‚å¦‚æœæ˜¯éœ€è¦è¢«GCç®¡ç†çš„å¯¹è±¡ï¼Œå°±ä»¥GCObjectæŒ‡é’ˆå½¢å¼ä¿å­˜ï¼Œå¦åˆ™ç›´æ¥ä¿å€¼ã€‚åœ¨ä»£ç çš„å…¶å®ƒéƒ¨åˆ†ï¼Œå¹¶ä¸ç›´æ¥ä½¿ç”¨Valueç±»å‹ï¼Œè€Œæ˜¯TValueç±»å‹ã€‚å®ƒæ¯”Valueå¤šäº†ä¸€ä¸ªç±»å‹æ ‡è¯†ã€‚ç”¨int tt_è®°å½•ã€‚é€šå¸¸çš„ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªTValueé•¿åº¦ä¸º12ä¸ªå­—èŠ‚ã€‚æ‰€æœ‰çš„GCObjectéƒ½æœ‰ä¸€ä¸ªç›¸åŒçš„æ•°æ®å¤´ï¼Œå«åšCommonHeaderï¼Œåœ¨lobject.hé‡Œ79è¡Œä»¥å®å½¢å¼å®šä¹‰å‡ºæ¥ã€‚ä½¿ç”¨å®æ˜¯æºäºä½¿ç”¨ä¸Šçš„æŸç§éå†ã€‚Cè¯­è¨€ä¸æ”¯æŒç»“æ„çš„ç»§æ‰¿ã€‚1234/*** Common Header for all collectable objects (in maro form, to be included in other objecs)*/#define CommonHeader GCObject *next; lu_byte tt; lu_byte marked ä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼šæ‰€æœ‰çš„GCObjectéƒ½ç”¨ä¸€ä¸ªå•å‘é‡è¡¨ä¸²äº†èµ·æ¥ã€‚æ¯ä¸ªå¯¹è±¡éƒ½ä»¥ttæ¥è¯†åˆ«å…¶ç±»å‹ã€‚markedåŸŸç”¨äºæ ‡è®°æ¸…é™¤å·¥ä½œã€‚æ ‡è®°æ¸…é™¤ç®—æ³•æ˜¯ä¸€ç§ç®€å•çš„GCç®—æ³•ã€‚æ¯æ¬¡GCè¿‡ç¨‹ï¼Œå…ˆä»¥è‹¥å¹²æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œé€ä¸ªæŠŠç›´æ¥ä»¥åŠé—´æ¥å’Œå®ƒä»¬ç›¸å…³çš„èŠ‚ç‚¹éƒ½åšä¸Šæ ‡è®°ã€‚å¯¹äºLuaï¼Œè¿™ä¸ªè¿‡ç¨‹å¾ˆå®¹æ˜“å®ç°ã€‚å› ä¸ºæ‰€æœ‰çš„GObjectéƒ½åœ¨åŒä¸€ä¸ªé“¾è¡¨ä¸Šï¼Œå½“æ ‡è®°å®Œæˆåï¼Œéå†è¿™ä¸ªé“¾è¡¨ï¼ŒæŠŠæœªè¢«æ ‡è®°çš„èŠ‚ç‚¹â€”åˆ é™¤å³å¯ã€‚Luaåœ¨å®é™…å®ç°æ—¶ï¼Œå…¶å®ä¸åªç”¨ä¸€æ¡é“¾è¡¨ç»´ç³»æ‰€æœ‰çš„GCObjectã€‚è¿™æ˜¯å› ä¸ºstringç±»å‹æœ‰å…¶ç‰¹æ®Šæ€§ã€‚æ‰€æœ‰çš„stringæ”¾åœ¨ä¸€å¼ å¤§çš„hashè¡¨ä¸­ã€‚å®ƒéœ€è¦ä¿è¯ç³»ç»Ÿä¸­ä¸ä¼šæœ‰å€¼ç›¸åŒçš„stringè¢«åˆ›å»ºä¸¤ä»½ã€‚é¡¾stringæ˜¯è¢«å•ç‹¬ç®¡ç†çš„ï¼Œè€Œä¸ä¸²åœ¨GCObjectçš„é“¾è¡¨ä¸­ã€‚å›å¤´æ¥çœ‹çœ‹lua_Stateè¿™ä¸ªç±»å‹ã€‚è¿™æ˜¯å†™Cå’ŒLuaäº¤äº’æ—¶ç”¨çš„æœ€å¤šçš„æ•°æ®ç±»å‹ã€‚é¡¾åæ€ä¹‰ï¼Œå®ƒè¡¨ç¤ºlua vmçš„æŸç§çŠ¶æ€ã€‚ä»å®ç°ä¸Šè¯´ï¼Œæ›´æ¥è¿‘luaçš„ä¸€ä¸ªthreadä»¥åŠå…¶åŒ…å«çš„ç›¸å…³æ•°æ®ï¼ˆå †æ ˆã€ç¯å¢ƒç­‰ï¼‰ã€‚äº‹å®ä¸Šä¸€ä¸ªlua_Stateä¹Ÿæ˜¯ä¸€ä¸ªç±»å‹çš„threadçš„GCObjectã€‚è§lstate.hã€‚12345678910sturct lua_State &#123; CommonHeader; unsigned short nci; /* number of items in 'ci' list */ lu_byte status; StkId top; /* first free slot in the stack */ global_State *l_G; CallInfo *ci; /* call info for current function */ const Instruction *oldpc; /* last pc traced */ StkId stack_last; /* last free slot in the stack */&#125;]]></content>
      <categories>
        <category>Lua</category>
      </categories>
      <tags>
        <tag>Lua</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ExecuteAlways]]></title>
    <url>%2F2019%2F03%2F25%2FExecuteAlways%2F</url>
    <content type="text"><![CDATA[æè¿°ä½¿è„šæœ¬çš„å®ä¾‹å§‹ç»ˆæ‰§è¡Œï¼Œä½œä¸ºPlay Modeçš„ä¸€éƒ¨åˆ†å’ŒEditingã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒMonoBehavioursä»…åœ¨Play Modeä¸‹æ‰§è¡Œã€‚ å½“å¸Œæœ›è„šæœ¬ä½œä¸ºç¼–è¾‘å™¨å·¥ä½œçš„ä¸€éƒ¨åˆ†æ‰§è¡ŒæŸäº›æ“ä½œæ—¶ï¼Œå¯ä»¥ä½¿ç”¨[ExecuteAlways]å±æ€§ï¼Œè¯¥å·¥å…·ä¸ä¸€å®šä¸æ„å»º ä»…åœ¨Sceneå‘ç”Ÿæ”¹å˜æ˜¯è°ƒç”¨Update å½“Game è¯•å›¾æ¥æ”¶åˆ°å®ƒä¸ä½¿ç”¨çš„éç¼–è¾‘å™¨äº‹ä»¶ï¼ˆä¾‹å¦‚ï¼ŒEventType.ScrollWheelï¼‰ä¼šè°ƒç”¨OnGUI åœ¨åœºæ™¯è¯•å›¾æˆ–è€…Gameè¯•å›¾çš„æ¯æ¬¡é‡ç»˜éƒ½ä¼šè°ƒç”¨OnRenderObjectå’Œå…¶ä»–æ¸²æŸ“å›è°ƒå‡½æ•°]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>UnityEngine</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ExecuteInEditMode]]></title>
    <url>%2F2019%2F03%2F25%2FExecuteInEditMode%2F</url>
    <content type="text"><![CDATA[æè¿°ä½¿è„šæœ¬å®ä¾‹å¯ä»¥åœ¨ç¼–è¾‘æ¨¡å¼è¿è¡Œé»˜è®¤çš„æƒ…å†µä¸‹ï¼ŒMonoBehavioursåªèƒ½åœ¨Playæ¨¡å¼ä¸‹å·¥ä½œã€‚é€šè¿‡æ·»åŠ è¿™ä¸ªå±æ€§ï¼Œä»»ä½•MonoBehaviourå®ä¾‹çš„å›è°ƒå‡½æ•°ä¹Ÿä¼šåœ¨Editæ¨¡å¼ä¸‹æ‰§è¡Œã€‚æ­¤å±æ€§æ­£åœ¨é€æ­¥æ·˜æ±°ï¼Œå› ä¸ºå®ƒä¸è€ƒè™‘é¢„åˆ¶æ¨¡å¼ã€‚å¦‚æœåœ¨é¢„åˆ¶æ¨¡å¼ä¸‹ç¼–è¾‘äº†å…·æœ‰æ­¤å±æ€§çš„MonoBehaviçš„é¢„åˆ¶ä½“ï¼Œå¹¶ä¸”è¾“å…¥äº†æ’­æ”¾æ¨¡å¼ï¼Œåˆ™ç¼–è¾‘å™¨å°†é€€å‡ºé¢„åˆ¶æ¨¡å¼ï¼Œä»¥é˜²æ­¢æ„å¤–ä¿®æ”¹ä»…ç”¨äºæ’­æ”¾æ¨¡å¼çš„é€»è¾‘å¼•èµ·çš„é¢„åˆ¶ä½“ã€‚ è¦æŒ‡ç¤ºMonoBehaviouræ­£ç¡®è€ƒè™‘é¢„åˆ¶æ¨¡å¼å¹¶ä¸”åœ¨æ’­æ”¾æ¨¡å¼ä¸‹é¢„åˆ¶æ¨¡å¼ä¸‹æ‰“å¼€æ˜¯å®‰å…¨çš„ï¼Œå¯ä»¥ä½¿ç”¨å±æ€§ExecuteAlwaysè€Œä¸æ˜¯ExecuteInEdiModeã€‚ Updateï¼šåœ¨Sceneå‘ç”Ÿå˜åŒ–æ—¶è¢«è°ƒç”¨OnGUIï¼šåœ¨Gameè§†å›¾æ¥å—åˆ°Eventæ—¶è¢«è°ƒç”¨OnRenderImageï¼šåœ¨Sceneè§†å›¾æˆ–Gameè§†å›¾é‡ç»˜æ—¶è¢«è°ƒç”¨]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é«˜æ–¯å‡½æ•°]]></title>
    <url>%2F2019%2F03%2F25%2FGaussian%2F</url>
    <content type="text"><![CDATA[ä¸€ç»´é«˜æ–¯å‡½æ•°é«˜æ–¯å‡½æ•°ï¼ŒGaussian Functionï¼Œä¹Ÿç®€ç§°ä¸ºGaussianï¼Œä¸€ç»´å½¢å¼å¦‚ä¸‹ï¼š $f(x)=ae^{(x-b) \over 2c^2}$é«˜æ–¯çš„ä¸€ç»´å›¾æ˜¯ç‰¹å¾å¯¹ç§°â€œbell curveâ€å½¢çŠ¶ï¼Œaæ˜¯æ›²çº¿å°–å³°çš„é«˜åº¦ï¼Œbæ˜¯å°–å³°ä¸­å¿ƒcçš„åæ ‡ï¼Œcç§°ä¸ºæ ‡å‡†æ–¹å·®ï¼Œè¡¨å¾çš„æ˜¯bellé’ŸçŠ¶çš„å®½åº¦ã€‚ä»ä»¥ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œé«˜æ–¯å‡½æ•°æ˜¯ä¸€ä¸ªæŒ‡æ•°å‡½æ•°ï¼Œå…¶logå‡½æ•°æ˜¯å¯¹æ•°å‡¹å‡½æ•°]]></content>
      <categories>
        <category>Math</category>
      </categories>
      <tags>
        <tag>Math</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Opencv]]></title>
    <url>%2F2019%2F03%2F25%2Fopencv%2F</url>
    <content type="text"><![CDATA[å¹³æ»‘å¤„ç†â€œå¹³æ»‘å¤„ç†â€ï¼ˆsmoothingï¼‰ä¹Ÿç§°â€œæ¨¡ç³Šå¤„ç†â€ï¼ˆbluringï¼‰ï¼Œæ˜¯ä¸€é¡¹ç®€å•ä¸”ä½¿ç”¨é¢‘ç‡å¾ˆé«˜çš„å›¾åƒå¤„ç†æ–¹æ³•ã€‚å¹³æ»‘å¤„ç†çš„ç”¨é€”å¾ˆå¤šï¼Œæœ€å¸¸è§çš„æ˜¯ç”¨æ¥å‡å°‘å›¾åƒä¸Šçš„å™ªç‚¹æˆ–è€…å¤±çœŸã€‚åœ¨æ¶‰åŠåˆ°é™ä½å›¾åƒåˆ†è¾¨ç‡æ—¶ï¼Œå¹³æ»‘å¤„ç†æ˜¯éå¸¸å¥½ç”¨çš„æ–¹æ³•ã€‚ å›¾åƒæ»¤æ³¢å’Œæ»¤æ³¢å™¨å›¾åƒæ»¤æ³¢ï¼šå³åœ¨å°½é‡ä¿ç•™å›¾åƒç»†èŠ‚ç‰¹å¾çš„æ¡ä»¶ä¸‹å¯¹ç›®æ ‡å›¾åƒçš„å™ªå£°è¿›è¡ŒæŠ‘åˆ¶ï¼Œæ˜¯å›¾åƒé¢„å¤„ç†ä¸­ä¸å¯ç¼ºå°‘çš„æ“ä½œï¼Œå…¶å¤„ç†æ•ˆæœçš„å¥½åå°†ç›´æ¥å½±å“åˆ°åç»­å›¾åƒå¤„ç†å’Œåˆ†æçš„æœ‰æ•ˆæ€§å’Œå¯é æ€§ã€‚æ¶ˆé™¤å›¾åƒä¸­å™ªå£°æˆä¸ºå«åšå›¾åƒçš„å¹³æ»‘åŒ–æˆ–æ»¤æ³¢æ“ä½œã€‚ä¿¡å·æˆ–å›¾åƒçš„èƒ½é‡å¤§éƒ¨åˆ†å‡ ç§åœ¨å¹…åº¦è°±çš„ä½é¢‘å’Œä¸­é¢‘æ®µæ˜¯å¾ˆå¸¸è§çš„ï¼Œè€Œåœ¨è¾ƒé«˜é¢‘æ®µï¼Œä¿¡æ¯ç»å¸¸è¢«å™ªå£°æ·¹æ²¡ã€‚å› æ­¤ä¸€ä¸ªèƒ½å‡ä½é«˜é¢‘æˆåˆ†å¹…åº¦çš„æ»¤æ³¢å™¨å°±èƒ½å¤Ÿå‡å¼±å™ªå£°çš„å½±å“ã€‚å›¾åƒæ»¤æ³¢çš„ç›®çš„æœ‰ä¸¤ä¸ªï¼šä¸€ä¸ªæ˜¯æŠ½å‡ºå¯¹è±¡çš„ç‰¹å¾ä½œä¸ºå›¾åƒè¯†åˆ«çš„ç‰¹å¾æ¨¡å¼ï¼›å¦ä¸€ä¸ªæ˜¯ä¸ºé€‚åº”å›¾åƒå¤„ç†çš„è¦æ±‚ï¼Œæ¶ˆé™¤å›¾åƒæ•°å­—åŒ–æ—¶æ‰€æ··å…¥çš„å™ªå£°ã€‚è€Œå¯¹æ»¤æ³¢å¤„ç†çš„è¦æ±‚ä¹Ÿæœ‰ä¸¤æ¡ï¼šä¸€æ˜¯ä¸èƒ½æŸåå›¾åƒçš„è½®å»“åŠè¾¹ç¼˜ç­‰é‡è¦ä¿¡æ¯ï¼›äºŒæ˜¯ä½¿å›¾åƒæ¸…æ™°è§†è§‰æ•ˆæœå¥½ã€‚ å¹³æ»‘æ»¤æ³¢æ˜¯ä½é¢‘å¢å¼ºçš„ç©ºé—´åŸŸæ»¤æ³¢æŠ€æœ¯ã€‚å®ƒçš„ç›®çš„æœ‰ä¸¤ç±»ï¼šä¸€ç±»æ˜¯æ¨¡ç³Šï¼›å¦ä¸€ç±»æ˜¯æ¶ˆé™¤å™ªéŸ³ã€‚ æ»¤æ³¢å’Œæ¨¡ç³Šæ»¤æ³¢å¯åˆ†ä¸ºä½é€šæ»¤æ³¢å’Œé«˜é€šæ»¤æ³¢ä¸¤ç§ã€‚è€Œé«˜æ–¯æ»¤æ³¢æ˜¯æŒ‡ç”¨é«˜æ–¯å‡½æ•°ä½œä¸ºæ»¤æ³¢å‡½æ•°çš„æ»¤æ³¢æ“ä½œï¼Œè‡³äºæ˜¯ä¸æ˜¯æ¨¡ç³Šï¼Œè¦çœ‹æ˜¯é«˜æ–¯ä½é€šè¿˜æ˜¯é«˜æ–¯é«˜é€šï¼Œä½é€šå°±æ˜¯æ¨¡ç³Šï¼Œé«˜é€šå°±æ˜¯é”åŒ–ã€‚é«˜æ–¯æ»¤æ³¢æ˜¯æŒ‡ç”¨é«˜æ–¯å‡½æ•°ä½œä¸ºæ»¤æ³¢å‡½æ•°çš„æ»¤æ³¢æ“ä½œã€‚é«˜æ–¯æ¨¡ç³Šå°±æ˜¯é«˜æ–¯ä½é€šæ»¤æ³¢ã€‚ é«˜æ–¯æ»¤æ³¢é«˜æ–¯æ»¤æ³¢æ˜¯ä¸€ç§çº¿æ€§å¹³æ»‘æ»¤æ³¢ï¼Œé€‚ç”¨äºæ¶ˆé™¤é«˜æ–¯å™ªå£°ï¼Œå¹¿æ³›åº”ç”¨äºå›¾åƒå¤„ç†çš„å‡å™ªè¿‡ç¨‹ã€‚]]></content>
      <categories>
        <category>Opencv</category>
      </categories>
      <tags>
        <tag>Opencv</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å±å¹•åå¤„ç†æ•ˆæœ]]></title>
    <url>%2F2019%2F03%2F25%2Fgauss%2F</url>
    <content type="text"><![CDATA[å±å¹•åå¤„ç†ï¼Œé€šå¸¸æŒ‡çš„æ˜¯åœ¨æ¸²æŸ“æ•´ä¸ªåœºæ™¯å¾—åˆ°å±å¹•å›¾åƒåï¼Œå†å¯¹è¿™ä¸ªå›¾åƒè¿›è¡Œä¸€ç³»åˆ—æ“ä½œï¼Œå®ç°å„ç§å±å¹•ç‰¹æ•ˆã€‚ä½¿ç”¨è¿™ç§æŠ€æœ¯ï¼Œå¯ä»¥ä¸ºæ¸¸æˆç”»é¢æ·»åŠ æ›´å¤šçš„è‰ºæœ¯æ•ˆæœï¼Œä¾‹å¦‚æ™¯æ·±ï¼ˆDepth of Fieldï¼‰ã€è¿åŠ¨æ¨¡ç³Šï¼ˆMotion Blurï¼‰ç­‰ã€‚å› æ­¤ï¼Œæƒ³è¦å®ç°å±å¹•åå¤„ç†çš„åŸºç¡€åœ¨äºå¾—åˆ°æ¸²æŸ“åçš„å±å¹•å›¾åƒï¼Œå³æŠ“å–å±å¹•ï¼Œè€ŒUnityä¸ºæˆ‘ä»¬æä¾›äº†è¿™æ ·ä¸€ä¸ªæ–¹ä¾¿çš„æ¥å£ï¼ŒOnRenderImageå‡½æ•°ã€‚å®ƒçš„å‡½æ•°å£°æ˜å¦‚ä¸‹ï¼š1void OnRenderImage(RenderTexture src, RenderTexture dest) å½“æˆ‘ä»¬åœ¨è„šæœ¬ä¸­å£°æ˜æ­¤å‡½æ•°åï¼ŒUnityä¼šæŠŠå½“å‰æ¸²æŸ“å¾—åˆ°çš„å›¾åƒå­˜å‚¨åœ¨ç¬¬ä¸€ä¸ªå‚æ•°å¯¹åº”çš„æ¸²æŸ“çº¹ç†ä¸­ï¼Œé€šè¿‡å‡½æ•°çš„ä¸€ç³»åˆ—æ“ä½œåï¼Œåœ¨æŠŠç›®æ ‡æ¸²æŸ“çº¹ç†ï¼Œå³ç¬¬äºŒä¸ªæ¡‰æ ‘å¯¹åº”çš„æ¸²æŸ“çº¹ç†æ˜¾ç¤ºåˆ°å±å¹•ä¸Šã€‚åœ¨OnRenderImageå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸æ˜¯åˆ©ç”¨Graphics.Blitå‡½æ•°æ¥å®Œæˆå¯¹æ¸²æŸ“çº¹ç†å¤„ç†ã€‚å®ƒæœ‰3ä¸­å‡½æ•°å£°æ˜ï¼š12345678910namespace UnityEngine&#123; public class Graphics &#123; public static void Blit(Texture src, RenderTexture dest); public static void Blit(Texture source, RenderTexture dest, int sourceDepthSlice, int destDet\pthSlice); public static void Blit(Texture src, RenderTexture dest, Material mat, int pass, int destDepthSlice); public static void Blit(Texture src, Material mat); &#125;&#125; å…¶ä¸­ï¼Œå‚æ•°srcå¯¹åº”äº†æºçº¹ç†ï¼Œåœ¨å±å¹•åå¤„ç†æŠ€æœ¯ä¸­ï¼Œè¿™ä¸ªå‚æ•°é€šå¸¸å°±æ˜¯å½“å‰å±å¹•çš„æ¸²æŸ“çº¹ç†æˆ–æ˜¯ä¸Šä¸€æ­¥å¤„ç†åå¾—åˆ°çš„æ¸²æŸ“çº¹ç†ã€‚å‚æ•°destæ˜¯ç›®æ ‡æ¸²æŸ“çº¹ç†ï¼Œå¦‚æœå®ƒçš„å€¼ä¸ºnullå°±ä¼šç›´æ¥å°†ç»“æœæ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚å‚æ•°matæ˜¯æˆ‘ä»¬ä½¿ç”¨çš„æè´¨ï¼Œè¿™ä¸ªæè´¨ä½¿ç”¨çš„Unity Shaderå°†ä¼šè¿›è¡Œå„ç§å±å¹•åå¤„ç†æ“ä½œï¼Œè€Œsrcçº¹ç†å°†ä¼šè¢«ä¼ é€’ç»™Shaderä¸­åä¸º_MainTextçš„çº¹ç†å±æ€§ã€‚å‚æ•°passçš„é»˜è®¤å€¼ä¸º-1ï¼Œè¡¨ç¤ºå°†ä¼šä¾æ¬¡è°ƒç”¨Shaderå†…çš„æ‰€æœ‰Passã€‚å¦åˆ™ï¼Œåªä¼šè°ƒç”¨ç»™å®šç´¢å¼•çš„Passã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒOnRenderImageå‡½æ•°ä¼šåœ¨æ‰€æœ‰çš„ä¸é€æ˜å’Œé€æ˜çš„Passæ‰§è¡Œå®Œæ¯•åè°ƒç”¨ï¼Œä»¥ä¾¿å¯¹åœºæ™¯ä¸­æ‰€æœ‰æ¸¸æˆå¯¹è±¡éƒ½äº§ç”Ÿå½±å“ã€‚ä½†æœ‰æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ä¸é€æ˜çš„Passï¼ˆå³æ¸²æŸ“é˜Ÿåˆ—å°äºç­‰äº2500çš„Passï¼Œå†…ç½®çš„Backgroundï¼ŒGeometryå’ŒAlphaTestæ¸²æŸ“é˜Ÿåˆ—å‡åœ¨æ­¤èŒƒå›´å†…ï¼‰æ‰§è¡Œå®Œæ¯•åç«‹å³è°ƒç”¨OnRenderImageå‡½æ•°ï¼Œä»è€Œä¸å¯¹é€æ˜ç‰©ä½“äº§ç”Ÿä»»ä½•å½±å“ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨OnRenderImageå‡½æ•°é’±æ·»åŠ ImageEffectOpaqueå±æ€§æ¥å®ç°è¿™æ ·çš„ç›®çš„ã€‚å› æ­¤ï¼Œè¦åœ¨Unityä¸­å®ç°å±å¹•åå¤„ç†æ•ˆæœï¼Œè¿‡ç¨‹é€šå¸¸å¦‚ä¸‹ï¼šæˆ‘ä»¬é¦–å…ˆéœ€è¦åœ¨æ‘„åƒæœºä¸­æ·»åŠ ä¸€ä¸ªç”¨äºå±å¹•åå¤„ç†çš„è„šæœ¬ã€‚åœ¨è¿™ä¸ªè„šæœ¬ä¸­ï¼Œæˆ‘ä»¬ä¼šå®ç°OnRenderImageå‡½æ•°æ¥è·å–å½“å‰å±å¹•çš„æ¸²æŸ“çº¹ç†ã€‚ç„¶åï¼Œå†è°ƒç”¨Graphics.Blitå‡½æ•°ä½¿ç”¨ç‰¹å®šçš„Unity Shaderæ¥å¯¹å½“å‰å›¾åƒè¿›è¡Œå¤„ç†ï¼Œåœ¨æŠŠè¿”å›çš„æ¸²æŸ“çº¹ç†æ˜¾ç¤ºåˆ°å±å¹•ä¸Šã€‚å¯¹äºä¸€äº›å¤æ‚çš„å±å¹•ç‰¹æ•ˆï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å¤šæ¬¡è°ƒç”¨Graphics.Blitå‡½æ•°æ¥å¯¹ä¸Šä¸€æ­¥çš„è¾“å‡ºç»“æœè¿›è¡Œä¸‹ä¸€æ­¥å¤„ç†ã€‚ å·ç§¯åœ¨å›¾åƒå¤„ç†ä¸­ï¼Œå·ç§¯æ“ä½œæŒ‡çš„æ˜¯ä½¿ç”¨ä¸€ä¸ªå·ç§¯æ ¸ï¼ˆkernelï¼‰ä¸€å¼ å›¾åƒä¸­çš„æ¯ä¸ªåƒç´ è¿›è¡Œä¸€äº›åˆ—æ“ä½œã€‚å·ç§¯æ ¸é€šå¸¸æ˜¯ä¸€ä¸ªå››æ–¹å½¢ç½‘æ ¼ç»“æ„ï¼Œè¯¥åŒºåŸŸå†…æ¯ä¸ªæ–¹æ ¼éƒ½æœ‰ä¸€ä¸ªæƒé‡å€¼ã€‚å½“å¯¹å›¾åƒä¸­çš„æŸä¸ªåƒç´ è¿›è¡Œå·ç§¯æ—¶ï¼Œæˆ‘ä»¬ä¼šæŠŠå·ç§¯æ ¸çš„ä¸­å¿ƒæ”¾ç½®äºè¯¥åƒç´ ä¸Šï¼Œç¿»è½¬æ ¸ä¹‹åå†ä¾æ¬¡è®¡ç®—æ ¸ä¸­æ¯ä¸ªå…ƒç´ å’Œå…¶è¦†ç›–çš„å›¾åƒåƒç´ å€¼çš„ä¹˜ç§¯å¹¶æ±‚å’Œï¼Œå¾—åˆ°çš„ç»“æœå°±æ˜¯è¯¥ä½ç½®çš„æ–°åƒç´ å€¼ã€‚ è¿™æ ·çš„è¿‡ç¨‹è™½ç„¶ç®€å•ï¼Œä½†å¯ä»¥å®ç°å¾ˆå¤šå¸¸è§çš„å›¾åƒå¤„ç†æ•ˆæœï¼Œä¾‹å¦‚å›¾åƒæ¨¡ç³Šã€è¾¹ç¼˜æ£€æµ‹ç­‰ã€‚ å¸¸è§çš„è¾¹ç¼˜æ£€æµ‹ç®—å­å·ç§¯æ“ä½œçš„ç¥å¥‡ä¹‹å¤„åœ¨äºé€‰æ‹©çš„å·ç§¯æ ¸ã€‚é‚£ä¹ˆï¼Œç”¨äºè¾¹ç¼˜æ£€æµ‹çš„å·ç§¯æ ¸ï¼ˆä¹Ÿè¢«ç§°ä¸ºè¾¹ç¼˜æ£€æµ‹ç®—å­ï¼‰åº”è¯¥å¼ ä»€ä¹ˆæ ·å‘¢ï¼Ÿå†å›ç­”è¿™ä¸ªé—®é¢˜å‰ï¼Œæˆ‘ä»¬å¯ä»¥é¦–å…ˆå›æƒ³ä¸€ä¸‹è¾¹åˆ°åº•æ˜¯å¦‚ä½•å½¢æˆçš„ã€‚å¦‚æœç›¸é‚»åƒç´ ä¹‹é—´å­˜åœ¨å·®åˆ«æ˜æ˜¾çš„é¢œè‰²ã€äº®åº¦ã€çº¹ç†ç­‰å±æ€§ï¼Œæˆ‘ä»¬å°±ä¼šè®¤ä¸ºå®ƒä»¬ä¹‹é—´åº”è¯¥æœ‰ä¸€æ¡ç¼–è¾‘ã€‚è¿™ç§ç›¸é‚»åƒç´ ä¹‹é—´çš„å·®å€¼å¯ä»¥ç”¨æ¢¯åº¦ï¼ˆgradientï¼‰æ¥è¡¨ç¤ºï¼Œå¯ä»¥æƒ³æƒ³å¾—åˆ°ï¼Œè¾¹ç¼˜å¤„çš„æ¢¯åº¦ç»å¯¹å€¼ä¼šæ¯”è¾ƒå¤§ã€‚åŸºäºè¿™æ ·çš„ç†è§£ï¼Œæœ‰å‡ ç§ä¸åŒçš„è¾¹ç¼˜æ£€æµ‹ç®—å­è¢«å…ˆåæå‡ºæ¥ã€‚ RobertsGx{ -1,0, 0,1,}Gy{ 0,-1, 1, 0,} PrewittGx{ -1,-1,-1, 0, 0, 0, 1, 1, 1,}Gy{ -1, 0, 1, -1, 0, 1, -1, -, 1,} SobelGx{ -1,-2,-1, 0, 0, 0, 1, 2, 1,}Gy{ -1, 0, 1, -2, 0, 2, -1, 0, 1,}3ä¸­å¸¸è§çš„è¾¹ç¼˜æ£€æµ‹ç®—å­ï¼Œå®ƒä»¬éƒ½åŒ…å«äº†ä¸¤ä¸ªæ–¹å‘çš„å·ç§¯æ ¸ï¼Œåˆ†åˆ«ç”¨äºæ£€æµ‹æ°´å¹³æ–¹å‘å’Œç«–ç›´æ–¹å‘ä¸Šçš„è¾¹ç¼˜ä¿¡æ¯ã€‚å†è¿›è¡Œè¾¹ç¼˜æ£€æµ‹æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªåƒç´ åˆ†åˆ«è¿›è¡Œä¸€æ¬¡å·ç§¯è®¡ç®—ï¼Œå¾—åˆ°ä¸¤ä¸ªæ–¹å‘ä¸Šçš„æ¢¯åº¦å€¼Gxå’ŒGyï¼Œè€Œæ•´ä½“çš„æ¢¯åº¦å¯æŒ‰ä¸‹é¢çš„å…¬å¼è®¡ç®—è€Œå¾—ï¼š G = \sqrt{G^2_x + G^2_y}ç”±äºä¸Šè¿°ç¬¦å·åŒ…å«äº†å¼€æ ¹å·æ“ä½œï¼Œå‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œæˆ‘ä»¬æœ‰æ—¶ä¼šä½¿ç”¨ç»å¯¹å€¼æ“ä½œæ¥ä»£æ›¿å¼€æ ¹å·æ“ä½œï¼š G=|G_x|+|G_y|å½“å¾—åˆ°æ¢¯åº¦åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ®æ­¤æ¥åˆ¤æ–­å“ªäº›åƒç´ å¯¹åº”äº†è¾¹ç¼˜ï¼ˆæ¢¯åº¦å€¼è¶Šå¤§ï¼Œè¶Šæœ‰å¯èƒ½æ˜¯è¾¹ç¼˜ç‚¹ï¼‰ã€‚æ¨¡å¼çš„å®ç°æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œä¾‹å¦‚å‡å€¼æ¨¡ç³Šå’Œä¸­å€¼æ¨¡ç³Šã€‚å‡å€¼æ¨¡ç³ŠåŒæ ·é€‚ç”¨äº†å·ç§¯æ“ä½œï¼Œå®ƒé€‚ç”¨çš„å·ç§¯æ ¸ä¸­çš„å„ä¸ªå…ƒç´ å€¼éƒ½ç›¸ç­‰ï¼Œä¸”ç›¸åŠ ç­‰äº1ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå·ç§¯åå¾—åˆ°çš„åƒç´ å€¼æ˜¯å…¶é¢†åŸŸå†…å„ä¸ªåƒç´ å€¼çš„å¹³å‡å€¼ã€‚è€Œä¸­å€¼æ¨¡å¼åˆ™æ˜¯é€‰æ‹©é¢†åŸŸå†…å¯¹æ‰€æœ‰åƒç´ æ’åºåçš„ä¸­å€¼æ›¿æ¢æ‰çš„é¢œè‰²ã€‚ä¸€ä¸ªæ›´é«˜çº§çš„æ¨¡ç³Šæ–¹æ³•æ˜¯é«˜æ–¯æ¨¡ç³Šã€‚ é«˜æ–¯æ»¤æ³¢é«˜æ–¯æ¨¡ç³Šï¼ˆGaussian Blurï¼‰ï¼Œä¹Ÿå«é«˜æ–¯å¹³æ»‘ï¼Œé«˜æ–¯æ»¤æ³¢ï¼Œå…¶é€šå¸¸ç”¨å®ƒæ¥å‡å°‘å›¾åƒå™ªå£°ä»¥åŠé™ä½ç»†èŠ‚å±‚æ¬¡ï¼Œå°å°ä¹Ÿè¢«ç”¨äºå¯¹å›¾åƒè¿›è¡Œæ¨¡ç³Šã€‚é€šä¿—çš„è®²ï¼Œé«˜æ–¯æ¨¡ç³Šå°±æ˜¯å¯¹æ•´å¹…å›¾åƒè¿›è¡ŒåŠ æƒå¹³å‡çš„è¿‡ç¨‹ï¼Œæ¯ä¸€ä¸ªåƒç´ ç‚¹çš„å€¼ï¼Œéƒ½ç”±å…¶æœ¬èº«å’Œé¢†åŸŸå†…çš„å…¶ä»–åƒç´ ç»è¿‡åŠ æƒå¹³å‡åå¾—åˆ°ã€‚é«˜æ–¯æ¨¡ç³Šçš„å…·ä½“æ“ä½œæ˜¯ï¼šç”¨ä¸€ä¸ªæ¨¡ç‰ˆï¼ˆæˆ–ç§°å·ç§¯ã€æ©æ¨¡ï¼‰æ‰«æå›¾åƒä¸­çš„æ¯ä¸€ä¸ªåƒç´ ï¼Œç”¨æ¨¡ç‰ˆç¡®å®šçš„é¢†åŸŸå†…åƒç´ çš„åŠ æƒå¹³å‡ç°åº¦å€¼å»æ›¿ä»£æ¨¡ç‰ˆä¸­å¿ƒåƒç´ ç‚¹çš„å€¼ã€‚é«˜æ–¯æ¨¡ç³ŠåŒæ ·åˆ©ç”¨äº†å·ç§¯è®¡ç®—ï¼Œå®ƒé€‚ç”¨äº†å·ç§¯æ ¸åä¸ºé«˜æ–¯æ ¸ã€‚é«˜æ–¯æ ¸æ˜¯ä¸€ä¸ªæ­£æ–¹å½¢å¤§å°çš„æ»¤æ³¢å™¨ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ çš„è®¡ç®—éƒ½æ˜¯åŸºäºä¸‹é¢çš„é«˜æ–¯æ–¹ç¨‹ï¼š $G(x,y)= {1 \over 2\pi\delta^2}^{e^{x^2+y^2 \over 2\delta^2}}$å…¶ä¸­ï¼Œ$\delta$æ˜¯æ ‡å‡†æ–¹å·®ï¼ˆä¸€èˆ¬å–å€¼ä¸º1ï¼‰ï¼Œxå’Œyåˆ†åˆ«å¯¹åº”äº†å½“å‰ä½ç½®åˆ°å·ç§¯æ ¸ä¸­å¿ƒçš„æ•´æ•°è·ç¦»ã€‚è¦æ„å»ºä¸€ä¸ªé«˜æ–¯æ ¸ï¼Œæˆ‘ä»¬åªéœ€è¦è®¡ç®—é«˜æ–¯æ ¸ä¸­å„ä¸ªä½ç½®å¯¹åº”çš„é«˜æ–¯å€¼ã€‚ä¸ºäº†ä¿è¯æ»¤æ³¢åçš„å›¾åƒä¸ä¼šå˜æš—ï¼Œæˆ‘ä»¬éœ€è¦å¯¹é«˜æ–¯æ ¸ä¸­çš„æƒé‡è¿›è¡Œå½’ä¸€åŒ–ï¼Œæ—¢è®©æ¯ä¸ªæƒé‡é™¤ä»¥æ‰€æœ‰æƒé‡çš„å’Œï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ‰€æœ‰æƒé‡çš„å’Œä¸º1ã€‚å› æ­¤ï¼Œé«˜æ–¯å‡½æ•°ä¸­eå‰é¢çš„ç³»æ•°å®é™…ä¸ä¼šå¯¹ç»“æœæœ‰ä»»ä½•å½±å“ã€‚é«˜æ–¯æ–¹ç¨‹å¾ˆå¥½åœ°æ¨¡æ‹Ÿäº†é¢†åŸŸæ¯ä¸ªåƒç´ å¯¹å½“å‰å¤„ç†åƒç´ çš„å½±å“ç¨‹åº¦ï¼Œè·ç¦»è¶Šè¿‘ï¼Œå½±å“è¶Šå¤§ã€‚]]></content>
      <categories>
        <category>Unity Shader</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AssetBundles]]></title>
    <url>%2F2019%2F03%2F24%2FAssetBundlesIntro%2F</url>
    <content type="text"><![CDATA[AssetBundlesAssetBundleæ˜¯ä¸€ä¸ªåŒ…å«æ¨¡å‹ï¼Œçº¹ç†ï¼Œé¢„åˆ¶ï¼ŒéŸ³é¢‘å‰ªè¾‘ï¼Œç”šè‡³æ•´ä¸ªåœºæ™¯çš„å¯ä»¥åœ¨è¿è¡Œä¸­åŠ è½½çš„æ¡£æ¡ˆæ–‡ä»¶ã€‚AssetBundleså¯ä»¥è¡¨è¾¾å½¼æ­¤ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼›ä¾‹å¦‚ï¼ŒAssetBundle Aä¸­çš„Matrialå¯ä»¥å¼•ç”¨AssetBundle Bä¸­çš„çº¹ç†ã€‚ä¸ºäº†é€šè¿‡ç½‘ç»œè¿›è¡Œæœ‰æ•ˆä¼ é€’ï¼Œå¯ä»¥æ ¹æ®ç”¨ä¾‹éœ€æ±‚ä½¿ç”¨å†…ç½®ç®—æ³•é€‰æ‹©å‹ç¼©AssetBundleã€‚AssetBundleså¯ç”¨äºï¼šå¯ä¸‹è½½çš„å†…å®¹æ›´æ–°ï¼ˆDLCï¼‰ã€é™ä½åˆå§‹å®‰è£…åŒ…å¤§å°ã€é’ˆå¯¹ç”¨æˆ·å¹³å°è¿›è¡Œæœ€ä¼˜èµ„æºåŠ è½½ï¼Œä»¥åŠé™ä½è¿è¡Œæ—¶å†…å­˜å‹åŠ›ã€‚ å‹ç¼©æ ¼å¼(BuildAssetBundleOptions) None æ— éœ€ä»»ä½•ç‰¹æ®Šé€‰é¡¹å³å¯æ„å»ºassetBundle UncompressedAssetBundle åˆ›å»ºabåŒ…æ—¶ä¸å‹ç¼©æ•°æ® DisableWriteTypeTree ä¸å†abä¸­åŒ…å«ç±»å‹ä¿¡æ¯ DeterministicAssetBundle ä½¿ç”¨å­˜å‚¨åœ¨assetä¸­çš„idçš„hashæ„å»ºab ForceRebuildAssetBundle å¼ºåˆ¶rebuild ab IgnoreTypeTreeChanges æ‰§è¡Œå¢é‡æ„å»ºæ£€æŸ¥æ—¶å¿½ç•¥ç±»å‹æ ‘çš„æ”¹å˜ AppendHashToAssetBundleName å°†hashé™„åŠ åˆ°assetBundleåç§° ChunkBasedCompression åˆ›å»ºAssetBundleæ—¶ä½¿ç”¨åŸºäºå—LZ4å‹ç¼© StricMode å¦‚æœåœ¨å…¶ä¸­æŠ¥å‘Šä»»ä½•é”™è¯¯ï¼Œåˆ™ä¸å…è®¸æ„å»ºæˆåŠŸ DryRunBuild åªç¼–è¯‘ DisableLoadAssetByFileName ç¦ç”¨æ‰é€šè¿‡æ–‡ä»¶ååŠ è½½ab DisableLoadAssetByFileNameWithExtension ç¦ç”¨æ‰é€šè¿‡æ–‡ä»¶ååç¼€åŠ è½½ab Unity5çš„BuildAssetBundleOptionsæœ‰CollectionDependenciesä½†æ˜¯åœ¨Unity2018.3ä¸­å·²ç»åºŸå¼ƒäº†ï¼ŒåŸå› æ˜¯2018.3é»˜è®¤æ”¶é›†èµ„æºçš„ä¾èµ–èµ„æºã€‚è¿™ä¸ªç‰¹æ€§ååˆ†çš„æ–¹ä¾¿ï¼Œæˆ‘ä»¬åªéœ€è¦å°†æ‰€æœ‰ä¸œè¥¿éƒ½åšæˆprefabï¼Œå°†prefabä½œä¸ºèµ„æºæŒ‡å®šç»™AssetBundleï¼Œç”±Unityè‡ªå·±å»æ”¶é›†æ‰€ç”¨åˆ°çš„èµ„æºå°±å¥½äº†ã€‚ä½†å®é™…é¡¹ç›®ä¸­ä»…ä»…å¦‚æ­¤æ˜¯ä¸å¤Ÿçš„ï¼ŒåŸå› åœ¨å¤ç”¨çš„èµ„æºä¸Šã€‚å¦‚æœå¤šä¸ªprefabä½¿ç”¨äº†åŒä¸€ä¸ªèµ„æºï¼Œä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬æ¥è¯•éªŒä¸€ä¸‹ã€‚ è€Œimageä¸‹é¢çš„Dependenciesæ˜¯ç©ºçš„ï¼Œä¹Ÿå°±æ˜¯å®ƒæ²¡æœ‰ä»»ä½•ä¾èµ–äº†ã€‚ ç„¶åæ­¤æ—¶æˆ‘åœ¨å°†èµ„æºä¹Ÿæ‰“åŒ…ï¼Œæ­¤æ—¶çš„Dependencieså°±å‡ºæ¥äº†ï¼Œä½†æ˜¯è·¯å¾„æ˜¯ç»å¯¹è·¯å¾„ã€‚è¿™å…¶å®å°±æ˜¯AssetBundleçš„é“¾å¼ç»“æ„å’Œå¢é‡æ‰“åŒ…äº†ã€‚ä¸€ä¸ªå°çš„éƒ¨åˆ†æ”¹å˜äº†ï¼Œå®ƒå°†ä¼šæ”¹å˜çš„åªæœ‰æ€»çš„AssetBundle.manifestï¼Œè¿˜æœ‰ç›´æ¥ä¾èµ–å®ƒæœ¬èº«çš„manifestã€‚å…¶ä»–ä¸ä¾èµ–çš„éƒ¨åˆ†æ˜¯ä¸éœ€è¦é‡æ–°æ‰“åŒ…çš„ã€‚è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œé™¤äº†manifestæ–‡ä»¶ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªæ²¡æœ‰åç¼€åç§°çš„AssetBundleæ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶å…¶å®æ‰æ˜¯åŒ…å«äº†æ‰€æœ‰ä¾èµ–å…³ç³»çš„æ€»çš„ä¾èµ–å…³ç³»çš„é…ç½®æ–‡ä»¶ï¼Œåˆšæ‰æˆ‘ä»¬èƒ½ç”¨txtæ‰“å¼€çš„manifestæ–‡ä»¶ï¼Œéƒ½åªæ˜¯ç”¨æ¥åšæœ¬åœ°ä¾èµ–å…³ç³»å’Œå¢é‡æ‰“åŒ…çš„æ—¶å€™ç”¨çš„ã€‚æˆ‘ä»¬åŠ è½½AssetBundleçš„æ—¶å€™ï¼Œå®Œå…¨ä¸éœ€è¦åŠ è½½é‚£ä¹ˆmanifestæ–‡ä»¶çš„ï¼Œåªéœ€è¦é‚£ä¸ªæ²¡æœ‰åç¼€åç§°çš„AssetBundleæ–‡ä»¶ï¼ˆå…·ä½“åå­—å’Œä½ å¯¼å‡ºçš„æ–‡ä»¶å¤¹æœ‰å…³ï¼‰å°±è¡Œäº†ã€‚å®ƒä»£è¡¨çš„æ˜¯è¯¥é¡¹ç›®çš„æ‰€æœ‰AssetBundleä¾èµ–å…³ç³»ã€‚æ‰€ä»¥ï¼Œåˆšæ‰æˆ‘ä»¬çœ‹åˆ°çš„manifesté‡Œé¢ç”¨çš„éƒ½æ˜¯æœ¬åœ°ç»å¯¹è·¯åŠ²ï¼Œé‚£æ˜¯é’ˆå¯¹ä½ æœ¬åœ°æ‰“åŒ…æ—¶ç”¨çš„ï¼Œå’ŒåŠ è½½æ— å…³ã€‚]]></content>
      <tags>
        <tag>Unity</tag>
        <tag>AssetBundle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DirectX 9 3Dæ¸¸æˆè®¾è®¡å…¥é—¨]]></title>
    <url>%2F2019%2F03%2F24%2FDirectX93DGame%2F</url>
    <content type="text"><![CDATA[ä¸‰ç»´ç©ºé—´ä¸­çš„å‘é‡ å‡ ä½•å­¦ä¸­ï¼Œæˆ‘ä»¬ç”¨æœ‰å‘çº¿æ®µè¡¨ç¤ºå‘é‡ï¼Œå¦‚å›¾1ã€‚å‘é‡çš„ä¸¤ä¸ªå±æ€§æ˜¯ä»–çš„é•¿åº¦å’Œä»–çš„é¡¶ç‚¹æ‰€æŒ‡çš„æ–¹å‘ã€‚å› æ­¤ï¼Œå¯ä»¥ç”¨å‘é‡æ¥æ¨¡æ‹Ÿæ—¢æœ‰å¤§å°åˆæœ‰æ–¹å‘çš„ç‰©ç†æ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œä»¥åæˆ‘ä»¬è¦å®ç°çš„ç²’å­ç³»ç»Ÿã€‚æˆ‘ä»¬ç”¨å‘é‡æ¥æ¨¡æ‹Ÿç²’å­çš„é€Ÿåº¦å’ŒåŠ é€Ÿåº¦ã€‚åœ¨3Dè®¡ç®—æœºå›¾å½¢å­¦ä¸­æˆ‘ä»¬ç”¨å‘é‡ä¸ä»…ä»…æ¨¡æ‹Ÿæ–¹å‘ã€‚ä¾‹å¦‚æˆ‘ä»¬å¸¸å¸¸æƒ³çŸ¥é“å…‰çº¿çš„ç…§å°„æ–¹å‘ï¼Œä»¥åŠåœ¨3Dä¸–ç•Œä¸­çš„æ‘„è±¡æœºã€‚å‘é‡ä¸ºåœ¨3ç»´ç©ºé—´ä¸­è¡¨ç¤ºæ–¹å‘çš„æä¾›äº†æ–¹ä¾¿ã€‚ å‘é‡ä¸ä½ç½®æ— å…³ã€‚æœ‰åŒæ ·é•¿åº¦å’Œæ–¹å‘çš„ä¸¤ä¸ªå‘é‡æ˜¯ç›¸ç­‰çš„ï¼Œå³ä½¿ä»–ä»¬åœ¨ä¸åŒçš„ä½ç½®ã€‚è§‚å¯Ÿå½¼æ­¤å¹³è¡Œçš„ä¸¤ä¸ªå‘é‡ï¼Œä¾‹å¦‚åœ¨å›¾1ä¸­uå’Œvæ˜¯ç›¸ç­‰çš„ã€‚ æˆ‘ä»¬ç»§ç»­å­¦ä¹ å·¦æ‰‹åæ ‡ç³»ã€‚å›¾2æ˜¾ç¤ºçš„æ˜¯å·¦æ‰‹åæ ‡ç³»å’Œå³æ‰‹åæ ‡ç³»ã€‚ä¸¤è€…ä¸åŒçš„æ˜¯Zè½´çš„æ–¹å‘ã€‚åœ¨å·¦æ‰‹åæ ‡ç³»ä¸­Zè½´æ˜¯å‘ä¹¦çš„é‡Œé¢å»çš„ï¼Œè€Œå³æ‰‹åæ ‡ç³»æ˜¯å‘ä¹¦çš„å¤–è¾¹å»çš„ã€‚ å›¾2 å› ä¸ºå‘é‡çš„ä½ç½®ä¸èƒ½æ”¹å˜å®ƒçš„æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰å‘é‡å¹³ç§»ä½¿ä»–ä»¬çš„å°¾éƒ¨å’Œåæ ‡ç³»çš„åŸç‚¹é‡åˆã€‚å› æ­¤ï¼Œå½“ä¸€ä¸ªå‘é‡åœ¨æ ‡å‡†ä½ç½®æˆ‘ä»¬èƒ½é€šè¿‡å¤´ç‚¹æ¥æè¿°å‘é‡ã€‚å›¾3æ˜¾ç¤ºçš„æ˜¯å›¾1ä¸­çš„å‘é‡åœ¨æ ‡å‡†ä½ç½®çš„æ ·å­ã€‚ å›¾3 æˆ‘ä»¬é€šå¸¸ç”¨å°å†™å­—æ¯è¡¨ç¤ºä¸€ä¸ªå‘é‡ï¼Œä½†æœ‰æ—¶ä¹Ÿç”¨å¤§å†™å­—æ¯ã€‚å¦‚2ã€3å’Œ4ç»´å‘é‡åˆ†åˆ«æ˜¯ï¼š u = (ux, uy), N = (Nx, Ny, Nz), c = (cx, cy, cz, cw)ã€‚ æˆ‘ä»¬ç°åœ¨ä»‹ç»4ä¸ªç‰¹æ®Šçš„3Då‘é‡ï¼Œå°±è±¡å›¾4æ˜¾ç¤ºçš„ã€‚é¦–å…ˆæ˜¯éƒ½ç”±å«æœ‰0çš„é›¶å‘é‡ï¼›å®ƒè¢«è¡¨ç¤ºæˆåŠ ç²—çš„0 = (0, 0, 0)ã€‚æ¥ä¸‹æ¥3ä¸ªç‰¹æ®Šçš„å‘é‡æ ‡å‡†åŸºå‘é‡ã€‚å®ƒä»¬è¢«å«åši, jå’Œkå‘é‡ï¼Œåˆ†åˆ«æ²¿ç€åæ ‡ç³»çš„xè½´,yè½´å’Œzè½´ï¼Œå¹¶ä¸”æœ‰1çš„å•ä½é•¿ï¼ši = (1, 0, 0), j = (0, 1, 0), and k = (0, 0, 1)ã€‚æ³¨æ„ï¼šåªæœ‰1ä¸ªå•ä½é•¿åº¦çš„å‘é‡å«åšå•ä½å‘é‡ï¼ˆæ¨¡é•¿ä¸º1çš„å‘é‡ï¼‰ã€‚ å›¾4åœ¨D3DXåº“ä¸­ï¼Œæˆ‘ä»¬èƒ½ç”¨D3DXVECTOR3ç±»è¡¨ç¤º3ç»´ç©ºé—´ä¸­çš„å‘é‡ã€‚å®ƒçš„å®šä¹‰æ˜¯ï¼š1234567891011121314151617181920212223242526272829303132333435typedef struct D3DXVECTOR3 : public D3DVECTOR&#123;public: D3DXVECTOR3() &#123;&#125;; D3DXVECTOR3( CONST FLOAT * ); D3DXVECTOR3( CONST D3DVECTOR&amp; ); D3DXVECTOR3( CONST D3DXFLOAT16 * ); D3DXVECTOR3( FLOAT x, FLOAT y, FLOAT z ); // casting operator FLOAT* (); operator CONST FLOAT* () const; // assignment operators D3DXVECTOR3&amp; operator += ( CONST D3DXVECTOR3&amp; ); D3DXVECTOR3&amp; operator -= ( CONST D3DXVECTOR3&amp; ); D3DXVECTOR3&amp; operator *= ( FLOAT ); D3DXVECTOR3&amp; operator /= ( FLOAT ); // unary operators D3DXVECTOR3 operator + () const; D3DXVECTOR3 operator - () const; // binary operators D3DXVECTOR3 operator + ( CONST D3DXVECTOR3&amp; ) const; D3DXVECTOR3 operator - ( CONST D3DXVECTOR3&amp; ) const; D3DXVECTOR3 operator * ( FLOAT ) const; D3DXVECTOR3 operator / ( FLOAT ) const; friend D3DXVECTOR3 operator * ( FLOAT, CONST struct D3DXVECTOR3&amp; ); BOOL operator == ( CONST D3DXVECTOR3&amp; ) const; BOOL operator != ( CONST D3DXVECTOR3&amp; ) const;&#125; D3DXVECTOR3, *LPD3DXVECTOR3; æ³¨æ„D3DXVECTOR3æ˜¯ä»D3DVECTORç»§æ‰¿çš„ã€‚å®ƒçš„å®šä¹‰æ˜¯ï¼š123typedef struct _D3DVECTOR &#123; float x, y, z;&#125; D3DVECTOR; å‘é‡æœ‰å®ƒä»¬è‡ªå·±çš„ç®—æ³•ï¼Œå°±åƒä½ åœ¨D3DXVECTOR3å®šä¹‰ä¸­çœ‹åˆ°çš„æ•°å­¦è¿ç®—ã€‚ç°åœ¨ä½ ä¸éœ€è¦çŸ¥é“å®ƒä»¬æ€ä¹ˆä½¿ç”¨ã€‚ä»¥åä»‹ç»è¿™äº›å‘é‡è¿ç®—ä»¥åŠä¸€äº›æœ‰ç”¨çš„å‡½æ•°å’Œå…³äºå‘é‡çš„é‡è¦çš„è¯¦ç»†èµ„æ–™ã€‚æ³¨æ„ï¼šåœ¨3Då›¾å½¢ç¨‹åºä¸­ï¼Œè™½ç„¶æˆ‘ä»¬ä¸»è¦å…³å¿ƒ3Då‘é‡ï¼Œä½†æœ‰æ—¶ä¹Ÿä¼šç”¨åˆ°2Då’Œ4Då‘é‡ã€‚åœ¨D3DXåº“ä¸­æä¾›äº†D3DXVECTOR2å’ŒD3DXVECTOR4ç±»æ¥åˆ†åˆ«è¡¨ç°2Då’Œ4Då‘é‡ã€‚ä¸åŒç»´æ•°çš„å‘é‡æœ‰ç€å’Œ3Då‘é‡ä¸€æ ·çš„æ€§è´¨ï¼Œä¹Ÿå°±æ˜¯å®ƒä»¬æè¿°å¤§å°å’Œæ–¹å‘ï¼Œä»…ä»…æ˜¯åœ¨ä¸åŒçš„ç»´æ•°ä¸­ã€‚æ‰€æœ‰è¿™äº›å‘é‡çš„æ•°å­¦è¿ç®—å¯¹äºä¸åŒç»´æ•°å‘é‡éƒ½æœ‰æ•ˆåªæ˜¯æœ‰ä¸€ä¸ªé™¤å¤–ï¼Œå°±æ˜¯å‘é‡ç§¯ã€‚è¿™äº›è¿ç®—æˆ‘ä»¬å¯é€šè¿‡è®ºè¿°3Då‘é‡æ‰©å±•åˆ°2D, 4Dç”šè‡³nç»´å‘é‡ã€‚ å‘é‡ç›¸ç­‰ å‡ ä½•å­¦ä¸Šï¼Œæœ‰åŒæ ·æ–¹å‘å’Œé•¿åº¦çš„ä¸¤ä¸ªå‘é‡ç›¸ç­‰ã€‚æ•°å­¦ä¸Šï¼Œæˆ‘ä»¬è¯´æœ‰åŒæ ·ç»´æ•°å’Œåˆ†é‡çš„å‘é‡ç›¸ç­‰ã€‚ä¾‹å¦‚ï¼šå¦‚æœux = vx, uy = vy, ä¸” uz = vz.é‚£ä¹ˆ(ux, uy, uz) = (vx, vy, vz)ã€‚åœ¨ä»£ç ä¸­æˆ‘ä»¬èƒ½å¤Ÿç”¨â€œ==â€åˆ¤æ–­ä¸¤ä¸ªå‘é‡ç›¸ç­‰ã€‚123D3DXVECTOR u(1.0f, 0.0f, 1.0f);D3DXVECTOR v(0.0f, 1.0f, 0.0f);if( u == v ) return true; åŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½ç”¨â€œï¼=â€åˆ¤æ–­ä¸¤ä¸ªå‘é‡ä¸ç›¸ç­‰ã€‚1if( u != v ) return true; æ³¨æ„ï¼šå½“æ¯”è¾ƒæµ®ç‚¹æ•°æ—¶ï¼Œå¿…é¡»æ³¨æ„ã€‚å› ä¸ºæµ®ç‚¹æ•°ä¸æ˜¯ç²¾ç¡®çš„ï¼Œæˆ‘ä»¬è®¤ä¸ºç›¸ç­‰çš„ä¸¤ä¸ªæµ®ç‚¹æ•°æ˜¯æœ‰ç»†å¾®å·®åˆ«çš„ï¼›å› æ­¤ï¼Œæˆ‘ä»¬æµ‹è¯•å®ƒä»¬è¿‘ä¼¼ç›¸ç­‰ã€‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå¸¸æ•°EPSILONï¼ŒæŠŠå®ƒå½“ä½œéå¸¸å°çš„â€œbufferâ€ã€‚å‡å¦‚ä¸¤ä¸ªæ•°å’ŒEPSILONç›¸å·®å¾ˆå°æˆ‘ä»¬è¯´å®ƒä»¬è¿‘ä¼¼ç›¸ç­‰ã€‚æ¢å¥è¯è¯´ï¼ŒEPSILONè®©æµ®ç‚¹æ•°æœ‰ä¸€å®šçš„ç²¾åº¦ã€‚æ¥ä¸‹æ¥çš„å®ä¾‹å‡½æ•°æ˜¯æ€æ ·ç”¨EPSILONæ¯”è¾ƒä¸¤ä¸ªæµ®ç‚¹æ•°ç›¸ç­‰ã€‚12345bool Equals(float lhs, float rhs)&#123; // if lhs == rhs their difference should be zero return fabs(lhs - rhs) &lt; EPSILON ? true : false;&#125; å½“æˆ‘ä»¬ç”¨D3DXVECTOR3ç±»æ—¶ä¸å¿…æ‹…å¿ƒï¼Œå› ä¸ºå®ƒå·²ç»å¸®æˆ‘ä»¬å¤„ç†äº†ï¼Œä½†æ˜¯åœ¨ä¸€èˆ¬æƒ…å†µä¸‹é€‚å½“æ³¨æ„æ¯”è¾ƒä¸¤ä¸ªæµ®ç‚¹æ•°æ˜¯å¾ˆé‡è¦çš„ã€‚ è®¡ç®—å‘é‡å¤§å°ï¼ˆå‘é‡çš„æ¨¡ï¼‰ å‡ ä½•å­¦ä¸Šï¼Œå‘é‡çš„å¤§å°æ˜¯æœ‰å‘çº¿æ®µçš„é•¿åº¦ã€‚çŸ¥é“å‘é‡çš„åˆ†é‡ï¼Œåˆ©ç”¨ä¸‹é¢çš„å…¬å¼æˆ‘ä»¬å°±èƒ½è®¡ç®—å‡ºå‘é‡çš„å¤§å°ã€‚ $||u||=\sqrt{u_{x}^2+u_{y}^2+u_{z}^2}$â€–uâ€–è¡¨ç¤ºå‘é‡uçš„é•¿åº¦ã€‚ä¾‹å¦‚ï¼šè®¡ç®—å‘é‡u = (1, 2, 3)å’Œv = (1, 1)çš„å¤§å°ã€‚æ ¹æ®å…¬å¼ï¼ˆ1ï¼‰ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š $||u||=\sqrt{1^2+2^2+3^2} = \sqrt{1+4+9}=\sqrt{14}$ æˆ‘ä»¬åˆ©ç”¨D3DXåº“ä¸­ä¸‹é¢çš„å‡½æ•°ä¾¿èƒ½è®¡ç®—å‘é‡çš„å¤§å°ã€‚12345FLOAT D3DXVec3Length( // Returns the magnitude. CONST D3DXVECTOR3* pV // The vector to compute the length of.);D3DXVECTOR3 v(1.0f, 2.0f, 3.0f);float magnitude = D3DXVec3Length( &amp;v ); // = sqrt(14) æ ‡å‡†åŒ–å‘é‡ æ ‡å‡†åŒ–å‘é‡æ˜¯è®©å‘é‡çš„å¤§å°ç­‰äº1ï¼Œå³è¢«å«ä½œå•ä½å‘é‡ã€‚æˆ‘ä»¬èƒ½åˆ©ç”¨å‘é‡å¤§å°ä»¥åŠå„ä¸ªåˆ†é‡æŠŠä¸€ä¸ªå‘é‡æ ‡å‡†åŒ–ï¼Œå°±åƒè¿™æ ·ï¼š $\hat{u} ={u \over ||u||} = {({u_x \over ||u||}, {u_y \over ||u||}, {u_z \over ||u||})}$æˆ‘ä»¬è¿™æ ·è¡¨ç¤ºå•ä½å‘é‡$\hat{u}$ã€‚å¦‚ï¼šæ ‡å‡†åŒ–å‘é‡u = (1, 2, 3) å’Œ v = (1, 1)ã€‚è§£ç­”æ–¹æ³•ï¼šæ ¹æ®(2)å’Œ(3)æˆ‘ä»¬å¾—åˆ°â€–uâ€–=âˆš14 å’Œ â€–vâ€–=âˆš2,å› æ­¤ï¼š æˆ‘ä»¬åˆ©ç”¨D3DXåº“ä¸­ä¸‹é¢çš„å‡½æ•°èƒ½æ ‡å‡†åŒ–å‘é‡ã€‚1234D3DXVECTOR3 *D3DXVec3Normalize( D3DXVECTOR3* pOut, // Result. CONST D3DXVECTOR3* pV // The vector to normalize.); æ³¨æ„ï¼šè¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªæŒ‡é’ˆï¼Œå› æ­¤å®ƒå¯ä»¥ä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ã€‚å¤§æ•°æƒ…å†µä¸‹ï¼Œé™¤éå¦ä½œè¯´æ˜ï¼ŒD3DXæ•°å­¦å‡½æ•°è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚ä½†ä¸æ˜¯æ‰€æœ‰å‡½æ•°éƒ½è¿™æ ·ã€‚ å‘é‡ç›¸åŠ  æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡åˆ†åˆ«æŠŠä¸¤ä¸ªå‘é‡çš„å„ä¸ªåˆ†é‡ç›¸åŠ å¾—åˆ°å‘é‡ä¹‹å’Œï¼Œæ³¨æ„åœ¨ç›¸åŠ ä¹‹å‰å¿…é¡»ä¿è¯å®ƒä»¬æœ‰ç›¸åŒçš„ç»´æ•°ã€‚$u + v = ({u_x + v_x, u_y + v_y, u_z + v_z})$å›¾5æ˜¾ç¤ºçš„æ˜¯å‡ ä½•å­¦ä¸Šçš„å‘é‡ç›¸åŠ ã€‚ ä¸¤ä¸ªå‘é‡ç›¸åŠ çš„ä»£ç ï¼Œæˆ‘ä»¬ä½¿ç”¨é‡è½½çš„åŠ æ³•æ“ä½œç¬¦ï¼š12345D3DXVECTOR3 u(2.0f, 0.0f, 1.0f);D3DXVECTOR3 v(0.0f, -1.0f, 5.0f);// (2.0 + 0.0, 0.0 + (-1.0), 1.0 + 5.0)D3DXVECTOR3 sum = u + v; // = (2.0f, -1.0f, 6.0f) å‘é‡ç›¸å‡ å’ŒåŠ æ³•ç±»ä¼¼ï¼Œé€šè¿‡åˆ†åˆ«æŠŠä¸¤ä¸ªå‘é‡çš„å„ä¸ªåˆ†é‡ç›¸å‡å¾—åˆ°å‘é‡ä¹‹å·®ã€‚å†æ¬¡é‡å£°ä¸¤ä¸ªå‘é‡å¿…é¡»æ˜¯ç›¸åŒç»´æ•°ã€‚ $u + v = ({u_x - v_x, u_y - v_y, u_z - v_z})$å›¾6æ˜¾ç¤ºçš„æ˜¯å‡ ä½•å­¦ä¸Šçš„å‘é‡ç›¸å‡ã€‚ä¸¤ä¸ªå‘é‡ç›¸å‡çš„ä»£ç ï¼Œæˆ‘ä»¬ä½¿ç”¨é‡è½½çš„å‡æ³•æ“ä½œç¬¦ï¼š123D3DXVECTOR3 u(2.0f, 0.0f, 1.0f);D3DXVECTOR3 v(0.0f, -1.0f, 5.0f);D3DXVECTOR3 difference = u - v; // = (2.0f, 1.0f, -4.0f) å›¾6æ˜¾ç¤ºï¼Œå‘é‡å‡æ³•å¾—åˆ°ä¸€ä¸ªä»vå‘é‡ç»ˆç‚¹åˆ°uå‘é‡ç»ˆç‚¹çš„å‘é‡ã€‚å‡å¦‚æˆ‘ä»¬è§£é‡Šuå’Œvçš„åˆ†é‡ï¼Œæˆ‘ä»¬èƒ½ç”¨å‘é‡ç›¸å‡æ‰¾åˆ°ä»ä¸€ä¸ªç‚¹åˆ°å¦ä¸€ä¸ªç‚¹çš„å‘é‡ã€‚è¿™æ˜¯éå¸¸æ–¹ä¾¿çš„æ“ä½œï¼Œå› ä¸ºæˆ‘ä»¬å¸¸å¸¸æƒ³æ‰¾åˆ°ä»ä¸€ä¸ªç‚¹åˆ°å¦ä¸€ä¸ªç‚¹çš„æ–¹å‘å‘é‡ã€‚ æ ‡é‡ä¸å‘é‡çš„ä¹˜ç§¯æˆ‘ä»¬èƒ½ç”¨ä¸€ä¸ªæ ‡é‡ä¸å‘é‡ç›¸ä¹˜ï¼Œå°±è±¡åå­—æš—ç¤ºçš„ä¸€æ ·ï¼Œå‘é‡æŒ‰æ¯”ä¾‹å˜åŒ–ã€‚è¿™ç§è¿ç®—ä¸ä¼šæ”¹å˜å‘é‡çš„æ–¹å‘ï¼Œé™¤éæ ‡é‡æ˜¯è´Ÿæ•°ï¼Œè¿™ç§æƒ…å†µå‘é‡æ–¹å‘ç›¸åã€‚ $ku=(ku_x,ku_y,ku_z)$D3DXVECTOR3ç±»æä¾›äº†å‘é‡ä¸æ ‡é‡ä¹˜æ³•çš„æ“ä½œç¬¦ã€‚12D3DXVECTOR3 u(1.0f, 1.0f, -1.0f);D3DXVECTOR3 scaledVec = u * 10.0f; // = (10.0f, 10.0f, -10.0f) ç‚¹ç§¯ æ•°å­¦ä¸Šå®šä¹‰ç‚¹ç§¯æ˜¯ä¸¤ä¸ªå‘é‡çš„ä¹˜ç§¯ã€‚æŒ‰ä¸‹é¢ç­‰å¼è®¡ç®—ï¼š $u \cdot v = u_{x}v_x+u_{y}v_y+u_{z}v_z = S$ ä¸Šé¢çš„ç­‰å¼ä¸èƒ½å¾ˆæ˜æ˜¾çš„ä½“ç°å‡ ä½•ä¸Šçš„æ„ä¹‰ã€‚åˆ©ç”¨ä½™å¼¦å®šå¾‹ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå‘ç°å®ƒä»¬çš„å…³ç³»ã€‚ u Â· v =|u||v|cosÎ¸ï¼Œè¡¨ç¤ºä¸¤ä¸ªå‘é‡çš„ç‚¹ç§¯æ˜¯å®ƒä»¬çš„æ¨¡å’Œå¤¹è§’çš„ä½™å¼¦ä¹‹ç§¯ã€‚å› æ­¤ï¼Œå¦‚æœuå’Œvéƒ½æ˜¯å•ä½å‘é‡ï¼Œé‚£ä¹ˆuÂ·vå°±æ˜¯å®ƒä»¬å¤¹è§’çš„ä½™å¼¦ã€‚ä¸€äº›ç‚¹ç§¯ä¸­æœ‰ç”¨çš„ç‰¹æ€§ â–  å‡å¦‚u Â· v = 0ï¼Œé‚£ä¹ˆuâŠ¥vã€‚ â–  å‡å¦‚u Â· v &gt; 0ï¼Œé‚£ä¹ˆä¸¤ä¸ªå‘é‡çš„è§’åº¦Î¸å°äº90åº¦ã€‚ â–  å‡å¦‚u Â· v &lt; 0ï¼Œé‚£ä¹ˆä¸¤ä¸ªå‘é‡çš„è§’åº¦Î¸å¤§äº90åº¦ã€‚ æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„D3DXå‡½æ•°è®¡ç®—ä¸¤ä¸ªå‘é‡çš„ç‚¹ç§¯ï¼š123456789FLOAT D3DXVec3Dot( // Returns the result. CONST D3DXVECTOR3* pV1, // Left sided operand. CONST D3DXVECTOR3* pV2 // Right sided operand.);D3DXVECTOR3 u(1.0f, -1.0f, 0.0f);D3DXVECTOR3 v(3.0f, 2.0f, 1.0f);// 1.0*3.0 + -1.0*2.0 + 0.0*1.0// = 3.0 + -2.0float dot = D3DXVec3Dot( &amp;u, &amp;v ); // = 1.0 å‰ç§¯ ç¬¬äºŒç§ä¹˜æ³•åœ¨å‘é‡æ•°å­¦ä¸­å«å‰ç§¯ã€‚ä¸åƒç‚¹ç§¯ï¼Œç»“æœå€¼æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œå‰ç§¯çš„ç»“æœå€¼æ˜¯å¦ä¸€ä¸ªå‘é‡ã€‚é€šè¿‡æŠŠä¸¤ä¸ªå‘é‡uå’Œvç›¸ä¹˜å¾—åˆ°å¦ä¸€çš„å‘é‡pï¼Œå‘é‡på‚ç›´äºuå’Œvã€‚ä¹Ÿå°±æ˜¯è¯´å‘é‡på‚ç›´äºuå¹¶ä¸”å‚ç›´äºuã€‚åå­—ç›¸ä¹˜å°±åƒè¿™æ ·è®¡ç®—ï¼š$p=u \times v=[(u_{y}v_z-u_{z}v_{y}),(u_{z}v_x-u_{x}v_{z}),(u_{x}v_y-u_{y}v_{x})]$$p_x = (u_{y}v_z-u_{z}v_{y})$$p_y = (u_{z}v_x-u_{x}v_{z})$$p_z = (u_{x}v_y-u_{y}v_{x})$ å¦‚ï¼šå‘ç°j = kÃ—i = (0, 0, 1)Ã—(1, 0, 0) å¹¶ä¸”jåŒæ—¶å‚ç›´äºkå’Œi.å› æ­¤ï¼Œj = (0, 1, 0)ã€‚å›å¿†ä¸€ä¸‹ä¸ŠèŠ‚çš„æ ‡é¢˜â€œå‰ç§¯â€ï¼Œæ˜¯è¯´å¦‚æœu Â· v = 0ï¼Œé‚£ä¹ˆuâŠ¥vã€‚åŒæ ·çš„å¦‚æœj Â· k = 0å¹¶ä¸”j Â· i = 0é‚£ä¹ˆæˆ‘ä»¬ä¾¿èƒ½çŸ¥é“jæ—¢å‚ç›´äºkåˆå‚ç›´äºiçš„ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„D3DXå‡½æ•°è®¡ç®—ä¸¤ä¸ªå‘é‡çš„å‰ç§¯ï¼š12345D3DXVECTOR3 *D3DXVec3Cross( D3DXVECTOR3* pOut, // Result. CONST D3DXVECTOR3* pV1, // Left sided operand. CONST D3DXVECTOR3* pV2 // Right sided operand.); ä»ä¸‹å›¾å¾ˆæ˜æ˜¾ï¼Œå‘é‡-pä¸uå’Œvä¹Ÿéƒ½ç›¸äº’å‚ç›´ã€‚æˆ‘ä»¬æ‰§è¡Œå‰ç§¯çš„å‘½ä»¤ï¼Œç¡®å®šå¾—åˆ°çš„çš„ç»“æœä¸ç®¡æ˜¯pæˆ–è€…-pã€‚æ¢å¥è¯è¯´ï¼ŒuÃ—v = -(vÃ—u)ã€‚è¿™è¯´æ˜å‰ç§¯æ˜¯ä¸å¯äº¤æ¢çš„ã€‚ä½ èƒ½é€šè¿‡å·¦æ‰‹æ³•åˆ™ç¡®å®šå‰ç§¯è¿”å›çš„å‘é‡ã€‚æŒ‰ç…§ç¬¬ä¸€ä¸ªå‘é‡æŒ‡å‘ç¬¬äºŒä¸ªå‘é‡å¼¯æ›²ä½ çš„å·¦æ‰‹ï¼Œè¿™æ—¶æ‹‡æŒ‡æ‰€æŒ‡çš„æ–¹å‘å°±æ˜¯å‘é‡æ‰€æŒ‡çš„æ–¹å‘ã€‚ çŸ©é˜µåœ¨è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬å…³æ³¨çš„ç„¦ç‚¹æ˜¯æ•°å­¦ä¸­çš„çŸ©é˜µã€‚å®ƒä»¬åœ¨3Då›¾å½¢å­¦ä¸­çš„åº”ç”¨å°†åœ¨ä¸‹ä¸€éƒ¨åˆ†è®²è§£ã€‚ä¸€ä¸ªmÃ—nçš„çŸ©é˜µæ˜¯ç”±mè¡Œå’Œnåˆ—çš„æ•°å­—ç»„æˆçš„çŸ©é˜µåˆ—ã€‚è¡Œå’Œåˆ—çš„æ•°å­—å°±æ˜¯è¿™ä¸ªçŸ©é˜µçš„ç»´æ•°ã€‚æˆ‘ä»¬é€šè¿‡å†™åœ¨ä¸‹æ–¹çš„æ•°å­—è¯†åˆ«çŸ©é˜µæ¸…å•ï¼Œæ•°å­—ä¸­çš„ç¬¬ä¸€ä¸ªè¡¨ç¤ºè¡Œç¬¬äºŒä¸ªè¡¨ç¤ºåˆ—ã€‚ä¾‹å¦‚ä¸‹è¾¹çš„Mæ˜¯3Ã—3çŸ©é˜µï¼ŒBæ˜¯2Ã—4çŸ©é˜µ, Cæ˜¯3Ã—2çŸ©é˜µã€‚$M=\begin{bmatrix} m_{11} &amp; m_{12} &amp; m_{13} \\ m_{21} &amp; m_{22} &amp; m_{23} \\ m_{31} &amp; m_{32} &amp; m_{33} \\\end{bmatrix}$ $B=\begin{bmatrix} b_{11} &amp; b_{12} &amp; b_{13} b_{14} \\ b_{21} &amp; b_{22} &amp; b_{23} b_{24} \\\end{bmatrix}$ $C=\begin{bmatrix} c_{11} &amp; c_{12} \\ c_{21} &amp; c_{22} \\c_{31} &amp; c_{32} \\\end{bmatrix}$æˆ‘ä»¬ä½¿ç”¨åŠ ç²—çš„å¤§å†™å­—æ¯è¡¨ç¤ºçŸ©é˜µã€‚æœ‰æ—¶ä¸€ä¸ªçŸ©é˜µåªåŒ…å«ä¸€è¡Œæˆ–è€…ä¸€åˆ—ã€‚æˆ‘ä»¬ç”¨è¡ŒçŸ©é˜µå’Œåˆ—çŸ©é˜µè¿™ä¸ªç‰¹æ®Šçš„åç§°æ¥ç§°å‘¼ã€‚ä¾‹å¦‚ä¸‹è¾¹å°±æ˜¯è¡Œå’Œåˆ—çŸ©é˜µï¼š$V = \begin{bmatrix} v_{1} &amp; v_{2} &amp; v_{3} v_{4} \\\end{bmatrix}$ $U = \begin{bmatrix} u_{x} \\ v_{y} \\ v_{z} \\\end{bmatrix}$å½“ä½¿ç”¨è¡Œæˆ–åˆ—çŸ©é˜µæ—¶ï¼Œæˆ‘ä»¬åªç”¨ä¸€ä¸ªä¸‹æ ‡ï¼Œæœ‰æ—¶æˆ‘ä»¬è¿˜ç”¨å­—æ¯è¡¨ç¤ºã€‚ ç›¸ç­‰ã€æ•°ä¹˜çŸ©é˜µä»¥åŠç›¸åŠ è¿™éƒ¨åˆ†æˆ‘ä»¬å°†ç”¨åˆ°ä¸‹è¾¹4ä¸ªçŸ©é˜µï¼š $A = \begin{bmatrix} 1 &amp; 5 &amp; -2 3 \\\end{bmatrix}$ $B = \begin{bmatrix} 6 &amp; 2 &amp; 5 -8 \\\end{bmatrix}$ $C = \begin{bmatrix} 1 &amp; 5 &amp; -2 3 \\\end{bmatrix}$ $D = \begin{bmatrix} 1 &amp; 2 &amp; -1 &amp; 3 \\ -6 &amp; 3 &amp; 0 &amp; 0 \\\end{bmatrix}$ â– å‡å¦‚ä¸¤ä¸ªçŸ©é˜µç»´æ•°å’Œæˆå‘˜éƒ½ç›¸åŒé‚£ä¹ˆå®ƒä»¬å°±ç›¸ç­‰ã€‚ä¾‹å¦‚ï¼ŒA = C å› ä¸ºAå’ŒCæœ‰åŒæ ·çš„ç»´æ•°å¹¶ä¸”ä»–ä»¬çš„æˆå‘˜éƒ½ç›¸ç­‰ã€‚Aâ‰ BåŒæ—¶Aâ‰ Då› ä¸ºä»–ä»¬çš„æˆå‘˜æˆ–è€…ç»´æ•°æ˜¯ä¸ç›¸åŒçš„ã€‚ â– æˆ‘ä»¬èƒ½é€šè¿‡æ ‡é‡ä¸çŸ©é˜µçš„æ¯ä¸ªæˆå‘˜ç›¸ä¹˜å¾—åˆ°æ ‡é‡ä¸çŸ©é˜µç›¸ä¹˜ã€‚å¦‚çŸ©é˜µDä¸kç›¸ä¹˜ï¼š $kD = \begin{bmatrix} k(1) &amp; k(2) &amp; k(-1) &amp; k(3) \\ k(-6) &amp; k(3) &amp; k(0) &amp; k(0) \\\end{bmatrix}$å‡å¦‚k = 2,é‚£ä¹ˆï¼š $kD = 2D = \begin{bmatrix} 2(1) &amp; 2(2) &amp; 2(-1) &amp; 2(3) \\ 2(-6) &amp; 2(3) &amp; 2(0) &amp; 2(0) \\\end{bmatrix} = \begin{bmatrix} 2 &amp; 4 &amp; -2 &amp; 6 \\ -12 &amp; 6 &amp; 0 &amp; 0 \\\end{bmatrix}$ â– å½“ä¸¤ä¸ªçŸ©é˜µçš„ç»´æ•°ç›¸åŒæ—¶æ‰èƒ½æŠŠå®ƒä»¬ç›¸åŠ ã€‚å’Œæ˜¯æŠŠä¸¤ä¸ªçŸ©é˜µç›¸åº”çš„æˆå‘˜ç›¸åŠ å¾—åˆ°ã€‚å¦‚ï¼š $A+B=\begin{bmatrix} 1 &amp; 5 \\ -2 &amp; 2(3) &amp; 2(0) &amp; 2(0) \\\end{bmatrix} + \begin{bmatrix} 2(1) &amp; 2(2) &amp; 2(-1) &amp; 2(3) \\ 2(-6) &amp; 2(3) &amp; 2(0) &amp; 2(0) \\\end{bmatrix}$ â– çŸ©é˜µæœ‰åŠ æ³•å½“ç„¶ä¹Ÿå°±æœ‰å‡æ³•ï¼Œå‰ææ˜¯æœ‰ç›¸åŒçš„ç»´æ•°ã€‚çŸ©é˜µå‡æ³•å¦‚å›¾æ‰€ç¤ºï¼š ä¹˜æ³• çŸ©é˜µç›¸ä¹˜åœ¨3Dè®¡ç®—æœºå›¾å½¢å­¦ä¸­æ˜¯éå¸¸é‡è¦çš„è¿ç®—ã€‚é€šè¿‡çŸ©é˜µç›¸ä¹˜ï¼Œæˆ‘ä»¬èƒ½å˜æ¢å‘é‡å¹¶ä¸”ï¼Œå°†ä¸åŒå‘é‡è½¬æ¢åˆ°ä¸€èµ·ã€‚å˜æ¢æ˜¯ä¸‹ä¸€èŠ‚çš„å†…å®¹ã€‚ ä¸ºäº†å¾—åˆ°çŸ©é˜µä¹‹ç§¯ABï¼ŒAçš„åˆ—æ•°å¿…é¡»ç­‰äºBçš„è¡Œæ•°ã€‚å‡å¦‚è¿™ä¸ªæ¡ä»¶ä¸æ»¡è¶³ï¼Œå°±ä¸èƒ½ç›¸ä¹˜ã€‚è€ƒè™‘ä¸‹è¾¹ä¸¤ä¸ªçŸ©é˜µï¼ŒA å’Œ Bï¼Œåˆ†åˆ«æ˜¯2Ã—3 å’Œ 3Ã—3ï¼Œå¦‚ï¼š æˆ‘ä»¬çœ‹ä¹˜ç§¯ABæ˜¯å¯ä»¥è®¡ç®—çš„ï¼Œå› ä¸ºAçš„åˆ—æ•°ç­‰äºBçš„è¡Œæ•°ã€‚æ³¨æ„ä¹˜ç§¯BA,å®ƒä»¬æ˜¯ä¸èƒ½è®¡ç®—çš„ï¼Œå› ä¸ºBçš„åˆ—æ•°ä¸ç­‰äºAçš„è¡Œæ•°ã€‚ç”±æ­¤è¯´æ˜ï¼šä¸€èˆ¬æƒ…å†µä¸‹çŸ©é˜µä¹˜æ³•ä¸æ»¡è¶³ä¹˜æ³•äº¤æ¢å¾‹ï¼ˆä¹Ÿå°±æ˜¯, ABâ‰ BAï¼‰ã€‚æˆ‘ä»¬è¯´â€œä¸€èˆ¬ä¸å¯äº¤æ¢â€å› ä¸ºæœ‰ä¸€äº›çŸ©é˜µä¹˜æ³•çš„å®ä¾‹è¿˜æ˜¯å¯ä»¥çš„ã€‚ çŸ¥é“äº†çŸ©é˜µä¹˜æ³•çš„è®¡ç®—æ–¹æ³•ï¼Œç°åœ¨æˆ‘ä»¬å°±èƒ½ç»™å‡ºç²¾ç¡®çš„å®šä¹‰ï¼šå‡å¦‚Aæ˜¯ä¸€ä¸ªmÃ—nçš„çŸ©é˜µï¼ŒBæ˜¯ä¸€ä¸ªnÃ—pçš„çŸ©é˜µï¼Œé‚£ä¹ˆå®ƒä»¬ä¹‹ç§¯ABå¯è®¡ç®—å¹¶ä¸”æ˜¯ä¸€ä¸ªmÃ—p çš„çŸ©é˜µC, Cçš„æˆå‘˜ij ç­‰äºAçš„ç¬¬iä¸ªä¸Bçš„ç¬¬jä¸ªç›¸ä¹˜ï¼š ä¾‹å¦‚ï¼Œæ±‚è§£ï¼š æˆ‘ä»¬æ£€æŸ¥çŸ¥é“ä¹˜æ³•æ˜¯å¯è®¡ç®—çš„ï¼Œå› ä¸ºAçš„åˆ—æ•°ç­‰äºBçš„è¡Œæ•°ã€‚ä¹ŸçŸ¥é“è®¡ç®—çš„ç»“æœæ˜¯ä¸€ä¸ª2Ã—2çš„çŸ©é˜µã€‚æ ¹æ®å…¬å¼ï¼ˆ4ï¼‰ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š ä½œä¸ºç»ƒä¹ ï¼Œæ£€æŸ¥ABâ‰ BAã€‚æ›´ä¸€èˆ¬çš„ä¾‹å­ï¼š å•ä½çŸ©é˜µ æœ‰ä¸€ç§ç‰¹æ®ŠçŸ©é˜µå«åšå•ä½çŸ©é˜µã€‚å•ä½çŸ©é˜µæ˜¯é™¤äº†å¯¹è§’ï¼ˆå·¦ä¸Šåˆ°å³ä¸‹ï¼‰ä»¥å¤–æ‰€æœ‰æˆå‘˜éƒ½æ˜¯0ï¼Œå¯¹è§’éƒ½æ˜¯1çš„æ–¹çŸ©é˜µã€‚ä¾‹å¦‚ï¼Œä¸‹è¾¹æ˜¯2Ã—2, 3Ã—3, å’Œ 4Ã—4çš„å•ä½çŸ©é˜µï¼š å•ä½çŸ©é˜µæœ‰å¦‚ä¸‹ç‰¹æ€§ï¼šMI = IM=Må³ï¼Œç”¨å•ä½çŸ©é˜µä¹˜ä»¥çŸ©é˜µä¸ä¼šæ”¹å˜çŸ©é˜µã€‚æ­¤å¤–ï¼Œè¿™æ˜¯ä¸€ä¸ªç‰¹ä¾‹ï¼šç”¨å•ä½çŸ©é˜µè¿›è¡Œä¹˜æ³•è¿ç®—æ»¡è¶³ä¹˜æ³•äº¤æ¢å¾‹ã€‚å•ä½çŸ©é˜µå¯ä»¥çœ‹ä½œçŸ©é˜µè¿ç®—ä¸­çš„æ•°å­—â€œ1â€ã€‚ ä¾‹å¦‚ï¼šéªŒè¯2Ã—2çŸ©é˜µMä¸å•ä½çŸ©é˜µç›¸ä¹˜å¾—åˆ°çš„ç»“æœæ˜¯Mã€‚ é€†è½¬ä¸‹é¢åˆ—ä¸¾äº†å…³äºé€†çŸ©é˜µçš„é‡è¦ä¿¡æ¯ã€‚ åªæœ‰æ­£æ–¹å½¢çš„çŸ©é˜µï¼ˆæ–¹é˜µï¼‰æ‰èƒ½æ±‚é€†ï¼Œå› æ­¤å½“æˆ‘ä»¬è¯´çŸ©é˜µæ±‚é€†ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯æ–¹çŸ©é˜µã€‚ nÃ—nçŸ©é˜µMçš„é€†çŸ©é˜µæ˜¯ä¸€ä¸ªnÃ—nçŸ©é˜µè¡¨ç¤ºä¸ºMâ€“1 ä¸æ˜¯æ¯ä¸ªæ–¹çŸ©é˜µéƒ½æœ‰é€†çŸ©é˜µ çŸ©é˜µå’Œä»–çš„é€†çŸ©é˜µç›¸ä¹˜å¾—åˆ°ä¸€ä¸ªå•ä½çŸ©é˜µï¼šM Mâ€“1 = Mâ€“1M = Iã€‚æ³¨æ„å½“æˆ‘ä»¬è¿›è¡Œè¿™æ ·çš„æ“ä½œæ—¶çŸ©é˜µæ˜¯å¯äº¤æ¢çš„ã€‚ é€†çŸ©é˜µç”¨æ¥è§£å†³ä¸å…¶ä»–çŸ©é˜µç›¸ç­‰æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘ç­‰å¼pâ€™= pR å¹¶ä¸”å‡è®¾æˆ‘ä»¬çŸ¥é“pâ€™å’ŒRæƒ³æ±‚pã€‚é¦–å…ˆæ‰¾åˆ°Râ€“1ï¼Œä¸€æ—¦æ±‚å¾—Râ€“1ï¼Œæˆ‘ä»¬ä¾¿èƒ½æ±‚å‡ºpï¼Œå°±è±¡è¿™æ ·ï¼š æ±‚é€†çŸ©é˜µçš„æ–¹æ³•å·²ç»è¶…å‡ºäº†æœ¬ä¹¦çš„èŒƒå›´ï¼Œä½†æ˜¯è¿™åœ¨ä»»ä½•ä¸€æœ¬çº¿æ€§ä»£æ•°ä¹¦ä¸Šéƒ½æœ‰è®²è§£ã€‚åœ¨â€œåŸºæœ¬å˜æ¢â€ä¸€èŠ‚æˆ‘ä»¬ç»™å‡ºä¸€ä¸ªç‰¹å®šçŸ©é˜µçš„é€†çŸ©é˜µã€‚åœ¨â€œD3DX çŸ©é˜µâ€éƒ¨åˆ†æˆ‘ä»¬å°†å­¦ä¹ ä¸€ä¸ªä¸ºæˆ‘ä»¬æ±‚é€†çŸ©é˜µçš„D3DXå‡½æ•°ã€‚ æˆ‘ä»¬ä»‹ç»å‡ ä¸ªæœ‰ç”¨çš„æ¨è®ºï¼š(AB) â€“1 = Bâ€“1 Aâ€“1ã€‚è¿™ä¸ªæ€§è´¨å‰ææ˜¯ï¼šå‡å®šAå’ŒBéƒ½èƒ½æ±‚é€†å¹¶ä¸”å®ƒä»¬éƒ½æ˜¯æœ‰ç›¸åŒç»´æ•°çš„æ–¹çŸ©é˜µã€‚çŸ©é˜µçš„è½¬ç½® çŸ©é˜µçš„è½¬ç½®æ˜¯ç›¸äº’äº¤æ¢çŸ©é˜µçš„è¡Œå’Œåˆ—ã€‚å› è€Œï¼ŒmÃ—nçš„çŸ©é˜µçš„è½¬ç½®æ˜¯ä¸€ä¸ªnÃ—mçš„çŸ©é˜µã€‚æˆ‘ä»¬æŠŠçŸ©é˜µMçš„è½¬ç½®è®°ä½œMTã€‚ä¾‹å¦‚ï¼šæ±‚ä¸‹é¢ä¸¤ä¸ªçŸ©é˜µçš„è½¬ç½®ï¼š é‡å£°ä¸€ä¸‹ï¼Œè½¬ç½®æ˜¯äº¤æ¢çŸ©é˜µçš„è¡Œå’Œåˆ—ã€‚å› æ­¤ï¼š D3DX çŸ©é˜µ å½“è®¾è®¡Direct3Dåº”ç”¨ç¨‹åºæ—¶ï¼Œä½¿ç”¨4Ã—4çŸ©é˜µå’Œ1Ã—4è¡ŒçŸ©é˜µï¼ˆå‘é‡ï¼‰æ˜¯æœ‰ä»£è¡¨æ€§çš„ã€‚æ³¨æ„ä½¿ç”¨è¿™ä¸¤ç§çŸ©é˜µæ„å‘³ç€å¯ä»¥è¿›è¡Œä¸‹åˆ—å®šä¹‰çš„çŸ©é˜µä¹˜æ³•ã€‚ å‘é‡-çŸ©é˜µä¹˜æ³•ã€‚å³ï¼Œå‡å¦‚1Ã—4çš„å•è¡ŒçŸ©é˜µVï¼Œå’Œ4Ã—4çš„çŸ©é˜µTï¼Œé‚£ä¹ˆç§¯VTå¯è®¡ç®—å¹¶ä¸”è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ª1Ã—4çš„å•è¡ŒçŸ©é˜µï¼ˆå‘é‡ï¼‰ã€‚ çŸ©é˜µ-çŸ©é˜µä¹˜æ³•ã€‚å³ï¼Œå‡å¦‚4Ã—4çš„çŸ©é˜µTï¼Œå’Œ4Ã—4çš„çŸ©é˜µRï¼Œé‚£ä¹ˆç§¯TRå’ŒRTå¯è®¡ç®—å¹¶ä¸”ä¸¤è€…è¿”å›çš„ç»“æœéƒ½æ˜¯ä¸€ä¸ª4Ã—4çš„çŸ©é˜µã€‚æ³¨æ„å› ä¸ºçŸ©é˜µä¹˜æ³•ä¸æ»¡è¶³äº¤æ¢å¾‹æ‰€ä»¥TRå’ŒRTä¸ä¸€å®šç›¸ç­‰ã€‚ åœ¨D3DXä¸­è¡¨ç¤º1Ã—4çš„è¡ŒçŸ©é˜µï¼ˆå‘é‡ï¼‰ï¼Œæˆ‘ä»¬ç”¨D3DXVECTOR3å’ŒD3DXVECTOR4å‘é‡ç±»ã€‚å½“ç„¶D3DXVECTOR3åªæœ‰3ä¸ªæˆå‘˜ï¼Œä¸æ˜¯4ä¸ªã€‚ç„¶è€Œï¼Œç¬¬4ä¸ªæˆå‘˜ç¼ºçœæ˜¯1æˆ–0ï¼ˆåœ¨ä¸‹ä¸€éƒ¨åˆ†æœ‰æ›´å¤šä¿¡æ¯ï¼‰ã€‚ åœ¨D3DXä¸­è¡¨ç¤º4Ã—4çš„çŸ©é˜µï¼Œæˆ‘ä»¬ç”¨D3DXMATRIXç±»ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334typedef struct D3DXMATRIX : public D3DMATRIX &#123;public: D3DXMATRIX() &#123;&#125;; D3DXMATRIX( CONST FLOAT * ); D3DXMATRIX( CONST D3DMATRIX&amp; ); D3DXMATRIX( FLOAT _11, FLOAT _12, FLOAT _13, FLOAT _14, FLOAT _21, FLOAT _22, FLOAT _23, FLOAT _24, FLOAT _31, FLOAT _32, FLOAT _33, FLOAT _34, FLOAT _41, FLOAT _42, FLOAT _43, FLOAT _44 ); // access grants FLOAT&amp; operator () ( UINT Row, UINT Col ); FLOAT operator () ( UINT Row, UINT Col ) const; // casting operators operator FLOAT* (); operator CONST FLOAT* () const; // assignment operators D3DXMATRIX&amp; operator *= ( CONST D3DXMATRIX&amp; ); D3DXMATRIX&amp; operator += ( CONST D3DXMATRIX&amp; ); D3DXMATRIX&amp; operator -= ( CONST D3DXMATRIX&amp; ); D3DXMATRIX&amp; operator *= ( FLOAT ); D3DXMATRIX&amp; operator /= ( FLOAT ); // unary operators D3DXMATRIX operator + () const; D3DXMATRIX operator - () const; // binary operators D3DXMATRIX operator * ( CONST D3DXMATRIX&amp; ) const; D3DXMATRIX operator + ( CONST D3DXMATRIX&amp; ) const; D3DXMATRIX operator - ( CONST D3DXMATRIX&amp; ) const; D3DXMATRIX operator * ( FLOAT ) const; D3DXMATRIX operator / ( FLOAT ) const; friend D3DXMATRIX operator * ( FLOAT, CONST D3DXMATRIX&amp; ); BOOL operator == ( CONST D3DXMATRIX&amp; ) const; BOOL operator != ( CONST D3DXMATRIX&amp; ) const;&#125; D3DXMATRIX, *LPD3DXMATRIX; D3DXMATRIXç±»æ˜¯ä»å•æ•°ç»“æ„D3DMATRIXç»§æ‰¿çš„å¤æ•°å½¢å¼ã€‚D3DMATRIXçš„å®šä¹‰æ˜¯ï¼š1234567891011typedef struct _D3DMATRIX &#123; union &#123; struct &#123; float _11, _12, _13, _14; float _21, _22, _23, _24; float _31, _32, _33, _34; float _41, _42, _43, _44; &#125;; float m[4][4]; &#125;;&#125; D3DMATRIX; è§‚å¯ŸD3DXMATRIXç±»å‘ç°æœ‰å¾ˆå¤šæœ‰ç”¨çš„è¿ç®—ç¬¦ï¼Œæ¯”å¦‚å¯¹çŸ©é˜µæ£€æµ‹ç›¸ç­‰ï¼ŒçŸ©é˜µç›¸åŠ å’ŒçŸ©é˜µç›¸å‡ï¼Œæ ‡é‡ä¸çŸ©é˜µç›¸ä¹˜ï¼Œé“¸é€ ï¼ˆcastingï¼‰ï¼Œä»¥åŠéå¸¸é‡è¦çš„ä¸¤ä¸ªD3DXMATRIXsç›¸ä¹˜ã€‚å› ä¸ºçŸ©é˜µç›¸ä¹˜æ˜¯éå¸¸é‡è¦çš„ï¼Œæˆ‘ä»¬ç»™å‡ºä¸€æ®µå®ä¾‹ä»£ç ï¼š123D3DXMATRIX A(â€¦); // initialize AD3DXMATRIX B(â€¦); // initialize BD3DXMATRIX C = A * B; // C = AB D3DXMATRIXç±»å¦ä¸€ä¸ªé‡è¦çš„è¿ç®—ç¬¦æ˜¯å°æ‹¬å·ï¼Œå®ƒå…è®¸æˆ‘ä»¬éå¸¸æ–¹ä¾¿çš„ä¸ºçŸ©é˜µæˆå‘˜èµ‹å€¼ã€‚æ³¨æ„å½“ä½¿ç”¨å°æ‹¬å·æ—¶æˆ‘ä»¬çš„ä¸‹æ ‡å°±è±¡Cè¯­è¨€æ•°ç»„ä¸‹æ ‡ä¸€æ ·æ˜¯ä»0å¼€å§‹çš„ã€‚ä¾‹å¦‚ï¼Œä¸ºä¸€ä¸ªçŸ©é˜µçš„ij = 11 èµ‹å€¼ï¼Œæˆ‘ä»¬å†™æˆï¼š12D3DXMATRIX M;M(0, 0) = 5.0f; // Set entry ij = 11 to 5.0f. D3DXåº“ä¹Ÿæä¾›ä¸‹åˆ—æœ‰ç”¨çš„å‡½æ•°ï¼šå°†D3DXMATRIXè½¬åŒ–ä¸ºå•ä½çŸ©é˜µï¼Œè½¬ç½®D3DXMATRIXçŸ©é˜µä»¥åŠæ±‚é€†çŸ©é˜µã€‚1234567891011121314D3DXMATRIX *D3DXMatrixIdentity( D3DXMATRIX *pout // å°†çŸ©é˜µè½¬æ¢ä¸ºå•ä½çŸ©é˜µ);D3DXMATRIX M;D3DXMatrixIdentity( &amp;M ); // M = å•ä½çŸ©é˜µD3DXMATRIX *D3DXMatrixTranspose( D3DXMATRIX *pOut, // è¾“å‡ºçš„è½¬ç½®çŸ©é˜µ CONST D3DXMATRIX *pM // åŸçŸ©é˜µ);D3DXMATRIX A(...); // åˆå§‹åŒ–çŸ©é˜µAD3DXMATRIX B;D3DXMatrixTranspose( &amp;B, &amp;A ); // B = è¾“å‡ºçš„è½¬ç½®çŸ©é˜µ å‡å¦‚æˆ‘ä»¬å°†ä¸èƒ½æ±‚é€†çš„çŸ©é˜µç”¨æ±‚é€†å‡½æ•°ï¼Œé‚£ä¹ˆå‡½æ•°å°†ä¼šè¿”å›null.åŒæ ·çš„ï¼Œè¿™æœ¬ä¹¦æˆ‘ä»¬å¿½è§†ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¹¶ä¸”æ€»æ˜¯æŠŠå®ƒè®¾ç½®ä¸º0ã€‚12345678D3DXMATRIX *D3DXMatrixInverse( D3DXMATRIX *pOut, // è¾“å‡ºçš„é€†çŸ©é˜µ FLOAT *pDeterminant, // é™¤éæ˜¯å¿…éœ€çš„ï¼Œä¸€èˆ¬è®¾ä¸º0 CONST D3DXMATRIX *pM // åŸçŸ©é˜µ);D3DXMATRIX A(...); // åˆå§‹åŒ–çŸ©é˜µD3DXMATRIX B;D3DXMatrixInverse( &amp;B, 0, &amp;A ); // B = Açš„é€†çŸ©é˜µ åŸºæœ¬å˜æ¢ å½“ç”¨Direct3Dç¼–ç¨‹æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨4Ã—4çŸ©é˜µæ¥è¿›è¡ŒçŸ©é˜µå˜æ¢ã€‚ç”¨å®ƒçš„åŸå› æ˜¯ï¼šæˆ‘ä»¬è®¾ç½®ä¸€ä¸ª4Ã—4çŸ©é˜µXæ˜¯ä¸ºäº†æ›´ç²¾ç¡®çš„æè¿°çŸ©é˜µå˜æ¢ã€‚åŒæ ·æˆ‘ä»¬è®¾ç½®ä¸€ä¸ªç›¸åŒ¹é…çš„ç‚¹æˆ–è€…æŠŠå‘é‡çš„åˆ†é‡æ”¾ç½®åˆ°ä¸€ä¸ª1Ã—4çš„è¡ŒçŸ©é˜µVä¸­ã€‚VXçš„ä¹˜ç§¯è¿”å›ä¸€ä¸ªæ–°çš„å‘é‡Vâ€™ã€‚ä¾‹å¦‚ï¼šè®©Xæ²¿ç€xè½´å¹³ç§»10ä¸ªå•ä½åŒæ—¶V = [2, 6, â€“3, 1]ï¼Œä¹˜ç§¯VX = Vâ€™= [12, 6, â€“3, 1]ã€‚ æœ‰ä¸€äº›ä¸œè¥¿éœ€è¦é˜æ˜ã€‚æˆ‘ä»¬ä½¿ç”¨4Ã—4çŸ©é˜µæ˜¯å› ä¸ºè¿™æ ·çš„å¤§å°èƒ½è¡¨ç°æˆ‘ä»¬éœ€è¦çš„æ‰€æœ‰å˜æ¢ã€‚æœ€åˆçœ‹æ¥ä¸€ä¸ª3Ã—3çš„å¥½è±¡æ›´é€‚åˆ3Dã€‚ç„¶è€Œè¿™é‡Œæœ‰å¾ˆå¤šç§æˆ‘ä»¬å–œæ¬¢ç”¨çš„å˜æ¢æ˜¯ä¸èƒ½ç”¨ä¸€ä¸ª3Ã—3çš„çŸ©é˜µæ¥è¡¨ç¤ºçš„ï¼Œæ¯”å¦‚å¹³ç§»ã€æŠ•å½±ã€åå°„ã€‚æˆ‘ä»¬ä½¿ç”¨å‘é‡-çŸ©é˜µç›¸ä¹˜æ¥å·¥ä½œï¼Œå› æ­¤æˆ‘ä»¬è‡³å°‘è¦é€šè¿‡ä¸€ä¸ªçŸ©é˜µä¹˜æ³•æ¥å®Œæˆç›¸åº”çš„å˜åŒ–ã€‚å¢å¤§åˆ°4Ã—4çš„çŸ©é˜µåï¼Œå®ƒå…è®¸æˆ‘ä»¬ç”¨ä¸€ä¸ªçŸ©é˜µæè¿°æ›´å¤šçš„å˜æ¢ï¼Œå¹¶ä¸”å‘é‡-çŸ©é˜µä¹˜æ³•æ˜¯å¯è¡Œçš„ã€‚ æˆ‘ä»¬è¯´è¿‡æŠŠä¸€ä¸ªç›¸åŒ¹é…çš„ç‚¹æˆ–è€…ä¸€ä¸ªå‘é‡çš„æˆå‘˜æ”¾ç½®åˆ°ä¸€ä¸ª1Ã—4çš„è¡ŒçŸ©é˜µä¸­ã€‚ä½†æ˜¯ç‚¹å’Œå‘é‡æ˜¯3Dçš„ï¼ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç”¨ä¸€ä¸ª1Ã—4çš„è¡ŒçŸ©é˜µå‘¢ï¼Ÿæˆ‘ä»¬å¿…éœ€æŠŠ3Dç‚¹/å‘é‡å¢å¤§ä¸º4Dçš„å•è¡ŒçŸ©é˜µï¼Œæ˜¯ä¸ºäº†ç¬¦åˆå‘é‡ä¸çŸ©é˜µçš„ä¹˜æ³•å®šä¹‰ï¼Œè€Œ1Ã—3çš„å•è¡ŒçŸ©é˜µå’Œ4Ã—4çš„çŸ©é˜µç›¸ä¹˜æ˜¯ä¸å…è®¸çš„ã€‚ é‚£ä¹ˆï¼Œæˆ‘ä»¬æ€ä¹ˆä½¿ç”¨ç¬¬å››ä¸ªæˆå‘˜ï¼ˆæˆ‘ä»¬ç”¨wæ¥è¡¨ç¤ºï¼‰å‘¢ï¼Ÿå½“æˆ‘ä»¬æŠŠä¸€ä¸ªç‚¹æ”¾ç½®åˆ°ä¸€ä¸ª1Ã—4çš„è¡ŒçŸ©é˜µä¸­æ—¶ï¼Œæˆ‘ä»¬è®¾ç½®wä¸º1ã€‚å…è®¸å¯¹ç‚¹è¿›è¡Œé€‚å½“çš„å¹³ç§»ã€‚å› ä¸ºå‘é‡å’Œä½ç½®æ— å…³ï¼Œæ‰€ä»¥å‘é‡çš„å¹³ç§»æ²¡æœ‰è¢«å®šä¹‰ï¼Œå¦‚æœè¯•å›¾è¿™æ ·åšä¼šè¿”å›ä¸€ä¸ªæ— æ„ä¹‰çš„å‘é‡ã€‚ä¸ºäº†é˜²æ­¢å¯¹å‘é‡è¿›è¡Œå¹³ç§»ï¼Œå½“åœ¨æŠŠä¸€ä¸ªå‘é‡æ”¾ç½®åˆ°ä¸€ä¸ª1Ã—4è¡ŒçŸ©é˜µä¸­æ—¶æˆ‘ä»¬æŠŠwè®¾ç½®ä¸º0ã€‚ä¾‹å¦‚ï¼šæŠŠç‚¹p = (p1, p2, p3)æ”¾ç½®åˆ°ä¸€ä¸ªå•è¡ŒçŸ©é˜µä¸­å°±è±¡è¿™æ ·ï¼š[p1, p2, p3, 1]ï¼ŒåŒæ ·æŠŠå‘é‡v = (v1, v2, v3) æ”¾ç½®åˆ°ä¸€ä¸ªå•è¡ŒçŸ©é˜µä¸­å°±è±¡è¿™æ ·ï¼š[v1, v2, v3, 0]ã€‚ æ³¨æ„ï¼šæˆ‘ä»¬è®¾ç½®w = 1æ˜¯ä¸ºäº†è®©ç‚¹å¯ä»¥è¢«æ°å½“çš„ç§»åŠ¨ï¼ŒåŒæ ·æˆ‘ä»¬è®¾ç½®w = 0æ˜¯ä¸ºäº†é˜²æ­¢å‘é‡è¢«å¹³ç§»ã€‚å½“æˆ‘ä»¬æ£€æŸ¥çŸ©é˜µå®é™…å¹³ç§»æ—¶è¿™æ˜¯ä¸€ä¸ªéå¸¸æ¸…æ™°çš„æ¨¡å‹ã€‚ æœ‰æ—¶ä¸€ä¸ªçŸ©é˜µå˜æ¢æ—¶æˆ‘ä»¬æ”¹å˜å‘é‡æˆå‘˜wçš„å€¼ï¼Œå³wâ‰ 0 ä¸” wâ‰ 1ã€‚è€ƒè™‘ä¸‹è¾¹ä¾‹å­ï¼š $p = \begin{bmatrix} p_1 &amp; p_2 &amp; p_3 &amp; 1 \\\end{bmatrix} \begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 1 \\ 0 &amp; 0 &amp; 0 &amp; 0 \\\end{bmatrix} = \begin{bmatrix} p_1, p_2, p_3, p_3 \\\end{bmatrix} = p`$ å› ä¸ºp3â‰ 0 ä¸” p3â‰ 1ã€‚ æˆ‘ä»¬æ³¨æ„w =p3ã€‚å½“wâ‰ 0 ä¸” wâ‰ 1æ—¶ï¼Œæˆ‘ä»¬è¯´æˆ‘ä»¬æœ‰ä¸€ä¸ªå‘é‡åœ¨åŒç±»ç©ºé—´ä¸­ï¼Œä¸3ç»´ç©ºé—´ä¸­çš„å‘é‡æ˜¯ç›¸å¯¹çš„ã€‚æˆ‘ä»¬èƒ½é€šè¿‡æŠŠå‘é‡çš„æ¯ä¸ªåˆ†é‡ä¸wç›¸é™¤å°†åŒç±»ç©ºé—´ä¸­çš„å‘é‡æ˜ å°„åˆ°3ç»´ç©ºé—´ä¸­æ¥ã€‚ä¾‹å¦‚æŠŠåŒç±»ç©ºé—´ä¸­å‘é‡(x, y, z, w) æ˜ å°„åˆ°3ç»´ç©ºé—´ä¸­çš„å‘é‡xï¼Œæˆ‘ä»¬è¿™æ ·åšï¼š ${x \over w}, {y \over w}, {z \over w}, {w \over w}$ åœ¨3Då›¾å½¢ç¨‹åºè®¾è®¡ä¸­ï¼Œä»é½æ¬¡åæ ‡ç©ºé—´æ˜ å°„åˆ°3Dç©ºé—´æ—¶ä½¿ç”¨æŠ•å½±é€è§†ã€‚çŸ©é˜µå¹³ç§» å›¾8 æˆ‘ä»¬èƒ½é€šè¿‡ä¸ä¸‹é¢çš„çŸ©é˜µç›¸ä¹˜æŠŠå‘é‡(x, y, z, 1)æ²¿xè½´ç§»åŠ¨pxä¸ªå•ä½ï¼Œæ²¿yè½´ç§»åŠ¨py ä¸ªå•ä½ï¼Œæ²¿zè½´ç§»åŠ¨pzä¸ªå•ä½ï¼š å°†çŸ©é˜µå¹³ç§»çš„D3DXå‡½æ•°æ˜¯ï¼šD3DXMATRIX D3DXMatrixTranslation( D3DXMATRIX pOut, // è¿”å›å¹³ç§»åçš„çŸ©é˜µ. FLOAT x, // xè½´ç§»åŠ¨çš„å•ä½ FLOAT y, // yè½´ç§»åŠ¨çš„å•ä½ FLOAT z // zè½´ç§»åŠ¨çš„å•ä½); ç»ƒä¹ ï¼šè®©T(p)åšä¸ºä¸€ä¸ªå¹³ç§»å˜æ¢çŸ©é˜µï¼Œv = [v1, v2, v3, 0]æ˜¯ä¹Ÿä¸ªä»»æ„å‘é‡ã€‚éªŒè¯vT(p) = vï¼ˆå³ï¼Œå‡å¦‚w = 0ï¼ŒéªŒè¯é€šè¿‡å¹³ç§»ä¸ä¼šæ”¹å˜å‘é‡ï¼‰ã€‚ å¹³ç§»çŸ©é˜µæ±‚é€†åªéœ€è¦ç®€å•çš„å°†å‘é‡på–åå³å¯ï¼š çŸ©é˜µæ—‹è½¬å›¾9 æˆ‘ä»¬èƒ½ç”¨ä¸‹é¢çš„çŸ©é˜µæŠŠä¸€ä¸ªå‘é‡å›´ç»•x,y å’Œzè½´æ—‹è½¬Î´å¼§åº¦ã€‚æ³¨æ„ï¼šå½“æˆ‘ä»¬ä¿¯è§†ç»•è½´åŸç‚¹æ—¶ï¼Œè§’åº¦æ˜¯æŒ‡é¡ºæ—¶é’ˆæ–¹å‘çš„è§’åº¦ã€‚ å°†çŸ©é˜µé¥¶ç€xè½´æ—‹è½¬çš„D3DXå‡½æ•°æ˜¯ï¼šD3DXMATRIX D3DXMatrixRotationX( D3DXMATRIX pOut, // è¿”å›æ—‹è½¬åçš„çŸ©é˜µ FLOAT Angle // Angleæ˜¯æ—‹è½¬çš„å¼§åº¦); å°†çŸ©é˜µé¥¶ç€yè½´æ—‹è½¬çš„D3DXå‡½æ•°æ˜¯ï¼š1234D3DXMATRIX *D3DXMatrixRotationY( D3DXMATRIX* pOut, // è¿”å›æ—‹è½¬åçš„çŸ©é˜µ FLOAT Angle // Angleæ˜¯æ—‹è½¬çš„å¼§åº¦); å°†çŸ©é˜µé¥¶ç€zè½´æ—‹è½¬çš„D3DXå‡½æ•°æ˜¯ï¼š1234D3DXMATRIX *D3DXMatrixRotationZ( D3DXMATRIX* pOut, // è¿”å›æ—‹è½¬åçš„çŸ©é˜µ FLOAT Angle // Angleæ˜¯æ—‹è½¬çš„å¼§åº¦); æ—‹è½¬çŸ©é˜µRçš„é€†çŸ©é˜µç­‰äºå®ƒçš„è½¬ç½®çŸ©é˜µï¼šRT= R-1ã€‚è¿™æ ·çš„çŸ©é˜µæˆ‘ä»¬è¯´å®ƒä»¬æ˜¯äº’ç›¸å‚ç›´çš„ã€‚çŸ©é˜µç¼©æ”¾å›¾10 æˆ‘ä»¬èƒ½é€šè¿‡ä¸ä¸‹é¢çš„çŸ©é˜µç›¸ä¹˜æŠŠå‘é‡æ²¿xè½´ç¼©æ”¾qxä¸ªå•ä½ï¼Œæ²¿yè½´ç¼©æ”¾qy ä¸ªå•ä½ï¼Œæ²¿zè½´ç¼©æ”¾qzä¸ªå•ä½ï¼š $S(q) = \begin{bmartix}q_x &amp; 0 &amp; 0 &amp; 0 \\ 0 q_y &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; q_z 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 \\\end{bmartix}$å°†çŸ©é˜µç¼©æ”¾çš„D3DXå‡½æ•°æ˜¯ï¼šD3DXMATRIX D3DXMatrixScaling( D3DXMATRIX pOut, // è¿”å›ç¼©æ”¾åçš„çŸ©é˜µ FLOAT sx, // xè½´ç¼©æ”¾çš„æ¯”ä¾‹ FLOAT sy, // yè½´ç¼©æ”¾çš„æ¯”ä¾‹ FLOAT sz // zè½´ç¼©æ”¾çš„æ¯”ä¾‹.); ç¼©æ”¾çŸ©é˜µæ±‚é€†åªéœ€è¦å°†æ¯ä¸ªç¼©æ”¾å› å­å–å€’å³å¯ï¼š ç»¼åˆå˜æ¢ å¸¸å¸¸æˆ‘ä»¬è¦å¯¹ä¸€ä¸ªå‘é‡è¿›è¡Œä¸€ç³»åˆ—çš„å˜æ¢ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½å…ˆç¼©æ”¾ä¸€ä¸ªå‘é‡ï¼Œç„¶åæ—‹è½¬å®ƒï¼Œæœ€åæŠŠå®ƒå¹³ç§»åˆ°æŒ‡å®šçš„ä½ç½®ã€‚ ä¾‹å¦‚ï¼šå…ˆæŠŠå‘é‡p = [5, 0, 0, 1] åœ¨æ‰€æœ‰è½´ä¸Šç¼©å°ä¸ºåŸæ¥çš„1/5ï¼Œç„¶åæ²¿ç€yè½´æ—‹è½¬Ï€/4ï¼Œæœ€åæŠŠå®ƒåœ¨xè½´ä¸Šç§»åŠ¨1ä¸ªå•ä½ï¼Œåœ¨yè½´ä¸Šç§»åŠ¨2ä¸ªå•ä½ï¼Œåœ¨zè½´ä¸Šç§»åŠ¨3ä¸ªå•ä½ã€‚ è§£ç­”ï¼šæ³¨æ„æˆ‘ä»¬å¿…é¡»å®Œæˆç¼©æ”¾ï¼Œæ²¿yè½´æ—‹è½¬ï¼Œä»¥åŠç§»åŠ¨ã€‚æˆ‘ä»¬è®¾ç¼©æ”¾ã€æ—‹è½¬ã€ç§»åŠ¨çš„å˜æ¢çŸ©é˜µåˆ†åˆ«æ˜¯S, Ry, Tï¼Œå¦‚ä¸‹ï¼š åº”ç”¨ç¼©æ”¾ï¼Œæ—‹è½¬ï¼Œä»¥åŠå¹³ç§»ä¸€ç³»åˆ—å˜æ¢ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š æˆ‘ä»¬èƒ½ç”¨çŸ©é˜µä¹˜æ³•æŠŠå‡ ä¸ªå˜æ¢çŸ©é˜µè½¬æ¢æˆä¸€ä¸ªçŸ©é˜µï¼Œå®ƒæ˜¯éå¸¸æœ‰ç›Šçš„çŸ©é˜µã€‚æ¯”å¦‚ï¼Œé‡æ–°è€ƒè™‘è¿™éƒ¨åˆ†å¼€å§‹çš„ä¾‹å­ã€‚é€šè¿‡ä½¿ç”¨çŸ©é˜µç›¸ä¹˜æŠŠ3ä¸ªå˜æ¢çŸ©é˜µåˆæˆä¸€ä¸ªçŸ©é˜µã€‚æ³¨æ„æˆ‘ä»¬å¿…é¡»æŒ‰å®é™…åº”ç”¨çš„é¡ºåºæ¥è¿›è¡ŒçŸ©é˜µç›¸ä¹˜ã€‚ é‚£ä¹ˆ pQ = [1.707, 2, â€“3.707, 1]ã€‚ è”åˆå˜æ¢æœ‰æé«˜æ•ˆç‡çš„èƒ½åŠ›ã€‚å‡å¦‚æˆ‘ä»¬éœ€è¦å¯¹ä¸€ç»„æ•°é‡å·¨å¤§çš„å‘é‡ï¼ˆåœ¨3Då›¾å½¢ä»»åŠ¡ä¸­æ˜¯å¾ˆæ™®éçš„ï¼‰è¿›è¡ŒåŒæ ·çš„ç¼©æ”¾ï¼Œæ—‹è½¬ä»¥åŠç§»åŠ¨å˜æ¢ã€‚æ›¿æ¢è¿™ä¸€ç³»åˆ—çš„å˜æ¢ï¼Œå³å°±è±¡ç­‰å¼(5)ä¸­å¯¹æ¯ä¸€ä¸ªå‘é‡çš„åšæ³•ï¼Œæˆ‘ä»¬èƒ½æŠŠæ‰€æœ‰3ä¸ªå˜æ¢è½¬æ¢åˆ°ä¸€ä¸ªçŸ©é˜µä¸­ï¼Œå³å°±è±¡åœ¨ç­‰å¼(6)ä¸­çš„åšæ³•ã€‚è¿™æ ·æˆ‘ä»¬åªéœ€è¦å¯¹æ¯ä¸€ä¸ªå‘é‡è¿›è¡Œä¸€æ¬¡ä¹˜æ³•å°±å¯ä»¥å®ç°3ç§å˜æ¢ã€‚è¿™å°±å‡å°‘äº†å¤§é‡çš„å‘é‡-çŸ©é˜µä¹˜æ³•æ“ä½œã€‚ä¸€äº›å‘é‡å˜æ¢å‡½æ•° D3DXåº“åˆ†åˆ«æä¾›äº†ä¸‹è¾¹ä¸¤ä¸ªå¯¹ç‚¹å’Œå‘é‡çš„å˜æ¢å‡½æ•°ã€‚D3DXVec3TransformCoordå‡½æ•°å˜æ¢ç‚¹åŒæ—¶è®¾ç½®å‘é‡ç¬¬4ä¸ªæˆå‘˜ä¸º1ï¼ˆç”¨äºå˜æ¢ç‚¹å‘é‡ï¼‰ã€‚D3DXVec3TransformNormalå‡½æ•°å˜æ¢å‘é‡å¹¶ä¸”è®¾ç½®ç¬¬4ä¸ªæˆå‘˜ä¸º0ï¼ˆç”¨äºå˜æ¢æ–¹å‘å‘é‡ï¼‰ã€‚D3DXVECTOR3 D3DXVec3TransformCoord( D3DXVECTOR3 pOut, // è¿”å›çš„ç‚¹å‘é‡ CONST D3DXVECTOR3 pV, // ç‚¹å‘é‡ CONST D3DXMATRIX pM // å˜æ¢çŸ©é˜µ );D3DXMATRIX T(â€¦); // åˆå§‹åŒ–çŸ©é˜µD3DXVECTOR3 p(â€¦); // åˆå§‹åŒ–ç‚¹D3DXVec3TransformCoord( &amp;p, &amp;p, &amp;T); // å˜æ¢ä¸€ä¸ªç‚¹ D3DXVECTOR3 WINAPI D3DXVec3TransformNormal( D3DXVECTOR3 pOut, //è¿”å›çš„æ–¹å‘å‘é‡ CONST D3DXVECTOR3 pV, // æ–¹å‘å‘é‡ CONST D3DXMATRIX pM //å˜æ¢çŸ©é˜µ);D3DXMATRIX T(â€¦); // åˆå§‹åŒ–å˜æ¢çŸ©é˜µD3DXVECTOR3 v(â€¦); // åˆå§‹åŒ–æ–¹å‘å‘é‡D3DXVec3TransformNormal( &amp;v, &amp;v, &amp;T); // å˜æ¢æ–¹å‘å‘é‡æ³¨æ„ï¼šD3DXåº“ä¹Ÿæä¾›D3DXVec3TransformCoordArrayå’ŒD3DXVec3TransformNormalArrayæ¥åˆ†åˆ«å˜æ¢ä¸€ä¸ªç‚¹æ•°ç»„å’Œå‘é‡æ•°ç»„å¹³é¢ ä¸€ä¸ªå¹³é¢èƒ½é€šè¿‡ä¸€ä¸ªå‘é‡nå’Œå¹³é¢ä¸Šçš„ä¸€ä¸ªç‚¹p0æ¥æè¿°ã€‚è¿™ä¸ªå‘é‡nå‚ç›´äºå¹³é¢ï¼Œå®ƒè¢«ç§°ä¸ºæ­¤å¹³é¢çš„æ³•å‘é‡ï¼ˆå¦‚å›¾11ï¼‰ã€‚ å›¾11 åœ¨å›¾12ä¸­æˆ‘ä»¬èƒ½å¤Ÿå‘ç°å¹³é¢ä¸Šä»»æ„ä¸€ç‚¹péƒ½æ»¡è¶³å¦‚ä¸‹ç­‰å¼ã€‚å³ï¼šå‡å¦‚pã€p0éƒ½æ˜¯å¹³é¢ä¸Šä¸€ç‚¹ï¼Œé‚£ä¹ˆå‘é‡ï¼ˆp - p0ï¼‰å‚ç›´äºå¹³é¢çš„æ³•å‘é‡ã€‚ å›¾12 å½“æˆ‘ä»¬é€šè¿‡æ³•å‘é‡nå’Œå¹³é¢ä¸Šä¸€ä¸ªå·²çŸ¥ç‚¹æ¥æè¿°ä¸€ä¸ªå¹³é¢æ—¶ï¼Œç­‰å¼ï¼ˆ7ï¼‰åˆè¢«å†™æˆè¿™æ ·ï¼š è¿™æ—¶d = â€“nÂ·p0ã€‚ D3DXå¹³é¢åœ¨ä»£ç ä¸­æè¿°ä¸€ä¸ªå¹³é¢ï¼šä»…ä»…éœ€è¦ä¸€ä¸ªæ³•å‘é‡nå’Œå¸¸æ•°då°±å¯ä»¥äº†ã€‚å› æ­¤æˆ‘ä»¬å°±ä½¿ç”¨ä¸€ä¸ª4Då‘é‡ï¼ˆæˆ‘ä»¬è®°å½•æˆ(n, d)ï¼‰æ¥å®ç°å®ƒã€‚D3DXåº“ä¸­ç”¨å¦‚ä¸‹çš„ç»“æ„æ¥å®šä¹‰ä¸€ä¸ªå¹³é¢ï¼š1234567891011121314151617181920typedef struct D3DXPLANE&#123;#ifdef __cpluspluspublic: D3DXPLANE() &#123;&#125; D3DXPLANE( CONST FLOAT* ); D3DXPLANE( CONST D3DXFLOAT16* ); D3DXPLANE( FLOAT a, FLOAT b, FLOAT c, FLOAT d ); // casting operator FLOAT* (); operator CONST FLOAT* () const; // unary operators D3DXPLANE operator + () const; D3DXPLANE operator - () const; // binary operators BOOL operator == ( CONST D3DXPLANE&amp; ) const; BOOL operator != ( CONST D3DXPLANE&amp; ) const;#endif //__cplusplus FLOAT a, b, c, d;&#125; D3DXPLANE, *LPD3DXPLANE; å¯¹ç…§ç­‰å¼ï¼ˆ8ï¼‰å¯çŸ¥ï¼šè¿™é‡Œa, bå’Œcæ˜¯å¹³é¢æ³•å‘é‡nçš„æˆå‘˜ï¼Œdå°±æ˜¯é‚£ä¸ªå¸¸æ•°ã€‚ ç‚¹å’Œå¹³é¢çš„ç©ºé—´å…³ç³»æˆ‘ä»¬åˆ¤å®šç‚¹å’Œå¹³é¢çš„å…³ç³»ä¸»è¦æ˜¯åˆ©ç”¨ç­‰å¼(8)æ¥å®ç°ã€‚ä¾‹å¦‚ï¼Œå‡è®¾å¹³é¢(n, d)ï¼Œæˆ‘ä»¬èƒ½åˆ¤å®šç‚¹på’Œå¹³é¢çš„å…³ç³»ï¼š å‡å¦‚nÂ·p + d = 0ï¼Œé‚£ä¹ˆç‚¹pä¸å¹³é¢å…±é¢ã€‚ å‡å¦‚nÂ·p + d &gt;0ï¼Œé‚£ä¹ˆç‚¹påœ¨å¹³é¢çš„å‰é¢ä¸”åœ¨å¹³é¢çš„æ­£åŠç©ºé—´é‡Œã€‚ å‡å¦‚nÂ·p + d &lt;0ï¼Œé‚£ä¹ˆç‚¹påœ¨å¹³é¢çš„èƒŒé¢ä¸”åœ¨å¹³é¢çš„è´ŸåŠç©ºé—´é‡Œã€‚ ä¸‹è¾¹çš„D3DXå‡½æ•°å°±æ˜¯åˆ©ç”¨nÂ·p + d æ¥åˆ¤å®šç‚¹å’Œå¹³é¢çš„å…³ç³»çš„å‡½æ•°ï¼š123456789101112FLOAT D3DXPlaneDotCoord( CONST D3DXPLANE *pP, // å¹³é¢ CONST D3DXVECTOR3 *pV // ç‚¹);// æµ‹è¯•ç‚¹ç›¸å¯¹äºå¹³é¢çš„ä½ç½®D3DXPLANE p(0.0f, 1.0f, 0.0f, 0.0f);D3DXVECTOR3 v(3.0f, 5.0f, 2.0f);float x = D3DXPlaneDotCoord( &amp;p, &amp;v );if( x approximately equals 0.0f ) // våœ¨å¹³é¢.ä¸Šif( x &gt; 0 ) // våœ¨æ­£åŠç©ºé—´if( x &lt; 0 ) // våœ¨è´ŸåŠç©ºé—´ åˆ›å»ºå¹³é¢æˆ‘ä»¬èƒ½é€šè¿‡ä¸¤ç§æ–¹æ³•åˆ›å»ºå¹³é¢ã€‚ç¬¬ä¸€ç§æ–¹æ³•ï¼Œç›´æ¥ç”¨æŒ‡å®šæ³•çº¿å’Œç‚¹åˆ›å»ºå¹³é¢ã€‚å‡è®¾æ³•çº¿nå’Œåœ¨å¹³é¢ä¸Šçš„å·²çŸ¥ç‚¹p0,æˆ‘ä»¬å°±èƒ½æ±‚å‡ºdï¼š$n \cdot P_0 + d = 0$$n \cdot P_0 = -d$$-n \cdot P_0 = d$ D3DXåº“æä¾›å¦‚ä¸‹å‡½æ•°æ¥å®Œæˆåˆ›å»ºå¹³é¢çš„ä»»åŠ¡ï¼š12345D3DXPLANE *D3DXPlaneFromPointNormal( D3DXPLANE* pOut, // Result. CONST D3DXVECTOR3* pPoint, // Point on the plane. CONST D3DXVECTOR3* pNormal // The normal of the plane.); ç¬¬äºŒç§æ–¹æ³•ï¼Œæˆ‘ä»¬èƒ½é€šè¿‡åœ¨å¹³é¢ä¸Šçš„3ä¸ªç‚¹åˆ›ç«‹ä¸€ä¸ªå¹³é¢ã€‚å‡å¦‚æœ‰ç‚¹p0, p1, p2ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½å¾—åˆ°å¹³é¢ä¸Šçš„ä¸¤ä¸ªå‘é‡ï¼š$u = p_1 - p_0$$v = p_2 - p_0$å› æ­¤æˆ‘ä»¬èƒ½é€šè¿‡æŠŠå¹³é¢ä¸Šçš„ä¸¤ä¸ªå‘é‡è¿›è¡Œåå­—ç›¸ä¹˜å¾—åˆ°å¹³é¢çš„æ³•çº¿ã€‚å›å¿†å·¦æ‰‹åæ ‡ç³»ã€‚$n = u \times v$é‚£ä¹ˆâ€“(nÂ·p0) = d.D3DXåº“æä¾›å¦‚ä¸‹å‡½æ•°æ¥å®Œæˆé€šè¿‡åŒä¸€å¹³é¢ä¸Šçš„3ä¸ªç‚¹ç¡®å®šä¸€ä¸ªå¹³é¢ï¼š123456D3DXPLANE *D3DXPlaneFromPoints( D3DXPLANE* pOut, // Result. CONST D3DXVECTOR3* pV1, // Point 1 on the plane. CONST D3DXVECTOR3* pV2, // Point 2 on the plane. CONST D3DXVECTOR3* pV3 // Point 3 on the plane.); æ ‡å‡†åŒ–å¹³é¢æœ‰æ—¶æˆ‘ä»¬å¯èƒ½æƒ³æ ‡å‡†åŒ–ä¸€ä¸ªå¹³é¢çš„æ³•å‘é‡ï¼Œå³æ ‡å‡†åŒ–å¹³é¢ã€‚åˆä¸€æƒ³ï¼Œå¥½è±¡æˆ‘ä»¬åªéœ€è±¡æ ‡å‡†åŒ–å…¶ä»–å‘é‡ä¸€æ ·æ ‡å‡†åŒ–å¹³é¢çš„æ³•å‘é‡å°±å¯ä»¥äº†ã€‚ä½†æ˜¯å›å¿†åœ¨ç­‰å¼nÂ·p + d = 0ä¸­çš„d = â€“nÂ·p0ã€‚æˆ‘ä»¬æ˜ç™½æ³•å‘é‡çš„é•¿åº¦å°†å½±å“å¸¸æ•°dã€‚å› æ­¤ï¼Œå‡å¦‚æˆ‘ä»¬æ ‡å‡†åŒ–æ³•å‘é‡ï¼Œæˆ‘ä»¬å¿…é¡»é‡æ–°è®¡ç®—d.æ³¨æ„${d \over ||n||} = -{n \over ||n||} \cdot P_0$ å› æ­¤ï¼Œæˆ‘ä»¬æœ‰ä¸‹è¾¹å…¬å¼æ¥æ ‡å‡†åŒ–å¹³é¢(n, d)çš„æ³•å‘é‡ï¼š æˆ‘ä»¬èƒ½ç”¨ä¸‹é¢çš„D3DXå‡½æ•°æ¥æ ‡å‡†åŒ–ä¸€ä¸ªå¹³é¢ï¼š1234D3DXPLANE *D3DXPlaneNormalize( D3DXPLANE *pOut, // Resulting normalized plane. CONST D3DXPLANE *pP // Input plane.); å˜æ¢å¹³é¢æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡å¦‚ä¸‹å¤„ç†æ¥å˜æ¢ä¸€ä¸ªé¢ï¼ˆn, dï¼‰ï¼Œå°±è±¡ä¸€ä¸ª4Då‘é‡é€šè¿‡ä¹˜ä»¥å®ƒæ¸´æœ›å¾—åˆ°å˜æ¢çš„å˜æ¢çŸ©é˜µçš„é€†çŸ©é˜µä¸€æ ·æ¥è¾¾åˆ°å˜æ¢ç›®çš„ã€‚æ³¨æ„å¹³é¢çš„æ³•å‘é‡å¿…é¡»é¦–å…ˆè¢«æ ‡å‡†åŒ–ã€‚æˆ‘ä»¬èƒ½ç”¨ä¸‹é¢çš„D3DXå‡½æ•°æ¥å®Œæˆæ“ä½œï¼š12345D3DXPLANE *D3DXPlaneTransform( D3DXPLANE *pOut, // Result CONST D3DXPLANE *pP, // Input plane. CONST D3DXMATRIX *pM // Transformation matrix.); ç¤ºä¾‹ä»£ç ï¼š12345678D3DXMATRIX T(...); // Init. T to a desired transformation.D3DXMATRIX inverseOfT;D3DXMATRIX inverseTransposeOfT;D3DXMatrixInverse( &amp;inverseOfT, 0, &amp;T );D3DXMatrixTranspose( &amp;inverseTransposeOfT, &amp;inverseOfT );D3DXPLANE p(...); // Init. Plane.D3DXPlaneNormalize( &amp;p, &amp;p ); // make sure normal is normalized.D3DXPlaneTransform( &amp;p, &amp;p, &amp;inverseTransposeOfT ); ç‚¹åˆ°å¹³é¢ä¸Šæœ€è¿‘çš„ç‚¹ å‡å¦‚æˆ‘ä»¬åœ¨ç©ºé—´ä¸­æœ‰ä¸€ä¸ªç‚¹på¹¶ä¸”æƒ³æ‰¾åˆ°åœ¨å¹³é¢( n, d)ä¸Šçš„ä¸pæœ€æ¥è¿‘ä¸€ä¸ªç‚¹qã€‚æ³¨æ„å¦‚æœå¹³é¢çš„æ³•å‘é‡æ˜¯å•ä½é•¿åº¦ï¼Œè¿™å°†ç®€åŒ–é—®é¢˜ã€‚ å›¾13 ä»å›¾13æˆ‘ä»¬èƒ½çœ‹å‡ºq = p + (â€“k_n)ï¼Œkæ˜¯æœ‰ç¬¦å·ä¹‹åˆ†çš„ä»ç‚¹påˆ°å¹³é¢çš„è·ç¦»ï¼Œä¹Ÿå°±æ˜¯ç‚¹på’Œqä¹‹é—´çš„æœ‰å‘è·ç¦»ã€‚å‡å¦‚å¹³é¢çš„æ³•å‘é‡næ˜¯å•ä½é•¿åº¦ï¼Œé‚£ä¹ˆnÂ·p + d å°±æ˜¯ä»å¹³é¢åˆ°ç‚¹pæœ‰å‘è·ç¦». å°„çº¿ ä¸€æ¡å°„çº¿èƒ½ç”¨ä¸€ä¸ªèµ·ç‚¹å’Œæ–¹å‘æ¥æè¿°ã€‚å°„çº¿çš„å‚æ•°æ–¹ç¨‹æ˜¯ï¼š $p(t)=p_{0} + tu$ å›¾14 p0 æ˜¯å°„çº¿çš„èµ·ç‚¹ï¼Œuæ˜¯å°„çº¿çš„æ–¹å‘ï¼Œtæ˜¯å‚æ•°ã€‚é€šè¿‡èµ‹äºˆä¸åŒçš„tå€¼ï¼Œæˆ‘ä»¬èƒ½è®¡ç®—å‡ºåœ¨å°„çº¿ä¸Šä¸åŒçš„ç‚¹ã€‚è¦æè¿°ä¸€æ¡å°„çº¿ï¼Œå‚æ•°tèŒƒå›´å°±å¿…é¡»åœ¨[0, âˆ)ä¹‹é—´ã€‚å®é™…ä¸Šï¼Œå‡å¦‚æˆ‘ä»¬è®©tâˆˆ(â€“âˆ, âˆ),é‚£ä¹ˆæˆ‘ä»¬å°±èƒ½å¾—åˆ°ä¸€æ¡3ç»´ç©ºé—´ç›´çº¿ã€‚ çº¿/é¢ç›¸äº¤ å‡è®¾ä¸€æ¡å°„çº¿p(t) = p0 + tu å’Œ ä¸€ä¸ªå¹³é¢nÂ·p + d = 0ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“å°„çº¿æ˜¯å¦ä¸å¹³é¢ç›¸äº¤ï¼Œä»¥åŠç›¸äº¤çš„äº¤ç‚¹ä¿¡æ¯ï¼ˆå¦‚æœç›¸äº¤çš„è¯ï¼‰ã€‚ç…§è¿™æ ·åšï¼Œæˆ‘ä»¬æŠŠå°„çº¿ä»£å…¥å¹³é¢æ–¹ç¨‹å¹¶ä¸”æ±‚æ»¡è¶³å¹³é¢æ–¹ç¨‹çš„å‚æ•°tï¼Œè§£ç­”å‡ºæ¥çš„å‚æ•°å°±æ˜¯ç›¸äº¤çš„ç‚¹ã€‚ å‡å¦‚t ä¸åœ¨[0, âˆ)ä¹‹é—´ï¼Œé‚£ä¹ˆå°„çº¿ä¸å¹³é¢ä¸ç›¸äº¤ã€‚ å‡å¦‚t åœ¨[0, âˆ)ä¹‹é—´ï¼Œé‚£ä¹ˆå°„çº¿ä¸å¹³é¢ç›¸äº¤ã€‚ä¸”æŠŠå‚æ•°ä»£å…¥å°„çº¿æ–¹ç¨‹å°±èƒ½æ‰¾åˆ°äº¤ç‚¹ï¼š åˆå§‹åŒ–Direct3D (Direct3D Initialization)Direct3Dæ¦‚è¿° Direct3Dæ˜¯ä¸€ç§åº•å±‚å›¾å½¢APIï¼Œå®ƒèƒ½è®©æˆ‘ä»¬åˆ©ç”¨3Dç¡¬ä»¶åŠ é€Ÿæ¥æ¸²æŸ“3Dä¸–ç•Œã€‚æˆ‘ä»¬å¯ä»¥æŠŠDirect3Dçœ‹ä½œæ˜¯åº”ç”¨ç¨‹åºå’Œå›¾å½¢è®¾å¤‡ä¹‹é—´çš„ä¸­ä»‹ã€‚ä¾‹å¦‚é€šçŸ¥å›¾å½¢è®¾å¤‡æ¸…ç©ºå±å¹•ï¼Œåº”ç”¨ç¨‹åºå°†è°ƒç”¨Direct3Dçš„IDirect3DDevice9::Clearæ–¹æ³•ã€‚å›¾1.1æ˜¾ç¤ºäº†åº”ç”¨ç¨‹åºã€Direct3Då’Œå›¾å½¢è®¾å¤‡ä¹‹é—´çš„å…³ç³»ã€‚ å›¾1.1ä¸­Direct3Dæ‰€è¡¨ç¤ºçš„æ˜¯Direct3Dä¸­å·²å®šä¹‰çš„ï¼Œä¾›ç¨‹åºå‘˜ä½¿ç”¨çš„Direct3Dæ¥å£å’Œå‡½æ•°çš„é›†åˆã€‚è¿™äº›æ¥å£å’Œå‡½æ•°ä»£è¡¨äº†å½“å‰ç‰ˆæœ¬çš„Direct3Dæ‰€æ”¯æŒçš„å…¨éƒ¨ç‰¹æ€§ã€‚æ³¨æ„ï¼šä»…ä»…å› ä¸ºDirect3Dæ”¯æŒæŸç§ç‰¹æ€§ï¼Œå¹¶ä¸æ„å‘³ç€ä½ æ‰€ä½¿ç”¨çš„å›¾å½¢ç¡¬ä»¶ï¼ˆæ˜¾å¡ï¼‰ä¹Ÿèƒ½æ”¯æŒå®ƒã€‚ å¦‚å›¾1.1æ‰€ç¤ºï¼Œåœ¨Direct3Då’Œå›¾å½¢è®¾å¤‡ä¹‹é—´æœ‰ä¸€å±‚ä¸­ä»‹â€”â€”å«åšç¡¬ä»¶æŠ½è±¡å±‚ï¼ˆHALï¼ŒHardware Abstraction Layerï¼‰ã€‚Direct3Dä¸èƒ½ç›´æ¥ä½œç”¨äºå›¾å½¢è®¾å¤‡ï¼Œå› ä¸ºç°åœ¨å¸‚é¢ä¸Šçš„æ˜¾å¡ç§ç±»å®åœ¨æ˜¯å¤ªå¤šäº†å¹¶ä¸”æ¯ç§æ˜¾å¡éƒ½æœ‰ä¸åŒçš„æ€§èƒ½å’Œå¤„ç†äº‹ä»¶çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä¸¤ç§ä¸åŒçš„æ˜¾å¡å®ç°æ¸…å±çš„æ–¹å¼ä¹Ÿå¯èƒ½æ˜¯ä¸åŒçš„ã€‚å› æ­¤ï¼ŒDirect3Dè¦æ±‚è®¾å¤‡åˆ¶é€ å•†å®ç°HALã€‚HALæ˜¯ä¸€ç»„æŒ‡ç¤ºè®¾å¤‡æ‰§è¡ŒæŸç§æ“ä½œçš„ç‰¹æ®Šè®¾å¤‡ä»£ç çš„é›†åˆã€‚ç”¨è¿™ç§æ–¹æ³•ï¼ŒDirect3Dé¿å…äº†å¿…é¡»å»äº†è§£æŸä¸ªè®¾å¤‡çš„ç‰¹æ®Šç»†èŠ‚ï¼Œä½¿å®ƒèƒ½å¤Ÿç‹¬ç«‹äºç¡¬ä»¶è®¾å¤‡ã€‚ è®¾å¤‡åˆ¶é€ å•†åœ¨HALä¸­å®ç°ä»–ä»¬çš„äº§å“æ‰€æ”¯æŒçš„æ‰€æœ‰ç‰¹æ€§ã€‚HALå°†ä¸ä¼šå®ç°é‚£äº›Direct3Dæ”¯æŒä½†ç¡¬ä»¶äº§å“ä¸æ”¯æŒçš„ç‰¹æ€§ã€‚è°ƒç”¨ä¸€ä¸ªHALä¸­æ²¡æœ‰å®ç°çš„Direct3Dçš„å‡½æ•°å°†ä¼šå‡ºé”™ï¼Œé™¤éå®ƒæ˜¯é¡¶ç‚¹å¤„ç†æ“ä½œï¼Œå› ä¸ºè¿™ä¸ªåŠŸèƒ½å¯ä»¥ç”±è½¯ä»¶æ¨¡æ‹Ÿæ¥å®ç°ã€‚å› æ­¤å½“ä½¿ç”¨æŸäº›ä»…ç”±å¸‚é¢ä¸Šå°‘æ•°æ˜¾å¡æ‰€æ”¯æŒçš„é«˜çº§ç‰¹æ€§æ—¶ï¼Œå¿…é¡»æ£€æµ‹ä¸€ä¸‹è®¾å¤‡æ˜¯å¦æ”¯æŒã€‚ï¼ˆè®¾å¤‡çš„åŠŸèƒ½å°†åœ¨1.3.8èŠ‚ä¸­è®²è§£ï¼‰ REFè®¾å¤‡ ä½ ä¹Ÿè®¸æƒ³æŠŠä¸€äº›ä½ çš„è®¾å¤‡ä¸æ”¯æŒçš„Direct3Då‡½æ•°å†™å…¥ç¨‹åºã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼ŒDirect3Dæä¾›äº†REFè®¾å¤‡,å®ƒç”¨è½¯ä»¶æ¨¡æ‹Ÿäº†æ‰€æœ‰çš„Direct3D APIã€‚è¿™å…è®¸ä½ å†™å¹¶æµ‹è¯•é‚£äº›ä½ çš„æ˜¾å¡ä¸æ”¯æŒçš„Direct3Dç‰¹æ€§çš„ä»£ç ã€‚ä¾‹å¦‚åœ¨æœ¬ä¹¦çš„ç¬¬å››éƒ¨åˆ†ï¼ŒæŸäº›äººçš„æ˜¾å¡å¯èƒ½ä¼šä¸æ”¯æŒé¡¶ç‚¹å’Œåƒç´ ç€è‰²å™¨ã€‚å¦‚æœä½ çš„æ˜¾å¡ä¸æ”¯æŒç€è‰²å™¨ï¼Œä½ ä»ç„¶èƒ½å¤Ÿä½¿ç”¨REè®¾å¤‡æµ‹è¯•ç¤ºä¾‹ä»£ç ã€‚æ‡‚å¾—REè®¾å¤‡ä»…ä»…æ˜¯ä¸ºäº†å‘å±•ï¼Œè¿™æ˜¯å¾ˆé‡è¦çš„ã€‚å®ƒåªä¼šå’ŒDirectX SDKä¸€èµ·è¢«è£…è½½ï¼Œè€Œä¸ä¼šå‘å¸ƒç»™æœ€ç»ˆç”¨æˆ·ã€‚ å¦å¤–ï¼ŒREè®¾å¤‡å®åœ¨æ˜¯å¤ªæ…¢äº†ï¼Œé™¤äº†æµ‹è¯•ä»¥å¤–å®ƒæ²¡æœ‰ä»»ä½•åˆ©ç”¨ä»·å€¼ã€‚ D3DDEVTYPE åœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç”¨D3DDEVTYPE_HALæ¥å®šä¹‰HALè®¾å¤‡ï¼Œå®ƒæ˜¯D3DDEVTYPEæšä¸¾ç±»å‹çš„ä¸€ä¸ªæˆå‘˜ã€‚åŒæ ·çš„ï¼ŒREFè®¾å¤‡åˆ™ç”±D3DDEVTYPE_REFæ¥å®šä¹‰ï¼Œå®ƒä¹Ÿå±äºD3DDEVTYPEæšä¸¾ç±»å‹ã€‚è®°ä½è¿™äº›ç±»å‹å¾ˆé‡è¦ï¼Œå› ä¸ºåœ¨åˆ›å»ºè®¾å¤‡çš„æ—¶å€™æˆ‘ä»¬éœ€è¦æŒ‡å®šæˆ‘ä»¬å°†è¦ä½¿ç”¨çš„ç±»å‹ã€‚ COM ç»„ä»¶å¯¹è±¡æ¨¡å‹ï¼ˆCOM, Component Object Modelï¼‰æ˜¯ä¸€ç§èƒ½ä½¿DirectXç‹¬ç«‹äºç¼–ç¨‹è¯­è¨€å’Œå…·æœ‰å‘ä¸‹å…¼å®¹æ€§çš„æŠ€æœ¯ã€‚æˆ‘ä»¬é€šå¸¸æŠŠCOMå¯¹è±¡ä½œä¸ºä¸€ä¸ªæ¥å£ï¼Œä½ å¯ä»¥æŠŠå®ƒå½“ä½œè¾¾åˆ°æŸç§ç›®çš„çš„C++ç±»æ¥ä½¿ç”¨å®ƒã€‚å½“ä½¿ç”¨C++å†™DirectXç¨‹åºçš„æ—¶å€™ï¼ŒCOMçš„å¤§éƒ¨åˆ†ç»†èŠ‚å¯¹æˆ‘ä»¬æ¥è¯´æ˜¯é€æ˜ã€‚ä½†æ˜¯æœ‰ä¸€ä»¶äº‹ï¼Œæˆ‘ä»¬å¿…é¡»çŸ¥é“ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬é€šè¿‡æŸä¸ªç‰¹æ®Šçš„COMæ¥å£çš„å‡½æ•°æˆ–æŒ‡é’ˆè·å¾—äº†å¦ä¸€ä¸ªCOMæ¥å£æŒ‡é’ˆï¼Œè€Œä¸æ˜¯é€šè¿‡C++çš„æ–°å…³é”®å­—æ¥åˆ›å»ºå®ƒã€‚å½“æˆ‘ä»¬ä½¿ç”¨å®ŒæŸä¸ªæ¥å£åï¼Œè°ƒç”¨å®ƒçš„Releaseæ–¹æ³•æ¯”ç›´æ¥Deleteå®ƒæ›´å¥½ã€‚COMå¯¹è±¡å…·æœ‰å®ƒä»¬è‡ªå·±çš„å†…å­˜ç®¡ç†ã€‚ å¯¹COMæ¥è¯´è¿˜æœ‰å¾ˆå¤šç»†èŠ‚å¯ä»¥äº†è§£ï¼Œä½†æ˜¯æŒæ¡è¿™äº›ç»†èŠ‚å¯¹äºæˆ‘ä»¬æœ‰æ•ˆçš„ä½¿ç”¨DirectXä¸æ˜¯å¿…é¡»çš„ã€‚æ³¨æ„ï¼šCOMæ¥å£éƒ½å…·æœ‰å‰ç¼€å¤§å†™å­—æ¯â€œIâ€ï¼Œä¾‹å¦‚è¡¨ç¤ºä¸€ä¸ªè¡¨é¢çš„COMæ¥å£å«åšIDirect3DSurface9ã€‚ ä¸€äº›å‡†å¤‡å·¥ä½œ Direct3Dçš„åˆå§‹åŒ–è¿‡ç¨‹è¦æ±‚æˆ‘ä»¬å¯¹å›¾å½¢å­¦åŸºç¡€çŸ¥è¯†å’ŒDirect3Dç±»å‹æœ‰ä¸€å®šäº†è§£ã€‚æœ¬èŠ‚å°†ä»‹ç»è¿™äº›çŸ¥è¯†å’Œç±»å‹ï¼Œä»¥ç¡®ä¿ä¸‹ä¸€èŠ‚èƒ½æŠŠç„¦ç‚¹é›†ä¸­åœ¨è®¨è®ºDirect3Dçš„åˆå§‹åŒ–ä¸Šã€‚ è¡¨é¢ è¡¨é¢æ˜¯ä¸€ä¸ªåƒç´ ç‚¹é˜µï¼Œåœ¨Direct3Dä¸­ä¸»è¦ç”¨æ¥å­˜å‚¨2Då›¾å½¢æ•°æ®ã€‚å›¾1.2æŒ‡æ˜äº†è¡¨é¢çš„ä¸€äº›æˆåˆ†ã€‚ç”±å›¾å¯ä»¥çœ‹å‡ºè¡¨é¢æ•°æ®å°±åƒä¸€ä¸ªçŸ©é˜µï¼Œåƒç´ æ•°æ®å®é™…ä¸Šå­˜å‚¨åœ¨çº¿æ€§æ•°ç»„é‡Œé¢ã€‚ è¡¨é¢çš„Widthå’ŒHeightæ˜¯æŒ‰åƒç´ è®¡ç®—çš„ã€‚Pitchä»¥å­—èŠ‚ä¸ºå•ä½ã€‚è€Œä¸”Pitchæœ‰å¯èƒ½æ¯”Widthå¤§ä¸”ä¾èµ–äºä½å±‚ç¡¬ä»¶ï¼Œæ‰€ä»¥ä¸èƒ½å•çº¯çš„è®¤ä¸ºPitch = Width * sizeof (pixelFormat)ã€‚ åœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨IDirect3DSurface9æ¥å£æ¥æè¿°è¡¨é¢ã€‚è¿™ä¸ªæ¥å£æä¾›è‹¥å¹²æ–¹æ³•æ¥ç›´æ¥è¯»å†™è¡¨é¢æ•°æ®å¹¶ä¸”è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•ç”¨æ¥è¿”å›è¡¨é¢ä¿¡æ¯ã€‚IDirect3DSurface9ä¸­æœ€é‡è¦çš„æ–¹æ³•æ˜¯ï¼š LockRectâ€”â€”ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å°†è·å¾—ä¸€ä¸ªæŒ‡å‘è¡¨é¢å†…å­˜çš„æŒ‡é’ˆï¼Œç„¶åï¼Œé€šè¿‡ä¸€ç³»åˆ—æŒ‡é’ˆè¿ç®—ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¡¨é¢ä¸Šä»»ä¸€ä¸ªåƒç´ ç‚¹è¿›è¡Œè¯»ã€å†™æ“ä½œã€‚ UnlockRectâ€”â€”å½“ä½ è°ƒç”¨äº†LockRectå’Œå®Œæˆäº†å¯¹è¡¨é¢å†…å­˜çš„è®¿é—®åï¼Œä½ å¿…é¡»è°ƒç”¨è¿™ä¸ªæ–¹æ³•ç»™è¡¨é¢è§£é”ã€‚ GetDescâ€”â€”è¿™ä¸ªæ–¹æ³•å°†é€šè¿‡å¡«å……D3DSURFACE_DESCç»“æ„æ¥è¿”å›è¡¨é¢çš„æè¿°ä¿¡æ¯ã€‚æœ€åˆé”å®šè¡¨é¢å’Œæ”¹å†™æ¯ä¸€åƒç´ çœ‹æ¥ç¨å¾®æœ‰ç‚¹è¿·èŒ«ã€‚ä¸‹é¢çš„ä»£ç è¡¨ç¤ºé”å®šè¡¨é¢å¹¶å°†æ¯ä¸€åƒç´ æŸ“æˆçº¢è‰²ï¼š12345678910111213141516171819202122232425262728// å‡å®š_surfaceæ˜¯ä¸€ä¸ªæŒ‡å‘IDirect3DSurface9æ¥å£çš„æŒ‡é’ˆ// å‡å®šæ¯ä¸ªåƒç´ ä¸ºï¼š32-bitçš„åƒç´ æ ¼å¼// å–å¾—è¡¨é¢æè¿°D3DSURFACE_DESC surfaceDesc;_surface-&gt;GetDesc(&amp;surfaceDesc);// å–å¾—è¢«é”å®šè¡¨é¢çš„åƒç´ æ•°æ®çš„æŒ‡é’ˆD3DLOCKED_RECT lockedRect;_surface-&gt;LockRect( &amp;lockedRect, // æŒ‡å‘è¢«é”å®šè¡¨é¢çš„æ•°æ® 0, // 0è¡¨ç¤ºé”å®šå…¨éƒ¨è¡¨é¢ 0); // 0è¡¨ç¤ºæ²¡æœ‰æŒ‡å®šé”å®šæ ‡è®°// éä¾‹è¡¨é¢ä¸Šçš„æ¯ä¸ªåƒç´ ï¼Œå°†å®ƒä»¬è®¾ä¸ºçº¢è‰²DWORD* imageData = (DWORD*)lockedRect.pBits;for(int i = 0; i &lt; surfaceDesc.Height; i++)&#123; for(int j = 0; j &lt; surfaceDesc.Width; j++) &#123; // å–å¾—çº¹ç†ç´¢å¼•, æ³¨æ„æˆ‘ä»¬ç”¨pitch é™¤ä»¥4æ˜¯å› ä¸ºpitchçš„å•ä½æ˜¯åƒç´ ï¼Œ // å¹¶ä¸”ä¸€ä¸ªDWORDç±»å‹å ä¸º4 bytesç©ºé—´ int index = i * lockedRect.Pitch / 4 + j; imageData[index] = 0xffff0000; // æ¯ä¸ªåƒç´ è®¾ä¸ºçº¢è‰² &#125;&#125;_surface-&gt;UnlockRect(); ç¨‹åºä¸­D3DLOCKED_RECTç»“æ„çš„å®šä¹‰å¦‚ä¸‹ï¼š1234typedef struct _D3DLOCKED_RECT &#123; INT Pitch; // è¡¨é¢æ·±åº¦ void *pBits; // æŒ‡å‘è¡¨é¢å¼€å§‹å¤„çš„å†…å­˜&#125; D3DLOCKED_RECT; åœ¨è¿™é‡Œæœ‰ä¸€äº›å…³äºè¡¨é¢é”å®šä»£ç çš„ä¸€äº›è¯´æ˜ã€‚32-bitåƒç´ æ ¼å¼è¿™ä¸ªè®¾å®šå¾ˆé‡è¦ï¼Œæˆ‘ä»¬æŠŠbitsè½¬æ¢æˆDWORDsã€‚è¿™è®©æˆ‘ä»¬èƒ½æŠŠæ¯ä¸€ä¸ªDWORDè§†ä¸ºè¡¨ç¤ºä¸€ä¸ªåƒç´ ã€‚ Multisamplingç”±äºä½¿ç”¨åƒç´ çŸ©é˜µæ¥è¡¨ç¤ºå›¾åƒï¼Œåœ¨æ˜¾ç¤ºæ—¶ä¼šå‡ºç°é”¯é½¿çŠ¶ï¼ŒMultisamplingå°±æ˜¯ä½¿å…¶å˜å¾—å¹³æ»‘çš„æŠ€æœ¯ã€‚å®ƒçš„ä¸€ç§æœ€æ™®é€šçš„ç”¨æ³•å³ä¸ºâ€”â€”å…¨å±æŠ—é”¯é½¿ã€‚ D3DMULTISAMPLE_TYPEæšä¸¾ç±»å‹ä½¿æˆ‘ä»¬å¯ä»¥æŒ‡å®šå…¨å±æŠ—é”¯é½¿çš„è´¨é‡ç­‰çº§ï¼š D3DMULTISAMPLE_NONEâ€”â€”ä¸ä½¿ç”¨å…¨å±æŠ—é”¯é½¿ã€‚ D3DMULTISAMPLE_1_SAMPLEâ€¦D3DMULTISAPLE_16_SAMPLEâ€”â€”è®¾å®š1-16çº§çš„ç­‰çº§ã€‚ æœ¬ä¹¦çš„ç¤ºä¾‹ç¨‹åºä¸­æ²¡æœ‰ä½¿ç”¨å…¨å±æŠ—é”¯é½¿çš„åŠŸèƒ½ï¼Œå› ä¸ºå®ƒå¤§å¤§çš„é™ä½äº†ç¨‹åºè¿è¡Œé€Ÿåº¦ã€‚å¦‚æœä½ å®åœ¨å¾ˆæƒ³ä½¿ç”¨å®ƒçš„è¯ï¼Œè¦è®°ä½ä½¿ç”¨IDirect3D9::CheckDeviceMultisampleTypeæ¥æ£€æµ‹ä½ çš„æ˜¾å¡æ˜¯å¦æ”¯æŒã€‚ åƒç´ æ ¼å¼å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¡¨é¢æˆ–çº¹ç†æ—¶ï¼Œç»å¸¸éœ€è¦æŒ‡å®šè¿™äº›Direct3Dèµ„æºçš„åƒç´ æ ¼å¼ã€‚å®ƒæ˜¯ç”±D3DFORMATæšä¸¾ç±»å‹çš„ä¸€ä¸ªæˆå‘˜æ¥å®šä¹‰çš„ã€‚è¿™é‡Œä¾‹ä¸¾ä¸€éƒ¨åˆ†ï¼š D3DFMT_R8G8B8â€”â€”è¡¨ç¤ºä¸€ä¸ª24ä½åƒç´ ï¼Œä»å·¦å¼€å§‹ï¼Œ8ä½åˆ†é…ç»™çº¢è‰²ï¼Œ8ä½åˆ†é…ç»™ç»¿è‰²ï¼Œ8ä½åˆ†é…ç»™è“è‰²ã€‚ D3DFMT_X8R8G8B8â€”â€”è¡¨ç¤ºä¸€ä¸ª32ä½åƒç´ ï¼Œä»å·¦å¼€å§‹ï¼Œ8ä½ä¸ç”¨ï¼Œ8ä½åˆ†é…ç»™çº¢è‰²ï¼Œ8ä½åˆ†é…ç»™ç»¿è‰²ï¼Œ8ä½åˆ†é…ç»™è“è‰²ã€‚ D3DFMT_A8R8G8B8â€”â€”è¡¨ç¤ºä¸€ä¸ª32ä½åƒç´ ï¼Œä»å·¦å¼€å§‹ï¼Œ8ä½ä¸ºALPHAé€šé“ï¼Œ8ä½åˆ†é…ç»™çº¢è‰²ï¼Œ8ä½åˆ†é…ç»™ç»¿è‰²ï¼Œ8ä½åˆ†é…ç»™è“è‰²ã€‚ D3DFMT_A16B16G16R16Fâ€”â€”è¡¨ç¤ºä¸€ä¸ª64ä½æµ®ç‚¹åƒç´ ï¼Œä»å·¦å¼€å§‹ï¼Œ16ä½ä¸ºALPHAé€šé“ï¼Œ16ä½åˆ†é…ç»™è“è‰²ï¼Œ16ä½åˆ†é…ç»™ç»¿è‰²ï¼Œ16ä½åˆ†é…ç»™çº¢è‰²ã€‚ D3DFMT_A32B32G32R32Fâ€”â€”è¡¨ç¤ºä¸€ä¸ª128ä½æµ®ç‚¹åƒç´ ï¼Œä»å·¦å¼€å§‹ï¼Œ32ä½ä¸ºALPHAé€šé“ï¼Œ32ä½åˆ†é…ç»™è“è‰²ï¼Œ32ä½åˆ†é…ç»™ç»¿è‰²ï¼Œ32ä½åˆ†é…ç»™çº¢è‰²ã€‚æƒ³äº†è§£å…¨éƒ¨çš„åƒç´ æ ¼å¼è¯·æŸ¥çœ‹SDKæ–‡æ¡£ä¸­çš„D3DFORMATéƒ¨åˆ†ã€‚æ³¨æ„ï¼šè¿™å‰ä¸‰ç§æ ¼å¼ï¼ˆD3DFMT_R8G8B8ã€D3DFMT_X8R8G8B8ã€D3DFMT_A8R8G8B8ï¼‰æ˜¯æœ€å¸¸ç”¨å¹¶ä¸ºå¤§éƒ¨åˆ†æ˜¾å¡æ‰€æ”¯æŒã€‚ä½†æµ®ç‚¹åƒç´ æ ¼å¼æˆ–å…¶å®ƒä¸€äº›ç±»å‹çš„æ”¯æŒå¹¶ä¸æ˜¯å¾ˆå¹¿æ³›ï¼Œåœ¨ä½¿ç”¨å®ƒä»¬å‰è¯·å…ˆæ£€æµ‹ä½ çš„æ˜¾å¡ï¼Œçœ‹æ˜¯å¦æ”¯æŒã€‚ å†…å­˜æ± è¡¨é¢å’Œå…¶å®ƒä¸€äº›Direct3Dèµ„æºè¢«æ”¾åœ¨å¤šç§å†…å­˜æ± ä¸­ã€‚å†…å­˜æ± çš„ç§ç±»ç”±D3DPOOLæšä¸¾ç±»å‹çš„ä¸€ä¸ªæˆå‘˜æ¥æŒ‡å®šã€‚å¯ç”¨åˆ°çš„å†…å­˜æ± æœ‰ä¸‹åˆ—å‡ ç§ï¼š D3DPOOL_DEFAULTâ€”â€”è¡¨ç¤ºDirect3Då°†æ ¹æ®èµ„æºçš„ç±»å‹å’Œç”¨é€”æŠŠå®ƒä»¬æ”¾åœ¨æœ€åˆé€‚çš„åœ°æ–¹ã€‚è¿™æœ‰å¯èƒ½æ˜¯æ˜¾å­˜ã€AGPå†…å­˜æˆ–è€…ç³»ç»Ÿå†…å­˜ä¸­ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§å†…å­˜æ± ä¸­çš„èµ„æºå¿…é¡»è¦åœ¨IDirect3DDevice9::Resetè¢«è°ƒç”¨ä¹‹å‰æ¶ˆæ¯æ‰ï¼Œå¹¶ä¸”å†æ¬¡ä½¿ç”¨æ—¶å¿…é¡»é‡æ–°åˆå§‹åŒ–ã€‚ D3DPOOL_MANAGEDâ€”â€”èµ„æºå°†ç”±Direct3Dç®¡ç†å¹¶ä¸”æŒ‰è®¾å¤‡çš„éœ€è¦æ¥æŒ‡å®šæ”¾åœ¨æ˜¾å­˜è¿˜æ˜¯æ”¾åœ¨AGPå†…å­˜ä¸­ã€‚å½“åº”ç”¨ç¨‹åºè®¿é—®å’Œæ”¹å˜èµ„æºæ—¶å®ƒå…ˆæŠŠè¿™äº›èµ„æºæ‹·è´åˆ°ç³»ç»Ÿå†…å­˜ä¸­ï¼Œå½“éœ€è¦æ—¶Direct3Dä¼šè‡ªåŠ¨æŠŠå®ƒä»¬æ‹·è´åˆ°æ˜¾å­˜é‡Œã€‚ D3DPOOL_SYSTEMMEMâ€”â€”æŒ‡å®šèµ„æºæ”¾åœ¨ç³»ç»Ÿå†…å­˜ä¸­ã€‚ D3DPOOL_SCRATCHâ€”â€”æŒ‡å®šèµ„æºæ”¾åœ¨ç³»ç»Ÿå†…å­˜ä¸­ï¼Œå®ƒä¸D3DPOOL_SYSTEMMEMä¸åŒä¹‹å¤„åœ¨äºä½¿ç”¨è¿™äº›èµ„æºä¸å¿…å—å›¾å½¢è®¾å¤‡çš„é™åˆ¶ã€‚å› æ­¤ï¼Œå‚æ•°ä½¿å›¾å½¢è®¾å¤‡ä¸èƒ½è®¿é—®è¯¥å†…å­˜æ± çš„èµ„æºï¼Œä½†èµ„æºå¯ä»¥ç›¸äº’æ‹·è´ã€‚1.3.5 äº¤æ¢é“¾å’Œé¡µé¢åˆ‡æ¢ Direct3Dé€šå¸¸åˆ›å»º2~3ä¸ªè¡¨é¢ç»„æˆä¸€ä¸ªé›†åˆï¼Œå³ä¸ºäº¤æ¢é“¾ï¼Œé€šå¸¸ç”±IDirect3DSwapChainæ¥å£æ¥è¡¨ç¤ºã€‚æˆ‘ä»¬ä¸å¿…å»äº†è§£å®ƒæ›´è¯¦ç»†çš„ç»†èŠ‚ã€‚æˆ‘ä»¬ä¹Ÿå¾ˆå°‘å»ç®¡ç†å®ƒï¼Œé€šå¸¸Direct3Dä¼šè‡ªå·±å»ç®¡ç†ã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦å¤§æ¦‚çš„äº†è§£ä¸€ä¸‹å®ƒå°±å¯ä»¥äº†ã€‚ äº¤æ¢é“¾ä»¥åŠé¡µé¢åˆ‡æ¢æŠ€å·§è¢«ç”¨åœ¨ä½¿ä¸¤å¸§åŠ¨ç”»ä¹‹é—´è¿‡åº¦æ›´å¹³æ»‘ã€‚å›¾1.4å±•ç¤ºçš„æ˜¯ä¸€ä¸ªæœ‰ä¸¤ä¸ªç»˜åˆ¶è¡¨é¢çš„äº¤æ¢é“¾ã€‚ å›¾1.4 å¦‚å›¾1.4ï¼Œåœ¨Front Bufferä¸­çš„è¡¨é¢å°†ç”¨æ¥åœ¨å±å¹•ä¸Šæ˜¾ç¤ºã€‚æ˜¾ç¤ºå™¨ä¸èƒ½å³æ—¶æ˜¾ç¤ºFront Bufferä¸­è¡¨ç¤ºçš„å›¾åƒï¼›é€šå¸¸æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯æ¯å…­ååˆ†ä¹‹ä¸€ç§’åˆ·æ–°æ˜¾ç¤ºä¸€æ¬¡ï¼Œå³åˆ·æ–°ç‡ä¸º60èµ«å…¹ã€‚åº”ç”¨ç¨‹åºçš„å¸§ç‡ç»å¸¸ä¸ç›‘è§†å™¨çš„åˆ·æ–°ç‡ä¸åŒæ­¥ï¼ˆæ¯”å¦‚åº”ç”¨ç¨‹åºçš„æ¸²æŸ“å¸§é€Ÿåº¦å¯èƒ½æ¯”æ˜¾ç¤ºå™¨çš„åˆ·æ–°é€Ÿåº¦å¿«ï¼‰ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä¸èƒ½åœ¨æ˜¾ç¤ºå™¨æ˜¾ç¤ºå®Œæˆå½“å‰å¸§ä¹‹å‰å°±æ›´æ–°æœ‰ä¸‹ä¸€å¸§åŠ¨ç”»çš„Front Bufferå†…å®¹ï¼Œä½†æ˜¯æˆ‘ä»¬åˆä¸æƒ³è®©ç¨‹åºåœæ­¢æ¸²æŸ“è€Œå»ç­‰å¾…æ˜¾ç¤ºå™¨æ˜¾ç¤ºã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ¸²æŸ“å¦ä¸€ä¸ªå±å¹•è¡¨é¢Back Bufferã€‚å½“ç›‘è§†å™¨å°†Front Bufferæ˜¾ç¤ºå‡ºæ¥åï¼ŒFront Bufferå°±è¢«æ”¾åˆ°äº¤æ¢é“¾çš„æœ«ç«¯ï¼Œå³å˜æˆå›¾ä¸­çš„Back Bufferï¼Œè€ŒBack Bufferå°±ä¼šå˜æˆäº¤æ¢é“¾ä¸­çš„Front Bufferã€‚è¿™ä¸ªè¿‡ç¨‹å°±å«åšpresentingã€‚å›¾1.5è¡¨ç¤ºäº†äº¤æ¢çš„æ•´ä¸ªè¿‡ç¨‹ã€‚ å›¾1.5 å› æ­¤ï¼Œæˆ‘ä»¬ç»˜å›¾ä»£ç çš„ç»“æ„å°±ä¼šåƒä¸‹é¢è¿™æ ·ï¼š1ï¼ Render to back buffer2ï¼ Present the back buffer3ï¼ Goto (1)1.3.6 æ·±åº¦ç¼“å†² æ·±åº¦ç¼“å†²ä¹Ÿæ˜¯ä¸€ä¸ªè¡¨é¢ï¼Œä½†å®ƒä¸æ˜¯ç”¨æ¥å­˜å‚¨å›¾åƒæ•°æ®çš„ï¼Œè€Œæ˜¯ç”¨æ¥è®°å½•åƒç´ çš„æ·±åº¦ä¿¡æ¯ã€‚å®ƒå°†ç¡®å®šå“ªä¸€ä¸ªåƒç´ æœ€åè¢«ç»˜åˆ¶å‡ºæ¥ã€‚æ‰€ä»¥ï¼Œå¦‚æœè¦ç»˜åˆ¶640480åˆ†è¾¨ç‡çš„å›¾ç‰‡ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰640480ä¸ªæ·±åº¦å€¼ã€‚ å›¾1.6å›¾1.6å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„åœºæ™¯ï¼Œåœ¨è¿™ä¸ªåœºæ™¯é‡Œï¼Œä¸€ä¸ªç‰©ä½“æŠŠå°†å¦ä¸€ä¸ªç‰©ä½“çš„ä¸€éƒ¨åˆ†é®ä½äº†ã€‚ä¸ºäº†ä½¿Direct3Dèƒ½ç¡®å®šç‰©ä½“çš„å‰åå…³ç³»å¹¶æ­£ç¡®çš„ç»˜åˆ¶å‡ºæ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ç§æ·±åº¦ç¼“å†²ï¼Œåˆå«åšz-bufferingçš„æŠ€æœ¯ã€‚ æ·±åº¦ç¼“å†²ä¸ºæ¯ä¸€ä¸ªåƒç´ è®¡ç®—æ·±åº¦å€¼ï¼Œå¹¶è¿›è¡Œæ·±åº¦æµ‹è¯•ã€‚é€šè¿‡æ·±åº¦æµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥æ¯”è¾ƒå‡ºå“ªä¸ªåƒç´ ç¦»ç…§ç›¸æœºæ›´è¿‘ï¼Œå¹¶å°†å®ƒç”»å‡ºæ¥ã€‚è¿™æ ·å°±å¯ä»¥åªç»˜åˆ¶æœ€é è¿‘ç…§ç›¸æœºçš„åƒç´ ï¼Œè¢«é®ä½çš„åƒç´ å°±ä¸ä¼šè¢«ç”»å‡ºæ¥ã€‚ æ·±åº¦ç¼“å†²çš„æ ¼å¼å†³å®šç€æ·±åº¦æµ‹è¯•çš„ç²¾ç¡®æ€§ã€‚ä¸€ä¸ª24ä½çš„æ·±åº¦ç¼“å†²æ¯”16ä½çš„æ·±åº¦ç¼“å†²æ›´ç²¾ç¡®ã€‚é€šå¸¸ï¼Œåº”ç”¨ç¨‹åºåœ¨24ä½æ·±åº¦ç¼“å†²ä¸‹å°±èƒ½å·¥ä½œçš„å¾ˆå¥½ï¼Œä½†æ˜¯Direct3Dä¹ŸåŒæ—¶æ”¯æŒ32ä½çš„æ·±åº¦ç¼“å†²ã€‚ D3DFMT_D32â€”â€”è¡¨ç¤º32ä½æ·±åº¦ç¼“å†² D3DFMT_D24S8â€”â€”è¡¨ç¤º24ä½æ·±åº¦ç¼“å†²å¹¶ä¿ç•™8ä½æ¨¡ç‰ˆç¼“å†²ï¼ˆstencil bufferï¼‰ D3DFMT_D24X8â€”â€”è¡¨ç¤º24ä½æ·±åº¦ç¼“å†² D3DFMT_D24X4S4â€”â€”è¡¨ç¤º24ä½æ·±åº¦ç¼“å†²å¹¶ä¿ç•™4ä½æ¨¡ç‰ˆç¼“å†² D3DFMT_D16â€”â€”è¡¨ç¤º16ä½æ·±åº¦ç¼“å†² æ³¨æ„ï¼šå…³äºæ¨¡ç‰ˆç¼“å†²çš„é—®é¢˜å°†åœ¨ç¬¬å…«ç« è¯¦ç»†è¯´æ˜ã€‚1.3.7 é¡¶ç‚¹å¤„ç† é¡¶ç‚¹æ˜¯3Då›¾å½¢å­¦çš„åŸºç¡€ï¼Œå®ƒèƒ½å¤Ÿé€šè¿‡ä¸¤ç§ä¸åŒçš„æ–¹æ³•è¢«å¤„ç†ï¼Œä¸€ç§æ˜¯è½¯ä»¶æ–¹å¼ï¼ˆsoftware vertex processingï¼‰ï¼Œä¸€ç§æ˜¯ç¡¬ä»¶æ–¹å¼ï¼ˆhardware vertex processingï¼‰ï¼Œå‰è€…æ€»æ˜¯è¢«æ”¯æŒä¸”æ°¸è¿œå¯ç”¨ï¼Œåè€…å¿…é¡»è¦æ˜¾å¡ç¡¬ä»¶æ”¯æŒé¡¶ç‚¹å¤„ç†æ‰å¯ç”¨ã€‚ ä½¿ç”¨ç¡¬ä»¶é¡¶ç‚¹å¤„ç†æ€»æ˜¯é¦–é€‰ï¼Œå› ä¸ºå®ƒæ¯”è½¯ä»¶æ–¹å¼æ›´å¿«ï¼Œè€Œä¸”ä¸å ç”¨CPUèµ„æºï¼Œè¿™æ„å‘³CPUè‡³å°‘å¯ä»¥æœ‰æ›´å¤šçš„ç©ºé—²æ—¶é—´è¿›è¡Œåˆ«çš„è®¡ç®—ã€‚æ³¨æ„ï¼šå¦‚æœä¸€å—æ˜¾å¡æ”¯æŒç¡¬ä»¶é¡¶ç‚¹å¤„ç†çš„è¯ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¹Ÿæ”¯æŒç¡¬ä»¶å‡ ä½•è½¬æ¢å’Œå…‰æºè®¡ç®—ã€‚1.3.8 è®¾å¤‡èƒ½åŠ› Direct3Dæ”¯æŒçš„æ¯ä¸€é¡¹ç‰¹æ€§éƒ½å¯¹åº”äºD3DCAPS9ç»“æ„çš„ä¸€ä¸ªæ•°æ®æˆå‘˜ã€‚åˆå§‹åŒ–ä¸€ä¸ªD3DCAPS9å®ä¾‹åº”è¯¥ä»¥ä½ çš„è®¾å¤‡å®é™…æ”¯æŒç‰¹æ€§ä¸ºåŸºç¡€ã€‚å› æ­¤ï¼Œåœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºé‡Œï¼Œæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡æ£€æµ‹D3DCAPS9ç»“æ„ä¸­ç›¸å¯¹åº”çš„æŸä¸€æˆå‘˜æ¥æ£€æµ‹è®¾å¤‡æ˜¯å¦æ”¯æŒè¿™ä¸€ç‰¹æ€§ã€‚ ä¸‹é¢å°†ä¸¾ä¾‹è¯´æ˜ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦æ£€æµ‹æ˜¾å¡æ˜¯å¦æ”¯æŒç¡¬ä»¶é¡¶ç‚¹å¤„ç†ï¼ˆæ¢å¥è¯è¯´ï¼Œå°±æ˜¯æ˜¾å¡æ˜¯å¦æ”¯æŒç¡¬ä»¶å‡ ä½•è½¬æ¢å’Œå…‰æºè®¡ç®—ï¼‰ã€‚é€šè¿‡æŸ¥é˜…SDKä¸­çš„D3DCAPS9ç»“æ„ï¼Œå¯ä»¥å¾—çŸ¥æ•°æ®æˆå‘˜D3DCAPS9::DevCapsä¸­çš„D3DDEVCAPS_HWTRANSFORMANDLIGHTä½è¡¨ç¤ºç¡¬ä»¶æ˜¯å¦æ”¯æŒç¡¬ä»¶é¡¶ç‚¹å¤„ç†å³ç¡¬ä»¶å‡ ä½•å˜æ¢å’Œå…‰æºè®¡ç®—ã€‚ç¨‹åºå¦‚ä¸‹ï¼š12345678910111213bool supportsHardwareVertexProcessing;// å¦‚æœä¸ºçœŸï¼Œæ„å‘³ç€ç¡¬ä»¶è®¾å¤‡æ”¯æŒå®ƒif( caps.DevCaps &amp; D3DDEVCAPS_HWTRANSFORMANDLIGHT )&#123; // æ”¯æŒ supportsHardwareVertexProcessing = true;&#125;else&#123; // ä¸æ”¯æŒ hardwareSupportsVertexProcessing = false;&#125; æ³¨æ„ï¼šDevCapså³ä¸ºâ€œdevice capabilitiesâ€ ä¸‹ä¸€èŠ‚å°†å­¦ä¹ æ€æ ·æ ¹æ®ç¡¬ä»¶çš„å®é™…æƒ…å†µæ¥åˆå§‹åŒ–D3DCAPS9 æˆ‘ä»¬å»ºè®®ä½ é˜…è¯»SDKä¸­å…³äºD3DCAPS9çš„ç»“æ„ï¼Œå®ƒå®Œæ•´çš„åˆ—å‡ºäº†Direct3Dæ”¯æŒçš„ç‰¹æ€§ã€‚1.4 åˆå§‹åŒ–Direct3D ä¸‹é¢å‡ ç‚¹è¯´æ˜æ€æ ·åˆå§‹åŒ–Direct3Dã€‚æ ¹æ®ä¸‹è¾¹çš„æ­¥éª¤ä½ èƒ½åˆå§‹åŒ–Direct3Dï¼š1ï¼ è·å¾—ä¸€ä¸ªIDirect3D9æ¥å£æŒ‡é’ˆã€‚è¿™ä¸ªæ¥å£ç”¨äºè·å¾—ç‰©ç†è®¾å¤‡çš„ä¿¡æ¯å’Œåˆ›å»ºä¸€ä¸ªIDirect3DDevice9æ¥å£ï¼Œå®ƒæ˜¯ä¸€ä¸ªä»£è¡¨æˆ‘ä»¬æ˜¾ç¤º3Då›¾å½¢çš„ç‰©ç†è®¾å¤‡çš„C++å¯¹è±¡ã€‚2ï¼ æ£€æŸ¥è®¾å¤‡èƒ½åŠ›ï¼ˆD3DCAPS9ï¼‰ï¼Œææ¸…æ¥šä¸»æ˜¾å¡æ˜¯å¦æ”¯æŒç¡¬ä»¶é¡¶ç‚¹å¤„ç†ã€‚æˆ‘ä»¬éœ€è¦çŸ¥é“å‡å¦‚å®ƒèƒ½æ”¯æŒï¼Œæˆ‘ä»¬å°±èƒ½åˆ›å»ºIDirect3DDevice9æ¥å£ã€‚3ï¼ åˆå§‹åŒ–ä¸€ä¸ªD3DPRESENT_PARAMETERSç»“æ„å®ä¾‹ï¼Œè¿™ä¸ªç»“æ„åŒ…å«äº†è®¸å¤šæ•°æ®æˆå‘˜å…è®¸æˆ‘ä»¬æŒ‡å®šå°†è¦åˆ›å»ºçš„IDirect3DDevice9æ¥å£çš„ç‰¹æ€§ã€‚4ï¼ åˆ›å»ºä¸€ä¸ªåŸºäºå·²ç»åˆå§‹åŒ–å¥½çš„D3DPRESENT_PARAMETERSç»“æ„çš„IDirect3DDevice9å¯¹è±¡ã€‚å®ƒæ˜¯ä¸€ä¸ªä»£è¡¨æˆ‘ä»¬æ˜¾ç¤º3Då›¾å½¢çš„ç‰©ç†è®¾å¤‡çš„C++å¯¹è±¡ã€‚è¯·æ³¨æ„ï¼Œæœ¬ä¹¦ä½¿ç”¨ä¸»æ˜¾ç¤ºè®¾å¤‡ç»˜åˆ¶3Då›¾å½¢ï¼Œå¦‚æœä½ çš„æœºå­åªæœ‰ä¸€å—æ˜¾å¡ï¼Œé‚£å®ƒå°±æ˜¯ä¸»æ˜¾ç¤ºè®¾å¤‡ã€‚å¦‚æœä½ æœ‰å¤šä¸ªæ˜¾å¡ï¼Œé‚£ä¹ˆä½ å½“å‰ä½¿ç”¨çš„æ˜¾å¡å°†ä¼šæˆä¸ºä¸»æ˜¾ç¤ºè®¾å¤‡ï¼ˆå¦‚ï¼šç”¨æ¥æ˜¾ç¤ºWindowsæ¡Œé¢çš„æ˜¾å¡ï¼‰ã€‚1.4.1è·å¾—IDirect3D9æ¥å£ Direct3Dçš„åˆå§‹åŒ–æ˜¯ä»è·å¾—ä¸€ä¸ªIDirect3D9æ¥å£æŒ‡é’ˆå¼€å§‹çš„ã€‚ä½¿ç”¨ä¸€ä¸ªä¸“é—¨çš„Direct3Då‡½æ•°æ¥å®Œæˆè¿™ä¸ªå·¥ä½œæ˜¯éå¸¸å®¹æ˜“çš„ï¼Œä»£ç å¦‚ä¸‹ï¼šIDirect3D9 _d3d9;_d3d9 = Direct3DCreate9(D3D_SDK_VERSION); Direct3DCreate9çš„å”¯ä¸€ä¸€ä¸ªå‚æ•°æ€»æ˜¯D3D_SDK_VERSIONï¼Œè¿™å¯ä»¥ä¿è¯åº”ç”¨ç¨‹åºé€šè¿‡æ­£ç¡®çš„å¤´æ–‡ä»¶è¢«ç”Ÿæˆã€‚å¦‚æœå‡½æ•°è°ƒç”¨å¤±è´¥ï¼Œé‚£ä¹ˆå®ƒå°†è¿”å›ä¸€ä¸ªç©ºæŒ‡é’ˆã€‚ IDirect3D9å¯¹è±¡é€šå¸¸æœ‰ä¸¤ä¸ªç”¨é€”ï¼šè®¾å¤‡åˆ—ä¸¾å’Œåˆ›å»ºIDirect3DDevice9å¯¹è±¡ã€‚è®¾å¤‡åˆ—ä¸¾å³ä¸ºæŸ¥æ˜ç³»ç»Ÿä¸­æ˜¾ç¤ºè®¾å¤‡çš„æŠ€æœ¯ç‰¹æ€§ï¼Œæ˜¾ç¤ºæ¨¡å¼ã€æ ¼å¼ï¼Œä»¥åŠå…¶å®ƒæ¯ä¸€ç§æ˜¾å¡å„è‡ªæ”¯æŒçš„ç‰¹æ€§ã€‚åˆ›å»ºä»£è¡¨ç‰©ç†è®¾å¤‡çš„IDirect3DDevice9å¯¹è±¡ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨è¿™ä¸ªç‰©ç†è®¾å¤‡çš„æ˜¾ç¤ºæ¨¡å¼ç»“æ„å’Œæ ¼å¼æ¥åˆ›å»ºå®ƒã€‚ä¸ºäº†æ‰¾åˆ°ä¸€ä¸ªå·¥ä½œé…ç½®ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨IDirect3D9çš„åˆ—ä¸¾æ–¹æ³•ã€‚ ç„¶è€Œï¼Œè®¾å¤‡åˆ—ä¸¾å®åœ¨å¤ªæ…¢äº†ï¼Œä¸ºäº†ä½¿Direct3Dè¿è¡Œå¾—å°½å¯èƒ½å¿«ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ä½¿ç”¨è¿™ä¸ªæµ‹è¯•ï¼Œé™¤äº†ä¸‹ä¸€èŠ‚æ‰€è°ˆåˆ°çš„ä¸€é¡¹æµ‹è¯•ã€‚ä¸ºäº†å®‰å…¨è·³è¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©æ€»æ˜¯è¢«æ‰€æœ‰æ˜¾å¡éƒ½æ”¯æŒçš„â€œå®‰å…¨â€é…ç½®ã€‚1.4.2 æ£€æµ‹ç¡¬ä»¶é¡¶ç‚¹å¤„ç† å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªIDirect3DDevice9å¯¹è±¡æ¥è¡¨ç¤ºä¸»æ˜¾ç¤ºè®¾å¤‡æ—¶ï¼Œå¿…é¡»è¦è®¾å®šå…¶é¡¶ç‚¹å¤„ç†çš„ç±»å‹ã€‚å¦‚æœå¯ä»¥çš„è¯ï¼Œå½“ç„¶è¦é€‰ç”¨ç¡¬ä»¶é¡¶ç‚¹å¤„ç†ï¼Œä½†æ˜¯ç”±äºå¹¶éæ‰€æœ‰æ˜¾å¡éƒ½æ”¯æŒç¡¬ä»¶é¡¶ç‚¹å¤„ç†ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»é¦–å…ˆæ£€æŸ¥æ˜¾å¡æ˜¯å¦æ”¯æŒã€‚ é¦–å…ˆæˆ‘ä»¬è¦æ ¹æ®ä¸»æ˜¾ç¤ºè®¾å¤‡çš„æŠ€æœ¯ç‰¹æ€§æ¥åˆå§‹åŒ–D3DCAPS9å®ä¾‹ã€‚å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼šHRESULT IDirect3D9::GetDeviceCaps( UINT Adapter, D3DDEVTYPE DeviceType, D3DCAPS9 pCaps); Adapterâ€”â€”æŒ‡å®šè¦è·å¾—å“ªä¸ªæ˜¾ç¤ºé€‚é…å™¨çš„ç‰¹æ€§ DeviceTypeâ€”â€”æŒ‡å®šè®¾å¤‡ç±»å‹ï¼ˆç¡¬ä»¶è®¾å¤‡ï¼ˆD3DDEVTYPE_HALï¼‰ï¼Œè½¯ä»¶è®¾å¤‡ï¼ˆD3DDEVTYPE_REFï¼‰ï¼‰ PCapsâ€”â€”è¿”å›ä¸€ä¸ªå·²åˆå§‹åŒ–çš„D3DCAPS9ç»“æ„ ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥è±¡1.3.8éƒ¨åˆ†é‚£æ ·æ£€æµ‹æ˜¾å¡çš„èƒ½åŠ›äº†ã€‚ä¸‹é¢å°±æ˜¯ä»£ç ç‰‡æ®µï¼š// å¡«å……ä¸»æ˜¾ç¤ºè®¾å¤‡çš„èƒ½åŠ›ï¼ˆD3DCAPS9ç»“æ„ï¼‰123456789101112131415161718D3DCAPS9 caps;d3d9-&gt;GetDeviceCaps( D3DADAPTER_DEFAULT, // ä¸»æ˜¾ç¤ºè®¾å¤‡ deviceType, // è®¾å¤‡ç±»å‹ï¼Œä¸€èˆ¬æ˜¯D3DDEVTYPE_HAL. &amp;caps); // è¿”å›å¡«å……åçš„D3DCAPS9 ç»“æ„ï¼ŒåŒ…å«ä¸»æ˜¾ç¤ºè®¾å¤‡çš„èƒ½åŠ›// æ˜¯å¦å¯ä»¥ä½¿ç”¨ç¡¬ä»¶é¡¶ç‚¹å¤„ç†?int vp = 0;if( caps.DevCaps &amp; D3DDEVCAPS_HWTRANSFORMANDLIGHT )&#123; // æ˜¯ï¼Œæ”¯æŒç¡¬ä»¶é¡¶ç‚¹å¤„ç† vp = D3DCREATE_HARDWARE_VERTEXPROCESSING;&#125;else&#123; // ä¸ï¼Œåªèƒ½ç”¨è½¯ä»¶é¡¶ç‚¹å¤„ç† vp = D3DCREATE_SOFTWARE_VERTEXPROCESSING;&#125; è§‚å¯Ÿä»£ç ï¼Œæˆ‘ä»¬ä½¿ç”¨å˜é‡vpæ¥å­˜å‚¨é¡¶ç‚¹å¤„ç†ç±»å‹ã€‚è¿™æ˜¯å› ä¸ºåœ¨ç¨ååˆ›å»ºIDirect3DDevice9å¯¹è±¡æ—¶è¦æ±‚æŒ‡å®šå…¶é¡¶ç‚¹å¤„ç†çš„ç±»å‹ã€‚æ³¨æ„ï¼šæ ‡è¯†ç¬¦D3DCREATE_HARDWARE_VERTEXPROCESSINGå’ŒD3DCREATE_SOFTWARE_VERTEXPROCESSINGæ˜¯é¢„å®šä¹‰çš„å€¼ï¼Œå®ƒä»¬åˆ†åˆ«ä»£è¡¨ç¡¬ä»¶é¡¶ç‚¹å¤„ç†å’Œè½¯ä»¶é¡¶ç‚¹å¤„ç†ã€‚ æŠ€å·§ï¼šè‹¥æˆ‘ä»¬å¼€å‘æœ‰ä¸€äº›æ–°çš„ï¼Œé«˜çº§ç‰¹æ€§çš„ç¨‹åºï¼Œåœ¨ä½¿ç”¨å‰æˆ‘ä»¬æ€»æ˜¯å…ˆæ£€æŸ¥ç¡¬ä»¶æ˜¯å¦æ”¯æŒè¿™äº›ç‰¹æ€§ã€‚æ³¨æ„ï¼šå¦‚æœä¸€ä¸ªåº”ç”¨ç¨‹åºåœ¨ä½ çš„æœºå­ä¸Šä¸èƒ½è¿è¡Œï¼Œè¯´æ˜å®ƒç”¨åˆ°çš„ä¸€äº›ç‰¹æ€§å¯èƒ½ä½ çš„æ˜¾å¡å¹¶ä¸æ”¯æŒï¼Œå¯ä»¥è¯•è¯•æŠŠè®¾å¤‡ç±»å‹æ¢æˆREFã€‚1.4.3 å¡«å……D3DPRESENT_PARAMETERSç»“æ„åˆå§‹åŒ–è¿‡ç¨‹çš„ä¸‹ä¸€æ­¥æ˜¯å¡«å……ä¸€ä¸ªD3DPRESENT_PARAMETERSç»“æ„çš„å®ä¾‹ã€‚è¿™ä¸ªç»“æ„ç”¨äºè®¾å®šæˆ‘ä»¬å°†è¦åˆ›å»ºçš„IDirect3DDevice9å¯¹è±¡çš„ä¸€äº›ç‰¹æ€§ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š12345678910111213141516typedef struct _D3DPRESENT_PARAMETERS_ &#123; UINT BackBufferWidth; UINT BackBufferHeight; D3DFORMAT BackBufferFormat; UINT BackBufferCount; D3DMULTISAMPLE_TYPE MultiSampleType; DWORD MultiSampleQuality; D3DSWAPEFFECT SwapEffect; HWND hDeviceWindow; BOOL Windowed; BOOL EnableAutoDepthStencil; D3DFORMAT AutoDepthStencilFormat; DWORD Flags; UINT FullScreen_RefreshRateInHz; UINT PresentationInterval;&#125; D3DPRESENT_PARAMETERS; ä¸‹é¢ä»‹ç»å…¶æ¯”è¾ƒé‡è¦çš„æ•°æ®æˆå‘˜ï¼Œè‡³äºæ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œè¯·æŸ¥é˜…SDKï¼šBackBufferWidthâ€”â€”åå¤‡ç¼“å†²è¡¨é¢çš„å®½åº¦ï¼ˆä»¥åƒç´ ä¸ºå•ä½ï¼‰BackBufferHeightâ€”â€”åå¤‡ç¼“å†²è¡¨é¢çš„é«˜åº¦ï¼ˆä»¥åƒç´ ä¸ºå•ä½ï¼‰BackBufferFormatâ€”â€”åå¤‡ç¼“å†²è¡¨é¢çš„åƒç´ æ ¼å¼ï¼ˆå¦‚ï¼š32ä½åƒç´ æ ¼å¼ä¸ºD3DFMTâ€”â€”A8R8G8B8ï¼‰BackBufferCountâ€”â€”åå¤‡ç¼“å†²è¡¨é¢çš„æ•°é‡ï¼Œé€šå¸¸è®¾ä¸ºâ€œ1â€ï¼Œå³åªæœ‰ä¸€ä¸ªåå¤‡è¡¨é¢MultiSampleTypeâ€”â€”å…¨å±æŠ—é”¯é½¿çš„ç±»å‹ï¼Œè¯¦æƒ…è¯·çœ‹SDKMultiSampleQualityâ€”â€”å…¨å±æŠ—é”¯é½¿çš„è´¨é‡ç­‰çº§ï¼Œè¯¦æƒ…çœ‹SDKSwapEffectâ€”â€”æŒ‡å®šè¡¨é¢åœ¨äº¤æ¢é“¾ä¸­æ˜¯å¦‚ä½•è¢«äº¤æ¢çš„ï¼Œå–D3DSWAPEFFECTæšä¸¾ç±»å‹ä¸­çš„ä¸€ä¸ªæˆå‘˜ã€‚å…¶ä¸­D3DSWAPEFFECT_DISCARDæ˜¯æœ€æœ‰æ•ˆçš„hDeviceWindowâ€”â€”ä¸è®¾å¤‡ç›¸å…³çš„çª—å£å¥æŸ„ï¼Œä½ æƒ³åœ¨å“ªä¸ªçª—å£ç»˜åˆ¶å°±å†™é‚£ä¸ªçª—å£çš„å¥æŸ„Windowedâ€”â€”BOOLå‹ï¼Œè®¾ä¸ºtrueåˆ™ä¸ºçª—å£æ¨¡å¼ï¼Œfalseåˆ™ä¸ºå…¨å±æ¨¡å¼EnableAutoDepthStencilâ€”â€”è®¾ä¸ºtrueï¼ŒD3Då°†è‡ªåŠ¨åˆ›å»ºæ·±åº¦/æ¨¡ç‰ˆç¼“å†²AutoDepthStencilFormatâ€”â€”æ·±åº¦/æ¨¡ç‰ˆç¼“å†²çš„æ ¼å¼Flagsâ€”â€”ä¸€äº›é™„åŠ ç‰¹æ€§ï¼Œè®¾ä¸º0æˆ–D3DPRESENTFLAGç±»å‹çš„ä¸€ä¸ªæˆå‘˜ã€‚ä¸‹åˆ—ä¸¤ä¸ªæœ€å¸¸ç”¨çš„æ ‡å¿—å…¨éƒ¨çš„æ ‡å¿—è¯·æŸ¥é˜…SDKï¼š D3DPRESENTFLAG_LOCKABLE_BACKBUFFERâ€”â€”è®¾å®šåå¤‡è¡¨é¢èƒ½å¤Ÿè¢«é”å®šï¼Œè¿™ä¼šé™ä½åº”ç”¨ç¨‹åºçš„æ€§èƒ½ D3DPRESENTFLAG_DISCARD_DEPTHSTENCILâ€”â€”æ·±åº¦/æ¨¡ç‰ˆç¼“å†²åœ¨è°ƒç”¨IDirect3DDevice9::presentæ–¹æ³•åå°†è¢«åˆ é™¤ï¼Œè¿™æœ‰åˆ©äºæå‡ç¨‹åºæ€§èƒ½FullScreen_RefreshRateInHzâ€”â€”åˆ·æ–°ç‡ï¼Œè®¾å®šD3DPRESENT_RATE_DEFAULTä½¿ç”¨é»˜è®¤åˆ·æ–°ç‡PresentationIntervalâ€”â€”å±äºD3DPRESENTæˆå‘˜ï¼Œåˆæœ‰ä¸¤ä¸ªå¸¸ç”¨æ ‡å¿—ï¼Œå…¶ä½™è¯·æŸ¥SDKï¼š D3DPRESENT_INTERVAL_IMMEDIATEâ€”â€”ç«‹å³äº¤æ¢ D3DPRESENT_INTERVAL_DEFAULTâ€”â€”D3Dé€‰æ‹©äº¤æ¢é€Ÿåº¦ï¼Œé€šå¸¸ç­‰äºåˆ·æ–°ç‡å¡«å……ç¤ºä¾‹å¦‚ä¸‹ï¼š123456789101112131415D3DPRESENT_PARAMETERS d3dpp;d3dpp.BackBufferWidth = 800;d3dpp.BackBufferHeight = 600;d3dpp.BackBufferFormat = D3DFMT_A8R8G8B8; //åƒç´ æ ¼å¼d3dpp.BackBufferCount = 1;d3dpp.MultiSampleType = D3DMULTISAMPLE_NONE;d3dpp.MultiSampleQuality = 0;d3dpp.SwapEffect = D3DSWAPEFFECT_DISCARD;d3dpp.hDeviceWindow = hwnd;d3dpp.Windowed = false; // fullscreend3dpp.EnableAutoDepthStencil = true;d3dpp.AutoDepthStencilFormat = D3DFMT_D24S8; // depth formatd3dpp.Flags = 0;d3dpp.FullScreen_RefreshRateInHz = D3DPRESENT_RATE_DEFAULT;d3dpp.PresentationInterval = D3DPRESENT_INTERVAL_IMMEDIATE; 1.4.4 åˆ›å»ºIDirect3DDevice9å¯¹è±¡ åœ¨å¡«å……å®Œäº†D3DPRESENT_PARAMETERSç»“æ„åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•åˆ›å»ºä¸€ä¸ªIDirect3DDevice9å¯¹è±¡äº†ï¼šHRESULT IDirect3D9::CreateDevice( UINT Adapter, D3DDEVTYPE DeviceType, HWND hFocusWindow, DWORD BehaviorFlags, D3DPRESENT_PARAMETERS pPresentationParameters, IDirect3DDevice9* ppReturnedDeviceInterface); Adapterâ€”â€”æŒ‡å®šå¯¹è±¡è¦è¡¨ç¤ºçš„ç‰©ç†æ˜¾ç¤ºè®¾å¤‡ DeviceTypeâ€”â€”è®¾å¤‡ç±»å‹ï¼Œå‰é¢è¯´è¿‡ hFocusWindowâ€”â€”åŒæˆ‘ä»¬åœ¨å‰é¢d3dpp.hDeviceWindowçš„ç›¸åŒ BehaviorFlagsâ€”â€”è®¾å®šä¸ºD3DCREATE_SOFTWARE_VERTEXPROCESSINGæˆ–è€…D3DCREATE_HARDWARE_VERTEXPROCESSING pPresentationParametersâ€”â€”æŒ‡å®šä¸€ä¸ªå·²ç»åˆå§‹åŒ–å¥½çš„D3DPRESENT_PARAMETERSå®ä¾‹ ppReturnedDeviceInterfaceâ€”â€”è¿”å›åˆ›å»ºçš„è®¾å¤‡ä¾‹å­ï¼š12345678910111213IDirect3DDevice9* device = 0;hr = d3d9-&gt;CreateDevice( D3DADAPTER_DEFAULT, // primary adapter D3DDEVTYPE_HAL, // device type hwnd, // window associated with device D3DCREATE_HARDWARE_VERTEXPROCESSING, // vertex processing type &amp;d3dpp, // present parameters &amp;device); // returned created deviceif( FAILED(hr) )&#123; ::MessageBox(0, "CreateDevice() - FAILED", 0, 0); return 0;&#125; 1.5 åˆå§‹åŒ–Direct3Då®ä¾‹åœ¨æœ¬ç« çš„ä¾‹ç¨‹ä¸­ï¼Œåˆå§‹åŒ–äº†ä¸€ä¸ªDirect3Dåº”ç”¨ç¨‹åºå¹¶ç”¨é»‘è‰²å¡«å……æ˜¾ç¤ºçª—å£ï¼ˆå¦‚å›¾1.7ï¼‰ã€‚ å›¾1.7 æœ¬ä¹¦æ‰€æœ‰çš„åº”ç”¨ç¨‹åºéƒ½åŒ…å«äº†d3dUtility.hå’Œd3dUtility.cppè¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œå®ƒä»¬æ‰€åŒ…å«çš„å‡½æ•°å®ç°äº†æ‰€æœ‰Direct3Dåº”ç”¨ç¨‹åºéƒ½è¦å»åšçš„ä¸€äº›å¸¸è§çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼šåˆ›å»ºä¸€ä¸ªçª—å£ã€åˆå§‹åŒ–Direct3Dã€è¿›å…¥ç¨‹åºçš„æ¶ˆæ¯å¾ªç¯ç­‰ã€‚å°†è¿™äº›åŠŸèƒ½å°è£…åœ¨å‡½æ•°ä¸­èƒ½ä½¿ç¤ºä¾‹ç¨‹åºæ›´åŠ çªå‡ºè¯¥ç« çš„ä¸»é¢˜ã€‚å¦å¤–ï¼Œåœ¨æˆ‘ä»¬å­¦ä¹ æœ¬ä¹¦çš„è¿‡ç¨‹ä¸­è¿˜ä¼šåœ¨è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸­åŠ ä¸Šä¸€äº›é€šç”¨çš„ä»£ç ã€‚ 1.5.1 d3dUtility.h/cpp åœ¨å¼€å§‹æœ¬ç« çš„ä¾‹ç¨‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆç†Ÿæ‚‰ä¸€ä¸‹d3dUtility.h/cppæ‰€æä¾›çš„å‡½æ•°ã€‚d3dUtility.hå¦‚ä¸‹ï¼š// åŒ…å«ä¸»è¦çš„Direct3DXå¤´æ–‡ä»¶ï¼Œè¿™å°†åŒ…å«æˆ‘ä»¬éœ€è¦çš„å¦å¤–çš„Direct3Då¤´æ–‡ä»¶12345678910111213141516171819202122232425262728293031323334353637#include &lt;d3dx9.h&gt;namespace d3d&#123; bool InitD3D( HINSTANCE hInstance, // [in] åº”ç”¨ç¨‹åºå®ä¾‹ int width, int height, // [in] Back bufferå°ºå¯¸ bool windowed, // [in] æ˜¯å¦å…¨å± D3DDEVTYPE deviceType, // [in] HAL æˆ– REF IDirect3DDevice9** device); // [out] åˆ›å»ºçš„è®¾å¤‡ int EnterMsgLoop( bool (*ptr_display)(float timeDelta)); LRESULT CALLBACK WndProc( HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam); template&lt;class T&gt; void Release(T t) &#123; if( t ) &#123; t-&gt;Release(); t = 0; &#125; &#125; template&lt;class T&gt; void Delete(T t) &#123; if( t ) &#123; delete t; t = 0; &#125; &#125;&#125; InitD3Dâ€”â€”åˆå§‹åŒ–ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸»çª—å£å¹¶è¿›è¡ŒDirect3Dçš„åˆå§‹åŒ–ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™è¾“å‡ºIDirect3DDevice9æ¥å£æŒ‡é’ˆã€‚ä»å®ƒçš„å‚æ•°æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè®¾ç½®çª—å£çš„å¤§å°å’Œä»¥çª—å£æ¨¡å¼è¿è¡Œè¿˜æ˜¯å…¨å±æ¨¡å¼è¿è¡Œã€‚è¦çŸ¥é“å®ƒå®ç°çš„ç»†èŠ‚ï¼Œè¯·çœ‹ç¤ºä¾‹ä»£ç ã€‚EnterMsgLoopâ€”â€”è¿™ä¸ªå‡½æ•°å°è£…äº†åº”ç”¨ç¨‹åºçš„æ¶ˆæ¯å¾ªç¯ã€‚å®ƒéœ€è¦è¾“å…¥ä¸€ä¸ªæ˜¾ç¤ºå‡½æ•°çš„å‡½æ•°æŒ‡é’ˆï¼Œæ˜¾ç¤ºå‡½æ•°ä¸ºç¨‹åºä¸­ç»˜åˆ¶å›¾å½¢çš„ä»£ç å—ï¼Œè¿™æ ·åšæ˜¯ä¸ºäº†ä½¿æ˜¾ç¤ºå‡½æ•°èƒ½å¤Ÿåœ¨ç©ºé—²çš„æ—¶å€™è¢«è°ƒç”¨å¹¶æ˜¾ç¤ºåœºæ™¯ï¼Œå®ƒçš„å®ç°å¦‚ä¸‹ï¼š1234567891011121314151617181920212223int d3d::EnterMsgLoop( bool (*ptr_display)(float timeDelta) )&#123; MSG msg; ::ZeroMemory(&amp;msg, sizeof(MSG)); static float lastTime = (float)timeGetTime(); while(msg.message != WM_QUIT) &#123; if(::PeekMessage(&amp;msg, 0, 0, 0, PM_REMOVE)) &#123; ::TranslateMessage(&amp;msg); ::DispatchMessage(&amp;msg); &#125; else &#123; float currTime = (float)timeGetTime(); float timeDelta = (currTime - lastTime)*0.001f; ptr_display(timeDelta); // call display function lastTime = currTime; &#125; &#125; return msg.wParam;&#125; ä¸â€œtimeâ€æœ‰å…³çš„ä»£ç ç”¨äºè®¡ç®—æ¯æ¬¡è°ƒç”¨æ˜¾ç¤ºå‡½æ•°çš„æ—¶é—´é—´éš”ï¼Œå³æ˜¯æ¯å¸§çš„æ—¶é—´ã€‚Releaseâ€”â€”è¿™ä¸ªæ¨¡ç‰ˆå‡½æ•°èƒ½æ–¹ä¾¿çš„é‡Šæ”¾COMæ¥å£å¹¶å°†å®ƒä»¬çš„å€¼è®¾ä¸ºNULLDeleteâ€”â€”è¿™ä¸ªæ¨¡ç‰ˆå‡½æ•°èƒ½æ–¹ä¾¿çš„åˆ é™¤ä¸€ä¸ªå¯¹è±¡å¹¶å°†æŒ‡å‘å…¶çš„æŒ‡é’ˆè®¾ä¸ºNULLWndProcâ€”â€”åº”ç”¨ç¨‹åºä¸»çª—å£çš„å›è°ƒå‡½æ•°1.5.2 å®ä¾‹æ¡†æ¶ é€šè¿‡å®ä¾‹æ¡†æ¶ï¼Œæˆ‘ä»¬å½¢æˆäº†ä¸€ç§é€šç”¨çš„æ–¹æ³•å»æ„é€ æœ¬ä¹¦çš„ç¤ºä¾‹ç¨‹åºã€‚æ¯ä¸€ä¸ªä¾‹ç¨‹éƒ½å«æœ‰ä¸‰ä¸ªå‡½æ•°çš„å®ç°ï¼Œå½“ç„¶è¿™ä¸åŒ…æ‹¬å›è°ƒå‡½æ•°å’ŒWinMainä¸»å‡½æ•°ã€‚è¿™ä¸‰ä¸ªå‡½æ•°ç”¨ç‰¹å®šçš„ä»£ç å®ç°ç‰¹å®šçš„åŠŸèƒ½ã€‚è¿™ä¸‰ä¸ªå‡½æ•°æ˜¯ï¼š bool Setup()â€”â€”åœ¨è¿™ä¸ªå‡½æ•°é‡Œï¼Œæˆ‘ä»¬å°†å‡†å¤‡ä¸€åˆ‡è¯¥ç¨‹åºéœ€è¦ç”¨åˆ°çš„ä¸œè¥¿ï¼ŒåŒ…æ‹¬èµ„æºçš„åˆ†é…ï¼Œæ£€æŸ¥è®¾å¤‡èƒ½åŠ›ï¼Œè®¾ç½®åº”ç”¨ç¨‹åºçš„çŠ¶æ€ void Clearup()â€”â€”è¿™ä¸ªå‡½æ•°å°†é‡Šæ”¾Setup()ä¸­åˆ†é…çš„èµ„æºï¼Œå¦‚åˆ†é…çš„å†…å­˜ã€‚ bool Display(float timeDelta)â€”â€”è¿™ä¸ªå‡½æ•°åŒ…å«æ‰€æœ‰ä¸æˆ‘ä»¬ç»˜å›¾å’Œæ˜¾ç¤ºæœ‰å…³çš„ä»£ç ã€‚å‚æ•°timeDeltaä¸ºæ¯ä¸€å¸§çš„é—´éš”æ—¶é—´ï¼Œç”¨æ¥æ§åˆ¶æ¯ç§’çš„å¸§æ•°ã€‚1.5.3 D3D Initå®ä¾‹ è¿™ä¸ªç¤ºä¾‹ç¨‹åºå°†åˆ›å»ºå¹¶åˆå§‹åŒ–ä¸€ä¸ªDirect3Dåº”ç”¨ç¨‹åºï¼Œå¹¶ç”¨é»‘è‰²å¡«å……å±å¹•ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†é€šç”¨å‡½æ•°ç®€åŒ–äº†åˆå§‹åŒ–è¿‡ç¨‹ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬è¦åŒ…å«d3dUtility.hå¤´æ–‡ä»¶ï¼Œå¹¶ä¸ºè®¾å¤‡å£°æ˜ä¸€ä¸ªå…¨å±€å˜é‡ï¼šinclude â€œd3dUtility.hâ€ IDirect3DDevice9* Device = 0; ç„¶åå®ç°æˆ‘ä»¬çš„æ¡†æ¶å‡½æ•°ï¼š123456789bool Setup()&#123; return true;&#125;void Cleanup()&#123;&#125; åœ¨è¿™ä¸ªç¨‹åºä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨ä»»ä½•èµ„æºæˆ–è§¦å‘ä»»ä½•äº‹ä»¶ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªå‡½æ•°éƒ½ä¸ºç©ºã€‚12345678910bool Display(float timeDelta)&#123; if( Device ) &#123; Device-&gt;Clear(0, 0, D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER, 0x00000000, 1.0f, 0); Device-&gt;Present(0, 0, 0, 0); // é¡µé¢åˆ‡æ¢ &#125; return true;&#125; Displayæ–¹æ³•è°ƒç”¨äº†IDirect3DDevice::Clearæ–¹æ³•ï¼Œåˆ†åˆ«ç”¨é»‘è‰²å’Œ1.0å¡«å……åå¤‡è¡¨é¢å’Œæ·±åº¦/æ¨¡ç‰ˆç¼“å†²ã€‚å¦‚æœåº”ç”¨ç¨‹åºä¸åœæ­¢çš„è¯ï¼Œæˆ‘ä»¬ä¼šä¸€ç›´æ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚IDirect3DDevice::Clearå£°æ˜å¦‚ä¸‹ï¼š12345678HRESULT IDirect3DDevice9::Clear( DWORD Count, const D3DRECT* pRects, DWORD Flags, D3DCOLOR Color, float Z, DWORD Stencil); Countâ€”â€”pRectsç»„ä¸­çš„çŸ©å½¢çš„ä¸ªæ•° pRectsâ€”â€”å°†è¦æ¸…é™¤çš„å±å¹•çŸ©å½¢çš„æ•°ç»„ï¼Œè¿™ä½¿æˆ‘ä»¬å¯ä»¥æ¸…é™¤å±å¹•çš„æŸä¸€éƒ¨åˆ† Flagsâ€”â€”æŒ‡å®šåœ¨å“ªäº›è¡¨é¢ä¸Šæ‰§è¡Œæ¸…é™¤è¡¨é¢çš„æ“ä½œ D3DCLEAR_TARGETâ€”â€”ç›®çš„è¡¨é¢ï¼Œé€šå¸¸ä¸ºåå¤‡è¡¨é¢ D3DCLEAR_ZBUFFERâ€”â€”æ·±åº¦ç¼“å†² D3DCLEAR_STENCILâ€”â€”æ¨¡ç‰ˆç¼“å†² Colorâ€”â€”ä½¿ç”¨ä»€ä¹ˆé¢œè‰²å¡«å……æ¸…é™¤çš„è¡¨é¢ Zâ€”â€”è®¾ç½®æ·±åº¦ç¼“å†²çš„å€¼ Stencilâ€”â€”è®¾ç½®æ¨¡ç‰ˆç¼“å†²çš„å€¼ å±å¹•è¢«å¡«å……åï¼Œè¦è°ƒç”¨IDirecte3DDevice9::Presentæ–¹æ³•è¿›è¡Œåå¤‡è¡¨é¢çš„äº¤æ¢ã€‚ Windows å›è°ƒå‡½æ•°ä¸ºä¸€ç»„äº‹ä»¶é›†ï¼Œå³ï¼Œæˆ‘ä»¬å¯æŒ‰ESCé”®è®©ç¨‹åºé€€å‡ºã€‚123456789101112131415LRESULT CALLBACK d3d::WndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)&#123; switch( msg ) &#123; case WM_DESTROY: ::PostQuitMessage(0); break; case WM_KEYDOWN: if( wParam == VK_ESCAPE ) ::DestroyWindow(hwnd); break; &#125; return ::DefWindowProc(hwnd, msg, wParam, lParam);&#125; æœ€åï¼ŒWinMainæŒ‰å¦‚ä¸‹æ­¥éª¤è¿è¡Œï¼š åˆå§‹åŒ–ä¸»æ˜¾ç¤ºçª—å£å’ŒDirect3D è°ƒç”¨Setupè¿›è¡Œç¨‹åºçš„å‡†å¤‡å·¥ä½œ ä½¿ç”¨Displayå‡½æ•°ä½œä¸ºå‚æ•°è¿›å…¥æ¶ˆæ¯å¾ªç¯ æ¸…é™¤åº”ç”¨ç¨‹åºæœ€åé‡Šæ”¾IDirecte3DDevice9å¯¹è±¡123456789101112131415161718192021int WINAPI WinMain(HINSTANCE hinstance, HINSTANCE prevInstance, PSTR cmdLine,int showCmd)&#123; if(!d3d::InitD3D(hinstance, 800, 600, true, D3DDEVTYPE_HAL, &amp;Device)) &#123; ::MessageBox(0, "InitD3D() - FAILED", 0, 0); return 0; &#125; if(!Setup()) &#123; ::MessageBox(0, "Setup() - FAILED", 0, 0); return 0; &#125; d3d::EnterMsgLoop( Display ); Cleanup(); Device-&gt;Release(); return 0;&#125; å°±åƒä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬çš„ä¾‹ç¨‹çš„æ¨¡æ¿ç»“æ„æ˜¯ç›¸å½“ç®€æ´çš„ï¼šæœ‰æ•ˆçš„æ“ä½œçª—å£å‡½æ•°ã€ Direct3Dçš„åˆå§‹åŒ–è¿‡ç¨‹ã€‚è¿™æœ¬ä¹¦ä¸­çš„å¤§éƒ¨åˆ†ç¨‹åºï¼Œéƒ½æ˜¯é€šè¿‡æ‰§è¡ŒSetup, Cleanup, å’ŒDisplayè¿™ä¸‰ä¸ªå‡½æ•°æ¥å®ç°ã€‚ æ³¨æ„ï¼šä¸è¦å¿˜äº†åœ¨ä½ çš„å·¥ç¨‹ä¸­åŠ å…¥d3d9.libã€d3dx9.libã€winmm.lib è¿™ä¸‰ä¸ªåº“ï¼ ç¬¬äºŒç«  æ¸²æŸ“ç®¡çº¿(The Rendering Pipeline) æœ¬ç« çš„ä¸»é¢˜æ˜¯æ¸²æŸ“ç®¡çº¿ã€‚å®ƒæ˜¯ç”¨æ¥åˆ›å»ºä¸º3Dä¸–ç•Œè¿›è¡Œå‡ ä½•æè¿°çš„2Då›¾å½¢å¹¶è®¾å®šä¸€ä¸ªè™šæ‹Ÿç…§ç›¸æœºç¡®å®šè¿™ä¸ªä¸–ç•Œä¸­å“ªä¸€éƒ¨åˆ†å°†è¢«é€è§†æŠ•å½±åˆ°å±å¹•ä¸Šã€‚ å›¾2.1ç›®æ ‡ è¦å¼„æ¸…æ¥šæˆ‘ä»¬æ€æ ·åœ¨Direct3Dä¸­è¡¨ç¤º3Dç‰©ä½“ å­¦ä¹ æ€æ ·æ¨¡æ‹Ÿè™šæ‹Ÿç…§ç›¸æœº å¼„æ‡‚æ¸²æŸ“ç®¡çº¿â€”â€”è¿™ä¸ªè¿‡ç¨‹æ˜¯ç”¨å‡ ä½•å­¦æ¥è¡¨ç°3Dåœºæ™¯å’Œç”¨å®ƒæ¥äº§ç”Ÿ2Då›¾è±¡ã€‚2.1è¡¨ç°æ¨¡å‹ ä¸€ä¸ªåœºæ™¯æ˜¯å¤šä¸ªç‰©ä½“æˆ–æ¨¡å‹çš„é›†åˆã€‚ä¸€ä¸ªç‰©ä½“å¯ä»¥ç”¨ä¸‰è§’å½¢ç½‘æ ¼ï¼ˆtriangle meshï¼‰æ¥è¿‘ä¼¼è¡¨ç¤ºï¼Œå¦‚å›¾2.2æ‰€ç¤ºã€‚ç”±ä¸‰è§’å½¢ç½‘æ ¼å»ºç«‹ä¸€ä¸ªç‰©ä½“ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå»ºæ¨¡ã€‚3Dä¸–ç•Œä¸­æœ€åŸºæœ¬çš„å›¾å…ƒå°±æ˜¯ä¸‰è§’å½¢ï¼Œä½†æ˜¯Direct3Dä¹Ÿæ”¯æŒç‚¹å›¾å…ƒå’Œçº¿å›¾å…ƒä½†æˆ‘ä»¬éƒ½ä¸å¸¸ç”¨åˆ°ã€‚ä¸è¿‡åœ¨å­¦åˆ°ç¬¬14ç« çš„ç²’å­ç³»ç»Ÿçš„æ—¶å€™ï¼Œå°†ä¼šç”¨åˆ°ç‚¹å›¾å…ƒã€‚ å›¾2.2 ä¸€ä¸ªå¤šè¾¹å½¢çš„ä¸¤è¾¹ç›¸äº¤çš„ç‚¹å«åšé¡¶ç‚¹ã€‚ä¸ºäº†æè¿°ä¸€ä¸ªä¸‰è§’å½¢ï¼Œæˆ‘ä»¬é€šå¸¸æŒ‡å®šä¸‰ä¸ªç‚¹çš„ä½ç½®æ¥å¯¹åº”ä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹ï¼ˆå¦‚å›¾2.3ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å¤Ÿå¾ˆæ˜ç¡®çš„è¡¨ç¤ºå‡ºè¿™ä¸ªä¸‰è§’å½¢äº†ã€‚ å›¾2.32.1.1 é¡¶ç‚¹æ ¼å¼ æˆ‘ä»¬ä»¥å‰å®šä¹‰çš„ç‚¹åœ¨æ•°å­¦ä¸Šæ¥è¯´æ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯å½“æˆ‘ä»¬åœ¨Direct3Dç¯å¢ƒä¸­ä½¿ç”¨å®ƒçš„æ—¶å€™å°±ä¼šè§‰å¾—å¾ˆä¸å®Œå–„ã€‚è¿™æ˜¯å› ä¸ºåœ¨Direct3Dä¸­çš„é¡¶ç‚¹åŒ…å«äº†è®¸å¤šé™„åŠ çš„å±æ€§ï¼Œè€Œä¸å†å•çº¯çš„åªæœ‰ç©ºé—´ä½ç½®çš„ä¿¡æ¯äº†ã€‚ä¾‹å¦‚ï¼šä¸€ä¸ªé¡¶ç‚¹å¯ä»¥æœ‰é¢œè‰²å’Œæ³•çº¿å‘é‡å±æ€§ï¼ˆè¿™ä¸¤ä¸ªå±æ€§åˆ†åˆ«åœ¨ç¬¬å››ç« å’Œç¬¬äº”ç« ä»‹ç»ï¼‰ã€‚Direct3Dè®©æˆ‘ä»¬å¯ä»¥çµæ´»çš„æ„é€ è‡ªå·±çš„é¡¶ç‚¹æ ¼å¼ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®šä¹‰é¡¶ç‚¹çš„æˆå‘˜ã€‚ ä¸ºäº†åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„é¡¶ç‚¹ç»“æ„ï¼Œæˆ‘ä»¬é¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªåŒ…å«èƒ½å­˜æ”¾æˆ‘ä»¬é€‰æ‹©çš„é¡¶ç‚¹æ•°æ®çš„ç»“æ„ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢æˆ‘ä»¬ä¸¾å‡ºä¸¤ç§ä¸åŒé¡¶ç‚¹æ•°æ®ç±»å‹çš„ä¾‹å­ï¼Œä¸€ç§åŒ…å«äº†ä½ç½®å’Œé¢œè‰²ä¿¡æ¯ï¼Œç¬¬äºŒç§åˆ™åŒ…å«äº†ä½ç½®ï¼Œæ³•çº¿å‘é‡ï¼Œçº¹ç†åæ ‡ä¿¡æ¯ï¼ˆâ€œçº¹ç†â€è§ç¬¬å…­ç« ï¼‰ã€‚123456789101112struct ColorVertex&#123; float _x, _y, _z; // ä½ç½® DWORD _color; // é¢œè‰²&#125;;struct NormalTexVertex&#123; float _x, _y, _z; // ä½ç½® float _nx, _ny, _nz; // æ³•çº¿å‘é‡ float _u, _v; // çº¹ç†åæ ‡&#125;; ä¸€æ—¦æˆ‘ä»¬æœ‰äº†å®Œæ•´çš„é¡¶ç‚¹æ ¼å¼ï¼Œæˆ‘ä»¬å°±è¦ä½¿ç”¨çµæ´»é¡¶ç‚¹æ ¼å¼ï¼ˆFVFï¼‰çš„ç»„åˆæ ‡å¿—æ¥æè¿°å®ƒã€‚ä¾‹å¦‚ç¬¬ä¸€ä¸ªé¡¶ç‚¹ç»“æ„ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨å¦‚ä¸‹çš„é¡¶ç‚¹æ ¼å¼ï¼š define FVF_COLOR (D3DFVF_XYZ | D3DFVF_DIFFUSE) ä¸Šé¢çš„é¡¶ç‚¹ç»“æ„è¡¨æ˜å®ƒåŒ…å«ä½ç½®å’Œé¢œè‰²å±æ€§ã€‚ è€Œç¬¬äºŒç§ç»“æ„åˆ™è¦ä½¿ç”¨ï¼š define FVF_NORMAL_TEX (D3DFVF_XYZ | D3DFVF_NORMAL | D3DFVF_TEX1) ä¸Šé¢çš„é¡¶ç‚¹ç»“æ„è¡¨æ˜å®ƒåŒ…å«äº†ä½ç½®ï¼Œæ³•çº¿å‘é‡ï¼Œçº¹ç†åæ ‡çš„å±æ€§ï¼ˆè¿™äº›å¸¸é‡æ˜¯D3Då†…ç½®çš„ï¼‰ã€‚ æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œä½ çš„æ ‡å¿—çš„é¡ºåºå¿…é¡»è¦å’Œä½ çš„é¡¶ç‚¹ç»“æ„çš„é¡ºåºä¸€ä¸€å¯¹åº”ã€‚å¦‚æœæƒ³çŸ¥é“æ‰€æœ‰çš„D3DFVFæ ‡å¿—ï¼Œè¯·æŸ¥é˜…SDKæ–‡æ¡£ã€‚2.1.2 ä¸‰è§’å½¢ ä¸‰è§’å½¢æ˜¯æ„å»º3Dç‰©ä½“çš„åŸºæœ¬å›¾å½¢ã€‚ä¸ºäº†æ„é€ ç‰©ä½“ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸‰è§’å½¢åˆ—è¡¨ï¼ˆtriangle listï¼‰æ¥æè¿°ç‰©ä½“çš„å½¢çŠ¶å’Œè½®å»“ã€‚ä¸‰è§’å½¢åˆ—åŒ…å«äº†æˆ‘ä»¬å°†è¦ç”»çš„æ¯ä¸€ä¸ªä¸‰è§’å½¢çš„æ•°æ®ä¿¡æ¯ã€‚ä¾‹å¦‚ä¸ºäº†æ„é€ ä¸€ä¸ªçŸ©å½¢ï¼Œæˆ‘ä»¬æŠŠå®ƒåˆ†æˆä¸¤ä¸ªä¸‰è§’å½¢ï¼Œå¦‚å›¾2.4æ‰€ç¤ºï¼Œæœ€åæŒ‡å®šæ¯ä¸ªä¸‰è§’å½¢çš„é¡¶ç‚¹ã€‚ å›¾2.4Vertex rect[6] = {v0, v1, v2, // ä¸‰è§’å½¢0 v0, v2, v3}; // ä¸‰è§’å½¢1æ³¨æ„ï¼šæŒ‡å®šä¸‰è§’å½¢é¡¶ç‚¹çš„é¡ºåºæ˜¯å¾ˆé‡è¦çš„ï¼Œå°†ä¼šæŒ‰ä¸€å®šé¡ºåºç¯ç»•æ’åˆ—ï¼Œè¿™ä¼šåœ¨2.3.4èŠ‚å­¦ä¹ ç›¸å…³çš„å†…å®¹ã€‚2.1.3 ç´¢å¼• 3Dç‰©ä½“ä¸­çš„ä¸‰è§’å½¢ç»å¸¸ä¼šæœ‰è®¸å¤šå…±ç”¨é¡¶ç‚¹ã€‚å¦‚å›¾2.4æ‰€è¡¨ç¤ºçš„çŸ©å½¢ã€‚è™½ç„¶ç°åœ¨ä»…æœ‰ä¸¤ä¸ªç‚¹è¢«é‡å¤ä½¿ç”¨ï¼Œä½†æ˜¯å½“è¦è¡¨ç°ä¸€ä¸ªæ›´ç²¾ç»†æ›´å¤æ‚çš„æ¨¡å‹çš„æ—¶å€™ï¼Œé‡å¤çš„é¡¶ç‚¹æ•°å°†ä¼šå˜å¾—å¾ˆå¤§ã€‚ä¾‹å¦‚å›¾2.5æ‰€ç¤ºçš„ç«‹æ–¹ä½“ï¼Œä»…æœ‰å…«ä¸ªé¡¶ç‚¹ï¼Œä½†æ˜¯å½“ç”¨ä¸‰è§’å½¢åˆ—è¡¨ç¤ºå®ƒçš„æ—¶å€™ï¼Œæ‰€æœ‰çš„ç‚¹éƒ½è¢«é‡å¤ä½¿ç”¨ã€‚ å›¾2.5 ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥ç´¢å¼•ï¼ˆindicesï¼‰è¿™ä¸ªæ¦‚å¿µã€‚å®ƒçš„å·¥ä½œæ–¹å¼æ˜¯ï¼šæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªé¡¶ç‚¹åˆ—è¡¨å’Œä¸€ä¸ªç´¢å¼•åˆ—è¡¨ï¼ˆindex listï¼‰ã€‚é¡¶ç‚¹åˆ—è¡¨åŒ…å«æ‰€æœ‰ä¸é‡å¤çš„é¡¶ç‚¹ï¼Œç´¢å¼•åˆ—ä¸­åˆ™ç”¨é¡¶ç‚¹åˆ—ä¸­å®šä¹‰çš„å€¼æ¥è¡¨ç¤ºæ¯ä¸€ä¸ªä¸‰è§’å½¢çš„æ„é€ æ–¹å¼ã€‚å›åˆ°é‚£ä¸ªçŸ©å½¢çš„ç¤ºä¾‹ä¸Šæ¥ï¼Œå®ƒçš„é¡¶ç‚¹åˆ—è¡¨çš„æ„é€ æ–¹å¼å¦‚ä¸‹ï¼šVertex vertexList[4] = {v0, v1, v2, v3}; ç´¢å¼•åˆ—è¡¨åˆ™å®šä¹‰é¡¶ç‚¹åˆ—ä¸­çš„é¡¶ç‚¹æ˜¯å¦‚ä½•æ„é€ è¿™ä¸¤ä¸ªä¸‰è§’å½¢çš„ï¼šWORD indexList[6] = {0, 1, 2, //ä¸‰è§’å½¢0 0, 2, 3}; //ä¸‰è§’å½¢1 ä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨é¡¶ç‚¹åˆ—è¡¨ä¸­çš„0ï¼ˆvertexList[0]ï¼‰ã€1ï¼ˆvertexList[1]ï¼‰å’Œ2ï¼ˆvertexList[2]ï¼‰é¡¶ç‚¹æ„æˆä¸‰è§’å½¢0ï¼›ç”¨é¡¶ç‚¹åˆ—è¡¨ä¸­çš„0ï¼ˆvertexList[0]ï¼‰ã€2ï¼ˆvertexList[2]ï¼‰å’Œ3ï¼ˆvertexList[3]ï¼‰é¡¶ç‚¹æ„æˆä¸‰è§’å½¢1ã€‚ 2.2è™šæ‹Ÿç…§ç›¸æœº ç…§ç›¸æœºç¡®å®š3Dä¸–ç•Œä¸­çš„å“ªéƒ¨åˆ†æ˜¯å¯è§çš„ï¼Œå› è€Œéœ€è¦å°†å“ªéƒ¨åˆ†è½¬æ¢ä¸º2Då›¾å½¢ã€‚åœ¨3Dä¸–ç•Œä¸­ç…§ç›¸æœºè¢«æ”¾ç½®å’Œå®šå‘ï¼Œå¹¶ä¸”å®šä¹‰å…¶å¯è§†ä½“ï¼Œå›¾2.6å±•ç¤ºäº†æˆ‘ä»¬çš„ç…§ç›¸æœºæ¨¡å‹ã€‚ å›¾2.6 å¯è§†ä½“æ˜¯ç”±å¯è§†è§’åº¦å’Œå‰è£å‰ªé¢ï¼ˆNear Planeï¼‰ä¸åè£å‰ªé¢ï¼ˆFar Planeï¼‰å®šä¹‰çš„ä¸€ä¸ªå¹³æˆªå¤´ä½“ã€‚ä¹‹æ‰€ä»¥è¦é€‰æ‹©å¹³æˆªå¤´ä½“æ„é€ å¯è§†ä½“ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬çš„æ˜¾ç¤ºå™¨éƒ½æ˜¯çŸ©å½¢çš„ã€‚åœ¨å¯è§†ä½“ä¸­ä¸èƒ½è¢«çœ‹è§çš„ç‰©ä½“éƒ½ä¼šè¢«åˆ é™¤ï¼Œåˆ é™¤è¿™ç§æ•°æ®çš„è¿‡ç¨‹å°±å«åšâ€œè£å‰ªâ€ã€‚ æŠ•å½±çª—å£ï¼ˆProjection Windowï¼‰æ˜¯å¯è§†ä½“å†…çš„3Då‡ ä½•å›¾å½¢æŠ•å½±ç”Ÿæˆçš„ç”¨æ¥æ˜¾ç¤º3Dåœºæ™¯çš„2Då›¾åƒçš„2DåŒºåŸŸã€‚é‡è¦çš„æ˜¯è¦çŸ¥é“ï¼Œæˆ‘ä»¬ä½¿ç”¨min=(-1,-1)å’Œmax=(1,1)æ¥å®šä¹‰æŠ•å½±çª—å£çš„å¤§å°ã€‚ ä¸ºäº†ç®€åŒ–æœ¬ä¹¦æ¥ä¸‹æ¥çš„éƒ¨åˆ†ç»˜åˆ¶ï¼Œæˆ‘ä»¬ä½¿å‰è£å‰ªé¢ä¸æŠ•å½±çª—å£åœ¨åŒä¸€å¹³é¢ä¸Šã€‚å¹¶ä¸”ï¼Œæ³¨æ„Direct3Dä¸­å®šä¹‰çš„æŠ•å½±å¹³é¢ï¼ˆå³æŠ•å½±çª—å£æ‰€åœ¨çš„å¹³é¢ï¼‰æ˜¯Z = 1çš„å¹³é¢ã€‚ 2.3 æ¸²æŸ“ç®¡çº¿ä¸€æ—¦æˆ‘ä»¬æè¿°å‡ ä½•å­¦ä¸Šçš„3Dåœºæ™¯å’Œè®¾ç½®äº†è™šæ‹Ÿç…§ç›¸æœºï¼Œæˆ‘ä»¬è¦æŠŠè¿™ä¸ªåœºæ™¯è½¬æ¢æˆ2Då›¾è±¡æ˜¾ç¤ºåœ¨æ˜¾ç¤ºå™¨ä¸Šã€‚è¿™ä¸€ç³»åˆ—å¿…é¡»å®Œæˆçš„æ“ä½œå°±å«åšæ¸²æŸ“ç®¡çº¿ã€‚å›¾2.7å±•ç¤ºäº†ä¸€ä¸ªç®€åŒ–çš„æ¸²æŸ“ç®¡çº¿ï¼Œéšåå°†è¯¦ç»†è§£é‡Šå›¾ä¸­çš„æ¯ä¸€éƒ¨åˆ†ã€‚ å›¾2.7æ¸²æŸ“ç®¡çº¿ä¸­çš„è®¸å¤šçº§éƒ½æ˜¯ä»ä¸€ä¸ªåæ ‡ç³»åˆ°å¦ä¸€ä¸ªåæ ‡çš„å‡ ä½•å˜æ¢ã€‚è¿™äº›å˜æ¢éƒ½é€šè¿‡çŸ©é˜µå˜æ¢æ¥å®ç°ã€‚Direct3Dä¸ºæˆ‘ä»¬è¿›è¡Œå˜æ¢è®¡ç®—å¹¶ä¸”å¦‚æœæ˜¾å¡æ”¯æŒç¡¬ä»¶å˜æ¢çš„è¯é‚£å°±æ›´æœ‰åˆ©äº†ã€‚ä½¿ç”¨Direct3Dè¿›è¡ŒçŸ©é˜µå˜æ¢ï¼Œæˆ‘ä»¬å”¯ä¸€è¦åšçš„äº‹å°±æ˜¯æä¾›ä»ä¸€ä¸ªç³»ç»Ÿå˜æ¢åˆ°å¦ä¸€ä¸ªç³»ç»Ÿçš„å˜æ¢çŸ©é˜µå°±å¯ä»¥äº†ã€‚æˆ‘ä»¬ä½¿ç”¨IDirect3DDevice9::SetTranformæ–¹æ³•æä¾›å˜æ¢çŸ©é˜µã€‚å®ƒè¾“å…¥ä¸€ä¸ªè¡¨ç¤ºå˜æ¢ç±»å‹çš„å‚æ•°å’Œä¸€ä¸ªå˜æ¢çŸ©é˜µã€‚å¦‚å›¾2.7æ‰€ç¤ºï¼Œä¸ºäº†è¿›è¡Œä¸€ä¸ªä»è‡ªèº«åæ ‡ç³»åˆ°ä¸–ç•Œåæ ‡ç³»çš„å˜æ¢ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼šDevice-&gt;SetTransform(D3DTS_WORLD, &amp;worldMatrix); 2.3.1è‡ªèº«åæ ‡ç³»ï¼ˆLocal Spaceï¼‰ è‡ªèº«åæ ‡ç³»åˆå«åšå»ºæ¨¡ç©ºé—´ï¼Œè¿™æ˜¯æˆ‘ä»¬å®šä¹‰ç‰©ä½“çš„ä¸‰è§’å½¢åˆ—çš„åæ ‡ç³»ã€‚è‡ªèº«åæ ‡ç³»ç®€åŒ–äº†å»ºæ¨¡çš„è¿‡ç¨‹ã€‚åœ¨ç‰©ä½“è‡ªå·±çš„åæ ‡ç³»ä¸­å»ºæ¨¡æ¯”åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­ç›´æ¥å»ºæ¨¡æ›´å®¹æ˜“ã€‚ä¾‹å¦‚ï¼Œåœ¨è‡ªèº«åæ ‡ç³»ä¸­å»ºæ¨¡ä¸åƒåœ¨ä¸–ç•Œåæ ‡ç³»ä¸­è¦è€ƒè™‘æœ¬ç‰©ä½“ç›¸å¯¹äºå…¶ä»–ç‰©ä½“çš„ä½ç½®ã€å¤§å°ã€æ–¹å‘å…³ç³»ã€‚ å›¾2.82.3.2ä¸–ç•Œåæ ‡ç³»ï¼ˆWorld Spaceï¼‰ ä¸€æ—¦æˆ‘ä»¬æ„é€ äº†å„ç§æ¨¡å‹ï¼Œå®ƒä»¬éƒ½åœ¨è‡ªå·±çš„è‡ªèº«åæ ‡ç³»ä¸­ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦æŠŠå®ƒä»¬éƒ½æ”¾åˆ°åŒä¸€ä¸ªä¸–ç•Œåæ ‡ç³»ä¸­ã€‚ç‰©ä½“ä»è‡ªèº«åæ ‡ç³»åˆ°ä¸–ç•Œåæ ‡ç³»ä¸­çš„æ¢å«åšä¸–ç•Œå˜æ¢ã€‚ä¸–ç•Œå˜æ¢é€šå¸¸æ˜¯ç”¨å¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾æ“ä½œæ¥è®¾ç½®æ¨¡å‹åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­çš„ä½ç½®ã€å¤§å°ã€æ–¹å‘ã€‚ä¸–ç•Œå˜æ¢å°±æ˜¯é€šè¿‡å„ç‰©ä½“åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­çš„ä½ç½®ã€å¤§å°å’Œæ–¹å‘ç­‰ç›¸äº’ä¹‹é—´çš„å…³ç³»æ¥å»ºç«‹æ‰€æœ‰ç‰©ä½“ã€‚ å›¾2.9 ä¸–ç•Œå˜æ¢ç”±ä¸€ä¸ªçŸ©é˜µè¡¨ç¤ºï¼Œå¹¶ä¸”åœ¨Direct3Dä¸­è°ƒç”¨IDirect3DDevice9::SetTransformæ–¹æ³•è®¾ç½®å®ƒï¼Œè®°ä½å°†è½¬æ¢ç±»å‹è®¾ä¸ºD3DTS_WORLDã€‚ä¾‹å¦‚æˆ‘ä»¬è¦åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­æ”¾ç½®ä¸€ä¸ªç«‹æ–¹ä½“å®šä½åœ¨ï¼ˆ-3ï¼Œ2ï¼Œ6ï¼‰å’Œä¸€ä¸ªçƒä½“å®šä½åœ¨ï¼ˆ5ï¼Œ0ï¼Œ-2ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ç¨‹åºï¼š//åˆ›å»ºç«‹æ–¹ä½“çš„ä¸–ç•ŒçŸ©é˜µï¼ˆä¸€ä¸ªå¹³ç§»çŸ©é˜µï¼‰D3DXMATRIX cubeWorldMatrix;D3DXMatrixTranslation(&amp;cubeWorldMatrix, -3.0f, 2.0f, 6.0f); //åˆ›å»ºçƒä½“çš„ä¸–ç•ŒçŸ©é˜µï¼ˆä¸€ä¸ªå¹³ç§»çŸ©é˜µï¼‰D3DXMATRIX sphereWorldMatrix;D3DXMatrixTranslation(&amp;sphereWorldMatrix, 5.0f, 0.0f, -2.0f); // å˜æ¢ç«‹æ–¹ä½“ï¼Œç„¶åç»˜åˆ¶å®ƒDevice-&gt;SetTransform(D3DTS_WORLD, &amp;cubeWorldMatrix);drawCube(); // draw the cube // å› ä¸ºçƒä½“ä½¿ç”¨ä¸€ä¸ªä¸åŒçš„ä¸–ç•Œå˜æ¢ï¼Œæˆ‘ä»¬å¿…é¡»æ›´æ”¹ä¸–ç•ŒçŸ©é˜µä¸ºçƒä½“çš„ï½ï¼Œ// å¦‚æœä¸æ›´æ”¹ï¼Œçƒä½“å°†ç»˜åˆ¶åœ¨ä¸Šä¸€ä¸ªä¸–ç•ŒçŸ©é˜µçš„ä½ç½®ä¸Šï¼ˆç«‹æ–¹ä½“çš„ä¸–ç•ŒçŸ©é˜µï¼‰Device-&gt;SetTransform(D3DTS_WORLD, &amp;sphereWorldMatrix);drawSphere(); // ç»˜åˆ¶çƒä½“ è¿™æ˜¯ä¸ªéå¸¸ç®€å•çš„å®ä¾‹ï¼Œæ²¡æœ‰ç”¨åˆ°çŸ©é˜µçš„æ—‹è½¬å’Œç¼©æ”¾ã€‚ä½†æ˜¯ä¸€èˆ¬å¾ˆå¤šç‰©ä½“éƒ½éœ€è¦è¿›è¡Œè¿™äº›å˜æ¢ï¼Œä¸è¿‡è¿™ä¸ªä¾‹å­ä¹Ÿè¿˜æ˜¯å±•ç¤ºäº†ä¸–ç•Œå˜æ¢æ˜¯æ€æ ·è¿›è¡Œçš„ã€‚2.3.3è§†å›¾åæ ‡ç³»ï¼ˆView Spaceï¼‰ ä¸–ç•Œåæ ‡ç³»ä¸­çš„å‡ ä½•å›¾ä¸ç…§ç›¸æœºæ˜¯ç›¸å¯¹äºä¸–ç•Œåæ ‡ç³»è€Œå®šä¹‰çš„ï¼Œå¦‚å›¾2.10æ‰€ç¤ºã€‚ç„¶è€Œåœ¨ä¸–ç•Œåæ ‡ç³»ä¸­å½“ç…§ç›¸æœºæ˜¯ä»»æ„æ”¾ç½®å’Œå®šå‘æ—¶ï¼ŒæŠ•å½±å’Œå…¶å®ƒä¸€äº›æ“ä½œä¼šå˜å¾—å›°éš¾æˆ–ä½æ•ˆã€‚ä¸ºäº†ä½¿äº‹æƒ…å˜å¾—æ›´ç®€å•ï¼Œæˆ‘ä»¬å°†ç…§ç›¸æœºå¹³ç§»å˜æ¢åˆ°ä¸–ç•Œåæ ‡ç³»çš„æºç‚¹å¹¶æŠŠå®ƒçš„æ–¹å‘æ—‹è½¬è‡³æœå‘Zè½´çš„æ­£æ–¹å‘ï¼Œå½“ç„¶ï¼Œä¸–ç•Œåæ ‡ç³»ä¸­çš„æ‰€æœ‰ç‰©ä½“éƒ½å°†éšç€ç…§ç›¸æœºçš„å˜æ¢è€Œåšç›¸åŒçš„å˜æ¢ã€‚è¿™ä¸ªå˜æ¢å°±å«åšè§†å›¾åæ ‡ç³»å˜æ¢ï¼ˆview space transformationï¼‰ã€‚ å›¾2.10 è§†å›¾åæ ‡çš„å˜æ¢çŸ©é˜µå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„D3DXå‡½æ•°è®¡ç®—å¾—åˆ°ï¼šD3DXMATRIX D3DXMatrixLookAtLH( D3DXMATRIX pOut, // æŒ‡å‘è¿”å›çš„è§†å›¾çŸ©é˜µ CONST D3DXVECTOR3 pEye, // ç…§ç›¸æœºåœ¨ä¸–ç•Œåæ ‡ç³»çš„ä½ç½® CONST D3DXVECTOR3 pAt, // ç…§ç›¸æœºåœ¨ä¸–ç•Œåæ ‡ç³»çš„ç›®æ ‡ç‚¹ CONST D3DXVECTOR3* pUp // ä¸–ç•Œåæ ‡ç³»çš„ä¸Šæ–¹å‘(0, 1, 0)); pEyeå‚æ•°æŒ‡å®šç…§ç›¸æœºåœ¨ä¸–ç•Œåæ ‡ç³»ä¸­çš„ä½ç½®ï¼ŒpAtå‚æ•°æŒ‡å®šç…§ç›¸æœºæ‰€è§‚å¯Ÿçš„ä¸–ç•Œåæ ‡ç³»ä¸­çš„ä¸€ä¸ªç›®æ ‡ç‚¹ï¼ŒpUpå‚æ•°æŒ‡å®š3Dä¸–ç•Œä¸­çš„ä¸Šæ–¹å‘ï¼Œé€šå¸¸è®¾Yè½´æ­£æ–¹å‘ä¸ºä¸Šæ–¹å‘ï¼Œå³å–å€¼ä¸ºï¼ˆ0ï¼Œ1ï¼Œ0ï¼‰ã€‚ ä¾‹å¦‚ï¼šå‡è®¾æˆ‘ä»¬è¦æŠŠç…§ç›¸æœºæ”¾åœ¨ç‚¹ï¼ˆ5ï¼Œ3ï¼Œ-10ï¼‰ï¼Œå¹¶ä¸”ç›®æ ‡ç‚¹ä¸ºä¸–ç•Œåæ ‡ç³»çš„ä¸­ç‚¹ï¼ˆ0ï¼Œ0ï¼Œ0ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·è·å¾—è§†å›¾åæ ‡ç³»å˜æ¢çŸ©é˜µï¼šD3DXVECTOR3 position(5.0f, 3.0f, â€“10.0f);D3DXVECTOR3 targetPoint(0.0f, 0.0f, 0.0f);D3DXVECTOR3 worldUp(0.0f, 1.0f, 0.0f); D3DXMATRIX V;D3DXMatrixLookAtLH(&amp;V, &amp;position, &amp;targetPoint, &amp;worldUp); è§†å›¾åæ ‡ç³»å˜æ¢ä¹Ÿæ˜¯é€šè¿‡IDirect3DDevice9::SetTransformæ¥å®ç°çš„ï¼Œåªæ˜¯è¦å°†å˜æ¢ç±»å‹è®¾ä¸ºD3DTS_VIEWï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼šDevice-&gt;SetTransform(D3DTS_VIEW, &amp;V);2.3.4èƒŒé¢æ‹£é€‰ï¼ˆBackface Cullingï¼‰ ä¸€ä¸ªå¤šè¾¹å½¢æœ‰ä¸¤ä¸ªè¡¨é¢ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªæ ‡ä¸ºæ­£é¢ï¼Œä¸€ä¸ªä¸ºèƒŒé¢ã€‚é€šå¸¸ï¼Œåè¡¨é¢æ€»æ˜¯ä¸å¯è§çš„ï¼Œè¿™æ˜¯å› ä¸ºåœºæ™¯ä¸­å¤§å¤šæ•°ç‰©ä½“æ˜¯å¯†å°çš„ã€‚ä¾‹å¦‚ç›’å­ã€åœ†æŸ±ä½“ã€ç®±å­ã€charactersç­‰ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¹Ÿä¸èƒ½æŠŠç…§ç›¸æœºæ”¾å…¥ç‰©ä½“çš„å†…éƒ¨ã€‚å› æ­¤ç…§ç›¸æœºæ°¸ä¸å¯èƒ½çœ‹åˆ°å¤šè¾¹å½¢çš„èƒŒé¢ã€‚è¿™æ˜¯å¾ˆé‡è¦çš„ï¼Œå¦‚æœæˆ‘ä»¬èƒ½çœ‹èƒŒé¢ï¼Œé‚£ä¹ˆèƒŒé¢æ‹£é€‰å°±ä¸å¯èƒ½å·¥ä½œã€‚ å›¾2.11è¡¨ç¤ºäº†ä¸€ä¸ªç‰©ä½“åœ¨è§†å›¾åæ ‡ç³»ä¸­çš„æ­£é¢ã€‚ä¸€ä¸ªå¤šè¾¹å½¢çš„è¾¹éƒ½æ˜¯é¢å‘ç…§ç›¸æœºå«æ­£é¢å¤šè¾¹å½¢ï¼Œè€Œä¸€ä¸ªå¤šè¾¹å½¢çš„è¾¹éƒ½èƒŒå¯¹ç…§ç›¸æœºå«èƒŒé¢å¤šè¾¹å½¢ã€‚ å›¾2.11 ç”±å›¾2.11å¯çŸ¥ï¼Œæ­£é¢å¤šè¾¹å½¢æŒ¡ä½äº†åœ¨å®ƒåé¢çš„èƒŒé¢å¤šè¾¹å½¢ï¼ŒDirect3Då°†é€šè¿‡æ‹£é€‰ï¼ˆå³åˆ é™¤å¤šä½™çš„å¤„ç†è¿‡ç¨‹ï¼‰èƒŒé¢å¤šè¾¹å½¢æ¥æé«˜æ•ˆç‡ï¼Œè¿™ç§æ–¹æ³•å°±å«èƒŒé¢æ‹£é€‰ã€‚å›¾2.12å±•ç¤ºäº†èƒŒé¢æ‹£é€‰ä¹‹åçš„å¤šè¾¹å½¢ï¼Œä»ç…§ç›¸æœºçš„è§‚å¯Ÿç‚¹æ¥çœ‹ï¼Œä»å°†ç»˜åˆ¶ç›¸åŒçš„åœºæ™¯åˆ°åå¤‡è¡¨é¢ï¼Œé‚£äº›è¢«é®ä½çš„éƒ¨åˆ†æ— è®ºå¦‚ä½•éƒ½æ°¸è¿œä¸ä¼šè¢«çœ‹è§çš„ã€‚ å›¾2.12 å½“ç„¶ï¼Œä¸ºäº†å®Œæˆè¿™é¡¹å·¥ä½œï¼ŒDirect3Déœ€è¦çŸ¥é“å“ªä¸ªå¤šè¾¹å½¢æ˜¯æ­£é¢ï¼Œå“ªä¸ªæ˜¯èƒŒé¢ã€‚Direct3Dä¸­é»˜è®¤é¡¶ç‚¹ä»¥é¡ºæ—¶é’ˆæ–¹å‘ï¼ˆåœ¨è§‚å¯Ÿåæ ‡ç³»ä¸­ï¼‰å½¢æˆçš„ä¸‰è§’å½¢ä¸ºæ­£é¢ï¼Œä»¥é€†æ—¶é’ˆæ–¹å‘å½¢æˆçš„ä¸‰è§’å½¢ä¸ºèƒŒé¢ã€‚å¦‚æœæˆ‘ä»¬ä¸æƒ³ä½¿ç”¨é»˜è®¤çš„æ‹£é€‰çŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ”¹å˜D3DRS_CULLMODEæ¥æ”¹å˜æ¸²æŸ“çŠ¶æ€ï¼šDevice-&gt;SetRenderState(D3DRS_CULLMODE, Value);Valueå¯ä»¥æ˜¯å¦‚ä¸‹ä¸€ä¸ªå€¼ï¼š D3DCULL_NONEâ€”â€”å®Œå…¨ä¸ä½¿ç”¨èƒŒé¢æ‹£é€‰ D3DCULL_CWâ€”â€”æ‹£é€‰é¡ºæ—¶é’ˆæ–¹å‘ç¯ç»•çš„ä¸‰è§’å½¢ D3DCULL_CCWâ€”â€”æ‹£é€‰é€†æ—¶é’ˆæ–¹å‘ç¯ç»•çš„ä¸‰è§’å½¢ï¼Œè¿™æ˜¯é»˜è®¤å€¼ã€‚ 2.3.5å…‰æºï¼ˆLightingï¼‰ å…‰æºå®šä¹‰åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­ç„¶åè¢«å˜æ¢åˆ°è§†å›¾åæ ‡ç³»ä¸­ã€‚è§†å›¾åæ ‡ç³»ä¸­å…‰æºç»™ç‰©ä½“æ–½åŠ çš„å…‰ç…§å¤§å¤§å¢åŠ äº†åœºæ™¯ä¸­ç‰©ä½“çš„çœŸå®æ€§ï¼Œè‡³äºå…‰ç…§çš„ç›¸å…³å‡½æ•°çš„ç»†èŠ‚å°†ä¼šåœ¨ç¬¬äº”ç« å­¦ä¹ ã€‚åœ¨æœ¬ä¹¦çš„ç¬¬å››éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å¯ç¼–ç¨‹ç®¡çº¿å®ç°è‡ªå·±çš„å…‰ç…§ã€‚ 2.3.6è£å‰ªï¼ˆClippingï¼‰æˆ‘ä»¬æ‹£é€‰é‚£äº›è¶…å‡ºäº†å¯è§†ä½“èŒƒå›´çš„å‡ ä½•å›¾å½¢çš„è¿‡ç¨‹å°±å«åšè£å‰ªã€‚è¿™ä¼šå‡ºç°ä¸‰ç§æƒ…å†µï¼š å®Œå…¨åŒ…å«â€”â€”ä¸‰è§’å½¢å®Œå…¨åœ¨å¯è§†ä½“å†…ï¼Œè¿™ä¼šä¿æŒä¸å˜ï¼Œå¹¶è¿›å…¥ä¸‹ä¸€çº§ å®Œå…¨åœ¨å¤–â€”â€”ä¸‰è§’å½¢å®Œå…¨åœ¨å¯è§†ä½“å¤–éƒ¨ï¼Œè¿™å°†è¢«æ‹£é€‰ éƒ¨åˆ†åœ¨å†…ï¼ˆéƒ¨åˆ†åœ¨å¤–ï¼‰â€”â€”ä¸‰è§’å½¢ä¸€éƒ¨åˆ†åœ¨å¯è§†ä½“å†…ï¼Œä¸€éƒ¨åˆ†åœ¨å¯è§†ä½“å¤–ï¼Œåˆ™ä¸‰è§’å½¢å°†è¢«åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œå¯è§†ä½“å†…çš„éƒ¨åˆ†è¢«ä¿ç•™ï¼Œå¯è§†ä½“ä¹‹å¤–çš„åˆ™è¢«æ‹£é€‰ å›¾2.13å±•ç¤ºäº†ä¸Šé¢ä¸‰ç§æƒ…å†µï¼š å›¾2.13 2.3.7æŠ•å½±ï¼ˆProjectionï¼‰è§†å›¾åæ ‡ç³»çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯å°†3Dåœºæ™¯è½¬åŒ–ä¸º2Då›¾åƒè¡¨ç¤ºã€‚è¿™ç§ä»nç»´è½¬æ¢æˆn-1ç»´çš„è¿‡ç¨‹å°±å«åšæŠ•å½±ã€‚æŠ•å½±çš„æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œä½†æ˜¯æˆ‘ä»¬åªå¯¹ä¸€ç§ç‰¹æ®Šçš„æŠ•å½±æ„Ÿå…´è¶£ï¼Œé‚£å°±æ˜¯é€è§†æŠ•å½±ã€‚å› ä¸ºé€è§†æŠ•å½±å¯ä»¥ä½¿ç¦»ç…§ç›¸æœºè¶Šè¿œçš„ç‰©ä½“æŠ•å½±åˆ°å±å¹•ä¸Šåå°±è¶Šå°ï¼Œè¿™å¯ä»¥ä½¿æˆ‘ä»¬æŠŠ3Dåœºæ™¯æ›´çœŸå®çš„è½¬åŒ–ä¸º2Då›¾åƒã€‚å›¾2.14å±•ç¤ºäº†ä¸€ä¸ª3Dç©ºé—´ä¸­çš„ç‚¹æ˜¯å¦‚ä½•é€šè¿‡é€è§†æŠ•å½±åˆ°æŠ•å½±çª—å£ä¸Šå»çš„ã€‚ å›¾2.14 æŠ•å½±å˜æ¢çš„å®è´¨å°±æ˜¯å®šä¹‰å¯è§†ä½“ï¼Œå¹¶å°†å¯è§†ä½“å†…çš„å‡ ä½•å›¾å½¢æŠ•å½±åˆ°æŠ•å½±çª—å£ä¸Šå»ã€‚æŠ•å½±çŸ©é˜µçš„è®¡ç®—å¤ªå¤æ‚äº†ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸ä¼šç»™å‡ºæ¨å¯¼è¿‡ç¨‹ï¼Œè€Œæ˜¯ä½¿ç”¨å¦‚ä¸‹çš„Direct3Då‡½æ•°é€šè¿‡ç»™å‡ºå¹³æˆªå¤´ä½“çš„å‚æ•°æ¥æ±‚å‡ºæŠ•å½±çŸ©é˜µã€‚ å›¾2.151234567D3DXMATRIX *D3DXMatrixPerspectiveFovLH( D3DXMATRIX* pOut, // è¿”å›çš„æŠ•å½±çŸ©é˜µ FLOAT fovY, // ç”¨å¼§åº¦è¡¨ç¤ºçš„è§†é‡è§’åº¦vertical field of view angle in radians FLOAT Aspect, // å®½é«˜æ¯” FLOAT zn, // å‰è£å‰ªé¢è·ç¦» FLOAT zf // åè£å‰ªé¢è·ç¦»); ï¼ˆfovYå®šä¹‰é•œå¤´å‚ç›´è§‚å¯ŸèŒƒå›´ï¼Œä»¥å¼§åº¦ä¸ºå•ä½ã€‚å¯¹äºè¿™ä¸ªå‚æ•°ï¼Œä¸‹é¢æ˜¯æˆ‘çš„ç†è§£ï¼šå¦‚æœå®šä¹‰ä¸ºD3DX_PI/4ï¼ˆ90åº¦è§’ï¼‰ï¼Œé‚£ä¹ˆå°±æ˜¯è¡¨ç¤ºä»¥æ‘„åƒæœºçš„è§‚å¯Ÿæ–¹å‘ä¸ºå¹³åˆ†çº¿ï¼Œä¸Šæ–¹45åº¦è§’å’Œä¸‹æ–¹45åº¦è§’å°±æ˜¯æ‘„åƒæœºæ‰€èƒ½çœ‹åˆ°çš„å‚ç›´èŒƒå›´äº†ã€‚å—¯ï¼Œå¯ä»¥æƒ³è±¡ä¸€ä¸‹è‡ªå·±çš„çœ¼ç›ï¼Œå¦‚æœå¯ä»¥æŠŠè‡ªå·±çœ¼ç›çš„fovYå€¼è®¾ä¸ºD3DX_PI/2ï¼ˆ180åº¦è§’ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä¸ç”¨æŠ¬å¤´å°±çœ‹å¾—è§å¤´é¡¶çš„ä¸œè¥¿äº†ã€‚å¦‚æœè®¾ä¸ºD3DX_PIçš„è¯ã€‚ã€‚ã€‚æˆ‘å…ˆç¼–è¯‘ä¸€ä¸‹è¯•è¯•ï¼ˆbuildingâ€¦ï¼‰ã€‚å“ˆå“ˆï¼Œç»“æœå•¥ä¹Ÿçœ‹ä¸è§ã€‚å¾ˆéš¾æƒ³è±¡å¦‚æœè‡ªå·±èƒ½åŒæ—¶çœ‹åˆ°æ‰€æœ‰æ–¹å‘çš„ç‰©ä½“ï¼Œé‚£ä¹ˆå°†æ˜¯ä¸€ä¸ªæ€æ ·çš„ç”»é¢å•Šï¼‰ Aspectå‚æ•°ä¸ºæŠ•å½±å¹³é¢çš„å®½é«˜æ¯”ä¾‹å€¼ï¼Œç”±äºæœ€åéƒ½ä¸ºè½¬æ¢åˆ°å±å¹•ä¸Šï¼Œæ‰€ä»¥è¿™ä¸ªæ¯”ä¾‹ä¸€èˆ¬è®¾ä¸ºå±å¹•åˆ†è¾¨ç‡çš„å®½å’Œé«˜çš„æ¯”å€¼ï¼ˆè§2.3.8èŠ‚ï¼‰ã€‚å¦‚æœæŠ•å½±çª—å£æ˜¯ä¸ªæ­£æ–¹å½¢ï¼Œè€Œæˆ‘ä»¬çš„æ˜¾ç¤ºå±ä¸€èˆ¬éƒ½æ˜¯é•¿æ–¹å½¢çš„ï¼Œè¿™æ ·è½¬æ¢åå°±ä¼šå¼•èµ·æ‹‰ä¼¸å˜å½¢ã€‚ æˆ‘ä»¬è¿˜æ˜¯é€šè¿‡è°ƒç”¨IDirect3DDevice9::SetTranformæ–¹æ³•æ¥è¿›è¡ŒæŠ•å½±å˜æ¢ï¼Œå½“ç„¶ï¼Œè¦æŠŠç¬¬ä¸€ä¸ªæŠ•å½±ç±»å‹çš„å‚æ•°è®¾ä¸ºD3DTS_PROJECTIONã€‚ä¸‹é¢çš„ä¾‹å­åŸºäºä¸€ä¸ª90åº¦è§†è§’ã€å‰è£å‰ªé¢è·ç¦»ä¸º1ã€åè£å‰ªé¢è·ç¦»ä¸º1000çš„å¹³æˆªå¤´ä½“åˆ›å»ºæŠ•å½±çŸ©é˜µï¼šD3DXMATRIX proj;D3DXMatrixPerspectiveFovLH( &amp;proj, PI * 0.5f, (float)width / (float)height, 1.0, 1000.0f);Device-&gt;SetTransform(D3DTS_PROJECTION, &amp;proj);2.3.8è§†å£å˜æ¢ï¼ˆViewport Transformï¼‰ è§†å£å˜æ¢ä¸»è¦æ˜¯è½¬æ¢æŠ•å½±çª—å£åˆ°æ˜¾ç¤ºå±å¹•ä¸Šã€‚é€šå¸¸ä¸€ä¸ªæ¸¸æˆçš„è§†å£å°±æ˜¯æ•´ä¸ªæ˜¾ç¤ºå±ï¼Œä½†æ˜¯å½“æˆ‘ä»¬ä»¥çª—å£æ¨¡å¼è¿è¡Œçš„æ—¶å€™ï¼Œä¹Ÿæœ‰å¯èƒ½åªå å±å¹•çš„ä¸€éƒ¨åˆ†æˆ–åœ¨å®¢æˆ·åŒºå†…ã€‚è§†å£çŸ©å½¢æ˜¯ç”±å®ƒæ‰€åœ¨çª—å£çš„åæ ‡ç³»æ¥æè¿°çš„ï¼Œå¦‚å›¾2.16ã€‚ å›¾2.16 åœ¨Direct3Dä¸­ï¼Œè§†å£çŸ©å½¢é€šè¿‡D3DVIEWPORT9ç»“æ„æ¥è¡¨ç¤ºã€‚å®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼štypedef struct _D3DVIEWPORT9 { DWORD X; DWORD Y; DWORD Width; DWORD Height; DWORD MinZ; DWORD MaxZ;} D3DVIEWPORT9; å‰å››ä¸ªå‚æ•°å®šä¹‰äº†è§†å£çŸ©å½¢ä¸å…¶æ‰€åœ¨çª—å£çš„å…³ç³»ã€‚MinZæˆå‘˜æŒ‡å®šæœ€å°æ·±åº¦ç¼“å†²å€¼ï¼ŒMaxZæŒ‡å®šæœ€å¤§æ·±åº¦ç¼“å†²å€¼ã€‚Direct3Dä½¿ç”¨çš„æ·±åº¦ç¼“å†²çš„èŒƒå›´æ˜¯0~1ï¼Œæ‰€ä»¥å¦‚æœä¸æƒ³åšä»€ä¹ˆç‰¹æ®Šæ•ˆæœçš„è¯ï¼Œå°†å®ƒä»¬åˆ†åˆ«è®¾æˆç›¸åº”çš„å€¼å°±å¯ä»¥äº†ã€‚ ä¸€æ—¦æˆ‘ä»¬å¡«å……å®ŒD3DVIEWPORT9ç»“æ„åï¼Œå°±å¯ä»¥å¦‚ä¸‹è®¾è§†å£ï¼šD3DVIEWPORT9 vp{ 0, 0, 640, 480, 0, 1 };Device-&gt;SetViewport(&amp;vp);è¿™æ ·ï¼ŒDirect3Då°±ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬å¤„ç†è§†å£å˜æ¢ã€‚ç°åœ¨è¿˜æ˜¯ç»™å‡ºè§†å£å˜æ¢çŸ©é˜µä½œä¸ºå‚è€ƒï¼š å…‰æ …åŒ–ï¼ˆRasterizationï¼‰åœ¨æŠŠä¸‰è§’å½¢æ¯ä¸ªé¡¶ç‚¹è½¬æ¢åˆ°å±å¹•ä¸Šä»¥åï¼Œæˆ‘ä»¬å°±ç”»äº†ä¸€ä¸ª2Dä¸‰è§’å½¢ã€‚å…‰æ …åŒ–æ˜¯è®¡ç®—éœ€è¦æ˜¾ç¤ºçš„æ¯ä¸ªä¸‰è§’å½¢ä¸­æ¯ä¸ªç‚¹é¢œè‰²å€¼ï¼ˆå¦‚å›¾2.17ï¼‰ã€‚å›¾2.17å…‰æ …åŒ–è¿‡ç¨‹æ˜¯éå¸¸ç¹é‡çš„è®¡ç®—ï¼Œå®ƒåº”è¯¥é€šè¿‡ç¡¬ä»¶å›¾å½¢å¤„ç†æ¥å®Œæˆã€‚å®ƒçš„å¤„ç†ç»“æœå°±æ˜¯æŠŠ2Då›¾è±¡æ˜¾ç¤ºåœ¨æ˜¾ç¤ºå™¨ä¸Šã€‚]]></content>
      <tags>
        <tag>è®¡ç®—æœºå›¾å½¢å­¦</tag>
        <tag>Direct3D 9</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å›¾]]></title>
    <url>%2F2019%2F03%2F23%2Fmap%2F</url>
    <content type="text"><![CDATA[å›¾çœ‹èµ·æ¥å°±åƒä¸‹å›¾è¿™æ ·ï¼š ä¸€ä¸ªå›¾å°±æ˜¯ä¸€äº›é¡¶ç‚¹çš„é›†åˆï¼Œè¿™äº›é¡¶ç‚¹é€šè¿‡è¾¹è¿æ¥ã€‚é¡¶ç‚¹ç”¨åœ†åœˆè¡¨ç¤ºï¼Œè¾¹å°±æ˜¯è¿™äº›åœ†åœˆä¹‹é—´çš„è¿çº¿ã€‚é¡¶ç‚¹ä¹‹é—´é€šè¿‡è¾¹è¿æ¥ã€‚ æ³¨æ„ï¼šé¡¶ç‚¹æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºèŠ‚ç‚¹æˆ–è€…äº¤ç‚¹ï¼Œè¾¹æœ‰æ—¶ä¹Ÿç§°ä¸ºé“¾æ¥ã€‚å›¾æœ‰ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼šé‚»æ¥åˆ—è¡¨å’Œé‚»æ¥çŸ©é˜µã€‚é‚»æ¥åˆ—è¡¨ï¼šåœ¨é‚»æ¥åˆ—è¡¨å®ç°ä¸­ï¼Œæ¯ä¸€ä¸ªé¡¶ç‚¹ä¼šå­˜å‚¨ä¸€ä¸ªä»å®ƒè¿™é‡Œå¼€å§‹çš„è¾¹çš„åˆ—è¡¨ã€‚æ¯”å¦‚ï¼Œå¦‚æœé¡¶ç‚¹Aæœ‰ä¸€æ¡è¾¹åˆ°Bã€Cå’ŒDï¼Œé‚£ä¹ˆAçš„åˆ—è¡¨ä¸­ä¼šæœ‰3æ¡è¾¹ é‚»æ¥åˆ—è¡¨åªæè¿°äº†æŒ‡å‘å¤–éƒ¨çš„è¾¹ã€‚Aæœ‰ä¸€æ¡è¾¹åˆ°Bï¼Œä½†æ˜¯Bæ²¡æœ‰è¾¹åˆ°Aï¼Œæ‰€ä»¥Aæ²¡æœ‰å‡ºç°åœ¨Bçš„é‚»æ¥åˆ—è¡¨ä¸­ã€‚æŸ¥æ‰¾ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´çš„è¾¹æˆ–è€…æƒé‡ä¼šæ¯”è¾ƒè´¹æ—¶ï¼Œå› ä¸ºéå†é‚»æ¥åˆ—è¡¨çŸ¥é“æ‰¾åˆ°ä¸ºæ­¢ã€‚ é‚»æ¥çŸ©é˜µï¼šåœ¨é‚»æ¥çŸ©é˜µå®ç°ä¸­ï¼Œç”±è¡Œå’Œåˆ—éƒ½è¡¨ç¤ºé¡¶ç‚¹ï¼Œç”±ä¸¤ä¸ªé¡¶ç‚¹æ‰€å†³å®šçš„çŸ©é˜µå¯¹åº”å…ƒç´ è¡¨ç¤ºè¿™é‡Œä¸¤ä¸ªé¡¶ç‚¹æ˜¯å¦ç›¸è¿ã€å¦‚æœç›¸è¿è¿™ä¸ªå€¼è¡¨ç¤ºçš„æ˜¯ç›¸è¿è¾¹çš„æƒé‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä»é¡¶ç‚¹Aåˆ°é¡¶ç‚¹Bæœ‰ä¸€æ¡æƒé‡ä¸º5.6çš„è¾¹ï¼Œé‚£ä¹ˆçŸ©é˜µä¸­ç¬¬Aè¡Œç¬¬Båˆ—çš„ä½ç½®çš„å…ƒç´ å€¼åº”è¯¥æ˜¯5.6ï¼šå¾€è¿™ä¸ªå›¾ä¸­æ·»åŠ é¡¶ç‚¹çš„æˆæœ¬éå¸¸æ˜‚è´µï¼Œå› ä¸ºæ–°çš„çŸ©é˜µç»“æœå¿…é¡»é‡æ–°æŒ‰ç…§æ–°çš„è¡Œ/åˆ—åˆ›å»ºï¼Œç„¶åå°†å·²æœ‰çš„æ•°æ®å¤åˆ¶åˆ°æ–°çš„çŸ©é˜µä¸­ã€‚æ‰€ä»¥ä½¿ç”¨å“ªä¸€ä¸ªå‘¢ï¼Ÿå¤§å¤šæ•°çš„æ—¶å€™ï¼Œé€‰æ‹©é‚»æ¥åˆ—è¡¨æ˜¯æ­£ç¡®çš„ã€‚ä¸‹é¢æ˜¯ä¸¤ç§æ–¹æ³•æ›´è¯¦ç»†çš„çš„æ¯”è¾ƒã€‚å‡è®¾Vè¡¨ç¤ºå›¾ä¸­çš„é¡¶ç‚¹çš„ä¸ªæ•°ï¼ŒEè¡¨ç¤ºè¾¹çš„ä¸ªæ•°ã€‚ æ“ä½œ é‚»æ¥åˆ—è¡¨ é‚»æ¥çŸ©é˜µ å­˜å‚¨ç©ºé—´ O(V+E) O(V^2) æ·»åŠ é¡¶ç‚¹ O(1) O(V^2) æ·»åŠ è¾¹ O(1) O(1) æ£€æŸ¥ç›¸é‚»è¡Œ O(V) O(1) â€œæ£€æŸ¥ç›¸é‚»æ€§â€æ˜¯æŒ‡å¯¹äºç»™å®šçš„é¡¶ç‚¹ï¼Œå°è¯•ç¡®å®šå®ƒæ˜¯å¦æ˜¯å¦ä¸€ä¸ªé¡¶ç‚¹çš„é‚»å±…ã€‚åœ¨é‚»æ¥åˆ—è¡¨ä¸­æ£€æŸ¥ç›¸é‚»æ€§çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(V)ï¼Œå› ä¸ºæœ€åçš„è½»å¿«æ˜¯ä¸€ä¸ªé¡¶ç‚¹ä¸æ¯ä¸€ä¸ªé¡¶ç‚¹éƒ½ç›¸è¿ã€‚ åœ¨ç¨€ç–å›¾çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸€ä¸ªé¡¶ç‚¹éƒ½åªä¼šå’Œå°‘æ•°å‡ ä¸ªé¡¶ç‚¹ç›¸è¿ï¼Œè¿™ç§æƒ…å†µä¸‹ç›¸é‚»åˆ—è¡¨æ˜¯æœ€ä½³é€‰æ‹©ã€‚å¦‚æœè¿™ä¸ªå›¾æ¯”è¾ƒå¯†é›†ï¼Œæ¯ä¸€ä¸ªé¡¶ç‚¹éƒ½å’Œå¤§å¤šæ•°å…¶ä»–é¡¶ç‚¹ç›¸è¿ï¼Œé‚£ä¹ˆç›¸é‚»çŸ©é˜µæ›´åˆé€‚ã€‚ å›¾å¯åˆ†ä¸ºæœ‰å‘å›¾å’Œæ— å‘å›¾ã€‚æœ‰å‘å›¾çš„æ‰€æœ‰è¾¹éƒ½æœ‰æ–¹å‘ï¼Œå³ç¡®å®šäº†é¡¶ç‚¹åˆ°é¡¶ç‚¹çš„ä¸€ä¸ªæŒ‡å‘ï¼›è€Œæ— å‘å›¾çš„æ‰€æœ‰è¾¹éƒ½æ˜¯åŒå‘çš„ï¼Œå³æ— å‘è¾¹æ‰€è¿æ¥çš„ä¸¤ä¸ªé¡¶ç‚¹å¯ä»¥äº’ç›¸åˆ°è¾¾ã€‚é¡¶ç‚¹çš„åº¦æ˜¯æŒ‡å’Œè¯¥é¡¶ç‚¹ç›¸è¿çš„è¾¹çš„æ¡æ•°ã€‚ç‰¹åˆ«æ˜¯å¯¹äºæœ‰å‘å›¾æ¥è¯´ï¼Œé¡¶ç‚¹çš„å‡ºè¾¹æ¡æ•°æˆä¸ºè¯¥é¡¶ç‚¹çš„å‡ºåº¦ï¼Œé¡¶ç‚¹çš„å…¥è¾¹æ¡æ•°æˆä¸ºè¯¥é¡¶ç‚¹çš„å…¥åº¦ã€‚]]></content>
      <tags>
        <tag>æ•°æ®ç»“æ„ä¸ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Androidå¼€å‘å…¥é—¨]]></title>
    <url>%2F2019%2F03%2F23%2Fandroid-GettingStarted%2F</url>
    <content type="text"></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AssetBundles å·¥ä½œæµç¨‹]]></title>
    <url>%2F2019%2F03%2F22%2FAssetBundles-Workflow%2F</url>
    <content type="text"><![CDATA[AssetBundleå·¥ä½œæµç¨‹è¦å¼€å§‹ä½¿ç”¨AssetBundlesï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œã€‚æœ‰å…³æ¯ä¸ªå·¥ä½œæµç¨‹çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æœ¬æ–‡çš„å…¶ä»–é¡µé¢ã€‚ å°†èµ„äº§åˆ†é…ç»™AssetBundlesåˆ†é…ç»™å®šèµ„äº§Assetbundleçš„ï¼Œè¯·æŒ‰ç…§ä¸‹åˆ—æ­¥éª¤æ“ä½œï¼š ä»é¡¹ç›®è§†å›¾ä¸­é€‰æ‹©è¦åˆ†é…ç»™æ†ç»‘åŒ…çš„èµ„äº§ æ£€æŸ¥æ£€æŸ¥å™¨ä¸­çš„å¯¹è±¡ åœ¨æ£€æŸ¥å™¨çš„åº•éƒ¨ï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ä¸€ä¸ªåˆ†é…AssetBundleså’ŒVariantsçš„éƒ¨åˆ† å·¦ä¾§ä¸‹æ‹‰åˆ†é…AssetBundleï¼Œè€Œå³ä¾§ä¸‹æ‹‰åˆ†é…å˜é‡ å•å‡»å·¦ä¾§ä¸‹æ‹‰åˆ—è¡¨ï¼Œæ˜¾ç¤ºâ€æ— â€ï¼Œä»¥æ˜¾ç¤ºå½“å‰å·²æ³¨å†Œçš„AssetBundleåç§° å•å‡»â€æ–°å»ºâ€¦â€ä»¥åˆ›å»ºæ–°çš„AssetBundle è¾“å…¥æ‰€éœ€çš„AssetBundleåç§°ã€‚è¯·æ³¨æ„ï¼ŒAssetBundleåç§°ç¡®å®æ”¯æŒä¸€ç§æ–‡ä»¶å¤¹ç»“æ„ï¼Œå…·ä½“å–å†³äºæ‚¨é”®å…¥çš„å†…å®¹ã€‚è¦æ·»åŠ å­æ–‡ä»¶å¤¹ï¼Œè¯·ç”¨â€/â€œåˆ†å‰²æ–‡ä»¶å¤¹åç§°ã€‚ä¾‹å¦‚ï¼šAssetBundleåç§°â€environment/forestâ€å°†åœ¨ç¯å¢ƒå­æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºåforestçš„åŒ… ä¸€æ—¦é€‰æ‹©æˆ–åˆ›å»ºäº†AssetBundleåç§°ï¼Œæ‚¨å¯ä»¥é‡å¤æ­¤è¿‡ç¨‹ä»¥å³æ‰‹ä¸‹æ‹‰ä»¥åˆ†é…æˆ–åˆ›å»ºå˜ä½“åç§°ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚æ„å»ºAssetBundleä¸éœ€è¦å˜ä½“åç§° æ„å»ºAssetBundlesåœ¨Assetæ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºEditorçš„æ–‡ä»¶å¤¹ï¼Œå¹¶å°†åŒ…å«ä»¥ä¸‹å†…å®¹çš„è„šæœ¬æ”¾åœ¨è¯¥æ–‡ä»¶å¤¹ä¸­ï¼š1234567891011121314151617using UnityEditor;using UnityEngine;using System.IO;public class CreateAssetBundles&#123; [MenuItem(&quot;Assets/Build AssetBundles&quot;)] static void BuildAllAssetBundles() &#123; if (!Directory.Exists(Application.streamingAssetsPath)) &#123; Directory.CreateDirectory(Application.streamingAssetsPath); &#125; BuildPipeline.BuildAssetBundles(Application.streamingAssetsPath, BuildAssetBundleOptions.None, BuildTarget.Android); AssetDatabase.Refresh(); &#125;&#125; æ­¤è„šæœ¬å°†åœ¨Assetsèœå•åº•éƒ¨åˆ›å»ºä¸€ä¸ªåä¸ºâ€Build AssetBundlesâ€çš„èœå•é¡¹ï¼Œè¯¥èœå•é¡¹å°†æ‰§è¡Œä¸è¯¥æ ‡è®°å…³è”çš„å‡½æ•°ä¸­çš„ä»£ç ã€‚å•å‡»â€Build AssetBundlesâ€æ—¶ï¼Œå°†æ˜¾ç¤ºä¸€ä¸ªå¸¦æœ‰æ„å»ºå¯¹è¯æ¡†çš„è¿›åº¦æ¡ã€‚è¿™å°†è·å–æ‚¨ä½¿ç”¨AssetBundleåç§°æ ‡è®°çš„æ‰€æœ‰èµ„äº§ï¼Œå¹¶å°†å®ƒä»¬æ”¾åœ¨assetBundleDirectoryå®šä¹‰çš„è·¯å¾„ä¸­çš„æ–‡ä»¶å¤¹ä¸­ã€‚ å°†AssetBundlesä¸Šä¼ åˆ°åœºå¤–å­˜å‚¨æ­¤æ­¥éª¤å¯¹æ¯ä¸ªç”¨æˆ·éƒ½æ˜¯å”¯ä¸€çš„ï¼Œè€Œä¸æ˜¯Unityå¯ä»¥å‘Šè¯‰æ‚¨å¦‚ä½•æ“ä½œçš„æ­¥éª¤ã€‚å¦‚æœæ‚¨æ‰“ç®—å°†AssetBundlesä¸Šä¼ åˆ°ç¬¬ä¸‰æ–¹æ‰˜ç®¡ç½‘ç«™ï¼Œè¯·åœ¨æ­¤æ‰§è¡Œæ­¤æ“ä½œã€‚å¦‚æœæ‚¨æ­£åœ¨è¿›è¡Œä¸¥æ ¼çš„æœ¬åœ°å¼€å‘å¹¶æ‰“ç®—å°†æ‰€æœ‰AssetBundleéƒ½æ”¾åœ¨ç£ç›˜ä¸Šï¼Œè¯·è·³åˆ°ä¸‹ä¸€æ­¥ã€‚ åŠ è½½AssetBundleå’ŒAssetså¯¹äºæ‰“ç®—ä»æœ¬åœ°å­˜å‚¨åŠ è½½çš„ç”¨æˆ·ï¼Œæ‚¨å°†å¯¹AssetBundles.LoadFromFile APIæ„Ÿå…´è¶£ã€‚å¦‚ä¸‹ï¼š1234567891011121314public class LoadFromFileExample : MonoBehaviour &#123; void Start() &#123; var myLoaderAssetBundle = AssetBundle.LoadFromFile(Path.Combine(Application.streamingAssetsPath, &quot;myassetBundle&quot;)); if (myLoaderAssetBundle == null) &#123; Debug.Log(&quot;Failed to load AssetBundle!&quot;); return; &#125; var prefab = myLoaderAssetBundle.LoadAsset&lt;GameObject&gt;(&quot;MyObject&quot;); Instantiate(prefab); &#125;&#125; LoadFromFile è·å–bundleæ–‡ä»¶çš„è·¯å¾„ã€‚å¦‚æœæ‚¨è‡ªå·±æ‰˜ç®¡AssetBundleså¹¶éœ€è¦å°†å®ƒä»¬ä¸‹è½½åˆ°æ¸¸æˆä¸­ï¼Œæ‚¨å°†å¯¹UnityWebRequest APIæ„Ÿå…´è¶£ã€‚è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼š1234IEnumerator InstantiateObject()&#123; string uri = &quot;file:///&quot;&#125;]]></content>
      <categories>
        <category>Unity-2018-3</category>
      </categories>
      <tags>
        <tag>Unity AssetBundles</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity æ–‡ä»¶è·¯å¾„]]></title>
    <url>%2F2019%2F03%2F22%2FUnity-Path%2F</url>
    <content type="text"><![CDATA[ResourcesResourcesæ–‡ä»¶å¤¹æ˜¯Unityé‡Œè‡ªåŠ¨è¯†åˆ«çš„ä¸€ç§æ–‡ä»¶å¤¹ï¼Œå¯åœ¨Unityç¼–è¾‘å™¨çš„Projectçª—å£åˆ›å»ºï¼Œå¹¶å°†èµ„æºæ”¾ç½®åœ¨é‡Œé¢ã€‚Resourcesæ–‡ä»¶å¤¹ä¸‹çš„èµ„æºä¸ç®¡æ˜¯å¦æœ‰ç”¨ï¼Œå…¨éƒ¨ä¼šæ‰“åŒ…è¿›.apkæˆ–è€….ipaï¼Œå¹¶ä¸”æ‰“åŒ…æ—¶ä¼šå°†é‡Œé¢çš„èµ„æºå‹ç¼©å¤„ç†ã€‚åŠ è½½æ–¹æ³•æ˜¯Resources.Load(æ–‡ä»¶å)ï¼Œéœ€è¦æ³¨æ„ï¼šæ–‡ä»¶åä¸åŒ…æ‹¬æ‰©å±•åï¼Œæ‰“åŒ…åä¸èƒ½æ›´æ”¹Resourcesä¸‹çš„èµ„æºå†…å®¹ï¼Œä½†æ˜¯ä»Resourcesæ–‡ä»¶å¤¹ä¸­åŠ è½½å‡ºæ¥çš„èµ„æºå¯ä»¥æ›´æ”¹ã€‚ Application.dataPathè¿™ä¸ªå±æ€§è¿”å›çš„æ˜¯ç¨‹åºçš„æ•°æ®æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œä¾‹å¦‚åœ¨Editorä¸­å°±æ˜¯é¡¹ç›®çš„Assetsæ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œé€šè¿‡è¿™ä¸ªè·¯å¾„å¯ä»¥è®¿é—®é¡¹ç›®ä¸­ä»»ä½•æ–‡ä»¶å¤¹ä¸­çš„èµ„æºï¼Œä½†æ˜¯åœ¨ç§»åŠ¨ç«¯å®ƒæ˜¯å®Œå…¨æ²¡ç”¨ã€‚ Application.streamingAssetsPathè¿™ä¸ªå±æ€§ç”¨äºè¿”å›æµæ•°æ®çš„ç¼“å­˜ç›®å½•ï¼Œè¿”å›è·¯å¾„ä¸ºç›¸å¯¹è·¯å¾„ï¼Œé€‚åˆè®¾ç½®ä¸€äº›å¤–éƒ¨æ•°æ®æ–‡ä»¶çš„è·¯å¾„ã€‚åœ¨Unityå·¥ç¨‹çš„Assetsç›®å½•ä¸‹èµ·ä¸€ä¸ªåä¸ºâ€StreamingAssetsâ€çš„æ–‡ä»¶å¤¹å³å¯ï¼Œç„¶åç”¨Application.streamingAssetsPathè®¿é—®ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹ä¸­çš„èµ„æºåœ¨æ‰“åŒ…æ—¶ä¼šåŸå°ä¸åŠ¨çš„æ‰“åŒ…è¿›å»ï¼Œä¸ä¼šå‹ç¼©ï¼Œä¸€èˆ¬æ”¾ç½®ä¸€äº›èµ„æºæ•°æ®ã€‚åœ¨PC/MACä¸­å¯å®ç°å¯¹æ–‡ä»¶çš„â€œå¢åˆ æ”¹æŸ¥â€ç­‰æ“ä½œï¼Œä½†åœ¨ç§»åŠ¨ç«¯æ˜¯ä¸€ä¸ªåªè¯»è·¯å¾„ã€‚ IOS Android Windows Mac Application.dataPath åªè¯»ä¸å†™ Application/xxxxxx/xxx.app/Data /data/app/xxx.xxx.xxx.apk /Assets Assets Application.streamAssetsPath åªè¯»ä¸å†™ï¼Œé¦–åŒ…èµ„æºç›®å½• Application/xxxxxx/xxx.app/Data/Raw jar:file:///data/app/xxx.xxx.xxx.apk/!/assets Assets/StreamingAssets Assets/StreamingAssets Application.peristentDataPath å¯è¯»å¯å†™ï¼Œæ›´æ–°èµ„æºåŒ…ç›®å½• Application/xxxxxx/xxx.app/Documents /data/data/xxx.xxx.xxx/files C:/Users/Admin/AppData/LocalLow/CompanyName/ProductName /Users/xxxx/Library/Caches/CompanyName/ProductName Application.temproaryCachPath Application/xxxxxx/xxx.app/Library/Caches /data/data/xxx.xxx.xxx/cache C:/Users/Admin/AppData/Local/Temp/CompanyName/ProductName /var/folders/57/6b4_9w8113x2fsmzx_yhrhvh0000gn/T/CompanyName/Product]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æœ€çŸ­è·¯å¾„ç®—æ³•ç®€ä»‹ï¼ˆDijkstraç®—æ³•ï¼ŒA*ç®—æ³•ï¼ŒD*ç®—æ³•ï¼‰]]></title>
    <url>%2F2019%2F03%2F21%2FNav%2F</url>
    <content type="text"><![CDATA[æœ€çŸ­è·¯å¾„è®¡ç®—åˆ†é™æ€æœ€çŸ­è®¡ç®—å’ŒåŠ¨æ€æœ€çŸ­è·¯å¾„è®¡ç®—ã€‚é™æ€æœ€çŸ­è·¯å¾„ç®—æ³•æ˜¯å¤–ç•Œç¯å¢ƒä¸å˜ï¼Œè®¡ç®—æœ€çŸ­è·¯å¾„ã€‚ä¸»è¦æœ‰Dijkstraç®—æ³•ï¼ŒAï¼ˆA Starï¼‰ç®—æ³•ã€‚åŠ¨æ€æœ€çŸ­è·¯å¾„ç®—æ³•æ˜¯å¤–ç•Œç¯å¢ƒä¸æ–­å‘ç”Ÿå˜åŒ–ï¼Œå³ä¸èƒ½è®¡ç®—é¢„æµ‹çš„æƒ…å†µä¸‹è®¡ç®—æœ€çŸ­è·¯å¾„ã€‚å¦‚åœ¨æ¸¸æˆä¸­æ•Œäººæˆ–éšœç¢ç‰©ä¸æ–­ç§»åŠ¨çš„æƒ…å†µä¸‹ã€‚å…¸å‹çš„æœ‰Dç®—æ³•ã€‚ è¿™æ˜¯Drewç¨‹åºå®ç°çš„10000ä¸ªèŠ‚ç‚¹çš„éšæœºè·¯ç½‘ä¸‰æ¡äº’ä¸ç›¸äº¤æœ€çŸ­è·¯å¾„ çœŸå®è·¯ç½‘è®¡ç®—Kæ¡è·¯å¾„ç¤ºä¾‹ï¼šèŠ‚ç‚¹5696åˆ°èŠ‚ç‚¹3006ï¼Œä¸‰æ¡æœ€å¿«è·¯å¾„ï¼Œå¯ä»¥çœ‹å‡ºè·¯å¾„åŸºæœ¬ä¸Šèµ°ç¯çº¿æˆ–ä¸»å¹²è·¯ã€‚é»‘çº¿ä¸ºç¬¬ä¸€æ¡ï¼Œè“çº¿ä¸ºç¬¬äºŒæ¡ï¼Œçº¢çº¿ä¸ºç¬¬ä¸‰æ¡ã€‚çº¦æŸæ¡ä»¶ç³»æ•°ä¸º1.2ã€‚å…±äº«éƒ¨åˆ†è·¯æ®µã€‚ Dijkstraç®—æ³•æ±‚æœ€çŸ­è·¯å¾„Dijkstraç®—æ³•æ˜¯å…¸å‹çš„æœ€çŸ­è·¯å¾„ç®—æ³•ï¼Œç”¨äºè®¡ç®—ä¸€ä¸ªèŠ‚ç‚¹åˆ°å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚ä¸»è¦ç‰¹ç‚¹æ˜¯èµ·å§‹ç‚¹ä¸ºä¸­å¿ƒå‘å¤–å±‚å±‚å±‚æ‰©å±•ï¼Œç›´åˆ°æ‰©å±•åˆ°ç»ˆç‚¹ä½ç½®ã€‚Dijkstraç®—æ³•èƒ½å¾—å‡ºæœ€çŸ­è·¯å¾„çš„æœ€ä¼˜è§£ï¼Œä½†ç”±äºå®ƒéå†è®¡ç®—çš„èŠ‚ç‚¹å¾ˆå¤šï¼Œæ‰€ä»¥æ•ˆç‡ä½ã€‚ Dijkstraç®—æ³•æ˜¯å¾ˆæœ‰ä»£è¡¨æ€§çš„æœ€çŸ­è·¯å¾„ç®—æ³•ã€‚ Dijkstraä¸€èˆ¬çš„è¡¨è¿°é€šå¸¸æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§ç”¨æ°¸ä¹…å’Œä¸´æ—¶æ ‡å·æ–¹å¼ï¼Œä¸€ç§æ˜¯ç”¨OPENï¼ŒCLOSEè¡¨æ–¹å¼ï¼ŒDrewä¸ºäº†å’Œä¸‹é¢è¦ä»‹ç»çš„Aç®—æ³•å’ŒDç®—æ³•è¡¨è¿°ä¸€è‡´ï¼Œè¿™é‡Œå‡é‡‡ç”¨OPENï¼ŒCLOSEè¡¨çš„æ–¹å¼ã€‚ å¤§æ¦‚è¿‡ç¨‹ï¼šåˆ›å»ºä¸¤ä¸ªè¡¨ï¼ŒOPENï¼ŒCLOSEã€‚ è®¿é—®è·¯ç½‘ä¸­é‡Œèµ·å§‹ç‚¹æœ€è¿‘ä¸”æ²¡æœ‰è¢«æ£€æŸ¥è¿‡çš„ç‚¹ï¼ŒæŠŠè¿™ä¸ªç‚¹æ”¾å…¥OPENç»„ä¸­ç­‰å¾…æ£€æŸ¥ã€‚ ä»OPENè¡¨ä¸­æ‰¾å‡ºè·ç¦»èµ·å§‹ç‚¹æœ€è¿‘çš„ç‚¹ï¼Œæ‰¾å‡ºè¿™ä¸ªç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼ŒæŠŠè¿™ä¸ªç‚¹æ”¾åˆ°CLOSEè¡¨ä¸­ã€‚ éå†è€ƒå¯Ÿè¿™ä¸ªç‚¹çš„å­èŠ‚ç‚¹ã€‚æ±‚å‡ºè¿™äº›å­èŠ‚ç‚¹è·ç¦»èµ·èµ·å§‹ç‚¹çš„è·ç¦»å€¼ï¼Œæ”¾å­èŠ‚ç‚¹åˆ°OPENè¡¨ä¸­ã€‚ é‡å¤2ã€3æ­¥ã€‚ç›´åˆ°OPENè¡¨ä¸ºç©ºï¼Œæˆ–æ‰¾åˆ°ç›®æ ‡ç‚¹ã€‚ åŠ¨æ€è·¯ç”±ï¼Œæœ€çŸ­è·¯å¾„ç®—æ³•D* å…ˆç”¨Dijstraç®—æ³•ä»ç›®æ ‡èŠ‚ç‚¹Gå‘èµ·å§‹èŠ‚ç‚¹æœç´¢ã€‚å­˜å‚¨è·¯ç½‘ä¸­ç›®æ ‡ç‚¹åˆ°å„ä¸ªèŠ‚ç‚¹çš„æœ€çŸ­è·¯å’Œè¯¥ä½ç½®åˆ°ç›®æ ‡ç‚¹çš„å®é™…å€¼h,kï¼ˆkä¸ºæ‰€æœ‰å˜åŒ–hä¹‹ä¸­æœ€å°çš„å€¼ï¼Œå½“å‰ä¸ºk=hã€‚æ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸Šä¸€èŠ‚åˆ°ç›®æ ‡ç‚¹çš„æœ€çŸ­è·¯ä¿¡æ¯1ï¼ˆ2ï¼‰ï¼Œ2ï¼ˆ5ï¼‰ï¼Œ5ï¼ˆ4ï¼‰ï¼‰]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[nginx]]></title>
    <url>%2F2019%2F03%2F15%2Fnginx%2F</url>
    <content type="text"><![CDATA[å¯åŠ¨ /usr/sbin/nginx -c /etc/nginx/nginx.conf é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ /usr/sbin/nginx -s reload]]></content>
  </entry>
  <entry>
    <title><![CDATA[IL2CPP]]></title>
    <url>%2F2019%2F03%2F13%2FL2CPP%2F</url>
    <content type="text"><![CDATA[ä»€ä¹ˆæ˜¯IL2CPPä»æŠ€æœ¯å±‚é¢ä¸Šæ¥è¯´ï¼ŒIL2CPPåŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼šä¸€ä¸ªè¿›è¡Œé¢„å…ˆç¼–è¯‘ï¼ˆahead-of-timeï¼Œåˆå«AOTï¼‰çš„ç¼–è¯‘å™¨ï¼›ä¸€ä¸ªæ”¯æŒè™šæ‹Ÿæœºçš„è¿è¡Œæ—¶åº“ã€‚ AOTç¼–è¯‘å™¨IL2CPP AOTç¼–è¯‘å™¨å®é™…çš„æ‰§è¡Œæ–‡ä»¶æ˜¯il2cpp.extã€‚åœ¨Windowså¹³å°ä½ å¯ä»¥åœ¨Unityå®‰è£…è·¯å¾„çš„Editor\Data\il2cppç›®å½•ä¸‹æ‰¾åˆ°ã€‚il2cpp.exeè¿™ä¸ªå·¥å…·æ˜¯ä¸€ä¸ªæ‰˜ç®¡ä»£ç å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå…¶å®Œå…¨ç”±C#ç¼–ç ã€‚åœ¨å¼€å‘IL2CPPçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åŒæ—¶ä½¿ç”¨.NETå’ŒMonoç¼–è¯‘å™¨å¯¹å…¶è¿›è¡Œç¼–è¯‘ã€‚ il2cppæ¥å—æ¥è‡ªUnityè‡ªå¸¦çš„æˆ–è€…ç”±Monoç¼–è¯‘å™¨äº§ç”Ÿçš„æ‰˜ç®¡ç¨‹åºé›†ï¼Œå°†è¿™äº›ç¨‹åºé›†è½¬æ¢æˆC++ä»£ç ã€‚è¿™äº›è½¬åŒ–å‡ºçš„C++ä»£ç æœ€ç»ˆç”±éƒ¨ç½²ç›®æ ‡å¹³å°çš„C++ç¼–è¯‘å™¨è¿›è¡Œç¼–è¯‘ã€‚ ä½ å¯ä»¥å‚ç…§ä¸‹å›¾ç†è§£IL2CPPå·¥å…·é“¾çš„ä½œç”¨ï¼š è¿è¡Œæ—¶åº“IL2CPPçš„å¦å¤–ä¸€ä¸ªéƒ¨åˆ†å°±æ˜¯å¯¹è™šæ‹Ÿæœºæä¾›æ”¯æŒçš„è¿è¡Œæ—¶åº“ã€‚æˆ‘ä»¬åŸºæœ¬ä¸Šæ˜¯ç”¨C++ä»£ç æ¥å®ç°æ•´ä¸ªè¿è¡Œæ—¶åº“çš„ï¼ˆå…¶å®é‡Œé¢è¿˜æ˜¯æœ‰ä¸€äº›å’Œå¹³å°ç›¸å…³çš„ä»£ç ä½¿ç”¨äº†ç¨‹åºé›†ï¼‰ã€‚æˆ‘ä»¬æŠŠè¿è¡Œæ—¶åº“ç§°ä¹‹ä¸ºlibli2cppï¼Œå®ƒæ˜¯ä½œä¸ºä¸€ä¸ªé™æ€åº“è¢«è¿æ¥åˆ°æœ€ç»ˆçš„æ¸¸æˆå¯è¡Œæ€§æ–‡ä»¶ä¸­ã€‚è¿™ä¹ˆåšçš„ä¸€ä¸ªä¸»è¦çš„å¥½å¤„æ˜¯å¯ä»¥ä½¿å¾—æ•´ä¸ªIL2CPPæŠ€æœ¯æ˜¯ç®€å•å¹¶ä¸”æ˜¯å¯ç§»æ¤çš„ã€‚ AOTç¼–è¯‘å™¨å°†ç”±.Netè¾“å‡ºçš„ä¸­é—´è¯­è¨€ILä»£ç ç”ŸæˆC++ä»£ç ã€‚è¿è¡Œæ—¶åº“åˆ™æä¾›è¯¸å¦‚åƒåœ¾å›æ”¶ï¼Œä¸å¹³å°æ— å…³çš„çº¿ç¨‹ï¼ŒIOä»¥åŠå†…éƒ¨è°ƒç”¨ï¼ˆC++åŸç”Ÿä»£ç ç›´æ¥è®¿é—®æ‰˜ç®¡ä»£ç ç»“æ„ï¼‰è¿™æ ·çš„æœåŠ¡å±‚å’ŒæŠ½è±¡å±‚ã€‚]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å›¾å½¢å­¦]]></title>
    <url>%2F2019%2F03%2F13%2Fgraphics%2F</url>
    <content type="text"><![CDATA[å‘é‡ç§¯æ¨¡é•¿ï¼šï¼ˆåœ¨è¿™é‡Œ$\theta$è¡¨ç¤ºä¸¤å‘é‡ä¹‹é—´çš„å¤¹è§’ï¼ˆå…±èµ·ç‚¹çš„å‰æä¸‹ï¼‰ï¼ˆ$0^ã€‚\le \theta \le 180^ã€‚$ï¼‰ï¼Œå®ƒä½äºè¿™ä¸¤ä¸ªçŸ¢é‡æ‰€å®šä¹‰çš„å¹³é¢ä¸Šã€‚ï¼‰å‘é‡ç§¯æ»¡è¶³äº¤æ¢å¾‹ã€‚ $|\vec a \times \vec b| = |\vec a| \cdot |\vec b| \cdot sin\theta$ æ–¹å‘ï¼šaå‘é‡ä¸bå‘é‡çš„å‘é‡ç§¯çš„æ–¹å‘ä¸è¿™ä¸¤ä¸ªå‘é‡æ‰€åœ¨å¹³é¢å‚ç›´ï¼Œä¸”éµå®ˆå³æ‰‹å®šåˆ™ã€‚ï¼ˆä¸€ä¸ªç®€å•çš„ç¡®å®šæ»¡è¶³â€œå³æ‰‹å®šåˆ™â€çš„ç»“æœå‘é‡çš„æ–¹å‘çš„æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼šè‹¥åæ ‡ç³»æ˜¯æ»¡è¶³å³æ‰‹å®šåˆ™çš„ï¼Œå½“å³æ‰‹çš„å››æŒ‡ä»aä»¥ä¸è¶…è¿‡180åº¦çš„è½¬è§’è½¬å‘bæ—¶ï¼Œç«–èµ·çš„å¤§æ‹‡æŒ‡æŒ‡å‘çš„æ–¹å‘å°±æ˜¯cçš„æ–¹å‘ã€‚ï¼‰ è®¡ç®—å¤šè¾¹å½¢é¢ç§¯è®¾å¤šè¾¹å½¢æœ‰nä¸ªé¡¶ç‚¹$V_{0}(X_0,Y_0),V_{1}(X_1,Y_1)â€¦V_{n-1}(X_n-1,Y_n-1)$ï¼Œä»åŸç‚¹O(0,0)ä¸æ¯æ¡è¾¹åšä¸‰è§’å½¢ï¼Œè®¡ç®—çš„é¢ç§¯å’Œå°±æ˜¯å¤šè¾¹å½¢é¢ç§¯ã€‚ä¸‰è§’å½¢çš„é¢ç§¯å¯ä»¥ç”¨å‰ç§¯è®¡ç®—ï¼Œæ¯”å¦‚$OV_{0}V_1$é¢ç§¯ä¸ºï¼š $S_{0}=0.5 * OV_{0} \cdot OV_{1} = 0.5 * (X_{0}Y_{1} - X_{1}Y_{0})$ åˆ¤æ–­ä¸¤çº¿æ®µæ˜¯å¦ç›¸äº¤åˆ¤æ–­çº¿æ®µæ˜¯å¦ç›¸äº¤ä¸€èˆ¬åˆ†ä¸ºä¸¤æ­¥è¿›è¡Œ å¿«é€Ÿæ’åºè®¾æœ‰çº¿æ®µ$P_{1}P_{2}$å’Œ$Q_{1}Q_{2}$ï¼Œä»¥çº¿æ®µ$P_{1}P_{2}$ä¸ºå¯¹è§’çº¿çš„çŸ©å½¢ä¸ºRï¼Œä»¥çº¿æ®µ$Q_{1}Q_{2}$ä¸ºå¯¹è§’çº¿çš„çŸ©å½¢ä¸ºTï¼Œå¦‚æœRå’ŒTä¸æƒ³äº¤ï¼Œæ˜¾ç„¶ä¸¤çº¿æ®µä¸ä¼šç›¸äº¤ï¼Œå¦åˆ™è¿›å…¥ç¬¬äºŒæ­¥ã€‚ è·¨ç«‹å®éªŒå¦‚æœä¸¤çº¿æ®µå…ˆäº¤ï¼Œé‚£ä¹ˆä¸¤çº¿æ®µå¿…ç„¶äº’ç›¸è·¨ç«‹å¯¹æ–¹ã€‚ å¤æ•°æŠŠåˆ‘è¾±z=a+biï¼ˆaï¼Œbå‡ä¸ºå®æ•°ï¼‰çš„æ•°æˆä¸ºå¤æ•°ï¼Œå…¶ä¸­aç§°ä¸ºå®éƒ¨ï¼Œbç§°ä¸ºè™šéƒ¨ï¼Œiç§°ä¸ºè™šæ•°å•ä½ã€‚å½“è™šéƒ¨ç­‰äºé›¶æ—¶ï¼Œè¿™ä¸ªå¤æ•°å¯ä»¥è§†ä¸ºå®æ•°ï¼›å½“zçš„è™šéƒ¨ä¸ç­‰äºé›¶æ—¶ï¼Œå®éƒ¨ç­‰äºé›¶æ—¶ï¼Œå¸¸ç§°zä¸ºçº¯è™šæ•°ã€‚ æ•°é›†æ‰©å±•åˆ°å®æ•°èŒƒå›´å†…ï¼Œä»æœ‰äº›è¿ç®—æ— æ³•è¿›è¡Œï¼ˆæ¯”å¦‚å¯¹å¤æ•°å¼€å¶æ•°æ¬¡æ–¹ï¼‰ï¼Œä¸ºäº†ä½¿æ–¹ç¨‹æœ‰è§£ï¼Œæˆ‘ä»¬å°†æ•°é›†å†æ¬¡æ‰©å……ã€‚åœ¨å®æ•°åŸŸä¸Šå®šä¹‰äºŒå…ƒæœ‰åºå¯¹z=(a,b)ï¼Œå¹¶è§„å®šæœ‰åºå¯¹ä¹‹é—´æœ‰è¿ç®—â€+â€ã€â€xâ€(è®°$z_{1}=(a,b),z){2}=(c,d)$):$z_{1}+z_{2}=(a+c,b+d)$$z_{1} \times z_{2}=(ac-db,bc+ad)$ å››å…ƒæ•°å››å…ƒæ•°æ˜¯ç®€å•çš„è¶…å¤æ•°ã€‚å¤æ•°æ˜¯ç”±å®æ•°åŠ ä¸Šè™šæ•°å•ä½iç»„æˆï¼Œå…¶ä¸­i^2=-1ã€‚ç›¸ä¼¼åœ°ï¼Œå››å…ƒæ•°éƒ½æ˜¯ç”±å®æ•°åŠ ä¸Šä¸‰ä¸ªè™šæ•°å•ä½iã€jã€kç»„æˆï¼Œè€Œä¸”å®ƒä»¬æœ‰å¦‚ä¸‹çš„å…³ç³»ï¼ši^2=j^2=k^2=-1ï¼Œi^0=j^0=k^0=1ï¼Œæ¯ä¸ªå››å…ƒæ•°éƒ½æ˜¯1ã€iã€jå’Œkçš„çº¿æ€§ç»„åˆï¼Œæ—¢æ˜¯å››å…ƒæ•°ä¸€èˆ¬å¯è¡¨ç¤ºä¸ºa+bi+cj+dkï¼Œå…¶ä¸­aã€bã€cã€dæ˜¯å®æ•°ã€‚]]></content>
      <categories>
        <category>å›¾å½¢å­¦</category>
      </categories>
      <tags>
        <tag>å›¾å½¢å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Light Reflect]]></title>
    <url>%2F2019%2F03%2F12%2FLight-Reflect%2F</url>
    <content type="text"><![CDATA[å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå‘ç€å…‰çš„å¤ªé˜³ï¼Œå¤ªé˜³åº•ä¸‹æœ‰ä¸€ä¸ªâ€œç†æƒ³é•œé¢â€ï¼Œå¦‚ä¸‹å›¾ï¼šè¿™æ—¶å€™æˆ‘ä»¬æŠ½è±¡æˆæ•°å­¦å›¾æ¥è¿›è¡Œè®¡ç®—ï¼Œå¦‚ä¸‹å›¾ï¼šè¿™å¹…å›¾å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬è®¡ç®—åå°„å…‰çº¿OBï¼Œåˆ™è½¬æ¢æˆäº†è®¡ç®—OPï¼Œè¿™é‡ŒOPæ˜¯AOåœ¨æ³•å‘é‡Nä¸Šçš„æŠ•å½±ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¨å¯¼æŠ•å½±å‘é‡çš„è®¡ç®—ï¼Œå¦‚ä¸‹å›¾ï¼šæˆ‘ä»¬æ ¹æ®ç‚¹ç§¯è®¡ç®—å‡º$cos\theta$ï¼Œç„¶åé€šè¿‡$OAâ€™ = |OA| \cdot cos\theta \cdot n$(næ˜¯å•ä½æ³•å‘é‡)å°±èƒ½å¾—åˆ°ï¼Œå‘é‡çš„æŠ•å½±å…¬å¼ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬åœ¨å›è¿‡å¤´æ¥æ¨å¯¼$OB = AO + 2OP$çš„ç»“æœï¼Œå¦‚ä¸‹å›¾ï¼š]]></content>
      <categories>
        <category>Unity Shader</category>
      </categories>
      <tags>
        <tag>Math</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Shaderç”¨åˆ°çš„ä¸‰è§’å‡½æ•°]]></title>
    <url>%2F2019%2F03%2F09%2Ftrigonometric-function%2F</url>
    <content type="text"><![CDATA[æ­£å¼¦ã€ä½™å¼¦ã€æ­£åˆ‡ æ­£å¼¦ã€ä½™å¼¦æ›²çº¿ æ­£å¼¦æ›²çº¿å…¬å¼å¯è¡¨ç¤ºä¸º$y = Asin({\omega}x+\phi)+k$Aï¼šæŒ¯å¹…ï¼Œæœ€é«˜å’Œæœ€ä½çš„è·ç¦»ï¼ˆshaderä¸­ç†è§£ä¸ºç¦»åœ†å¿ƒæœ€è¿‘å’Œæœ€è¿œçš„è·ç¦»ï¼‰Wï¼šè§’é€Ÿåº¦ï¼Œç”¨äºæ§åˆ¶å‘¨æœŸï¼ˆshaderä¸­ç†è§£ä¸ºåœˆæ•°ï¼‰Kï¼šåè·ï¼Œæ›²çº¿æ•´ä½“ä¸Šä¸‹åç§»é‡ï¼ˆshaderä¸­ç†è§£ä¸ºå¤šè¾¹å½¢æ•´ä½“å¤§å°ï¼‰ ä½™å¼¦ï¼ˆæ­£å¼¦ï¼‰æ›²çº¿å’Œåœ†çš„åŸºæœ¬å…³ç³» æ ¹æ®ä½™å¼¦ï¼ˆæˆ–æ­£å¼¦ï¼‰æ›²çº¿ä¸å›­çš„åŸºæœ¬å…³ç³»ã€‚${\omega}t={\omega}x=è§’åº¦$]]></content>
      <categories>
        <category>Math</category>
      </categories>
      <tags>
        <tag>Math</tag>
        <tag>Unity Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MathJax]]></title>
    <url>%2F2019%2F03%2F09%2FMathJax%2F</url>
    <content type="text"><![CDATA[å¸Œè…Šå­—æ¯ å°å†™ Tex å¤§å†™ Tex $\alpha$ \alpha $\beta$ \beta $\gamma$ \gamma $\delta$ \delta $\epsilon$ \epsilon $\zeta$ \zeta $\eta$ \eta $\theta$ \theta $\upsilon$ \upsilon $\phi$ \phi $\omega$ \omega $\Omega$ \Omega $\in$ \in $\lambda$ \lambad $\Lambda$ \Lambda è‹¥éœ€è¦å¤§å†™å¸Œè…Šå­—æ¯ï¼Œå°†å‘½ä»¤é¦–å­—æ¯å¤§å†™å³å¯ã€‚ \Omega å‘ˆç°ä¸º $\Omega$ éœ€éœ€è¦æ–œä½“å¸Œè…Šå­—æ¯ï¼Œå°†å‘½ä»¤å‰é¢åŠ ä¸Švarã€‚\varpi å‘ˆç°ä¸º $\varPi$ å­—æ¯ä¿®é¥°ä¸Šä¸‹æ ‡ ä¸Šæ ‡ï¼š^ ä¸‹æ ‡ï¼š_ ä¸¾ä¾‹ï¼šc_n^2å‘ˆç°ä¸º$c_n^2$ åˆ†æ•°æœ‰ä¸¤ç§æ–¹æ³•æ¥æ˜¾ç¤ºåˆ†æ•°ï¼Œä¸€ç§æ˜¯ \frac a b æ˜¾ç¤º$\frac a b$ï¼Œå¦ä¸€ç§æ˜¯ç”¨\overï¼Œå¦‚{a+1 \over b+1}æ˜¾ç¤º${a+1 \over b+1}$ æ±‚å’Œä¸ç§¯åˆ†\sumç”¨æ¥è¡¨ç¤ºæ±‚å’Œç¬¦å·ï¼Œå…¶ä¸‹æ ‡è¡¨ç¤ºæ±‚å’Œä¸Šçº¿ï¼Œå•†æ ‡è¡¨ç¤ºä¸Šé™ã€‚å¦‚\sum_1^nï¼š$\sum_1^n$ \int \int_0^\infty{fxdx} å‘ˆç°ä¸º$\int_0^\infty{fxdx}$ ç‰¹æ®Šç¬¦å·å’Œè®°å· \lt \gt \le \ge \neq è¡¨ç¤º $\lt \gt \le \ge \neq$ï¼Œè¿˜å¯ä»¥åœ¨ä¸ç­‰å·ä¸ŠåŠ \notï¼Œå¦‚\not\lt è¡¨ç¤º $\not\lt$ \times \div \pm \mp è¡¨ç¤º $\times \div \pm \mp$ï¼Œç‚¹ä¹˜ç”¨\cdotè¡¨ç¤ºï¼Œå¦‚ x \cdot y è¡¨ç¤º $x \cdot y$ çŸ¢é‡\vec{a} \cdot \vec{b} = 0 æ˜¾ç¤º $\vec{a} \cdot \vec{b} = 0$]]></content>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity Shader:ä¼˜åŒ–GPUä»£ç ï¼Œç”¨step()ä»£æ›¿if seleç­‰æ¡ä»¶è¯­å¥]]></title>
    <url>%2F2019%2F03%2F09%2FUS-Step%2F</url>
    <content type="text"><![CDATA[æ™®é€šçš„å¡é€šç€è‰²Shaderå…ˆçœ‹ä¸€ä¸ªShaderï¼Œå¡é€šç€è‰²ã€‚ç”±äºå¡é€šç€è‰²éœ€è¦å¯¹ä¸åŒæ¸²æŸ“åŒºåŸŸè¿›è¡Œåˆ¤å®šï¼Œæ¯”è¾ƒé€‚åˆåšæ¡ˆä¾‹ã€‚]]></content>
      <categories>
        <category>Unity Shader</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity Avatar]]></title>
    <url>%2F2019%2F03%2F08%2FUnity-Avatar%2F</url>
    <content type="text"></content>
      <categories>
        <category>Unity3D</category>
      </categories>
      <tags>
        <tag>Unity3D</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity Reflection]]></title>
    <url>%2F2019%2F03%2F06%2FUnity-Reflection%2F</url>
    <content type="text"><![CDATA[æ¦‚å¿µåå°„æ˜¯.NETä¸­çš„é‡è¦æœºåˆ¶ï¼Œé€šè¿‡åå°„ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶è·å¾—ç¨‹åºæˆ–è€…ç¨‹åºé›†ä¸­æ¯ä¸€ä¸ªç±»å‹ï¼ˆåŒ…æ‹¬ç±»ã€ç»“æ„ã€å§”æ‰˜ã€æ¥å£å’Œæšä¸¾ç­‰ï¼‰çš„æˆå‘˜å’Œæˆå‘˜çš„ä¿¡æ¯ã€‚å¦å¤–è¿˜å¯ä»¥ç›´æ¥åˆ›å»ºå¯¹è±¡ï¼Œå³ä½¿è¿™ä¸ªå¯¹è±¡çš„ç±»å‹åœ¨ç¼–è¯‘æ—¶è¿˜ä¸çŸ¥é“ã€‚ ç”¨é€” ä½¿ç”¨Assemblyå®šä¹‰å’ŒåŠ è½½ç¨‹åºé›†ï¼ŒåŠ è½½åœ¨ç¨‹åºé›†æ¸…å•ä¸­åˆ—å‡ºæ¨¡å—ï¼Œä»æ­¤ç¨‹åºé›†ä¸­æŸ¥æ‰¾ç±»å‹å¹¶åˆ›å»ºå¹¶åˆ›å»ºè¯¥ç±»å‹çš„å®ä¾‹ã€‚ ä½¿ç”¨Moduleäº†è§£åŒ…å«æ¨¡å—çš„ç¨‹åºé›†ä»¥åŠæ¨¡å—ä¸­çš„ç±»ç­‰ï¼Œè¿˜å¯ä»¥è·å–åœ¨æ¨¡å—ä¸Šå®šä¹‰çš„æ‰€æœ‰å…¨å±€æ–¹æ³•æˆ–å…¶ä»–ç‰¹å®šçš„éå…¨å±€æ–¹æ³•ã€‚ ä½¿ç”¨ConstructorInfoäº†è§£æ„é€ å‡½æ•°çš„åç§°ï¼Œå‚æ•°ï¼Œè®¿é—®ä¿®é¥°ç¬¦ï¼ˆå¦‚publicæˆ–privateï¼‰å’Œå®ç°è¯¦ç»†ä¿¡æ¯ï¼ˆå¦‚abstractæˆ–virtualï¼‰ç­‰ã€‚ ä½¿ç”¨MethodInfoäº†è§£æ–¹æ³•çš„åç§°ï¼Œè¿”å›ç±»å‹ï¼Œå‚æ•°ï¼Œè®¿é—®ä¿®é¥°ç¬¦ï¼ˆå¦‚publicæˆ–privateï¼‰å’Œå®ç°è¯¦ç»†ä¿¡æ¯ï¼ˆå¦‚abstractæˆ–virtualï¼‰ç­‰ã€‚ ä½¿ç”¨FieldInfoäº†è§£å­—æ®µçš„åç§°ã€è®¿é—®ä¿®é¥°ç¬¦ï¼ˆå¦‚publicæˆ–privateï¼‰å’Œå®ç°ç›¸ä¿¡ä¿¡æ¯ï¼ˆå¦‚staticï¼‰ç­‰ï¼Œå¹¶è·å–æˆ–è®¾ç½®å­—æ®µå€¼ã€‚ ä½¿ç”¨EventInfoäº†è§£äº‹ä»¶çš„åç§°ã€äº‹ä»¶å¤„ç†ç¨‹åºæ•°æ®ç±»å‹ã€è‡ªå®šä¹‰å±æ€§ã€å£°æ˜ç±»å‹å’Œåå°„ç±»å‹ç­‰ï¼Œæ·»åŠ æˆ–ç§»é™¤äº‹ä»¶å¤„ç†ç¨‹åºã€‚ ä½¿ç”¨PropertyInfoäº†è§£å±æ€§çš„åç§°ã€æ•°æ®ç±»å‹ã€å£°æ˜ç±»å‹ã€åå°„ç±»å‹å’Œåªè¯»æˆ–å¯å†™çŠ¶æ€ç­‰ï¼Œè·å–æˆ–è®¾ç½®å±æ€§å€¼ã€‚ ä½¿ç”¨ParameterInfoäº†è§£å‚æ•°çš„åç§°ã€æ•°æ®ç±»å‹ã€æ˜¯è¾“å…¥å‚æ•°è¿˜æ˜¯è¾“å‡ºå‚æ•°ï¼Œä»¥åŠå‚æ•°åœ¨æ–¹æ³•ç­¾åä¸­çš„ä½ç½®ç­‰ã€‚ éœ€è¦çš„namespaceSystem.Reflection; System.Type; System.Reflection.Assembly; ä¸»è¦ç±»System.Type // é€šè¿‡è¿™ä¸ªç±»å¯ä»¥è®¿é—®ä»»ä½•ç»™å®šæ•°æ®ç±»å‹çš„ä¿¡æ¯ System.Reflection.Assembly; // è®¿é—®æˆ–è€…åŠ è½½ç¨‹åºé›†çš„ä¿¡æ¯ System.TypeSystem.Typeç±»å¯¹äºåå°„èµ·ç€æ ¸å¿ƒçš„ä½œç”¨ã€‚å®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡çš„åŸºç±»ï¼ŒTypeæœ‰ä¸æ¯ç§æ•°æ®ç±»å‹å¯¹åº”çš„æ´¾ç”Ÿç±»ã€‚1234567891011121314151617181920212223242526272829// å±æ€§string Name &#123;get;&#125; // æ•°æ®ç±»å‹åstring FullName &#123;get;&#125; // æ•°æ®ç±»å‹çš„å®Œå…¨é™å®šåï¼ˆåŒ…æ‹¬å‘½åç©ºé—´ï¼‰string Namespace; // å‘½åç©ºé—´åbool IsAbstract; // æ˜¯å¦æŠ½è±¡bool IsArray; // æ˜¯å¦æ•°ç»„bool IsClass; // æ˜¯å¦ç±»bool IsEnum; // æ˜¯å¦æšä¸¾bool IsInterface; // æ˜¯å¦æ¥å£bool IsPublic; // æ˜¯å¦æ˜¯å…¬æœ‰çš„ç±»å‹bool IsSealed; // æ˜¯å¦æ˜¯å¯†å°ç±»bool IsValueType; // æ˜¯å¦æ˜¯æŒ‡ç±»å‹// æ–¹æ³•// ç”¨äºå–å¾—è¯¥ç±»çš„æ„é€ å‡½æ•°çš„ä¿¡æ¯public ConstructorInfo GetConstructor();// åŒä¸Špublic ConstructorInfo[] GetConstructors();// å–å¾—è¯¥ç±»çš„äº‹ä»¶ä¿¡æ¯public EventInfo GetEvent();public EventInfo[] GetEvents();public FieldInfo GetField();public FieldInfo[] GetFields();public InterfaceInfo GetInterFace();public InterfaceInfo[] GetInterFaces();public MemberInfo GetMember();public MemberInfos GetMembers();public PropertyInfo GetProperty();public PropertyInfo[] GetProperties();// è°ƒç”¨ä¸Šè¿°æˆå‘˜ï¼Œæ–¹å¼æ˜¯è°ƒç”¨Typeçš„InvokeMember()æ–¹æ³•ï¼Œæˆ–è€…è°ƒç”¨MethodInfoï¼ŒPropertyInfoçš„Invokeæ–¹æ³• 123456789101112// æŸ¥çœ‹ç±»çš„æ„é€ æ–¹æ³•NewClass nc = new NewClass();Type t = nc.GetType();ConstructorInfo[] ci = t.GetConstructors(); // è·å–ç±»çš„æ‰€æœ‰æ„é€ å‡½æ•°foreach (ConstructorInfo c in ci)&#123; ParamterInfo[] ps = c.GetParameters(); foreach (ParamterInfo pi in ps) &#123; Debug.Log("&#123;0&#125;\t&#123;1&#125;", pi.ParamterType.ToString(), pi.Name); &#125;&#125; 1234567891011// ç”¨æ„é€ å‡½æ•°åŠ¨æ€ç”Ÿæˆå¯¹è±¡Type t = typeof(NewClass);Type[] pt = new Type[2];pt[0] = typeof(string);pt[1] = typeof(string);// æ ¹æ®å‚æ•°ç±»å‹è·å–æ„é€ å‡½æ•°ConstructorInfo ci = t.GetConstructor(pt);// æ„é€ Objectæ•°ç»„ï¼Œä½œä¸ºæ„é€ å‡½æ•°çš„è¾“å…¥å‚æ•°object[] obj = new object[2]&#123;"Liyanfeng", "Hello World"&#125;;// è°ƒç”¨æ„é€ å‡½æ•°ç”Ÿæˆå¯¹è±¡object o = ci.Invoke(obj); 1234// ç”¨Activatorç”Ÿæˆå¯¹è±¡Type t = typeof(NewClass);// ç”¨Activatorçš„CreateInstanceé™æ€æ–¹æ³•ï¼Œç”Ÿæˆæ–°å¯¹è±¡object o = Activator.CreateInstance(t, "Liyanfeng", "Hello World"); è·å–ç»™å®šç±»å‹çš„Typeå¼•ç”¨æœ‰3ä¸­å¸¸ç”¨æ–¹å¼123456789101112// ä½¿ç”¨typeofè¿ç®—å•ŠType t = typeof(string);// ä½¿ç”¨å¯¹è±¡GetType()æ–¹æ³•string s = "Liyanfeng";Type t = s.GetType();// è°ƒç”¨Typeç±»çš„é™æ€æ–¹æ³•GetType()Type t = Type.GetType("System.String");foreach(MemberInfo mi in t.GetMembers())&#123; Debug.Log("&#123;0&#125;/t&#123;1&#125;", mi.MemberType, mi.Name);&#125;]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å›¾å½¢æ¸²æŸ“åŠä¼˜åŒ–-Batch]]></title>
    <url>%2F2019%2F03%2F05%2FBatch%2F</url>
    <content type="text"><![CDATA[æ‰¹å¤„ç†ï¼ˆBatchï¼‰å°±æ˜¯å¯¹æŸå¯¹è±¡è¿›è¡Œæ‰¹é‡çš„å¤„ç†ï¼Œæœ¬æ–‡ä»‹ç»ä¸€ä¸‹Batchçš„åŸºæœ¬æ¦‚å¿µã€]]></content>
      <tags>
        <tag>å›¾å½¢</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[C# Jobs System]]></title>
    <url>%2F2019%2F03%2F05%2FCsharpJobSystem%2F</url>
    <content type="text"><![CDATA[Unity Cï¼ƒ Job Systemå…è®¸ç”¨æˆ·ç¼–å†™ä¸Unityå…¶ä½™éƒ¨åˆ†è‰¯å¥½äº¤äº’çš„å¤šçº¿ç¨‹ä»£ç ï¼Œå¹¶ä½¿ç¼–å†™æ­£ç¡®çš„ä»£ç å˜å¾—æ›´åŠ å®¹æ˜“ã€‚ç¼–å†™å¤šçº¿ç¨‹ä»£ç å¯ä»¥æä¾›é«˜æ€§èƒ½çš„å¥½å¤„ã€‚å…¶ä¸­åŒ…æ‹¬æ˜¾ç€æé«˜å¸§é€Ÿç‡å’Œå»¶é•¿ç§»åŠ¨è®¾å¤‡çš„ç”µæ± å¯¿å‘½ã€‚Cï¼ƒ Job Systemçš„ä¸€ä¸ªé‡è¦æ–¹é¢æ˜¯å®ƒä¸Unityå†…éƒ¨ä½¿ç”¨çš„é›†æˆï¼ˆUnityçš„native jobsystemï¼‰ã€‚ç”¨æˆ·ç¼–å†™çš„ä»£ç å’ŒUnityå…±äº«å·¥ä½œçº¿ç¨‹ã€‚è¿™ç§åˆä½œé¿å…äº†å¯¼è‡´äº‰ç”¨CPUèµ„æºçš„é—®é¢˜ï¼Œå¹¶ä¸”å¯ä»¥åˆ›å»ºæ¯”CPUæ ¸å¿ƒæ›´å¤šçš„çº¿ç¨‹ã€‚ å¤šçº¿ç¨‹åœ¨å•çº¿ç¨‹è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œä¸€æ¬¡åªèƒ½è¿›å…¥ä¸€æ¡æŒ‡ä»¤ï¼Œå¹¶ä¸”åªèƒ½å¾—å‡ºä¸€ä¸ªç»“æœã€‚åŠ è½½å’Œå®Œæˆç¨‹åºçš„æ—¶é—´å–å†³äºCPUéœ€è¦å®Œæˆçš„å·¥ä½œé‡ã€‚å¤šçº¿ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹ï¼Œå®ƒåˆ©ç”¨CPUåœ¨å¤šä¸ªå†…æ ¸ä¸ŠåŒæ—¶å¤„ç†å¤šä¸ªçº¿ç¨‹çš„èƒ½åŠ›ï¼Œå®ƒä¸æ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ‰§è¡Œä»»åŠ¡æˆ–æŒ‡ä»¤ï¼Œè€Œæ˜¯åŒæ—¶è¿è¡Œçš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªçº¿ç¨‹åœ¨ç¨‹åºçš„å¼€å¤´è¿è¡Œã€‚è¿™æ˜¯â€œä¸»çº¿ç¨‹â€ã€‚ä¸»çº¿ç¨‹åˆ›å»ºæ–°çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ã€‚è¿™äº›æ–°çº¿ç¨‹å½¼æ­¤å¹¶è¡Œè¿è¡Œï¼Œå¹¶ä¸”é€šå¸¸åœ¨å®Œæˆåå°†å…¶ç»“æœä¸ä¸»çº¿ç¨‹åŒæ­¥ã€‚å¦‚æœæœ‰ä¸€äº›è¿è¡Œå¾ˆé•¿æ—¶é—´çš„ä»»åŠ¡ï¼Œè¿™ç§å¤šçº¿ç¨‹æ–¹æ³•å¾ˆæœ‰æ•ˆã€‚ä½†æ˜¯ï¼Œæ¸¸æˆå¼€å‘ä»£ç é€šå¸¸åŒ…å«è®¸å¤šä¸€æ¬¡æ‰§è¡Œçš„å°æŒ‡ä»¤ã€‚å¦‚æœä¸ºæ¯ä¸ªå°æŒ‡ä»¤åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œæœ€ç»ˆå¯èƒ½ä¼šæœ‰è®¸å¤šçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸéƒ½å¾ˆçŸ­ã€‚è¿™å¯ä»¥æ¨åŠ¨CPUå’Œæ“ä½œç³»ç»Ÿå¤„ç†èƒ½åŠ›çš„æé™ã€‚é€šè¿‡æ‹¥æœ‰ä¸€ä¸ªçº¿ç¨‹æ± å¯ä»¥ç¼“è§£çº¿ç¨‹ç”Ÿå­˜æœŸçš„é—®é¢˜ã€‚ä½†æ˜¯ï¼Œå³ä½¿ä½¿ç”¨çº¿ç¨‹æ± ï¼Œä¹Ÿå¯èƒ½åŒæ—¶æ¿€æ´»å¤§é‡çº¿ç¨‹ã€‚çº¿ç¨‹æ•°å¤šäºCPUæ ¸å¿ƒå¯¼è‡´çº¿ç¨‹ç›¸äº’äº‰ç”¨CPUèµ„æºï¼Œå¯¼è‡´é¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚ä¸Šä¸‹æ–‡åˆ‡æ¢æ˜¯é€šè¿‡æ‰§è¡Œä¿å­˜çº¿ç¨‹çŠ¶æ€çš„è¿‡ç¨‹ï¼Œç„¶åå¤„ç†å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œç„¶åé‡æ–°æ„å»ºç¬¬ä¸€ä¸ªçº¿ç¨‹ï¼Œä»¥ä¾¿ç»§ç»­å¤„ç†å®ƒã€‚ä¸Šä¸‹æ–‡åˆ‡æ¢æ˜¯èµ„æºå¯†é›†å‹çš„ï¼Œå› æ­¤æ‚¨åº”å°½å¯èƒ½é¿å…ä½¿ç”¨å®ƒã€‚å¤§å¤šæ•°ä½¿ç”¨å¤šçº¿ç¨‹ä»£ç çš„äººéƒ½çŸ¥é“ç¼–å†™çº¿ç¨‹å®‰å…¨ä»£ç å¾ˆéš¾ï¼Œçº¿ç¨‹äº‰æŠ¢èµ„æºå¯èƒ½ä¼šå‘ç”Ÿï¼Œä½†æœºä¼šéå¸¸å°‘ï¼Œå¦‚æœç¨‹åºå‘˜æ²¡æœ‰æƒ³åˆ°è¿™ä¸ªé—®é¢˜ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ½œåœ¨çš„ä¸¥é‡é”™è¯¯ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢çš„æˆæœ¬å¾ˆé«˜ï¼Œå› ä¸ºå­¦ä¹ å¦‚ä½•å¹³è¡¡å·¥ä½œè´Ÿè½½å·²å°½å¯èƒ½é«˜æ•ˆåœ°è¿è¡Œæ˜¯å¾ˆå›°éš¾çš„ã€‚ Job SystemJob Systemé€šè¿‡åˆ›å»ºJobè€Œä¸æ˜¯çº¿ç¨‹æ¥ç®¡ç†å¤šçº¿ç¨‹ä»£ç ã€‚Job Systemè·¨å¤šä¸ªæ ¸å¿ƒç®¡ç†ä¸€ç»„å·¥ä½œçº¿ç¨‹ã€‚å®ƒé€šå¸¸æ¯ä¸ªé€»è¾‘CPUæ ¸å¿ƒæœ‰ä¸€ä¸ªå·¥ä½œçº¿ç¨‹ï¼Œä»¥é¿å…ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆå°½ç®¡å®ƒå¯èƒ½ä¸ºæ“ä½œç³»ç»Ÿæˆ–å…¶ä»–ä¸“ç”¨åº”ç”¨ç¨‹åºä¿ç•™ä¸€äº›æ ¸å¿ƒï¼‰ã€‚Job Systemå°†Jobæ”¾å…¥ä½œä¸šé˜Ÿåˆ—ä¸­ç”¨æ¥æ‰§è¡Œã€‚Job Systemä¸­çš„å·¥ä½œçº¿ç¨‹ä»ä½œä¸šé˜Ÿåˆ—ä¸­è·å–Jobå¹¶æ‰§è¡Œå®ƒä»¬ã€‚ä½œä¸šç³»ç»Ÿç®¡ç†ä¾èµ–å…³ç³»å¹¶ç¡®ä¿ä½œä¸šä»¥é€‚å½“çš„é¡ºåºæ‰§è¡Œã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ç®€å•çš„å­å¼¹è¿åŠ¨ç³»ç»Ÿï¼Œå¤§å¤šæ•°ç¨‹åºå‘˜éƒ½ä¼šä¸ºGameObjectç¼–å†™ä¸€ä¸ªç®¡ç†å™¨ï¼Œå¦‚Bullet Managerï¼Œé€šå¸¸ï¼Œè¿™äº›ç®¡ç†å™¨ä¼šç®¡ç†ä¸€ä¸ªGameObjectsåˆ—è¡¨ï¼Œå¹¶æ¯å¸§æ›´æ–°åœºæ™¯ä¸­æ‰€æœ‰å­å¼¹æ´»åŠ¨çš„ä½ç½®ã€‚è¿™éå¸¸ç¬¦åˆä½¿ç”¨C# Jobs Systemçš„æ¡ä»¶ï¼Œç”±äºå­å¼¹è¿åŠ¨å¯ä»¥å•ç‹¬å¤„ç†ï¼Œå› æ­¤éå¸¸é€‚åˆå¹¶è¡ŒåŒ–ï¼Œå€ŸåŠ©C# Jobs Systemï¼Œå¯ä»¥è½»æ¾åœ°å°†æ­¤åŠŸèƒ½æ‹‰å‡ºæ¥ï¼Œå¹¶è¡Œè¿è¡Œä¸é€šçš„æ•°æ®å—ï¼Œä½œä¸ºå¼€å‘äººå‘˜ï¼Œåªéœ€è¦ä¸“æ³¨æ¸¸æˆé€»è¾‘ä»£ç å³å¯ã€‚ JobJobæ˜¯å®Œæˆä¸€é¡¹ç‰¹å®šä»»åŠ¡çš„ä¸€å°éƒ¨åˆ†å·¥ä½œã€‚Jobæ¥æ”¶å‚æ•°å¹¶å¯¹æ•°æ®è¿›è¡Œæ“ä½œï¼Œç±»ä¼¼äºæ–¹æ³•è°ƒç”¨çš„è¡Œä¸ºæ–¹å¼ã€‚Jobå¯ä»¥æ˜¯ç‹¬ç«‹çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¾èµ–çš„ï¼ˆéœ€è¦ç­‰å…¶ä»–ä½œä¸šå®Œæˆåï¼Œç„¶åæ‰èƒ½è¿è¡Œã€‚ï¼‰ Job ä¾èµ–åœ¨å¤æ‚çš„ç³»ç»Ÿä¸­ï¼Œå¦‚æ¸¸æˆå¼€å‘æ‰€éœ€çš„ç³»ç»Ÿï¼Œæ¯ä¸ªå·¥ä½œéƒ½ä¸å¯èƒ½æ˜¯ç‹¬ç«‹çš„ã€‚ä¸€é¡¹å·¥ä½œé€šå¸¸æ˜¯ä¸ºä¸‹ä¸€ä»½å·¥ä½œå‡†å¤‡æ•°æ®ã€‚ä½œä¸šäº†è§£å¹¶æ”¯æŒä¾èµ–å…³ç³»ä»¥ä½¿å…¶å‘æŒ¥ä½œç”¨ã€‚å¦‚æœjobAå¯¹jobBä¾èµ–ï¼Œåˆ™Job Systemç¡®ä¿åœ¨å®ŒæˆjobAä¹‹å‰ä¸ä¼šå¼€å§‹æ‰§è¡ŒjobBã€‚ å®‰å…¨ç¼–å†™å¤šçº¿ç¨‹ä»£ç æ—¶ï¼Œæ€»æ˜¯å­˜åœ¨ç«äº‰æ¡ä»¶çš„é£é™©ã€‚å½“ä¸€ä¸ªæ“ä½œçš„è¾“å‡ºå–å†³äºå…¶æ§åˆ¶ä¹‹å¤–çš„å¦ä¸€ä¸ªè¿‡ç¨‹çš„æ—¶é—´çš„æ—¶å€™ï¼Œå°±ä¼šå‘ç”Ÿç«äº‰æ¡ä»¶ã€‚ç«äº‰æ¡ä»¶å¹¶ä¸æ€»æ˜¯ä¸€ä¸ªbugï¼Œä½†æ˜¯å®ƒä¸ç¡®å®šè¡Œä¸ºçš„æ¥æºï¼Œå½“ç«äº‰æ¡ä»¶å¯¼è‡´bugçš„æ—¶å€™ï¼Œæ€»æ˜¯æ¯”è¾ƒéš¾ä»¥æ‰¾åˆ°é—®é¢˜çš„æ ¹æºã€‚å› ä¸ºå®ƒå–å†³äºæ—¶é—´ï¼Œå› æ­¤ä½ å¯èƒ½æå°‘æ•°æƒ…å†µä¸‹ä¼šå¤ç°é—®é¢˜ã€‚è°ƒè¯•çš„æ—¶å€™å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜æ¶ˆå¤±ã€‚å› æ­¤è°ƒè¯•å’Œæ—¥å¿—å¯èƒ½ä¼šæ”¹å˜bugçš„å‘ç”Ÿæ¡ä»¶ã€‚ç«äº‰æ¡ä»¶æ˜¯ç¼–å†™å¤šçº¿ç¨‹çš„æ—¶å€™é¢ä¸´çš„æ¯”è¾ƒå¤§çš„æŒ‘æˆ˜ã€‚ ä¸ºäº†æ›´å®¹æ˜“ç¼–å†™å¤šçº¿ç¨‹ä»£ç ï¼ŒJob Systemå¯ä»¥æ£€æµ‹æ‰€æœ‰æ½œåœ¨çš„ç«äº‰æ¡ä»¶ï¼Œå¹¶ä¿æŠ¤ä½ å…å—å¯èƒ½å¯¼è‡´çš„bugçš„å½±å“ã€‚ä¾‹å¦‚ï¼šå¦‚æœJob Systemå°†ä¸»çº¿ç¨‹ä¸­ä»£ç ä¸­çš„æ•°æ®å¼•ç”¨å‘é€åˆ°Jobä¸­ï¼Œåˆ™æ— æ³•éªŒè¯ä½œä¸šåœ¨å†™å…¥æ•°æ®çš„æ—¶å€™åŒæ—¶è¯»å–æ•°æ®ï¼Œè¿™ç§æƒ…å†µå°±ä¼šåˆ›å»ºç«äº‰æ¡ä»¶ã€‚ Job Systemé€šè¿‡å‘æ¯ä¸ªä½œä¸šå‘é€å®ƒéœ€è¦çš„æ“ä½œçš„æ•°æ®çš„å‰¯æœ¬æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè€Œä¸æ˜¯å¯¹ä¸»çº¿ç¨‹ä¸­çš„æ•°æ®çš„å¼•ç”¨ï¼Œè¿™ç§æ‹·è´éš”ç¦»äº†æ•°æ®ï¼Œä»è€Œæ¶ˆé™¤äº†ç«äº‰æ¡ä»¶ã€‚]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[UnityHubç ´è§£]]></title>
    <url>%2F2019%2F03%2F03%2FUnity-Hub%2F</url>
    <content type="text"><![CDATA[é€€å‡ºUnityHub npm install -g asar cd C:\Program Files\Unity Hub\resources asar extract .\app.aser app rm -rf app.asar cd app/src/services/licenseService vim licenseClient.js 1234567getLicenseInfo(callback)&#123; // load license // get latest data from licenseCore //licenseInfo.activated = licenseCore.getLicenseToken().length &gt; 0; // æ³¨é‡Šè¿™è¡Œ licenseInfo.activated = true; // æ–°å¢è¿™è¡Œ licenseInfo.flow = licenseCore.getLicenseKind();&#125; vim licenseCore.js 12345678verifyLicenseData(xml)&#123; return new Promise((resolve, reject)=&gt; resolve(true); //æ–°å¢è¿™è¡Œ if (xml === &apos;&apos;)&#123; &#125; )&#125;]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IOå¤šè·¯å¤ç”¨ä¹‹selectã€pollã€epollè¯¦è§£]]></title>
    <url>%2F2019%2F03%2F02%2FNetSocket%2F</url>
    <content type="text"><![CDATA[ç›®å‰æ”¯æŒI/Oå¤šè·¯å¤ç”¨çš„ç³»ç»Ÿè°ƒç”¨æœ‰select,pselect,poll,epoll,I/Oå¤šè·¯å¤ç”¨å°±æ˜¯é€šè¿‡ä¸€ç§æœºåˆ¶ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥ç›‘å¬å¤šä¸ªæè¿°ç¬¦ï¼Œä¸€æ—¦æŸä¸ªæè¿°ç¬¦å°±ç»ªï¼ˆä¸€èˆ¬æ˜¯è¯»å°±ç»ªæˆ–è€…å†™å°±ç»ªï¼‰ï¼Œå°±èƒ½å¤Ÿé€šçŸ¥ç¨‹åºè¿›è¡Œç›¸åº”çš„è¯»å†™æ“ä½œã€‚ä½†select,pselect,poll,epollæœ¬è´¨ä¸Šéƒ½æ˜¯åŒæ­¥I/Oï¼Œå› ä¸ºä»–ä»¬éƒ½éœ€è¦åœ¨è¯»å†™æ—¶é—´å°±ç»ªåè‡ªå·±è´Ÿè´£è¿›è¡Œè¯»å†™ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè¯»å†™è¿‡ç¨‹æ˜¯é˜»å¡çš„ï¼Œè€Œå¼‚æ­¥I/Oåˆ™æ— éœ€è‡ªå·±è´Ÿè´£è¿›è¡Œè¯»å†™ï¼Œå¼‚æ­¥I/Oçš„å®ç°ä¼šè´Ÿè´£æŠŠæ•°æ®ä»å†…æ ¸æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚ï¼ˆè¿™ä¸€æ­¥æœ‰æ€§èƒ½å¼€é”€ï¼‰ä¸å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹æŠ€æœ¯ç›¸æ¯”ï¼ŒI/Oå¤šè·¯å¤ç”¨æŠ€æœ¯çš„æœ€å¤§ä¼˜åŠ¿æ˜¯ç³»ç»Ÿå¼€é”€å°ï¼Œç³»ç»Ÿä¸å¿…åˆ›å»ºè¿›ç¨‹/çº¿ç¨‹ï¼Œä¹Ÿä¸å¿…ç»´æŠ¤è¿™äº›è¿›ç¨‹/çº¿ç¨‹ï¼Œä»è€Œå¤§å¤§å‡å°‘äº†ç³»ç»Ÿçš„å¼€é”€ã€‚ ä½¿ç”¨åœºæ™¯IOå¤šè·¯å¤ç”¨æ˜¯æŒ‡å†…æ ¸ä¸€æ—¦å‘ç”Ÿè¿›ç¨‹æŒ‡å®šçš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªIOæ¡ä»¶å‡†å¤‡è¯»å–ï¼Œå®ƒå°±é€šçŸ¥è¯¥è¿›ç¨‹ã€‚IOå¤šè·¯å¤ç”¨é€‚ç”¨å¦‚ä¸‹åœºåˆï¼š1ï¼‰å½“å®¢æˆ·å¤„ç†å¤šä¸ªæè¿°ç¬¦æ—¶ï¼ˆä¸€èˆ¬æ˜¯äº¤äº’å¼è¾“å…¥å’Œç½‘ç»œå¥—æ¥å£ï¼‰ï¼Œå¿…é¡»é€‚ç”¨I/Oå¤ç”¨ã€‚2ï¼‰å½“ä¸€ä¸ªå®¢æˆ·åŒæ—¶å¤„ç†å¤šä¸ªå¥—æ¥å£ï¼Œè¿™ç§æƒ…å†µæ˜¯å¯èƒ½çš„ï¼Œä½†å¾ˆå°‘å‡ºç°ã€‚ï¼ˆè²Œä¼¼æ²¡è§è¿‡ï¼‰3ï¼‰å¦‚æœä¸€ä¸ªTCPæœåŠ¡å™¨æ—¢è¦å¤„ç†ç›‘å¬å¥—æ¥å£ï¼Œåˆè¦å¤„ç†å·²è¿æ¥å¥—æ¥å£ï¼Œä¸€èˆ¬ä¹Ÿè¦ç”¨I/Oå¤ç”¨ã€‚ï¼ˆè¿™æ˜¯æœ€å¸¸è§çš„æ–¹å¼ï¼Œè²Œä¼¼æ²¡æœ‰å…¶ä»–å–ä»£æ–¹å¼ï¼Ÿï¼‰4ï¼‰å¦‚æœä¸€ä¸ªæœåŠ¡å™¨æ—¢è¦å¤„ç†TCPï¼Œåˆè¦å¤„ç†UDPï¼Œä¸€èˆ¬è¦ä½¿ç”¨I/Oå¤ç”¨ã€‚5ï¼‰å¦‚æœä¸€ä¸ªæœåŠ¡å™¨è¦å¤„ç†å¤šä¸ªæœåŠ¡æˆ–å¤šä¸ªåè®®ï¼Œä¸€èˆ¬è¦ä½¿ç”¨I/Oå¤ç”¨ã€‚ selectã€pollã€epollç®€ä»‹epollè·Ÿselectéƒ½èƒ½æä¾›å¤šè·¯I/Oå¤ç”¨çš„è§£å†³æ–¹æ¡ˆã€‚åœ¨ç°åœ¨çš„Linuxå†…æ ¸éƒ½æ”¯æŒï¼Œå…¶ä¸­epollæ˜¯Linuxæ‰€ç‰¹æœ‰ï¼Œè€Œselectåˆ™åº”è¯¥æ˜¯POSIXè§„å®šã€‚åŸºæœ¬æµç¨‹ï¼Œå¦‚å›¾æ‰€ç¤ºï¼šselectç›®å‰å‡ ä¹åœ¨æ‰€æœ‰çš„å¹³å°ä¸Šæ”¯æŒï¼Œå…¶è‰¯å¥½çš„è·¨å¹³å°æ”¯æŒä¹Ÿæ˜¯å®ƒçš„ä¸€ä¸ªä¼˜ç‚¹ã€‚selectçš„ä¸€ä¸ªç¼ºç‚¹åœ¨ä¸å•ä¸ªè¿›ç¨‹èƒ½å¤Ÿç›‘è§†çš„æ–‡ä»¶æè¿°ç¬¦çš„æ•°é‡å­˜åœ¨æœ€å¤§é™åˆ¶ï¼Œåœ¨Linuxä¸Šä¸€èˆ¬ä¸º1024ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹å®å®šä¹‰ç”šè‡³é‡æ–°ç¼–è¯‘å†…æ ¸çš„æ–¹å¼æå‡è¿™ä¸€é™åˆ¶ï¼Œä½†æ˜¯è¿™æ ·ä¹Ÿä¼šé€ æˆæ•ˆç‡çš„é™ä½ã€‚selectæœ¬è´¨ä¸Šæ˜¯é€šè¿‡è®¾ç½®æˆ–è€…æ£€æŸ¥å­˜æ”¾fbæ ‡å¿—ä½çš„æ•°æ®ç»“æ„æ¥è¿›è¡Œä¸‹ä¸€æ­¥å¤„ç†ã€‚è¿™æ ·æ‰€å¸¦æ¥çš„çš„ç¼ºç‚¹æ˜¯ï¼š1.selectæœ€å¤§çš„ç¼ºé™·å°±æ˜¯å•ä¸ªè¿›ç¨‹æ‰“å¼€çš„DFæ˜¯æœ‰ä¸€å®šé™åˆ¶çš„ï¼Œå®ƒç”±FD_SETSIZEè®¾ç½®ï¼Œé»˜è®¤å€¼æ˜¯1024ã€‚ä¸€èˆ¬æ¥è¯´è¿™ä¸ªæ•°ç›®å’Œç³»ç»Ÿå†…å­˜å…³ç³»å¾ˆå¤§ï¼Œå…·ä½“æ•°ç›®å¯ä»¥cat /proc/sys/fs/file-maxæŸ¥çœ‹ã€‚32ä½é»˜è®¤1024ä¸ªï¼Œ64ä½é»˜è®¤2048ä¸ªã€‚æˆ‘æŸ¥äº†ä¸€ä¸‹è‡ªå·±çš„è™šæ‹ŸæœºCentos6.0 æ˜¯95979ï¼Œä»æ•°é‡ä¸Šåˆ†ææ¥çœ‹ï¼Œå¯¹äºæ¸¸æˆæ¥è¯´ï¼Œselectæ¨¡å‹ä¸ªäººæ„Ÿè§‰è¿™ç‚¹å¯ä»¥å¿½è§†äº†ã€‚2.å¯¹socketè¿›è¡Œæ‰«ææ˜¯çº¿æ€§æ‰«æï¼Œå³é‡‡ç”¨è½®è¯¢çš„æ–¹æ³•ï¼Œæ•ˆç‡è¾ƒä½ã€‚å½“å¥—æ¥å­—æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œæ¯æ¬¡select()éƒ½è¦é€šè¿‡éå†FD_SETSIZEä¸ªSocketæ¥å®Œæˆè°ƒåº¦ï¼Œä¸ç®¡å“ªä¸ªSocketæ˜¯æ´»è·ƒçš„ï¼Œéƒ½éå†ä¸€éã€‚ï¼ˆè¿™å¯å¤ªæ‰¯äº†ï¼‰è¿™ä¼šæµªè´¹å¾ˆå¤šCPUæ—¶é—´ã€‚å¦‚æœèƒ½ç»™å¥—æ¥å­—æ³¨å†ŒæŸä¸ªå›è°ƒå‡½æ•°ï¼Œå½“ä»–ä»¬æ´»è·ƒæ—¶ï¼Œè‡ªåŠ¨å®Œæˆç›¸å…³æ“ä½œï¼Œé‚£å°±é¿å…äº†è½®è¯¢ï¼Œè¿™æ­£æ˜¯epollä¸kqueueåšçš„ã€‚3.éœ€è¦ç»´æŠ¤ä¸€ä¸ªç”¨æ¥å­˜æ”¾å¤§é‡fdçš„æ•°æ®ç»“æ„ï¼Œè¿™æ ·ä¼šä½¿å¾—ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´åœ¨ä¼ é€’è¯¥ç»“æ„æ—¶å¤åˆ¶å¼€é”€å¾ˆå¤§ã€‚ pollpollæ˜¯selectçš„ä¸€ç§æ”¹è‰¯ï¼Œæœ€çªå‡ºçš„æ”¹è‰¯æœ‰ä¸¤ç‚¹ï¼š1.æ–‡ä»¶æè¿°ç¬¦æ•°é‡æ²¡æœ‰ä¸Šé™2.å°†è¾“å…¥è¾“å‡ºå‚æ•°è¿›è¡Œåˆ†ç¦»ï¼Œä¸ç”¨æ¯æ¬¡è®¾å®šç¼ºç‚¹ï¼š1.å’Œselectä¸€æ ·ï¼Œpollè¿”å›åï¼Œéœ€è¦è½®è¯¢pollfdæ¥è·å–å°±ç»ªçš„æè¿°ç¬¦2.æ¯æ¬¡è°ƒç”¨polléƒ½éœ€è¦å¤§æŠŠå¤§é‡å®¢æˆ·ç«¯åœ¨ä¸€æ—¶åˆ»å¯èƒ½åªæœ‰å¾ˆå°‘çš„å¤„äºå°±ç»ªçŠ¶æ€ï¼Œå› æ­¤éšç€ç›‘è§†çš„æè¿°ç¬¦æ•°é‡çš„å¢é•¿ï¼Œå…¶æ•ˆç‡ä¹Ÿä¼šçº¿æ€§ä¸‹é™ã€‚ epoll1.æ–‡ä»¶æè¿°ç¬¦æ²¡æœ‰ä¸Šé™ï¼Œé€šè¿‡epoll_ctl()æ¥æ³¨å†Œä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå†…æ ¸ä¸­ä½¿ç”¨çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„æ¥ç®¡ç†æ‰€æœ‰éœ€è¦ç›‘æ§çš„æ–‡ä»¶æè¿°ç¬¦ã€‚2.åŸºäºæ—¶é—´å°±ç»ªé€šçŸ¥æ–¹å¼ï¼Œä¸€æ—¦è¢«ç›‘å¬çš„æŸä¸ªæ–‡ä»¶æè¿°ç¬¦å°±ç»ªï¼Œå†…æ ¸ä¼šé‡‡ç”¨ç±»ä¼¼äºcallbackçš„å›è°ƒæœºåˆ¶ï¼Œè¿…é€Ÿæ¿€æ´»è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œè¿™æ ·éšç€æ–‡ä»¶æè¿°ç¬¦æ•°é‡çš„å¢åŠ ï¼Œä¹Ÿä¸ä¼šå½±å“åˆ¤å®šå°±ç»ªçš„æ€§èƒ½ã€‚3.ç»´æŠ¤å°±ç»ªé˜Ÿåˆ—ï¼Œå½“æ–‡ä»¶æè¿°ç¬¦å°±ç»ªï¼Œå°±ä¼šè¢«æ”¾åˆ°å†…æ ¸ä¸­çš„ä¸€ä¸ªå°±ç»ªé˜Ÿåˆ—ä¸­ï¼Œè¿™æ ·è°ƒç”¨epoll_waitè·å–å°±ç»ªæ–‡ä»¶æè¿°ç¬¦çš„æ—¶å€™ï¼Œåªè¦å–é˜Ÿåˆ—ä¸­çš„å…ƒç´ å³å¯ï¼Œæ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ’ä¸ºO(1)ã€‚4.epollå†…å­˜æ˜ å°„æœºåˆ¶ï¼Œå³å†…æ ¸å°†å°±ç»ªé˜Ÿåˆ—é€šè¿‡mmapçš„æ–¹å¼æ˜ å°„åˆ°ç”¨æˆ·æ€ï¼Œé¿å…äº†æ‹·è´å†…å­˜è¿™æ ·çš„é¢å¤–æ€§èƒ½å¼€é”€ã€‚]]></content>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ’åº]]></title>
    <url>%2F2019%2F02%2F25%2FQuickSort%2F</url>
    <content type="text"><![CDATA[å¿«é€Ÿæ’åºå¿«é€Ÿæ’åº(Quick Sort)ä½¿ç”¨åˆ†æ²»æ³•ç­–ç•¥ã€‚å®ƒçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šé€‰æ‹©ä¸€ä¸ªåŸºå‡†æ•°ï¼Œé€šè¿‡ä¸€è¶Ÿæ’åºå°†è¦æ’åºçš„æ•°æ®åˆ†å‰²æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†ï¼›å…¶ä¸­ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½æ¯”å¦å¤–ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½è¦å°ã€‚ç„¶åï¼Œåœ¨æŒ‰æ­¤æ–¹æ³•å¯¹è¿™ä¸¤éƒ¨åˆ†æ•°æ®åˆ†åˆ«è¿›è¡Œå¿«é€Ÿæ’åºï¼Œæ•´ä¸ªæ’åºè¿‡ç¨‹å¯ä»¥é€’å½’è¿›è¡Œï¼Œä»¥æ­¤è¾¾åˆ°æ•´ä¸ªæ•°æ®å˜æˆæœ‰åºåºåˆ—ã€‚ ä¸€è¶Ÿå¿«é€Ÿæ’åºçš„ç®—æ³•æ˜¯ï¼š è®¾ç½®ä¸¤ä¸ªå˜é‡iã€jï¼Œæ’åºå¼€å§‹çš„æ—¶å€™ï¼Œi=0ï¼Œj=N-1ï¼› ä»¥ç¬¬ä¸€ä¸ªæ•°ç»„å…ƒç´ ä½œä¸ºå…³é”®æ•°æ®ï¼Œèµ‹å€¼ç»™keyï¼Œå³key=A[0] ä»jå¼€å§‹å‘å‰æœç´¢ï¼Œå³ç”±åå¼€å§‹å‘å‰æœç´¢ï¼ˆjâ€”ï¼‰ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªå°äºkeyçš„å€¼A[j]ï¼Œå°†A[j]=A[i]çš„å€¼äº¤æ¢ï¼› ä»iå¼€å§‹å‘åæœç´¢ï¼Œå³ç”±é’±å¼€å§‹å‘åæœç´¢ï¼ˆi++ï¼‰ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºkeyçš„å€¼A[i]ï¼Œå°†A[i]å’ŒA[j]çš„å€¼äº¤æ¢ï¼› é‡å¤ç¬¬3ã€4æ­¥ï¼Œç›´åˆ°i=jï¼›123456789101112131415161718192021222324252627282930313233343536void Sort(int *arr, int low, int high)&#123; if (low &gt;= high) return; int i = low, j = high; int key = arr[i]; while (true) &#123; while (j &gt; i) &#123; if (key &gt; arr[j]) &#123; break; &#125; j--; &#125; while (i &lt; j) &#123; if (key &lt; arr[i]) &#123; break; &#125; i++; &#125; if (i &gt;= j)break; int temp = arr[j]; arr[j] = arr[i]; arr[i] = temp; &#125; int temp = arr[j]; arr[j] = arr[low]; arr[low] = temp; Sort(arr, low, i); Sort(arr, i + 1, high);&#125; å½’å¹¶æ’åºåŸºæœ¬æ€æƒ³å½’å¹¶æ’åºï¼ˆMERGE-SORTï¼‰æ˜¯åˆ©ç”¨å½’å¹¶çš„æ€æƒ³å®ç°çš„æ’åºæ–¹æ³•ï¼Œè¯¥ç®—æ³•é‡‡ç”¨ç»å…¸çš„åˆ†æ”¯ï¼ˆdivide-and-conquerï¼‰ç­–ç•¥ï¼ˆåˆ†æ²»æ³•å°†é—®é¢˜åˆ†(divide)æˆä¸€äº›å°é—®é¢˜ç„¶ååœ¨é€’å½’æ±‚è§£ï¼Œè€Œæ²»(conquer)çš„é˜¶æ®µåˆ™å°†åˆ†çš„é˜¶æ®µå¾—åˆ°çš„å„ç­”æ¡ˆâ€œä¿®è¡¥â€åœ¨ä¸€èµ·ï¼Œå³åˆ†è€Œæ²»ä¹‹ï¼‰ã€‚ å¯ä»¥çœ‹åˆ°è¿™ç§ç»“æ„å¾ˆåƒä¸€é¢—å®Œå…¨äºŒå‰æ ‘ï¼Œæœ¬æ–‡çš„å½’å¹¶æ’åºæˆ‘ä»¬é‡‡ç”¨é€’å½’å»å®ç°ï¼Œé€’å½’æ·±åº¦ä¸º$log_{2^n}$ åˆå¹¶ç›¸é‚»æœ‰åºå­åºåˆ—å†æ¥çœ‹çœ‹æ²»é˜¶æ®µï¼Œæˆ‘ä»¬éœ€è¦å°†ä¸¤ä¸ªå·²ç»æœ‰åºçš„å­åºåˆ—åˆå¹¶æˆä¸€ä¸ªæœ‰åºåºåˆ—ï¼Œæ¯”å¦‚ä¸Šå›¾ä¸­çš„æœ€åä¸€æ¬¡åˆå¹¶ï¼Œè¦å°†[4,5,7,8]å’Œ[1,2,3,6]ä¸¤ä¸ªå·²ç»æœ‰åºçš„å­åºåˆ—ï¼Œåˆå¹¶ä¸ºæœ€ç»ˆåºåˆ—[1,2,3,4,5,6,7,8]ï¼Œæ¥çœ‹ä¸‹å®ç°æ­¥éª¤ã€‚ å¤æ‚åº¦å½’å¹¶æ’åºæ¯”è¾ƒå ç”¨å†…å­˜ï¼Œä½†å´æ˜¯ä¸€ç§é«˜æ•ˆä¸”ç¨³å®šçš„ç®—æ³•ã€‚æ—¶é—´å¤æ‚åº¦ï¼š$O(n \cdot log^n)$ç©ºé—´å¤æ‚åº¦ï¼šT(n) äºŒå‰å †ï¼ˆbinary heapï¼‰äºŒå‰å †æ˜¯ä¸€ç§ç‰¹æ®Šçš„å †ï¼ŒäºŒå‰å †æ˜¯å®Œå…¨äºŒå‰æ ‘ï¼ˆäºŒå‰æ ‘ï¼‰æˆ–è€…è¿‘ä¼¼å®Œå…¨äºŒå…ƒæ ‘ï¼ˆäºŒå‰æ ‘ï¼‰ã€‚äºŒå‰å †æœ‰ä¸¤ç§ï¼šæœ€å°å †å’Œæœ€å¤§å †ã€‚æœ€å¤§å †ï¼šçˆ¶èŠ‚ç‚¹çš„é”®å€¼æ€»æ˜¯å¤§äºæˆ–ç­‰äºä»»ä½•ä¸€ä¸ªå­èŠ‚ç‚¹çš„é”®å€¼ï¼›æœ€å°å †ï¼šçˆ¶ç»“ç‚¹çš„é”®å€¼æ€»æ˜¯å°äºæˆ–ç­‰äºä»»ä½•ä¸€ä¸ªå­èŠ‚ç‚¹çš„é”®å€¼ã€‚]]></content>
      <tags>
        <tag>æ•°æ®ç»“æ„ä¸ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[C++]]></title>
    <url>%2F2019%2F02%2F25%2FC%2B%2B%2F</url>
    <content type="text"><![CDATA[è™šå‡½æ•° å¯¹äºä¸€ä¸ªclassï¼Œäº§ç”Ÿä¸€å †æŒ‡å‘virtual functionsçš„æŒ‡é’ˆï¼Œè™šå‡½æ•°è¡¨æŒ‡é’ˆé€šå¸¸æ”¾åœ¨å¯¹è±¡å®ä¾‹çš„æœ€å‰é¢çš„ä½ç½®ã€‚ç¼–è¯‘æŠ¥é”™çš„æ—¶å€™æ²¡æœ‰vtableï¼Œè¡¨ç¤ºè¯¥çº¯è™šå‡½æ•°æ²¡æœ‰å®ç°ã€‚ æ¯ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ç›¸å…³çš„virtual tableã€‚è¿™ä¸ªæŒ‡é’ˆè¢«ç§°ä½œè™šå‡½æ•°è¡¨æŒ‡é’ˆã€‚ C/C++ä¸­staticå…³é”®å­—ä½œç”¨æ€»ç»“å…ˆæ¥ä»‹ç»å®ƒçš„ç¬¬ä¸€æ¡ä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€æ¡ï¼šéšè—ã€‚ï¼ˆstaticå‡½æ•°ï¼Œstaticå˜é‡å‡å¯ï¼‰å½“åŒäº‹ç¼–è¯‘å¤šä¸ªæ–‡ä»¶æ—¶ï¼Œæ‰€æœ‰æœªåŠ staticå‰ç¼€çš„å…¨å±€å˜é‡å’Œå‡½æ•°éƒ½å…·æœ‰å…¨å±€å¯è§æ€§ã€‚ä¸¾ä¾‹æ¥è¯´æ˜ã€‚åŒæ—¶ç¼–è¯‘ä¸¤ä¸ªæºæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯a.cï¼Œå¦ä¸€ä¸ªæ˜¯main.cã€‚123456789101112131415//a.cchar a = 'A'; // global variablevoid msg()&#123; printf("Hello\n");&#125;// main.cint main()&#123; extern char a; // extern variable must be declared before use printf("%c", a); (void)msg(); return 0;&#125; ç¨‹åºè¿è¡Œç»“æœæ˜¯ï¼šA Helloä¸ºä»€ä¹ˆåœ¨a.cä¸­å®šä¹‰çš„å…¨å±€å˜é‡aå’Œå‡½æ•°msgèƒ½åœ¨main.cä¸­ä½¿ç”¨ï¼Ÿå‰é¢è¯´è¿‡ï¼Œæ‰€æœ‰æœªåŠ staticå‰ç¼€çš„å…¨å±€å˜é‡å’Œå‡½æ•°éƒ½å…·æœ‰å…¨å±€å¯è§æ€§ï¼Œå…¶å®ƒçš„æºæ–‡ä»¶ä¹Ÿèƒ½è®¿é—®ã€‚æ­¤ä¾‹ä¸­ï¼Œaæ˜¯å…¨å±€å˜é‡ï¼Œmsgæ˜¯å‡½æ•°ï¼Œå¹¶ä¸”éƒ½æ²¡æœ‰åŠ staticå‰ç¼€ï¼Œå› æ­¤å¯¹äºå¦å¤–çš„æºæ–‡ä»¶main.cæ˜¯å¯è§çš„ã€‚å¦‚æœåŠ äº†staticï¼Œå°±ä¼šå¯¹å…¶å®ƒæºæ–‡ä»¶éšè—ã€‚ä¾‹å¦‚åœ¨aå’Œmsgçš„å®šä¹‰å‰åŠ ä¸Šäº†staticï¼Œmain.cå°±çœ‹ä¸åˆ°å®ƒä»¬äº†ã€‚åˆ©ç”¨è¿™ä¸€ç‰¹æ€§å¯ä»¥å†ä¸åŒçš„æ–‡ä»¶ä¸­å®šä¹‰åŒåå‡½æ•°å’ŒåŒåå˜é‡ï¼Œè€Œä¸å¿…æ‹…å¿ƒå‘½åå†²çªã€‚staticå¯ä»¥ç”¨ä½œå‡½æ•°å’Œå˜é‡çš„å‰ç¼€ï¼Œå¯¹äºå‡½æ•°æ¥è®²ï¼Œstaticçš„ä½œç”¨ä»…é™äºéšè—ã€‚ staticçš„ç¬¬äºŒä¸ªä½œç”¨æ˜¯ä¿æŒå†…å®¹çš„æŒä¹…ã€‚ï¼ˆstaticå˜é‡ä¸­çš„è®°å¿†åŠŸèƒ½å’Œå…¨å±€ç”Ÿå­˜æœŸï¼‰å­˜å‚¨åœ¨é™æ€æ•°æ®åŒºçš„å˜é‡ä¼šåœ¨ç¨‹åºåˆšå¼€å§‹è¿è¡Œæ—¶å°±å®Œæˆåˆå§‹åŒ–ï¼Œä¹Ÿæ˜¯å”¯ä¸€çš„ä¸€æ¬¡åˆå§‹åŒ–ã€‚å…±æœ‰ä¸¤ç§å˜é‡å­˜å‚¨åœ¨é™æ€å­˜å‚¨åŒºï¼šå…¨å±€å˜é‡å’Œstaticå˜é‡ï¼Œåªä¸è¿‡å’Œå…¨å±€å˜é‡æ¯”èµ·æ¥ï¼Œstaticå¯ä»¥æ§åˆ¶å˜é‡çš„å¯è§èŒƒå›´ï¼Œè¯´åˆ°åº•staticè¿˜æ˜¯ç”¨æ¥éšè—çš„ï¼Œè™½ç„¶è¿™ç§ç”¨æ³•ä¸å¸¸è§PSï¼šå¦‚æœä½œä¸ºstaticå±€éƒ¨å˜é‡åœ¨å‡½æ•°å†…å®šä¹‰ï¼Œå®ƒçš„ç”Ÿå­˜æœŸä¸ºæ•´ä¸ªæºç¨‹åºï¼Œä½†æ˜¯å…¶ä½œç”¨åŸŸä»ä¸è‡ªåŠ¨å˜é‡ç›¸åŒï¼Œåªèƒ½å®šä¹‰è¯¥å˜é‡çš„å‡½æ•°å†…ä½¿ç”¨è¯¥å˜é‡ã€‚é€€å‡ºè¯¥å‡½æ•°åï¼Œå°½ç®¡è¯¥å˜é‡è¿˜ç»§ç»­å­˜åœ¨ï¼Œä½†ä¸èƒ½ä½¿ç”¨å®ƒã€‚ ç¨‹åºä¸¾ä¾‹ï¼š12345678910111213141516#include &lt;stdio.h&gt;int fun()&#123; static int count = 10; //åœ¨ç¬¬ä¸€æ¬¡è¿›å…¥è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œå˜é‡aè¢«åˆå§‹åŒ–ä¸º10ï¼å¹¶æ¥ç€è‡ªå‡1ï¼Œä»¥åæ¯æ¬¡è¿›å…¥è¯¥å‡½æ•°ï¼Œaå°±ä¸ä¼šå†æ¬¡è¢«åˆå§‹åŒ–äº†ï¼Œä»…è¿›è¡Œè‡ªå‡1çš„æ“ä½œï¼›åœ¨staticå‘æ˜å‰ï¼Œè¦è¾¾åˆ°åŒæ ·çš„åŠŸèƒ½ï¼Œåˆ™åªèƒ½ä½¿ç”¨å…¨å±€å˜é‡ï¼› return count--;&#125;int count = 1;int main(void)&#123; printf("global\t\tlocal static\n"); for(;count&lt;=10;++count) &#123; printf("%d\t\t%d\n",count,fun()); &#125; return 0;&#125; åŸºäºä»¥ä¸Šä¸¤ç‚¹å¯ä»¥å¾—å‡ºä¸€ä¸ªç»“è®ºï¼šæŠŠå±€éƒ¨å˜é‡æ”¹å˜ä¸ºé™æ€å˜é‡åæ˜¯æ”¹å˜äº†å®ƒçš„å­˜å‚¨æ–¹å¼å³æ”¹å˜äº†å®ƒçš„ç”Ÿå­˜æœŸã€‚æŠŠå…¨å±€å˜é‡æ”¹å˜ä¸ºé™æ€å˜é‡åæ˜¯æ”¹å˜äº†å®ƒçš„ä½œç”¨åŸŸï¼Œé™åˆ¶äº†å®ƒçš„ä½¿ç”¨èŒƒå›´ã€‚å› æ­¤staticè¿™ä¸ªè¯´æ˜ç¬¦åœ¨ä¸åŒçš„åœ°æ–¹æ‰€èµ·çš„ä½œç”¨æ˜¯ä¸åŒçš„ã€‚ staticçš„ç¬¬ä¸‰ä¸ªä½œç”¨æ˜¯é»˜è®¤åˆå§‹åŒ–ä¸º0ï¼ˆstaticå˜é‡ï¼‰å…¶å®å…¨å±€å˜é‡ä¹Ÿå…·å¤‡è¿™ä¸€å±æ€§ï¼Œå› ä¸ºå…¨å±€å˜é‡ä¹Ÿå­˜å‚¨åœ¨é™æ€æ•°æ®åŒºã€‚åœ¨é™æ€æ•°æ®åŒºï¼Œå†…å­˜ä¸­æ‰€æœ‰çš„å­—èŠ‚é»˜è®¤å€¼éƒ½æ˜¯0x00ï¼ŒæŸäº›æ—¶å€™è¿™ä¸€ç‰¹ç‚¹å¯ä»¥å‡å°‘ç¨‹åºå‘˜çš„å·¥ä½œé‡ã€‚æ¯”å¦‚åˆå§‹åŒ–ä¸€ä¸ªç¨€ç–ä¸¾è¯ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€ä¸ªä¸€ä¸ªåœ°æŠŠæ‰€æœ‰å…ƒç´ éƒ½ç½®0ï¼Œç„¶åæŠŠä¸æ˜¯0çš„å‡ ä¸ªå…ƒç´ èµ‹å€¼ã€‚å¦‚æœå®šä¹‰æˆé™æ€çš„ï¼Œå°±çœå»äº†ä¸€å¼€å§‹ç½®0çš„æ“ä½œã€‚å†æ¯”å¦‚æŠŠä¸€ä¸ªå­—ç¬¦æ•°ç»„å½“å­—ç¬¦ä¸²æ¥ç”¨ï¼Œä½†åˆè§‰å¾—æ¯æ¬¡åœ¨å­—ç¬¦æ•°ç»„æœ«å°¾åŠ â€™\0â€™ï¼›å¤ªéº»çƒ¦ã€‚å¦‚æœæŠŠå­—ç¬¦ä¸²å®šä¹‰æˆé™æ€çš„ï¼Œå°±çœå»äº†è¿™ä¸ªéº»çƒ¦ï¼Œå› ä¸ºé‚£é‡Œæœ¬æ¥å°±æ˜¯â€™\0â€™; æœ€åå¯¹staticçš„ä¸‰æ¡ä½œç”¨åšä¸€å¥è¯æ€»ç»“ã€‚é¦–å…ˆstaticçš„æœ€ä¸»è¦åŠŸèƒ½æ˜¯éšè—ï¼Œå…¶æ¬¡å› ä¸ºstaticå˜é‡å­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒºï¼Œæ‰€ä»¥å®ƒå…·å¤‡æŒä¹…æ€§å’Œé»˜è®¤å€¼0ã€‚ staticçš„ç¬¬å››ä¸ªä½œç”¨ï¼šC++ä¸­çš„ç±»æˆå‘˜å£°æ˜staticï¼ˆæœ‰äº›åœ°æ–¹ä¸ä»¥ä¸Šä½œç”¨é‡å ï¼‰åœ¨ç±»ä¸­å£°æ˜staticå˜é‡æˆ–è€…å‡½æ•°æ—¶ï¼Œåˆå§‹åŒ–æ—¶ä½¿ç”¨ä½œç”¨åŸŸè¿ç®—ç¬¦æ¥æ ‡æ˜å®ƒæ‰€å±ç±»ï¼Œå› æ­¤ï¼Œé™æ€æ•°æ®æˆå‘˜æ˜¯ç±»çš„æˆå‘˜ï¼Œè€Œä¸æ˜¯å¯¹è±¡çš„æˆå‘˜ï¼Œè¿™æ ·å°±å‡ºç°ä»¥ä¸‹ä½œç”¨ï¼šï¼ˆ1ï¼‰ç±»çš„é™æ€æˆå‘˜å‡½æ•°æ˜¯å±äºæ•´ä¸ªç±»è€Œéç±»çš„å¯¹è±¡ï¼Œæ‰€ä»¥å®ƒæ²¡æœ‰thisæŒ‡é’ˆï¼Œè¿™å°±å¯¼è‡´äº†å®ƒä»…èƒ½è®¿é—®ç±»çš„é™æ€æ•°æ®å’Œé™æ€æˆå‘˜å‡½æ•°ã€‚ï¼ˆ2ï¼‰ä¸èƒ½å°†é™æ€æˆå‘˜å‡½æ•°å®šä¹‰ä¸ºè™šå‡½æ•°ã€‚ï¼ˆ3ï¼‰ç”±äºé™æ€æˆå‘˜å£°æ˜äºç±»ä¸­ï¼Œæ“ä½œäºå…¶å¤–ï¼Œæ‰€ä»¥å¯¹å…¶å–åœ°å€æ“ä½œï¼Œå°±å¤šå°‘æœ‰äº›ç‰¹æ®Šï¼Œå˜é‡åœ°å€æ˜¯æŒ‡å‘å…¶æ•°æ®ç±»å‹çš„æŒ‡é’ˆï¼Œå‡½æ•°åœ°å€ç±»å‹æ˜¯ä¸€ä¸ªâ€nonmemberå‡½æ•°æŒ‡é’ˆâ€ã€‚ï¼ˆ4ï¼‰ç”±äºé™æ€æˆå‘˜å‡½æ•°æ²¡æœ‰thisæŒ‡é’ˆï¼Œæ‰€ä»¥å°±å·®ä¸å¤šç­‰åŒäºnonmemberå‡½æ•°ï¼Œç»“æœå°±äº§ç”Ÿäº†ä¸€ä¸ªæ„æƒ³ä¸åˆ°çš„å¥½å¤„ï¼šæˆä¸ºä¸€ä¸ªcallbackå‡½æ•°ï¼Œä½¿å¾—æˆ‘ä»¬å¾—ä»¥å°†C++å’ŒC-based XWindowç³»ç»Ÿç»“åˆï¼ŒåŒæ—¶ä¹ŸæˆåŠŸçš„åº”ç”¨äºçº¿ç¨‹å‡½æ•°èº«ä¸Šã€‚ï¼ˆè¿™æ¡æ²¡é‡è§è¿‡ï¼‰ï¼ˆ5ï¼‰staticå¹¶æ²¡æœ‰å¢åŠ ç¨‹åºçš„æ—¶ç©ºå¼€é”€ï¼Œç›¸åå®ƒè¿˜ç¼©çŸ­äº†å­ç±»å¯¹çˆ¶ç±»é™æ€æˆå‘˜çš„è®¿é—®æ—¶é—´ï¼ŒèŠ‚çœäº†å­ç±»çš„å†…å­˜ç©ºé—´ã€‚ï¼ˆ6ï¼‰é™æ€æ•°æ®æˆå‘˜åœ¨&lt;å®šä¹‰æˆ–è¯´æ˜&gt;æ—¶å‰é¢åŠ å…³é”®å­—staticã€‚ï¼ˆ7ï¼‰é™æ€æ•°æ®æˆå‘˜æ˜¯é™æ€å­˜å‚¨çš„ï¼Œæ‰€ä»¥å¿…é¡»å¯¹å®ƒè¿›è¡Œåˆå§‹åŒ–ã€‚ï¼ˆç¨‹åºå‘˜æ‰‹åŠ¨åˆå§‹åŒ–ï¼Œå¦åˆ™ç¼–è¯‘æ—¶ä¸€èˆ¬ä¸ä¼šæŠ¥é”™ï¼Œä½†æ˜¯Linkæ—¶ä¼šæŠ¥é”™è¯¯ï¼‰ï¼ˆ8ï¼‰é™æ€æˆå‘˜åˆå§‹åŒ–ä¸ä¸€èˆ¬æ•°æ®æˆå‘˜åˆå§‹åŒ–ä¸åŒï¼šåˆå§‹åŒ–åœ¨ç±»ä½“å¤–è¿›è¡Œï¼Œè€Œå‰é¢ä¸åŠ staticï¼Œä»¥å…ä¸ä¸€èˆ¬é™æ€å˜é‡æˆ–å¯¹è±¡ç›¸æ··æ·†ï¼›åˆå§‹åŒ–æ—¶ä¸åŠ è¯¥æˆå‘˜çš„è®¿é—®æƒé™æ§åˆ¶ç¬¦private,publicç­‰ï¼›åˆå§‹åŒ–æ—¶ä½¿ç”¨ä½œç”¨åŸŸæ¥æ ‡æ˜å®ƒæ‰€å±ç±»ï¼›æ‰€ä»¥æˆ‘ä»¬å¾—å‡ºé™æ€æ•°æ®æˆå‘˜åˆå§‹åŒ–çš„æ ¼å¼ï¼š&lt;æ•°æ®ç±»å‹&gt; &lt;ç±»å&gt;::&lt;é™æ€æ•°æ®æˆå‘˜å&gt;=&lt;å€¼&gt;ï¼ˆ9ï¼‰ä¸ºäº†é˜²æ­¢çˆ¶ç±»çš„å½±å“ï¼Œå¯ä»¥åœ¨å­ç±»å®šä¸€ä¸ªä¸çˆ¶ç±»ç›¸åŒçš„é™æ€å˜é‡ï¼Œä»¥å±è”½çˆ¶ç±»çš„å½±å“ã€‚è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼šæˆ‘ä»¬è¯´é™æ€æˆå‘˜ä¸ºçˆ¶ç±»å’Œå­ç±»å…±äº«ï¼Œä½†æˆ‘ä»¬æœ‰é‡å¤å®šä¹‰äº†é™æ€æˆå‘˜ï¼Œè¿™ä¼šä¸ä¼šå¼•èµ·é”™è¯¯å‘¢ï¼Ÿä¸ä¼šï¼Œæˆ‘ä»¬çš„ç¼–è¯‘å™¨é‡‡ç”¨äº†ä¸€ç§ç»å¦™çš„æ‰‹æ³•ï¼šname-manglingç”¨ä»¥ç”Ÿæˆå”¯ä¸€çš„æ ‡å¿—ã€‚ C++æ™ºèƒ½æŒ‡é’ˆshared_ptrshared_pträ½¿ç”¨å¼•ç”¨è®¡æ•°ï¼Œæ¯ä¸€ä¸ªshared_ptrçš„æ‹·è´éƒ½æŒ‡å‘ç›¸åŒçš„å†…å­˜ã€‚ weak_ptrweak_ptræ²¡æœ‰å…±äº«èµ„æºï¼Œå®ƒçš„æ„é€ ä¸ä¼šå¼•èµ·æŒ‡é’ˆå¼•ç”¨è®¡æ•°çš„å¢åŠ  unique_ptrâ€œå”¯ä¸€â€æ‹¥æœ‰å…¶æ‰€æŒ‡å¯¹è±¡ï¼ŒåŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªunique_ptræŒ‡å‘ç»™å®šå¯¹è±¡ è™šå‡½æ•°é€šè¿‡ä¸€å¼ è™šå‡½æ•°è¡¨ï¼ˆVirtual Tableï¼‰æ¥å®ç°sizeofä¸ç»Ÿè®¡è™šå‡½æ•°è¡¨ C/C++å†…å­˜å¯¹é½ä»€ä¹ˆæ˜¯å†…å­˜å¯¹é½32ä½ç³»ç»Ÿä¸‹ï¼Œintå 4byteï¼Œcharå 1byteï¼Œé‚£ä¹ˆå°†å®ƒä»¬æ”¾åˆ°ä¸€ä¸ªç»“æ„ä½“ä¸­å®é™…ä¸Šå 8byteï¼Œè¿™å°±æ˜¯å†…å­˜å¯¹é½å¯¼è‡´çš„ã€‚ inlineä»€ä¹ˆæ˜¯å†…è”å‡½æ•°ï¼Ÿå†…è”å‡½æ•°æ˜¯æŒ‡é‚£äº›å®šä¹‰åœ¨ç±»ä½“å†…éƒ¨çš„æˆå‘˜å‡½æ•°ï¼Œå³è¯¥å‡½æ•°çš„å‡½æ•°ä½“æ”¾åœ¨ç±»ä½“å†…ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œinlineé€‚ç”¨çš„å‡½æ•°æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯ç±»å†…å®šä¹‰çš„æˆå‘˜å‡½æ•°ï¼Œå¦ä¸€ç§æ˜¯ç±»å†…å£°æ˜ï¼Œç±»å¤–å®šä¹‰çš„æˆå‘˜å‡½æ•°ï¼Œå¯¹äºè¿™ä¸¤ç§æƒ…å†µinlineçš„ä½¿ç”¨æœ‰ä¸€äº›ä¸åŒï¼› å†…è”å‡½æ•°çš„ä¼˜ç¼ºç‚¹ï¼šä¼˜ç‚¹ï¼š1.inlineå®šä¹‰çš„ç±»çš„å†…è”å‡½æ•°ï¼Œå‡½æ•°çš„ä»£ç è¢«æ”¾å…¥ç¬¦å·è¡¨ä¸­ï¼Œåœ¨ä½¿ç”¨æ—¶ç›´æ¥è¿›è¡Œæ›¿æ¢ï¼Œï¼ˆåƒå®ä¸€æ ·å±•å¼€ï¼‰ï¼Œæ²¡æœ‰äº†è°ƒç”¨çš„å¼€é”€ï¼Œæ•ˆç‡ä¹Ÿå¾ˆé«˜ã€‚2.inlineä¹Ÿæ˜¯çœŸæ­£çš„å‡½æ•°ï¼Œç¼–è¾‘å™¨åœ¨è°ƒç”¨ä¸€ä¸ªå†…è”å‡½æ•°æ—¶ï¼Œä¼šé¦–å…ˆæ£€æŸ¥å®ƒçš„å‚æ•°çš„ç±»å‹ï¼Œä¿è¯è°ƒç”¨æ­£ç¡®ã€‚ç„¶åè¿›è¡Œä¸€ç³»åˆ—çš„ç›¸å…³æ£€æŸ¥ï¼Œå°±åƒå¯¹å¾…ä»»ä½•ä¸€ä¸ªæ­£åœ¨çš„å‡½æ•°ä¸€æ ·ã€‚è¿™æ ·å°±æ¶ˆé™¤äº†å®ƒçš„éšæ‚£å’Œå±€é™æ€§ã€‚ï¼ˆå®æ›¿æ¢ä¸ä¼šæ£€æŸ¥å‚æ•°ç±»å‹ï¼Œå®‰å…¨éšæ‚£è¾ƒå¤§ï¼‰ç¼ºç‚¹ï¼š1.å†…è”å‡½æ•°å…·æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œinlineå‡½æ•°çš„å‡½æ•°ä½“ä¸€èˆ¬æ¥è¯´ä¸èƒ½å¤ªå¤§ï¼Œå¦‚æœå¤ªå¤§ï¼Œä¸€èˆ¬çš„ç¼–è¯‘å™¨ä¼šæ”¾å¼ƒå†…è”æ–¹å¼ï¼Œè€Œé‡‡ç”¨æ™®é€šçš„æ–¹å¼è°ƒç”¨å‡½æ•°ã€‚ï¼ˆæ¢å¥è¯è¯´ï¼Œä½ ä½¿ç”¨å†…è”å‡½æ•°ï¼Œåªä¸è¿‡æ˜¯å‘ç¼–è¯‘å™¨æå‡ºä¸€ä¸ªç”³è¯·ï¼Œç¼–è¯‘å™¨å¯ä»¥æ‹’ç»ä½ çš„ç”³è¯·ï¼‰ï¼Œè¿™æ ·ï¼Œå†…è”å’Œæ™®é€šå‡½æ•°æ‰§è¡Œæ•ˆç‡ä¸€æ ·äº†ã€‚2.inlineå¯¹ç¼–è¯‘å™¨æ¥è¯´åªæ˜¯ä¸€ç§ç®€æ˜“ï¼Œç¼–è¯‘å™¨å¯ä»¥é€‰æ‹©å¿½ç•¥è¿™ä¸ªå»ºè®®ã€‚ æ³¨æ„äº‹é¡¹1.å†…è”å‡½æ•°ä¸èƒ½å®åº“æ¬§å¤æ‚çš„æ§åˆ¶è¯­å¥ï¼Œå¦‚å¾ªç¯è¯­å¥å’Œswitchè¯­å¥ï¼› æ¥å£ï¼ˆæŠ½è±¡ç±»ï¼‰æ¥å£æè¿°äº†ç±»çš„è¡Œä¸ºå’ŒåŠŸèƒ½ï¼Œè€Œä¸éœ€è¦å®Œæˆç±»çš„ç‰¹å®šå®ç°ã€‚ è§†C++ä¸ºä¸€ä¸ªè¯­è¨€è”é‚¦ Cè¯­è¨€ é¢å‘å¯¹è±¡ C++æ¨¡ç‰ˆ STLå®¹å™¨ å°½é‡ç”¨constï¼Œenumï¼Œinlineæ›¿æ¢#define constçš„å¥½å¤„ï¼šdefineç›´æ¥å¸¸é‡æ›¿æ¢ï¼Œå‡ºç°ç¼–è¯‘é”™è¯¯ä¸æ˜“å®šä½ï¼ˆä¸çŸ¥é“å¸¸é‡æ˜¯å“ªä¸ªå˜é‡ï¼Œè¿™ä¸ªå…¶å®è¿˜å¥½ï¼Œå·¥ç¨‹è§„èŒƒç‚¹çš„éƒ½ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼‰ï¼›defineæ²¡æœ‰ä½œç”¨åŸŸï¼Œconstæœ‰ä½œç”¨åŸŸæä¾›äº†å°è£…æ€§ï¼ˆè¿™ä¸ªåŒä¸Šï¼Œä¸è¿‡è¿™ä¸¤ç‚¹éƒ½æ˜¯äººä¸ºçš„é¿å¼€äº†ï¼‰ enumçš„å¥½å¤„ï¼šæä¾›äº†å°è£…æ€§ï¼Œç¼–è¯‘å™¨è‚¯å®šä¸ä¼šåˆ†é…é¢å¤–çš„å†…å­˜ç©ºé—´ï¼ˆå…¶å®constä¹Ÿä¸ä¼šï¼Œéš¾é“defineä¼šï¼Ÿè‡³äºå°è£…æ€§ï¼Œundefï¼Œæ‰€ä»¥è¿™ä¹ˆå¤šå¹´äº†ï¼Œè™½ç„¶è¯´é¿å…ï¼Œä½†æ˜¯å·¥ç¨‹ä¸Šç”¨çš„è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼‰ inlineçš„å¥½å¤„ï¼šdefineå®å‡½æ•°å®¹æ˜“é€ æˆè¯¯ç”¨ å®å®ç°å·¥å‚è®¾è®¡æ¨¡å¼ éœ€è¦ä¸€ä¸ªå…¨å±€mapç”¨äºå­˜å‚¨ç±»çš„ä¿¡æ¯ä»¥åŠåˆ›å»ºå®ä¾‹çš„å‡½æ•° éœ€è¦è°ƒç”¨å…¨å±€å¯¹è±¡çš„æ„é€ å‡½æ•°ç”¨äºæ³¨å†Œ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071// ConsoleApplication1.cpp : æ­¤æ–‡ä»¶åŒ…å« &quot;main&quot; å‡½æ•°ã€‚ç¨‹åºæ‰§è¡Œå°†åœ¨æ­¤å¤„å¼€å§‹å¹¶ç»“æŸã€‚//#include &quot;pch.h&quot;#include &lt;iostream&gt;#include &lt;map&gt;using namespace std;typedef void *(*register_fun)();class CCFactory&#123;public: static void *NewInstance(string class_name) &#123; auto it = map_.find(class_name); if (it == map_.end()) &#123; return NULL; &#125; else &#123; return it-&gt;second(); &#125; &#125; static void Register(string class_name, register_fun func) &#123; map_[class_name] = func; &#125;private: static map&lt;string, register_fun&gt; map_;&#125;;map&lt;string, register_fun&gt; CCFactory::map_; // ä½“å¤–åˆå§‹åŒ–#define REGISTER_CLASS(class_name); \ CCFactory::Register(#class_name, []()-&gt;void *&#123;return (new class_name);&#125;);class Product&#123;public: virtual void Say() = 0;&#125;;class Register : public Product // æ³¨å†Œè€…ï¼Œå°±æ˜¯äº§å“ï¼Œè™½ç„¶ä¸å–œæ¬¢è®¾è®¡æ¨¡å¼è¿™å¨ä¸œè¥¿ï¼Œä½†æ˜¯ç ”ç©¶èµ·æ¥è¿˜æ˜¯æŒºå¥½ç©çš„&#123;public: void Say() &#123; std::cout &lt;&lt; &quot;Say What?\n&quot;; &#125;&#125;;void Init()&#123; REGISTER_CLASS(Register);&#125;void Release()&#123;&#125;int main()&#123; Init(); Register* a = (Register*)CCFactory::NewInstance(&quot;Register&quot;); a-&gt;Say(); Release();&#125; æ²¡å†™å®Œï¼Œä½†æ˜¯æ„Ÿè§‰åšä¸ªæ± è¿˜æ˜¯æŒºå¥½ç©çš„ã€‚ å°½å¯èƒ½ä½¿ç”¨const constå®šä¹‰æ¥å£ï¼Œé˜²æ­¢è¯¯ç”¨ constæˆå‘˜å‡½æ•°ï¼Œä»£è¡¨è¿™ä¸ªæˆå‘˜å‡½æ•°æ‰¿è¯ºä¸ä¼šæ”¹å˜å¯¹è±¡å€¼ï¼ˆconstæˆå‘˜åªèƒ½è°ƒç”¨constæˆå‘˜å‡½æ•°(åŠ -fpermissiveç¼–è¯‘é€‰é¡¹å°±å¯ä»¥äº†)ï¼Œéconstæˆå‘˜å¯ä»¥è°ƒç”¨æ‰€æœ‰æˆå‘˜å‡½æ•°ï¼‰ ç¡®å®šå¯¹è±¡ä½¿ç”¨å‰è¢«åˆå§‹åŒ–12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182// ConsoleApplication1.cpp : æ­¤æ–‡ä»¶åŒ…å« &quot;main&quot; å‡½æ•°ã€‚ç¨‹åºæ‰§è¡Œå°†åœ¨æ­¤å¤„å¼€å§‹å¹¶ç»“æŸã€‚//#include &quot;pch.h&quot;#include &lt;iostream&gt;#include &lt;map&gt;using namespace std;typedef void *(*register_fun)();class CCFactory&#123;public: static void *NewInstance(string class_name) &#123; auto it = map_.find(class_name); if (it == map_.end()) &#123; return NULL; &#125; else &#123; return it-&gt;second(); &#125; &#125; static void Register(string class_name, register_fun func) &#123; map_[class_name] = func; &#125;private: static map&lt;string, register_fun&gt; map_;&#125;;map&lt;string, register_fun&gt; CCFactory::map_; // ä½“å¤–åˆå§‹åŒ–#define REGISTER_CLASS(class_name); \ CCFactory::Register(#class_name, []()-&gt;void *&#123;return (new class_name(#class_name));&#125;);class Product&#123;public: virtual void Say() = 0;&#125;;class Register : public Product // æ³¨å†Œè€…ï¼Œå°±æ˜¯äº§å“ï¼Œè™½ç„¶ä¸å–œæ¬¢è®¾è®¡æ¨¡å¼è¿™å¨ä¸œè¥¿ï¼Œä½†æ˜¯ç ”ç©¶èµ·æ¥è¿˜æ˜¯æŒºå¥½ç©çš„&#123;public: void Say() &#123; std::cout &lt;&lt; name.c_str() &lt;&lt; &quot;: Say What?\n&quot;; &#125; void Run() const // è¡¨æ˜è¿™ä¸ªå‡½æ•°ä¸ä¼šå¯¹ç±»å¯¹è±¡çš„æ•°æ®æˆå‘˜ï¼ˆå‡†ç¡®åœ°è¯´æ˜¯éé™æ€æ•°æ®æˆå‘˜ï¼‰ä½œä»»ä½•æ”¹å˜ &#123; &#125; int b; const string name; // å¿…é¡»åœ¨åˆå§‹åŒ–çš„æ—¶å€™èµ‹å€¼ Register(string _y) : name(_y) &#123; &#125;&#125;;void Init()&#123; REGISTER_CLASS(Register);&#125;void Release()&#123;&#125;int main()&#123; Init(); Register* a = (Register*)CCFactory::NewInstance(&quot;Register&quot;); a-&gt;Say(); Release();&#125; æ„é€ ã€ææ„ã€èµ‹å€¼è¿ç®—å¦‚æœç±»ä¸­æ²¡æœ‰å®šä¹‰ï¼Œç¨‹åºå´è°ƒç”¨äº†ï¼Œç¼–è¯‘å™¨ä¼šäº§ç”Ÿä¸€äº›å‡½æ•° ä¸€ä¸ªdefaultçš„æ„é€ å‡½æ•° ä¸€ä¸ªcopyæ„é€ å‡½æ•° ä¸€ä¸ªcopy assignment æ“ä½œç¬¦ ä¸€ä¸ªææ„å‡½æ•°(non virtual) å¦‚æœè‡ªå·±æ„é€ äº†å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¸ä¼šäº§ç”Ÿdefaultæ„é€ å‡½æ•° base classå¦‚æœæŠŠæ‹·è´æ„é€ å‡½æ•°æˆ–è€…å¤åˆ¶æ“ä½œç¬¦è®¾ç½®ä¸ºprivateï¼Œä¸ä¼šäº§ç”Ÿè¿™ä¸¤ä¸ªå‡½æ•° å«æœ‰å¼•ç”¨æˆå‘˜å˜é‡æˆ–è€…constæˆå‘˜å˜é‡ä¸äº§ç”Ÿå¤åˆ¶æ“ä½œç¬¦ è‹¥ä¸æƒ³ä½¿ç”¨ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„å‡½æ•°ï¼Œå°±è¯¥æ˜ç¡®æ‹’ç»å°†é»˜è®¤ç”Ÿæˆçš„å‡½æ•°å£°æ˜ä¸ºprivateï¼Œæˆ–è€…C++ 11æ–°ç‰¹æ€§â€=deleteâ€123456class UncopyTable&#123;private: UncopyTable(const UncopyTable&amp;); UncopyTable&amp; operator=(const UncopyTable&amp;);&#125;; é™æ€ç±»å‹ä¸Šä¸‹æ–‡æ— å…³ï¼Œåœ¨ç¼–è¯‘æ—¶å°±å¯ä»¥ç¡®å®šå…¶ç±»å‹ã€‚ åŠ¨æ€ç±»å‹åŸºç±»æŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡åœ¨ç¼–è¯‘çš„æ—¶å€™æ— æ³•ç¡®å®š åŠ¨æ€ç»‘å®šä¸é™æ€ç»‘å®šé™æ€ç»‘å®šï¼šç¼–è¯‘æ—¶ç»‘å®šï¼Œé€šè¿‡å¯¹è±¡è°ƒç”¨åŠ¨æ€ç»‘å®šï¼šè¿è¡Œæ—¶ç»‘å®šï¼Œé€šè¿‡åœ°å€å®ç° è¦è§¦å‘åŠ¨æ€ç»‘å®šï¼Œéœ€æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ åªæœ‰è™šå‡½æ•°æ‰èƒ½æƒŠé†’åŠ¨æ€ç»‘å®šï¼Œéè™šå‡½æ•°ä¸èƒ½è¿›è¡ŒåŠ¨æ€ç»‘å®š å¿…é¡»é€šè¿‡åŸºç±»ç±»å‹çš„å¼•ç”¨æˆ–æŒ‡é’ˆè¿›è¡Œå‡½æ•°è°ƒç”¨ ä¸ºå¤šæ€åŸºç±»å£°æ˜virtualææ„å‡½æ•° ç»™å¤šæ€åŸºç±»åº”è¯¥ä¸»åŠ¨å£°æ˜virtualææ„å‡½æ•° éå¤šæ€åŸºç±»ï¼Œæ²¡æœ‰virtualå‡½æ•°ï¼Œä¸è¦å£°æ˜virtualææ„å‡½æ•° å¤åˆ¶å¯¹è±¡æ—¶å‹¿å¿˜å…¶æ¯ä¸ªæˆåˆ† å®ç°æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼æ“ä½œç¬¦çš„æ—¶å€™ï¼Œè°ƒç”¨baseçš„ç›¸å…³å‡½æ•° å¯ä»¥è®©æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼æ“ä½œç¬¦è°ƒç”¨ä¸€ä¸ªå…±åŒçš„å‡½æ•°ï¼Œæ¯”å¦‚Init èµ„æºç®¡ç†ä»¥å¯¹è±¡ç®¡ç†èµ„æº ä¸ºäº†é˜²æ­¢èµ„æºæ³„æ¼ï¼Œè¯·ä½¿ç”¨RAIIå¯¹è±¡ï¼Œåœ¨æ„é€ å‡½æ•°é‡Œé¢è·å¾—èµ„æºï¼Œåœ¨ææ„å‡½æ•°é‡Œé¢é‡Šæ”¾èµ„æº shared_ptrï¼Œunique_lockéƒ½æ˜¯RAIIå¯¹è±¡ åœ¨èµ„æºç®¡ç†ç±»å°å¿ƒcopyè¡Œä¸º å¸¸è§çš„RAIIå¯¹è±¡copyè¡Œä¸º ç¦æ­¢copy å¼•ç”¨è®¡æ•° æ·±åº¦èµ‹å€¼ è½¬ç§»èµ„æºæ‹¥æœ‰æƒ å¤´æ–‡ä»¶æœç´¢ç›®å½•#include &quot;headfile.h&quot; æœç´¢é¡ºåºä¸ºï¼š å½“å‰ç›®å½• -IæŒ‡å®šç›®å½• gccçš„ç¯å¢ƒå˜é‡CPLUS_INCLUDE_PATHï¼ˆCç¨‹åºä½¿ç”¨çš„æ˜¯C_INCLUDE_PATHï¼‰ gccå†…å®šç›®å½•/usr/include/usr/local/include/usr/lib/gcc/x86_64-redhat-linux/4.1.1/include]]></content>
      <categories>
        <category>C++</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åºç« ]]></title>
    <url>%2F2018%2F12%2F09%2Ffiction%2F</url>
    <content type="text"><![CDATA[èŠ©ä¹Ÿä¸æ˜¯ä¸€å¼€å§‹å°±çŸ¥é“è¿™ä¸ªä¸–ç•Œæ˜¯é»‘ç™½çš„ï¼Œæ˜¯ä»–çš„çˆ¶äº²å‘Šè¯‰ä»–çš„ã€‚çˆ¶äº²è¯´ï¼ŒèŠ©ï¼Œä½ é•¿å¤§äº†ï¼Œçˆ¶äº²è¦èµ°äº†ã€‚èŠ©é—®ï¼Œçˆ¶äº²ä½ å»å“ªé‡Œï¼Ÿçˆ¶äº²è¯´ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œæˆ‘æ€»è§‰å¾—æœ‰äººåœ¨å¬å”¤æˆ‘ï¼Œæˆ‘è¯¥ä¸Šè·¯äº†ã€‚æˆ‘ä»¬æ¯ä¸ªäººéƒ½ä¼šä¸Šè·¯çš„ï¼ŒåŒ…æ‹¬ä½ ï¼ŒèŠ©ã€‚èŠ©è¯´ï¼Œçˆ¶äº²ï¼Œæˆ‘å¯ä»¥é™ªä½ ä¸€èµ·ä¸Šè·¯å—ï¼Ÿçˆ¶äº²å›ç­”ï¼Œæˆ‘ä»¬æ¯ä¸ªäººçš„è·¯éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œä½ ä»¥åä¼šæœ‰ä½ è‡ªå·±çš„è·¯èµ°çš„ï¼Œæˆ–è®¸æ˜¯æ˜å¤©ï¼Œæˆ–è®¸æ˜¯æ˜å¹´ï¼Œæˆ–è®¸æ˜¯æ›´ä¹…ã€‚èŠ©æ²¡è¯´è¯ï¼Œå…­å²çš„ä»–ä¸çŸ¥é“è¯¥è¯´ä»€ä¹ˆï¼Œä¹Ÿä¸å¤ªæ˜ç™½çˆ¶äº²å¯¹ä»–è¯´çš„è¯ã€‚å¥¹åªçŸ¥é“ï¼Œçˆ¶äº²è¦èµ°äº†ã€‚è¦å»å¾ˆè¿œçš„åœ°æ–¹ï¼Œä¸€ä¸ªå¥¹æ‰¾ä¸åˆ°çš„åœ°æ–¹ã€‚è€Œå¥¹ï¼Œå†ä¹Ÿè§ä¸åˆ°çˆ¶äº²äº†ã€‚]]></content>
      <tags>
        <tag>æ··æ²Œ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity Shaderç¬¬ä¸‰éƒ¨åˆ†]]></title>
    <url>%2F2018%2F10%2F22%2FUnity-Shader-IntrodutionToTopic-2%2F</url>
    <content type="text"><![CDATA[é€æ˜æ•ˆæœé€æ˜æ˜¯æ¸¸æˆä¸­ç»å¸¸è¦ä½¿ç”¨çš„ä¸€ç§æ•ˆæœã€‚åœ¨å®æ—¶æ¸²æŸ“ä¸­è¦å®ç°é€æ˜æ•ˆæœï¼Œé€šå¸¸ä¼šåœ¨æ¸²æŸ“æ¨¡å‹æ—¶æ§åˆ¶å®ƒçš„é€æ˜é€šé“ï¼ˆAlpha Channelï¼‰ã€‚å½“å¼€å¯é€æ˜æ··åˆåï¼Œå½“ä¸€ä¸ªç‰©ä½“è¢«æ¸²æŸ“åˆ°å±å¹•ä¸Šæ—¶ï¼Œæ¯ä¸ªç‰‡å…ƒé™¤äº†é¢œè‰²å€¼å’Œæ·±åº¦å€¼ä¹‹å¤–ï¼Œå®ƒè¿˜æœ‰é€æ˜åº¦ã€‚å½“é€æ˜åº¦ä¸º1æ—¶ï¼Œè¡¨ç¤ºè¯¥åƒç´ æ˜¯å®Œå…¨ä¸é€æ˜çš„ï¼Œè€Œå½“å…¶ä¸º0æ—¶ï¼Œåˆ™è¡¨ç¤ºè¯¥åƒç´ å®Œå…¨ä¸ä¼šæ˜¾ç¤ºã€‚åœ¨Unityä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ä¸¤ç§æ–¹æ³•æ¥å®ç°é€æ˜æ•ˆæœï¼šç¬¬ä¸€ç§æ˜¯ä½¿ç”¨é€æ˜åº¦æµ‹è¯•ï¼ˆAlpha Testï¼‰ï¼Œè¿™ç§æ•ˆæœå…¶å®æ— æ³•å¾—åˆ°çœŸæ­£çš„åŠé€æ˜æ•ˆæœï¼›å¦ä¸€ç§æ˜¯é€æ˜åº¦æ··åˆï¼ˆAlpha Blendingï¼‰ã€‚åœ¨ä¹‹å‰çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ä»æ²¡æœ‰å¼ºè°ƒè¿‡æ¸²æŸ“é¡ºåºçš„é—®é¢˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“åœºæ™¯ä¸­åŒ…å«å¾ˆå¤šæ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰è€ƒè™‘æ˜¯å…ˆæ¸²æŸ“Aï¼Œåœ¨æ¸²æŸ“Bï¼Œæœ€ååœ¨æ¸²æŸ“Cï¼Œè¿˜æ˜¯æŒ‰ç…§å…¶ä»–çš„é¡ºåºæ¥æ¸²æŸ“ã€‚äº‹å®ä¸Šï¼Œå¯¹äºä¸é€æ˜ï¼ˆopaqueï¼‰ç‰©ä½“ï¼Œä¸è€ƒè™‘å®ƒä»¬çš„æ¸²æŸ“é¡ºåºä¹Ÿèƒ½å¾—åˆ°æ­£ç¡®çš„æ’åºæ•ˆæœï¼Œè¿™æ˜¯ç”±äºå¼ºå¤§çš„æ·±åº¦ç¼“å†²ï¼ˆdepth bufferï¼Œä¹Ÿè¢«ç§°ä¸ºz-bufferï¼‰çš„å­˜åœ¨ã€‚åœ¨å®æ—¶æ¸²æŸ“ä¸­ï¼Œæ·±åº¦ç¼“å†²æ˜¯ç”¨äºè§£å†³å¯è§æ€§ï¼ˆvisibilityï¼‰é—®é¢˜çš„ï¼Œå®ƒå¯ä»¥å†³å®šå“ªä¸ªç‰©ä½“çš„å“ªäº›éƒ¨åˆ†ä¼šè¢«æ¸²æŸ“åœ¨å‰é¢ï¼Œè€Œå“ªäº›éƒ¨åˆ†ä¼šè¢«å…¶ä»–ç‰©ä½“é®æŒ¡ã€‚å®ƒçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šæ ¹æ®æ·±åº¦ç¼“å†²ä¸­çš„å€¼æ¥åˆ¤æ–­è¯¥ç‰‡å…ƒè·ç¦»æ‘„åƒæœºçš„è·ç¦»ï¼Œå½“æ¸²æŸ“ä¸€ä¸ªç‰‡å…ƒæ—¶ï¼Œéœ€è¦æŠŠå®ƒçš„æ·±åº¦å€¼å’Œå·²ç»å­˜åœ¨äºæ·±åº¦ç¼“å†²ä¸­çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼ˆå¦‚æœå¼€å¯äº†æ·±åº¦æµ‹è¯•ï¼‰ï¼Œå¦‚æœå®ƒçš„å€¼è·ç¦»æ‘„åƒæœºæ›´è¿œï¼Œé‚£ä¹ˆè¯´æ˜è¿™ä¸ªç‰‡å…ƒä¸åº”è¯¥è¢«æ¸²æŸ“åˆ°å±å¹•ä¸Šï¼ˆæœ‰ç‰©ä½“é®æŒ¡ä½äº†å®ƒï¼‰ï¼›å¦åˆ™ï¼Œè¿™ä¸ªç‰‡å…ƒåº”è¯¥è¦†ç›–æ‰æ­¤æ—¶é¢œè‰²ç¼“å†²ä¸­çš„åƒç´ å€¼ï¼Œå¹¶æŠŠå®ƒçš„æ·±åº¦å€¼æ›´æ–°åˆ°æ·±åº¦ç¼“å†²ä¸­ï¼ˆå¦‚æœå¼€å¯äº†æ·±åº¦å†™å…¥ï¼‰ã€‚ é€æ˜åº¦æ··åˆé€æ˜åº¦æ··åˆçš„å®ç°è¦æ¯”é€æ˜åº¦æµ‹è¯•å¤æ‚ä¸€äº›ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨å¤„ç†é€æ˜åº¦æµ‹è¯•æ—¶ï¼Œå®é™…ä¸Šè·Ÿå¯¹å¾…æ™®é€šçš„ä¸é€æ˜ç‰©ä½“å‡ ä¹æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯åœ¨ç‰‡å…ƒç€è‰²å™¨ä¸­å¢åŠ äº†å¯¹é€æ˜åº¦åˆ¤æ–­å¹¶è£å‰ªç‰‡å…ƒçš„ä»£ç ã€‚è€Œæƒ³è¦å®ç°é€æ˜åº¦æ··åˆå°±æ²¡è¿™ä¹ˆç®€å•äº†ã€‚æˆ‘ä»¬å›é¡¾ä¹‹å‰æåˆ°çš„é€æ˜åº¦æ··åˆçš„åŸç†ã€‚é€æ˜åº¦æ··åˆï¼šè¿™ç§æ–¹æ³•å¯ä»¥å¾—åˆ°çœŸæ­£çš„åŠé€æ˜æ•ˆæœã€‚å®ƒä¼šä½¿ç”¨å½“å‰ç‰‡å…ƒçš„é€æ˜åº¦ä½œä¸ºæ··åˆå› å­ï¼Œä¸å·²ç»å­˜å‚¨åœ¨é¢œè‰²ç¼“å†²åŒºç§çš„é¢œè‰²è¿›è¡Œæ··åˆï¼Œå¾—åˆ°æ–°çš„é¢œè‰²ã€‚ä½†æ˜¯ï¼Œé€æ˜åº¦æ··åˆéœ€è¦å…³é—­æ·±åº¦å†™å…¥ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬è¦éå¸¸å°å¿ƒç‰©ä½“çš„æ¸²æŸ“é¡ºåºã€‚ä¸ºäº†è¿›è¡Œæ··åˆï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨Unityæä¾›çš„æ··åˆå‘½ä»¤Blendã€‚Blendæ˜¯Unityæä¾›çš„è®¾ç½®æ··åˆæ¨¡å¼çš„å‘½ä»¤ã€‚æƒ³è¦å®ç°åŠé€æ˜çš„æ•ˆæœå°±éœ€è¦æŠŠå½“å‰è‡ªèº«çš„é¢œè‰²å’Œå·²ç»å­˜åœ¨äºé¢œè‰²ç¼“å†²åŒºç§çš„é¢œè‰²å€¼è¿›è¡Œæ··åˆï¼Œæ··åˆæ—¶ä½¿ç”¨çš„å‡½æ•°å°±æ˜¯ç”±è¯¥æŒ‡ä»¤å†³å®šçš„ã€‚ è¯­ä¹‰ æè¿° Blend Off å…³é—­æ··åˆ Blend SrcFactor DstFactor å¼€å¯æ··åˆï¼Œå¹¶è®¾ç½®æ··åˆå› å­ã€‚æºé¢œè‰²ï¼ˆè¯¥ç‰‡å…ƒäº§ç”Ÿçš„é¢œè‰²ï¼‰ä¼šä¹˜ä»¥SrcFactorï¼Œè€Œç›®æ ‡é¢œè‰²ï¼ˆå·²ç»å­˜åœ¨äºé¢œè‰²ç¼“å­˜çš„é¢œè‰²ï¼‰ä¼šä¹˜ä»¥DstFactorï¼Œç„¶åæŠŠä¸¤è€…ç›¸åŠ ååœ¨å­˜å…¥é¢œè‰²ç¼“å†²ä¸­ Blend SrcFactor DstFactor, SrcFactorA DstFractorA å’Œä¸Šé¢ä¸€æ ·ï¼Œåªæ˜¯ä½¿ç”¨ä¸åŒçš„å› å­æ¥æ··åˆé€æ˜é€šé“ BlendOp BlendOperation å¹¶éæ˜¯æŠŠæºé¢œè‰²å’Œç›®æ ‡é¢œè‰²ç®€å•ç›¸åŠ åæ··åˆï¼Œè€Œæ˜¯ä½¿ç”¨BlendOperationå¯¹å®ƒä»¬è¿›è¡Œå…¶ä»–æ“ä½œ æˆ‘ä»¬ä»‹ç»ç¬¬äºŒç§è¯­ä¹‰ï¼Œå³Blend SrcFactor DstFactoræ¥è¿›è¡Œæ··åˆã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªå‘½ä»¤åœ¨è®¾ç½®æ··åˆå› å­çš„åŒæ—¶ä¹Ÿå¼€å¯äº†æ··åˆæ¨¡å¼ã€‚è¿™æ˜¯å› ä¸ºï¼Œåªæœ‰å¼€å¯äº†æ··åˆä¹‹åï¼Œè®¾ç½®ç‰‡å…ƒçš„é€æ˜é€šé“æ‰æœ‰æ„ä¹‰ï¼Œè€ŒUnityåœ¨æˆ‘ä»¬ä½¿ç”¨Blendå‘½ä»¤çš„æ—¶å€™å°±è‡ªåŠ¨å¸®æˆ‘ä»¬æ‰“å¼€äº†ã€‚å¾ˆå¤šåˆå­¦è€…æŠ±æ€¨ä¸ºä»€ä¹ˆè‡ªå·±çš„æ¨¡å‹æ²¡æœ‰ä»»ä½•é€æ˜æ•ˆæœï¼Œè¿™å¾€å¾€æ˜¯å› ä¸ºä»–ä»¬æ²¡æœ‰åœ¨Passä¸­ä½¿ç”¨Blendå‘½ä»¤ï¼Œä¸€æ–¹é¢æ˜¯æ²¡æœ‰è®¾ç½®æ··åˆå› å­ï¼Œæ›´é‡è¦çš„æ˜¯æ²¡æœ‰æ‰“å¼€æ··åˆæ¨¡å¼ã€‚æˆ‘ä»¬ä¼šæŠŠæºé¢œè‰²çš„æ··åˆå› å­SrcFactorè®¾ä¸ºSrcAlphaï¼Œè€Œç›®æ ‡é¢œè‰²çš„æ··åˆå› å­DstFactorè®¾ä¸ºOneMinusSrcAlphaã€‚è¿™æ„å‘³ç€ï¼Œç»è¿‡æ··åˆåæ–°çš„é¢œè‰²æ˜¯ï¼š $DstColor_{new} = SrcAlphaSrcColor+(1-SrcAlpha)DstColor_{old}$ å¼€å¯æ·±åº¦å†™å…¥çš„åŠé€æ˜æ•ˆæœShaderLabçš„æ··åˆå‘½ä»¤æ··åˆç­‰å¼å’Œå‚æ•°æ··åˆæ“ä½œå¸¸è§å’Œæ··åˆç±»å‹åŒé¢æ¸²æŸ“çš„é€æ˜æ•ˆæœé€æ˜åº¦æµ‹è¯•çš„åŒé¢æ¸²æŸ“é€æ˜åº¦æ··åˆçš„åŒé¢æ¸²æŸ“æ¸²æŸ“è·¯å¾„Rendering Path LightMode æè¿° Always ä¸ç®¡ä½¿ç”¨å“ªç§æ¸²æŸ“è·¯å¾„ï¼Œè¯¥Passæ€»æ˜¯ä¼šè¢«æ¸²æŸ“ï¼Œä½†ä¸ä¼šè®¡ç®—ä»»ä½•å…‰ç…§ ForwardBase ç”¨äºå‰å‘æ¸²æŸ“ã€‚è¯¥Passä¼šè®¡ç®—ç¯å¢ƒå…‰ã€æœ€é‡è¦çš„å¹³è¡Œå…‰ã€é€é¡¶ç‚¹/SHå…‰æºå’ŒLightmaps ForwardAdd ç”¨äºå‰å‘æ¸²æŸ“ã€‚è¯¥Passä¼šè®¡ç®—é¢å¤–çš„é€åƒç´ å…‰æºï¼Œæ¯ä¸ªPasså¯¹åº”ä¸€ä¸ªå…‰æº Deferred ç”¨äºå»¶è¿Ÿæ¸²æŸ“ã€‚è¯¥Passä¼šæ¸²æŸ“Gç¼“å†²ï¼ˆG-bufferï¼‰ ShadowCaster æŠŠç‰©ä½“çš„æ·±åº¦ä¿¡æ¯æ¸²æŸ“åˆ°é˜´å½±æ˜ å°„çº¹ç†ï¼ˆshadowmapï¼‰æˆ–ä¸€å¼ æ·±åº¦çº¹ç†ä¸­ PrepassBase ç”¨äºé—ç•™çš„å»¶è¿Ÿæ¸²æŸ“ã€‚è¯¥Passä¼šæ¸²æŸ“æ³•çº¿å’Œé«˜å…‰åå°„çš„æŒ‡æ•°éƒ¨åˆ† PrepassFinal ç”¨äºé—ç•™çš„å»¶è¿Ÿæ¸²æŸ“ã€‚è¯¥Passé€šè¿‡åˆå¹¶çº¹ç†ã€å…‰ç…§å’Œè‡ªå‘å…‰æ¥æ¸²æŸ“å¾—åˆ°æœ€åçš„é¢œè‰² Vertexã€VertexLMRGBMå’ŒVertexLX ç”¨äºé—ç•™çš„é¡¶ç‚¹ç…§æ˜æ¸²æŸ“ Unityåœ¨å¤„ç†å¤šå…‰æºçš„æƒ…å†µæ—¶ä¸ºæˆ‘ä»¬æä¾›äº†ä¸‰ç§æ¨¡å¼ï¼›ä¿®æ”¹çš„åœ°æ–¹åœ¨Edit-&gt;Project Settingsâ€”Playerâ€”Other Settingsâ€”Redering Path é¡¶ç‚¹å…‰Vertex Lit æ–¹å‘æ€§Forward(é»˜è®¤) å»¶è¿Ÿç…§æ˜ Deferred Lighting shaderé»˜è®¤ä½¿ç”¨Forward å‰å‘æ¸²æŸ“è·¯å¾„æ¯è¿›è¡Œä¸€æ¬¡å®Œæ•´çš„å‰å‘æ¸²æŸ“ï¼Œéœ€è¦æ¸²æŸ“è¯¥å¯¹è±¡çš„æ¸²æŸ“å›¾å…ƒï¼Œå¹¶è®¡ç®—ä¸¤ä¸ªç¼“å†²åŒºçš„ä¿¡æ¯ï¼šä¸€ä¸ªæ˜¯é¢œè‰²ç¼“å†²åŒºï¼Œä¸€ä¸ªæ˜¯æ·±åº¦ç¼“å†²åŒºã€‚åˆ©ç”¨æ·±åº¦ç¼“å†²åŒºæ¥å†³å®šä¸€ä¸ªç‰‡å…ƒæ˜¯å¦å¯è§ï¼Œå¦‚æœå¯è§å°±æ›´æ–°é¢œè‰²ç¼“å†²åŒºçš„çš„é¢œè‰²å€¼ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„ä¼ªä»£ç æ¥æè¿°å‰å‘æ¸²æŸ“è·¯å¾„çš„å¤§è‡´è¿‡ç¨‹ï¼š 12345678910111213141516171819Pass &#123; for (each primitive in this model) &#123; if (failed in depth test) &#123; // å¦‚æœæ²¡æœ‰é€šè¿‡æ·±åº¦æµ‹è¯•ï¼Œè¯´æ˜è¯¥ç‰‡å…ƒæ˜¯ä¸å¯è§çš„ discard; &#125; else &#123; // å¦‚æœè¯¥ç‰‡å…ƒå¯è§ // å°±è¿›è¡Œå…‰ç…§è®¡ç®— float4 color = Shading(materialInfo, pos, normal, lightDir, viewDir); // æ›´æ–°å¸§ç¼“å†² writeFrameBuffer(fragment, color); &#125; &#125;&#125; å¯¹äºæ¯ä¸ªé€åƒç´ å…‰æºï¼Œæˆ‘ä»¬éƒ½éœ€è¦è¿›è¡Œä¸Šé¢ä¸€æ¬¡å®Œæ•´çš„æ¸²æŸ“æµç¨‹ã€‚å¦‚æœä¸€ä¸ªç‰©ä½“åœ¨å¤šä¸ªé€åƒç´ å…‰æºçš„å½±å“åŒºåŸŸå†…ï¼Œé‚£ä¹ˆè¯¥ç‰©ä½“å°±éœ€è¦æ‰§è¡Œå¤šä¸ªPassï¼Œæ¯ä¸ªPassè®¡ç®—ä¸€ä¸ªé€åƒç´ å…‰æºçš„å…‰ç…§ç»“æœï¼Œç„¶ååœ¨å¸§ç¼“å†²ä¸­æŠŠè¿™äº›å…‰ç…§ç»“æœæ··åˆèµ·æ¥å¾—åˆ°æœ€ç»ˆçš„é¢œè‰²å€¼ã€‚å‡è®¾ï¼Œåœºæ™¯ä¸­æœ‰Nä¸ªç‰©ä½“ï¼Œæ¯ä¸ªç‰©ä½“ç‰©ä½“å—Mä¸ªå…‰æºçš„å½±å“ï¼Œé‚£ä¹ˆè¦æ¸²æŸ“æ•´ä¸ªåœºæ™¯ä¸€å…±éœ€è¦N*Mä¸ªPassã€‚å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœæœ‰å¤§é‡é€åƒç´ å…‰ç…§ï¼Œé‚£ä¹ˆéœ€è¦æ‰§è¡Œçš„Passæ•°ç›®ä¹Ÿä¼šå¾ˆå¤§ã€‚å› æ­¤ï¼Œæ¸²æŸ“å¼•æ“é€šå¸¸ä¼šé™åˆ¶æ¯ä¸ªç‰©ä½“çš„é€åƒç´ å…‰ç…§çš„æ•°ç›®ã€‚ Unityä¸­çš„å‰å‘æ¸²æŸ“äº‹å®ä¸Šï¼Œä¸€ä¸ªPassä¸ä»…ä»…å¯ä»¥ç”¨æ¥è®¡ç®—é€åƒç´ å…‰ç…§ï¼Œå®ƒä¹Ÿå¯ä»¥ç”¨æ¥è®¡ç®—é€é¡¶ç‚¹ç­‰å…¶ä»–å…‰ç…§ã€‚è¿™å–å†³äºå…‰ç…§è®¡ç®—æ‰€å¤„æµæ°´çº¿é˜¶æ®µä»¥åŠè®¡ç®—æ—¶ä½¿ç”¨çš„æ•°å­¦æ¨¡å‹ã€‚å½“æ¸²æŸ“ä¸€ä¸ªç‰©ä½“æ—¶ï¼ŒUnityä¼šè®¡ç®—å“ªäº›å…‰æºç…§äº®äº†å®ƒï¼Œä»¥åŠè¿™äº›å…‰æºç…§äº®è¯¥ç‰©ä½“çš„æ–¹å¼ã€‚åœ¨Unityä¸­ï¼Œå‰å‘æ¸²æŸ“è·¯å¾„æœ‰3ç§å¤„ç†å…‰ç…§ï¼ˆå³ç…§äº®ç‰©ä½“ï¼‰çš„æ–¹å¼ï¼šé€é¡¶ç‚¹å¤„ç†ã€é€åƒç´ å¤„ç†ï¼Œçƒè°å‡½æ•°ï¼ˆSpherical Harmonics, SHï¼‰å¤„ç†ã€‚ é¡¶ç‚¹ç…§æ˜æ¸²æŸ“è·¯å¾„å»¶è¿Ÿæ¸²æŸ“è·¯å¾„è¿™æ˜¯ä¸€ç§å¯ä»¥æŒ‰ç…§ä½ çš„éœ€æ±‚åœ¨åœºæ™¯ä¸­ä½¿ç”¨ä»»æ„æ•°ç›®çš„å…‰æºçš„æ–¹æ³•ï¼Œè€Œä¸”è¿™ä¸ªæ–¹æ³•è¿˜èƒ½åŒæ—¶ä¿è¯æ€§èƒ½ä»ç„¶ä¿æŒåœ¨ä¸€ä¸ªåˆç†çš„èŒƒå›´ã€‚å®ƒä¹Ÿä¸é™åˆ¶é˜´å½±çš„æ•°é‡ï¼Œå¦‚æœåœºæ™¯ä¸­çš„å¯¹è±¡å®åœ¨å…‰ç…§èŒƒå›´ä¹‹å†…çš„è¯ï¼Œä¹Ÿä¸ä¼šå¢åŠ é¢å¤–çš„æ¸²æŸ“æ‰¹æ¬¡ï¼ˆå¦‚æœå¯¹è±¡æŠ•å½±é˜´å½±çš„è¯åˆ™æ˜¯ä¾‹å¤–ï¼‰ã€‚ åœ¨æ¸¸æˆä¸­çš„å®æ—¶å…‰ç…§ï¼Œä¸€èˆ¬æœ‰ä¸‰ç§å¸¸ç”¨çš„æ–¹æ³• ä¸€éæ¸²æŸ“å¤šä¸ªå…‰æºï¼šæ‰€æœ‰å…‰æºéƒ½åœ¨ä¸€ä¸ªç€è‰²å™¨ä¸­è¿›è¡Œã€‚ä½†ä¸€ä¸ªç€è‰²å™¨æŒ‡ä»¤æ•°é‡æœ‰é™ï¼Œæ‰€ä»¥è¿™ä¸ªæŠ€æœ¯åªé€‚ç”¨äºå…‰æºæ•°é‡è¾ƒå°‘çš„æƒ…å†µã€‚ å¤šéæ¸²æŸ“å¤šå…‰æº å»¶è¿Ÿæ¸²æŸ“ å¹¿å‘Šç‰Œå¹¿å‘Šç‰ŒæŠ€æœ¯çš„æœ¬è´¨å°±æ˜¯æ„å»ºæ—‹è½¬çŸ©é˜µï¼Œè€Œæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªå˜æ¢çŸ©é˜µéœ€è¦3ä¸ªåŸºå‘é‡ã€‚å¹¿å‘Šç‰ŒæŠ€æœ¯ä½¿ç”¨çš„åŸºå‘é‡é€šå¸¸å°±æ˜¯è¡¨é¢æ³•çº¿ï¼ˆnormalï¼‰ã€æŒ‡å‘ä¸Šçš„æ–¹å‘ï¼ˆupï¼‰ä»¥åŠæŒ‡å‘å³çš„æ–¹å‘ï¼ˆrightï¼‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æŒ‡å®šä¸€ä¸ªé”šç‚¹ï¼ˆanchor locationï¼‰ï¼Œè¿™ä¸ªé”šç‚¹åœ¨æ—‹è½¬è¿‡ç¨‹ä¸­æ˜¯å›ºå®šä¸å˜çš„ï¼Œä»¥æ­¤æ¥ç¡®å®šå¤šè¾¹å½¢åœ¨ç©ºé—´ä¸­çš„ä½ç½®ã€‚å¹¿å‘Šç‰ŒæŠ€æœ¯çš„éš¾ç‚¹åœ¨äºï¼Œå¦‚ä½•æ ¹æ®éœ€æ±‚æ„å»º3ä¸ªç›¸äº’æ­£äº¤çš„åŸºå‘é‡ã€‚è®¡ç®—è¿‡ç¨‹é€šå¸¸æ˜¯ï¼ŒCPUå†™æ³•ï¼š12345678public Vector3 Normal;Quaternion direction;void Start () &#123; direction = Quaternion.FromToRotation(new Vector3(0, 0, 1), Normal);&#125;void Update () &#123; transform.rotation = Camera.main.transform.rotation * direction;&#125; å±å¹•åå¤„ç†æ•ˆæœå»ºç«‹ä¸€ä¸ªåŸºæœ¬çš„å±å¹•åå¤„ç†è„šæœ¬ç³»ç»ŸMonoBehaviour.OnRenderImage(RenderTexture src, RenderTexture dest); å½“åœ¨è„šæœ¬ä¸­å£°æ˜è¯¥å‡½æ•°åï¼ŒUnityä¼šæŠŠå½“å‰æ¸²æŸ“å¾—åˆ°çš„å›¾åƒå­˜å‚¨åœ¨ç¬¬ä¸€ä¸ªå‚æ•°å¯¹åº”çš„æºæ¸²æŸ“çº¹ç†ä¸­ï¼ŒæŠŠç¬¬äºŒå‚æ•°å¯¹åº”çš„æ¸²æŸ“çº¹ç†æ˜¾ç¤ºåˆ°å±å¹•ä¸Šã€‚ public static void Blit(Texture src, RenderTexture dest); public static void Blit(Texture src, RenderTextrue dest, Material mat, int pass = -1); public static void Blit(Texture src, Material mat, int pass = -1); å‚æ•°passçš„é»˜è®¤å€¼èƒƒ-1ï¼Œè¡¨ç¤ºå°†ä¼šä¾æ¬¡è°ƒç”¨Shaderå†…çš„æ‰€æœ‰Passã€‚å¦åˆ™ï¼Œåªä¼šè°ƒç”¨ç»™å®šç´¢å¼•çš„Passã€‚ ä½¿ç”¨æ·±åº¦å’Œæ³•çº¿çº¹ç†æ¶ˆèå™ªå£°çº¹ç†+é€æ˜åº¦æµ‹è¯•ï¼Œæˆ‘ä»¬ä½¿ç”¨å¯¹å™ªå£°çº¹ç†é‡‡æ ·çš„ç»“æœå’ŒæŸä¸ªæ§åˆ¶æ¶ˆèç¨‹åº¦çš„é˜€å€¼æ¯”è¾ƒï¼Œå¦‚æœå°äºé˜€å€¼ï¼Œå°±ä½¿ç”¨clipå‡½æ•°æŠŠå®ƒå¯¹åº”çš„åƒç´ è£å‡æ‰ã€‚ 12345678910111213141516171819202122Shader &quot;Test&quot;&#123; Properties &#123; _BurnAmount(&quot;Burn Amount&quot;, Range(0.0, 1.0)) = 0.0 // æ§åˆ¶æ¶ˆèç¨‹åº¦ï¼Œ0ä¸ºæ­£å¸¸ï¼Œ1å®Œå…¨æ¶ˆè _LineWith(&quot;Burn Line Width&quot;, Range(0.0, 0.2)) = 0.1 // æ¨¡æ‹Ÿçƒ§ç„¦æ•ˆæœçš„çº¿å®½ï¼Œå€¼è¶Šå¤§ï¼Œç«ç„°è¾¹ç¼˜çš„è”“å»¶èŒƒå›´è¶Šå®½ _MainText (&quot;Base (RGB)&quot;, 2D) = &quot;white&quot; &#123;&#125; // æ¼«åå°„çº¹ç† _BumpMap (&quot;Normal Map&quot;, 2D) = &quot;bump&quot; &#123;&#125; // æ³•çº¿çº¹ç† _BurnFirstColor(&quot;Burn First Color&quot;, Color) = (1,0,0,1) // ç«ç„°è¾¹ç¼˜é¢œè‰² _BurnSecondColor(&quot;Burn Second Color&quot;, Color) = (1,0,0,1) // ç«ç„°è¾¹ç¼˜é¢œè‰² _BurnMap(&quot;Burn Map&quot;, 2D) = &quot;white&quot; &#123;&#125; // æ¶ˆèçº¹ç† &#125; SubShader &#123; Pass &#123; CGPROGRAM #pragma vertex vert #pragma vertex frag ENDCG &#125; &#125; &#125; æ°´æ³¢æ•ˆæœåœ¨æ¨¡æ‹Ÿå®æ—¶æ°´é¢çš„è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€ä¹Ÿä¼šä½¿ç”¨å™ªå£°çº¹ç†ã€‚æ­¤æ—¶ï¼Œå™ªå£°çº¹ç†é€šå¸¸ä¼šç”¨ä½œä¸€ä¸ªé«˜åº¦å›¾ï¼Œä»¥ä¸æ–­ä¿®æ”¹æ°´é¢çš„æ³•çº¿æ–¹å‘ã€‚ä¸ºäº†æ¨¡æ‹Ÿæ°´ä¸æ–­æµåŠ¨çš„æ•ˆæœï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨å’Œæ—¶é—´ç›¸å…³çš„å˜é‡æ¥å¯¹å™ªå£°çº¹ç†è¿›è¡Œé‡‡æ ·ï¼Œå½“å¾—åˆ°æ³•çº¿ä¿¡æ¯åï¼Œåœ¨è¿›è¡Œæ­£å¸¸çš„åå°„+æŠ˜å°„è®¡ç®—ï¼Œå¾—åˆ°æœ€åçš„æ°´é¢æ³¢åŠ¨æ•ˆæœã€‚1234SubShader &#123; Tags &#123;&quot;Queue&quot;=&quot;Transparent&quot; &quot;RenderType&quot;=&quot;Opaque&quot;&#125; GrabPass &#123;&quot;_RefractionTex&quot;&#125;&#125; é¦–å…ˆæŠŠSubShaderçš„æ ‡ç­¾ä¸­æ¸²æŸ“é˜Ÿåˆ—è®¾ç½®æˆTransparentï¼Œå¹¶æŠŠåé¢çš„RenderTypeè®¾ç½®ä¸ºOpaqueã€‚æŠŠQueueè®¾ç½®æˆTransparentå¯ä»¥ç¡®ä¿è¯¥ç‰©ä½“æ¸²æŸ“æ—¶ï¼Œå…¶ä»–æ‰€æœ‰ä¸é€æ˜çš„ç‰©ä½“éƒ½å·²ç»è¢«æ¸²æŸ“åˆ°å±å¹•ä¸Šäº†ï¼Œå¦åˆ™å°±å¯èƒ½æ— æ³•æ­£ç¡®å¾—åˆ°â€œé€è¿‡æ°´é¢çœ‹åˆ°çš„å›¾åƒâ€ã€‚è€Œè®¾ç½®RenderTypeåˆ™æ˜¯ä¸ºäº†åœ¨ä½¿ç”¨ç€è‰²å™¨æ›¿æ¢ï¼ˆShader Replacementï¼‰æ—¶ï¼Œè¯¥ç‰©ä½“å¯ä»¥åœ¨éœ€è¦æ—¶è¢«æ­£ç¡®æ¸²æŸ“ã€‚]]></content>
      <categories>
        <category>Unity Shader</category>
      </categories>
      <tags>
        <tag>Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity Shaderç¬¬äºŒéƒ¨åˆ†]]></title>
    <url>%2F2018%2F10%2F21%2FUnity-Shader-IntroductionToTopic1%2F</url>
    <content type="text"><![CDATA[å…‰æºåœ¨å…‰å­¦é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨è¾ç…§åº¦ï¼ˆirradianceï¼‰æ¥é‡åŒ–å…‰ã€‚å¯¹äºå¹³è¡Œå…‰æ¥è¯´ï¼Œå®ƒçš„è¾ç…§åº¦å¯é€šè¿‡è®¡ç®—åœ¨å‚ç›´äºlçš„å•ä½å¹³é¢ä¸Šçš„å•ä½æ—¶é—´å†…ç©¿è¿‡çš„èƒ½é‡æ¥å¾—åˆ°ã€‚ å¸æ”¶å’Œæ•£å°„å…‰çº¿ç”±å…‰æºå‘å°„å‡ºæ¥åï¼Œå°±ä¼šä¸ä¸€äº›ç‰©ä½“ç›¸äº¤ã€‚é€šå¸¸ï¼Œç›¸äº¤çš„ç»“æ„æœ‰ä¸¤ä¸ªï¼šæ•£å°„ï¼ˆscatteringï¼‰å’Œå¸æ”¶ï¼ˆabsorptionï¼‰ã€‚æ•£å°„åªæ”¹å˜å…‰çº¿çš„æ–¹å‘ï¼Œä½†ä¸æ”¹å˜å…‰çº¿çš„å¯†åº¦å’Œé¢œè‰²ã€‚è€Œå¸æ”¶åªæ”¹å˜å…‰çº¿çš„å¯†åº¦å’Œé¢œè‰²ï¼Œä½†ä¸æ”¹å˜å…‰çº¿çš„æ–¹å‘ã€‚ BRDFå…‰ç…§æ¨¡å‹æˆ‘ä»¬å·²ç»äº†è§£äº†å…‰çº¿åœ¨å’Œç‰©ä½“è¡¨é¢ç›¸äº¤æ—¶ä¼šå‘ç”Ÿå“ªäº›ç°è±¡ã€‚å½“å·²çŸ¥å…‰æºä½ç½®å’Œæ–¹å‘ã€è§†è§’æ–¹å‘æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦çŸ¥é“ä¸€ä¸ªè¡¨é¢æ˜¯å’Œå…‰ç…§è¿›è¡Œäº¤äº’çš„ã€‚ä¾‹å¦‚ï¼Œå½“å…‰çº¿ä»æŸä¸ªæ–¹å‘ç…§å°„åˆ°ä¸€ä¸ªè¡¨é¢æ—¶ï¼Œæœ‰å¤šå°‘å…‰çº¿è¢«åå°„ï¼Ÿåå°„çš„æ–¹å‘æœ‰å“ªäº›ï¼Ÿè€ŒBRDFï¼ˆBidirectional Reflectance Distribution Functionï¼‰å°±æ˜¯ç”¨æ¥å›ç­”è¿™äº›é—®é¢˜çš„ã€‚å½“ç»™å®šæ¨¡å‹è¡¨é¢ä¸Šçš„ä¸€ä¸ªç‚¹æ—¶ï¼ŒBRDFåŒ…å«äº†å¯¹è¯¥ç‚¹å¤–è§‚çš„å®Œæ•´çš„æè¿°ã€‚åœ¨å›¾å½¢å­¦ç§ï¼ŒBRDFå¤§å¤šä½¿ç”¨ä¸€ä¸ªæ•°å­¦å…¬å¼æ¥è¡¨ç¤ºï¼Œå¹¶ä¸”æä¾›äº†ä¸€äº›å‚æ•°æ¥è°ƒæ•´æè´¨å±æ€§ã€‚é€šä¿—æ¥è®²ï¼Œå½“ç»™å®šå…¥å°„å…‰çº¿çš„æ–¹å‘å’Œè¾ç…§åº¦åï¼ŒBRDKå¯ä»¥ç»™å‡ºæŸä¸ªå‡ºå°„æ–¹å‘ä¸Šçš„å…‰ç…§èƒ½é‡åˆ†å¸ƒã€‚æœ¬ç« æ¶‰åŠçš„BRDFéƒ½æ˜¯å¯¹çœŸå®åœºæ™¯è¿›è¡Œç†æƒ³åŒ–å’Œç®€åŒ–åçš„æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬å¹¶ä¸èƒ½çœŸå®åœ°åæ˜ ç‰©ä½“å’Œå…‰çº¿ä¹‹é—´åœ°äº¤äº’ï¼Œè¿™äº›å…‰ç…§æ¨¡å‹è¢«æˆä¸ºæ˜¯ç»éªŒæ¨¡å‹ã€‚å°½ç®¡å¦‚æ­¤ï¼Œè¿™äº›ç»éªŒæ¨¡å‹ä»ç„¶åœ¨å®æ—¶æ¸²æŸ“é¢†åŸŸè¢«åº”ç”¨äº†å¤šå¹´ã€‚ æ ‡å‡†å…‰ç…§æ¨¡å‹åŸºæœ¬æ–¹æ³•æ˜¯ï¼ŒæŠŠè¿›å…¥åˆ°æ‘„åƒæœºçš„å…‰çº¿åˆ†ä¸º4éƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†ä½¿ç”¨ä¸€ç§æ–¹æ³•æ¥è®¡ç®—å®ƒçš„è´¡çŒ®åº¦ è‡ªå‘å…‰(emissive) é«˜å…‰åå°„(specular) æ¼«åå°„(diffuse) ç¯å¢ƒå…‰(ambient) ç¯å¢ƒå…‰åœ¨æ ‡å‡†å…‰ç…§æ¨¡å‹ä¸­ï¼Œä½¿ç”¨ä¸€ç§è¢«ç§°ä¸ºç¯å¢ƒå…‰çš„éƒ¨åˆ†æ¥è¿‘ä¼¼æ¨¡æ‹Ÿé—´æ¥å…‰ç…§ã€‚ç¯å¢ƒå…‰çš„è®¡ç®—éå¸¸ç®€å•ï¼Œå®ƒé€šå¸¸æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå³åœºæ™¯ä¸­çš„æ‰€æœ‰ç‰©ä½“éƒ½ä½¿ç”¨è¿™ä¸ªç¯å¢ƒå…‰ã€‚ä¸‹é¢çš„ç­‰å¼ç»™å‡ºäº†è®¡ç®—ç¯å¢ƒå…‰çš„éƒ¨åˆ†ï¼š $c_{ambient}=g_{ambient}$ è‡ªå‘å…‰å…‰çº¿ä¹Ÿå¯ä»¥ç›´æ¥ç”±å…‰æºå‘å°„è¿›å…¥æ‘„åƒæœºï¼Œè€Œä¸éœ€è¦ç»è¿‡ä»»ä½•ç‰©ä½“çš„åå°„ã€‚æ ‡å‡†å…‰ç…§æ¨¡å‹ä½¿ç”¨è‡ªå‘å…‰æ¥è®¡ç®—è¿™ä¸ªéƒ¨åˆ†çš„è´¡çŒ®åº¦ã€‚å®ƒçš„è®¡ç®—ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯ç›´æ¥ä½¿ç”¨äº†è¯¥æè´¨çš„è‡ªå‘å…‰é¢œè‰²ï¼š $c_{emissive}=m_{emissive}$ é€šå¸¸åœ¨å®æ—¶æ¸²æŸ“ä¸­ï¼Œè‡ªå‘å…‰çš„è¡¨é¢å¾€å¾€å¹¶ä¸ä¼šç…§äº®å‘¨å›´çš„è¡¨é¢ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªç‰©ä½“å¹¶ä¸ä¼šè¢«å½“æˆä¸€ä¸ªå…‰æºã€‚ æ¼«åå°„æ¼«åå°„å…‰ç…§æ˜¯ç”¨äºå¯¹é‚£äº›è¢«ç‰©ä½“è¡¨é¢éšæœºæ•£å°„åˆ°å„ä¸ªæ–¹å‘çš„è¾å°„åº¦è¿›è¡Œå»ºæ¨¡çš„ã€‚åœ¨æ¼«åå°„ä¸­ï¼Œè§†è§’çš„ä½ç½®æ˜¯ä¸é‡è¦çš„ï¼Œå› ä¸ºåå°„æ˜¯å®Œå…¨éšæœºçš„ï¼Œå› æ­¤å¯ä»¥è®¤ä¸ºåœ¨ä»»ä½•åå°„æ–¹å‘ä¸Šçš„åˆ†å¸ƒéƒ½æ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯ï¼Œå…¥å°„å…‰çº¿çš„è§’åº¦å¾ˆé‡è¦ã€‚æ¼«åå°„å…‰ç…§ç¬¦åˆå…°ä¼¯ç‰¹å®šå¾‹ï¼ˆLambertâ€™s lawï¼‰ï¼šåå°„å…‰çº¿çš„å¼ºåº¦ä¸è¡¨é¢å‘ç°å’Œå…‰æºæ–¹å‘ä¹‹é—´å¤¹è§’çš„ä½™å¼¦å€¼æˆæ­£æ¯”ã€‚å› æ­¤ï¼Œæ¼«åå°„éƒ¨åˆ†çš„è®¡ç®—å¦‚ä¸‹ï¼š $c_{diffuse} = (c_{light} \cdot m_{diffuse})max(0, n \cdot I)$ é«˜å…‰åå°„è¿™é‡Œçš„é«˜å…‰åå°„æ˜¯ä¸€ç§ç»éªŒæ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¹¶ä¸å®Œå…¨ç¬¦åˆçœŸå®ä¸–ç•Œä¸­çš„é«˜å…‰åå°„ç°è±¡ã€‚å®ƒå¯ç”¨äºè®¡ç®—é‚£äº›æ²¿ç€å®Œå…¨é•œé¢åå°„æ–¹å‘è¢«åå°„çš„å…‰çº¿ï¼Œè¿™å¯ä»¥è®©ç‰©ä½“çœ‹èµ·æ¥æ˜¯æœ‰å…‰æ³½çš„ï¼Œä¾‹å¦‚é‡‘å±æè´¨ã€‚è®¡ç®—é«˜å…‰åå°„éœ€è¦çŸ¥é“çš„ä¿¡æ¯æ¯”è¾ƒå¤šï¼Œå¦‚è¡¨é¢æ³•çº¿ã€è§†è§’æ–¹å‘ã€å…‰æºæ–¹å‘ã€åå°„æ–¹å‘ç­‰ã€‚åå°„è®¡ç®—å…¬å¼ï¼š$r = 2(\vec{n} \cdot I)\vec{n} - I$æ¨å¯¼å…¬å¼è§Light Reflectè¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨Phongæ¨¡å‹æ¥è®¡ç®—é«˜å…‰åå°„çš„éƒ¨åˆ†ï¼š $c_{spscular} = (c_{light} \cdot m_{specular})max(0, \vec{v} \cdot r)^{m_{glass}}$å…¶ä¸­ï¼Œ$m_{gloss}$æ˜¯æè´¨çš„å…‰æ³½åº¦ï¼ˆglossï¼‰ï¼Œä¹Ÿè¢«ç§°ä¸ºåå…‰åº¦ï¼ˆshinnessï¼‰ã€‚å®ƒç”¨äºæ§åˆ¶é«˜å…‰åŒºåŸŸçš„â€œäº®ç‚¹â€æœ‰å¤šå®½ï¼Œ$m_{gloss}$è¶Šå¤§ï¼Œäº®ç‚¹å°±è¶Šå°ã€‚$m_{spscular}$æ˜¯æè´¨çš„é«˜å…‰åå°„é¢œè‰²ï¼Œå®ƒç”¨äºæ§åˆ¶è¯¥æè´¨å¯¹äºé«˜å…‰åå°„çš„å¼ºåº¦å’Œé¢œè‰²ã€‚$c_{light}åˆ™æ˜¯å…‰æºçš„é¢œè‰²å’Œå¼ºåº¦ã€‚$ é€åƒç´ è¿˜æ˜¯é€é¡¶ç‚¹æ€»ç»“å•å¼ çº¹ç†å®è·µçº¹ç†çš„å±æ€§å‡¹å‡¸æ˜ å°„é«˜åº¦çº¹ç†æ³•çº¿çº¹ç†å®è·µæ³•çº¿çº¹ç†ç±»å‹æ¸å˜çº¹ç†é®ç½©çº¹ç†å®è·µå…¶ä»–é®ç½©çº¹ç†]]></content>
      <categories>
        <category>Unity Shader</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity Shaderç¬¬ä¸€éƒ¨åˆ†]]></title>
    <url>%2F2018%2F10%2F20%2FUnity-Shader-IntroductionToTopic%2F</url>
    <content type="text"><![CDATA[åƒç´ å…‰ Pixel LightUnityä¸­å°†å¹³è¡Œå…‰ç§°ä½œä¸ºåƒç´ å…‰ï¼Œç¬¬ä¸€ä¸ªåƒç´ å…‰æ˜¯åŸºç¡€å¹³è¡Œå…‰ï¼Œä»¥LightMode=ForwardBaseæ ‡ç­¾ä¿®é¥°ï¼Œæ¯å¤šä¸€ä¸ªåƒç´ å…‰éƒ½ä»¥LightMode=ForwardAddæ ‡ç­¾ä¿®é¥°ã€‚å¹¶ä¸æ˜¯æ‰€æœ‰çš„å…‰æºåœ¨è¿è¡Œæ—¶éƒ½ä¼šåå°„åˆ°ç‰©ä½“ä¸Šï¼Œè€Œæ˜¯æ ¹æ®Projectçš„Qualityä¸­è®¾ç½®çš„åƒç´ å…‰æ•°é‡æ¥æ¸²æŸ“çš„ã€‚é»˜è®¤çš„åƒç´ å…‰çš„æ•°é‡åº”è¯¥æ˜¯2ï¼Œæˆ‘ä»¬æœ‰æ›´å¤šçš„å¹³è¡Œå…‰ç…§åœ¨ç‰©ä½“ä¸Šï¼Œå°±éœ€è¦åœ¨Edit-&gt;Project Setting-&gt;Qualityä¸­å»è°ƒèŠ‚åƒç´ å…‰çš„æ•°é‡Pixel Light Countå½“åœºæ™¯ä¸­çš„å®é™…åƒç´ å…‰æ•°é‡è¶…è¿‡è¿™ä¸ªè®¾å®šå€¼çš„æ—¶å€™ï¼ŒUnityåªä¼šæ¸²æŸ“æœ€é‡è¦çš„å…‰ã€‚ å…³äºåƒç´ å…‰çš„å åŠ åŸç†ç‰‡æ®µç€è‰²å™¨æ˜¯è¦å°†meshç»„ä»¶ä¼ é€’çš„ä¿¡æ¯æœ€ç»ˆè®¡ç®—ä¸ºé¢œè‰²(æˆ–è€…æ·±åº¦)å­˜å‚¨åœ¨å¸§ç¼“å­˜(Frame Buffer)ä¸­ã€‚æ¯ä¸ªPassä¹‹é—´è¾“å‡ºçš„é¢œè‰²é€šè¿‡ä¸€å®šçš„å…¬å¼è¿›è¡Œæ··åˆã€‚åœ¨è¿™é‡Œæˆ‘ä»¬ç®€å•ä½¿ç”¨ä¸€æ¯”ä¸€çš„æ¨¡å¼è¿›è¡Œé¢œè‰²æ··åˆï¼Œå³æ··åˆæŒ‡ä»¤ä¸ºï¼š Blend One One ç¬¬äºŒä¸ªPassçš„ä»£ç åŒæ ·çš„ä¹Ÿç›´æ¥å¤åˆ¶ç¬¬ä¸€ä¸ªPasså³å¯ï¼Œç›¸åº”çš„å°†Tagsæ ‡ç­¾ä¸­LightMode=ForwardBaseä¿®æ”¹ä¸ºLightMode=ForwordAddã€‚ 12345Shader &quot;Custom/Multi-Light Diffuse&quot; &#123; Properties &#123; // ææ–™é¢œè‰²é»˜è®¤ä¸ºé»‘è‰²ï¼Œ &#125;&#125; æ¸²æŸ“æµæ°´çº¿æ¸²æŸ“æµæ°´çº¿çš„å·¥ä½œä»»åŠ¡åœ¨äºç”±ä¸€ä¸ªä¸‰ç»´åœºæ™¯è§¦å‘ã€ç”Ÿæˆï¼ˆæˆ–è€…è¯´æ¸²æŸ“ï¼‰ä¸€å¼ äºŒç»´å›¾åƒã€‚æ¢å¥è¯è¯´ï¼Œè®¡ç®—æœºéœ€è¦ä»ä¸€ç³»åˆ—çš„é¡¶ç‚¹æ•°æ®ã€çº¹ç†ç­‰ä¿¡æ¯å‡ºå‘ï¼ŒæŠŠè¿™äº›ä¿¡æ¯æœ€ç»ˆè½¬æ¢æˆä¸€å¼ äººçœ¼å¯ä»¥çœ‹åˆ°çš„å›¾åƒã€‚è€Œè¿™ä¸ªå·¥ä½œé€šå¸¸æ˜¯ç”±CPUå’ŒGPUå…±åŒå®Œæˆçš„ã€‚ã€ŠRender-Time Rendering, Third Editionã€‹å°†ä¸€ä¸ªæ¸²æŸ“æµç¨‹åˆ†æˆ3ä¸ªé˜¶æ®µï¼šåº”ç”¨é˜¶æ®µ(Application Stage)ã€å‡ ä½•é˜¶æ®µ(Geometry Stage)ã€å…‰æ …åŒ–é˜¶æ®µ(Rasterizer Stage)ã€‚ åº”ç”¨é˜¶æ®µï¼ˆCPUå¤„ç†ï¼‰è¿™ä¸€é˜¶æ®µæ˜¯ç”±å¼€å‘è€…ä¸»å¯¼çš„ï¼Œåœ¨è¿™ä¸€é˜¶æ®µä¸­å¼€å‘éƒ½æœ‰3ä¸ªä¸»è¦çš„ä»»åŠ¡ï¼šé¦–å…ˆï¼Œéœ€è¦å‡†å¤‡å¥½åœºæ™¯æ•°æ®ï¼ˆæ‘„åƒæœºä½ç½®ï¼Œè§†é”¥ä½“ï¼Œæ¨¡å‹å’Œå…‰æºç­‰ï¼‰æ¥ç€ï¼Œè¿˜éœ€è¦åšç²—ç²’åº¦çš„å‰”é™¤å·¥ä½œæœ€åï¼Œéœ€è¦è®¾ç½®å¥½æ¯ä¸ªæ¨¡å‹çš„æ¸²æŸ“çŠ¶æ€ï¼ˆä½¿ç”¨çš„æè´¨ï¼Œä½¿ç”¨çš„çº¹ç†ï¼Œä½¿ç”¨çš„Shaderç­‰ï¼‰è¿™ä¸€é˜¶æ®µæœ€é‡è¦çš„è¾“å‡ºæ˜¯æ¸²æŸ“æ‰€éœ€çš„å‡ ä½•ä¿¡æ¯ï¼Œå³æ¸²æŸ“å›¾å…ƒï¼Œæ¸²æŸ“å›¾å…ƒå¯ä»¥æ˜¯ç‚¹ï¼Œçº¿ï¼Œä¸‰è§’é¢ç­‰ã€‚ å‡ ä½•é˜¶æ®µï¼ˆGPUå¤„ç†ï¼‰å‡ ä½•é˜¶æ®µä¸»è¦ç”¨äºå¤„ç†æ‰€æœ‰å’Œæˆ‘ä»¬ç»˜åˆ¶çš„å‡ ä½•ç›¸å…³çš„äº‹æƒ…ã€‚å‡ ä½•é˜¶æ®µè´Ÿè´£å’Œæ¯ä¸ªæ¸²æŸ“å›¾å…ƒæ‰“äº¤é“ï¼Œè¿›è¡Œé€é¡¶ç‚¹ï¼Œé€å¤šè¾¹å½¢çš„æ“ä½œã€‚è¿™ä¸ªé˜¶æ®µå¯ä»¥è¿›ä¸€æ­¥åˆ†æˆæ›´å°çš„æµæ°´çº¿é˜¶æ®µã€‚å‡ ä½•é˜¶æ®µçš„ä¸€ä¸ªé‡è¦ä»»åŠ¡å°±æ˜¯æŠŠé¡¶ç‚¹åæ ‡å˜æ¢åˆ°å±å¹•ç©ºé—´ä¸­ï¼Œå†äº¤ç»™å…‰æ …å™¨è¿›è¡Œå¤„ç†ã€‚æ€»ç»“ï¼šè¾“å…¥çš„æ¸²æŸ“å›¾å…ƒ-&gt;å±å¹•ç©ºé—´çš„äºŒç»´é¡¶ç‚¹åæ ‡ã€æ¯ä¸ªé¡¶ç‚¹å¯¹åº”æ·±åº¦ã€ç€è‰²ç­‰ä¿¡æ¯ å…‰æ …åŒ–é˜¶æ®µï¼ˆGPUå¤„ç†ï¼‰å°†ä¼šä½¿ç”¨ä¸Šä¸€ä¸ªé˜¶æ®µä¼ é€’çš„æ•°æ®æ¥äº§ç”Ÿå±å¹•ä¸Šçš„åƒç´ ï¼Œå¹¶æ¸²æŸ“å‡ºæœ€ç»ˆçš„å›¾åƒã€‚ä¸»è¦ä»»åŠ¡æ˜¯å†³å®šæ¯ä¸ªæ¸²æŸ“å›¾å…ƒä¸­çš„é‚£äº›åƒç´ åº”è¯¥è¢«ç»˜åˆ¶åœ¨å±å¹•ä¸Šã€‚é¡¶ç‚¹ç€è‰²å™¨ï¼ˆVertex Shaderï¼‰æ˜¯å®Œå…¨å¯ç¼–ç¨‹çš„ï¼Œå®ƒé€šå¸¸ç”¨äºå®ç°é¡¶ç‚¹çš„ç©ºé—´å˜æ¢ã€é¡¶ç‚¹ç€è‰²ç­‰åŠŸèƒ½ã€‚æ›²é¢ç»†åˆ†ç€è‰²å™¨ï¼ˆTessellation Shaderï¼‰æ˜¯ä¸€ä¸ªå¯é€‰çš„ç€è‰²å™¨ï¼Œå‡ ä½•ç€è‰²å™¨ï¼ˆGeometry Shaderï¼‰åŒæ ·æ˜¯ä¸€ä¸ªå¯é€‰çš„ç€è‰²å™¨ï¼Œå®ƒå¯ä»¥è¢«ç”¨äºæ‰§è¡Œé€å›¾å…ƒï¼ˆPer-Pimitiveï¼‰çš„ç€è‰²æ“ä½œï¼Œæˆ–è€…è¢«ç”¨äºäº§ç”Ÿæ›´å¤šçš„å›¾å…ƒã€‚ä¸‹ä¸€ä¸ªæµæ°´çº¿æ˜¯è£å‰ªï¼ˆClippingï¼‰ï¼Œè¿™ä¸€é˜¶æ®µçš„ç›®çš„æ˜¯å°†é‚£äº›ä¸åœ¨æ‘„åƒæœºè§†é‡å†…çš„é¡¶ç‚¹è£å‰ªæ‰ï¼Œå¹¶å‰”é™¤æŸäº›ä¸‰è§’å›¾å…ƒçš„é¢ç‰‡ã€‚è¿™ä¸ªé˜¶æ®µæ˜¯å¯é…ç½®çš„ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„è£å‰ªå¹³é¢æ¥é…ç½®è£å‰ªåŒºåŸŸï¼Œä¹Ÿå¯ä»¥é€šè¿‡æŒ‡ä»¤æ§åˆ¶è£å‰ªä¸‰è§’å›¾å…ƒçš„æ­£é¢è¿˜æ˜¯èƒŒé¢ã€‚å‡ ä½•æ¦‚å¿µé˜¶æ®µçš„æœ€åä¸€ä¸ªæµæ°´çº¿é˜¶æ®µæ˜¯å±å¹•æ˜ å°„ï¼ˆScreen Mappingï¼‰ã€‚è¿™ä¸€é˜¶æ®µæ˜¯ä¸å¯é…ç½®å’Œç¼–ç¨‹çš„ï¼Œå®ƒè´Ÿè´£æŠŠæ¯ä¸ªå›¾å…ƒçš„åæ ‡è½¬æ¢åˆ°å±å¹•åæ ‡ç³»ä¸­ã€‚å…‰æ …åŒ–æ¦‚å¿µé˜¶æ®µä¸­çš„ä¸‰è§’å½¢è®¾ç½®ï¼ˆTriangle Setupï¼‰å’Œä¸‰è§’å½¢éå†ï¼ˆTriangle Traversalï¼‰é˜¶æ®µä¹Ÿéƒ½æ˜¯å›ºå®šå‡½æ•°ï¼ˆFixed-Functionï¼‰çš„é˜¶æ®µã€‚æ¥ä¸‹æ¥çš„ç‰‡å…ƒç€è‰²å™¨ï¼ˆFragment Shaderï¼‰ï¼Œåˆ™æ˜¯å®Œå…¨å¯ç¼–ç¨‹çš„ï¼Œå®ƒç”¨äºå®ç°é€ç‰‡å…ƒï¼ˆPer-Fragmentï¼‰çš„ç€è‰²æ“ä½œã€‚æœ€åï¼Œé€ç‰‡å…ƒæ“ä½œï¼ˆPer-Fragment Operationsï¼‰é˜¶æ®µè´Ÿè´£æ‰§è¡Œå¾ˆå¤šé‡è¦çš„æ“ä½œï¼Œä¾‹å¦‚ä¿®æ”¹é¢œè‰²ã€æ·±åº¦ç¼“å†²ã€è¿›è¡Œæ··åˆç­‰ï¼Œå®ƒä¸æ˜¯å¯ç¼–ç¨‹ï¼Œä½†å…·æœ‰å¾ˆé«˜çš„å¯é…ç½®å‹ã€‚Unityå†…ç½®çš„DiffuseShader,ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªMaterialå‡ºæ¥æ—¶é»˜è®¤çš„Shaderä¹Ÿæ˜¯å¤šå…‰æºçš„ï¼Œæ‰€ä»¥è¿™ç¯‡æ–‡ç« å®Œæˆçš„Shaderä¸é»˜è®¤çš„diffuse shaderåŸºæœ¬æ•ˆæœä¸€è‡´ã€‚ CPUä¸GPUä¹‹é—´çš„é€šä¿¡æ¸²æŸ“æµæ°´çº¿çš„èµ·ç‚¹æ˜¯CPUï¼Œå³åº”ç”¨é˜¶æ®µã€‚åº”ç”¨é˜¶æ®µå¯ä»¥åˆ†ä¸ºä¸‹é¢3ä¸ªé˜¶æ®µï¼š æŠŠæ•°æ®åŠ è½½åˆ°æ˜¾å­˜ä¸­ è®¾ç½®æ¸²æŸ“çŠ¶æ€ è°ƒç”¨Draw Call æ•°æ®åŠ è½½åˆ°æ˜¾å­˜ä¸­åŸºæœ¬æ­¥éª¤å°±æ˜¯çº¹ç†ã€ç½‘æ ¼ç­‰æ•°æ®ä»ç¡¬ç›˜åŠ è½½åˆ°ç³»ç»Ÿå†…å­˜åœ¨åŠ è½½åˆ°æ˜¾å­˜ä¸­ã€‚æ•°æ®è®°è½½åˆ°æ˜¾å­˜åç³»ç»Ÿå†…å­˜ä¸­çš„æ•°æ®å°±å¯ä»¥è¢«ç§»é™¤äº†ï¼Œä½†æ˜¯å¯¹äºä¸€äº›æ•°æ®æ¥è¯´CPUéœ€è¦è®¿é—®ä»–ä»¬ï¼Œä¾‹å¦‚ç”¨äºç¢°æ’æ£€æµ‹ç”¨çš„ç½‘æ ¼æ•°æ®ï¼Œè¿™äº›æ•°æ®åˆ™ä¼šè¢«ä¿ç•™ã€‚ è®¾ç½®æ¸²æŸ“çŠ¶æ€æ¸²æŸ“çŠ¶æ€æŒ‡çš„æ˜¯åœºæ™¯ä¸­çš„ç½‘æ ¼æ˜¯å¦‚ä½•è¢«æ¸²æŸ“çš„ï¼Œä¾‹å¦‚ä½¿ç”¨å“ªä¸ªVertex Shaderæˆ–è€…å“ªä¸ªFragment Shaderã€å…‰æºå±æ€§ã€æè´¨ç­‰ã€‚ è°ƒç”¨Draw CallDraw CallæŒ‡çš„æ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œå‘èµ·æ–¹ä¸ºCPUï¼Œæ¥æ”¶æ–¹ä¸ºGPUã€‚å½“ç»™å®šäº†ä¸€ä¸ªDraw Callæ—¶ï¼ŒGPUä¼šæ ¹æ®æ¸²æŸ“çŠ¶æ€ï¼ˆä¾‹å¦‚æè´¨ã€çº¹ç†ã€ç€è‰²å™¨ç­‰ï¼‰å’Œæ‰€æœ‰è¾“å…¥çš„é¡¶ç‚¹æ•°æ® ä»åº”ç”¨ç¨‹åºé˜¶æ®µæ¨¡å‹æ•°æ®ç»™é¡¶ç‚¹ç€è‰²å™¨æ—¶æ”¯æŒçš„è¯­ä¹‰ è¯­ä¹‰ æè¿° POSITION æ¨¡å‹ç©ºé—´çš„é¡¶ç‚¹ä½ç½®ï¼Œé€šå¸¸æ˜¯float4ç±»å‹ NORMAL é¡¶ç‚¹æ³•çº¿ï¼Œé€šå¸¸æ˜¯float3ç±»å‹ TANGENT é¡¶ç‚¹åˆ‡çº¿ï¼Œé€šå¸¸æ˜¯float4ç±»å‹ TEXCOORDn,å¦‚TEXCOORD0ã€TEXCOORD1 è¯¥é¡¶ç‚¹çš„çº¹ç†åæ ‡ï¼ŒTEXCOORD0è¡¨ç¤ºç¬¬ä¸€ç»„çº¹ç†åæ ‡ï¼Œä¾æ¬¡ç±»æ¨ï¼Œé€šå¸¸æ˜¯float2æˆ–float4ç±»å‹ å…¶ä¸­TEXCOORDnä¸­çš„æ•°ç›®æ˜¯å’ŒShader Modelæœ‰å…³çš„ï¼Œä¾‹å¦‚ä¸€èˆ¬åœ¨Shader Model 2(å³Unityé»˜è®¤ç¼–è¯‘åˆ°çš„Shader Modelç‰ˆæœ¬)å’ŒShader Model 3ä¸­ï¼Œnç­‰äº8ï¼Œè€Œåœ¨Shader Model 4 å’ŒShader Model 5ä¸­ï¼Œnç­‰äº16.é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ¨¡å‹çš„çº¹ç†åæ ‡æ•°ç»„ä¸€èˆ¬ä¸è¶…è¿‡2ï¼Œå³æˆ‘ä»¬å¾€å¾€åªåªç”¨TEXCOORD0å’ŒTEXCOORD1ã€‚åœ¨Unityå†…ç½®çš„æ•°æ®ç»“æ„ä½“appdata_fullä¸­ï¼Œå®ƒæœ€å¤šä½¿ç”¨äº†6ä¸ªåæ ‡çº¹ç†ã€‚ ä»é¡¶ç‚¹ç€è‰²å™¨ä¼ é€’æ•°æ®ç»™ç‰‡å…ƒç€è‰²å™¨æ—¶çš„è¯­ä¹‰ è¯­ä¹‰ æè¿° SV_POSITION è£å‰ªç©ºé—´ä¸­çš„é¡¶ç‚¹åæ ‡ï¼Œç»“æ„ä½“ä¸­å¿…é¡»åŒ…å«ä¸€ä¸ªç”¨è¯¥è¯­ä¹‰ä¿®é¥°çš„å˜é‡ã€‚ç­‰åŒäºDirect9ä¸­çš„POSITIONï¼Œä½†æœ€å¥½ä½¿ç”¨SV_POSITION COLOR0 é€šå¸¸ç”¨äºè¾“å‡ºç¬¬ä¸€ç»„é¡¶ç‚¹é¢œè‰²ï¼Œä½†ä¸æ˜¯å¿…é¡»çš„ COLOR1 é€šå¸¸ç”¨äºè¾“å‡ºç¬¬äºŒç»„é¡¶ç‚¹é¢œè‰²ï¼Œä½†ä¸æ˜¯å¿…é¡»çš„ TEXCOORD0~TEXCOORD7 é€šå¸¸ç”¨äºè¾“å‡ºçº¹ç†åæ ‡ï¼Œä½†ä¸æ˜¯å¿…é¡»çš„ ä¸Šé¢çš„è¯­ä¹‰ä¸­ï¼Œé™¤äº†SV_POSITIONæ˜¯æœ‰ç‰¹åˆ«å«æ„å¤–ï¼Œå…¶ä»–è¯­ä¹‰å¯¹å˜é‡çš„å«ä¹‰æ²¡æœ‰æ˜ç¡®è¦æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å­˜å‚¨ä»»æ„å€¼åˆ°è¿™äº›æè¿°å˜é‡ä¸­ã€‚ ç‰‡å…ƒç€è‰²å™¨è¾“å‡ºæ—¶Unityæ”¯æŒçš„å¸¸ç”¨è¯­ä¹‰ è¯­ä¹‰ æè¿° ç‚¹å’ŒçŸ¢é‡çš„åŒºåˆ«ç‚¹æ˜¯ä¸€ä¸ªæ²¡æœ‰å¤§å°ä¹‹åˆ†çš„ç©ºé—´ä¸­çš„ä½ç½®ï¼Œè€ŒçŸ¢é‡æ˜¯ä¸€ä¸ªæœ‰æ¨¡å’Œæ–¹å‘ä½†æ˜¯æ²¡æœ‰ä½ç½®çš„é‡ã€‚ é½æ¬¡åæ ‡å¯¹äºä¸€ä¸ªç‚¹ï¼Œä»ä¸‰ç»´åæ ‡è½¬æ¢æˆé½æ¬¡åæ ‡æ˜¯æŠŠwåˆ†é‡è®¾ä¸º1ï¼Œè€Œå¯¹äºæ–¹å‘çŸ¢é‡æ¥è¯´ï¼Œéœ€è¦æŠŠwåˆ†é‡è®¾ä¸º0ã€‚ å¹³ç§»çŸ©é˜µæˆ‘ä»¬å¯ä»¥ä½¿ç”¨çŸ©é˜µä¹˜æ³•æ¥è¡¨ç¤ºå¯¹ä¸€ä¸ªç‚¹è¿›è¡Œå¹³ç§»å˜æ¢ï¼š $\begin{bmatrix}{1}&amp;{0}&amp;{0}&amp;{t_{x}}\\{0}&amp;{1}&amp;{0}&amp;{t_{y}}\\{0}&amp;{0}&amp;{1}&amp;{t_{z}}\\{0}&amp;{0}&amp;{0}&amp;{1}\\\end{bmatrix}\begin{bmatrix}{x}\\{y}\\{z}\\{1}\\\end{bmatrix} =\begin{bmatrix}{x+t_{x}}\\{y+t_{y}}\\{z+t_{z}}\\{1}\\\end{bmatrix}$ ä»ç»“æœæ¥çœ‹æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çœ‹å‡ºä¸ºä»€ä¹ˆè¿™ä¸ªçŸ©é˜µæœ‰å¹³ç§»çš„æ•ˆæœï¼šç‚¹çš„xã€yã€zåˆ†é‡åˆ†åˆ«å¢åŠ äº†ä¸€ä¸ªä½ç½®åç§»ã€‚åœ¨3Dä¸­çš„å¯è§†åŒ–æ•ˆæœæ˜¯ï¼ŒæŠŠç‚¹$(x,y,z)$åœ¨ç©ºé—´ä¸­å¹³ç§»äº†$(t_{x},t_{y},t_{z})$ã€‚å¦‚æœæˆ‘ä»¬å¯¹ä¸€ä¸ªæ–¹å‘çŸ¢é‡è¿›è¡Œå¹³ç§»å˜æ¢ï¼Œç»“æœå¦‚ä¸‹ï¼š $\begin{bmatrix}{1}&amp;{0}&amp;{0}&amp;{t_{x}}\\{0}&amp;{1}&amp;{0}&amp;{t_{y}}\\{0}&amp;{0}&amp;{1}&amp;{t_{z}}\\{0}&amp;{0}&amp;{0}&amp;{1}\\\end{bmatrix}\begin{bmatrix}{x}\\{y}\\{z}\\{0}\\\end{bmatrix} =\begin{bmatrix}{x}\\{y}\\{z}\\{0}\\\end{bmatrix}$å¯ä»¥å‘ç°ï¼Œå¹³ç§»å˜æ¢ä¸ä¼šå¯¹æ–¹å‘çŸ¢é‡äº§ç”Ÿä»»ä½•å½±å“ã€‚å› ä¸ºçŸ¢é‡æ²¡æœ‰ä½ç½®å±æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå¯ä»¥ä½äºç©ºé—´ä¸­çš„ä»»æ„ä¸€ç‚¹ï¼Œå› æ­¤å¯¹ä½ç½®çš„æ”¹å˜ä¸åº”è¯¥å¯¹å››ç»´çŸ¢é‡äº§ç”Ÿå½±å“ã€‚ ç¼©æ”¾çŸ©é˜µæˆ‘ä»¬å¯ä»¥å¯¹ä¸€ä¸ªæ¨¡å‹æ²¿ç©ºé—´çš„xè½´ã€yè½´å’Œzè½´è¿›è¡Œç¼©æ”¾ã€‚ $\begin{bmatrix}{k_{x}}&amp;{0}&amp;{0}&amp;{0}\\{0}&amp;{k_{y}}&amp;{0}&amp;{0}\\{0}&amp;{0}&amp;{k_{z}}&amp;{0}\\{0}&amp;{0}&amp;{0}&amp;{1}\\\end{bmatrix}\begin{bmatrix}{x}\\{y}\\{z}\\{1}\\\end{bmatrix} =\begin{bmatrix}{k_{x}x}\\{k_{y}y}\\{k_{z}z}\\{1}\\\end{bmatrix}$ å¦‚æœç¼©æ”¾ç³»æ•°$k_{x}=k_{y}=k_{z}$ï¼Œæˆ‘ä»¬æŠŠè¿™æ ·çš„ç¼©æ”¾ç§°ä¸ºç»Ÿä¸€ç¼©æ”¾ï¼ˆuniform scaleï¼‰ï¼Œå¦åˆ™ç§°ä¸ºéåŒä¸€ç¼©æ”¾ï¼ˆnonuniform scaleï¼‰ã€‚ä»å¤–è§‚çœ‹ï¼Œç»Ÿä¸€ç¼©æ”¾æ˜¯æ‰©å¤§æ•´ä¸ªæ¨¡å‹ï¼Œè€ŒéåŒä¸€ç¼©æ”¾ä¼šæ‹‰ä¼¸æˆ–æŒ¤å‹æ¨¡å‹ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œç»Ÿä¸€ç¼©æ”¾ä¸ä¼šæ”¹å˜è§’åº¦å’Œæ¯”ä¾‹ä¿¡æ¯ã€‚ å¤åˆå˜æ¢åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çº¦å®šå˜æ¢çš„é¡ºåºå°±æ˜¯å…ˆç¼©æ”¾ï¼Œå†æ—‹è½¬ï¼Œæœ€åå¹³ç§»ã€‚å˜æ¢çŸ©é˜µå¦‚ä¸‹ï¼š(æ³¨æ„ï¼ŒçŸ©é˜µæ˜¯ä»å³å¾€å·¦ç®—çš„)$M_{translation}M_{rotation}M_{scale} =\begin{bmatrix}{1}&amp;{0}&amp;{0}&amp;{t_{x}}\\{0}&amp;{1}&amp;{0}&amp;{t_{y}}\\{0}&amp;{0}&amp;{1}&amp;{t_{z}}\\{0}&amp;{0}&amp;{0}&amp;{1}\\\end{bmatrix}$å½“æˆ‘ä»¬ç›´æ¥ç»™å‡º$(\theta_{x}, \theta_{y}, \theta_{z})$è¿™æ ·çš„æ—‹è½¬è§’åº¦æ—¶ï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ªæ—‹è½¬é¡ºåºã€‚åœ¨Unityä¸­ï¼Œè¿™ä¸ªæ—‹è½¬é¡ºåºæ˜¯zxyã€‚ é¡¶ç‚¹çš„åæ ‡ç©ºé—´å˜åŒ–åœ¨æ¸²æŸ“æµæ°´çº¿ä¸­ï¼Œä¸€ä¸ªé¡¶ç‚¹è¦ç»è¿‡å¤šä¸ªåæ ‡ç©ºé—´çš„å˜æ¢æ‰èƒ½æœ€ç»ˆè¢«ç”»åœ¨å±å¹•ä¸Šã€‚ä¸€ä¸ªé¡¶ç‚¹æœ€å¼€å§‹æ˜¯åœ¨æ¨¡å‹ç©ºé—´ä¸­å®šä¹‰çš„ï¼Œæœ€åå®ƒå°†ä¼šå˜æ¢åˆ°å±å¹•ç©ºé—´ä¸­ï¼Œå¾—åˆ°çœŸæ­£çš„å±å¹•åƒç´ åæ ‡ã€‚ æ¨¡å‹ç©ºé—´æ¨¡å‹ç©ºé—´ï¼ˆmodel spaceï¼‰ï¼Œæ˜¯å’ŒæŸä¸ªæ¨¡å‹æˆ–è€…è¯´æ˜¯å¯¹è±¡æœ‰å…³çš„ã€‚æœ‰æ—¶æ¨¡å‹ç©ºé—´ä¹Ÿè¢«ç§°ä¸ºå¯¹è±¡ç©ºé—´ï¼ˆobject spaceï¼‰æˆ–å±€éƒ¨ç©ºé—´ï¼ˆlocal spaceï¼‰ã€‚æ¯ä¸ªæ¨¡å‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„åæ ‡ç©ºé—´ï¼Œå½“å®ƒç§»åŠ¨æˆ–æ—‹è½¬çš„æ—¶å€™ï¼Œæ¨¡å‹ç©ºé—´ä¹Ÿä¼šè·Ÿç€å®ƒç§»åŠ¨å’Œæ—‹è½¬ã€‚é¡¶ç‚¹å˜æ¢çš„ç¬¬ä¸€æ­¥ï¼Œå°±æ˜¯å°†é¡¶ç‚¹åæ ‡ä»æ¨¡å‹ç©ºé—´å˜æ¢åˆ°ä¸–ç•Œç©ºé—´ä¸­ã€‚è¿™ä¸ªå˜æ¢é€šå¸¸å«åšæ¨¡å‹å˜æ¢ï¼ˆmodel transformï¼‰ã€‚ ä¸–ç•Œç©ºé—´é¡¶ç‚¹å˜æ¢çš„ç¬¬ä¸€æ­¥ï¼Œå°±æ˜¯å°†é¡¶ç‚¹åæ ‡ä»æ¨¡å‹ç©ºé—´å˜æ¢åˆ°ä¸–ç•Œç©ºé—´ä¸­ã€‚è¿™ä¸ªå˜æ¢é€šå¸¸å«åšæ¨¡å‹å˜æ¢ï¼ˆmodel transformï¼‰ã€‚å˜æ¢çŸ©é˜µå¦‚ä¸‹ï¼š$M_{model} = \begin{bmatrix}{1}&amp;{0}&amp;{0}&amp;{t_{x}}\\{0}&amp;{1}&amp;{0}&amp;{t_{y}}\\{0}&amp;{0}&amp;{1}&amp;{t_{z}}\\{0}&amp;{0}&amp;{0}&amp;{1}\\\end{bmatrix}\begin{bmatrix}{cos\theta}&amp;{0}&amp;{sin\theta}&amp;{0}\\{0}&amp;{1}&amp;{0}&amp;{0}\\{-sin\theta}&amp;{0}&amp;{cos\theta}&amp;{0}\\{0}&amp;{0}&amp;{0}&amp;{1}\\\end{bmatrix}\begin{bmatrix}{k_{x}}&amp;{0}&amp;{0}&amp;{0}\\{0}&amp;{k_{y}}&amp;{0}&amp;{0}\\{0}&amp;{0}&amp;{k_{z}}&amp;{0}\\{0}&amp;{0}&amp;{0}&amp;{1}\\\end{bmatrix} =\begin{bmatrix}{k_{x}cos\theta}&amp;{0}&amp;{k_{z}sin\theta}&amp;{t_{x}}\\{0}&amp;{k_{y}}&amp;{0}&amp;{t_{y}}\\{-k_{x}sin\theta}&amp;{0}&amp;{k_{z}cos\theta}&amp;{-t_{z}}\\{0}&amp;{0}&amp;{0}&amp;{1}\\\end{bmatrix}$æ³¨æ„ï¼šä¸Šè¿°å˜æ¢é¡ºåºæ˜¯ä¸èƒ½äº’æ¢çš„ï¼Œå³å…ˆè¿›è¡Œç¼©æ”¾ï¼Œåœ¨è¿›è¡Œæ—‹è½¬ï¼Œæœ€åæ˜¯å¹³ç§»ã€‚å› ä¸ºæ¯ä¸ªTransformçš„å¹³ç§»æ—‹è½¬ç¼©æ”¾éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥ä»–ä»¬çš„çŸ©é˜µä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚ è§‚å¯Ÿç©ºé—´è§‚å¯Ÿç©ºé—´ï¼ˆview spaceï¼‰ä¹Ÿè¢«ç§°ä¸ºæ‘„åƒæœºç©ºé—´ï¼ˆcamera spaceï¼‰ã€‚é¡¶ç‚¹å˜æ¢çš„ç¬¬äºŒæ­¥ï¼Œå°±æ˜¯å°†é¡¶ç‚¹åæ ‡ä»ä¸–ç•Œç©ºé—´å˜æ¢åˆ°è§‚å¯Ÿç©ºé—´ä¸­ã€‚è¿™ä¸ªå˜æ¢å«åšè§‚å¯Ÿå˜æ¢ï¼ˆview transformï¼‰ã€‚ è£å‰ªç©ºé—´è£å‰ªç©ºé—´ï¼ˆclip spaceï¼Œä¹Ÿç§°é½æ¬¡è£å‰ªç©ºé—´ï¼‰ï¼Œè¿™ä¸ªç”¨äºå˜æ¢çš„çŸ©é˜µå«åšè£å‰ªçŸ©é˜µï¼ˆclip matrixï¼‰ï¼Œä¹Ÿç§°ä¸ºæŠ•å½±çŸ©é˜µï¼ˆprojection matrixï¼‰ã€‚è£å‰ªç©ºé—´çš„ç›®æ ‡æ˜¯èƒ½å¤Ÿæ–¹ä¾¿åœ°å¯¹æ¸²æŸ“å›¾å…ƒè¿›è¡Œè£å‰ªï¼šå®Œå…¨ä½äºè¿™å—ç©ºé—´å†…éƒ¨çš„å›¾å…ƒå°†ä¼šè¢«ä¿ç•™ï¼Œå®Œå…¨ä½äºè¿™å—ç©ºé—´å¤–éƒ¨çš„å›¾å…ƒå°†ä¼šè¢«å‰”é™¤ï¼Œè€Œä¸è¿™å—ç©ºé—´è¾¹ç•Œç›¸äº¤çš„å›¾å…ƒå°±ä¼šè¢«è£å‰ªã€‚è¿™å—ç©ºé—´æ˜¯ç”±è§†é”¥ä½“æ¥å†³å®šçš„ã€‚è§†é”¥ä½“æŒ‡çš„æ˜¯ç©ºé—´ä¸­çš„ä¸€å—åŒºåŸŸï¼Œè¿™å—åŒºåŸŸå†³å®šäº†æ‘„åƒæœºå¯ä»¥çœ‹åˆ°çš„ç©ºé—´ã€‚è§†é”¥ä½“ç”±å…­ä¸ªå¹³é¢åŒ…å›´è€Œæˆï¼Œè¿™äº›å¹³é¢ä¹Ÿè¢«ç§°ä¸ºè£å‰ªå¹³é¢ï¼ˆclip planesï¼‰ã€‚è§†é”¥ä½“æœ‰ä¸¤ç§ç±»å‹ï¼Œä¸€ç§æ˜¯æ­£äº¤æŠ•å½±ï¼ˆorthographic projectionï¼‰ï¼Œä¸€ç§æ˜¯é€è§†æŠ•å½±ï¼ˆperspective projectionï¼‰ã€‚åœ¨è§†é”¥ä½“çš„6å—è£å‰ªå¹³é¢ä¸­ï¼Œæœ‰ä¸¤å—è£å‰ªå¹³é¢æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒä»¬åˆ†åˆ«è¢«ç§°ä¸ºè¿‘è£å‰ªå¹³é¢ï¼ˆnear clip planeï¼‰å’Œè¿œè£å‰ªå¹³é¢ï¼ˆfar clip planeï¼‰ã€‚å®ƒä»¬å†³å®šäº†æ‘„åƒæœºå¯ä»¥çœ‹åˆ°çš„æ·±åº¦èŒƒå›´ã€‚ é€è§†æŠ•å½±è§†é”¥ä½“çš„æ„ä¹‰åœ¨äºå®šäº†åœºæ™¯ä¸­çš„ä¸€å—ä¸‰ç»´ç©ºé—´ã€‚æ‰€æœ‰ä½äºè¿™å—ç©ºé—´å†…çš„ç‰©ä½“å°†ä¼šè¢«æ¸²æŸ“ï¼Œå¦åˆ™å°±ä¼šè¢«å‰”é™¤æˆ–è£å‰ªã€‚è¿™å—åŒºåŸŸæ˜¯ç”±6ä¸ªè£å‰ªå¹³é¢ç»„æˆï¼Œåœ¨Unityä¸­ï¼Œå®ƒä»¬ç”±Cameraç»„ä»¶ä¸­çš„å‚æ•°å’ŒGameè§†å›¾ä¸­æ¨ªçºµæ¯”å…±åŒå†³å®šCameraç»„ä»¶çš„Field of Viewï¼ˆç®€ç§°FOVï¼‰å±æ€§æ¥æ”¹å˜è§†é”¥ä½“ç«–ç›´æ–¹å‘çš„å¼ å¼€è§’åº¦ï¼Œè€ŒClipping Planesä¸­çš„Nearå’ŒFarå‚æ•°å¯ä»¥æ§åˆ¶è§†é”¥ä½“çš„è¿‘è£å‰ªé¢å’Œè¿œè£å‰ªé¢è·ç¦»ç›¸æœºçš„è¿œè¿‘ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚å‡ºè§†é”¥ä½“è¿‘è£å‰ªé¢å’Œè¿œè£å‰ªé¢çš„é«˜åº¦ $nearClipPlaneHeight = 2 \cdot Near \cdot tan {FOV \over 2}$ $farClipPlaneHeight = 2 \cdot Far \cdot tan {FOV \over 2}$ é€è§†æŠ•å½±çš„æ¨ªå‘ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡ç›¸æœºçš„æ¨ªçºµæ¯”å¾—åˆ°ã€‚åœ¨Unityä¸­ï¼Œä¸€ä¸ªæ‘„åƒæœºçš„æ¨ªçºµæ¯”ç”±Gameè§†å›¾çš„æ¨ªçºµæ¯”å’ŒViewport Rectä¸­çš„Wå’ŒHå±æ€§å…±åŒå†³å®šï¼ˆå®é™…ä¸Šï¼ŒUnityå…è®¸æˆ‘ä»¬åœ¨è„šæœ¬é‡Œé€šè¿‡Camera.aspectè¿›è¡Œæ›´æ”¹ï¼‰ã€‚å‡è®¾ï¼Œå½“å‰ç›¸æœºçš„æ¨ªçºµæ¯”ä¸ºAspectï¼Œåˆ™ï¼š $Aspect = {nearClipPlaneWidth \over nerClipPlaneHeight}$ $Aspect = {farClipPlaneWidth \over farClipPlaneHeight}$ ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å·²çŸ¥çš„Nearã€Farã€FOVå’ŒAspectçš„å€¼æ¥ç¡®å®šé€è§†æŠ•å½±çš„æŠ•å½±çŸ©é˜µã€‚å¦‚ä¸‹ï¼š $M_{frustum} = \begin{bmatrix}{cot{FOV \over 2} \over Aspect}&amp;{0}&amp;{0}&amp;{0}\\{0}&amp;{cot{FOV \over 2}}&amp;{0}&amp;{0}\\{0}&amp;{0}&amp;{-{Far+Near \over Far-Near}}&amp;{-{2 \cdot Far \cdot Near \over Far-Near}}\\{0}&amp;{0}&amp;{-1}&amp;{0}\\\end{bmatrix}$è¿™é‡Œé’ˆå¯¹çš„æ˜¯è§‚å¯Ÿç©ºé—´æ˜¯å³æ‰‹åæ ‡ç³»ï¼Œä½¿ç”¨åˆ—çŸ©é˜µåœ¨çŸ©é˜µå³ä¾§ç›¸ä¹˜çš„ï¼Œä¸”å˜æ¢åzåˆ†é‡èŒƒå›´åœ¨[-w,w]ä¹‹é—´çš„æƒ…å†µã€‚è€Œä¸€ä¸ªé¡¶ç‚¹å’Œä¸Šè¿°æŠ•å½±çŸ©é˜µç›¸ä¹˜åï¼Œå¯ä»¥ç”±è§‚å¯Ÿç©ºé—´å˜æ¢åˆ°è£å‰ªç©ºé—´ä¸­ï¼Œç»“æœå¦‚ä¸‹$P_{clip} = M_{frustum}P_{view} =\begin{bmatrix}{cot{FOV \over 2} \over Aspect}&amp;{0}&amp;{0}&amp;{0}\\{0}&amp;{cot{FOV \over 2}}&amp;{0}&amp;{0}\\{0}&amp;{0}&amp;{-{Far+Near \over Far-Near}}&amp;{-{2 \cdot Far \cdot Near \over Far-Near}}\\{0}&amp;{0}&amp;{-1}&amp;{0}\\\end{bmatrix}\begin{bmatrix}{x}\\{y}\\{z}\\{1}\\\end{bmatrix}=\begin{bmatrix}{x{cot{FOV \over 2} \over Aspect}}\\{y{cot{FOV \over 2}}}\\{-z{Far+Near \over Far-Near}-{2 \cdot Near \cdot Far \over Far-Near}}\\{-z}\\\end{bmatrix}$ä»è¿™ä¸ªç»“æœæ¥çœ‹ï¼Œè¿™ä¸ªæŠ•å½±çŸ©é˜µæœ¬è´¨å°±æ˜¯å¯¹xã€yå’Œzåˆ†é‡è¿›è¡Œäº†ä¸åŒç¨‹åº¦çš„ç¼©æ”¾ï¼ˆzåˆ†é‡è¿˜æœ‰ä¸€ä¸ªå¹³ç§»ï¼‰ï¼Œç¼©æ”¾çš„ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿è£å‰ªã€‚æ­¤æ—¶é¡¶ç‚¹çš„wåˆ†é‡ä¸å†æ˜¯1ï¼Œè€Œæ˜¯åŸå…ˆzåˆ†é‡çš„å–åç»“æœã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŒ‰å¦‚ä¸‹ä¸ç­‰å¼æ¥åˆ¤æ–­ä¸€ä¸ªå˜æ¢åçš„é¡¶ç‚¹æ˜¯å¦ä½äºè§†é”¥ä½“å†…ã€‚å¦‚æœä¸€ä¸ªé¡¶ç‚¹åœ¨è§†é”¥ä½“å†…ï¼Œé‚£ä¹ˆå®ƒå˜æ¢åçš„åæ ‡å¿…é¡»æ»¡è¶³ï¼š$-w \le x \le w$$-w \le y \le w$$-w \le z \le w$ä»»ä½•ä¸æ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„å›¾å…ƒéƒ½éœ€è¦è¢«å‰”é™¤æˆ–è€…è£å‰ªã€‚ä¸‹å›¾æ˜¾ç¤ºäº†ç»è¿‡ä¸Šè¿°æŠ•å½±çŸ©é˜µåï¼Œè§†é”¥ä½“çš„å˜åŒ–ã€‚ä»ä¸Šå›¾è¿˜å¯ä»¥æ³¨æ„åˆ°ï¼Œè£å‰ªçŸ©é˜µä¼šæ”¹å˜ç©ºé—´çš„æ—‹å‘è¡Œï¼›ç©ºé—´ä»å³æ‰‹åæ ‡ç³»å˜æ¢åˆ°äº†å·¦æ‰‹åæ ‡ç³»ã€‚è¿™æ„å‘³ç€ï¼Œç¦»æ‘„åƒæœºè¶Šè¿œï¼Œzå€¼å°†è¶Šå¤§ã€‚ æ­£äº¤æŠ•å½± æ­£äº¤æŠ•å½±çš„6ä¸ªè£å‰ªé¢å’Œé€è§†æŠ•å½±ç±»ä¼¼ï¼Œåœ¨Unityä¸­ï¼Œå®ƒä»¬ä¹Ÿæ˜¯ç”±Cameraç»„ä»¶ä¸­çš„å‚æ•°å’ŒGameè§†å›¾çš„æ¨ªçºµæ¯”å…±åŒå†³å®šã€‚æ­£äº¤æŠ•å½±çš„è§†é”¥ä½“æ˜¯ä¸€ä¸ªé•¿æ–¹ä½“ï¼Œå› æ­¤è®¡ç®—ä¸Šç›¸æ¯”é€è§†æŠ•å½±æ¥è¯´æ›´åŠ ç®€å•ã€‚ç”±å›¾å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Cameraç»„ä»¶çš„Sizeå±æ€§æ¥æ”¹å˜è§†é”¥ä½“ç«–ç›´æ–¹å‘ä¸Šé«˜åº¦çš„ä¸€èˆ¬ï¼Œè€ŒClipping Planesä¸­çš„Nearå’ŒFarå‚æ•°å¯ä»¥æ§åˆ¶è§†é”¥ä½“çš„è¿‘è£å‰ªé¢å’Œè¿œè£å‰ªé¢è·ç¦»ç›¸æœºçš„è¿œè¿‘ã€‚è¿™æ ·ï¼Œå¯ä»¥æ±‚å‡ºè§†é”¥ä½“è¿‘è£å‰ªé¢å’Œè¿œè£å‰ªé¢çš„é«˜åº¦ï¼Œä¹Ÿå°±æ˜¯ï¼š$newClipPlaneHeight=2 \cdot Size$$farClipPlaneHeight=nearClipPlaneHeight$ ç°åœ¨æˆ‘ä»¬è¿˜ç¼ºä¹æ¨ªå‘çš„ä¿¡æ¯ã€‚åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‘„åƒæœºçš„æ¨ªçºµæ¯”å¾—åˆ°ã€‚å‡è®¾ï¼Œå½“å‰æ‘„åƒæœºçš„æ¨ªçºµæ¯”ä¸ºAspectï¼Œé‚£ä¹ˆï¼š$nearClipPlaneWidth=Aspect \cdot nearClipPlaneHeight$$farClipPlaneWidth=nearClipPlaneWidth$ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å·²çŸ¥çš„Nearã€Farã€Sizeå’ŒAspectçš„å€¼æ¥ç¡®å®šæ­£äº¤æŠ•å½±çš„è£å‰ªçŸ©é˜µã€‚å¦‚ä¸‹ï¼š$M_{prtho} =\begin{bmatrix}{1 \over Aspect \cdot Size}&amp;{0}&amp;{0}&amp;{0}\\{0}&amp;{1 \over Size}&amp;{0}&amp;{0}\\{0}&amp;{0}&amp;{-{2 \over Far-Near}}&amp;{-{Far+Near} \over {Far-Near}}\\{0}&amp;{0}&amp;{0}&amp;{1}\\\end{bmatrix}$ å±å¹•ç©ºé—´ç»è¿‡æŠ•å½±çŸ©é˜µçš„å˜æ¢åï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œè£å‰ªæ“ä½œã€‚å½“å®Œæˆäº†æ‰€æœ‰çš„è£å‰ªå·¥ä½œåï¼Œå°±éœ€è¦è¿›è¡ŒçœŸæ­£çš„æŠ•å½±äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè§†é”¥ä½“æŠ•å½±åˆ°å±å¹•ç©ºé—´ï¼ˆscreen spaceï¼‰ä¸­ã€‚ç»è¿‡è¿™ä¸€æ­¥å˜æ¢ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°çœŸæ­£çš„åƒç´ ä½ç½®ï¼Œè€Œä¸æ˜¯è™šæ‹Ÿçš„ä¸‰ç»´åæ ‡ã€‚å±å¹•ç©ºé—´æ˜¯ä¸€ä¸ªäºŒç»´ç©ºé—´ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»æŠŠé¡¶ç‚¹ä»è£å‰ªç©ºé—´æŠ•å½±åˆ°å±å¹•ç©ºé—´ä¸­ï¼Œæ¥ç”Ÿæˆå¯¹åº”çš„2Dåæ ‡ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ç†è§£æˆæœ‰ä¸¤ä¸ªæ­¥éª¤ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œæ ‡å‡†é½æ¬¡é™¤æ³•ï¼ˆhomogeneous divisionï¼‰ï¼Œä¹Ÿè¢«ç§°ä¸ºé€è§†é™¤æ³•ï¼ˆperspective divisionï¼‰ã€‚è™½ç„¶è¿™ä¸ªæ­¥éª¤å¬èµ·æ¥å¾ˆé™Œç”Ÿï¼Œä½†æ˜¯å®ƒå®é™…ä¸Šéå¸¸ç®€å•ï¼Œå°±æ˜¯ç”¨é½æ¬¡åæ ‡ç³»çš„wåˆ†é‡å»é™¤ä»¥xã€yã€zåˆ†é‡ã€‚åœ¨OpenGLä¸­ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸€æ­¥å¾—åˆ°çš„åæ ‡å«åšå½’ä¸€åŒ–çš„è®¾å¤‡åæ ‡ï¼ˆNormalized Device Coordinatesï¼ŒNDCï¼‰ã€‚ç»è¿‡è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåæ ‡ä»é½æ¬¡è£å‰ªåæ ‡ç©ºé—´è½¬æ¢åˆ°NDCä¸­ã€‚ç»è¿‡é€è§†æŠ•å½±å˜æ¢åçš„è£å‰ªç©ºé—´ï¼Œç»è¿‡é½æ¬¡é™¤æ³•ä¼šå˜æ¢åˆ°ä¸€ä¸ªç«‹æ–¹ä½“å†…ã€‚æŒ‰ç…§OpenGLçš„ä¼ ç»Ÿï¼Œè¿™ä¸ªç«‹æ–¹ä½“çš„xã€yã€zåˆ†é‡çš„èŒƒå›´éƒ½æ˜¯[-1,1]ã€‚ä½†åœ¨DirectXè¿™æ ·çš„APIä¸­ï¼Œzåˆ†é‡çš„èŒƒå›´ä¼šæ˜¯[0,1]ã€‚è€ŒUnityé€‰æ‹©äº†OpenGLè¿™æ ·çš„é½æ¬¡è£å‰ªç©ºé—´ã€‚ ä¸€ä¸ªæœ€ç®€å•çš„é¡¶ç‚¹/ç‰‡å…ƒç€è‰²å™¨é¡¶ç‚¹/ç‰‡å…ƒç€è‰²å™¨çš„åŸºæœ¬ç»“æ„Unity Shaderçš„åŸºæœ¬ç»“æ„åŒ…å«äº†Shaderã€Propertiesã€SubShaderã€Fallbackç­‰è¯­ä¹‰å—ã€‚é¡¶ç‚¹/ç‰‡å…ƒç€è‰²å™¨çš„ç»“æ„ä¸ä¹‹å¤§ä½“ç±»ä¼¼ï¼Œå®ƒçš„ç»“æ„å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930Shader &quot;MyShaderName&quot; &#123; Properties &#123; // å±æ€§ &#125; SubShader &#123; // é’ˆå¯¹æ˜¾å¡Açš„SubShader Pass &#123; // è®¾ç½®æ¸²æŸ“çŠ¶æ€å’Œæ ‡ç­¾ // å¼€å§‹CGä»£ç ç‰‡æ®µ CGPROGRAM // è¯¥ç‰‡æ®µçš„ç¼–è¯‘æŒ‡ä»¤ï¼Œä¾‹å¦‚: #pragma vertex vert #pragma fragment frag // CGä»£ç å†™åœ¨è¿™é‡Œ ENDCG // å…¶ä»–è®¾ç½® &#125; // å…¶ä»–éœ€è¦çš„Pass &#125; SubShader &#123; // é’ˆå¯¹æ˜¾å¡Bçš„SubShader &#125; // ä¸Šè¿°SubShaderéƒ½å¤±è´¥åç”¨äºå›è°ƒçš„Unity Shader Fallback &quot;VertexLit&quot;&#125; å…¶ä¸­ï¼Œæœ€é‡è¦çš„éƒ¨åˆ†æ˜¯Passè¯­ä¹‰å—ï¼Œæˆ‘ä»¬ç»å¤§éƒ¨åˆ†çš„ä»£ç éƒ½æ˜¯å†™åœ¨è¿™ä¸ªè¯­ä¹‰å—é‡Œé¢çš„ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥åˆ›å»ºä¸€ä¸ªæœ€ç®€å•çš„é¡¶ç‚¹/ç‰‡å…ƒç€è‰²å™¨ã€‚1234567891011121314151617Shader &quot;Shader/Simple&quot; &#123; SubShader &#123; Pass &#123; CGPROGRAM #pragma vertex vert #pragma fragment frag float4 vert(float4 v : POSITION) : SV_POSITION &#123; return UnityObjectToClipPos(v); &#125; fixed4 frag() : SV_Target&#123; return fixed4(1.0, 1.0, 1.0, 1.0); &#125; ENDCG &#125; &#125;&#125; 12345678910111213141516Shader &quot;Shader/Simple1&quot;&#123; SubShader&#123; Pass&#123; CGPROGRAM #pragma vertex vert #pargma fragment frag // ä½¿ç”¨ä¸€ä¸ªç»“æ„ä½“æ¥å®šä¹‰é¡¶ç‚¹ç€è‰²å™¨çš„è¾“å…¥ struct a2v &#123; // POSITIONè¯­ä¹‰å‘Šè¯‰Unityï¼Œç”¨æ¨¡å‹ç©ºé—´çš„é¡¶ç‚¹åæ ‡å¡«å……vertexå˜é‡ float4 vertex : POSITION; &#125; ENDCG &#125; &#125;&#125; æ¨¡å‹æ•°æ®ä»å“ªé‡Œæ¥é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡å…ƒç€è‰²å™¨ä¹‹é—´å¦‚ä½•é€šä¿¡å¦‚ä½•ä½¿ç”¨å±æ€§Unityæä¾›çš„å†…ç½®æ–‡ä»¶å’Œå˜é‡å†…ç½®çš„åŒ…å«æ–‡ä»¶å†…ç½®çš„å˜é‡Unityæä¾›çš„CG/HLSLè¯­ä¹‰Unityæ”¯æŒçš„è¯­ä¹‰ è¯­ä¹‰ æè¿° POSITION æ¨¡å‹ç©ºé—´çš„é¡¶ç‚¹ä½ç½®ï¼Œé€šå¸¸æ˜¯float4ç±»å‹ NORMAL é¡¶ç‚¹æ³•çº¿ï¼Œé€šå¸¸æ˜¯float3ç±»å‹ TANGENT é¡¶ç‚¹åˆ‡çº¿ï¼Œé€šå¸¸æ˜¯float4ç±»å‹ $TEXCOORD_{n}$ï¼Œå¦‚TEXCOORD0ã€TEXCOORD1 è¯¥é¡¶ç‚¹çš„çº¹ç†åæ ‡ï¼ŒTEXCOORD0è¡¨ç¤ºç¬¬ä¸€ç»„çº¹ç†åæ ‡ï¼Œä¾æ­¤ç±»æ¨ã€‚é€šå¸¸æ˜¯float2æˆ–float4ç±»å‹ COLOR é¡¶ç‚¹é¢œè‰²ï¼Œé€šå¸¸æ˜¯fixed4æˆ–float4ç±»å‹ å¦‚ä½•å®šä¹‰å¤æ‚çš„å˜é‡ç±»å‹ä½¿ç”¨å‡å½©è‰²å›¾å½¢floatã€halfè¿˜æ˜¯fixedåœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨CG/HLSLæ¥ç¼–å†™Unity Shaderä¸­çš„ä»£ç ã€‚è€Œåœ¨CG/HLSLä¸­ï¼Œæœ‰3ä¸­ç²¾åº¦çš„æ•°å€¼ç±»å‹ï¼šfloatã€halfå’Œfixedã€‚è¿™äº›ç²¾åº¦å°†å†³å®šè®¡ç®—ç»“æœçš„æ•°å€¼èŒƒå›´ã€‚è¡¨5.8ç»™å‡ºäº†è¿™3ä¸­ç²¾åº¦åœ¨é€šå¸¸æƒ…å†µä¸‹çš„æ•°å€¼èŒƒå›´ã€‚ CG/HLSLä¸­3ç§ç²¾åº¦çš„æ•°å€¼ç±»å‹ ç±»å‹ ç²¾åº¦ float æœ€é«˜ç²¾åº¦çš„æµ®ç‚¹å€¼ã€‚é€šå¸¸ä½¿ç”¨32ä½æ¥å­˜å‚¨ half ä¸­ç­‰ç²¾åº¦çš„æµ®ç‚¹å€¼ã€‚é€šå¸¸ç”¨16ä½æ¥å­˜å‚¨ï¼Œç²¾åº¦èŒƒå›´æ˜¯-60000~+60000 fixed æœ€ä½ç²¾åº¦çš„æµ®ç‚¹å€¼ã€‚é€šå¸¸ä½¿ç”¨11ä½æ¥å­˜å‚¨ï¼Œç²¾åº¦æ–¹ä½æ˜¯-2.0~+2.0]]></content>
      <categories>
        <category>Unity Shader</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity Shader Manual]]></title>
    <url>%2F2018%2F10%2F15%2FUnity-Shader-Manual%2F</url>
    <content type="text"><![CDATA[Properties123456789101112Shader &quot;ShaderLab Tutorials/TestShader&quot;&#123; Properties &#123; _Range (&quot;My Range&quot;, Range(0.02, 0.15)) = 0.07 // sliders _Color (&quot;My Color&quot;, Color) = (.34, .85, .92, 1) // color _2D (&quot;My Texture 2D&quot;, 2D) = &quot;&quot; &#123;&#125; // texture _Rect (&quot;My Rectangle&quot;, Rect) = &quot;name&quot; &#123;&#125; _Cube (&quot;My Cubemap&quot;, Cube) = &quot;name&quot; &#123;&#125; _Float (&quot;My Float&quot;, Float) = 1 _Vector (&quot;My Vector&quot;, Vector) = (1,2,3,4) &#125;&#125; Shaderåœ¨Unityç¼–è¾‘å™¨æš´éœ²ç»™ç¾æœ¯çš„å‚æ•°ï¼Œé€šè¿‡Propertiesæ¥å®ç°ã€‚ æ‰€æœ‰å¯èƒ½çš„å‚æ•°å¦‚ä¸Šæ‰€ç¤ºã€‚ä¸»è¦ä¹Ÿå°±æ˜¯Floatã€Vectorå’ŒTextureè¿™3ç±»ã€‚ é™¤äº†é€šè¿‡ç¼–è¾‘å™¨ç¼–è¾‘Propertiesï¼Œè„šæœ¬ä¹Ÿå¯ä»¥é€šè¿‡Materialçš„æ¥å£ï¼ˆæ¯”å¦‚SetFloatã€SetTextureç¼–è¾‘ï¼‰ ä¹‹åçš„Shaderç¨‹åºé€šè¿‡[name]ï¼ˆå›ºå®šç®¡çº¿ï¼‰æˆ–è€…ç›´æ¥nameï¼ˆå¯ç¼–ç¨‹Shaderï¼‰è®¿é—®è¿™äº›å±æ€§ã€‚ åœ¨æ¯ä¸€ä¸ªPropertyå‰é¢ä¹Ÿèƒ½ç±»ä¼¼C#é‚£æ ·æ·»åŠ Attributeï¼Œä»¥è¾¾åˆ°é¢å¤–UIåŠŸèƒ½ã€‚è¯¦è§SemanticsSubShaderTags{â€œTagName1â€=â€Value1â€ â€œTagName2â€=â€Value2â€}Tagçš„è¯­æ³•ç»“æ„ï¼Œé€šè¿‡Tags{}æ¥è¡¨ç¤ºéœ€è¦æ·»åŠ çš„æ ‡è¯†ï¼Œå¤§æ‹¬å·å¯ä»¥æ·»åŠ å¤šç»„Tagï¼ˆæ‰€ä»¥æ‰å«Tagså˜›ï¼‰ï¼Œåç§°(TagName)å’Œå€¼ï¼ˆValueï¼‰æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œå¹¶ä¸”å…¨éƒ¨ç”¨å­—ç¬¦ä¸²è¡¨ç¤ºã€‚ Queueæ¸²æŸ“é˜Ÿåˆ—ç›´æ¥å½±å“æ€§èƒ½ä¸­çš„é‡å¤ç»˜åˆ¶ï¼Œåˆç†çš„é˜Ÿåˆ—å¯æå¤§çš„æå‡æ¸²æŸ“æ•ˆç‡ã€‚æ¸²æŸ“é˜Ÿåˆ—æ•°ç›®å°äº2500çš„å¯¹è±¡éƒ½è¢«è®¤ä¸ºæ˜¯ä¸é€æ˜çš„ç‰©ä½“ï¼ˆä»å‰å¾€åæ¸²æŸ“ï¼‰ï¼Œé«˜äº2500çš„è¢«ä»»åŠ¡æ˜¯åŠé€æ˜ç‰©ä½“ï¼ˆååå¾€å‰æ¸²æŸ“ï¼‰ã€‚â€œQueueâ€=â€Geometry+1â€å¯é€šè¿‡å€¼ååŠ æ•°å­—çš„æ–¹å¼æ¥æ”¹å˜é˜Ÿåˆ—ã€‚ Queueæ ‡ç­¾ è§£é‡Š â€œQueueâ€=â€Backgroundâ€ å€¼ä¸º1000ï¼Œæ­¤é˜Ÿåˆ—çš„å¯¹è±¡æœ€å…ˆè¿›è¡Œæ¸²æŸ“ â€œQueueâ€=â€Geometryâ€ é»˜è®¤å€¼ï¼Œå€¼ä¸º2000ï¼Œé€šå¸¸ç”¨äºä¸é€æ˜å¯¹è±¡ï¼Œæ¯”å¦‚åœºæ™¯ä¸­çš„ç‰©ä½“ä¸è§’è‰²ç­‰ â€œQueueâ€=â€AlphaTestâ€ å€¼ä¸º2450ï¼Œè¦ä¹ˆå®Œå…¨é€æ˜è¦ä¹ˆå®Œå…¨ä¸é€æ˜ï¼Œå¤šç”¨äºåˆ©ç”¨è´´å›¾æ¥å®ç°è¾¹ç¼˜é€æ˜çš„æ•ˆæœï¼Œä¹Ÿå°±æ˜¯ç¾æœ¯å¸¸è¯´çš„é€è´´ â€œQueueâ€=â€Transparentâ€ å€¼ä¸º3000ï¼Œå¸¸ç”¨äºåŠé€æ˜å¯¹è±¡ï¼Œæ¸²æŸ“æ—¶ä»åå¾€å‰è¿›è¡Œæ¸²æŸ“ï¼Œå»ºè®®éœ€è¦æ··åˆçš„å¯¹è±¡æ”¾å…¥æ­¤é˜Ÿåˆ— â€œQueueâ€=â€Overlayâ€ å€¼ä¸º4000ï¼Œæ­¤æ¸²æŸ“é˜Ÿåˆ—ç”¨äºå åŠ é€‰è¿‡ã€‚æœ€åæ¸²æŸ“çš„ä¸œè¥¿åº”è¯¥æ”¾åœ¨è¿™é‡Œï¼ˆä¾‹å¦‚é•œå¤´å…‰æ™•ç­‰ï¼‰ RenderTypeç”¨æ¥åŒºåˆ†è¿™ä¸ªShaderè¦æ¸²æŸ“çš„å¯¹è±¡æ˜¯å±äºä»€ä¹ˆç±»å‹çš„ï¼Œä½ å¯ä»¥æƒ³è±¡æˆäº‹æˆ‘ä»¬æŠŠä¸åŒçš„ç‰©ä½“æŒ‰æˆ‘ä»¬éœ€è¦çš„ç±»å‹æ¥è¿›è¡Œåˆ†ç±»ä¸€æ ·ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦æ”¹æˆè‡ªå®šä¹‰çš„åç§°ï¼Œè¿™æ ·å¹¶ä¸ä¼šå½±å“åˆ°Shaderçš„é€‰è¿‡ã€‚æ­¤Tagå¤šç”¨äºæ‘„åƒæœºçš„æ›¿æ¢æè´¨åŠŸèƒ½ï¼ˆCamera.SetReplacementShaderï¼‰ã€‚ æ ‡ç­¾ é‡Šä¹‰ â€œRenderTypeâ€=â€Opaqueâ€ å¤§å¤šæ•°ä¸é€æ˜ç€è‰²å™¨ â€œRenderTypeâ€=â€Transparentâ€ å¤§å¤šæ•°åŠé€æ˜ç€è‰²å™¨ï¼Œæ¯”å¦‚ç²’å­ã€ç‰¹æ•ˆã€å­—ä½“ç­‰ã€‚ â€œRenderTypeâ€=â€TransparentCutoutâ€ é€è´´ç€è‰²å™¨ï¼Œå¤šç”¨äºæ¤è¢«ç­‰ã€‚ â€œRenderTypeâ€=â€Backgroundâ€ å¤šç”¨äºå¤©ç©ºç›’ç€è‰²å™¨ã€‚ â€œRenderTypeâ€=â€Overlayâ€ GUIã€å…‰æ™•ç€è‰²å™¨ç­‰ã€‚ â€œRenderTypeâ€=â€TreeOpaqueâ€ Terrainåœ°å½¢ä¸­çš„æ ‘å¹²ã€‚ â€œRenderTypeâ€=â€TreeTransparentCutoutâ€ Treeainåœ°å½¢ä¸­çš„æ ‘å¶ã€‚ â€œRenderTypeâ€=â€TreeBillboardâ€ Terrainåœ°å½¢ä¸­çš„æ°¸å¯¹é¢æ ‘ã€‚ â€œRenderTypeâ€=â€Grassâ€ Terrainåœ°å½¢ä¸­çš„è‰ã€‚ â€œRenderTypeâ€=â€GrassBillboardâ€ Terrainåœ°å½¢ä¸­çš„ç”¨å¯¹é¢è‰ã€‚ æŒ‡å®šRenderTypeçš„åç§°ï¼Œä¸»è¦æ˜¯ä¸ºäº†é…åˆä½¿ç”¨æ›¿ä»£æ¸²æŸ“çš„æ–¹æ³•ã€‚ Camera.SetReplacementShader(&quot;shader&quot;, &quot;RenderType&quot;) DisableBatchingåœ¨åˆ©ç”¨Shaderåœ¨æ¨¡å‹çš„å®šç‚¹æœ¬åœ°åæ ‡ä¸‹åšä¸€äº›ä½ç§»åŠ¨ç”»ï¼Œè€Œå½“æ­¤æ¨¡å‹æœ‰æ‰¹å¤„ç†æ—¶ä¼šå‡ºç°æ•ˆæœä¸æ­£ç¡®çš„æƒ…å†µï¼Œè¿™æ˜¯å› ä¸ºæ‰¹å¤„ç†å°†æ‰€æœ‰æ¨¡å‹è½¬æ¢ä¸ºä¸–ç•Œåæ ‡ç©ºé—´ï¼Œå› ä¸ºâ€æœ¬åœ°åæ ‡ç©ºé—´â€å°†ä¸¢å¤±ã€‚ æ‰¹å¤„ç†æ ‡ç­¾ è§£é‡Š â€œDisableBatchingâ€=â€Trueâ€ ç¦æ­¢æ‰¹å¤„ç† â€œDisableBatchingâ€=â€Falseâ€ ä¸ç¦ç”¨æ‰¹å¤„ç† Mathdot(a,b)ç‚¹ä¹˜ï¼Œaå’Œbå¿…é¡»ä¸ºä¸‰ç»´å‘é‡æˆ–è€…å››ç»´å‘é‡ï¼Œå…¶è®¡ç®—ç»“æœæ˜¯ä¸¤ä¸ªå‘é‡å¤¹è§’çš„ä½™å¼¦å€¼ï¼Œç›¸å½“äºa.x*b.x+a.y*b.y+a.z*b.zaå’Œbçš„ä½ç½®æ— æ‰€è°“å‰åï¼Œç»“æœéƒ½æ˜¯ä¸€æ ·çš„ Miscellaneousfloat3 objCenterPos = mul(unity_ObjectToWorld, float4(0,0,0,1)).xyz; åœ¨Shaderä¸­è·å–å½“å‰æ¨¡å‹çš„ä¸­å¿ƒç‚¹ï¼Œå…¶å®å°±æ˜¯å°†(0,0,0)ç‚¹ä»æœ¬åœ°åæ ‡è½¬æ¢åˆ°ä¸–ç•Œç©ºé—´åæ ‡ä¸‹å³å¯ã€‚ å†…ç½®å‡½æ•° Syntax Description abs(x) Absolute value (per component)(æ¯ä¸ªç»„ä»¶). acos(x) Returns the arccosine(åä½™å¼¦) of each component of x. ceil(x) Returns the smallest integer(æœ€å°æ•´æ•°) which is greater(å¤§äº) than or equal to x. clip(x) Discards(æŠ›å¼ƒ) the current pixel,if any component of x is less than zero. cross(x,y) xå‘é‡å’Œyå‘é‡çš„å‘é‡ç§¯ï¼ˆå‰ç§¯ï¼‰ frac(x) è¿”å›xçš„å°æ•°éƒ¨åˆ† lerp(x,y,s) Returns x + s(y-x) noise(x) Generates a random value using the Perlin-noise algorithm. pow(x,y) Returns $x^y$ saturate(x) x: ä¸ºç”¨äºæ“ä½œçš„æ ‡é‡æˆ–çŸ¢é‡ï¼Œå¯ä»¥æ˜¯floatã€float2ã€float3ç­‰ç±»å‹ã€‚æŠŠxæˆªå–åœ¨[0,1]èŒƒå›´å†…ï¼Œå¦‚æœxæ˜¯ä¸€ä¸ªçŸ¢é‡ï¼Œé‚£ä¹ˆä¼šå¯¹å®ƒçš„æ¯ä¸€ä¸ªåˆ†é‡è¿›è¡Œè¿™æ ·çš„æ“ä½œã€‚ smoothstep(min,max,x) å¦‚æœxæ¯”minå°ï¼Œè¿”å›0ï¼›å¦‚æœxæ¯”maxå¤§ï¼Œè¿”å›1ï¼›å¦‚æœxå¤„äºèŒƒå›´[min,max]ä¸­ï¼Œåˆ™è¿”å›0å’Œ1ä¹‹é—´çš„å€¼ï¼ˆè¿”å›å€¼åœ¨minå’Œmaxé—´çš„æ¯”ä¾‹ï¼‰ã€‚ step(a,b) Returns (b&gt;=a)?1:0 (ä¸€èˆ¬ç”¨è¿™ä¸ªå–ä»£if else) tex2D(s, t) 2D texture lookup. reflect(I,N) æ ¹æ®å…¥å°„å…‰æ–¹å‘å‘é‡Iï¼Œå’Œé¡¶ç‚¹æ³•å‘é‡Nï¼Œè®¡ç®—åå°„å…‰æ–¹å‘å‘é‡ã€‚å…¶ä¸­Iå’ŒNå¿…é¡»è¢«å½’ä¸€åŒ–ï¼Œéœ€è¦éå¸¸æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªIæ˜¯æŒ‡å‘é¡¶ç‚¹çš„ï¼›å‡½æ•°åªå¯¹ä¸‰å…ƒå‘é‡æœ‰æ•ˆ Tex2DProj(sampler2D tex, float3 sq) äºŒç»´æŠ•å½±çº¹ç†æŸ¥è¯¢ Tex2DProj(sampler2D tex, float4 szq) äºŒç»´æŠ•å½±çº¹ç†æŸ¥è¯¢ï¼Œå¹¶è¿›è¡Œæ·±åº¦å€¼æ¯”è¾ƒ #pragma fragementoption ARB_precision_hint_fastestARB_precision_hint_fastest æ˜¯ç”¨æœ€å¿«çš„æ–¹å¼ï¼Œä»¥æœ€ä½çš„ç²¾åº¦è¿è¡Œï¼Œæå‡ç‰‡æ®µç€è‰²å™¨çš„è¿è¡Œé€Ÿåº¦ï¼Œå‡å°‘æ—¶é—´ã€‚ï¼ˆé€šå¸¸æ˜¯æŒ‡FP16,16bitï¼ŒåŠç²¾åº¦ï¼‰ç‰ºç‰²è¡¨ç°æ¢å–è¿è¡Œé€Ÿåº¦ã€‚ UnpackNormalhalf3 normal = UnpackNormal(tex2D(_NormalMap, IN.uv_NormalMap)); UnpackNormalæ˜¯å®šä¹‰åœ¨UnityCG.cgincæ–‡ä»¶ä¸­çš„æ–¹æ³•ï¼ŒUnpackNormalæ¥å—ä¸€ä¸ªfixed4çš„è¾“å…¥ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºæ‰€å¯¹åº”çš„æ³•çº¿å€¼(fixed3)ã€‚]]></content>
      <categories>
        <category>Unity Shader</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[TSF4G]]></title>
    <url>%2F2018%2F09%2F21%2FTSF4G%2F</url>
    <content type="text"><![CDATA[https://github.com/johnnyluo586/TSF4G.git Tbusç®€ä»‹Tbusæ˜¯tsf4g(Tencent ServiceFramework for Game,è…¾è®¯æ¸¸æˆæœåŠ¡æ¡†æ¶)ä¸­çš„åŸºç¡€ç»„ä»¶ä¹‹ä¸€ï¼Œä¸»è¦çš„ç›®çš„æ˜¯ä¸ºä¸Šå±‚ä¸šåŠ¡æä¾›ç»Ÿä¸€çš„çº¿ç¨‹æˆ–è¿›ç¨‹é—´é€šä¿¡æ¥å£ï¼Œå±è”½æœ¬åœ°è¿›ç¨‹é—´é€šä¿¡ä»¥åŠè¿œç¨‹è¿›ç¨‹é€šä¿¡çš„ç»†èŠ‚ï¼Œè®©å¼€å‘äººå‘˜å¯ä»¥é›†ä¸­ç²¾åŠ›å…³æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œæ˜¯tsf4gé‡è¦ç»„æˆéƒ¨åˆ†ã€‚ TbusåŸç† TbusåŸºäºå…±äº«å†…å­˜æ„å»ºæ— é”åŒé€šå¾ªç¯æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå‘é€çš„åŒæ–¹é€šè¿‡ä¸“ç”¨çš„è¯»å†™é˜Ÿåˆ—å®Œæˆæ•°æ®æ”¶å‘ï¼Œå®ç°æœ¬åœ°è¿›ç¨‹æˆ–è€…è¿œç¨‹è¿›ç¨‹é—´é€šä¿¡ã€‚é€šä¿¡åŒæ–¹ä½¿ç”¨çš„ä¸¤ä¸ªé˜Ÿåˆ—ç§°ä¹‹ä¸ºtbusé€šé“(channel)ï¼Œæ¯ä¸€ç»„é€šè®¯çš„åŒæ–¹å°±éœ€è¦æœ‰ä¸€ä¸ªtbusé€šé“ã€‚ è¿›ç¨‹Aå‘é€æ¶ˆæ¯åï¼Œæ¶ˆæ¯è¢«å­˜å‚¨åˆ°Host Açš„å‘é€é˜Ÿåˆ—ä¸­ï¼Œéƒ¨ç½²äºHost Açš„tbusdå‘ç°é˜Ÿåˆ—ä¸­å­˜åœ¨æ¶ˆæ¯ï¼Œåˆ™ä»é˜Ÿåˆ—ä¸­æŠŠæ¶ˆæ¯å–å‡ºï¼Œé€šè¿‡tcpå‘é€åˆ°Host Bä¸Šã€‚Host Bä¸Šçš„tbusdæ¥æ”¶åˆ°æ¶ˆæ¯åï¼ŒæŠŠæ¶ˆæ¯å†™å…¥æœ¬åœ°çš„æ¥æ”¶é˜Ÿåˆ—ï¼Œä»¥ä¾›è¿›ç¨‹Bè¯»å–ã€‚ ä¸ºäº†èƒ½å®Œæˆé€šä¿¡ï¼ŒTbusè¿˜æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š é€šä¿¡åŒæ–¹å…·å¤‡å…¨å±€å”¯ä¸€çš„tbusé€šä¿¡åœ°å€ï¼Œè¯¥åœ°å€æ˜¯ä¸€ä¸ªç‚¹åˆ†åè¿›åˆ¶çš„å­—ç¬¦ä¸²ï¼Œä¸IPåœ°å€ç±»å‹ï¼Œæ€»é•¿åº¦ä¸º32bitï¼Œåˆ†ä¸º4æ®µï¼Œæ¯æ®µbitä½æ•°å¯ä»¥è‡ªå®šä¹‰ï¼Œæ€»é•¿åº¦ä¸è¶…è¿‡32bitã€‚ä¾‹å¦‚ï¼š128.1.100.1,5.0.200.1ã€‚ Tbusé€šé“ä»¥åŠæ¶ˆæ¯æ˜¯å­˜å‚¨åœ¨å…±äº«å†…å­˜ä¸­ï¼Œå¿…é¡»è¦ä½¿ç”¨ç›¸åº”çš„å·¥å…·æå‰åˆ›å»ºï¼Œè¿›ç¨‹æ‰èƒ½ç»‘å®šä¸ä½¿ç”¨ã€‚è€Œå½“ä¸šåŠ¡è¿›ç¨‹å¼‚å¸¸é€€å‡ºåï¼Œç”±äºæ¶ˆæ¯æ˜¯å­˜å‚¨åœ¨å…±äº«å†…å­˜ä¸­ï¼Œåªè¦ä¸ä¸»åŠ¨æ¸…ç†å…±äº«å†…å­˜ã€é‡å¯æœåŠ¡å™¨æˆ–æŸåå…±äº«å†…å­˜ï¼Œé€šé“çš„æ¶ˆæ¯å°±ä¸ä¼šä¸¢å¤±ã€‚]]></content>
      <tags>
        <tag>Server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity-Lua-Manual]]></title>
    <url>%2F2018%2F09%2F18%2FUnity-Lua-Manual%2F</url>
    <content type="text"><![CDATA[GameObjectGO_namegameObject.GO_name = &quot;name&quot; è®¾ç½®æˆ–è€…è·å–æ¸¸æˆå¯¹è±¡çš„åå­— GO_selfgameObject.GO_self ç»‘å®šåˆ°è‡ªå·±èº«ä¸Šçš„Luaæ¨¡å—æŒ‡é’ˆ GO_activegameObject.GO_active = true/false è®¾ç½®æ¸¸æˆå¯¹è±¡çš„æ˜¾å¼æˆ–è€…éšè— GO_parentgameObject.GO_parent = parent è®¾ç½®æ¸¸æˆå¯¹è±¡çš„çˆ¶èŠ‚ç‚¹ GO_childCountgameObject.GO_childCount è·å–æ¸¸æˆå¯¹è±¡çš„å­èŠ‚ç‚¹å¯¹è±¡ï¼Œä¸é€’å½’ GO_AddComponentgameObject:GO_AddComponent(â€œUILabel&quot;) ç»™æ¸¸æˆå¯¹è±¡æ·»åŠ ç»„ä»¶ GO_GetComponentgameObject:GO_GetComponent(&quot;UILabel&quot;) gameObject:GO_GetComponent(&quot;UILabel&quot;, &quot;Sprite/Label&quot;) æ–¹æ³•ä¸€ï¼šè·å–æ¸¸æˆå¯¹è±¡çš„ç»„ä»¶æ–¹æ³•äºŒï¼šè·å–å­èŠ‚ç‚¹ä¸Šçš„ç»„ä»¶ï¼Œå‚æ•°äºŒè¡¨ç¤ºç›¸å¯¹äºçˆ¶èŠ‚ç‚¹çš„è·¯å¾„ GO_FindgameObject:GO_Find(&quot;Sprite/Label&quot;) è·å–å­èŠ‚ç‚¹å¯¹è±¡ GO_AddChildgameObject:GO_AddChild(&quot;UI/ui_node&quot;) gameObject:GO_AddChild(ui_node) æ–¹æ³•ä¸€ï¼šé€šè¿‡ç›¸å¯¹äºResourcesä¸‹çš„è·¯å¾„æ¥ç»™æ¸¸æˆå¯¹è±¡æ·»åŠ å­èŠ‚ç‚¹æ–¹æ³•äºŒï¼šé€šè¿‡å®ä¾‹å¯¹è±¡æ¥ç»™æ¸¸æˆå¯¹è±¡æ·»åŠ å­èŠ‚ç‚¹å¦‚æœæ˜¯UIèŠ‚ç‚¹ï¼Œè¯·ä½¿ç”¨UI_AddChild UI_AddChildgameObject:UI_AddChild(&quot;UI/ui_node&quot;) gameObject:UI_AddChild(ui_node) æ–¹æ³•ä¸€ï¼šé€šè¿‡ç›¸å¯¹äºResourcesä¸‹çš„è·¯å¾„æ¥ç»™æ¸¸æˆå¯¹è±¡æ·»åŠ å­èŠ‚ç‚¹æ–¹æ³•äºŒï¼šé€šè¿‡å®ä¾‹å¯¹è±¡æ¥ç»™æ¸¸æˆå¯¹è±¡æ·»åŠ å­èŠ‚ç‚¹ GO_DelChildgameObject:GO_DelChild(idx) åˆ é™¤æ¸¸æˆå¯¹è±¡çš„å­èŠ‚ç‚¹ï¼Œidxæ˜¯ä¸‹æ ‡ä»0å¼€å§‹çš„ç´¢å¼•ï¼ˆé¡ºåºæ˜¯æ£€è§†é¢æ¿æ˜¾ç¤ºçš„é¡ºåºï¼‰ GO_DestroySelfgameObject:GO_DestroySelf() é”€æ¯è‡ªå·± GO_RemoveAllChildrengameObject:GO_RemoveAllChildren() é”€æ¯æ‰€æœ‰çš„å­èŠ‚ç‚¹ GO_ShowAllChildrengameObject:GO_ShowAllChildren(ture/false) æ˜¾ç¤ºæˆ–è€…éšè—è‡ªå·±æ‰€æœ‰çš„å­èŠ‚ç‚¹ GO_GetLocalPositionlocal x,y,z = gameObject:GO_GetLocalPosition() è·å–è‡ªå·±çš„localPosition GO_SetLocalPositiongameObject:GO_SetLocalPosition(x,y [,z]) è®¾ç½®è‡ªå·±çš„localPosition,[] è¡¨ç¤ºå¯é€‰å‚æ•°,å½“æœªæŒ‡å®šæ—¶è¡¨ç¤ºä½¿ç”¨ä¹‹å‰çš„z GO_GetLocalRotationlocal x,y,z = gameObject:GO_GetLocalRotation() è·å–è‡ªå·±çš„localRotation GO_SetLocalRotationgameObject:GO_SetLocalRotation(x,y [,z]) è®¾ç½®è‡ªå·±çš„localRotation,[]è¡¨ç¤ºå¯é€‰å‚æ•°,å½“æœªæŒ‡å®šæ—¶è¡¨ç¤ºä½¿ç”¨ä¹‹å‰çš„z GO_SetLocalScalegameObject:GO_SetLocalScale(x,y,z) è®¾ç½®è‡ªå·±çš„localScale GO_UpdateAllAnchorsgameObject:GO_UpdateAllAnchors() æ‰‹åŠ¨åˆ·æ–°è‡ªèº«çš„é”šç‚¹ UI_activegameObject.UI_active = true/false é€’å½’åˆ·æ–°è‡ªå·±å’Œå­èŠ‚ç‚¹çš„æ˜¾ç¤ºå’Œéšè—ï¼Œå¦‚æ— ç‰¹æ®Šè¦æ±‚è¯·ä½¿ç”¨GO_active UI_onClickgameObject.UI_onClick = function() end æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œæ¸¸æˆå¯¹è±¡éœ€è¦æ·»åŠ boxcollider2D UIToggle_onChangegameObject.UIToggle_onChange = function() end æ·»åŠ ToggleçŠ¶æ€æ”¹å˜çš„å›è°ƒå‡½æ•°ï¼Œæ¸¸æˆå¯¹è±¡éœ€è¦æ·»åŠ UIToggle UILabel_textgameObject.UILabel_text = &quot;Hello, World!&quot; è®¾ç½®æˆ–è€…è¯»å–æ¸¸æˆå¯¹è±¡çš„UILabelæ–‡æœ¬ï¼Œæ¸¸æˆå¯¹è±¡éœ€è¦æ·»åŠ UILabel UILabel_colorgameObject.UILabel_color = Color.FromHex(&quot;C4C4C4FF&quot;) è®¾ç½®æˆ–è€…è¯»å–æ–‡æœ¬é¢œè‰²ï¼Œè¿”å›å€¼æ˜¯Color UISprite_spriteNamegameObject.UISprite_spriteName = &quot;btn_blue&quot; è®¾ç½®æˆ–è€…è¯»å–ç²¾çµçš„åå­—ï¼Œæ¸¸æˆå¯¹è±¡éœ€è¦æ·»åŠ UISpriteç»„ä»¶ UISprite_colorgameObject.UISprite_color = Color.FormHex(&quot;6f4f3fff&quot;) è®¾ç½®æˆ–è€…è¯»å–ç²¾çµçš„é¢œè‰²ï¼Œæ¸¸æˆå¯¹è±¡éœ€è¦æ·»åŠ UISpriteç»„ä»¶ UIToggle_valuegameObject.UIToggle_value = true/false è®¾ç½®UIToggleçš„å€¼ UIWidget_colorgameObject.UIWidget_color = Color.FormHex(&quot;6f4f3fff&quot;) è®¾ç½®UIWidgetæˆ–è€…ç»§æ‰¿ä»–çš„å­ç±»ï¼ˆUILabel,UISprite)çš„é¢œè‰² UIWidget_widthgameObject.UIWidget_width = 100 è®¾ç½®UIWidgetæˆ–è€…ç»§æ‰¿ä»–çš„å­ç±»ï¼ˆUILabel,UISprite)çš„å®½åº¦ UIWidget_heightgameObject.UIWidget_height = 100 è®¾ç½®UIWidgetæˆ–è€…ç»§æ‰¿ä»–çš„å­ç±»çš„é«˜åº¦ UIGrid_RepositiongameObject:UIGrid_Reposition() ä½¿Gridé‡æ–°æ’åºï¼Œä¸€èˆ¬ç»™Gridæ·»åŠ äº†å­èŠ‚ç‚¹åä½¿ç”¨ Tween_PlaygameObject:Tween_Play() æ’­æ”¾TweenåŠ¨ç”» MBMB.LogMB.Log(&quot;Hello,World!&quot;) æ‰“å°æ—¥å¿— MB.PCallMB.PCall(function() end) å®‰å…¨çš„è°ƒç”¨å‡½æ•°ï¼Œå½“å‡½æ•°å†…éƒ¨å‘ç”Ÿé”™è¯¯çš„æ—¶å€™ï¼Œä¸ä¼šä¸­æ–­å½“å‰æ‰§è¡Œç¯å¢ƒ MB.LoadModuleMB.LoadModule(&quot;ui_task&quot;) åŠ è½½ä¸€ä¸ªluaæ¨¡å— MB.ShowTheTipMB.ShowTheTip(&quot;Hello,World!&quot;, 2) å¼¹å‡ºTipsï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ—¶é•¿å•ä½æ˜¯ç§’ String.CSFormatString.CSFormat(&quot;id={0},name={1}&quot;,10,&quot;test&quot;) è°ƒç”¨C#çš„æ ¼å¼åŒ–å‡½æ•° MB.GetStringXMB.GetStringX(bytes[], 10, &quot;test&quot;) è°ƒç”¨C#çš„æ ¼å¼åŒ–å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯byteæ•°ç»„ï¼Œä¸€èˆ¬æ¥è¯´è¡¨æ ¼ä¸­çš„å­—æ®µç”¨å®ƒ MB.GetExcelListMB.GetExcelList(&quot;NewTaskResConf&quot;) è¯»å–è¡¨æ ¼ MB.GO_GetResourceself.u_testSprite.atlas = MB.GO_GetResource(&quot;UI/01Common&quot;) è·å–èµ„æº å‚æ•°è¡¨ç¤ºç›¸å¯¹äºResourcesçš„è·¯å¾„ï¼Œè¿”å›çš„æ˜¯GameObject UITextureSetTexturePathtexture:SetTexturePath(&quot;Texture/UI/Chapter1&quot;) è®¾ç½®textureçš„èµ„æºè·¯å¾„ï¼Œè·¯å¾„ç›¸å¯¹äºResourcesï¼Œtextureæ˜¯é€šè¿‡gameObjectè·å–çš„ç»„ä»¶ SetMattexture:SetMat(path) è®¾ç½®textureçš„æè´¨ï¼Œpathè¡¨ç¤ºç›¸å¯¹Resourcesè·¯å¾„ UILabletextlabel.text = &quot;Hello, Worldï¼&quot; è®¾ç½®æˆ–è€…è¯»å–Labelçš„æ–‡æœ¬ colorlabel.color = Color.FromHex(&quot;6F4F3FFF&quot;) è®¾ç½®æˆ–è€…è¯»å–Labelçš„é¢œè‰² effectColorlabel.effectColor = Color.FromHex(&quot;6F4F3FFF&quot;) è®¾ç½®æˆ–è€…è¯»å–Labelçš„æ•ˆæœé¢œè‰² fontSizelabel.fontSize = 20 è®¾ç½®æˆ–è€…è¯»å–å­—ä½“çš„å¤§å° UISpritespriteNamesprite.spriteName = &quot;btn_red&quot; è®¾ç½®æˆ–è€…è¯»å–Spriteçš„åå­—ï¼ˆå›¾é›†ä¸­çš„ï¼‰ widthsprite.width = 100 è®¾ç½®æˆ–è€…è¯»å–Spriteçš„å®½åº¦ heightsprite.height = 100 è®¾ç½®æˆ–è€…è¯»å–Spriteçš„é«˜åº¦ atlassprite.atlas = MB.GO_GetResource(&quot;UI/01Common&quot;) è®¾ç½®æˆ–è€…è¯»å–å›¾é›† LuaEventC#ä¸­ LuaEvent.CallEvent((int)eLuaEvnet.eLuaEvent_PlayerTaskUpdate, param1, param2, param3); luaä¸­ lua_event.InvokeEvent(lua_def.eLuaEvent_PlayerTaskUpdate, param1, param2, param3) lua_event.InsertEvent(lua_def.eLuaEvent_PlayerTaskUpdate, callback, name, 0) function callback(param1, param2, param3) end CallEventè¡¨ç¤ºC#äº‹ä»¶é€šçŸ¥LuaInvokeEventè¡¨ç¤ºLuaäº‹ä»¶é€šçŸ¥LuaLuaEvent.CallEventä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºç±»å‹åœ¨obj_def.csä¸­å®šä¹‰ï¼Œåé¢æ˜¯éœ€è¦ä¼ é€’ç»™luaçš„å‚æ•° lua_netSendBinlua_net.SendBin(lua_def.CS_CMD_GET_TASK_LIST_REQ, {Page = 1, Type = 4}, callback) function callback(msg) end å‘é€äºŒè¿›åˆ¶åŒ…ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¶ˆæ¯IDï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç›¸å¯¹äºæ•°æ®ç»“æ„ç±»å‹ï¼Œcallbackæ˜¯å›è°ƒå‡½æ•°ï¼Œå¯é€‰ç±»å‹å›è°ƒå‡½æ•°ä¸­çš„msgè¡¨ç¤ºä¸€ä¸ªjsonçš„xmlä¸­ç»“æ„ã€‚ Sendlua_net.Send(lua_def.eCTS_UI_Task, {op = &quot;get&quot;}) å‘é€JSONåŒ…ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯cts_def.csä¸­å®šä¹‰çš„æ¶ˆæ¯ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯lua table Registerlua_net.Register(lua_def.eSTC_UI_Task, OnUITaskHandle, signal, -1) function OnUITaskHandler(msg) end lua_net.Register(lua_def.CS_CMD_GET_TASK_LIST_RES, OnGetTaskListRes, signal, -1) function OnGetTaskListRes(msg) -- msgæ˜¯xmlç”Ÿæˆçš„æ•°æ®ç»“æ„ï¼Œä¼ åˆ°luaé‡Œé¢æ˜¯ä¸€ä¸ªjson table end æ³¨å†Œä¸€ä¸ªæ¶ˆæ¯å›è°ƒï¼Œsignalè¡¨ç¤ºä¸€ä¸ªå›è°ƒçš„å”¯ä¸€å¥æŸ„ï¼Œ-1è¡¨ç¤ºè°ƒç”¨è¯¥å›è°ƒå‡½æ•°çš„é¡ºåºï¼Œé»˜è®¤æ˜¯0 lua_timerlua_timer.Timer(self.gameObject, span, onTick, count, name) â€” åˆ›å»ºTimerå¯¹è±¡â€” go : æŒ‡å®šæŒ‚åˆ°æŸä¸ªgameObjectä¸Šâ€” span : æ—¶é—´é—´éš”ï¼Œæ¯«ç§’â€” onTick : å›è°ƒå‡½æ•°(timer, dt)ï¼Œå›è°ƒçš„dtå‚æ•°æ˜¯è¶…æ—¶çš„æ—¶é—´ï¼Œä¸€èˆ¬ä¹Ÿç”¨ä¸ä¸Šâ€” count : é‡å¤æ¬¡æ•°ï¼Œç¼ºçœæ˜¯1ï¼Œå¦‚æœæ˜¯-1åˆ™æ— é™å¾ªç¯ã€‚â€” return : è¿”å›ä¸€ä¸ªlua tableä½œä¸ºTimer]]></content>
  </entry>
  <entry>
    <title><![CDATA[luajit]]></title>
    <url>%2F2018%2F09%2F10%2Fluajit%2F</url>
    <content type="text"><![CDATA[JIT = Just In TimeIOSä¸­ç¦æ­¢ä½¿ç”¨ï¼ˆä¸è®©è‡ªä¸»ç”³è¯·å†…å­˜ï¼‰ è§£é‡Šæ‰§è¡Œï¼š æ•ˆç‡ä½ ä»£ç æš´éœ² é™æ€ç¼–è¯‘ ä¸å¤Ÿçµæ´»ï¼Œæ— æ³•çƒ­æ›´æ–° å¹³å°å…¼å®¹æ€§å·® JITï¼š æ•ˆç‡ï¼šé«˜äºè§£é‡Šæ‰§è¡Œï¼Œä½äºé™æ€ç¼–è¯‘ã€‚ å®‰å…¨æ€§ï¼šä¸€èˆ¬éƒ½å…ˆè½¬æ¢æˆå­—èŠ‚ç  çƒ­æ›´æ–°ï¼šæ— è®ºæºç è¿˜æ˜¯å­—èŠ‚ç æœ¬è´¨éƒ½æ˜¯è‡ªæ„¿æ–‡ä»¶ã€‚ å…¼å®¹æ€§ï¼šè™šæ‹Ÿæœºä¼šå¤„ç†å¹³å°å·®å¼‚ï¼Œå¯¹ç”¨æˆ·é€æ˜ã€‚]]></content>
  </entry>
  <entry>
    <title><![CDATA[Andorid NDK]]></title>
    <url>%2F2018%2F07%2F21%2FAndroid-NDK%2F</url>
    <content type="text"><![CDATA[JNIJNIçš„å…¨ç§°æ˜¯Java Native Interfaceï¼ŒJavaåŸç”Ÿæ¥å£ã€‚æä¾›åˆ«çš„ä»£ç è°ƒç”¨çš„ä¸€ç»„å‡½æ•°ã€‚é¦–å…ˆä½¿ç”¨C++å†™å‡ºäº†ä¸€äº›å‡½æ•°ï¼Œç„¶åå°†è¿™äº›å‡½æ•°åœ¨Javaç±»ä¸­å†å£°æ˜ä¸€æ¬¡ï¼ˆåŠ ä¸Šå…³é”®å­—nativeï¼‰ï¼Œè¿™æ ·Javaç±»ä¸­çš„å‡½æ•°å’ŒC++ä¸­çš„å‡½æ•°å°±åŒ¹é…åˆ°ä¸€èµ·äº†ï¼Œæˆ‘ä»¬ä½¿ç”¨Javaç±»ä¸­çš„å‡½æ•°ï¼Œå…¶å®å°±æ˜¯ä½¿ç”¨C++ä¸­çš„å‡½æ•°ã€‚è¿™ä¸ªåœ¨Javaç±»ä¸­å£°æ˜çš„å‡½æ•°å°±æ˜¯ä¸€ä¸ªJNIã€‚ NDKNDKçš„å…¨ç§°æ˜¯Native Development Kitï¼ŒåŸç”Ÿå¼€å‘å·¥å…·åŒ…ã€‚ äº¤å‰ç¼–è¯‘äº¤å‰ç¼–è¯‘å°±æ˜¯åœ¨ä¸€ä¸ªå¹³å°ä¸Šç”Ÿæˆå¦ä¸€ä¸ªå¹³å°ä¸Šçš„å¯æ‰§è¡Œä»£ç ã€‚]]></content>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AndroidManifest.xmlè¯¦è§£]]></title>
    <url>%2F2018%2F07%2F21%2FAndroidManifest%2F</url>
    <content type="text"><![CDATA[ä¸ºåº”ç”¨çš„JAVAè½¯ä»¶åŒ…å‘½åã€‚è½¯ä»¶åŒ…åç§°å……å½“åº”ç”¨çš„å”¯ä¸€æ ‡è¯†ç¬¦ æè¿°åº”ç”¨çš„å„ä¸ªç»„ä»¶ï¼ŒåŒ…æ‹¬æ„æˆåº”ç”¨çš„Activityã€æœåŠ¡ã€å¹¿æ’­æ¥æ”¶å™¨å’Œå†…å®¹æä¾›ç¨‹åºã€‚å®ƒè¿˜ä¸ºå®ç°æ¯ä¸ªç»„ä»¶çš„ç±»å‘½åå¹¶å‘å¸ƒå…¶åŠŸèƒ½ï¼Œä¾‹å¦‚å®ƒä»¬å¯ä»¥å¤„ç†Intentæ¶ˆæ¯ã€‚è¿™äº›å£°æ˜å‘Androidç³»ç»Ÿå‘ŠçŸ¥æœ‰å…³ç»„ä»¶ä»¥åŠå¯ä»¥å¯åŠ¨è¿™äº›ç»„ä»¶çš„æ¡ä»¶çš„ä¿¡æ¯ã€‚ ç¡®å®šæ‰˜ç®¡åº”ç”¨ç»„ä»¶çš„è¿›ç¨‹ã€‚ å£°æ˜åº”ç”¨å¿…é¡»å…·å¤‡å“ªäº›æƒé™æ‰èƒ½è®¿é—®APIä¸­å—ä¿æŠ¤çš„éƒ¨åˆ†å¹¶ä¸å…¶ä»–åº”ç”¨äº¤äº’ã€‚è¿˜å£°æ˜å…¶ä»–åº”ç”¨ä¸è¯¥åº”ç”¨ç»„ä»¶äº¤äº’æ‰€éœ€å…·å¤‡çš„æƒé™ã€‚ åˆ—å‡ºInstrumentationç±»ï¼Œè¿™äº›ç±»å¯åœ¨åº”ç”¨è¿è¡Œæ—¶æä¾›åˆ†æå’Œå…¶ä»–ä¿¡æ¯ã€‚è¿™äº›å£°æ˜åªä¼šåœ¨åº”ç”¨å¤„äºå¼€å‘é˜¶æ®µæ—¶å‡ºç°åœ¨æ¸…å•ä¸­ï¼Œåœ¨åº”ç”¨å‘å¸ƒä¹‹å‰ä¼šå°†ç§»é™¤ã€‚ å£°æ˜åº”ç”¨æ‰€éœ€çš„æœ€ä½Android APIçº§åˆ«ã€‚ åˆ—å‡ºåº”ç”¨å¿…é¡»é“¾æ¥åˆ°çš„åº“ å…ƒç´ é¦–å…ˆï¼Œæ‰€æœ‰çš„xmléƒ½å¿…é¡»åŒ…å«å…ƒç´ ã€‚è¿™æ˜¯æ–‡ä»¶çš„æ ¹èŠ‚ç‚¹ã€‚å®ƒå¿…é¡»è¦åŒ…å«å…ƒç´ ï¼Œå¹¶ä¸”æŒ‡æ˜xmlns:androidå’Œpackageå±æ€§ã€‚ xmlns:androidè¿™ä¸ªå±æ€§å®šä¹‰äº†Androidå‘½åç©ºé—´ã€‚å¿…é¡»è®¾ç½®æˆâ€http://schemas.android.com/apk/res/android&quot;ã€‚ä¸è¦æ‰‹åŠ¨ä¿®æ”¹ã€‚ packageè¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„Javaè¯­è¨€é£æ ¼åŒ…åã€‚åŒ…åç”±è‹±æ–‡å­—æ¯ï¼ˆå¤§å°å†™å‡å¯ï¼‰ã€æ•°å­—å’Œä¸‹åˆ’çº¿ç»„æˆã€‚æ¯ä¸ªç‹¬ç«‹çš„åå­—å¿…é¡»ä»¥å­—æ¯å¼€å¤´ã€‚ æ„å»ºAPKçš„æ—¶å€™ï¼Œæ„å»ºç³»ç»Ÿä½¿ç”¨è¿™ä¸ªå±æ€§æ¥åšä¸¤ä»¶äº‹ï¼š ç”ŸæˆR.javaç±»æ—¶ç”¨è¿™ä¸ªåå­—ä½œä¸ºå‘½åç©ºé—´ï¼ˆç”¨äºè®¿é—®APPçš„èµ„æºï¼‰æ¯”å¦‚ï¼špackageè¢«è®¾ç½®æˆnet.pixelgame.unity3d android:nameè¯¥å±æ€§ä»¥å­—ç¬¦ä¸²å½¢å¼æŒ‡å®šäº†APPè¦ç”¨çš„ç¡¬ä»¶æˆ–è½¯ä»¶åŠŸèƒ½ã€‚ android:required andorid:glEsVersion å…ƒç´  æ­¤å…ƒç´ æè¿°äº†åº”ç”¨çš„é…ç½®ã€‚è¿™æ˜¯ä¸€ä¸ªå¿…å¤‡çš„å…ƒç´ ï¼Œå®ƒåŒ…å«äº†å¾ˆå¤šå­å…ƒç´ æ¥æè¿°åº”ç”¨çš„ç»„ä»¶ï¼Œå®ƒçš„å±æ€§å½±å“åˆ°æ‰€æœ‰çš„å­ç»„ä»¶ã€‚è®¸å¤šå±æ€§]]></content>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Protocol Buffer]]></title>
    <url>%2F2018%2F07%2F21%2FProtocol%2F</url>
    <content type="text"><![CDATA[é«˜æ•ˆçš„äºŒè¿›åˆ¶æ–¹å¼å­˜å‚¨Varintæ˜¯ä¸€ç§ç´§å‡‘çš„è¡¨ç¤ºæ•°å­—çš„æ–¹æ³•ã€‚å®ƒç”¨ä¸€ä¸ªæˆ–å¤šä¸ªå­—èŠ‚æ¥è¡¨ç¤ºä¸€ä¸ªæ•°å­—ï¼Œå€¼è¶Šå°‘çš„æ•°å­—ä½¿ç”¨è¶Šå°‘çš„å­—èŠ‚æ•°ã€‚é‡‡ç”¨è¿™ç§Key-Pairç»“æ„æ— éœ€ä½¿ç”¨åˆ†éš”ç¬¦æ¥åˆ†å‰²ä¸åŒçš„Fieldã€‚ Type Meaning Used For 0 Varint int32,int64,uint32,uint64,sint32,sint64,bool,enum 1 64-bit fixed64 sfixed64,double 2 Length-delimi string,bytes,embedded messages,packed repeated fields 3 Start group Groups(deprecated) 4 End group Groups(deprecated) 5 32-bit fixed32,sfixed32,float åœ¨è®¡ç®—æœºå†…ï¼Œä¸€ä¸ªè´Ÿæ•°ä¸€èˆ¬ä¼šè¢«è¡¨ç¤ºä¸€ä¸ªå¾ˆå¤§çš„æ•´æ•°ï¼Œå› ä¸ºè®¡ç®—æœºå®šä¹‰è´Ÿæ•°çš„ç¬¦å·ä½ä¸ºæ•°å­—çš„æœ€é«˜ä½ã€‚å¦‚æœé‡‡ç”¨Varintè¡¨ç¤ºä¸€ä¸ªè´Ÿæ•°ï¼Œé‚£ä¹ˆä¸€å®šéœ€è¦5ä¸ªbyteã€‚ä¸ºæ­¤Google Protocol Bufferå®šä¹‰äº†sint32è¿™ç§ç±»å‹ï¼Œé‡‡ç”¨zigzagç¼–ç ã€‚ Zigzagç¼–ç ç”¨æ— ç¬¦å·æ¥è¡¨ç¤ºæœ‰ç¬¦å·æ•°å­—ï¼Œæ­£æ•°å’Œè´Ÿæ•°äº¤é”™ï¼Œè¿™å°±æ˜¯zigzagè¿™ä¸ªè¯çš„å«ä¹‰äº†ã€‚ ä½¿ç”¨zigzagç¼–ç ï¼Œç»å¯¹å€¼å°çš„æ•°å­—ï¼Œæ— è®ºæ­£è´Ÿéƒ½å¯ä»¥é‡‡ç”¨è¾ƒå°‘çš„byteæ¥è¡¨ç¤ºï¼Œå……åˆ†åˆ©ç”¨äº†Varintè¿™ç§æŠ€æœ¯ã€‚ å…¶ä»–çš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²åˆ™é‡‡ç”¨ç±»ä¼¼æ•°æ®åº“ä¸­çš„varcharçš„è¡¨ç¤ºæ–¹æ³•ï¼Œå³ç”¨ä¸€ä¸ªvarintè¡¨ç¤ºé•¿åº¦ï¼Œç„¶åå…¶ä½™éƒ¨åˆ†ç´§è·Ÿåœ¨è¿™ä¸ªé•¿åº¦éƒ¨åˆ†ä¹‹åå³å¯ã€‚ å°è§£åŒ…çš„é€Ÿåº¦é¦–å…ˆæ¥äº†è§£ä¸€ä¸‹XMLçš„å°è§£åŒ…è¿‡ç¨‹ã€‚XMLéœ€è¦ä»æ–‡ä»¶ä¸­è¯»å–å­—ç¬¦ä¸²ï¼Œå†è½¬æ¢ä¸ºXMLæ–‡æ¡£å¯¹è±¡ç»“æ„æ¨¡å‹ã€‚ä¹‹åï¼Œå†ä»XMLæ–‡æ¡£å¯¹è±¡ç»“æ„æ¨¡å‹ä¸­è¯»å–æŒ‡å®šèŠ‚ç‚¹çš„å­—ç¬¦ä¸²ï¼Œæœ€åå†å°†è¿™ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆæŒ‡å®šç±»å‹çš„å˜é‡ã€‚è¿™ä¸ªè¿‡ç¨‹éå¸¸å¤æ‚ï¼Œå…¶ä¸­å°†XMLæ–‡ä»¶è½¬æ¢ä¸ºæ–‡æ¡£å¯¹è±¡ç»“æ„æ¨¡å‹çš„è¿‡ç¨‹é€šå¸¸éœ€è¦å®Œæˆè¯æ³•æ–‡æ³•åˆ†æç­‰å¤§é‡æ¶ˆè€—CPUçš„å¤æ‚è®¡ç®—ã€‚ åè§‚Protobufï¼Œå®ƒåªéœ€è¦ç®€å•åœ°å°†ä¸€ä¸ªäºŒè¿›åˆ¶åºåˆ—ï¼ŒæŒ‰ç…§æŒ‡çš„æ ¼å¼è¯»å–åˆ°C++å¯¹åº”çš„ç»“æ„ç±»å‹ä¸­å°±å¯ä»¥äº†ã€‚ä»ä¸Šä¸€èŠ‚çš„æè¿°å¯ä»¥çœ‹åˆ°æ¶ˆæ¯çš„decodingè¿‡ç¨‹ä¹Ÿå¯ä»¥é€šè¿‡å‡ ä¸ªä½ç§»æ“ä½œç»„æˆçš„è¡¨è¾¾å¼è®¡ç®—å³å¯å®Œæˆã€‚é€Ÿåº¦éå¸¸å¿«ã€‚ T-L-Vçš„æ•°æ®å­˜å‚¨æ–¹å¼Tag-Lenght-Value,æ ‡è¯†-é•¿åº¦-å­—æ®µå€¼å­˜å‚¨æ–¹å¼ æ ‡è¯†-é•¿åº¦-å­—æ®µå€¼è¡¨ç¤ºå•ä¸ªæ•°æ®ï¼Œæœ€ç»ˆå°†æ‰€æœ‰æ•°æ®æ‹¼æ¥æˆä¸€ä¸ªå­—èŠ‚æµï¼Œä»è€Œå®ç°æ•°æ®å­˜å‚¨çš„åŠŸèƒ½ å…¶ä¸­Lengthå¯é€‰å­˜å‚¨ï¼Œå¦‚å­˜å‚¨Varintç¼–ç æ•°æ®å°±ä¸éœ€è¦å­˜å‚¨Length]]></content>
  </entry>
  <entry>
    <title><![CDATA[CameraEditor]]></title>
    <url>%2F2018%2F07%2F11%2FCameraEditor%2F</url>
    <content type="text"><![CDATA[Floder:Editor\Mono\Inspector123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705706707708709710711712713714715716717718719720721722723724725726727728729730731732733734735736737738739740741742743744745746747748// Unity C# reference source// Copyright (c) Unity Technologies. For terms of use, see// https://unity3d.com/legal/licenses/Unity_Reference_Only_Licenseusing System.Collections.Generic;using System.Text;using UnityEngine;using UnityEngine.Rendering;using AnimatedBool = UnityEditor.AnimatedValues.AnimBool;using UnityEngine.Scripting;using UnityEditor.Modules;namespace UnityEditor&#123; [CustomEditor(typeof(Camera))] [CanEditMultipleObjects] public class CameraEditor : Editor &#123; public sealed class Settings &#123; private SerializedObject m_SerializedObject; public Settings(SerializedObject so) &#123; m_SerializedObject = so; &#125; // Manually entered rendering path names/values, since we want to show them // in different order than they appear in the enum. private static readonly GUIContent[] kCameraRenderPaths = &#123; EditorGUIUtility.TrTextContent("Use Graphics Settings"), EditorGUIUtility.TrTextContent("Forward"), EditorGUIUtility.TrTextContent("Deferred"), EditorGUIUtility.TrTextContent("Legacy Vertex Lit"), EditorGUIUtility.TrTextContent("Legacy Deferred (light prepass)") &#125;; private static readonly int[] kCameraRenderPathValues = &#123; (int)RenderingPath.UsePlayerSettings, (int)RenderingPath.Forward, (int)RenderingPath.DeferredShading, (int)RenderingPath.VertexLit, (int)RenderingPath.DeferredLighting &#125;; public SerializedProperty clearFlags &#123; get; private set; &#125; public SerializedProperty backgroundColor &#123; get; private set; &#125; public SerializedProperty normalizedViewPortRect &#123; get; private set; &#125; public SerializedProperty fieldOfView &#123; get; private set; &#125; public SerializedProperty orthographic &#123; get; private set; &#125; public SerializedProperty orthographicSize &#123; get; private set; &#125; public SerializedProperty depth &#123; get; private set; &#125; public SerializedProperty cullingMask &#123; get; private set; &#125; public SerializedProperty renderingPath &#123; get; private set; &#125; public SerializedProperty occlusionCulling &#123; get; private set; &#125; public SerializedProperty targetTexture &#123; get; private set; &#125; public SerializedProperty HDR &#123; get; private set; &#125; public SerializedProperty allowMSAA &#123; get; private set; &#125; public SerializedProperty allowDynamicResolution &#123; get; private set; &#125; public SerializedProperty stereoConvergence &#123; get; private set; &#125; public SerializedProperty stereoSeparation &#123; get; private set; &#125; public SerializedProperty nearClippingPlane &#123; get; private set; &#125; public SerializedProperty farClippingPlane &#123; get; private set; &#125; public SerializedProperty targetDisplay &#123; get; private set; &#125; public SerializedProperty targetEye &#123; get; private set; &#125; private static readonly GUIContent[] kTargetEyes = &#123; EditorGUIUtility.TrTextContent("Both"), EditorGUIUtility.TrTextContent("Left"), EditorGUIUtility.TrTextContent("Right"), EditorGUIUtility.TrTextContent("None (Main Display)"), &#125;; private static readonly int[] kTargetEyeValues = &#123; (int)StereoTargetEyeMask.Both, (int)StereoTargetEyeMask.Left, (int)StereoTargetEyeMask.Right, (int)StereoTargetEyeMask.None &#125;; public void OnEnable() &#123; clearFlags = m_SerializedObject.FindProperty("m_ClearFlags"); backgroundColor = m_SerializedObject.FindProperty("m_BackGroundColor"); normalizedViewPortRect = m_SerializedObject.FindProperty("m_NormalizedViewPortRect"); nearClippingPlane = m_SerializedObject.FindProperty("near clip plane"); farClippingPlane = m_SerializedObject.FindProperty("far clip plane"); fieldOfView = m_SerializedObject.FindProperty("field of view"); orthographic = m_SerializedObject.FindProperty("orthographic"); orthographicSize = m_SerializedObject.FindProperty("orthographic size"); depth = m_SerializedObject.FindProperty("m_Depth"); cullingMask = m_SerializedObject.FindProperty("m_CullingMask"); renderingPath = m_SerializedObject.FindProperty("m_RenderingPath"); occlusionCulling = m_SerializedObject.FindProperty("m_OcclusionCulling"); targetTexture = m_SerializedObject.FindProperty("m_TargetTexture"); HDR = m_SerializedObject.FindProperty("m_HDR"); allowMSAA = m_SerializedObject.FindProperty("m_AllowMSAA"); allowDynamicResolution = m_SerializedObject.FindProperty("m_AllowDynamicResolution"); stereoConvergence = m_SerializedObject.FindProperty("m_StereoConvergence"); stereoSeparation = m_SerializedObject.FindProperty("m_StereoSeparation"); targetDisplay = m_SerializedObject.FindProperty("m_TargetDisplay"); targetEye = m_SerializedObject.FindProperty("m_TargetEye"); &#125; public void Update() &#123; m_SerializedObject.Update(); &#125; public void ApplyModifiedProperties() &#123; m_SerializedObject.ApplyModifiedProperties(); &#125; public void DrawClearFlags() &#123; EditorGUILayout.PropertyField(clearFlags, EditorGUIUtility.TextContent("Clear Flags|What to display in empty areas of this Camera's view.\n\nChoose Skybox to display a skybox in empty areas, defaulting to a background color if no skybox is found.\n\nChoose Solid Color to display a background color in empty areas.\n\nChoose Depth Only to display nothing in empty areas.\n\nChoose Don't Clear to display whatever was displayed in the previous frame in empty areas.")); &#125; public void DrawBackgroundColor() &#123; EditorGUILayout.PropertyField(backgroundColor, EditorGUIUtility.TextContent("Background|The Camera clears the screen to this color before rendering.")); &#125; public void DrawCullingMask() &#123; EditorGUILayout.PropertyField(cullingMask); &#125; public void DrawProjection() &#123; ProjectionType projectionType = orthographic.boolValue ? ProjectionType.Orthographic : ProjectionType.Perspective; EditorGUI.BeginChangeCheck(); EditorGUI.showMixedValue = orthographic.hasMultipleDifferentValues; projectionType = (ProjectionType)EditorGUILayout.EnumPopup(EditorGUIUtility.TextContent("Projection|How the Camera renders perspective.\n\nChoose Perspective to render objects with perspective.\n\nChoose Orthographic to render objects uniformly, with no sense of perspective."), projectionType); EditorGUI.showMixedValue = false; if (EditorGUI.EndChangeCheck()) orthographic.boolValue = (projectionType == ProjectionType.Orthographic); if (!orthographic.hasMultipleDifferentValues) &#123; if (projectionType == ProjectionType.Orthographic) EditorGUILayout.PropertyField(orthographicSize, new GUIContent("Size")); else EditorGUILayout.Slider(fieldOfView, 1f, 179f, EditorGUIUtility.TextContent("Field of View|The width of the Cameraâ€™s view angle, measured in degrees along the local Y axis.")); &#125; &#125; public void DrawClippingPlanes() &#123; EditorGUILayout.PropertiesField(EditorGUI.s_ClipingPlanesLabel, new[] &#123;nearClippingPlane, farClippingPlane&#125;, EditorGUI.s_NearAndFarLabels, EditorGUI.kNearFarLabelsWidth); &#125; public void DrawNormalizedViewPort() &#123; EditorGUILayout.PropertyField(normalizedViewPortRect, EditorGUIUtility.TextContent("Viewport Rect|Four values that indicate where on the screen this camera view will be drawn. Measured in Viewport Coordinates (values 0â€“1).")); &#125; public void DrawDepth() &#123; EditorGUILayout.PropertyField(depth); &#125; public void DrawRenderingPath() &#123; EditorGUILayout.IntPopup(renderingPath, kCameraRenderPaths, kCameraRenderPathValues, EditorGUIUtility.TempContent("Rendering Path")); &#125; public void DrawTargetTexture(bool deferred) &#123; EditorGUILayout.PropertyField(targetTexture); // show warning if we have deferred but manual MSAA set // only do this if the m_TargetTexture has the same values across all target cameras if (!targetTexture.hasMultipleDifferentValues) &#123; var targetTexture = this.targetTexture.objectReferenceValue as RenderTexture; if (targetTexture &amp;&amp; targetTexture.antiAliasing &gt; 1 &amp;&amp; deferred) &#123; EditorGUILayout.HelpBox("Manual MSAA target set with deferred rendering. This will lead to undefined behavior.", MessageType.Warning, true); &#125; &#125; &#125; public void DrawOcclusionCulling() &#123; EditorGUILayout.PropertyField(occlusionCulling); &#125; public void DrawHDR() &#123; EditorGUILayout.PropertyField(HDR, EditorGUIUtility.TempContent("Allow HDR")); &#125; public void DrawMSAA() &#123; EditorGUILayout.PropertyField(allowMSAA); &#125; public void DrawDynamicResolution() &#123; EditorGUILayout.PropertyField(allowDynamicResolution); &#125; public void DrawVR() &#123; if (PlayerSettings.virtualRealitySupported) &#123; EditorGUILayout.PropertyField(stereoSeparation); EditorGUILayout.PropertyField(stereoConvergence); &#125; &#125; public void DrawMultiDisplay() &#123; if (ModuleManager.ShouldShowMultiDisplayOption()) &#123; int prevDisplay = targetDisplay.intValue; EditorGUILayout.Space(); EditorGUILayout.IntPopup(targetDisplay, DisplayUtility.GetDisplayNames(), DisplayUtility.GetDisplayIndices(), EditorGUIUtility.TempContent("Target Display")); if (prevDisplay != targetDisplay.intValue) GameView.RepaintAll(); &#125; &#125; public void DrawTargetEye() &#123; EditorGUILayout.IntPopup(targetEye, kTargetEyes, kTargetEyeValues, EditorGUIUtility.TempContent("Target Eye")); &#125; &#125; private class Styles &#123; public static GUIContent iconRemove = EditorGUIUtility.IconContent("Toolbar Minus", "|Remove command buffer"); public static GUIStyle invisibleButton = "InvisibleButton"; &#125; readonly AnimatedBool m_ShowBGColorOptions = new AnimatedBool(); readonly AnimatedBool m_ShowOrthoOptions = new AnimatedBool(); readonly AnimatedBool m_ShowTargetEyeOption = new AnimatedBool(); private Camera camera &#123; get &#123; return target as Camera; &#125; &#125; private static bool IsDeferredRenderingPath(RenderingPath rp) &#123; return rp == RenderingPath.DeferredLighting || rp == RenderingPath.DeferredShading; &#125; private bool wantDeferredRendering &#123; get &#123; bool isCamDeferred = IsDeferredRenderingPath(camera.renderingPath); bool isTierDeferred = IsDeferredRenderingPath(Rendering.EditorGraphicsSettings.GetCurrentTierSettings().renderingPath); return isCamDeferred || (camera.renderingPath == RenderingPath.UsePlayerSettings &amp;&amp; isTierDeferred); &#125; &#125; enum ProjectionType &#123; Perspective, Orthographic &#125;; private Camera m_PreviewCamera; protected Camera previewCamera &#123; get &#123; if (m_PreviewCamera == null) m_PreviewCamera = EditorUtility.CreateGameObjectWithHideFlags("Preview Camera", HideFlags.HideAndDontSave, typeof(Camera), typeof(Skybox)).GetComponent&lt;Camera&gt;(); m_PreviewCamera.enabled = false; return m_PreviewCamera; &#125; &#125; private RenderTexture m_PreviewTexture; // should match color in GizmosDrawers.cpp private static readonly Color kGizmoCamera = new Color(233f / 255f, 233f / 255f, 233f / 255f, 128f / 255f); private const float kPreviewNormalizedSize = 0.2f; private bool m_CommandBuffersShown = true; private Settings m_Settings; protected Settings settings &#123; get &#123; if (m_Settings == null) m_Settings = new Settings(serializedObject); return m_Settings; &#125; &#125; bool clearFlagsHasMultipleValues &#123; get &#123; return settings.clearFlags.hasMultipleDifferentValues; &#125; &#125; bool orthographicHasMultipleValues &#123; get &#123; return settings.orthographic.hasMultipleDifferentValues; &#125; &#125; int targetEyeValue &#123; get &#123; return settings.targetEye.intValue; &#125; &#125; public void OnEnable() &#123; settings.OnEnable(); var c = (Camera)target; m_ShowBGColorOptions.value = !clearFlagsHasMultipleValues &amp;&amp; (c.clearFlags == CameraClearFlags.SolidColor || c.clearFlags == CameraClearFlags.Skybox); m_ShowOrthoOptions.value = c.orthographic; m_ShowTargetEyeOption.value = targetEyeValue != (int)StereoTargetEyeMask.Both || PlayerSettings.virtualRealitySupported; m_ShowBGColorOptions.valueChanged.AddListener(Repaint); m_ShowOrthoOptions.valueChanged.AddListener(Repaint); m_ShowTargetEyeOption.valueChanged.AddListener(Repaint); &#125; internal void OnDisable() &#123; m_ShowBGColorOptions.valueChanged.RemoveListener(Repaint); m_ShowOrthoOptions.valueChanged.RemoveListener(Repaint); m_ShowTargetEyeOption.valueChanged.RemoveListener(Repaint); &#125; public void OnDestroy() &#123; if (m_PreviewCamera != null) DestroyImmediate(m_PreviewCamera.gameObject, true); &#125; private void DepthTextureModeGUI() &#123; // Camera's depth texture mode is not serialized data, so can't get to it through // serialized property (hence no multi-edit). if (targets.Length != 1) return; var cam = target as Camera; if (cam == null || cam.depthTextureMode == DepthTextureMode.None) return; List&lt;string&gt; buffers = new List&lt;string&gt;(); if ((cam.depthTextureMode &amp; DepthTextureMode.Depth) != 0) buffers.Add("Depth"); if ((cam.depthTextureMode &amp; DepthTextureMode.DepthNormals) != 0) buffers.Add("DepthNormals"); if ((cam.depthTextureMode &amp; DepthTextureMode.MotionVectors) != 0) buffers.Add("MotionVectors"); if (buffers.Count == 0) return; StringBuilder sb = new StringBuilder("Info: renders "); for (int i = 0; i &lt; buffers.Count; ++i) &#123; if (i != 0) sb.Append(" &amp; "); sb.Append(buffers[i]); &#125; sb.Append(buffers.Count &gt; 1 ? " textures" : " texture"); EditorGUILayout.HelpBox(sb.ToString(), MessageType.None, true); &#125; static Rect GetRemoveButtonRect(Rect r) &#123; var buttonSize = Styles.invisibleButton.CalcSize(Styles.iconRemove); return new Rect(r.xMax - buttonSize.x, r.y + (int)(r.height / 2 - buttonSize.y / 2), buttonSize.x, buttonSize.y); &#125; /** * Draws the 2D bounds of the camera when in 2D mode. */ [DrawGizmo(GizmoType.NonSelected)] static void DrawCameraBound(Camera camera, GizmoType gizmoType) &#123; var sv = SceneView.currentDrawingSceneView; if (sv != null &amp;&amp; sv.in2DMode) &#123; if (camera == Camera.main &amp;&amp; camera.orthographic) CameraEditor.RenderGizmo(camera); &#125; &#125; private void CommandBufferGUI() &#123; // Command buffers are not serialized data, so can't get to them through // serialized property (hence no multi-edit). if (targets.Length != 1) return; var cam = target as Camera; if (cam == null) return; int count = cam.commandBufferCount; if (count == 0) return; m_CommandBuffersShown = GUILayout.Toggle(m_CommandBuffersShown, GUIContent.Temp(count + " command buffers"), EditorStyles.foldout); if (!m_CommandBuffersShown) return; EditorGUI.indentLevel++; foreach (CameraEvent ce in (CameraEvent[])System.Enum.GetValues(typeof(CameraEvent))) &#123; CommandBuffer[] cbs = cam.GetCommandBuffers(ce); foreach (CommandBuffer cb in cbs) &#123; using (new GUILayout.HorizontalScope()) &#123; // row with event &amp; command buffer information label Rect rowRect = GUILayoutUtility.GetRect(GUIContent.none, EditorStyles.miniLabel); rowRect.xMin += EditorGUI.indent; Rect minusRect = GetRemoveButtonRect(rowRect); rowRect.xMax = minusRect.x; GUI.Label(rowRect, string.Format("&#123;0&#125;: &#123;1&#125; (&#123;2&#125;)", ce, cb.name, EditorUtility.FormatBytes(cb.sizeInBytes)), EditorStyles.miniLabel); // and a button to remove it if (GUI.Button(minusRect, Styles.iconRemove, Styles.invisibleButton)) &#123; cam.RemoveCommandBuffer(ce, cb); SceneView.RepaintAll(); GameView.RepaintAll(); GUIUtility.ExitGUI(); &#125; &#125; &#125; &#125; // "remove all" button using (new GUILayout.HorizontalScope()) &#123; GUILayout.FlexibleSpace(); if (GUILayout.Button("Remove all", EditorStyles.miniButton)) &#123; cam.RemoveAllCommandBuffers(); SceneView.RepaintAll(); GameView.RepaintAll(); &#125; &#125; EditorGUI.indentLevel--; &#125; public override void OnInspectorGUI() &#123; settings.Update(); var c = (Camera)target; m_ShowBGColorOptions.target = !clearFlagsHasMultipleValues &amp;&amp; (c.clearFlags == CameraClearFlags.SolidColor || c.clearFlags == CameraClearFlags.Skybox); m_ShowOrthoOptions.target = !orthographicHasMultipleValues &amp;&amp; c.orthographic; m_ShowTargetEyeOption.target = targetEyeValue != (int)StereoTargetEyeMask.Both || PlayerSettings.virtualRealitySupported; settings.DrawClearFlags(); if (EditorGUILayout.BeginFadeGroup(m_ShowBGColorOptions.faded)) settings.DrawBackgroundColor(); EditorGUILayout.EndFadeGroup(); settings.DrawCullingMask(); EditorGUILayout.Space(); settings.DrawProjection(); settings.DrawClippingPlanes(); settings.DrawNormalizedViewPort(); EditorGUILayout.Space(); settings.DrawDepth(); settings.DrawRenderingPath(); if (m_ShowOrthoOptions.target &amp;&amp; wantDeferredRendering) EditorGUILayout.HelpBox("Deferred rendering does not work with Orthographic camera, will use Forward.", MessageType.Warning, true); settings.DrawTargetTexture(wantDeferredRendering); settings.DrawOcclusionCulling(); settings.DrawHDR(); settings.DrawMSAA(); settings.DrawDynamicResolution(); DisplayCameraWarnings(); settings.DrawVR(); settings.DrawMultiDisplay(); if (EditorGUILayout.BeginFadeGroup(m_ShowTargetEyeOption.faded)) settings.DrawTargetEye(); EditorGUILayout.EndFadeGroup(); DepthTextureModeGUI(); CommandBufferGUI(); serializedObject.ApplyModifiedProperties(); &#125; private void DisplayCameraWarnings() &#123; Camera camera = target as Camera; if (camera != null) &#123; string[] warnings = camera.GetCameraBufferWarnings(); if (warnings.Length &gt; 0) EditorGUILayout.HelpBox(string.Join("\n\n", warnings), MessageType.Warning, true); &#125; &#125; public virtual void OnOverlayGUI(Object target, SceneView sceneView) &#123; if (target == null) return; // cache some deep values var c = (Camera)target; Vector2 previewSize = GameView.GetMainGameViewTargetSize(); if (previewSize.x &lt; 0f) &#123; // Fallback to Scene View of not a valid game view size previewSize.x = sceneView.position.width; previewSize.y = sceneView.position.height; &#125; // Apply normalizedviewport rect of camera Rect normalizedViewPortRect = c.rect; previewSize.x *= Mathf.Max(normalizedViewPortRect.width, 0f); previewSize.y *= Mathf.Max(normalizedViewPortRect.height, 0f); // Prevent using invalid previewSize if (previewSize.x &lt;= 0f || previewSize.y &lt;= 0f) return; float aspect = previewSize.x / previewSize.y; // Scale down (fit to scene view) previewSize.y = kPreviewNormalizedSize * sceneView.position.height; previewSize.x = previewSize.y * aspect; if (previewSize.y &gt; sceneView.position.height * 0.5f) &#123; previewSize.y = sceneView.position.height * 0.5f; previewSize.x = previewSize.y * aspect; &#125; if (previewSize.x &gt; sceneView.position.width * 0.5f) &#123; previewSize.x = sceneView.position.width * 0.5f; previewSize.y = previewSize.x / aspect; &#125; // Get and reserve rect Rect cameraRect = GUILayoutUtility.GetRect(previewSize.x, previewSize.y); if (Event.current.type == EventType.Repaint) &#123; // setup camera and render previewCamera.CopyFrom(c); // also make sure to sync any Skybox component on the preview camera var dstSkybox = previewCamera.GetComponent&lt;Skybox&gt;(); if (dstSkybox) &#123; var srcSkybox = c.GetComponent&lt;Skybox&gt;(); if (srcSkybox &amp;&amp; srcSkybox.enabled) &#123; dstSkybox.enabled = true; dstSkybox.material = srcSkybox.material; &#125; else &#123; dstSkybox.enabled = false; &#125; &#125; var previewTexture = GetPreviewTextureWithSize((int)cameraRect.width, (int)cameraRect.height); previewTexture.antiAliasing = Mathf.Max(1, QualitySettings.antiAliasing); previewCamera.targetTexture = previewTexture; previewCamera.pixelRect = new Rect(0, 0, cameraRect.width, cameraRect.height); Handles.EmitGUIGeometryForCamera(c, previewCamera); GL.sRGBWrite = QualitySettings.activeColorSpace == ColorSpace.Linear; previewCamera.Render(); GL.sRGBWrite = false; Graphics.DrawTexture(cameraRect, previewTexture, new Rect(0, 0, 1, 1), 0, 0, 0, 0, GUI.color, EditorGUIUtility.GUITextureBlit2SRGBMaterial); &#125; &#125; private RenderTexture GetPreviewTextureWithSize(int width, int height) &#123; if (m_PreviewTexture == null || m_PreviewTexture.width != width || m_PreviewTexture.height != height) &#123; m_PreviewTexture = new RenderTexture(width, height, 24, RenderTextureFormat.Default, RenderTextureReadWrite.Linear); &#125; return m_PreviewTexture; &#125; [RequiredByNativeCode] static float GetGameViewAspectRatio() &#123; Vector2 gameViewSize = GameView.GetMainGameViewTargetSize(); if (gameViewSize.x &lt; 0f) &#123; // Fallback to Scene View of not a valid game view size gameViewSize.x = Screen.width; gameViewSize.y = Screen.height; &#125; return gameViewSize.x / gameViewSize.y; &#125; static float GetFrustumAspectRatio(Camera camera) &#123; Rect normalizedViewPortRect = camera.rect; if (normalizedViewPortRect.width &lt;= 0f || normalizedViewPortRect.height &lt;= 0f) return -1f; float viewportAspect = normalizedViewPortRect.width / normalizedViewPortRect.height; return GetGameViewAspectRatio() * viewportAspect; &#125; // Returns near- and far-corners in this order: leftBottom, leftTop, rightTop, rightBottom // Assumes input arrays are of length 4 (if allocated) static bool GetFrustum(Camera camera, Vector3[] near, Vector3[] far, out float frustumAspect) &#123; frustumAspect = GetFrustumAspectRatio(camera); if (frustumAspect &lt; 0) return false; if (far != null) &#123; far[0] = new Vector3(0, 0, camera.farClipPlane); // leftBottomFar far[1] = new Vector3(0, 1, camera.farClipPlane); // leftTopFar far[2] = new Vector3(1, 1, camera.farClipPlane); // rightTopFar far[3] = new Vector3(1, 0, camera.farClipPlane); // rightBottomFar for (int i = 0; i &lt; 4; ++i) far[i] = camera.ViewportToWorldPoint(far[i]); &#125; if (near != null) &#123; near[0] = new Vector3(0, 0, camera.nearClipPlane); // leftBottomNear near[1] = new Vector3(0, 1, camera.nearClipPlane); // leftTopNear near[2] = new Vector3(1, 1, camera.nearClipPlane); // rightTopNear near[3] = new Vector3(1, 0, camera.nearClipPlane); // rightBottomNear for (int i = 0; i &lt; 4; ++i) near[i] = camera.ViewportToWorldPoint(near[i]); &#125; return true; &#125; // Called from C++ when we need to render a Camera's gizmo internal static void RenderGizmo(Camera camera) &#123; var near = new Vector3[4]; var far = new Vector3[4]; float frustumAspect; if (GetFrustum(camera, near, far, out frustumAspect)) &#123; Color orgColor = Handles.color; Handles.color = kGizmoCamera; for (int i = 0; i &lt; 4; ++i) &#123; Handles.DrawLine(near[i], near[(i + 1) % 4]); Handles.DrawLine(far[i], far[(i + 1) % 4]); Handles.DrawLine(near[i], far[i]); &#125; Handles.color = orgColor; &#125; &#125; static bool IsViewPortRectValidToRender(Rect normalizedViewPortRect) &#123; if (normalizedViewPortRect.width &lt;= 0f || normalizedViewPortRect.height &lt;= 0f) return false; if (normalizedViewPortRect.x &gt;= 1f || normalizedViewPortRect.xMax &lt;= 0f) return false; if (normalizedViewPortRect.y &gt;= 1f || normalizedViewPortRect.yMax &lt;= 0f) return false; return true; &#125; public virtual void OnSceneGUI() &#123; var c = (Camera)target; if (!IsViewPortRectValidToRender(c.rect)) return; SceneViewOverlay.Window(EditorGUIUtility.TrTextContent("Camera Preview"), OnOverlayGUI, (int)SceneViewOverlay.Ordering.Camera, target, SceneViewOverlay.WindowDisplayOption.OneWindowPerTarget); Color orgHandlesColor = Handles.color; Color slidersColor = kGizmoCamera; slidersColor.a *= 2f; Handles.color = slidersColor; // get the corners of the far clip plane in world space var far = new Vector3[4]; float frustumAspect; if (!GetFrustum(c, null, far, out frustumAspect)) return; Vector3 leftBottomFar = far[0]; Vector3 leftTopFar = far[1]; Vector3 rightTopFar = far[2]; Vector3 rightBottomFar = far[3]; // manage our own gui changed state, so we can use it for individual slider changes bool guiChanged = GUI.changed; // FOV handles Vector3 farMid = Vector3.Lerp(leftBottomFar, rightTopFar, 0.5f); // Top and bottom handles float halfHeight = -1.0f; Vector3 changedPosition = MidPointPositionSlider(leftTopFar, rightTopFar, c.transform.up); if (!GUI.changed) changedPosition = MidPointPositionSlider(leftBottomFar, rightBottomFar, -c.transform.up); if (GUI.changed) halfHeight = (changedPosition - farMid).magnitude; // Left and right handles GUI.changed = false; changedPosition = MidPointPositionSlider(rightBottomFar, rightTopFar, c.transform.right); if (!GUI.changed) changedPosition = MidPointPositionSlider(leftBottomFar, leftTopFar, -c.transform.right); if (GUI.changed) halfHeight = (changedPosition - farMid).magnitude / frustumAspect; // Update camera settings if changed if (halfHeight &gt;= 0.0f) &#123; Undo.RecordObject(c, "Adjust Camera"); if (c.orthographic) &#123; c.orthographicSize = halfHeight; &#125; else &#123; Vector3 pos = farMid + c.transform.up * halfHeight; c.fieldOfView = Vector3.Angle(c.transform.forward, (pos - c.transform.position)) * 2f; &#125; guiChanged = true; &#125; GUI.changed = guiChanged; Handles.color = orgHandlesColor; &#125; private static Vector3 MidPointPositionSlider(Vector3 position1, Vector3 position2, Vector3 direction) &#123; Vector3 midPoint = Vector3.Lerp(position1, position2, 0.5f); return Handles.Slider(midPoint, direction, HandleUtility.GetHandleSize(midPoint) * 0.03f, Handles.DotHandleCap, 0f); &#125; &#125;&#125;]]></content>
      <tags>
        <tag>UnityCsReference</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç®—æ³•]]></title>
    <url>%2F2018%2F07%2F09%2Farithmetic%2F</url>
    <content type="text"><![CDATA[èƒŒåŒ…é—®é¢˜]]></content>
      <tags>
        <tag>arithmetic</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[C++11]]></title>
    <url>%2F2018%2F07%2F09%2FC%2B%2B11%2F</url>
    <content type="text"><![CDATA[è™šå‡½æ•° å¯¹äºä¸€ä¸ªclassï¼Œäº§ç”Ÿä¸€å †æŒ‡å‘virtual functionsçš„æŒ‡é’ˆï¼Œè™šå‡½æ•°è¡¨æŒ‡é’ˆé€šå¸¸æ”¾åœ¨å¯¹è±¡å®ä¾‹çš„æœ€å‰é¢çš„ä½ç½®ã€‚ æ¯ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ç›¸å…³çš„virtual tableã€‚è¿™ä¸ªæŒ‡é’ˆè¢«ç§°ä½œè™šå‡½æ•°è¡¨æŒ‡é’ˆã€‚]]></content>
      <categories>
        <category>C++</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[presentandsync]]></title>
    <url>%2F2018%2F07%2F05%2Fpresentandsync%2F</url>
    <content type="text"><![CDATA[WaitForTargetFPSè¯¥å‚æ•°ä¸€èˆ¬å‡ºç°åœ¨CPUå¼€é”€è¿‡ä½ï¼Œä¸”é€šè¿‡è®¾å®šäº†ç›®æ ‡å¸§ç‡åœ°æƒ…å†µä¸‹(Application.targetFrameRate)ã€‚å½“ä¸Šä¸€å¸§äº§ç”Ÿä¸€ä¸ªWaitForTargetFPSåœ°ç©ºé—²ç­‰å¾…æ¶ˆè€—æ—¶ï¼Œä»¥ç»´æŒç›®æ ‡å¸§ç‡ã€‚ è§£æï¼šè¯¥é¡¹åœ¨Unityå¼•æ“åœ°ä¸»å¾ªç¯ä¸­å…¶å®æ˜¯æœ€æ—©æ‰§è¡Œåœ°ï¼Œå³å¼•æ“å®é™…ä¸Šæ˜¯æ ¹æ®ä¸Šä¸€å¸§åœ°CPUè€—æ—¶ï¼Œåœ¨å½“å‰å¸§é€šè¿‡å¢è¡¥WaitForTargetFPSçš„æ–¹å¼æ¥å°†è¿è¡ŒFPSç»´æŒåˆ°ç›®æ ‡å€¼ã€‚æ¯”å¦‚ï¼Œç›®æ ‡å¸§ç‡ä¸º30å¸§/ç§’ï¼Œä¸Šä¸€å¸§è€—æ—¶15msï¼Œé‚£ä¹ˆå½“å‰å¸§ä¸­WaitForTargetFPSå°†ä¼šæ˜¯18ï¼ˆ33-15ï¼‰msï¼Œä½†æ˜¯è¿™ä¸€å¸§ä¸­å…¶ä»–è€—æ—¶ä¸º28msï¼Œé‚£ä¹ˆåœ¨Profilerä¸­è¿™ä¸€å¸§çš„æ€»è€—æ—¶å°±å˜æˆäº†46ï¼ˆ18+28ï¼‰msã€‚å› æ­¤ï¼Œç”±è¯¥å€¼é€ æˆäº†Profilerå¼€é”€è¾ƒé«˜çš„ç°è±¡ï¼Œå…¶å®æ˜¯è€—æ—¶çš„â€œå‡è±¡â€ï¼Œåœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œä½ å¯¹å®ƒå¯ä»¥â€œè§†è€Œä¸è§â€ã€‚ Gfx.WaitForPresend &amp;&amp; Graphics.PresentAndSyncè¿™ä¸¤ä¸ªå‚æ•°åœ¨Profilerä¸­ç»å¸¸å‡ºç°CPUå ç”¨è¾ƒé«˜çš„æƒ…å†µï¼Œä¸”ä»…åœ¨å‘å¸ƒç‰ˆæœ¬ä¸­å¯ä»¥çœ‹åˆ°ã€‚ç©¶å…¶åŸå› ï¼Œå…¶å®æ˜¯CPUå’ŒGPUä¹‹é—´å‚ç›´åŒæ­¥ï¼ˆVSyncï¼‰å¯¼è‡´çš„ï¼Œä¹‹æ‰€ä»¥ä¼šæœ‰ä¸¤ç§å‚æ•°ï¼Œä¸»è¦æ˜¯ä¸é¡¹ç›®æ˜¯å¦å¼€å¯å¤šçº¿ç¨‹æ¸²æŸ“æœ‰å…³ã€‚å½“é¡¹ç›®å¼€å¯å¤šçº¿ç¨‹æ¸²æŸ“æ—¶ï¼Œä½ çœ‹åˆ°çš„æ˜¯Gfx.WaitForPresentï¼›å½“é¡¹ç›®æœªå¼€å¯å¤šçº¿ç¨‹æ¸²æŸ“æ—¶ï¼Œçœ‹åˆ°çš„åˆ™æ˜¯Graphics.PresentAndSyncã€‚ Graphics.PresentAndSyncæ˜¯æŒ‡ä¸»çº¿ç¨‹è¿›è¡ŒPresentæ—¶çš„ç­‰å¾…æ—¶é—´å’Œç­‰å¾…å‚ç›´åŒæ­¥çš„æ—¶é—´ã€‚ Gfx.WaitForPresentå…¶å­—é¢æ„æ€åŒæ ·ä¹Ÿæ˜¯è¿›è¡ŒPresentæ—¶éœ€è¦ç­‰å¾…çš„æ—¶é—´ï¼Œä½†è¿™é‡Œå…¶å®çœç•¥äº†å¾ˆå¤šçš„å†…å®¹ï¼Œå…¶çœŸå®çš„æ„æ€åº”è¯¥æ˜¯ä¸ºäº†åœ¨æ¸²æŸ“å­çº¿ç¨‹ï¼ˆRendering Threadï¼‰ä¸­è¿›è¡ŒPresendï¼Œå½“å‰ä¸»çº¿ç¨‹ï¼ˆMainThreadï¼‰éœ€è¦ç­‰å¾…çš„æ—¶é—´ã€‚]]></content>
      <tags>
        <tag>uwa</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[optimzation_memory_1]]></title>
    <url>%2F2018%2F07%2F05%2Foptimzation-memory-1%2F</url>
    <content type="text"><![CDATA[å†…å­˜å¼€é”€ï¼š èµ„æºå†…å­˜å ç”¨åœ¨ä¸€ä¸ªè¾ƒä¸ºå¤æ‚çš„å¤§ä¸­å‹é¡¹ç›®ä¸­ï¼Œèµ„æºçš„å†…å­˜å ç”¨å¾€å¾€å æ®äº†æ€»ä½“å†…å­˜çš„70%ä»¥ä¸Šã€‚å› æ­¤ï¼Œèµ„æºä½¿ç”¨æ˜¯å¦æ°å½“ç›´æ¥å†³å®šäº†é¡¹ç›®çš„å†…å­˜å ç”¨æƒ…å†µã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¸€æ¬¾æ¸¸æˆé¡¹ç›®çš„èµ„æºä¸»è¦å¯åˆ†ä¸ºå¦‚ä¸‹å‡ ç§ï¼šçº¹ç†ï¼ˆTextureï¼‰ã€ç½‘æ ¼ï¼ˆMeshï¼‰ã€åŠ¨ç”»ç‰‡æ®µï¼ˆAnimationClipï¼‰ã€éŸ³é¢‘ç‰‡æ®µï¼ˆAudioClipï¼‰ã€æè´¨ï¼ˆMaterialï¼‰ã€ç€è‰²å™¨ï¼ˆShaderï¼‰ã€å­—ä½“èµ„æºï¼ˆFontï¼‰ä»¥åŠæ–‡æœ¬èµ„æºï¼ˆText Assetï¼‰ç­‰ç­‰ã€‚å…¶ä¸­ï¼Œçº¹ç†ã€ç½‘æ ¼ã€åŠ¨ç”»ç‰‡æ®µå’ŒéŸ³é¢‘ç‰‡æ®µåˆ™æ˜¯æœ€å®¹æ˜“é€ æˆè¾ƒå¤§å†…å­˜å¼€é”€çš„èµ„æºã€‚ ä¸€ã€çº¹ç†çº¹ç†èµ„æºå¯ä»¥è¯´æ˜¯å‡ ä¹æ‰€æœ‰æ¸¸æˆé¡¹ç›®ä¸­å æ®æœ€å¤§å†…å­˜å¼€é”€çš„èµ„æºã€‚ä¸€ä¸ª6ä¸‡é¢ç‰‡çš„åœºæ™¯ï¼Œç½‘æ ¼èµ„æºæœ€å¤§æ‰ä¸è¿‡10MBï¼Œä½†ä¸€ä¸ª2048x2048çš„çº¹ç†ï¼Œå¯èƒ½ç›´æ¥å°±è¾¾åˆ°16MBã€‚å› æ­¤ï¼Œé¡¹ç›®ä¸­çº¹ç†èµ„æºçš„ä½¿ç”¨æ˜¯å¦å¾—å½“ä¼šæå¤§åœ°å½±å“é¡¹ç›®åœ°å†…å­˜å ç”¨ã€‚ çº¹ç†æ ¼å¼çº¹ç†æ ¼å¼æ˜¯ç ”å‘å›¢é˜Ÿæœ€éœ€è¦å…³æ³¨çš„çº¹ç†å±æ€§ã€‚å› ä¸ºå®ƒä¸ä»…å½±å“ç€çº¹ç†çš„å†…å­˜å ç”¨ï¼ŒåŒæ—¶è¿˜å†³å®šäº†çº¹ç†çš„åŠ è½½æ•ˆç‡ã€‚åœ¨ä½¿ç”¨ç¡¬ä»¶æ”¯æŒçš„çº¹ç†æ ¼å¼æ—¶ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š è‰²é˜¶é—®é¢˜ ç”±äºETXã€PVRTCç­‰æ ¼å¼å‡ä¸ºæœ‰æŸå‹ç¼©ï¼Œå› æ­¤ï¼Œå½“çº¹ç†è‰²æŸ¥èŒƒå›´è·¨åº¦è¾ƒå¤§æ—¶ï¼Œå‡ä¸å¯é¿å…åœ°é€ æˆä¸åŒç¨‹åº¦åœ°â€œé˜¶æ¢¯â€çŠ¶çš„è‰²é˜¶é—®é¢˜ã€‚å› æ­¤ï¼Œå¾ˆå¤šç ”å‘å›¢é˜Ÿä½¿ç”¨RGBA32/ARGB32æ ¼å¼æ¥å®ç°æ›´å¥½çš„æ•ˆæœã€‚ä½†æ˜¯ï¼Œè¿™ç§åšæ³•å°†é€ æˆå¾ˆå¤§çš„å†…å­˜å ç”¨ã€‚æ¯”å¦‚ï¼ŒåŒæ ·ä¸€å¼ 1024x1024çš„çº¹ç†ï¼Œå¦‚æœä¸å¼€å¯Mipmapï¼Œå¹¶ä¸”PVRTCæ ¼å¼ï¼Œåˆ™å…¶å†…å­˜å ç”¨ä¸º512KBï¼Œè€Œå¦‚æœè½¬æ¢ä¸ºRGBA32ä½ï¼Œåˆ™å¾ˆå¯èƒ½å ç”¨è¾¾åˆ°4MBã€‚ ETC1ä¸æ”¯æŒé€æ˜é€šé“é—®é¢˜ åœ¨Andoridå¹³å°ä¸Šï¼Œå¯¹äºä½¿ç”¨OpenGL ES 2.0çš„è®¾å¤‡ï¼Œå…¶çº¹ç†æ ¼å¼ä»…èƒ½æ”¯æŒETC1æ ¼å¼ï¼Œè¯¥æ ¼å¼æœ‰ä¸ªè¾ƒä¸ºä¸¥é‡çš„é—®é¢˜ï¼Œå³ä¸æ”¯æŒAlphaé€æ˜é€šé“ï¼Œä½¿å¾—é€æ˜è´´å›¾æ— æ³•ç›´æ¥é€šè¿‡ETC1æ ¼å¼æ¥è¿›è¡Œå‚¨å­˜ã€‚å¯¹æ­¤ï¼Œæˆ‘ä»¬å»ºè®®ç ”å‘å›¢é˜Ÿå°†é€æ˜è´´å›¾å°½å¯èƒ½æ‹†åˆ†æˆä¸¤å¼ ï¼Œå³ä¸€å¼ RGB24ä½çº¹ç†è®°å½•åŸå§‹çº¹ç†çš„é¢œè‰²éƒ¨åˆ†å’Œä¸€å¼ Alpha8çº¹ç†è®°å½•åŸå§‹çº¹ç†çš„é€æ˜é€šé“éƒ¨åˆ†ã€‚ç„¶åï¼Œå°†è¿™ä¸¤å¼ è´´å›¾åˆ†åˆ«è½¬åŒ–ä¸ºETC1æ ¼å¼çš„çº¹ç†ï¼Œå¹¶é€šè¿‡ç‰¹å®šçš„Shaderæ¥è¿›è¡Œæ¸²æŸ“ï¼Œä»è€Œè¾¾åˆ°æ”¯æŒé€æ˜è´´å›¾çš„æ•ˆæœã€‚è¿™ç§æ–¹æ³•æå¤§ç¨‹åº¦ä¼¤æ¯•ç«ŸRGBAé€æ˜è´´å›¾çš„æ¸²æŸ“æ•ˆæœï¼ŒåŒæ—¶é™ä½çº¹ç†çš„å†…å­˜å ç”¨ã€‚ çº¹ç†å°ºå¯¸ä¸€èˆ¬æ¥è¯´ï¼Œçº¹ç†å°ºå¯¸è¶Šå¤§ï¼Œåˆ™å†…å­˜å ç”¨è¶Šå¤§ã€‚æ‰€ä»¥ï¼Œå°½å¯èƒ½é™ä½çº¹ç†å°ºå¯¸ï¼Œå¦‚æœ512x512çš„çº¹ç†å¯¹äºæ˜¾ç¤ºæ•ˆæœå·²ç»å¤Ÿç”¨ï¼Œé‚£ä¹ˆå°±ä¸è¦ä½¿ç”¨1024x1024çš„çº¹ç†ï¼Œå› ä¸ºåè€…çš„å†…å­˜å ç”¨æ—¶å‰è€…çš„4å€ã€‚ MipmapåŠŸèƒ½Mipmapæ—¨åœ¨æœ‰æ•ˆé™ä½æ¸²æŸ“å¸¦å®½çš„å‹åŠ›ï¼Œæå‡æ¸¸æˆçš„æ¸²æŸ“æ•ˆç‡ã€‚ä½†æ˜¯ï¼Œå¼€å¯Mipmapä¼šå°†çº¹ç†å†…å­˜æå‡1.33å€ã€‚å¯¹äºå…·æœ‰è¾ƒå¤§çºµæ·±æ„Ÿçš„3Dæ¸¸æˆæ¥è¯´ï¼Œ3Dåœºæ™¯æ¨¡å‹å’Œè§’è‰²æˆ‘ä»¬ä¸€èˆ¬æ˜¯å»ºè®®å¼€å¯MipmapåŠŸèƒ½çš„ï¼Œè€Œç»å¤§å¤šæ•°UIå‡æ˜¯æ¸²æŸ“åœ¨å±å¹•æœ€ä¸Šå±‚ï¼Œå¼€å¯Mipmapå¹¶ä¸ä¼šæå‡æ¸²æŸ“æ•ˆç‡ï¼Œåå€’ä¼šå¢åŠ æ— è°“çš„å†…å­˜å ç”¨ã€‚ Read &amp; Writeä¸€èˆ¬æƒ…å†µä¸‹ï¼Œçº¹ç†èµ„æºçš„â€Read &amp; Writeâ€åŠŸèƒ½åœ¨Unityå¼•æ“ä¸­é»˜è®¤æ˜¯å…³é—­çš„ã€‚å¼€å¯è¯¥é€‰é¡¹å°†ä¼šä½¿çº¹ç†å†…å­˜å¢å¤§ä¸€å€ã€‚ äºŒã€ç½‘æ ¼Normalã€Colorå’ŒTangentMeshèµ„æºçš„æ•°æ®ä¸­ç»å¸¸ä¼šå«æœ‰å¤§é‡çš„Coloræ•°æ®ã€Normalæ•°æ®å’ŒTangentæ•°æ®ã€‚è¿™äº›æ•°æ®çš„å­˜åœ¨å°†å¤§å¹…åº¦å¢åŠ Meshèµ„æºçš„æ–‡ä»¶æåŠå’Œå†…å­˜å ç”¨ã€‚å…¶ä¸­ï¼ŒColoræ•°æ®å’ŒNormalæ•°æ®ä¸»è¦ä¸º3DMaxã€Mayaç­‰å»ºæ¨¡è½¯ä»¶å¯¼å‡ºæ—¶è®¾ç½®æ‰€ç”Ÿæˆï¼Œè€ŒTangentä¸€èˆ¬ä¸ºå¯¼å…¥å¼•æ“çš„ç”Ÿæˆã€‚ æ›´ä¸ºéº»çƒ¦çš„æ˜¯ï¼Œå¦‚æœé¡¹ç›®å¯¹Meshè¿›è¡ŒDraw Call Batchingæ“ä½œçš„è¯ï¼Œé‚£ä¹ˆå°†å¾ˆæœ‰å¯èƒ½è¿›ä¸€æ­¥å¢å¤§æ€»ä½“å†…å­˜çš„å ç”¨ã€‚æ¯”å¦‚ï¼Œ100ä¸ªMeshè¿›è¡Œæ‹¼åˆï¼Œå…¶ä¸­99ä¸ªMeshå‡æ²¡æœ‰Colorã€Tangentç­‰å±æ€§ï¼Œå‰©ä¸‹ä¸€ä¸ªåˆ™åŒ…å«æœ‰Colorã€Normalå’ŒTangentå±æ€§ï¼Œé‚£ä¹ˆMeshæ‹¼åˆåï¼ŒCombinedMeshä¸­å°†ä¸ºæ¯ä¸ªMeshæ¥æ·»åŠ ä¸Šæ­¤ä¸‰ä¸ªé¡¶ç‚¹å±æ€§ï¼Œè¿›è€Œé€ æˆå¾ˆå¤§çš„å†…å­˜å¼€é”€ã€‚ å¼•æ“æ¨¡å—è‡ªèº«å†…å­˜å ç”¨å¼•æ“è‡ªèº«ä¸­å­˜åœ¨å†…å­˜å¼€é”€çš„éƒ¨åˆ†çº·ç¹å¤æ‚ï¼Œå¯ä»¥è¯´æ˜¯ç”±å·¨é‡â€œå¾®å°â€å†…å­˜æ‰€ç§¯ç´¯èµ·æ¥çš„ï¼Œæ¯”å¦‚GameObjectåŠå…¶å„ç§Componentï¼ˆé‡æœ€å¤§çš„Componentåº”è¯¥ç®—æ˜¯Transformï¼‰äº†ã€ParticleSystemã€MonoScriptä»¥åŠå„ç§å„æ ·çš„æ¨¡å—Managerï¼ˆSceneManagerã€CanvasManagerã€PersistentManagerï¼‰ç­‰ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸Šé¢æ‰€æŒ‡å‡ºçš„å¼•æ“å„ç»„æˆéƒ¨åˆ†çš„å†…å­˜å¼€é”€å‡æ¯”è¾ƒå°ï¼ŒçœŸæ­£å æ®è¾ƒå¤§å†…å­˜å¼€é”€çš„è¿™ä¸¤å¤„ï¼šWebStreamå’ŒSerializedFileã€‚å…¶ç»å¤§éƒ¨åˆ†çš„å†…å­˜åˆ†é…åˆ™æ˜¯ç”±AssetBundleåŠ è½½èµ„æºæ‰€è‡´ã€‚å½“ä½¿ç”¨new WWWæˆ–CreateFromMemoryæ¥åŠ è½½AssetBundleæ—¶ï¼ŒUnityå¼•æ“ä¼šåŠ è½½åŸå§‹æ•°æ®åˆ°å†…å­˜ä¸­å¹¶å¯¹å…¶è¿›è¡Œè§£å‹ï¼Œè€ŒWebStreamçš„å¤§å°åˆ™æ˜¯AssetBundleåŸå§‹æ–‡ä»¶å¤§å°+è§£å‹åçš„æ•°æ®å¤§å°+DecompressionBuffer(0.5MB)ã€‚åŒæ—¶ï¼Œç”±äºUnity5.3ç‰ˆæœ¬ä¹‹å‰çš„AssetBundleæ–‡ä»¶ä¸ºLZMAå‹ç¼©ï¼Œå…¶å‹ç¼©æ¯”ç±»ä¼¼äºZip(20%-50%)ï¼Œæ‰€ä»¥å¯¹äº1MBçš„åŸå§‹AssetBundleæ–‡ä»¶ï¼Œå…¶åŠ è½½åWebStreamçš„å¤§å°åˆ™å¯èƒ½æ—¶5~6MBï¼Œå› æ­¤ï¼Œå½“é¡¹ç›®ä¸­é€šè¿‡new WWWåŠ è½½å¤šä¸ªAssetBundleæ–‡ä»¶ï¼Œä¸”AssetBundleåˆæ— æ³•å³æ—¶é‡Šæ”¾æ—¶ï¼ŒWebStreamçš„å†…å­˜å¯èƒ½ä¼šå¾ˆå¤§ã€‚ å¯¹äºSerilizedFileï¼Œåˆ™æ˜¯å½“ä½ ä½¿ç”¨LoadFromCacheOrDownloadã€CreateFromFileæˆ–new WWWæœ¬åœ°AssetBundleæ–‡ä»¶æ—¶äº§ç”Ÿçš„åºåˆ—åŒ–æ–‡ä»¶ã€‚ å¯¹äºWebStreamå’ŒSerializedFileï¼Œéœ€è¦å…³æ³¨ä¸¤ç‚¹ï¼š æ˜¯å¦å­˜åœ¨AssetBundleæ²¡æœ‰è¢«æ¸…ç†å¹²å‡€çš„æƒ…å†µã€‚å¯ä»¥é€šè¿‡Unity Profilerç›´æ¥æŸ¥çœ‹å…¶å…·ä½“çš„ä½¿ç”¨æƒ…å†µï¼Œå¹¶ç¡®å®šTake Sampleæ—¶AssetBundleçš„å­˜åœ¨æ˜¯å¦åˆç†ï¼› å¯¹äºå ç”¨WebStreamè¾ƒå¤§çš„AssetBundleæ–‡ä»¶ï¼ˆå¦‚UI Atlasç›¸å…³çš„AssetBundleæ–‡ä»¶ç­‰ï¼‰ï¼Œå»ºè®®ä½¿ç”¨LoadFromCacheOrDownLoadæˆ–CreateFromFileæ¥æ›¿æ¢ï¼Œå³å°†è§£å‹åçš„AssetBundleæ•°æ®å­˜å‚¨ä¸æœ¬åœ°Cacheä¸­è¿›è¡Œä½¿ç”¨ã€‚è¿™ç§åšæ³•éå¸¸é€‚åˆäºå†…å­˜ç‰¹åˆ«åƒç´§çš„é¡¹ç›®ï¼Œå³é€šè¿‡æœ¬åœ°çš„ç£ç›˜æ§ä»¶æ¥å­˜å‚¨å†…å­˜ç©ºé—´ã€‚ æ‰˜ç®¡å †å†…å­˜å ç”¨å¯¹äºç›®å‰ç»å¤§å¤šæ•°åŸºäºUnityå¼•æ“å¼€å‘çš„é¡¹ç›®è€Œè¨€ï¼Œå…¶æ‰˜ç®¡å †æ˜¯ç”±Monoåˆ†é…å’Œç®¡ç†çš„ã€‚â€œæ‰˜ç®¡â€çš„æœ¬æ„æ˜¯Monoå¯ä»¥è‡ªåŠ¨åœ°æ”¹å˜å †åœ°å¤§å°æ¥é€‚åº”ä½ æ‰€éœ€è¦çš„å†…å­˜ï¼Œå¹¶ä¸”é€‚å½“åœ°è°ƒç”¨åƒåœ¾å›æ”¶ï¼ˆGarbage Collectionæ“ä½œæ¥é‡Šæ”¾å·²ç»ä¸éœ€è¦åœ°å†…å­˜ï¼Œä»è€Œé™ä½å¼€å‘äººå‘˜å†ä»£ç å†…å­˜ç®¡ç†æ–¹é¢çš„é—¨æ§›ã€‚ ç›®å‰Unityæ‰€ä½¿ç”¨çš„Monoç‰ˆæœ¬å­˜åœ¨ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå³ï¼šMonoçš„å †å†…å­˜ä¸€æ—¦åˆ†é…å°±ä¸ä¼šè¿”è¿˜ç»™ç³»ç»Ÿã€‚è¿™æ„å‘³ç€Monoçš„å †å†…å­˜æ˜¯åªå‡ä¸é™çš„ã€‚ä¸¾ä¸ªç²’å­ï¼Œé¡¹ç›®è¿è¡Œæ—¶ï¼Œå†åœºæ™¯Aä¸­å¼€è¾Ÿäº†60MBçš„æ‰˜ç®¡å †å†…å­˜ï¼Œè€Œåˆ°ä¸‹ä¸€ä¸ªåœºæ™¯Bæ—¶ï¼Œåªéœ€è¦ä½¿ç”¨20MBçš„æ‰˜ç®¡å †å†…å­˜ï¼Œé‚£ä¹ˆMonoä¸­å°†ä¼šå­˜åœ¨40MBç©ºé—²çš„å †å†…å­˜ï¼Œä¸”ä¸ä¼šè¿”è¿˜ç»™ç³»ç»Ÿã€‚ é«˜é¢‘ç‡åœ°New Class/Container/Arrayç­‰ã€‚ä¸è¦å†Updateã€FixUpdateæˆ–è¾ƒé«˜è°ƒç”¨é¢‘ç‡åœ°å‡½æ•°ä¸­å¼€è¾Ÿå †å†…å­˜ã€‚ é¡¹ç›®ä¸­è¾ƒä¸ºåˆç†åœ°å†…å­˜åˆ†é…ï¼š çº¹ç†èµ„æºï¼š50MB ç½‘æ ¼èµ„æºï¼š20MB åŠ¨ç”»ç‰‡æ®µï¼š15MB éŸ³é¢‘ç‰‡æ®µï¼š15MB Monoå †å†…å­˜ï¼š40MB å…¶å®ƒï¼š10MB]]></content>
      <tags>
        <tag>uwa</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[optimzation_memory_2]]></title>
    <url>%2F2018%2F07%2F05%2Foptimzation_memory_2%2F</url>
    <content type="text"><![CDATA[å†…å­˜æ³„æ¼]]></content>
      <tags>
        <tag>uwa</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[LoadingPerformance_Texture]]></title>
    <url>%2F2018%2F07%2F05%2FLoadingPerformance_Texture%2F</url>
    <content type="text"><![CDATA[èµ„æºåŠ è½½èµ„æºåŠ è½½æ˜¯åŠ è½½æ¨¡å—ä¸­æœ€ä¸ºè€—æ—¶çš„éƒ¨åˆ†ï¼Œå…¶CPUå¼€é”€åœ¨Unityå¼•æ“ä¸­ä¸»è¦ä½“ç°åœ¨Loading.UpdatePreloadingå’ŒLoading.ReadObjectä¸¤é¡¹ä¸­ã€‚ Loading.UpdatePreloadingï¼Œè¿™ä¸€é¡¹å°½åœ¨è°ƒç”¨ç±»ä¼¼LoadLevel(Async)çš„æ¥å£å¤„å‡ºç°ï¼Œä¸»è¦è´Ÿè´£å¸è½½å½“å‰åœºæ™¯çš„èµ„æº]]></content>
      <tags>
        <tag>uwa</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity]]></title>
    <url>%2F2018%2F07%2F01%2FUnity3D_Game_Design%2F</url>
    <content type="text"><![CDATA[å‘½å æ¨¡å‹å‘½å Maxæ–‡ä»¶ä¸­è§’è‰²æ¨¡å‹å‘½åä¸ºskin@sk_001æ­¦å™¨æ¨¡å‹å‘½åä¸ºskin@wq_001 é¢œè‰²è´´å›¾skin@st_001.png é«˜å…‰è´´å›¾skin@st_001_ctr.png å¯¼å…¥å¯¼å‡ºèƒ½å¤Ÿä»3DsMaxå¯¼å…¥Unity3Dçš„èµ„æº æ‰€æœ‰èŠ‚ç‚¹çš„ä½ç§»ã€æ—‹è½¬ã€é”æ–¹ã€è½´å¿ƒå’Œå‘½åéƒ½å°†å¯¼å…¥ ç½‘æ ¼æ¨¡å‹åŒ…å«é¡¶ç‚¹é¢œè‰²ã€æ³•çº¿ï¼Œä¸€åˆ°ä¸¤ä¸ªUVé€šé“ æè´¨åŒ…å«è´´å›¾ä»¥åŠæ¼«åå°„é¢œè‰²ï¼Œä»¥åŠå•ä¸ªç½‘æ ¼çš„å¤šç»´æè´¨ åŠ¨ç”»ï¼ˆç‰©ä½“ç§»åŠ¨ã€æ—‹è½¬ã€ç¼©æ”¾ï¼‰ éª¨éª¼åŠ¨ç”»ï¼ˆè§’è‰²åŠ¨ç”»ï¼‰ è§’è‰²æ¨¡å‹åˆ¶ä½œè§„èŒƒæ¨¡å‹ é€‰äººç•Œé¢æ¨¡å‹é¢æ•°çº¦4500-5000å·¦å³ æ¸¸æˆå†…ä¸»è§’æ¨¡å‹é¢æ•°2500-3000å·¦å³ Bossæ¨¡å‹é¢æ•°æ ¹æ®ä½“å‹å¤§å°3000-5000å·¦å³ Npcæ¨¡å‹é¢æ•°900-1200é€ å‹ç®€å•é¢æ•°æ²¡ä¸‹é™ æ­¦å™¨æ¨¡å‹é¢æ•°250-500 é€ å‹ç®€å•é¢æ•°æ²¡ä¸‹é™ æ¨¡å‹åœ¨ä¸æ˜¯éå¸¸åºŸé¢çš„æƒ…å†µä¸‹ï¼Œè½¬æŠ˜çš„åœ°æ–¹åšå‡ºåšåº¦ï¼Œåšåº¦é€‚å½“å¤¸å¼ ã€‚ åœ°é¢éƒ¨åˆ†åˆ¶ä½œæˆåŒé¢æˆ–æ˜¯å°é—­ï¼Œå°å¸ƒæ¡ç±»æ¨¡å‹åšæˆåŒé¢æ¨¡å‹ è§’è‰²ç»“æ„æ•´ä½“å‡è¡¡ æ¯”å¦‚çœ¼ç›éƒ¨åˆ†ä¸éœ€è¦ç»†è‡´åˆ»ç”» è´´å›¾ä¸»è§’ 512*512 pngBoss 512*512 pngNpc 256*256 png æ­¦å™¨ä½“ç§¯è¾ƒå¤§çš„ä½¿ç”¨256*256 ä½“ç§¯è¾ƒå° 128*128 png å°ºå¯¸è®¾å®šåˆ¶ä½œæ¨¡å‹å‰å¿…é¡»å…ˆç¡®ä¿æ¨¡å‹å°ºå¯¸ï¼Œç»Ÿä¸€å°†æ˜¾ç¤ºå•ä½ä¸ç³»ç»Ÿå•ä½æ”¹ä¸ºå…¬å°ºã€‚ æ³¨æ„æ­£åé¢å…³ç³»æ¯ä¸ªæ¨¡å‹éƒ½åŒ…å«æ­£é¢å’Œåé¢ï¼Œä¸€èˆ¬æ¥è¯´å¼•æ“åªä¼šæ˜¾ç¤ºæ¨¡å‹çš„æ­£é¢ï¼Œå¦‚è¦åé¢ä¹Ÿä¸€èµ·æ˜¾ç¤ºéœ€é€è¿‡shaderæ¥å®ç°ï¼Œä½†å¢åŠ åé¢æ˜¾ç¤ºæ—¶ä¼šé™ä½æ€§èƒ½ï¼Œå› æ­¤å°½é‡è®©æ¨¡å‹å•é¢æ˜¾ç¤ºå°±å¥½ï¼Œè€Œåœ¨åˆ¶ä½œæ¨¡å‹æ—¶å¿…é¡»ç¡®ä¿è¦æ˜¾ç¤ºçš„æ¨¡å‹é¢æ˜¯æ­£é¢å³å¯ã€‚ ä¸è¦å­˜åœ¨ç ´é¢å’Œè¿­é¢åˆ¶ä½œæ¨¡å‹æ—¶æ³¨æ„é¡¶ç‚¹æ˜¯å¦ç„Šæ¥å¥½ï¼Œæœªç„Šæ¥çš„é¡¶ç‚¹å¯èƒ½ä¼šå¯¼è‡´æ¨¡å‹æœ‰ç ´é¢çš„æƒ…å½¢ï¼Œå¦å¤–æ¨¡å‹é¢ä¸é¢ä¹‹é—´æœ€å¥½ä¿æŒè·ç¦»ï¼Œä¸ç„¶ä¼šå‘ç”Ÿè¿­é¢çš„æƒ…å†µã€‚ ä¸è¦å­˜åœ¨å¤šä½™çš„é¡¶ç‚¹å’ŒTç‚¹åˆ é™¤ä¸€äº›æ²¡ç”¨çš„é¡¶ç‚¹ï¼Œå¹¶ä¸”é¿å…å‡ºç°Tç‚¹ã€‚ åˆ é™¤çœ‹ä¸åˆ°çš„é¢åˆ¶ä½œæ¨¡å‹æ—¶æœ‰äº›é¢å¯èƒ½åœ¨ä½ä¸‹æˆ–æ˜¯åœ¨æ¨¡å‹é‡Œé¢ï¼Œéƒ½æ˜¯åœ¨åœºæ™¯è¿›è¡Œä¸­çœ‹ä¸åˆ°çš„é¢ï¼Œè¿™äº›é¢å¯ä»¥åˆ é™¤ï¼Œä»¥å‡å°‘æ¨¡å‹é¢æ•°æé«˜æ•ˆèƒ½ã€‚ ç‰©ä½“çš„è½´å¿ƒæ¯ä¸ªç‰©ä½“éƒ½æœ‰ä¸€ä¸ªåæ ‡è½´å¿ƒï¼Œå®œæ®ç‰©ä½“å±æ€§è®¾è®¡å¥½ç‰©ä½“è½´å¿ƒä½ç½®ï¼Œä¸€èˆ¬æ¥è¯´è½´å¿ƒéƒ½ä¼šæ”¾ç½®åœ¨ä¸­å¿ƒçš„ä½ç½®ï¼Œå…¶ä»–æƒ…å†µå¦‚é—¨çš„è½´å¿ƒå¯èƒ½ä¼šåœ¨ä½ä¸‹è§’è½çš„ä½ç½®ã€‚ ä½¿ç”¨ç®€å•å‡ ä½•ä½“æ¥åˆ¶ä½œå¤æ‚å¯¹è±¡å½“é‡åˆ°æ¯”è¾ƒå¤æ‚çš„å¯¹è±¡ï¼Œä¸”å¯¹è±¡æ¯”è¾ƒå°ï¼Œå·¦ä¹˜æ¨¡å‹åè€Œå¢åŠ äº†æ¨¡å‹çš„é¢æ•°ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ç®€å•çš„å¹³é¢æ¨¡å‹ç»“åˆé€ç©ºè´´å›¾æ¥å®ç°å¤æ‚çš„é€ å‹ï¼Œå¯ä»¥å°†å›¾ç‰‡å­˜æˆPSDã€PNGã€TGAè¿™ç§å¸¦æœ‰é€æ˜é€šé“å±æ€§çš„è´´å›¾æ¡£ã€‚ é‡ç½®æ¨¡å‹ï¼ˆResetXFormï¼‰åˆ¶ä½œæ¨¡å‹æ—¶å¯èƒ½ä½¿ç”¨äº†ç¼©æ”¾åŠŸèƒ½æˆ–é•œåƒåŠŸèƒ½ï¼Œè¿™äº›æŒ‡ä»¤ä¼šä½¿å¾—æ¨¡å‹æ¯”ä¾‹é”™ä¹±ä»¥åŠå‡ºç°è´Ÿæ•°è½´å‘çš„æƒ…å½¢ï¼Œå› æ­¤åœ¨æ¨¡å‹åˆ¶ä½œå®Œæ¯•æ—¶æœ€å¥½è¿›è¡ŒResetXFormæŒ‡ä»¤ï¼Œè®©æ¨¡å‹å›å½’æœ€åŸºæœ¬çš„çŠ¶æ€ã€‚ åˆ¶ä½œè™šæ‹Ÿç¢°æ’ä½“å¯ä»¥ä¸ºæ¨¡å‹åˆ¶ä½œç®€å•çš„å‡ ä½•ä½“æ¥å½“ä½œç‰©ä½“çš„ç¢°æ’ä½“ï¼Œå¯ä»¥ä¾æ®ç‰©ä½“çš„é‡è¦æ€§ä¸ç²¾ç¡®æ€§æ¥è®¾è®¡å‡ ä½•ä½“å¤–è§‚ã€‚ æè´¨è´´å›¾å’ŒUVUnity3Dæ”¯æŒçš„Maxæè´¨Unity3Dæ”¯æŒ3dsmaxçš„Standard(æ ‡å‡†æè´¨)ä¸Muti/Sub-Object(å¤šç»´/å­ç‰©ä½“æè´¨)ã€‚ æ¨¡å‹æ±‡å…¥Unityåæ²¡æœ‰è´´å›¾ï¼Ÿå½“æ¨¡å‹æ±‡å…¥Unityå‰ï¼Œå¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ªTextureæ–‡ä»¶å¤¹ï¼Œå¹¶äº‹å…ˆå°†è´´å›¾å¯¼å…¥ï¼Œè¿™æ ·æ¨¡å‹æ±‡å…¥åå°±ä¼šè‡ªåŠ¨è¯»å–åˆ°è´´å›¾ã€‚ æ¨¡å‹å¡Œé™·åˆ¶ä½œæ¨¡å‹æ—¶ï¼Œå»ºè®®å°†æ¨¡å‹ä»¥ä¸€æ ‹å»ºç­‘è¿›è¡Œå¡Œé™·ï¼Œæ¥ç€å¯¹æ¨¡å‹è¿›è¡ŒUVæ‹†è§£ï¼Œè¿™æ ·å¯ä»¥å°†ä¸€ä¸ªæ¨¡å‹ä½¿ç”¨ä¸€å¼ è´´å›¾æ¥å®Œæˆã€‚ é¿å…æ‹‰ä¼¸UVè°ƒæ•´UVå‰å…ˆå°†æè´¨çƒä½¿ç”¨æ£‹æ ¼ (checkter) è´´å›¾æ¥è§‚çœ‹UVæ¯”ä¾‹ï¼Œè°ƒæ•´UVæ—¶å°½é‡è®©æ£‹æ ¼ç»´æŒæ­£æ–¹å½¢çš„å½¢çŠ¶ã€‚ è´´å›¾å°ºå¯¸è´´å›¾å¿…é¡»æ˜¯2çš„Nè¯æ”¾ï¼ˆ8ã€16ã€32ã€64ã€128ã€256ï¼‰ï¼Œå»ºè®®è´´å›¾ä¸è¦è¶…è¿‡1024*1024å¤§å°ã€‚ ç»˜åˆ¶UVå‡ºè¡€ç»˜åˆ¶æè´¨æ—¶ç»˜åˆ¶å‡ºè¡€è¾¹ç¼˜ï¼Œå¯é¿å…å‡ºç°æ˜æ˜¾æ¥ç¼çº¿ã€‚ é€ç©ºè´´å›¾åœ¨Unityé‡Œçš„ä½¿ç”¨é€ç©ºè´´å›¾æ¯›è¾¹å¤„ç†æŠ€å·§é€ç©ºè´´å›¾æ¯›è¾¹å¤„ç†æŠ€å·§ï¼ˆè¿›é˜¶ï¼‰æè´¨ä¸è´´å›¾å‘½åçƒ˜åŸ¹è´´å›¾æ•™å­¦3dsMax LightMap çƒ˜åŸ¹è´´å›¾3dsMax CompleteMap çƒ˜åŸ¹è´´å›¾Unityçƒ˜åŸ¹è´´å›¾Unity3Dåœ°å½¢åˆ¶ä½œåœ°å½¢ç¼–è¾‘å™¨åŸºæœ¬åŠŸèƒ½ä»‹ç»æ°´ç³»ç»Ÿä»‹ç»å¤©ç©ºç›’ç³»ç»Ÿä»‹ç»ç¬¬ä¸€äººç§°å¯¼è§ˆ3dsMaxè§’è‰²åŠ¨ç”»å¯¼å…¥ä¸åŸºæœ¬æ§åˆ¶å•ä¸ªè§’è‰²åŠ¨ç”»å¯¼å…¥å¤šä¸ªè§’è‰²åŠ¨ç”»å¯¼å…¥è§’è‰²åŸºæœ¬æ§åˆ¶ç¬¬ä¸‰äººç§°è§’è‰²æ§åˆ¶è§’è‰²é˜´å½±æ ‘æœ¨ä¸ç²’å­ç³»ç»Ÿæ ‘æœ¨åˆ¶ä½œç²’å­ç³»ç»Ÿ-ç¹æ˜Ÿç²’å­æ•ˆæœç²’å­ç³»ç»Ÿ-é›ªèŠ±ç²’å­æ•ˆæœç²’å­ç³»ç»Ÿ-ç«ç„°ç²’å­æ•ˆæœç¼–è¾‘ç•Œé¢ä»‹ç»åˆ›å»ºå·¥ç¨‹æ‰“å¼€å·¥ç¨‹Projectè§†å›¾Hierarchyè§†å›¾Inspectorè§†å›¾Sceneè§†å›¾è§†å›¾ä»‹ç»ç§»åŠ¨è§†å›¾ç§»åŠ¨æ¨¡å‹æ—‹è½¬æ¨¡å‹ç¼©æ”¾æ¨¡å‹åœºæ™¯å·¥å…·Senceè§†å›¾æ§åˆ¶æ¡Gameè§†å›¾Gameè§†å›¾æ§åˆ¶æ¡å·¥ç¨‹çš„æ‰“åŒ…å¯¼å‡ºä¸å¯¼å…¥æ¸¸æˆæ¡ˆä¾‹1Androidå’ŒiOSç‰ˆæœ¬å‘å¸ƒUnity3Dè„šæœ¬æ¦‚è¿°Unity3Dè„šæœ¬æ¦‚è¿°Unity3Dçš„åŸºæœ¬è¯­æ³•è®¿é—®å…¶ä»–ç»„ä»¶è®¿é—®å…¶ä»–æ¸¸æˆå¯¹è±¡å‘é‡æˆå‘˜å˜é‡ä¸å…¨å±€å˜é‡å®ä¾‹åŒ–ååŒç¨‹åºä¸ä¸­æ–­åˆ›å»ºæ¸¸æˆå¯¹è±¡è·å–æ¸¸æˆå¯¹è±¡æ·»åŠ ç»„ä»¶ä¸ä¿®æ”¹ç»„ä»¶è„šæœ¬ç»„ä»¶å…‹éš†æ¸¸æˆå¯¹è±¡æ—¶é—´1234567void OnGUI()&#123; GUILayout.Label("å½“å‰æ¸¸æˆæ—¶é—´ï¼š" + Time.time); GUILayout.Label("ä¸Šä¸€å¸§æ‰€æ¶ˆè€—çš„æ—¶é—´ï¼š" + Time.deltaTime); GUILayout.Label("å›ºå®šå¢é‡æ—¶é—´ï¼š" + Time.fixedTime); GUILayout.Label("ä¸Šä¸€å¸§æ‰€æ¶ˆè€—çš„å›ºå®šæ—¶é—´ï¼š" + Time.fixedDeltaTime);&#125; éšæœºæ•°å››å…ƒæ•°Unity3D GUIç•Œé¢è®¾è®¡ï¼ˆGUI&amp;NGUI&amp;UGUIï¼‰UGUIçš„ç½‘æ ¼é‡å»ºã€åŠ¨é™åˆ†ç¦»åŠ¨é™åˆ†ç¦»ï¼šä¹Ÿå°±æ˜¯è¯´åŒä¸€ä¸ªç•Œé¢ä¸‹çš„UIï¼Œå¯æ´»åŠ¨çš„å…ƒç´ æ”¾åœ¨ä¸€ä¸ªCanvasä¸‹ï¼Œä¸å¯æ´»åŠ¨çš„å…ƒç´ æ”¾åœ¨å¦ä¸€ä¸ªCanvasä¸‹ã€‚è™½ç„¶ä¸¤ä¸ªCanvasæ‰“æ–­äº†åˆæ‰¹ï¼Œä½†æ˜¯å´å‡å°‘äº†ç½‘æ ¼é‡å»ºæ—¶é—´ï¼Œæ€»ä½“ä¸Šæ˜¯æœ‰ä¼˜åŒ–çš„ã€‚ ç©¶å…¶åŸå› ï¼Œæ˜¯å› ä¸ºåœ¨åŒä¸€ä¸ªCanvasä¸‹çš„æŸä¸ªå…ƒç´ å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒåŒä¸€Canvasä¸‹çš„æ‰€æœ‰å…ƒç´ éƒ½ä¼šè¿›è¡Œç½‘æ ¼é‡å»º(ReBatch)ã€‚äº•é™æ€çš„å…ƒç´ åœ¨é€»è¾‘ä¸Šæ˜¯ä¸éœ€è¦é‡å»ºçš„ï¼Œå› ä¸ºä»–ä»¬éƒ½æ²¡å˜è¿‡ï¼Œæ‰€ä»¥éœ€è¦åˆ†å¼€ã€‚ GUIå¸¸ç”¨æ§ä»¶GUI TextGUI Texture (LazyTexture)Labelæ§ä»¶Buttonæ§ä»¶TextFieldToolBarSliderScrollViewæ§ä»¶ç¾¤ç»„è§†å›¾çª—å£NGUI Panel &amp; UGUI Canvaså›¾é›†åˆ¶ä½œ(TexturePacket)UITweenåŠ¨ç”»é¡¶ç‚¹åŠ¨ç”»GUI Skinè‡ªå®šä¹‰é£æ ¼ç»„ä»¶Unity3Dè¾“å…¥ä¸æ§åˆ¶é”®ç›˜äº‹ä»¶é”®ç›˜æŒ‰ä¸‹äº‹ä»¶é”®ç›˜æŠ¬èµ·äº‹ä»¶é”®ç›˜é•¿æŒ‰äº‹ä»¶è§¦æ‘¸äº‹ä»¶è§¦æ‘¸æŒ‰ä¸‹äº‹ä»¶è§¦æ‘¸æŠ¬èµ·äº‹ä»¶è§¦æ‘¸é•¿æŒ‰äº‹ä»¶é¼ æ ‡äº‹ä»¶é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶é¼ æ ‡æŠ¬èµ·äº‹ä»¶é¼ æ ‡é•¿æŒ‰äº‹ä»¶è‡ªå®šä¹‰äº‹ä»¶è¾“å…¥ç®¡ç†å™¨ï¼ˆInputHelperï¼‰è‡ªå®šä¹‰æŒ‰é”®äº‹ä»¶è‡ªå®šä¹‰æŒ‰é”®è½´å®ä¾‹ç»ƒä¹ è§’è‰²æ¨¡å‹ä¸åŠ¨ç”»ï¼ˆAnimation&amp;Animatorï¼‰æ¨¡å‹çš„è½½å…¥è®¾ç½®è§’è‰²åŠ¨ç”»æ’­æ”¾3DåŠ¨ç”»åŠ¨ç”»è£åˆ‡åŠ¨ç”»çš„å¸§Tweenå¤šåª’ä½“éŸ³é¢‘è§†é¢‘]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é˜´å½±æ˜ å°„çš„åŸç†å’Œå®ç°]]></title>
    <url>%2F2018%2F06%2F30%2FShadow_Mapping%2F</url>
    <content type="text"><![CDATA[é˜´å½±è´´å›¾ (Shadwom mapping)åƒç´ ä¸ä»¥çº¹ç†å½¢å¼ä¿å­˜çš„å…‰ç…§æ·±åº¦ç¼“å†²åŒºæˆ–è€…æ·±åº¦å›¾åƒæ¯”è¾ƒï¼Œé€šè¿‡è¿™ç§æ–¹å¼è®¡ç®—åƒç´ æ˜¯å¦å¤„äºå…‰æºç…§å°„èŒƒå›´ä¹‹å†…ï¼Œä»è€Œç”Ÿæˆé˜´å½±ã€‚ åŸç†é˜´å½±è´´å›¾æ˜¯ä¸€ç§ä½¿ç”¨æ·±åº¦çº¹ç†æ¥ä¸ºæ¸²æŸ“é˜´å½±æä¾›è§£å†³æ–¹æ³•çš„å¤šé€šé“è®¡ç®—ã€‚å®ƒçš„å…³é”®æ˜¯ï¼Œå°±æ˜¯ç”¨æŠ•å½±å…‰æºä»£æ›¿æœ€ç»ˆè§†å£æ¥è§‚å¯Ÿåœºæ™¯ã€‚é€šè¿‡ç§»åŠ¨è§†å£åˆ°å…‰æºä½ç½®ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°è¿™ä¸ªä½ç½®æ¯ä¸ªä¸œè¥¿éƒ½æ˜¯æ˜äº®çš„ï¼Œå› ä¸ºä»å…‰çš„è§’åº¦æ¥çœ‹æ˜¯æ²¡æœ‰é˜´å½±çš„ã€‚]]></content>
      <tags>
        <tag>Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity3Dä¼˜åŒ–ä¸“é¢˜]]></title>
    <url>%2F2018%2F06%2F26%2FUnity3D-Optimize%2F</url>
    <content type="text"><![CDATA[ä¸€ é®æŒ¡å‰”é™¤OcclusionCullingé®æŒ¡å‰”é™¤(Occlusion Culling)åŠŸèƒ½å¯åœ¨å¯¹è±¡å› è¢«å…¶ä»–ç‰©ä½“é®æŒ¡ï¼Œå½“å‰åœ¨ç›¸æœºä¸­æ— æ³•çœ‹åˆ°æ—¶ï¼Œç¦ç”¨å¯¹è±¡æ¸²æŸ“ã€‚è¯¥åŠŸèƒ½ä¸ä¼šåœ¨ä¸‰ç»´è®¡ç®—æœºå›¾å½¢ä¸­è‡ªåŠ¨å¼€å¯ï¼Œå› ä¸ºåœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œç¦»ç›¸æœºæœ€è¿œçš„å¯¹è±¡æœ€å…ˆæ¸²æŸ“ï¼Œç¦»ç›¸æœºçš„å¯¹è±¡è¦†ç›–å…ˆå‰çš„ç‰©ä½“ï¼ˆè¯¥æ­¥éª¤ç§°ä¹‹ä¸ºâ€œé‡å¤æ¸²æŸ“(overdraw)â€ï¼‰ã€‚é®æŒ¡å‰”é™¤(Occlusion Culling)ä¸è§†é”¥ä½“å‰”é™¤(Frustum Culling)ä¸åŒã€‚è§†é”¥ä½“å‰”é™¤(Frustum Culling)åªç¦ç”¨ç›¸æœºè§†é‡å¤–çš„å¯¹è±¡æ¸²æŸ“ï¼Œä¸ç¦ç”¨è§†é‡ä¸­è¢«é®æŒ¡çš„ä»»ä½•ç‰©ä½“çš„æ¸²æŸ“ã€‚æ³¨æ„ï¼Œä½¿ç”¨é®æŒ¡å‰”é™¤(Occlusion Culling)åŠŸèƒ½æ—¶ï¼Œä»å°†å—ç›Šäºè§†é”¥ä½“å‰”é™¤(Frustum Culling)ã€‚å½“åœºæ™¯ä¸­åŒ…å«å¤§é‡æ¨¡å‹æ—¶ï¼ŒåŠ¿å¿…ä¼šé€ æˆæ¸²æŸ“æ•ˆç‡çš„é™ä½ã€‚å¦‚æœä½¿ç”¨é®æŒ¡å‰”é™¤æŠ€æœ¯ï¼Œå¯ä»¥ä½¿ç”¨é‚£äº›è¢«é˜»æŒ¡çš„ç‰©ä½“ä¸è¢«æ¸²æŸ“ï¼Œä»è€Œè¾¾åˆ°æé«˜æ¸²æŸ“æ•ˆç‡çš„ç›®çš„ã€‚ é®æŒ¡å‰”é™¤çš„åŸºæœ¬åŸç†æ˜¯åœ¨åœºæ™¯ä¸­åˆ›å»ºä¸€ä¸ªé®æŒ¡åŒºåŸŸï¼Œè¯¥é®æŒ¡åŒºåŸŸç”±å•å…ƒæ ¼ç»„æˆï¼›æ¯ä¸ªå•å…ƒæ ¼æ„æˆæ•´ä¸ªåœºæ™¯é®æŒ¡åŒºåŸŸçš„ä¸€éƒ¨åˆ†ï¼Œè¿™äº›å•å…ƒæ ¼ä¼šæŠŠæ•´ä¸ªåœºæ™¯æ‹†åˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†ã€‚å½“æ‘„åƒæœºèƒ½å¤Ÿçœ‹åˆ°è¯¥å•å…ƒæ ¼æ—¶ï¼Œå•å…ƒæ ¼ä¸­çš„ç‰©ä½“ä¼šè¢«æ¸²æŸ“å‡ºæ¥ï¼Œè€Œè¢«å…¶ä»–å•å…ƒæ ¼æŒ¡ä½çš„ä¸è¢«æ‘„åƒæœºçœ‹åˆ°çš„ç‰©ä½“ä¸ä¼šè¢«æ¸²æŸ“ã€‚ ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥åšé®æŒ¡å‰”é™¤çš„æ¡ˆä¾‹ äºŒ å±‚çº§æ¶ˆéšå¦‚æœåœºæ™¯ä¸­å­˜åœ¨å¤§é‡çš„å°ç‰©ä½“ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å±‚æ¶ˆéšä¼˜åŒ–åœºæ™¯ã€‚å±‚æ¶ˆéšå°±æ˜¯åœ¨æ¯”è¾ƒè¿œçš„è·ç¦»å°†å°ç‰©ä½“å‰”é™¤ï¼Œå‡å°‘ç»˜åˆ¶è°ƒç”¨çš„æ¬¡æ•°ã€‚ä¾‹å¦‚ï¼Œåœ¨æ¯”è¾ƒè¿œçš„è·ç¦»ï¼Œå¤§å‹å»ºç­‘ç‰©ä¾ç„¶å¯è§ï¼Œä½†æ˜¯å°å‹çš„çŸ³å—å’Œç¢ç‰‡éšè—æ‰ã€‚å¯ä»¥å°†å°ç‰©ä»¶å•ç‹¬æ”¾å…¥ä¸€ä¸ªå±‚ï¼Œå¹¶ä¸”ä½¿ç”¨Camera.main.layerCullDistanceå‡½æ•°è®¾ç½®å±‚çš„æ¶ˆéšè·ç¦»ã€‚è°ƒæ•´æ‘„åƒæœºä½ç½®è¿›è¡Œæµ‹è¯•å³å¯ã€‚åªæœ‰åœ¨æ‘„åƒæœºè·ç¦»è¿™äº›ç‰©ä½“å°äº10Mçš„æ—¶å€™ï¼Œåœ°é¢ä¸Šçš„è¿™äº›ç‰©ä½“æ‰èƒ½æ˜¾ç¤ºå‡ºæ¥ã€‚ 1234567public class SeperateControl : MonoBehaviour &#123; void Start() &#123; float[] distance = new float[32]; distances[8] = 10; Camera.main.layerCullDistances = distances; // å¦‚æœmain == null,åˆ™è®¾ç½®cameraçš„tagä¸ºmainCamera &#125;&#125; ä¸‰ å±‚çº§ç»†èŠ‚LODå±‚çº§ç»†èŠ‚LODå…¨ç§°ä¸ºLevelOfDetail,å®ƒæ˜¯æ ¹æ®ç‰©ä½“åœ¨æ¸¸æˆç”»é¢ä¸­é”å æ®çš„ç™¾åˆ†æ¯”æ¥è°ƒç”¨ä¸åŒå¤æ‚åº¦çš„æ¨¡å‹çš„ã€‚ç®€å•ç†è§£å°±æ˜¯å½“ä¸€ä¸ªç‰©ä½“è·ç¦»æ‘„åƒæœºæ¯”è¾ƒè¿œçš„æ—¶å€™ï¼Œä½¿ç”¨å¤æ‚åº¦ä½çš„æ¨¡å‹ï¼Œæ¯”è¾ƒè¿‘çš„æ—¶å€™ï¼Œä½¿ç”¨å¤æ‚åº¦é«˜çš„æ¨¡å‹ã€‚ åœ¨å»ºæ¨¡è½¯ä»¶ä¸­ï¼Œåˆ¶ä½œå¥½å„ä¸ªå±‚çº§çš„æ¨¡å‹ï¼Œå¹¶ä¸”æ ¹æ®å¤æ‚ç¨‹åº¦è‡ªé«˜å‘ä½å‘½åä¸ºï¼šæ¨¡å‹åç§°_LOD0,æ¨¡å‹åç§°_LOD1,æ¨¡å‹åç§°_LOD2ï¼Œæ•°å­—è¶Šä½ï¼Œå¤æ‚ç¨‹åº¦è¶Šé«˜ã€‚ æˆ‘ä»¬æ–°å»ºä¸€ä¸ªåœºæ™¯ï¼Œæ„é€ æœ€ç®€å•çš„LODæ¨¡å‹ç¤ºä¾‹ã€‚ å‡†å¤‡3ä¸ªUnityåŸºæœ¬æ¸¸æˆå¯¹è±¡ï¼Œæ·»åŠ å¿…è¦çš„æè´¨ã€‚ å®šä¹‰ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå‘½åä¸º_LOD,æ·»åŠ LODGroupç»„ä»¶ åˆ†åˆ«å°†ä»¥ä¸Šä¸‰ä¸ªåŸºæœ¬å¯¹è±¡æ‹–æ‹½åˆ°LODGroupçš„å„ä¸ªçº§åˆ«ä¸Š é¦–å…ˆæ·»åŠ LOD0çš„å¯¹è±¡ï¼Œå½“ç„¶ä¸­é—´éœ€è¦ä¿®æ”¹çˆ¶èŠ‚ç‚¹ï¼Œç‚¹å‡»ç¡®å®šå³å¯ åœ¨Sceneè§†å›¾ä¸­ï¼Œæ‹–åŠ¨æ‘„åƒæœºåˆ†åˆ«è¿‘è·ç¦»ä¸è¿œè·ç¦»è§‚å¯Ÿæ¨¡å‹çš„å˜åŒ–ã€‚ å›› DrawCallè®²è§£ä¸€ä¸ªDrawCallï¼Œè¡¨ç¤ºU3Dä½¿ç”¨è¿™ä¸ªæè´¨/çº¹ç†ï¼Œæ¥è¿›è¡Œä¸€æ¬¡æ¸²æŸ“ï¼Œé‚£ä¹ˆè¿™æ¬¡æ¸²æŸ“å‡è®¾æœ‰3ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå½“3ä¸ªå¯¹è±¡éƒ½ä½¿ç”¨è¿™ä¸€ä¸ªæè´¨/çº¹ç†çš„æ—¶å€™ï¼Œå°±ä¼šäº§ç”Ÿä¸€æ¬¡DrawCallï¼Œå¯ä»¥ç†è§£ä¸ºä¸€æ¬¡å°†çº¹ç†è¾“é€åˆ°å±å¹•ä¸Šçš„è¿‡ç¨‹ï¼Œï¼ˆå®é™…ä¸Šå¼•æ“å¤§å¤šä¼šä½¿ç”¨å¦‚åŒç¼“å†²ï¼Œç¼“å­˜è¿™ç±»çš„æ‰‹æ®µæ¥ä¼˜åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼Œä½†åœ¨è¿™é‡Œæˆ‘ä»¬åªéœ€è¦è¿™æ ·è®¤è¯†å°±å¯ä»¥äº†ï¼‰ï¼Œå‡è®¾3ä¸ªå¯¹è±¡ä½¿ç”¨ä¸åŒçš„æè´¨/çº¹ç†ï¼Œé‚£ä¹ˆæ— ç–‘ä¼šäº§ç”Ÿ3ä¸ªDrawCallã€‚ æ‰¹å¤„ç†åŠ¨æ€ç‰©ä½“éœ€è¦åœ¨æ¯ä¸ªé¡¶ç‚¹ä¸Šè¿›è¡Œä¸€å®šçš„å¼€é”€ï¼Œæ‰€ä»¥åŠ¨æ€æ‰¹å¤„ç†ä»…æ”¯æŒå°äº900é¡¶ç‚¹çš„ç½‘æ ¼ç‰©ä½“ï¼Œå¦‚æœä½ çš„ç€è‰²å™¨ä½¿ç”¨é¡¶ç‚¹ä½ç½®ï¼Œæ³•çº¿å’ŒUVå€¼ä¸‰ç§å±æ€§ï¼Œé‚£ä¹ˆä½ åªèƒ½æ‰¹å¤„ç†300é¡¶ç‚¹ä¸€ä¸‹çš„ç‰©ä½“ï¼›è¯·æ³¨æ„ï¼šå±æ€§æ•°é‡çš„é™åˆ¶å¯èƒ½ä¼šåœ¨å°†æ¥è¿›è¡Œæ”¹å˜ã€‚ ç›¸åŒçš„ç‰©ä½“é‡‡å–ç›¸åŒçš„æè´¨ï¼Œä¿®æ”¹å…¶ç¼©æ”¾æ¯”ä¾‹ï¼Œè§‚å¯ŸDrawCallçš„å˜åŒ–ã€‚ åŠŸèƒ½æè¿°å¦‚ä¸‹ï¼šStatic Batchingæ˜¯å°†æ ‡æ˜ä¸ºStaticçš„é™æ€ç‰©ä»¶ï¼Œå¦‚æœåœ¨ä½¿ç”¨ç›¸åŒæè´¨çƒçš„æ¡ä»¶ä¸‹ï¼ŒUnityä¼šè‡ªåŠ¨å¸®ä½ æŠŠè¿™ä¸¤ä¸ªç‰©ä½“åˆå¹¶æˆä¸€ä¸ªBatchï¼Œé€å¾€GPUæ¥å¤„ç†ã€‚ Static Batchingå¯ä»¥è®©å¼•æ“é™ä½ä»»ä½•å°ºå¯¸ç½‘æ ¼çš„Draw Callï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Profile å·¥å…·ä½¿ç”¨æ€§èƒ½åˆ†æå·¥å…·å¯ä»¥ç»™æˆ‘ä»¬æä¾›æ¸¸æˆæ€§èƒ½è¡¨ç°çš„è¯¦ç»†ä¿¡æ¯ã€‚å¦‚æœæˆ‘ä»¬çš„æ¸¸æˆå­˜åœ¨æ€§èƒ½é—®é¢˜ï¼Œå¦‚ä½å¸§ç‡æˆ–è€…é«˜å†…å­˜å ç”¨ï¼Œæ€§èƒ½åˆ†æå·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ³•çº¿é—®é¢˜çš„èµ·å› ï¼Œå¹¶ååŠ©æˆ‘ä»¬è§£å†³é—®é¢˜ã€‚ Profilerå¸ƒå±€ åœ¨æˆ‘ä»¬ä½¿ç”¨Profileræ”¶é›†æ¸¸æˆæ•°æ®ä¹‹å‰ï¼Œå…ˆæ‰“å¼€å®ƒç†Ÿæ‚‰ä¸‹ç•Œé¢å¸ƒå±€ã€‚ä»èœå•Window-&gt;Profileræ‰“å¼€ã€‚ åœ¨çª—å£å·¦ä¾§ï¼Œå¯ä»¥çœ‹åˆ°ä¸€åˆ—profilersï¼Œæ¯ä¸ªprofileræ˜¾ç¤ºæˆ‘ä»¬æ¸¸æˆçš„ä¸€ä¸ªæ–¹é¢çš„ä¿¡æ¯ï¼Œåˆ†åˆ«ä¸ºcpuä½¿ç”¨æƒ…å†µï¼Œgpuä½¿ç”¨æƒ…å†µï¼Œæ¸²æŸ“ï¼Œå†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå£°éŸ³ï¼Œç‰©ç†å’Œç½‘ç»œã€‚ å½“å¼€å§‹å½•åˆ¶æ—¶ï¼Œçª—å£ä¸Šéƒ¨çš„æ¯ä¸ªprofilerä¼šéšç€æ—¶é—´æ˜¾ç¤ºæ•°æ®ã€‚æ€§èƒ½æ˜¯éšç€æ—¶é—´å˜åŒ–çš„ï¼Œæ‰€ä»¥éšç€æ—¶é—´å˜åŒ–çš„ä¿¡æ¯æ˜¯æ¯”ä»…ä»…ä¸€å¸§çš„ä¿¡æ¯æœ‰ç”¨çš„å¤šçš„ã€‚æœ‰äº›æ€§èƒ½é—®é¢˜æ˜¯æŒç»­æ€§çš„ï¼Œæœ‰äº›é—®é¢˜æ˜¯ä»…ä»…åœ¨ä¸€å¸§ä¸­å‡ºç°çš„ï¼Œè¿˜æœ‰ä¸€äº›æ€§èƒ½é—®é¢˜æ˜¯éšç€æ—¶é—´é€æ¸æ˜¾ç°çš„ã€‚]]></content>
      <tags>
        <tag>Unity3D</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[BRDF(åŒå‘åå°„åˆ†å¸ƒå‡½æ•°)]]></title>
    <url>%2F2018%2F06%2F09%2FBRDF%2F</url>
    <content type="text"><![CDATA[åœ¨è®¡ç®—æœºå›¾å½¢å­¦é¢†åŸŸï¼Œç€è‰²ï¼ˆShadingï¼‰æ˜¯æŒ‡æ ¹æ®è¡¨é¢æˆ–è€…å¤šè¾¹å½¢ç›¸å¯¹å…‰æºå’Œç›¸æœºçš„è§’åº¦å’Œè·ç¦»æ¥è®¡ç®—å®ƒçš„é¢œè‰²çš„è¿‡ç¨‹ã€‚ä¸åŒçš„ç”¨æˆ·å¯ä»¥ä½¿ç”¨ä¸åŒçš„ç€è‰²ç®—æ³•ï¼ŒCADç­‰è¿½æ±‚ç›¸åº”é€Ÿåº¦çš„äº¤äº’å¼å›¾å½¢é¢†åŸŸå¯ä»¥ä½¿ç”¨ç®€å•å¿«é€Ÿçš„ç€è‰²ç®—æ³•ï¼Œå¡é€šæ²¹ç”»ç­‰è‰ºæœ¯æ•ˆæœä½¿ç”¨éçœŸå®æ„Ÿï¼ˆNonphotorealisticï¼‰ç€è‰²ç®—æ³•ï¼Œè€Œè¿½æ±‚çœŸå®æ„Ÿçš„CGç”µå½±æˆ–æ¸¸æˆåˆ™å¯ä»¥ä½¿ç”¨åŸºäºç‰©ç†å»ºæ¨¡çš„ç€è‰²ç®—æ³•ã€‚æœ¬æ–‡å…³æ³¨åŸºäºç‰©ç†ç€è‰²çš„BRDFæ¨¡å‹ï¼Œå¸Œæœ›èƒ½å°†BRDFçš„æ¥é¾™å»è„‰å°†æ¸…æ¥šï¼Œå¹¶åˆ†æCook-TorranceBRDFå…¬å¼çš„æ¨å€’è¿‡ç¨‹ã€‚è¦æ¨¡æ‹ŸçœŸå®å…‰ç…§ï¼Œæˆ‘ä»¬å…ˆè¦å¼„æ¸…æ¥šå…‰ç…§çš„ç°è±¡ã€‚ å…‰ç…§ç°è±¡å…‰ç”±å…‰å­ç»„æˆï¼Œå…‰å­å³å…·æœ‰ç²’å­çš„ç‰¹æ€§ï¼Œåˆè¡¨ç°å‡ºæ³¢çš„ç‰¹æ€§ã€‚ä»æ³¢çš„è§’åº¦çœ‹ï¼Œå…‰æ˜¯ç”µç£æ³¢çš„ä¸€ç§ï¼Œä¸åŒé¢‘ç‡ï¼ˆæ³¢é•¿ï¼‰çš„å…‰æ³¢èƒ½é‡ä¸åŒï¼Œé¢‘ç‡è¶Šé«˜ï¼ˆæ³¢é•¿è¶ŠçŸ­ï¼‰ï¼Œèƒ½é‡è¶Šé«˜ï¼Œé¢‘ç‡è¶Šä½ï¼ˆæ³¢é•¿è¶Šé•¿ï¼‰ï¼Œèƒ½é‡è¶Šä½ï¼Œå…¶ä¸­æ³¢é•¿åœ¨380nm-780nmèŒƒå›´å†…çš„å…‰æ³¢èƒ½è¢«è®¤ç±»çš„è§†ç½‘è†œæ„ŸçŸ¥åˆ°ï¼Œè¿™ä¸ªèŒƒå›´çš„å…‰æ³¢æˆä¸ºå¯è§å…‰ï¼Œä¸åŒé¢‘ç‡çš„å¯è§å…‰è¢«äººæ„ŸçŸ¥ä¸ºä¸åŒçš„é¢œè‰²ï¼Œé¢‘ç‡è¶Šé«˜çš„å…‰åè“ï¼Œé¢‘ç‡è¾ƒä½çš„å…‰åˆ™åçº¢ã€‚ å…‰å­¦æ ¹æ®ç ”ç©¶çš„å°ºåº¦å¯ä»¥åˆ†ä¸ºæ³¢åŠ¨å…‰å­¦ï¼ˆWave Opticsï¼‰å’Œå‡ ä½•å…‰å­¦ï¼ˆGeometric Opticsï¼‰ï¼Œæ³¢åŠ¨å…‰å­¦æ¯”å‡ ä½•å…‰å­¦å¤æ‚ï¼Œè€Œç”±äºå›¾å½¢å­¦é¢†åŸŸå…‰æŸ±çš„å°ºåº¦è¿œå¤§äºå¯è§å…‰çš„æ³¢é•¿ï¼ˆ380nm - 780nmï¼‰ï¼Œä¹Ÿå¾ˆå°‘æ¶‰åŠå…‰çš„åæŒ¯ã€å¹²æ¶‰å’Œè¡å°„ç­‰æ³¢åŠ¨å…‰å­¦æ‰èƒ½è§£é‡Šçš„ç°è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬ç”¨å‡ ä½•å…‰å­¦å»ºç«‹å…‰ç…§çš„æ¨¡å‹ã€‚ å…‰å­¦å¹³é¢è¾¹ç•Œä¸Šçš„æ•£å°„ å¹³é¢è¾¹ç•Œä¸¤è¾¹ç‰©è´¨çš„æŠ˜å°„ç‡ï¼ˆRefractive Indexï¼‰ä¸åŒï¼Œå½“ä¸€æŸå…‰çº¿ä»ä¸€ç§ç‰©è´¨ç…§å°„åˆ°å¹³é¢è¾¹ç•Œä¸Šæ—¶ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†åœ¨å¹³é¢è¾¹ç•Œè¢«åå°„å›è¿™ç§ç‰©è´¨ï¼Œåå°„æ–¹å‘ä¸ºå…¥å°„æ–¹å‘å…³äºå¹³é¢æ³•çº¿çš„å¯¹ç§°å‘é‡ï¼š $r_i = 2(n \cdot l)n - l$ å…¶ä¸­$r_i$æ˜¯åå°„å‘é‡ï¼Œlæ˜¯å…‰çº¿å…¥å°„å‘é‡ï¼Œnæ˜¯å¹³é¢å‘ç°å‘é‡é—´çš„$\cdot$è¡¨ç¤ºå‘é‡çš„ç‚¹ç§¯ï¼Œä¸¤ä¸ªå•ä½å‘é‡çš„ç‚¹ç§¯ç­‰äºå®ƒä»¬å¤¹è§’çš„ä½™å¼¦ã€‚ å¦ä¸€éƒ¨åˆ†å…‰ç©¿è¿‡å¹³é¢è¾¹ç•ŒæŠ˜å°„è¿›å…¥å¦ä¸€ç§ç‰©è´¨ï¼ŒæŠ˜å°„æ–¹å‘å¯ç”±Snellæ³•åˆ™ï¼ˆSnellâ€™s Lawï¼‰è®¡ç®—å¾—å‡ºï¼š ${sin\theta_i \over sin\theta_t}={v_i\over v_t}={\lambda_i\over \lambda_t}={n_t\over n_i}$ å…¶ä¸­ä¸‹æ ‡iè¡¨ç¤ºå…¥å°„ä»‹è´¨ï¼Œä¸‹æ ‡tè¡¨ç¤ºæŠ˜å°„ä»‹è´¨ï¼Œ$\theta$è¡¨ç¤ºå…‰çº¿ç›¸å¯¹äºè¾¹ç•Œæ³•çº¿çš„è§’åº¦ï¼Œvè¡¨ç¤ºä»‹è´¨ä¸­çš„å…‰é€Ÿï¼Œ$\lambda$è¡¨ç¤ºä»‹è´¨ä¸­çš„æ³¢é•¿ï¼Œnè¡¨ç¤ºä»‹è´¨çš„æŠ˜å°„ç‡ã€‚åå°„å’ŒæŠ˜å°„çš„æ¯”ä¾‹ç”±è²æ¶…å°”æ–¹ç¨‹(Fresnel Equations)ç»™å‡ºï¼Œè²æ¶…å°”æ–¹ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œå›¾å½¢å­¦é‡Œä¸€èˆ¬ä½¿ç”¨è¿‘ä¼¼å…¬å¼è®¡ç®—ã€‚]]></content>
      <tags>
        <tag>PBR</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[3Dç¾æœ¯äººå‘˜Technical Artistï¼ˆTAæŠ€æœ¯ç¾æœ¯ï¼‰çš„å­¦ä¹ ä¹‹æ—…ï¼ˆ1ï¼‰]]></title>
    <url>%2F2018%2F06%2F03%2FTA-1%2F</url>
    <content type="text"><![CDATA[æ–‡ç« é’ˆå¯¹äºæœ‰ä¸€å®š3Dç¾æœ¯åŸºç¡€ï¼Œå¹¶äº†è§£æ¬¡æ—¶ä»£æ¸¸æˆåˆ¶ä½œæµç¨‹çš„å¼€å‘è€…ï¼Œéœ€è¦å…·å¤‡ä»¥ä¸‹çŸ¥è¯†åŸºç¡€ï¼šäº†è§£3Då»ºæ¨¡ï¼Œä»¥åŠæ‹“æ‰‘æµç¨‹ï¼Œè´´å›¾åˆ¶ä½œã€‚ç›¸å…³è½¯ä»¶3DMAX,ZB,substancepainte,psç­‰ã€‚TAæ˜¯ç¾æœ¯å’Œç¨‹åºä¹‹é—´æ²Ÿé€šçš„æ¡¥æ¢ã€‚ç¾æœ¯åŒå­¦éœ€è¦ä¸€äº›æ›´åŠ æ–¹ä¾¿ï¼Œå¯è§†åŒ–æ›´å¼ºçš„å·¥å…·ï¼Œä¾‹å¦‚æ‹“æ‰‘çš„å·¥å…·ï¼Œå„ä½éƒ½çŸ¥é“MAXé‡Œæœ‰ä¸€ä¸ªçŸ³å¢¨å·¥å…·æ˜¯å¯ä»¥ç”¨äºæ‹“æ‰‘çš„ï¼Œä½†æ˜¯æ“ä½œçŸ³å¢¨å·¥å…·æ‹“æ‰‘æ˜¯ä¸€ä»¶å¾ˆç—›è‹¦çš„äº‹ï¼Œè¿™æ—¶å€™æœ‰ä¸€ä¸ªæ’ä»¶å·¥å…·èƒ½ç»™è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¾‹å¦‚wrapitçš„æ‹“æ‰‘æ’ä»¶ã€‚æ­£å› ä¸ºæœ‰äº†è¿™ä¸ªæ’ä»¶å·¥å…·ï¼Œæˆ‘ä»¬å°±ä¸ç”¨æŠŠæ¨¡å‹å¯¼å…¥Topogunåœ¨å†æ¬¡è¿›è¡ŒäºŒæ¬¡æ“ä½œï¼Œè€Œç¼–å†™è¿™ä¸ªæ’ä»¶å°±å¯ä»¥ç®—ä½œTAäººå‘˜æ‰€è¦å»åšçš„ä¸€ä»¶äº‹ã€‚]]></content>
      <tags>
        <tag>-TA</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity ShaderLab]]></title>
    <url>%2F2018%2F05%2F19%2FUnity3D-ShaderLab%2F</url>
    <content type="text"><![CDATA[CGç±»å‹ Type Description float 32ä½æµ®ç‚¹æ•°æ® half 16ä½æµ®ç‚¹æ•°æ® int 32ä½æ•´å½¢æ•°æ® fixed 12ä½å®šç‚¹æ•° bool å¸ƒå°”æ•°æ® sampler çº¹ç†å¯¹è±¡çš„å¥æŸ„ï¼Œåˆ†ä¸ºsamplerã€sampler1Dã€sampler2Dã€sampler3Dã€samplerCUBEå’ŒsamplerRECTã€‚ float2x4 matrix // è¡¨ç¤º2x4é˜¶çŸ©é˜µï¼ŒåŒ…å«8ä¸ªfloatç±»å‹æ•°æ® ä½¿ç”¨æŠ€å·§ï¼š ç²¾åº¦å¤Ÿç”¨å°±å¥½ é¢œè‰²å’Œå•ä½å‘é‡ï¼Œä½¿ç”¨fixed å…¶ä»–æƒ…å†µï¼Œå°½é‡ä½¿ç”¨halfï¼ˆå³èŒƒå›´åœ¨[-6ä¸‡ï¼Œï¼‰ å†…ç½®æ•°æ®ç±»å‹ï¼šåŸºäºåŸºç¡€æ•°æ®ç±»å‹ï¼Œå¦‚float3ï¼Œè¡¨ç¤ºfloat3ç±»å‹çš„ä¸‰ç»´å‘é‡ï¼›åŒç†ï¼Œbool2è¡¨ç¤ºå¸ƒå°”ç±»å‹çš„äºŒç»´å‘é‡ã€‚ å‘é‡æœ€é•¿ä¸èƒ½è¶…è¿‡å››å…ƒï¼Œå¦‚float5 vector; //ç¼–è¯‘é”™è¯¯ Swizzleæ“ä½œç¬¦ï¼šå®ƒå¯ä»¥å°†ä¸€ä¸ªå‘é‡çš„æˆå‘˜å–å‡ºç»„æˆä¸€ä¸ªæ–°çš„å‘é‡ã€‚å¯¹äºåæ ‡æˆ–è€…è§’åº¦ç­‰å…¶å®ƒå¤šç»´å‘é‡ï¼ŒSwizzleæ“ä½œç¬¦(.)åæ¥xã€yã€zã€wåˆ†åˆ«è¡¨ç¤ºåŸå§‹å‘é‡çš„ç¬¬ä¸€ä¸ªã€ç¬¬äºŒä¸ªã€ç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªå…ƒç´ ï¼›åŒæ ·ï¼Œå¯¹äºé¢œè‰²å¯ä»¥åæ¥rã€gã€bå’Œaæ¥è¡¨ç¤ºåŒæ ·çš„ç´¢å¼•ã€‚ä¾‹å¦‚ï¼š float4(a,b,c,d).xwz ç­‰ä»·äº float4(a,d,c) float4(a,b,c,d).xxy ç­‰ä»·äº float4(a,a,b) Swizzleæ“ä½œç¬¦åªèƒ½å¯¹ç»“æ„ä½“å’Œå‘é‡ä½¿ç”¨ï¼Œä¸èƒ½å¯¹æ•°ç»„ä½¿ç”¨ã€‚]]></content>
      <categories>
        <category>Unity Shader</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•ç³»ç»Ÿåœ°è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ï¼Ÿ]]></title>
    <url>%2F2018%2F05%2F17%2FHow-to-systematically-optimize-performance%2F</url>
    <content type="text"><![CDATA[è¿è¡Œå¸§ç‡ä½ä½é…æœºå™¨ä¸Šè¿è¡Œå¸§ç‡æ¯”è¾ƒä½æ˜¯å¸¸è§é—®é¢˜ã€‚a)é¦–å…ˆæ˜¯åšåˆ†ç±»ï¼ŒæŠŠé€šå¸¸çš„é—®é¢˜å½’ç±»åˆ°å‡ ç§ç“¶é¢ˆä¸‹æ¥åšè®¨è®ºï¼šGPU Boundã€CPU Boundã€Bandwidth Boundï¼Œè¿˜æœ‰Memoryã€‚è¿™ç§åˆ†ç±»æ–¹å¼åŸºæœ¬æ˜¯æŒ‰ç…§ç¡¬ä»¶èµ„æºçš„æ–¹å¼æ¥è¿›è¡Œçš„ã€‚b)GPU Boundæ˜¯ä¸€ç§ç›®å‰æ‰‹æ¸¸ä¸­æ¯”è¾ƒå¸¸è§çš„ç“¶é¢ˆï¼Œé™ä½åˆ†è¾¨ç‡å¦‚æœå¯¹å¸§ç‡æœ‰éå¸¸æ˜æ˜¾çš„æå‡çš„è¯ï¼Œéå¸¸å¤§çš„å¯èƒ½å°±æ˜¯GPU Boundã€‚c)CPU Bound,é™ä½åˆ†è¾¨ç‡çš„æ–¹å¼å¦‚æœå¹¶ä¸èƒ½æé«˜å¸§ç‡ï¼Œé‚£ä¹ˆå¯èƒ½æ˜¯CPU Boundã€‚CPUé€šå¸¸å’ŒDraw Callç¥¥å…‰ï¼Œæˆ–è€…å’Œå¤æ‚çš„æ¸¸æˆé€»è¾‘ç›¸å…³ï¼Œé€šè¿‡Unityçš„Profilerå·¥å…·å¯ä»¥æ¯”è¾ƒæ˜ç¡®çœ‹å‡ºæ˜¯å¦æ˜¯CPU Boundï¼Œä»¥åŠè¿™äº›è®¡ç®—æ—¶é—´éƒ½æ¶ˆè€—åœ¨äº†å“ªé‡Œã€‚TimeLineå¯ä»¥æ¯”è¾ƒæ˜ç¡®çš„çœ‹åˆ°ç“¶é¢ˆï¼ˆ5.3.8æ²¡æœ‰ï¼Œæš‚æ—¶ä¸ç ”ç©¶ï¼‰d)Bandwith Bound åœ¨æ‰‹æ¸¸ä¸­ä¹Ÿæ¯”è¾ƒå¸¸è§ï¼Œä¸€ç§æ¯”è¾ƒç®€å•çš„åˆ¤æ–­æ–¹å¼æ˜¯ä½¿ç”¨NVIDIA Tegra Graphics Debuggerè¿™ä¸ªå·¥å…·ï¼ˆå¯¹äºTegraç¡¬ä»¶æ›´å‹å¥½ï¼Œä½†æ˜¯æ¯”è¾ƒéš¾æ‰¾ã€‚ã€‚ã€‚ï¼‰ä¸­å°†æ‰€æœ‰è´´å›¾æ›¿æ¢æˆ2 * 2çš„å¤§å°ï¼Œå¦‚æœå¸§ç‡æœ‰æ˜æ˜¾æå‡å¯èƒ½æ˜¯Bandwidthç“¶é¢ˆã€‚å½“ç„¶ä¹Ÿå¯ä»¥è‡ªå·±åä»£ç æ‰€å›¾æ¥ç¡®è®¤ï¼Œæ¯”å¦‚ä½¿ç”¨Unityçš„Quality Settingé‡Œçš„Texture Qualityã€‚e)å†…å­˜å°±ç”¨Unityåœ°Profileræ¥çœ‹å§ï¼Œä¸è¿‡è¿™ä¸ªå¯¹äºå¸§ç‡æ²¡ä»€ä¹ˆå½±å“ã€‚]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[3Dæ•°å­¦ï¼šå›¾å½¢ä¸æ¸¸æˆå¼€å‘]]></title>
    <url>%2F2018%2F05%2F16%2F3d-math-base-graph-game-develop%2F</url>
    <content type="text"><![CDATA[9.4.1 4Dé½æ¬¡ç©ºé—´4.1.3èŠ‚æ›¾æåˆ°ï¼Œ4Då‘é‡æœ‰4ä¸ªåˆ†é‡ï¼Œå‰3ä¸ªæ˜¯æ ‡å‡†çš„x,yå’Œzåˆ†é‡ï¼Œç¬¬å››ä¸ªæ˜¯wï¼Œæœ‰æ—¶ç§°ä½œé½æ¬¡åæ ‡ã€‚ ä¸ºäº†ç†è§£æ ‡å‡†3Dåæ ‡æ˜¯æ€æ ·æ‰©å±•åˆ°4Dåæ ‡çš„ï¼Œè®©æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹2Dä¸­çš„é½æ¬¡åæ ‡ï¼Œå®ƒçš„å½¢å¼ä¸º(x,y,w)ã€‚æƒ³è±¡åœ¨3Dä¸­w=1å¤„çš„æ ‡å‡†2Då¹³é¢ï¼Œå®é™…çš„2Dç‚¹(x,y)ç”¨é½æ¬¡åæ ‡è¡¨ç¤º(x,y,1)ï¼Œå¯¹äºå“ªäº›ä¸åœ¨w=1å¹³é¢çš„ç‚¹ï¼Œåˆ™å°†å®ƒä»¬æŠ•å½±åˆ°w=1å¹³é¢ä¸Šã€‚æ‰€ä»¥é½æ¬¡åæ ‡(x,y,w)æ˜ å°„çš„å®é™…2Dç‚¹ä¸º(x/w,y/w)ã€‚å¦‚å›¾9.2æ‰€ç¤ºã€‚ å› æ­¤ï¼Œç»™å®šä¸€ä¸ª2Dç‚¹(x,y)ï¼Œé½æ¬¡ç©ºé—´ä¸­æœ‰æ— æ•°å¤šä¸ªç‚¹ä¸ä¹‹å¯¹åº”ã€‚æ‰€æœ‰ç‚¹çš„å½¢å¼éƒ½ä¸º(kx,ky,k),kâ‰ 0ã€‚è¿™äº›ç‚¹æ„æˆä¸€æ¡ç©¿è¿‡é½æ¬¡åŸç‚¹çš„ç›´çº¿ã€‚ å½“w=0æ—¶ï¼Œé™¤æ³•æœªå®šä¹‰ï¼Œå› æ­¤ä¸å­˜åœ¨å®é™…çš„2Dç‚¹ã€‚ç„¶è€Œï¼Œå¯ä»¥å°†2Dé½æ¬¡ç‚¹(x,y,0)è§£é‡Šä¸ºâ€œä½äºæ— ç©·è¿œçš„ç‚¹â€ï¼Œå®ƒæè¿°äº†ä¸€ä¸ªæ–¹å‘è€Œä¸æ˜¯ä¸€ä¸ªä½ç½®ã€‚åœ¨ä¸‹èŠ‚ä¸­ä¼šæœ‰å…³äºè¯¥ç‚¹çš„æ›´å¤šè®¨è®ºã€‚ 4Dåæ ‡çš„åŸºæœ¬æ€æƒ³ç›¸åŒã€‚å®é™…çš„3Dç‚¹èƒ½è¢«è®¤ä¸ºæ˜¯åœ¨4Dä¸­w=1â€œå¹³é¢â€ä¸Šã€‚4Dç‚¹çš„å½¢å¼ä¸º(x,y,z,w)ï¼Œå°†4Dç‚¹æŠ•å½±åˆ°è¿™ä¸ªâ€œå¹³é¢â€ä¸Šå¾—åˆ°ç›¸åº”çš„å®é™…3Dç‚¹(x/w,y/w,z/w)ã€‚w=0æ—¶4Dç‚¹è¡¨ç¤ºâ€œæ— é™è¿œç‚¹â€ï¼Œå®ƒæè¿°äº†ä¸€ä¸ªæ–¹å‘è€Œä¸æ˜¯ä¸€ä¸ªä½ç½®ã€‚ é½æ¬¡åæ ‡å’Œé€šè¿‡é™¤ä»¥wæ¥æŠ•å½±æ—¶å¾ˆæœ‰è¶£çš„ï¼Œé‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ä½¿ç”¨4Dåæ ‡å‘¢ï¼Ÿæœ‰ä¸¤ä¸ªåŸºæœ¬åŸå› ä½¿å¾—æˆ‘ä»¬è¦ä½¿ç”¨4Då‘é‡å’Œ4X4çŸ©é˜µã€‚ç¬¬ä¸€ä¸ªåŸå› å®é™…ä¸Šå°±æ˜¯å› ä¸ºå®ƒæ˜¯ä¸€ç§æ–¹ä¾¿çš„è®°æ³•ï¼Œè¿™ä¹Ÿæ˜¯ä¸‹ä¸€èŠ‚å°†è¦è®¨è®ºçš„ã€‚ 9.4.2 4X4å¹³ç§»çŸ©é˜µå›å¿†8.8.1èŠ‚ï¼Œ3X3å˜æ¢çŸ©é˜µè¡¨ç¤ºçš„æ˜¯çº¿æ€§å˜æ¢ï¼Œä¸åŒ…å«å¹³ç§»ã€‚å› ä¸ºçŸ©é˜µä¹˜æ³•çš„æ€§è´¨ï¼Œé›¶å‘é‡æ€»æ˜¯å˜æ¢æˆé›¶å‘é‡ï¼Œå› æ­¤ï¼Œä»»ä½•èƒ½ç”¨çŸ©é˜µä¹˜æ³•è¡¨è¾¾çš„å˜æ¢éƒ½ä¸åŒ…å«å¹³ç§»ã€‚è¿™å¾ˆä¸å¹¸ï¼Œå› ä¸ºçŸ©é˜µä¹˜æ³•å’Œå®ƒçš„é€†æ˜¯ä¸€ç§éå¸¸æ–¹ä¾¿çš„å·¥å…·ï¼Œä¸ä»…å¯ä»¥ç”¨æ¥å¤ç”¨å¤æ‚çš„å˜æ¢ç»„åˆæˆç®€å•çš„å•ä¸€å˜æ¢ï¼Œè¿˜å¯ä»¥æ“çºµåµŒå…¥å¼åæ ‡ç³»é—´çš„å…³ç³»ã€‚å¦‚æœèƒ½æ‰¾åˆ°ä¸€ç§æ–¹æ³•å°†3X3å˜æ¢çŸ©é˜µè¿›è¡Œæ‰©å±•ï¼Œä½¿å®ƒèƒ½å¤„ç†å¹³ç§»ï¼Œè¿™å°†æ˜¯]]></content>
  </entry>
  <entry>
    <title><![CDATA[ã€åŸºäºç‰©ç†çš„æ¸²æŸ“ï¼ˆPBRï¼‰ç™½çš®ä¹¦ã€‘ï¼ˆä¸€ï¼‰å¼€ç¯‡ï¼šPBRæ ¸å¿ƒçŸ¥è¯†ä½“ç³»æ€»ç»“ä¸æ¦‚è§ˆ]]></title>
    <url>%2F2018%2F05%2F14%2FPBR-Guide-Vol1%2F</url>
    <content type="text"><![CDATA[å…‰ä¸ç‰©è´¨å…‰ä¸ç‰©è´¨ï¼šåŸºäºç‰©ç†çš„æ¸²æŸ“ä¸ç€è‰²ç†è®ºå…‰æ˜¯ä¸€ç§å¤æ‚çš„ç°è±¡ï¼Œå®ƒåŒæ—¶å±•ç°å‡ºæ³¢ä¸ç²’å­ä¸¤ç§ç‰¹æ€§ã€‚äºæ˜¯ï¼Œä¸ºäº†æè¿°å…‰çš„è¡¨ç°ç‰¹æ€§ï¼Œäººä»¬å»ºç«‹äº†å„ç§æ¨¡å‹ã€‚ä½œä¸ºæè´¨è‰ºæœ¯å®¶ï¼Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„æ˜¯å…‰çº¿æ¨¡å‹ï¼ˆLight Ray Modelï¼‰å› ä¸ºå®ƒæè¿°äº†å…‰ä¸ç‰©è´¨çš„äº¤äº’ä½œç”¨ã€‚å¯¹æˆ‘ä»¬æ¥è¯´ï¼Œç†è§£å…‰çº¿å¦‚ä½•ä¸ç‰©è´¨è¡¨é¢äº¤äº’éå¸¸é‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬çš„å·¥ä½œæ˜¯åˆ›ä½œæè¿°ç‰©ä½“è¡¨é¢çš„æè´¨ã€‚æˆ‘ä»¬åˆ›ä½œå‡ºçš„çº¹ç†ä¸æè´¨å†è™šæ‹Ÿä¸–ç•Œä¸­ä¸å…‰äº¤äº’ï¼Œå¯¹å…‰çº¿è¡¨ç°ç‰¹æ•ˆç†è§£çš„è¶Šå¤šï¼Œåˆ›ä½œå‡ºçš„æè´¨å°±ä¼šæ›´å¥½ã€‚å†è¿™ç¯‡æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬ä¼šè®¨è®ºç‰©ç†ç†è®ºï¼Œè€ŒåŸºäºç‰©ç†çš„æ¸²æŸ“(physically-based rendering)(PBR)æ¨¡å‹æ­£æ˜¯å»ºç«‹åœ¨å…¶ä¸Šçš„ã€‚æˆ‘ä»¬ä»å…‰çº¿å¼€å§‹ï¼Œé€æ­¥è®²è§£PBRä¸­çš„å…³é”®ç‚¹ã€‚ å…‰çº¿å…‰çº¿æ¨¡å‹é˜æ˜ï¼Œå…‰çº¿åœ¨å‡åŒ€é€æ˜ä»‹è´¨ï¼ˆå¦‚ç©ºæ°”ï¼‰ä¸­çš„è½¨è¿¹ä¸ºç›´çº¿ã€‚å…‰çº¿æ¨¡å‹åŒæ—¶ä¹Ÿé˜æ˜ï¼Œå½“å…‰ä¼ æ’­é‡åˆ°è¡¨é¢æ˜¯ï¼Œä¾‹å¦‚é‡åˆ°ä¸é€æ˜ç‰©ä½“æˆ–ç©¿è¿‡ä¸åŒä»‹è´¨å¦‚ä»ç©ºæ°”æŠ˜å°„å…¥æ°´ä¸­ï¼Œå…‰çš„è¡¨ç°æ˜¯å¯é¢„æµ‹çš„ã€‚è¿™æ ·ï¼Œå½“å…‰ä»ä¸€ä¸ªèµ·ç‚¹ä¼ æ’­åˆ°æŸç‚¹æœ€ç»ˆè½¬æ¢ä¸ºå…¶ä»–å½¢å¼ä¾‹å¦‚çƒ­æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒçš„è½¨è¿¹è§†è§‰åŒ–ã€‚å‡»ä¸­ä¸€ä¸ªè¡¨é¢çš„å…‰çº¿æˆä¸ºå…¥å°„å…‰ï¼Œè€Œå®ƒå‡»ä¸­çš„è§’åº¦ç§°ä¸ºå…¥å°„è§’ï¼Œå¦‚å›¾01æ‰€ç¤ºã€‚ä¸€æ¡å…‰çº¿å°„å…¥ä¸¤ä¸ªä¸åŒä»‹è´¨é—´çš„å¹³é¢äº¤ç•Œé¢ã€‚å…ˆæ”¾å‡ºPBRçŸ¥è¯†ä½“ç³»çš„æ¶æ„å›¾ï¼š ç³»åˆ—æ–‡ç« å‰è¨€åŸºäºç‰©ç†çš„æ¸²æŸ“ï¼ˆPhysically Based Renderingï¼ŒPBRï¼‰æŠ€æœ¯ï¼Œè‡ªè¿ªå£«å°¼SIGGRAPH 2012ä¸Šæå‡ºäº†è‘—åçš„â€œè¿ªå£«å°¼åŸåˆ™çš„BRDFï¼ˆDisney Principled BRDFï¼‰â€ä¹‹åï¼Œç”±äºå…¶é«˜åº¦çš„æ˜“ç”¨æ€§ä»¥åŠæ–¹ä¾¿çš„å·¥ä½œæµï¼Œå·²ç»è¢«ç”µå½±å’Œæ¸¸æˆä¸šç•Œå¹¿æ³›çš„ä½¿ç”¨ã€‚http://renderwonk.com/publications/s2010-shading-course/https://blog.selfshadow.com/publications/s2012-shading-course/https://blog.selfshadow.com/publications/s2013-shading-course/https://blog.selfshadow.com/publications/s2014-shading-course/https://blog.selfshadow.com/publications/s2015-shading-course/https://blog.selfshadow.com/publications/s2016-shading-course/https://blog.selfshadow.com/publications/s2017-shading-course/ã€ŠPhysically Based Rendering:From Theory to Implementation,Third Editionã€‹è¿™æœ¬ä¹¦ä¸“æ³¨ç¦»çº¿æ¸²æŸ“ï¼Œå®æ—¶æ¸²æŸ“åªèƒ½ç”¨åˆ°é‡Œé¢å¾ˆå°‘çš„ä¸€éƒ¨åˆ†ã€‚http://www.pbr-book.org/3ed-2018/contents.htmlã€ŠReal-Time Rendering 4thã€‹ä¸­PBRçš„ç›¸å…³ç« èŠ‚ã€ŠPhysically Based Shader Development for Unityã€‹ï¼Œä¸»è¦æ˜¯PBRåœ¨Unityå¼•æ“ä¸­çš„ä½¿ç”¨ï¼Œè€Œä¸”æ˜¯ä»¥Surface Shaderçš„æ–¹å¼ï¼Œå‡†å…¥é—¨çº§ï¼Œæ¯”è¾ƒæµ…ã€‚ PBRçŸ¥è¯†ä½“ç³»æ¦‚è§ˆè¿™ç¯‡æ–‡ç« æ¥ä¸‹æ¥çš„éƒ¨åˆ†ï¼Œæ˜¯è¿™ä¸ªç³»åˆ—æ–‡ä»¶PBRçŸ¥è¯†ä½“ç³»çš„ç²¾åæµ“ç¼©ç‰ˆã€‚æ¶‰åŠå…«ä¸ªéƒ¨åˆ†çš„å†…å®¹ï¼š æ ¸å¿ƒPBRç†è®º æ¸²æŸ“æ–¹ç¨‹ä¸BxDF è¿ªå£«å°¼åŸåˆ™çš„BxDFï¼ˆDisney Principled BxDFï¼‰ æ¼«åå°„BRDFæ¨¡å‹ï¼ˆDiffuse BRDFï¼‰ é•œé¢åå°„BRDFæ¨¡å‹ï¼ˆSpecular BRDFï¼‰ åŸºäºç‰©ç†çš„ç¯å¢ƒå…‰ç…§ï¼ˆPhysically Based Environment Lightingï¼‰ ç¦»çº¿æ¸²æŸ“ç›¸å…³ï¼ˆOffline Rendering Relatedï¼‰ è¿›é˜¶æ¸²æŸ“ä¸»é¢˜ï¼ˆAdvanced Rendering Topicsï¼‰ PBRæ ¸å¿ƒç†è®ºä¸æ¸²æŸ“åŸç†PBRæ ¸å¿ƒçŸ¥è¯†ä½“ç³»çš„ç¬¬ä¸€éƒ¨åˆ†è‡ªç„¶æ˜¯PBRçš„æ ¸å¿ƒç†è®ºä»¥åŠç›¸å…³çš„æ¸²æŸ“åŸç†ã€‚ åŸºäºç‰©ç†çš„æ¸²æŸ“ï¼ˆPhysically Based Renderingï¼ŒPBRï¼‰æ˜¯æŒ‡ä½¿ç”¨åŸºäºç‰©ç†åŸç†å’Œå¾®å¹³é¢ç†è®ºå»ºæ¨¡çš„ç€è‰²/å…‰ç…§æ¨¡å‹ï¼Œä»¥åŠä½¿ç”¨ä»ç°å®ä¸­æµ‹é‡çš„è¡¨é¢å‚æ•°æ¥å‡†ç¡®è¡¨ç¤ºçœŸå®ä¸–ç•Œæè´¨çš„æ¸²æŸ“ç†å¿µã€‚ä»¥ä¸‹æ˜¯å¯¹PBRåŸºç¡€ç†å¿µçš„æ¦‚æ‹¬ï¼š å¾®å¹³é¢ç†è®ºï¼ˆMicrofacet Theoryï¼‰ã€‚å¾®å¹³é¢ç†è®ºæ˜¯å°†ç‰©ä½“è¡¨é¢å»ºæ¨¡æˆæ— æ•°å¾®è§‚å°ºåº¦ä¸Šæœ‰éšæœºæœå‘çš„ç†æƒ³é•œé¢åå°„çš„å°å¹³é¢ï¼ˆmicrofacetï¼‰çš„ç†è®ºã€‚åœ¨å®é™…çš„PBRå·¥ä½œæµä¸­ï¼Œè¿™ç§ç‰©ä½“è¡¨é¢çš„ä¸è§„åˆ™æ€§ç”¨ç²—ç³™åº¦è´´å›¾æˆ–è€…é«˜å…‰è´´å›¾æ¥è¡¨ç¤ºã€‚ èƒ½é‡å®ˆæ’ï¼ˆEnergy Conservationï¼‰ã€‚å‡ºå°„å…‰çº¿çš„èƒ½é‡æ°¸è¿œä¸èƒ½è¶…è¿‡å…¥å°„å…‰çº¿çš„èƒ½é‡ã€‚éšç€ç²—ç³™åº¦çš„ä¸Šå‡é•œé¢åå°„åŒºåŸŸçš„é¢ç§¯ä¼šå¢åŠ ï¼Œä½œä¸ºå¹³è¡¡ï¼Œé•œé¢åå°„åŒºåŸŸçš„å¹³å‡äº®åº¦åˆ™ä¼šä¸‹é™ã€‚ è²æ¶…å°”åå°„ï¼ˆFresnel Reflectanceï¼‰ã€‚å…‰çº¿ä»¥ä¸åŒè§’åº¦å…¥å°„ä¼šæœ‰ä¸åŒçš„åå°„ç‡ã€‚ç›¸åŒçš„å…¥å°„è§’åº¦ï¼Œä¸åŒçš„ç‰©è´¨ä¹Ÿä¼šæœ‰ä¸åŒçš„åå°„ç‡ã€‚ä¸‡ç‰©çš†æœ‰è²æ¶…å°”åå°„ã€‚F0æ˜¯å³0åº¦è§’å…¥å°„çš„è²æ¶…å°”åå°„ã€‚å¤§å¤šæ•°éé‡‘å±çš„F0èŒƒå›´æ˜¯0.02~0.04ï¼Œå¤§å¤šæ•°é‡‘å±çš„F0èŒƒå›´æ˜¯0.7~1.0ã€‚ çº¿æ€§ç©ºé—´ï¼ˆLiner Spaceï¼‰ã€‚å…‰ç…§è®¡ç®—å¿…é¡»åœ¨çº¿æ€§ç©ºé—´å®Œæˆï¼Œshaderä¸­è¾“å…¥çš„gammaç©ºé—´çš„è´´å›¾æ¯”å¦‚æ¼«åå°„è´´å›¾éœ€è¦è¢«è½¬æˆçº¿æ€§ç©ºé—´ï¼Œåœ¨å…·ä½“æ“ä½œæ—¶éœ€è¦æ ¹æ®ä¸åŒå¼•æ“å’Œæ¸²æŸ“å™¨çš„ä¸åŒåšä¸åŒçš„æ“ä½œã€‚è€Œæè¿°ç‰©ä½“å±æ€§çš„è´´å›¾å¦‚ç²—ç³™åº¦ï¼Œé«˜å…‰è´´å›¾ï¼Œé‡‘å±è´´å›¾ç­‰å¿…é¡»ä¿è¯æ˜¯çº¿æ€§ç©ºé—´ã€‚ è‰²è°ƒæ˜ å°„ï¼ˆTone Mappingï¼‰ã€‚ä¹Ÿç§°è‰²è°ƒå¤åˆ¶ï¼ˆtone reproductionï¼‰ï¼Œæ˜¯å°†å®½èŒƒå›´çš„ç…§æ˜çº§åˆ«æ‹Ÿåˆåˆ°å±å¹•æœ‰é™è‰²åŸŸå†…çš„è¿‡ç¨‹ã€‚å› ä¸ºåŸºäºHDRæ¸²æŸ“å‡ºæ¥çš„äº®åº¦å€¼ä¼šè¶…è¿‡æ˜¾ç¤ºå™¨èƒ½å¤Ÿç°å®æœ€å¤§äº®åº¦ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨è‰²è°ƒæ˜ å°„ï¼Œå°†å…‰ç…§ç»“æœä»HDRè½¬æ¢å¾®æ˜¾ç¤ºå™¨èƒ½å¤Ÿæ­£å¸¸æ˜¾ç¤ºçš„LDRã€‚ ç‰©è´¨çš„å…‰å­¦ç‰¹æ€§ï¼ˆSubstance Optical Propertiesï¼‰ã€‚ç°å®ä¸–ç•Œä¸­æœ‰ä¸åŒç±»å‹çš„ç‰©è´¨å¯åˆ†ä¸ºä¸‰å¤§ç±»ï¼šç»ç¼˜ä½“ï¼ˆInsulatorsï¼‰ï¼ŒåŠå¯¼ä½“ï¼ˆsemi-conductorsï¼‰å’Œå¯¼ä½“ï¼ˆconductorsï¼‰ã€‚åœ¨æ¸²æŸ“å’Œæ¸¸æˆé¢†åŸŸï¼Œæˆ‘ä»¬ä¸€èˆ¬åªå¯¹å…¶ä¸­çš„ä¸¤ä¸ªæ„Ÿå…´è¶£ï¼šå¯¼ä½“ï¼ˆé‡‘å±ï¼‰å’Œç»ç¼˜ä½“ï¼ˆç”µè§£è´¨ï¼Œéé‡‘å±ï¼‰ã€‚å…¶ä¸­éé‡‘å±å…·æœ‰å•è‰²/ç°è‰²é•œé¢åå°„é¢œè‰²ã€‚è€Œé‡‘å±å…·æœ‰å½©è‰²çš„é•œé¢åå°„é¢œè‰²ã€‚å³éé‡‘å±çš„F0æ˜¯ä¸€ä¸ªfloatã€‚è€Œé‡‘å±çš„F0æ˜¯ä¸€ä¸ªfloat3ï¼Œå¦‚ä¸‹å›¾ã€‚ å…‰ä¸éå…‰å­¦å¹³å¦è¡¨é¢çš„äº¤äº’åŸç†å…‰åœ¨ä¸éå…‰å­¦å¹³å¦è¡¨é¢ï¼ˆNon-Optically-Flat Surfacesï¼‰çš„äº¤äº’æ—¶ï¼Œéå…‰å­¦å¹³å¦è¡¨é¢è¡¨ç°å¾—åƒä¸€ä¸ªå¾®å°çš„å…‰å­¦å¹³é¢è¡¨é¢çš„å¤§é›†åˆã€‚è¡¨é¢ä¸Šçš„æ¯ä¸ªç‚¹éƒ½ä¼šä»¥ç•¥å¾®ä¸åŒçš„æ–¹å‘å¯¹å…¥å°„å…‰åå°„ï¼Œè€Œæœ€ç»ˆçš„è¡¨é¢å¤–è§‚æ˜¯è®¸å¤šå…·æœ‰ä¸åŒè¡¨é¢å–å‘çš„ç‚¹çš„èšåˆç»“æœã€‚åœ¨å¾®è§‚å°ºåº¦ä¸Šï¼Œè¡¨é¢è¶Šç²—ç³™ï¼Œåå°„è¶Šæ¨¡ç³Šï¼Œå› ä¸ºè¡¨é¢å–å‘ä¸æ•´ä¸ªå®è§‚è¡¨é¢å–å‘çš„åç¦»æ›´å¼ºã€‚å›¾ç‰‡é¡¶éƒ¨æ‰€ç¤ºçš„è¡¨é¢ï¼Œè¡¨é¢ç›¸å¯¹å…‰æ»‘ï¼›è¡¨é¢å–å‘ä»…ç•¥æœ‰å˜åŒ–ï¼Œä»è€Œäº§ç”Ÿæ›´æ¸…æ™°çš„åå°„ã€‚å›¾ç‰‡åº•éƒ¨æ‰€ç¤ºçš„è¡¨é¢è¾ƒç²—ç³™ï¼›è¡¨é¢ä¸Šçš„ä¸åŒç‚¹å…·æœ‰å¹¿æ³›å˜åŒ–çš„æ–¹å‘å–å‘ï¼Œå¯¼è‡´åå°„å…‰æ–¹å‘çš„é«˜åº¦å˜åŒ–ï¼Œå¹¶å› æ­¤å¯¼è‡´æ¨¡ç³Šçš„åå°„ã€‚æ³¨æ„ï¼Œä¸¤ä¸ªè¡¨é¢åœ¨è‚‰çœ¼å¯è§å°ºåº¦ä¸‹çœ‹èµ·æ¥æ˜¯å…‰æ»‘çš„ï¼Œç²—ç³™åº¦å·®å¼‚ä»…åœ¨å¾®è§‚å°ºåº¦ä¸Šã€‚å‡ºäºç€è‰²çš„ç›®çš„ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå»ç”¨ç»Ÿè®¡æ–¹æ³•å¤„ç†è¿™ç§å¾®è§‚å‡ ä½•ç°è±¡ï¼Œå¹¶å°†è¡¨é¢è§†ä¸ºåœ¨æ¯ä¸ªç‚¹å¤„åœ¨å¤šä¸ªæ–¹å‘ä¸Šåå°„ï¼ˆå’ŒæŠ˜å°„ï¼‰å…‰ã€‚ä»è¡¨é¢åå°„çš„å…‰çš„è¡Œä¸ºå¾ˆå¥½ç†è§£ï¼Œé‚£ä¹ˆï¼Œä»è¡¨é¢æŠ˜å°„çš„å…‰ä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–ï¼Ÿè¿™å–å†³äºå¯¹è±¡æœ¬èº«çš„ç‰¹æ€§ï¼š å¯¹äºé‡‘å±ï¼ŒæŠ˜å°„ä¼šç«‹åˆ»è¢«å¸æ”¶-èƒ½é‡è¢«è‡ªç”±ç”µå­ç«‹å³å¸æ”¶ã€‚ å¯¹äºéé‡‘å±ï¼ˆä¹Ÿæˆä¸ºç”µä»‹è´¨æˆ–ç»ç¼˜ä½“ï¼‰ï¼Œä¸€æ—¦å…‰åœ¨å…¶å†…éƒ¨æŠ˜å°„ï¼Œå°±è¡¨ç°ä¸ºå¸¸è§„çš„å‚ä¸ä»‹è´¨ï¼Œè¡¨ç°å‡ºå¸æ”¶å’Œæ•£å°„ä¸¤ç§è¡Œä¸ºã€‚ æ¼«åå°„å’Œæ¬¡è¡¨é¢æ•£å°„æœ¬è´¨ç›¸åŒå¦å¤–ï¼Œæ¼«åå°„å’Œæ¬¡è¡¨é¢æ•£å°„å…¶å®æ˜¯ç›¸åŒçš„ç‰©ç†ç°è±¡ï¼Œæœ¬è´¨éƒ½æ˜¯æŠ˜å°„å…‰çš„æ¬¡è¡¨é¢æ•£å°„çš„ç»“æœã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯ç›¸å¯¹äºè§‚å¯Ÿå°ºåº¦çš„æ•£å°„è·ç¦»ã€‚æ•£å°„è·ç¦»ç›¸è¾ƒäºåƒç´ æ¥è¯´å¾®ä¸è¶³é“ï¼Œæ¬¡è¡¨é¢æ•£å°„ä¾¿å¯ä»¥è¿‘ä¼¼ä¸ºæ¼«åå°„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…‰çš„æŠ˜å°„ç°è±¡ï¼Œå»ºæ¨¡ä¸ºæ¼«åå°„è¿˜æ˜¯æ¬¡è¡¨é¢æ•£å°„ï¼Œå–å†³äºè§‚å¯Ÿçš„å°ºåº¦ï¼Œå¦‚ä¸‹å›¾ã€‚åœ¨å·¦ä¸Šè§’ï¼Œåƒç´ ï¼ˆå¸¦æœ‰çº¢è‰²è¾¹æ¡†çš„ç»¿è‰²åœ†å½¢ï¼‰å¤§äºå…‰æƒ³ç¦»å¼€è¡¨é¢ä¹‹å‰æ‰€ç»è¿‡çš„è·ç¦»ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥å‡è®¾å‡ºå°„å…‰ä»å…¥å£ç‚¹ï¼ˆå³ä¸Šï¼‰å°„å‡ºï¼Œå¯ä»¥å½“ä½œæ¼«åå°„ï¼Œç”¨å±€éƒ¨ç€è‰²æ¨¡å‹å¤„ç†ã€‚åœ¨åº•éƒ¨ï¼Œåƒç´ å°äºæ•£å°„è·ç¦»ï¼›å¦‚æœéœ€è¦æ›´çœŸå®çš„ç€è‰²æ•ˆæœï¼Œåˆ™ä¸èƒ½å¿½ç•¥è¿™äº›è·ç¦»çš„å­˜åœ¨ï¼Œéœ€å½“ä½œæ¬¡è¡¨é¢æ•£å°„ç°è±¡è¿›è¡Œå¤„ç†ã€‚ ä¸€ã€PBRçš„èŒƒç•´ï¼ˆScope of PBRï¼‰å¯’éœœï¼ˆFrostbiteï¼‰å¼•æ“åœ¨SIGGRAPH 2014çš„åˆ†äº«ã€ŠMoving Frostbite to PBRã€‹ä¸­æå‡ºï¼ŒåŸºäºç‰©ç†çš„æ¸²æŸ“çš„èŒƒç•´ï¼Œç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š åŸºäºç‰©ç†çš„æè´¨ï¼ˆMaterialï¼‰ åŸºäºç‰©ç†çš„å…‰ç…§ï¼ˆLightingï¼‰ åŸºäºç‰©ç†é€‚é…çš„æ‘„åƒæœºï¼ˆCameraï¼‰ å®Œæ•´çš„è¿™ä¸‰è€…ï¼Œæ‰æ˜¯çœŸæ­£å®Œæ•´çš„åŸºäºç‰©ç†çš„æ¸²æŸ“ç³»ç»Ÿã€‚è€Œå¾ˆå¤šåŒå­¦ä¸€æåˆ°PBRï¼Œå°±è¯´PBRå°±æ˜¯é•œé¢åå°„é‡‡ç”¨å¾®å¹³é¢Cook-Torranceæ¨¡å‹ï¼Œå…¶å®æ˜¯ä¸å¤ªä¸¥è°¨çš„ã€‚äºŒã€æ¸²æŸ“æ–¹ç¨‹ä¸BxDFPBRæ ¸å¿ƒçŸ¥è¯†ä½“ç³»çš„ç¬¬äºŒéƒ¨åˆ†æ˜¯æ¸²æŸ“æ–¹ç¨‹ä¸BxDFã€‚æ¸²æŸ“æ–¹ç¨‹ä½œä¸ºæ¸²æŸ“é¢†åŸŸä¸­çš„é‡è¦ç†è®ºï¼Œå°†BxDFä»£å…¥æ¸²æŸ“æ–¹ç¨‹æ˜¯æ±‚è§£æ¸²æŸ“é—®é¢˜çš„ä¸€èˆ¬æ–¹æ³•ã€‚ 2.1æ¸²æŸ“æ–¹ç¨‹ä¸åå°„æ–¹ç¨‹æ¸²æŸ“æ–¹ç¨‹ï¼ˆThe Rendering Equationï¼‰ä½œä¸ºæ¸²æŸ“é¢†åŸŸä¸­çš„é‡è¦ç†è®ºï¼Œå…¶æè¿°äº†å…‰èƒ½åœ¨åœºæ™¯ä¸­çš„æµåŠ¨ï¼Œæ˜¯æ¸²æŸ“ä¸­ä¸å¯æ„ŸçŸ¥æ–¹é¢çš„æœ€æŠ½è±¡çš„æ­£å¼è¡¨ç¤ºã€‚æ ¹æ®å…‰å­¦çš„ç‰©ç†å­¦åŸç†ï¼Œæ¸²æŸ“æ–¹ç¨‹åœ¨ç†è®ºä¸Šç»™å‡ºäº†ä¸€ä¸ªå®Œç¾çš„ç»“æœï¼Œè€Œå„ç§å„æ ·çš„æ¸²æŸ“æŠ€æœ¯ï¼ŒçŸ¥è¯†è¿™ä¸ªç†æƒ³ç»“æœçš„ä¸€ä¸ªè¿‘ä¼¼ã€‚ æ¸²æŸ“æ–¹ç¨‹çš„ç‰©ç†åŸºç¡€æ˜¯èƒ½é‡å®ˆæ’å®šå¾‹ã€‚åœ¨ä¸€ä¸ªç‰¹å®šçš„ä½ç½®å’Œæ–¹å‘ï¼Œå‡ºå°„å…‰$L_o$æ˜¯è‡ªå‘å…‰$L_e$ä¸åå°„å…‰çº¿ä¹‹å’Œï¼Œåå°„å…‰çº¿æœ¬èº«æ˜¯å„ä¸ªæ–¹å‘çš„å…¥å°„å…‰Liä¹‹å’Œè¯šæ„è¡¨é¢åå°„ç‡åŠå…¥å°„è§’ã€‚ è¿™ä¸ªæ–¹ç¨‹é‡‘å›½äº¤å‰ç‚¹å°†å‡ºå°„å…‰çº¿ä¸å…¥å°„å…‰çº¿è”ç³»åœ¨ä¸€èµ·ï¼Œå®ƒä»£è¡¨äº†åœºæ™¯ä¸­å…¨éƒ¨çš„å…‰çº¿ä¼ è¾“ã€‚æ‰€æœ‰æ›´åŠ å®Œå–„çš„ç®—æ³•éƒ½å¯ä»¥çœ‹ä½œæ˜¯è¿™ä¸ªæ–¹ç¨‹çš„ç‰¹æ®Šå½¢å¼çš„è§£ã€‚ æŸä¸€ç‚¹pçš„æ¸²æŸ“æ–¹ç¨‹ï¼Œå¯ä»¥è¡¨ç¤ºä¸ºï¼š$L_o=L_e + $$\int_\Omega $${f_r\cdot L_i \cdot (w_i\cdot n)\cdot dw_i}$å…¶ä¸­ï¼š $L_o$æ˜¯pç‚¹çš„å‡ºå°„å…‰äº®åº¦ã€‚ $L_e$æ˜¯pç‚¹çš„å‘å‡ºçš„å…‰äº®åº¦ã€‚ $f_r$æ˜¯pç‚¹å…¥å°„æ–¹å‘åˆ°å‡ºå°„æ–¹å‘å…‰çš„åå°„æ¯”ä¾‹ï¼Œå³BxDFï¼Œä¸€èˆ¬ä¸ºBRDFã€‚ $L_i$æ˜¯pç‚¹å…¥å°„å…‰äº®åº¦ã€‚ $(w_i\cdot n)$æ˜¯å…¥å°„è§’å¸¦æ¥çš„å…¥å°„å…‰è¡°å‡ã€‚ $\int_\Omega $$â€¦dw_i$æ˜¯å…¥å°„æ–¹å‘åŠçƒç§¯åˆ†ï¼ˆå¯ä»¥ç†è§£ä¸ºæ— ç©·å°çš„ç´¯åŠ å’Œï¼‰ã€‚ è€Œåœ¨å®æ—¶æ¸²æŸ“ä¸­ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„åå°„æ–¹ç¨‹ï¼ˆThe Reflctance Equationï¼‰ï¼Œåˆ™æ˜¯æ¸²æŸ“æ–¹ç¨‹çš„ç®€åŒ–çš„ç‰ˆæœ¬ï¼Œæˆ–è€…è¯´æ˜¯ä¸€ä¸ªç‰¹ä¾‹ï¼š$L_o=L_e + $$\int_\Omega $${f_r\cdot L_i \cdot (w_i\cdot n)\cdot dw_i}$åŒæ ·ï¼Œå…¶ä¸­ï¼š $L_o$æ˜¯pç‚¹çš„å‡ºå°„å…‰äº®åº¦ã€‚ $f_r$æ˜¯pç‚¹å…¥å°„æ–¹å‘åˆ°å‡ºå°„æ–¹å‘å…‰çš„åå°„æ¯”ä¾‹ï¼Œå³BxDFï¼Œä¸€èˆ¬ä¸ºBRDFã€‚ $L_i$æ˜¯pç‚¹å…¥å°„å…‰äº®åº¦ã€‚ $(w_i\cdot n)$æ˜¯å…¥å°„è§’å¸¦æ¥çš„å…¥å°„å…‰è¡°å‡ã€‚ $\int_\Omega $$â€¦dw_i$æ˜¯å…¥å°„æ–¹å‘åŠçƒç§¯åˆ†ï¼ˆå¯ä»¥ç†è§£ä¸ºæ— ç©·å°çš„ç´¯åŠ å’Œï¼‰ã€‚ 2.2 BxDFBxDFä¸€èˆ¬è€Œè¨€æ˜¯å¯¹BRDFã€BTDFã€BSDFã€BSSRDFç­‰å‡ ç§åŒå‘åå°„åˆ†å¸ƒå‡½æ•°çš„ä¸€ä¸ªç»Ÿä¸€çš„è¡¨ç¤ºã€‚å…¶ä¸­ï¼ŒBSDFå¯ä»¥çœ‹ä½œBRDFå’ŒBTDFæ›´ä¸€èˆ¬çš„å½¢å¼ï¼Œè€Œä¸”BSDF=BRDF+BTDFã€‚è€ŒBSSRDFå’ŒBRDFçš„ä¸åŒä¹‹å¤„åœ¨äºï¼ŒBSSRDFå¯ä»¥æŒ‡å®šä¸åŒçš„å…‰çº¿å…¥å°„ä½ç½®å’Œå‡ºå°„ä½ç½®ã€‚åœ¨ä¸Šè¿°è¿™äº›BxDFä¸­ï¼ŒBRDFæœ€ä¸ºç®€å•ï¼Œä¹Ÿæœ€ä¸ºå¸¸ç”¨ã€‚å› ä¸ºæ¸¸æˆå’Œç”µå½±ä¸­çš„å¤§å¤šæ•°ç‰©ä½“éƒ½æ˜¯ä¸é€æ˜çš„ï¼Œç”¨BRDFå°±å®Œå…¨è¶³å¤Ÿã€‚è€ŒBSDFã€BTDFã€BSSRDFå¾€å¾€æ›´å¤šç”¨äºåŠé€æ˜æè´¨å’Œæ¬¡è¡¨é¢æ•£å°„æè´¨ã€‚æˆ‘ä»¬æ—¶å¸¸è®¨è®ºçš„PBRä¸­çš„BxDFï¼Œä¸€èˆ¬éƒ½ä¸ºBRDFï¼Œå¯¹äºè¿›é˜¶çš„ä¸€äº›æè´¨çš„æ¸²æŸ“ï¼Œæ‰ä¼šè®¨è®ºBSDFç­‰å…¶å®ƒä¸‰ç§BxDFã€‚å¦å¤–ï¼ŒBxDFå³ä¸Šæ–‡æ‰€ç¤ºæ¸²æŸ“æ–¹ç¨‹ä»¥åŠåå°„æ–¹ç¨‹ä¸­çš„$f_r$é¡¹ã€‚ 2.3 BRDFçš„åˆ†ç±» ä¸‰ã€è¿ªå£«å°¼åŸåˆ™çš„BxDFï¼ˆDisney Principled BxDFï¼‰PBRæ ¸å¿ƒçŸ¥è¯†ä½“ç³»çš„ç¬¬ä¸‰éƒ¨åˆ†æ˜¯è¿ªå£«å°¼åŸåˆ™çš„BxDFã€‚è¿ªå£«å°¼åŠ¨ç”»å·¥ä½œå®¤åœ¨SIGGRAPH 2012ä¸Šè‘—åçš„talkã€ŠPhysically-based shading at Disneyã€‹ä¸­æå‡ºäº†è¿ªå£«å°¼åŸåˆ™çš„BRDFï¼ˆDisney Principled BRDFï¼‰,å¥ å®šäº†åç»­æ¸¸æˆè¡Œä¸šå’Œç”µå½±è¡Œä¸šPBRçš„æ–¹å‘å’Œæ ‡å‡†ã€‚äº†è§£Disney Principled BxDFï¼Œæ˜¯æ·±å…¥ç†è§£PBRçš„é‡è¦ä¸€ç¯ã€‚åŸºäºç‰©ç†çš„æ¸²æŸ“ï¼Œå…¶å®æ—©åœ¨20ä¸–çºªå°±å·²ç»åœ¨å›¾å½¢å­¦ä¸šç•Œæœ‰äº†ä¸€äº›å¥—è·¯æ€’ï¼Œ2010å¹´åœ¨SIGGRAPHä¸Šå°±å·²ç»æœ‰å…¬å¼€è®¨è®ºçš„Courseã€ŠSIGGRAPH 2010 Course:Physically-Based Shading Models in File and Game Productionã€‹ï¼Œè€Œç›´åˆ°2012~2013å¹´ï¼Œæ‰æ­£å¼è¿›å…¥å¤§å®—çš„è§†é‡ï¼Œæ¸æ¸è¢«ç”µå½±å’Œæ¸¸æˆä¸šç•Œå¹¿æ³›ä½¿ç”¨ã€‚ è¿ªå£«å°¼åŠ¨ç”»å·¥ä½œå®¤åˆ™æ˜¯è¿™æ¬¡PBRé©å‘½çš„é‡è¦æ¨åŠ¨è€…ã€‚è¿ªå£«å°¼çš„Brent Burleyä¸SIGGRAPH 2012ä¸Šè¿›è¡Œäº†è‘—åçš„talkã€ŠPhysically-based shading at Disneyã€‹ï¼Œæå‡ºäº†è¿ªå£«å°¼åŸåˆ™çš„BRDFï¼ˆDisney Principled BRDFï¼‰ï¼Œç”±äºå…¶é«˜åº¦çš„é€šç”¨æ€§ï¼Œå°†æè´¨å¤æ‚çš„ç‰©ç†å±æ€§ï¼Œç”¨éå¸¸ç›´è§‚çš„å°‘é‡å˜é‡è¡¨è¾¾äº†å‡ºæ¥ï¼ˆå¦‚é‡‘å±åº¦metallicå’Œç²—ç³™åº¦roughnessï¼‰ï¼Œåœ¨ç”µå½±ä¸šç•Œå’Œæ¸¸æˆä¸šç•Œå¼•èµ·äº†ä¸å°çš„è½°åŠ¨ã€‚ä»æ­¤ï¼ŒåŸºäºç‰©ç†çš„æ¸²æŸ“æ­£å¼è¿›å…¥å¤§ä¼—çš„è§†é‡ã€‚ åœ¨2012å¹´å—åˆ°Dineyçš„å¯å‘åï¼Œä»¥ä¸‹æ˜¯ä¸»æµæ¸¸æˆå¼•æ“ä»ä¼ ç»Ÿæ¸²æŸ“è½¬ç§»åˆ°åŸºäºç‰©ç†çš„æ¸²æŸ“æ—¶é—´èŠ‚ç‚¹ï¼š [SIGGRAPH 2013]UE4 : [Real shading in unreal engine 4] [SIGGRAPH 2014] Frostbite ï¼ˆå¯’éœœï¼‰:[Moving Frostbite to PBR] [GDC 2014] Unity : [Physically Based Shading in Unity] 3.1 è¿ªå£«å°¼åŸåˆ™çš„BRDFï¼ˆDisney Principled BRDFï¼‰3.1.1 Disney Principled BRDFæ ¸å¿ƒç†å¿µåœ¨2012å¹´è¿ªå£«å°¼åŸåˆ™çš„BRDFè¢«æå‡ºä¹‹å‰ï¼ŒåŸºäºç‰©ç†çš„æ¸²æŸ“éƒ½éœ€è¦å¤§é‡å¤æ‚è€Œä¸ç›´è§‚çš„å‚æ•°ï¼Œæ­¤æ—¶PBRçš„ä¼˜åŠ¿ï¼Œå¹¶æ²¡æœ‰é‚£ä¹ˆæ˜æ˜¾ã€‚ åœ¨2012å¹´è¿ªå£«å°¼æå‡ºï¼Œä»–ä»¬çš„ç€è‰²æ¨¡å‹æ˜¯è‰ºæœ¯å¯¼å‘ï¼ˆArt Directableï¼‰çš„ï¼Œè€Œä¸ä¸€å®šè¦æ˜¯å®Œå…¨ç‰©ç†æ­£ç¡®ï¼ˆphysically correctï¼‰çš„ï¼Œå¹¶ä¸”å¯¹ä¸ºå¹³é¢BRDFçš„å„é¡¹éƒ½è¿›è¡Œäº†ä¸¥è°¨çš„è°ƒæŸ¥ï¼Œå¹¶æå‡ºäº†æ¸…æ™°æ˜ç¡®è€Œç®€å•çš„è§£å†³æ–¹æ¡ˆã€‚ è¿ªå£«å°¼çš„ç†å¿µæ˜¯å¼€å‘ä¸€ç§â€œåŸåˆ™æ€§â€çš„æ˜“ç”¨æ¨¡å‹ï¼Œè€Œä¸æ˜¯ä¸¥æ ¼çš„ç‰©ç†æ¨¡å‹ã€‚æ­£å› ä¸ºè¿™ç§è‰ºæœ¯å¯¼å‘çš„æ˜“ç”¨æ€§ï¼Œèƒ½è®©ç¾æœ¯åŒå­¦éå¸¸ç›´è§‚çš„ä½¿ç”¨å°‘é‡å‚æ•°ï¼Œä»¥åŠéå¸¸æ ‡å‡†åŒ–çš„å·¥ä½œæµï¼Œå°±èƒ½å¿«é€Ÿå®ç°æ¶‰åŠå¤§é‡ä¸åŒæè´¨çš„çœŸå®æ„Ÿçš„æ¸²æŸ“å·¥ä½œã€‚è€Œè¿™å¯¹äºä¼ ç»Ÿçš„ç€è‰²æ¨¡å‹æ¥è¯´ï¼Œæ˜¯ä¸å¯èƒ½å®Œæˆçš„ä»»åŠ¡ã€‚ è¿ªå£«å°¼åŸåˆ™çš„BRDFï¼ˆDisney Principled BRDFï¼‰æ ¸å¿ƒç†å¿µå¦‚ä¸‹ï¼š åº”ä½¿ç”¨ç›´è§‚çš„å‚æ•°ï¼Œè€Œä¸æ˜¯ç‰©ç†ç±»çš„æ™¦æ¶©å‚æ•°ã€‚ å‚æ•°åº”å°½å¯èƒ½å°‘ã€‚ å‚æ•°åœ¨å…¶åˆç†èŒƒå›´å†…åº”è¯¥ä¸º0åˆ°1ã€‚ å…è®¸å‚æ•°åœ¨æœ‰æ„ä¹‰æ—¶è¶…å‡ºæ­£å¸¸çš„åˆç†èŒƒå›´ã€‚ æ‰€æœ‰å‚æ•°ç»„åˆåº”å°½å¯èƒ½å¥å£®å’Œåˆç†ã€‚ ä»¥ä¸Šäº”æ¡åŸåˆ™ï¼Œå¾ˆå¥½åœ°ä¿è¯äº†è¿ªå£«å°¼åŸåˆ™çš„BRDFçš„æ˜“ç”¨æ€§ã€‚ 3.1.2 Disney Principled BRDFå‚æ•°ä»¥ä¸Šç†å¿µä¸ºåŸºç¡€ï¼Œè¿ªå£«å°¼åŠ¨ç”»å·¥ä½œå®¤å¯¹æ¯ä¸ªå‚æ•°çš„æ·»åŠ è¿›è¡Œäº†æŠŠå…³ï¼Œæœ€ç»ˆå¾—åˆ°äº†é¢œè‰²å‚æ•°ï¼ˆbaseColorï¼‰å’Œä¸‹é¢æè¿°çš„æ˜¯ä¸ªæ ‡é‡å‚æ•°ï¼š baseColorï¼ˆåŸºç¡€è‰²ï¼‰ï¼šè¡¨é¢é¢œè‰²ï¼Œé€šå¸¸ç”±çº¹ç†è´´å›¾æä¾›ã€‚ subsurfaceï¼ˆæ¬¡è¡¨é¢ï¼‰ï¼šä½¿ç”¨æ¬¡è¡¨é¢è¿‘ä¼¼æ§åˆ¶æ¼«åå°„å½¢çŠ¶ã€‚ metallicï¼ˆé‡‘å±åº¦ï¼‰ï¼šé‡‘å±ï¼ˆ0=ç”µä»‹è´¨ï¼Œ1=é‡‘å±ï¼‰ã€‚è¿™æ˜¯ä¸¤ç§ä¸åŒæ¨¡å‹ä¹‹é—´çš„çº¿æ€§æ··åˆã€‚é‡‘å±æ¨¡å‹æ²¡æœ‰æ¼«åå°„æˆåˆ†ï¼Œå¹¶ä¸”è¿˜å…·æœ‰ç­‰äºåŸºç¡€è‰²ç€è‰²å…¥å°„é•œé¢åå°„ã€‚ specularï¼ˆé•œé¢åå°„å¼ºåº¦ï¼‰ï¼šå…¥å°„é•œé¢åå°„ä¸¤ã€‚ç”¨äºå–ä»£æŠ˜å°„ç‡ã€‚ specularTintï¼ˆé•œé¢åå°„é¢œè‰²ï¼‰ï¼šå¯¹ç¾æœ¯æ§åˆ¶çš„è®©æ­¥ï¼Œç”¨äºå¯¹åŸºç¡€è‰²ï¼ˆbase colorï¼‰çš„å…¥å°„é•œé¢åå°„è¿›è¡Œé¢œè‰²æ§åˆ¶ã€‚æ å°„é•œé¢åå°„ä»ç„¶æ—¶éå½©è‰²çš„ã€‚ roughnessï¼ˆç²—ç³™åº¦ï¼‰ï¼šè¡¨é¢ç²—ç³™åº¦ï¼Œæ§åˆ¶æ¼«åå°„å’Œé•œé¢åå°„ã€‚ anisotropicï¼ˆå„å‘å¼‚æ€§å¼ºåº¦ï¼‰ï¼šå„å‘å¼‚æ€§å¼ºåº¦ã€‚ç”¨äºæ§åˆ¶é•œé¢åå°„é«˜å…‰çš„çºµæ¨ªæ¯”ã€‚ï¼ˆ0=å„å‘åŒæ€§ï¼Œ1=æœ€å¤§å„å‘å¼‚æ€§ï¼‰ sheenï¼ˆå…‰æ³½åº¦ï¼‰ï¼šä¸€ç§é¢å¤–çš„æ å°„åˆ†é‡ï¼ˆgrazing componentï¼‰ï¼Œä¸»è¦ç”¨äºå¸ƒæ–™ã€‚ sheenTineï¼ˆå…‰æ³½é¢œè‰²ï¼‰ï¼šå¯¹sheenï¼ˆå…‰æ³½åº¦ï¼‰çš„é¢œè‰²æ§åˆ¶ã€‚ clearcoatï¼ˆæ¸…æ¼†å¼ºåº¦ï¼‰ï¼šæœ‰ç‰¹æ®Šç”¨é€”çš„ç¬¬äºŒä¸ªé•œé¢æ³¢ç“£ï¼ˆspecular lobeï¼‰ã€‚ clearcoatGlossï¼ˆæ¸…æ¼†å…‰æ³½åº¦ï¼‰ï¼šæ§åˆ¶é€æ˜æ¶‚å±‚å…‰æ³½åº¦ï¼Œ0=â€œç¼é¢ï¼ˆsatinï¼‰â€å¤–è§‚ï¼Œ1=â€œå…‰æ³½ï¼ˆglossï¼‰â€å¤–è§‚ã€‚ æ¯ä¸ªå‚æ•°çš„æ•ˆæœçš„æ¸²æŸ“ç¤ºä¾‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ 3.2 è¿ªå£«å°¼åŸåˆ™çš„BSDFï¼ˆDisney Principled BSDFï¼‰éšåçš„2015å¹´ï¼Œè¿ªå£«å°¼åŠ¨ç”»å·¥ä½œå®¤åœ¨Disney Principled BRDFçš„åŸºç¡€ä¸Šè¿›è¡Œäº†ä¿®è®¢ï¼Œæå‡ºäº†Disney Principled BSDF [Extenting the Disney BRDF to a BSDF with Integrated Subsurface Scattering,2015] ä»¥ä¸‹æ˜¯å¼€æºä¸‰ç»´åŠ¨ç”»è½¯ä»¶Blenderå®ç°çš„Disney Principled BSDFçš„å›¾ç¤ºï¼š å››ã€æ¼«åå°„BRDFæ¨¡å‹ï¼ˆDiffuse BRDFï¼‰ä¸ºäº†æ±‚è§£æ¸²æŸ“æ–¹ç¨‹ï¼Œéœ€è¦åˆ†åˆ«æ±‚è§£Diffuse BRDFå’ŒSpecular BRDFã€‚æ‰€ä»¥PBRæ ¸å¿ƒçŸ¥è¯†ä½“ç³»çš„ç¬¬å››éƒ¨åˆ†æ˜¯Diffuse BRDFã€‚Diffuse BRDFå¯ä»¥åˆ†ä¸ºä¼ ç»Ÿå‹å’ŒåŸºäºç‰©ç†å‹ä¸¤å¤§ç±»ã€‚å…¶ä¸­ï¼Œä¼ ç»Ÿå‹ä¸»è¦æ˜¯æ€»æ‰€å‘¨çŸ¥çš„Lambertã€‚è€ŒåŸºäºç‰©ç†å‹ï¼Œä»1994å¹´çš„Oren Nayarå¼€å§‹ï¼Œè¿™é‡Œä¸€ç›´ç»Ÿè®¡åˆ°ä»Šå¹´ï¼ˆ2019å¹´ï¼‰ã€‚å…¶ä¸­è¾ƒæ–°çš„æœ‰GDC 2017ä¸Šæå‡ºçš„é€‚ç”¨äºGGX+Smithçš„åŸºäºç‰©ç†çš„æ¼«åå°„æ¨¡å‹ï¼ˆPBR diffuse for GGX+Smithï¼‰ï¼Œä¹ŸåŒ…å«äº†æœ€è¿‘åœ¨SIGGRAPH2018ä¸Šæå‡ºçš„ï¼Œæ¥è‡ªã€Šä½¿å‘½å¬å”¤ï¼šäºŒæˆ˜ã€‹çš„å¤šæ•£å°„æ¼«åå°„BRDFï¼ˆMultiScattrering Diffuse BRDFï¼‰ï¼š Oren Nayar[1994] Simplified Oren-Nayar[2012] Disney Diffuse[2012] Renormalized Disney Diffuse[2014] Gotanda Diffuse[2014] PBR diffuse for GGX+Smith[2017] MultiScattrering Diffuse BRDF[2018] äº”ã€é•œé¢åå°„BRDFæ¨¡å‹ï¼ˆSpecular BRDFï¼‰PBRæ ¸å¿ƒçŸ¥è¯†æé†’çš„ç¬¬äº”éƒ¨åˆ†æ˜¯Specular BRDFã€‚è¿™ä¹Ÿæ˜¯åŸºäºç‰©ç†çš„æ¸²æŸ“é¢†åŸŸä¸­æœ€æ´»è·ƒï¼Œæœ€ä¸»è¦çš„éƒ¨åˆ†ã€‚ä¸Šå›¾ä¸­åŠ ç²—éƒ¨åˆ†ä¸ºç›®å‰ä¸šç•Œè¾ƒä¸ºä¸»æµçš„æ¨¡å‹ã€‚ æ¸¸æˆä¸šç•Œç›®å‰æœ€ä¸»æµçš„åŸºäºç‰©ç†çš„é•œé¢åå°„BRDFæ¨¡å‹æ˜¯åŸºäºå¾®å¹³é¢ç†è®ºï¼ˆmicrofacet theoryï¼‰çš„Microfacet Cook-Torrance BRDFã€‚ è€Œå¾®å¹³é¢ç†è®ºï¼ˆmicrofacet theoryï¼‰æºè‡ªå°†å¾®è§‚å‡ ä½•ï¼ˆmicrogeometryï¼‰å»ºæ¨¡ä¸ºå¾®å¹³é¢ï¼ˆmicrofacetsï¼‰çš„é›†åˆæ€æƒ³ï¼Œä¸€èˆ¬ç”¨äºæè¿°æ¥è‡ªéå…‰å­¦å¹³å¦ï¼ˆnon-optically flatï¼‰è¡¨é¢çš„è¡¨é¢åå°„ã€‚ å¾®å¹³é¢ç†è®ºçš„åŸºæœ¬å‡è®¾æ˜¯å¾®è§‚å‡ ä½•ï¼ˆmicrogeometryï¼‰çš„å­˜åœ¨ï¼Œå¾®è§‚å‡ ä½•çš„å°ºåº¦å°äºè§‚å¯Ÿå°ºåº¦ï¼ˆä¾‹å¦‚ç€è‰²åˆ†è¾¨ç‡ï¼‰ï¼Œä½†å¤§äºå¯è§å…‰æ³¢é•¿çš„å°ºåº¦ï¼ˆå› æ­¤åº”ç”¨å‡ ä½•å…‰å­¦å¦‚è¡å°„ä¸€æ ·çš„æ³¢æ•ˆåº”ç­‰å¯ä»¥å¿½ç•¥ï¼‰ã€‚ä¸”å¾®å¹³é¢ç†è®ºåœ¨2013å¹´å’Œä»¥å‰æ—¶ä»…ç”¨äºæ¨å¯¼å•åå°„ï¼ˆsingle-bounceï¼‰è¡¨é¢åå°„çš„è¡¨è¾¾å¼ï¼›è€Œéšç€é¢†åŸŸçš„æ·±å…¥ï¼Œæœ€è¿‘å‡ å¹´ä¹Ÿå‡ºç°äº†ä½¿ç”¨microfacetç†è®ºå¯¹å¤šæ¬¡åå¼¹è¡¨é¢çš„ä¸€äº›æ¢è®¨ã€‚ ç”±äºå‡è®¾å¾®è§‚å‡ ä½•å°ºåº¦æ˜æ˜¾å¤§äºå¯è§å…‰æ³¢é•¿ï¼Œå› æ­¤å¯ä»¥å°†æ¯ä¸ªè¡¨é¢ç‚¹è§†ä¸ºå…‰å­¦å¹³å¦çš„ã€‚å¦‚ä¸Šæ–‡æ‰€è¿°ï¼Œå…‰å­¦å¹³å¦è¡¨é¢å°†å…‰çº¿åˆ†æˆä¸¤ä¸ªæ–¹å‘ï¼šåå°„å’ŒæŠ˜å°„ã€‚ æ¯ä¸ªè¡¨é¢ç‚¹å°†æ¥è‡ªç»™å®šè¿›å…¥æ–¹å‘çš„å…‰åå°„åˆ°å•ä¸ªå‡ºå°„æ–¹å‘ï¼Œè¯¥æ–¹å‘å–å†³äºå¾®è§‚å‡ ä½•æ³•çº¿ï¼ˆmicrogeometry normalï¼‰mçš„æ–¹å‘ã€‚åœ¨è®¡ç®—BRDFé¡¹æ—¶ï¼ŒæŒ‡å®šå…‰æ–¹å‘Iå’Œè§†å›¾æ–¹å‘vã€‚è¿™æ„å‘³ç€æ‰€æœ‰è¡¨é¢ç‚¹ï¼Œåªæœ‰é‚£äº›æ°å¥½æ­£ç¡®æœå‘å¯ä»¥å°†Iåå°„åˆ°vçš„é‚£äº›å°å¹³é¢å¯èƒ½æœ‰åŠ©äºBRDFå€¼ï¼ˆå…¶ä»–æ–¹å‘æœ‰æ­£æœ‰è´Ÿï¼Œç§¯åˆ†ä¹‹åï¼Œç›¸äº’æŠµæ¶ˆï¼‰ã€‚ åœ¨ä¸‹å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™äº›â€œæ­£ç¡®æœå‘â€çš„è¡¨é¢ç‚¹çš„è¡¨é¢æ³•çº¿mæ­£å¥½ä½äºIå’Œvä¹‹é—´çš„ä¸­é—´ä½ç½®ã€‚Iå’Œvä¹‹é—´çš„çŸ¢é‡æˆä¸ºåŠçŸ¢é‡ï¼ˆhalf-vectorï¼‰æˆ–åŠè§’çŸ¢é‡ï¼ˆhalf-angle vectorï¼‰ï¼›æˆ‘ä»¬å°†å…¶è¡¨ç¤ºä¸ºhã€‚ å¹¶éæ‰€æœ‰çš„m = hçš„è¡¨é¢ç‚¹éƒ½ä¼šç§¯æåœ°å¯¹åå°„åšå‡ºå…±äº«ï¼›ä¸€ä¸ªè¢«Iæ–¹å‘ï¼ˆé˜´å½±shadowingï¼‰ï¼Œvæ–¹å‘ï¼ˆæ©è”½maskingï¼‰æˆ–ä¸¤è€…çš„å…¶ä»–è¡¨é¢åŒºåŸŸé˜»æŒ¡ã€‚Microfacetç†è®ºå‡è®¾æ‰€æœ‰è¢«é®è”½çš„å…‰ï¼ˆshadowed lightï¼‰éƒ½ä»é•œé¢åå°„é¡¹ä¸­æ¶ˆå¤±ï¼›å®é™…ä¸Šï¼Œç”±äºå¤šæ¬¡è¡¨é¢åå°„ï¼Œå…¶ä¸­ä¸€äº›æœ€ç»ˆå°†æ˜¯å¯è§çš„ï¼Œä½†è¿™åœ¨ç›®å‰å¸¸è§çš„å¾®å¹³é¢ç†è®ºä¸­ä¸€èˆ¬å¹¶æœªå»è€ƒè™‘ï¼Œå„ç§ç±»å‹çš„å…‰è¡¨é¢ç›¸äº’ä½œç”¨å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ä¸Šå›¾åœ¨å·¦ä¾§ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸€äº›è¡¨é¢ç‚¹ä»Içš„æ–¹å‘è¢«é®æŒ¡ï¼Œå› ä¸ºå®ƒä»¬è¢«é®æŒ¡å¹¶ä¸”ä¸æ¥å—å…‰ï¼ˆå› æ­¤å®ƒä»¬ä¸èƒ½åå°„ä»»ä½•ï¼‰ã€‚åœ¨ä¸­é—´ï¼Œæˆ‘ä»¬çœ‹åˆ°ä»è§†å›¾æ–¹å‘vçœ‹ä¸åˆ°ä¸€äº›è¡¨é¢ç‚¹ï¼Œå› æ­¤å½“ç„¶ä¸ä¼šçœ‹åˆ°ä»å®ƒä»¬åå°„çš„ä»»ä½•å…‰ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œè¿™äº›è¡¨é¢ç‚¹å¯¹BRDFæ²¡æœ‰å…±äº«ã€‚å®é™…ä¸Šï¼Œè™½ç„¶é˜´å½±åŒºåŸŸæ²¡æœ‰æ¥å—ä»Iæ¥å—ä»»ä½•ç›´å°„å…‰ï¼Œä½†å®ƒä»¬ç¡®å®æ¥å—ï¼ˆå¹¶å› æ­¤åå°„ï¼‰ä»å…¶ä»–è¡¨é¢åŒºåŸŸåå°„çš„å…‰ï¼ˆå¦‚å³å›¾æ‰€ç¤ºï¼‰ã€‚microfacetç†è®ºå¿½ç•¥äº†è¿™äº›äº’ç›¸åå°„ã€‚ 5.1 ä»ç‰©ç†ç°è±¡åˆ°BRDFåˆ©ç”¨è¿™äº›å‡è®¾ï¼ˆå±€éƒ¨å…‰å­¦å¹³å¦è¡¨é¢ï¼Œæ²¡æœ‰ç›¸äº’åå°„ï¼‰ï¼Œå¯ä»¥å¾ˆå®¹æ˜“æ¨å¯¼å‡ºä¸€ä¸ªè¢«æˆä¸ºMicrofacet Cook-Torrnace BRDFçš„ä¸€èˆ¬å½¢å¼çš„Specular BRDFé¡¹ã€‚æ­¤Specular BRDFå…·æœ‰ä»¥ä¸‹å½¢å¼ï¼š $f(l,v)={D(h)F(v,h)G(l,v,h)\over 4(n\cdot l)(n \cdot v)}$ å…¶ä¸­ï¼š D(h):æ³•çº¿åˆ†å¸ƒå‡½æ•°ï¼ˆNormal Distribution Functionï¼‰ï¼Œæè¿°å¾®é¢å…ƒå‘ç°åˆ†å¸ƒçš„æ¦‚ç‡ï¼Œå³æ­£ç¡®æœå‘çš„å‘ç°çš„æµ“åº¦ã€‚å³å…·æœ‰æ­£ç¡®æœå‘ï¼Œèƒ½å¤Ÿå°†æ¥è‡ªIçš„å…‰åå°„åˆ°vçš„è¡¨é¢ç‚¹çš„ç›¸å¯¹äºè¡¨é¢é¢ç§¯çš„æµ“åº¦ã€‚ F(I,h):è²æ¶…å°”æ–¹ç¨‹ï¼ˆFresnel Equationï¼‰ï¼Œæè¿°ä¸åŒçš„è¡¨é¢è§’ä¸‹è¡¨é¢æ‰€åå°„çš„å…‰çº¿æ‰€å çš„æ¯”ç‡ã€‚ G(l,v,h):å‡ ä½•å‡½æ•°ï¼ˆGeometry Functionï¼‰ï¼Œæè¿°å¾®å¹³é¢è‡ªæˆé˜´å½±çš„å±æ€§ï¼Œå³m=hçš„æœªè¢«é®è”½çš„è¡¨é¢ç‚¹çš„ç™¾åˆ†æ¯”ã€‚ åˆ†æ¯4(n\cdot l)(n \cdot v):æ ¡æ­£å› å­ï¼ˆcorrectionfactorï¼‰ï¼Œä½œä¸ºå¾®è§‚å‡ ä½•çš„å±€éƒ¨ç©ºé—´å’Œæ•´ä¸ªå®è§‚è¡¨é¢çš„å±€éƒ¨ç©ºé—´ä¹‹é—´å˜æ¢çš„å¾®å¹³é¢é‡çš„æ ¡æ­£ã€‚ å…³äºCook-Torrance BRDFï¼Œéœ€è¦å¼ºè°ƒçš„ä¸¤ç‚¹æ³¨æ„äº‹é¡¹ï¼š å¯¹äºåˆ†æ¯ä¸­çš„ç‚¹å‡»ï¼Œä»…ä»…é¿å…è´Ÿå€¼æ—¶ä¸å¤Ÿçš„ï¼Œä¹Ÿå¿…é¡»é¿å…é›¶å€¼ã€‚é€šå¸¸é€šè¿‡åœ¨å¸¸è§„çš„clampæˆ–ç»å¯¹å€¼æ“ä½œä¹‹åæ·»åŠ éå¸¸å°çš„æ­£å€¼æ¥å®Œæˆã€‚ Microfacet Cook-Torrance BRDFæ˜¯å®è·µä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„æ¨¡å‹ï¼Œå®é™…ä¸Šä¹Ÿæ˜¯äººä»¬å¯ä»¥æƒ³åˆ°çš„æœ€ç®€å•çš„å¾®å¹³é¢æ¨¡å‹ã€‚å®ƒä»…å¯¹å‡ ä½•å…‰å­¦ç³»ç»Ÿä¸­çš„å•å±‚ä¸ºè¡¨é¢ä¸Šçš„å•ä¸ªæ•£å°„è¿›è¡Œå»ºæ¨¡ï¼Œæ²¡æœ‰è€ƒè™‘å¤šæ¬¡æ•£å°„ï¼Œåˆ†å±‚æè´¨ï¼Œä»¥åŠè¡å°„ã€‚Microfacetæ¨¡å‹ï¼Œå®é™…ä¸Šè¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ã€‚ ä¸‹é¢å¯¹Microfacet Cook-Torrance BRDFä¸­çš„Dã€Fã€Gé¡¹åˆ†åˆ«è¿›è¡Œç®€å•è¯´æ˜ã€‚ 5.2 Specular Dæ³•çº¿åˆ†å¸ƒå‡½æ•°ï¼ˆNormal Distribution Function, NDFï¼‰Dçš„å¸¸è§æ¨¡å‹å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼š Beckmann[1963] Blinn-Phong[1977] GGX[2007]/Trowbridge-Reitz[1975] Generalized-Trowbridge-Reitz(GTR)[2012] Anisotropic Beckmann[2012] Anisotropic GGX[20115] å…¶ä¸­ï¼Œä¸šç•Œè¾ƒä¸ºä¸»æµçš„æ³•çº¿åˆ†å¸ƒå‡½æ•°æ˜¯GGXï¼ˆTrowbridge-Reitzï¼‰ï¼Œå› ä¸ºå…·æœ‰æ›´å¥½çš„é«˜å…‰é•¿å°¾ï¼š $D_{GGX} = {\alpha \over (\pi(n \cdot m)^2(\alpha^2 - 1) + 1)^2}$ å¦å¤–ï¼Œéœ€è¦å¼ºè°ƒä¸€ç‚¹ã€‚Normal Distribution Functionæ­£ç¡®çš„ç¿»è¯‘æ˜¯æ³•çº¿åˆ†å¸ƒå‡½æ•°ï¼Œè€Œä¸æ˜¯æ­£å¤ªåˆ†å¸ƒå‡½æ•°ã€‚googleç¿»è¯‘ç­‰ç¿»è¯‘è½¯ä»¶ä¼šå°†Normal Distribution Functionç¿»è¯‘æˆæ­£æ€åˆ†å¸ƒå‡½æ•°ï¼Œè€Œä¸å°‘ä¸­æ–‡èµ„æ–™å°±è·Ÿç€ç¿»è¯‘æˆæ­£æ€åˆ†å¸ƒå‡½æ•°ï¼Œè¿™æ˜¯é”™è¯¯çš„ã€‚ å…¶å®ï¼Œä¸€äº›å‚è€ƒæ–‡çŒ®ä¼šä½¿ç”¨æœ¯è¯­â€œæ³•çº¿åˆ†å¸ƒï¼ˆdistribution of normalsï¼‰â€æ¥é¿å…ä¸é«˜æ–¯æ­£å¤ªåˆ†å¸ƒ(Gaussian normal distribution)æ··æ·†ã€‚ 5.3 Specular Få¯¹äºè²æ¶…å°”ï¼ˆFresnelï¼‰é¡¹ï¼Œä¸šç•Œæ–¹æ¡ˆä¸€èˆ¬éƒ½é‡‡ç”¨Schlickçš„Fresnelè¿‘ä¼¼ï¼Œå› ä¸ºè®¡ç®—æˆæœ¬ä½å»‰ï¼Œè€Œä¸”ç²¾åº¦è¶³å¤Ÿï¼š $F_{Schlick}(v,h)=F_0 + (1 - F_0)(1 - (v \cdot h))^5$ è²æ¶…å°”é¡¹çš„å¸¸è§æ¨¡å‹å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼š Cook-Torrance[1982] Schlick[1994] Gotanta[2014] 5.4 Specular Gå‡ ä½•é¡¹Gçš„å¸¸è§æ¨¡å‹å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼š Smith[1967] Cook-Torrance[1982] Neumann[1999] Kelemen[2001] Implicit[2013] å¦å¤–ï¼ŒEric Heitzåœ¨[Heitz14]ä¸­å±•ç¤ºäº†Smithå‡ ä½•é˜´å½±å‡½æ•°æ˜¯æ­£ç¡®ä¸”æ›´å‡†ç¡®çš„Gé¡¹ï¼Œå¹¶å°†å…¶æ‰©å±•ä¸ºSmithè”åˆé®è”½å‡½æ•°(Smith Joint Masking-Shadowing Function)ï¼Œè¯¥å‡½æ•°å…·æœ‰å››ç§å½¢å¼ï¼š åˆ†ç¦»é®è”½é˜´å½±å‹ï¼ˆSeparable Masking and Shadowingï¼‰ é«˜åº¦ç›¸å…³é®è”½é˜´å½±å‹ï¼ˆHeight-Correlated Masking and Shadowingï¼‰ æ–¹å‘ç›¸å…³é®è”½é˜´å½±å‹ï¼ˆDirection-Correlated Masking and Shadowingï¼‰ é«˜åº¦-æ–¹å‘ç›¸å…³é®è”½é˜´å½±å‹ï¼ˆHeight-Direction-Correlated Masking and Shadowingï¼‰ ç›®å‰è¾ƒä¸ºå¸¸ç”¨çš„æ˜¯æœ€ä¸ºç®€å•çš„å½¢å¼ï¼Œåˆ†ç¦»é®è”½é˜´å½±ï¼ˆSeparable Masking and Shadowing Functionï¼‰ã€‚ è¯¥å½¢å¼å°†å‡ ä½•é¡¹Gåˆ†ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„éƒ¨åˆ†ï¼šå…‰çº¿æ–¹å‘ï¼ˆlightï¼‰å’Œè§†çº¿æ–¹å‘ï¼ˆviewï¼‰ï¼Œå¹¶å¯¹ä¸¤è€…ç”¨ç›¸åŒçš„åˆ†å¸ƒå‡½æ•°æè¿°ã€‚æ ¹æ®è¿™ç§æ€æƒ³ï¼Œç»“åˆæ³•çº¿åˆ†å¸ƒå‡½æ•°ï¼ˆNDFï¼‰ä¸Smithå‡ ä½•é˜´å½±å‡½æ•°ï¼Œäºæ˜¯æœ‰äº†ä»¥ä¸‹æ–°çš„Smithå‡ ä½•é¡¹ï¼š Smith-GGX Smith-Beckmann Smith-Schlick Schlick-Beckmann Schlick-GGx å…¶ä¸­UE4çš„æ–¹æ¡ˆæ˜¯ä¸Šé¢åˆ—ä¸¾ä¸­çš„â€Schlick-GGXâ€ï¼Œå³åŸºäºSchlickè¿‘ä¼¼ï¼Œå°†Kæ˜ å°„ä¸º$k = {\alpha \over 2}$ï¼Œå»åŒ¹é…GGX Smithæ–¹ç¨‹ï¼š $k = {\alpha \over 2}$$\alpha = roughness^2$$G_1(v)={(n\cdot v)\over {(n\cdot v)(1-k)+k}}$$G(l,v,h)=G_1(l)G_1(v)$ å…­ã€åŸºäºç‰©ç†çš„ç¯å¢ƒå…‰ç…§ï¼ˆPhysically Based Environment Lightingï¼‰æœ‰äº†ç›´æ¥å…‰éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦ç¯å¢ƒå…‰ã€‚æ‰€ä»¥PBRæ ¸å¿ƒçŸ¥è¯†ä½“ç³»çš„ç¬¬å…­éƒ¨åˆ†æ˜¯åŸºäºç‰©ç†çš„ç¯å¢ƒå…‰ç…§ï¼Œä¸€èˆ¬å¤§å®¶ä¹Ÿç›´æ¥é»˜è®¤ç¯å¢ƒå…‰ç…§çš„æŠ€æœ¯æ–¹æ¡ˆæ˜¯åŸºäºå›¾åƒçš„å…‰ç…§ï¼ˆImage Based Lighting, IBL)ã€‚è¿™ä¹Ÿæ˜¯çœŸæ­£è®©åŸºäºç‰©ç†çš„æ¸²æŸ“ç”»è´¨æå‡çš„ä¸»è¦è´¡çŒ®è€…ã€‚æ¼«åå°„ç¯å¢ƒå…‰ç…§éƒ¨åˆ†ä¸€èˆ¬é‡‡ç”¨ä¼ ç»ŸIBLä¸­è¾‰åº¦ç¯å¢ƒæ˜ å°„ï¼ˆIrradiance Environment Mappingï¼‰æŠ€æœ¯ï¼Œå¹¶ä¸æ˜¯åŸºäºç‰©ç†çš„ç‰¹æœ‰æ–¹æ¡ˆï¼Œè¿™é‡Œæš‚ä¸è®¨è®ºã€‚ è€ŒåŸºäºç‰©ç†çš„é•œé¢åå°„ï¼ˆSpecularï¼‰ç¯å¢ƒå…‰ç…§ï¼Œä¸šç•Œä¸­ä¸€èˆ¬ä¼šé‡‡ç”¨åŸºäºå›¾åƒçš„å…‰ç…§ï¼ˆIBLï¼‰çš„æ–¹æ¡ˆã€‚è¦å°†åŸºäºç‰©ç†çš„BRDFæ¨¡å‹ä¸åŸºäºå›¾åƒçš„å…‰ç…§ï¼ˆIBLï¼‰ä¸€èµ·ä½¿ç”¨ï¼Œéœ€è¦æ±‚è§£å…‰ç…§äº®åº¦ç§¯åˆ†ï¼ˆRadiance Integralï¼‰ï¼Œè€Œæ±‚è§£å…‰äº®åº¦ç§¯åˆ†é€šå¸¸ä¼šä½¿ç”¨é‡è¦æ€§é‡‡æ ·ï¼ˆImportance Sampleï¼‰ã€‚ é‡è¦æ€§é‡‡æ ·ï¼ˆImportance Sampleï¼‰å³é€šè¿‡ç°æœ‰çš„ä¸€äº›å·²çŸ¥æ¡ä»¶ï¼ˆåˆ†å¸ƒå‡½æ•°ï¼‰ï¼Œæƒ³åŠæ³•é›†ä¸­äºè¢«ç§¯å‡½æ•°åˆ†å¸ƒå¯èƒ½æ€§è¾ƒé«˜çš„åŒºåŸŸï¼ˆé‡è¦çš„åŒºåŸŸï¼‰è¿›è¡Œé‡‡æ ·ï¼Œè¿›è€Œå¯é«˜æ•ˆå’Œå‡†ç¡®çš„è®¡ç®—ã€‚ 6.1 åˆ†è§£æ±‚å’Œè¿‘ä¼¼ï¼ˆSplit Sum Approximationï¼‰åŸºäºé‡è¦æ€§é‡‡æ ·çš„æ€è·¯ï¼Œå°†è’™ç‰¹å¡æ´›ç§¯åˆ†å…¬å¼ä»£å…¥æ¸²æŸ“æ–¹ç¨‹å¯å¾—ï¼š $$ 6.3.1 æµæ´¾1ï¼š2D LUTUE4åœ¨[Real Shading in Unreal Engine 4,2013]ä¸­æå‡ºï¼Œç¬¬äºŒä¸ªæ±‚å’Œé¡¹ï¼Œä½¿ç”¨Schlickè¿‘ä¼¼åï¼Œ$F_0$å¯ä»¥ä»ç§¯åˆ†ä¸­åˆ†å‡ºæ¥ï¼š$\int_\Omega{L_i(l)f(l,v)cos\theta_l\cdot dl} = F_0\int_\Omega{f(l,v)\over F(v,h)}(1-(1-v\cdot h)^5)cos\theta_ldl+\int_\Omega{f(l,v)\over F(v,h)}(1-v\cdot h)^5cos\theta_ldl$ä¸Šå¼ç•™ä¸‹äº†ä¸¤ä¸ªè¾“å…¥(Roughnesså’Œ$cos\theta$v)å’Œä¸¤ä¸ªè¾“å‡º(ç¼©æ”¾å’Œå‘$F_0$çš„åå·®(a scale and bias to $F_0$))ï¼Œå³æŠŠä¸Šè¿°æ–¹ç¨‹çœ‹æˆæ˜¯$F_0 \cdot Scale + Offset$çš„å½¢å¼ã€‚æˆ‘ä»¬é¢„å…ˆè®¡ç®—æ­¤å‡½æ•°çš„ç»“æœå¹¶å°†å…¶å­˜å‚¨åœ¨2DæŸ¥æ‰¾çº¹ç†(LUT,look-up texture)ä¸­ã€‚è¿™å¼ çº¢ç»¿è‰²çš„è´´å›¾ï¼Œè¾“å…¥roughtnessã€$cos\theta$ï¼Œè¾“å‡ºç¯å¢ƒBRDFé•œé¢åå°„çš„å¼ºåº¦ã€‚æ˜¯å…³äºroughnessã€$cos\theta$ä¸ç¯å¢ƒBRDFé•œé¢åå°„å¼ºåº¦çš„å›ºæœ‰æ˜ å°„å…³ç³»ã€‚å¯ä»¥ç¦»çº¿é¢„è®¡ç®—ã€‚å…·ä½“çš„å–å‡ºæ–¹å¼ä¸ºï¼š ${1\over N}\sum_{k=1}^N {f(l_k,v)cos\theta_{l_k}\over p(l_k,v)}=LUT.r * F_0 + LUT.g$å³UE4æ˜¯é€šè¿‡æŠŠFresnelå…¬å¼çš„F0æå‡ºæ¥ï¼Œç»„æˆF0*Scale+Offsetçš„æ–¹å¼ï¼Œå†å°†Scaleå’ŒOffsetçš„ç´¢å¼•å­˜åˆ°ä¸€å¼ 2D LUTä¸Šã€‚é roughnesså’ŒNdotVè¿›è¡ŒæŸ¥æ‰¾ã€‚ 6.3.2 æµæ´¾2ï¼šè§£ææ‹ŸåˆCOD: Black Ops 2çš„åšæ³•ï¼Œæ˜¯é€šè¿‡æ•°å­¦å·¥å…·Mathematica(http://www.wolfram.com/mathematica/)ä¸­çš„æ•°å€¼ç§¯åˆ†æ‹Ÿåˆå‡ºæ›²çº¿ï¼Œå³å°†UE4ç¦»çº¿è®¡ç®—çš„è¿™å¼ 2D LUTç”¨å¦‚ä¸‹å‡½æ•°è¿›è¡Œäº†æ‹Ÿåˆï¼š1234float3 EnvironmentBRDF(float g, float NoV, float3 rf0)&#123; float4 t = float4(1/0.96, 0.475, (0.0275 - 0.25))&#125; ä¸ƒã€ç¦»çº¿æ¸²æŸ“ç›¸å…³ï¼ˆOffline Rendering Relatedï¼‰è™½ç„¶æˆ‘ä»¬ç›®å‰ä¸»è¦å…³æ³¨çš„æ˜¯å®æ—¶æ¸²æŸ“ï¼ˆå®æ—¶å…‰æ …å›¾å½¢å­¦ç›¸å…³ï¼Œæš‚æ—¶ä¸å…³æ³¨å®æ—¶å…‰çº¿è¿½è¸ªï¼‰é¢†åŸŸï¼Œä½†å¾ˆå¤šæ—¶å€™ï¼Œå®æ—¶æ¸²æŸ“ä¹Ÿéœ€è¦æ¶‰åŠåˆ°é¢„è®¡ç®—ï¼Œå°¤å…¶æ˜¯IBLç›¸å…³çš„é¢„è®¡ç®—ï¼Œæ‰€ä»¥æˆ–å¤šæˆ–å°‘ä¼šç”¨åˆ°ç¦»çº¿æ¸²æŸ“ç›¸å…³çš„çŸ¥è¯†ã€‚æ‰€ä»¥PBRæ ¸å¿ƒçŸ¥è¯†ä½“ç³»çš„ç¬¬ä¸ƒéƒ¨åˆ†æ˜¯ç¦»çº¿æ¸²æŸ“ç›¸å…³çš„ä¸»é¢˜ã€‚ä»¥ä¸‹æ˜¯ä¸å®æ—¶æ¸²æŸ“ç»“åˆç›¸å¯¹ç´§å¯†çš„ç¦»çº¿æ¸²æŸ“çš„æ ¸å¿ƒä¸»é¢˜ä»¥åŠæ¦‚æ‹¬æ€»ç»“ï¼ˆä¸»è¦æ˜¯ç»Ÿè®¡å­¦ä¸æ¦‚è§ˆç›¸å…³ï¼‰ï¼š é‡è¦æ€§é‡‡æ ·ï¼ˆImportance Sampleï¼‰ï¼šè’™ç‰¹å¡æ´›ç§¯åˆ†çš„ä¸€ç§é‡‡æ ·ç­–ç•¥ã€‚æ€è·¯æ˜¯åŸºäºåˆ†å¸ƒå‡½æ•°ï¼Œå°½é‡å¯¹è¢«ç§¯å‡½æ•°åˆ†å¸ƒå¯èƒ½æ€§è¾ƒé«˜çš„åŒºåŸŸè¿›è¡Œé‡‡æ ·ã€‚ å¤šé‡è¦æ€§é‡‡æ ·ï¼ˆMuti Importance Samplingï¼ŒMISï¼‰ï¼šä¼°ç®—æŸä¸€ç§¯åˆ†æ—¶ï¼ŒåŸºäºå¤šä¸ªåˆ†å¸ƒå‡½æ•°è·å–é‡‡æ ·ï¼Œå¹¶æœŸæœ›è‡³å°‘æŸä¸€åˆ†å¸ƒä¸è¢«ç§¯å‡½æ•°å½¢çŠ¶é€‚é…ã€‚å³æ ¹æ®å„ç§æŠ€æœ¯å¯¹é‡‡æ ·è¿›è¡ŒåŠ æƒè®¡ç®—ï¼Œè¿›è€Œæ¶ˆé™¤è¿‘ä¼¼äºå®ƒçš„æ¦‚è§ˆã€‚å³å¶ç„¶ä¸­åŒ…å«ç€æŸç§å¿…ç„¶ã€‚ è’™ç‰¹å¡æ´›æ–¹æ³•ï¼ˆMonte Carlo Methodsï¼‰ï¼šä¸€ç§ä»¥æ¦‚ç‡ç»Ÿè®¡ç†è®ºä¸ºæŒ‡å¯¼çš„æ•°å€¼è®¡ç®—æ–¹æ³•ã€‚æ˜¯æŒ‡ä½¿ç”¨éšæœºæ•°ï¼ˆæˆ–æ›´å¸¸è§çš„ä¼ªéšæœºæ•°ï¼‰æ¥è§£å†³å¾ˆå¤šè®¡ç®—é—®é¢˜çš„æ–¹æ³•ã€‚ ä½åå·®åºåˆ—ï¼ˆLow-discrepancy sequenceï¼‰ï¼šä¸€ç§ç¡®å®šç”Ÿæˆçš„è¶…å‡åŒ€åˆ†å¸ƒåˆ—ï¼Œä¹Ÿæˆä¸ºéšæœºåˆ—ã€æ¬¡éšæœºåˆ—ï¼Œå¸¸è§ä½åå·®åºåˆ—æœ‰Hammersleyï¼ŒHaltonç­‰ã€‚ æ‹Ÿè’™ç‰¹å¡ç½—æ–¹æ³•ï¼ˆQuasi-Monte Carlo Methodï¼‰ï¼šä½¿ç”¨ä½å·®å¼‚æ¥è¿›è¡Œæ•°å€¼ç§¯åˆ†å’Œç ”ç©¶å…¶å®ƒä¸€äº›æ•°å€¼é—®é¢˜çš„æ–¹æ³•ã€‚ å…«ã€è¿›é˜¶æ¸²æŸ“ä¸»é¢˜ï¼ˆAdvanced Rendering Topicsï¼‰å‰é¢çš„æ ¸å¿ƒPBRä¸»é¢˜éƒ½è®¨è®ºå®Œä»¥åï¼Œä¼šæœ‰æ›´å¤šè¿›é˜¶çš„å†…å®¹æµ®å‡ºæ°´é¢ï¼Œå®ƒä»¬å…±åŒç»„æˆäº†PBRæ ¸å¿ƒçŸ¥è¯†ä½“ç³»çš„ç¬¬å…«éƒ¨åˆ†ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªåˆ—ä¸¾ï¼š è¿›é˜¶ç€è‰²æ¨¡å‹ å¸ƒæ–™BRDF(Cloth BRDF) æ¸…æ¼†ç€è‰²æ¨¡å‹(Clear Coat Model) æ¬¡è¡¨é¢æ•£å°„BRDFæ¨¡å‹(Subsurface Scattering BRDF Model) è¿›é˜¶æè´¨åŠŸèƒ½ å…¨èƒ½æè´¨(Uber Shader) åˆ†å±‚æè´¨(Layered Materials) åˆ†å±‚å…¨èƒ½æè´¨(Layered Uber Shader) æ··åˆæè´¨(Blending Material) è¿‡æ»¤æè´¨(Filtering Materials) è¿›é˜¶ç†è®º ç‰©ç†å…‰å­¦(Physics of Light) æ³¢åŠ¨å…‰å­¦(Wave Optics) åŸºäºç‰©ç†çš„æ‘„åƒæœº(Physical Based Camera) åŸºäºç‰©ç†çš„å…‰æº(Physical Based Light) ç™½ç‚‰æµ‹è¯•(White Furnace Test) è¿›é˜¶BxDF BSDF BTDF BSSRDF è¿›é˜¶æè´¨æ¸²æŸ“ çš®è‚¤æ¸²æŸ“(Skin Rendering) å¸ƒæ–™æ¸²æŸ“(Cloth Rendering) åŠé€æ˜è¡¨é¢æ¸²æŸ“(Translucent Surfaces Rendering) å¤´å‘æ¸²æŸ“(Hair Rendering) æ¯›å‘æ¸²æŸ“(Fur Rendering) è½¦æ¼†æ¸²æŸ“(Car Paint Rendering) æ°´ä½“æ¸²æŸ“(Water Rendering) æ¹¿æ¶¦è¡¨é¢æ¸²æŸ“(Wet Surface Rendering) å¤©ç©ºä¸å¤§æ°”æ¸²æŸ“(Sky and Atmosphere Rendering) è–„è¡¨é¢æè´¨æ¸²æŸ“(Thin Surface Rendering) ä½“ç§¯æ¸²æŸ“(Volumetric Rendering)]]></content>
      <tags>
        <tag>è®¡ç®—æœºå›¾å½¢å­¦</tag>
        <tag>æ¸¸æˆå¼•æ“</tag>
        <tag>æ¸¸æˆå¼€å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Direct3D 11]]></title>
    <url>%2F2018%2F05%2F14%2Fd3d11%2F</url>
    <content type="text"><![CDATA[ç‚¹ç§¯(dot product)è®¡ç®—ç»“æœæ˜¯æ ‡é‡å€¼ï¼›ä¹Ÿå«æ ‡é‡ç§¯(scalar product)ã€‚ç­‰äºä¸¤ä¸ªå‘é‡å¯¹åº”åˆ†é‡çš„ä¹˜ç§¯ä¹‹å’Œã€‚ $\mathbf{u \cdot v} = u_xv_x+u_yv_y+u_zv_z$ 4.1 å‡†å¤‡å·¥ä½œ4.1.4 äº¤æ¢é“¾å’Œé¡µé¢ç¿»è½¬ä¸ºäº†é¿å…åœ¨åŠ¨ç”»ä¸­å‡ºç°é—ªçƒï¼Œæœ€å¥½çš„åšæ³•æ˜¯åœ¨ä¸€ä¸ªç¦»å±ï¼ˆoff-screenï¼‰çº¹ç†ä¸­æ‰§è¡Œæ‰€æœ‰çš„åŠ¨ç”»å¸§ç»˜åˆ¶å·¥ä½œï¼Œè¿™ä¸ªç¦»å±çº¹ç†æˆä¸ºåå°ç¼“å­˜åŒº(back buffer)ã€‚å½“æˆ‘ä»¬åœ¨åå°ç¼“å†²åŒºä¸­å®Œæˆç»™å®šå¸§çš„ç»˜åˆ¶å·¥ä½œåï¼Œä¾¿å¯ä»¥å°†åå°ç¼“å†²åŒºä½œä¸ºä¸€ä¸ªä½œä¸ºä¸€ä¸ªå®Œæ•´çš„å¸§æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼›ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œç”¨æˆ·ä¸ä¼šæ„Ÿè§‰åˆ°å¸§çš„ç»˜åˆ¶è¿‡ç¨‹ï¼Œåªä¼šçœ‹åˆ°å®Œæ•´çš„å¸§ã€‚ä»ç†è®ºä¸Šè®²ï¼Œå°†ä¸€å¸§æ˜¾ç¤ºåˆ°å±å¹•ä¸Šæ‰€æ¶ˆè€—çš„æ—¶é—´å°äºå±å¹•çš„å‚ç›´åˆ·æ–°æ—¶é—´ã€‚ç¡¬ä»¶ä¼šè‡ªåŠ¨ç»´æŠ¤ä¸¤ä¸ªå†…ç½®çš„çº¹ç†ç¼“å†²åŒºæ¥å®ç°è¿™ä¸€åŠŸèƒ½ï¼Œè¿™ä¸¤ä¸ªç¼“å†²åŒºåˆ†åˆ«æˆä¸ºå‰å°ç¼“å†²åŒº(front buffer)å’Œåå°ç¼“å†²åŒºã€‚å‰å°ç¼“å†²åŒºå­˜å‚¨äº†å½“å‰æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„å›¾åƒæ•°æ®ï¼Œè€ŒåŠ¨ç”»çš„ä¸‹ä¸€å¸§ä¼šåœ¨åå°ç¼“å†²åŒºä¸­æ‰§è¡Œç»˜åˆ¶ã€‚å½“åå°ç¼“å†²åŒºçš„ç»˜åˆ¶å·¥ä½œå®Œæˆä¹‹åï¼Œå‰åä¸¤ä¸ªç¼“å†²åŒºçš„åšå“Ÿä¸ªä¼šå‘ç”Ÿç¿»è½¬ï¼›åå°ç¼“å†²åŒºä¼šå˜ä¸ºå‰å°huanâ€™ch 4.1.5 æ·±åº¦ç¼“å†²åŒºæ·±åº¦ç¼“å†²åŒº(depth buffer)æ˜¯ä¸€ä¸ªä¸åŒ…å«å›¾åƒæ•°æ®çš„çº¹ç†å¯¹è±¡ã€‚åœ¨ä¸€å®šç¨‹åº¦ä¸Šï¼Œæ·±åº¦ä¿¡æ¯å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ç§ç‰¹æ®Šçš„åƒç´ ã€‚å¸¸è§çš„æ·±åº¦å€¼èŒƒå›´åœ¨0.0åˆ°1.0ä¹‹é—´ï¼Œå…¶ä¸­0.0è¡¨ç¤ºç¦»è§‚å¯Ÿè€…æœ€è¿‘çš„ç‰©ä½“ï¼Œ1.0è¡¨ç¤ºç¦»è§‚å¯Ÿè€…æœ€è¿œçš„ç‰©ä½“ã€‚æ·±åº¦ç¼“å†²åŒºä¸­çš„æ¯ä¸ªå…ƒç´ ä¸åå°ç¼“å†²åŒºä¸­çš„æ¯ä¸ªåƒç´ ä¸€ä¸€å¯¹é‚£ä¸ªï¼ˆå³ï¼Œåå°ç¼“å†²åŒºçš„ç¬¬ijä¸ªå…ƒç´ å¯¹åº”äºæ·±åº¦ç¼“å†²åŒºç¬¬ijä¸ªå…ƒç´ ï¼‰ã€‚æ‰€ä»¥ï¼Œå½“åå°ç¼“å†²åŒºçš„åˆ†è¾¨ç‡ä¸º1280x1024æ—¶ï¼Œåœ¨æ·±åº¦ç¼“å†²åŒºä¸­æœ‰1280x1024ä¸ªæ·±åº¦å…ƒç´ ã€‚ 4.1.6 çº¹ç†èµ„æºè§†å›¾çº¹ç†å¯ä»¥è¢«ç»‘å®šåˆ°æ¸²æŸ“ç®¡çº¿ï¼ˆrendering pipelineï¼‰çš„ä¸åŒé˜¶æ®µ(stage);ä¾‹å¦‚ï¼Œæ¯”è¾ƒå¸¸è§çš„æƒ…å†µæ˜¯å°†çº¹ç†ä½œä¸ºæ¸²æŸ“ç›®æ ‡ï¼ˆå³ï¼ŒDirect3Dæ¸²æŸ“åˆ°çº¹ç†ï¼‰æˆ–ç€è‰²å™¨èµ„æºï¼ˆå³ï¼Œåœ¨ç€è‰²å™¨ä¸­å¯¹çº¹ç†è¿›è¡Œé‡‡æ ·ï¼‰ã€‚å½“åˆ›å»ºç”¨äºè¿™ä¸¤ç§ç›®çš„çš„çº¹ç†èµ„æºæ—¶ï¼Œåº”ä½¿ç”¨ç»‘å®šæ ‡è®°å€¼ï¼š D3D11_BIND_RENDER_TARGET|D3D10_BIND_SHADER_RESOURCEæŒ‡å®šçº¹ç†æ‰€è¦ç»‘å®šçš„ä¸¤ä¸ªç®¡çº¿é˜¶æ®µã€‚å…¶å®ï¼Œèµ„æºä¸èƒ½è¢«ç›´æ¥ç»‘å®šåˆ°ä¸€ä¸ªç®¡çº¿é˜¶æ®µï¼›æˆ‘ä»¬åªèƒ½æŠŠä¸èµ„æºå…³è”çš„èµ„æºè¯•å›¾ç»‘å®šåˆ°ä¸åŒçš„ç®¡çº¿é˜¶æ®µã€‚æ— è®ºä»¥å“ªç§æ–¹å¼ä½¿ç”¨çº¹ç†ï¼ŒDirect3Då§‹ç»ˆè¦æ±‚æˆ‘ä»¬åœ¨åˆå§‹åŒ–æ—¶ä¸ºçº¹ç†åˆ›å»ºç›¸å…³çš„èµ„æºè§†å›¾(resource view)ã€‚è¿™æ ·æœ‰åŠ©äºæä¾›è¿è¡Œæ•ˆç‡ï¼Œæ­£å¦‚SDKæ–‡æ¡£æŒ‡å‡ºçš„é‚£æ ·ï¼šâ€œè¿è¡Œæ—¶ç¯å¢ƒä¸é©±åŠ¨ç¨‹åºå¯ä»¥åœ¨è§†å›¾åˆ›å»ºæ‰§è¡Œç›¸åº”çš„éªŒè¯å’Œæ˜ å°„ï¼Œå‡å°‘ç»‘å®šæ—¶çš„ç±»å‹æ£€æŸ¥â€ã€‚æ‰€ä»¥ï¼Œå½“æŠŠçº¹ç†ä½œä¸ºä¸€ä¸ªæ¸²æŸ“ç›®æ ‡å’Œç€è‰²å™¨èµ„æºæ—¶ï¼Œæˆ‘ä»¬è¦ä¸ºå®ƒåˆ›å»ºä¸¤ç§è¯•å›¾ï¼šæ¸²æŸ“ç›®æ ‡è¯•å›¾ (ID3D11RenderTargetView)å’Œç€è‰²å™¨èµ„æºè§†å›¾ (ID3D11ShaderResourceView)ã€‚èµ„æºè§†å›¾ä¸»è¦æœ‰ä¸¤ä¸ªåŠŸèƒ½ï¼šï¼ˆ1ï¼‰å‘Šè¯‰Direct3Då¦‚ä½•ä½¿ç”¨èµ„æºï¼ˆå³ï¼ŒæŒ‡å®šèµ„æºæ‰€è¦ç»‘å®šçš„ç®¡çº¿é˜¶æ®µï¼‰ï¼› 4.1.7 å¤šé‡é‡‡æ ·å› ä¸ºè®¡ç®—æœºæ˜¾ç¤ºå™¨ä¸Šçš„åƒç´ åˆ†è¾¨ç‡æœ‰é™ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ç»˜åˆ¶ä¸€æ¡ä»»æ„ç›´çº¿æ—¶ï¼Œè¯¥ç›´çº¿å¾ˆéš¾ç²¾ç¡®åœ°æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚å½“æ— æ³•æé«˜æ˜¾ç¤ºå™¨çš„åˆ†è¾¨ç‡ï¼Œç¼©å°åƒç´ å°ºå¯¸ï¼Œä¹Ÿå¯ä»¥æœ‰æ•ˆåœ°ç¼“è§£è¿™ä¸€é—®é¢˜ï¼Œä½¿é˜¶æ¢¯æ•ˆåº”æ˜æ˜¾é™ä½ã€‚å½“æ— æ³•æé«˜æ˜¾ç¤ºå™¨åˆ†è¾¨ç‡æˆ–åˆ†è¾¨ç‡ä¸å¤Ÿé«˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æŠ—é”¯é½¿ (antialiasing)æŠ€æœ¯ã€‚å…¶ä¸­çš„ä¸€ç§æŠ€æœ¯å«åšè¶…çº§é‡‡æ ·ï¼ˆsupersamplingï¼‰ï¼Œå®ƒæŠŠåå°ç¼“å†²å’Œæ·±åº¦ç¼“å†²çš„å¤§å°æé«˜åˆ°å±å¹•åˆ†è¾¨ç‡çš„4å€ã€‚ 4.1.8 Direct3Dä¸­çš„å¤šé‡é‡‡æ ·4.2 å¯¹Direct3Dè¿›è¡Œåˆå§‹åŒ– ID3D11Deviceæ¥å£ç”¨äºæ£€æµ‹æ˜¾ç¤ºé€‚é…å™¨åŠŸèƒ½å’Œåˆ†é…èµ„æºã€‚ ID3D11DeviceContextæ¥å£ç”¨äºè®¾ç½®ç®¡çº¿çŠ¶æ€ã€å°†èµ„æºç»‘å®šåˆ°å›¾å½¢ç®¡çº¿å’Œç”Ÿæˆæ¸²æŸ“å‘½ä»¤ã€‚ 4.2.2 æ£€æµ‹4Xå¤šé‡é‡‡æ ·è´¨é‡æ”¯æŒåˆ›å»ºäº†è®¾å¤‡åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ£€æŸ¥4Xå¤šé‡é‡‡æ ·è´¨é‡ç­‰çº§äº†ã€‚æ‰€æœ‰æ”¯æŒDirect3D 11çš„è®¾å¤‡éƒ½æ”¯æŒæ‰€æœ‰æ¸²æŸ“ç›®æ ‡æ ¼å¼çš„4X MSAAï¼ˆæ”¯æŒçš„è´¨é‡ç­‰çº§å¯èƒ½å¹¶ä¸ç›¸åŒï¼‰ã€‚123UINT m4xMsaaQuality;HR(md3dDevice-&gt;CheckMultisampleQualityLevels(DXGI_FORMAT_R8G8B8AB_UNORM, 4, &amp;m4xMassQuality));assert(m4xMsaaQuality&gt;0); å› ä¸º4X MSAAæ€»æ˜¯è¢«æ”¯æŒçš„ï¼Œæ‰€ä»¥è¿”å›çš„è´¨é‡ç­‰çº§æ€»æ˜¯å¤§äº0ã€‚ 4.2.3 æè¿°äº¤æ¢é“¾ä¸‹ä¸€æ­¥æ˜¯åˆ›å»ºäº¤æ¢é“¾ï¼Œé¦–å…ˆéœ€è¦å¡«å……ä¸€ä¸ªDXGI_SWAP_CHAIN_DESCç»“æ„ä½“æ¥æè¿°æˆ‘ä»¬å°†è¦åˆ›å»ºçš„äº¤æ¢é“¾çš„ç‰¹æ€§ã€‚è¯¥ç»“æ„ä½“çš„å®šä¹‰å¦‚ä¸‹ï¼š12345678910typedef struct DXGI_SWAP_CHAIN_DESC&#123; DXGI_MODE_DESC BufferDesc; DXGI_SAMPLE_DESC SampleDesc; DXGI_USAGE BufferUsage; UINT BufferCount; HWND OutputWindow; BOOL Windowed; DXGI_SWAP_EFFECT SwapEffect; UINT Flags;&#125;DXGI_SWAP_CHAIN_DESC; DXGI_MODE_DESCç±»å‹æ˜¯å¦ä¸€ä¸ªç»“æ„ä½“ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š12345678typedef struct DXGI_MODE_DESC&#123; UINT Width; // åå°ç¼“å†²åŒºå®½åº¦ UINT Height; // åå°ç¼“å†²åŒºé«˜åº¦ DXGI_RATIONAL RefreshRate; // æ˜¾ç¤ºåˆ·æ–°ç‡ DXGI_MODE_SCANLINE_ORDER ScanlineOrdering; // display scanline mode DXGI_MODE_SCALING Scaling; // display scaling mode &#125; æ³¨æ„ï¼šåœ¨ä¸‹é¢çš„æ•°æ®æˆå‘˜æè¿°ä¸­ï¼Œæˆ‘ä»¬åªè¦†ç›–äº†ä¸€äº›å¸¸ç”¨çš„æ ‡è®°å€¼å’Œé€‰é¡¹ï¼Œå®ƒä»¬å¯¹äºåˆå­¦è€…æ¥è¯´éå¸¸é‡è¦ã€‚å¯¹äºå…¶ä»–æ ‡å¿—å€¼å’Œé€‰é¡¹çš„æè¿°ï¼Œè¯·å‚é˜…SDKæ–‡æ¡£ã€‚ BufferDesc:è¯¥ç»“æ„ä½“æè¿°äº†æˆ‘ä»¬æ‰€è¦åˆ›å»ºçš„åå°ç¼“å†²åŒºçš„å±æ€§ã€‚æˆ‘ä»¬ä¸»è¦å…³æ³¨çš„å±æ€§æœ‰ï¼šå®½åº¦ã€é«˜åº¦å’Œåƒç´ éª¼æ—¶ï¼›å…¶ä»–å±æ€§çš„è¯¦æƒ…è¯·å‚é˜…SDKæ–‡æ¡£ã€‚ SampleDesc:]]></content>
      <tags>
        <tag>Direct3D 11</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Liyanfeng-Notes]]></title>
    <url>%2F2018%2F04%2F26%2FLiyanfeng-Notes%2F</url>
    <content type="text"><![CDATA[è·‘é…·é¡¹ç›®çš„ url: http://10.72.12.28/D2/JBR zentia.li P2psg99qvX5sqAWE]]></content>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Shaderæ¨¡æ¿ç¼“å†²å’Œæ¨¡æ¿æµ‹è¯•]]></title>
    <url>%2F2018%2F04%2F26%2FUnity-Stencil-Buffer-Stencil-Test%2F</url>
    <content type="text"><![CDATA[åœ¨å›¾å½¢å­¦ç§ä¸€ä¸ªåƒç´ ä¼šæœ‰å¦‚ä¸‹ç¼“å­˜ï¼š é¢œè‰²ç¼“å­˜color buffer/pixel buffer : å­˜å‚¨è¯¥ç‚¹å³å°†æ˜¾ç¤ºåœ°é¢œè‰²ï¼ŒRGBAå€¼ æ·±åº¦ç¼“å­˜depth buffer/z buffer:å­˜å‚¨è¯¥ç‚¹åœ°æ·±åº¦ï¼Œz æ¨¡æ¿ç¼“å­˜stencil bufferï¼š é€šå¸¸ç”¨ä½œé™åˆ¶æ¸²æŸ“åŒºåŸŸã€‚æ›´é«˜çº§ç”¨æ³•éœ€ç»“åˆæ·±åº¦ç¼“å†²ï¼Œä¾‹å¦‚æŸåƒç´ åœ°æ¨¡æ¿ç¼“å†²å€¼ä¼šéšç€å…¶æ˜¯å¦é€šè¿‡æ·±åº¦ç¼“å†²æµ‹è¯•è€Œæ”¹å˜ã€‚ ç´¯è®¡ç¼“å­˜Accumulation Buffer:ä¸é¢œè‰²ç¼“å­˜ç±»ä¼¼ï¼ŒåŒæ ·å‚¨å­˜ä¸€ä¸ªRGBAå€¼ã€‚ç´¯è®¡ç¼“å­˜æ˜¯ä¸ºåˆæˆå¤šå¹…å›¾åƒè€Œè®¾è®¡åœ°ï¼Œç´¯è®¡ç¼“å­˜æä¾›äº†ä¸€ç§åœ¨ä¿æŒå¥½åœ°é¢œè‰²åˆ†è¾¨ç‡ä¸‹å®ç°åœ¨åœºæ™¯ä¸­â€å¤šé‡æ›å…‰(multiple exposuresâ€åœ°æ–¹æ³•ã€‚ä½¿ç”¨ç´¯è®¡ç¼“å­˜å¯ä»¥äº§ç”Ÿè®¸å¤šå›¾åƒæ•ˆæœæ¥æé«˜å›¾åƒçš„çœŸå®æ€§ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼šåèµ°æ ·ï¼Œè¿åŠ¨æ¨¡ç³Šï¼Œè½¯é˜´å½±ï¼Œæ·±åº¦åŸŸï¼ˆæ™¯æ·±ï¼‰å’Œå·ç§¯ã€‚è¦äº§ç”Ÿè¿™äº›æ•ˆæœï¼Œå¿…é¡»å°†å›¾åƒæ¸²æŸ“å¤šæ¬¡ï¼Œå¯¹åœºæ™¯ä½ç½®ï¼ˆæˆ–æ‰€é€‰çš„ç‰©ä½“ï¼‰è¿›è¡Œå¾®å°çš„ã€æ¸å¢çš„æ”¹å˜ï¼Œç„¶åç´¯è®¡ç»“æœã€‚ stencilä¸é¢œè‰²ç¼“å†²åŒºå’Œæ·±åº¦ç¼“å­˜åŒºç±»ä¼¼ï¼Œæ¨¡æ¿ç¼“å­˜åŒºå¯ä»¥ä¸ºå±å¹•ä¸Šçš„æ¯ä¸ªåƒç´ ç‚¹ä¿å­˜ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°å€¼ï¼ˆé€šå¸¸æ˜¯ä¸ªå…«ä½æ•´æ•°ï¼‰ã€‚è¿™ä¸ªå€¼çš„å…·ä½“æ„ä¹‰è§†ç¨‹åºçš„å…·ä½“åº”ç”¨è€Œå®šã€‚åœ¨æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ç”¨è¿™ä¸ªå€¼ä¸ä¸€ä¸ªé¢„å…ˆè®¾å®šçš„å‚è€ƒå€¼ç›¸æ¯”è¾ƒï¼Œæ ¹æ®æ¯”è¾ƒçš„ç»“æœæ¥å†³å®šæ˜¯å¦æ›´æ–°ç›¸åº”çš„åƒç´ ç‚¹çš„é¢œè‰²å€¼ã€‚è¿™ä¸ªæ¯”è¾ƒçš„è¿‡ç¨‹æˆä¸ºæ¨¡æ¿æµ‹è¯•Stencil Testã€‚æ¨¡æ¿æµ‹è¯•å‘ç”Ÿåœ¨é€æ˜åº¦æµ‹è¯•(alpha test)ä¹‹åã€‚å¦‚æœæ¨¡æ¿æµ‹è¯•é€šè¿‡ï¼Œåˆ™ç›¸åº”çš„åƒç´ ç‚¹æ›´æ–°ï¼Œå¦åˆ™ä¸æ›´æ–°ã€‚å›¾å½¢æ¸²æŸ“ç®¡çº¿ä¸­ï¼ŒåŸºäºå•ä¸ªåƒç´ çš„æµ‹è¯•æ“ä½œçš„é¡ºåºå¦‚ä¸‹å›¾]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity Lerp]]></title>
    <url>%2F2018%2F04%2F26%2FUnity-Lerp%2F</url>
    <content type="text"><![CDATA[æœ‰æ—¶ï¼Œæˆ‘ä»¬åœ¨åšæ¸¸æˆæ—¶ä¼šå‘ç°æœ‰äº›è·ŸéšåŠ¨ä½œä¸å¤Ÿåœ†æ»‘æˆ–è€…éœ€è¦ä¸€ä¸ªç¼“å†²çš„æ•ˆæœï¼Œè¿™æ—¶ï¼Œä¸€èˆ¬ä¼šè€ƒè™‘åˆ°æ’å€¼ã€‚ï¼ˆæ¯”å¦‚æ‘„åƒæœºè·Ÿéšä¸»è§’ï¼‰ æ’å€¼æ˜¯æ•°å­¦ä¸Šçš„ä¸€ä¸ªæ¦‚å¿µï¼Œå…¬å¼ï¼š from + (to - from) * t;fromæ˜¯èµ·å§‹åœ°ä½ç½®ï¼Œtoæ˜¯ç›®æ ‡ä½ç½®ï¼ŒæŒ‰ç…§æ•°å­—tåœ¨fromåˆ°toä¹‹é—´æ’å€¼ã€‚]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CG-Input-Output-And-Semantic-Bind]]></title>
    <url>%2F2018%2F04%2F21%2FCG-Input-Output-And-Semantic-Bind%2F</url>
    <content type="text"><![CDATA[å…ˆå¤ä¹ ä¸€ä¸‹GPUçš„å·¥ä½œæµç¨‹ï¼Œç¬¬ä¸‰ç« ä»CPUè¿è¡ŒåŸç†å’Œæ•°æ®æµç¨‹çš„è§’åº¦é˜è¿°äº†é¡¶ç‚¹ç€è‰²å™¨ç¨‹åºå’Œç‰‡æ®µç€è‰²ç¨‹åºçš„è¾“å…¥è¾“å‡ºï¼Œå³ï¼Œåº”ç”¨ç¨‹åº(å®¿ä¸»ç¨‹åº)å°†å›¾å…ƒä¿¡æ¯(é¡¶ç‚¹ä½ç½®ã€æ³•å‘é‡ã€çº¹ç†åæ ‡ç­‰)ä¼ é€’ç»™é¡¶ç‚¹ç€è‰²ç¨‹åºï¼›é¡¶ç‚¹ç€è‰²ç¨‹åºåŸºäºå›¾å…ƒä¿¡æ¯è¿›è¡Œåæ ‡ç©ºé—´å˜æ¢ï¼Œè¿ç®—å¾—åˆ°çš„æ•°æ®ä¼ é€’åˆ°ç‰‡æ®µç€è‰²ç¨‹åºä¸­ï¼›ç‰‡æ®µç€è‰²ç¨‹åºè¿˜å¯ä»¥æ¥å—ä»åº”ç”¨ç¨‹åºä¸­ä¼ é€’çš„çº¹ç†ä¿¡æ¯ï¼Œå°†è¿™äº›ä¿¡æ¯ç»¼åˆèµ·æ¥è®¡ç®—æ¯ä¸ªç‰‡æ®µçš„é¢œè‰²å€¼ï¼Œæœ€åå°†è¿™äº›é¢œè‰²å€¼è¾“é€åˆ°å¸§ç¼“å†²åŒº(æˆ–é¢œè‰²ç¼“å†²åŒº)ä¸­ã€‚è¿™ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®²è§£Cgè¯­è¨€é€šè¿‡ä½•ç§æœºåˆ¶ç¡®å®šæ•°æ®ç±»å‹å’Œä¼ é€’å½¢å¼ã€‚ä¸‰ä¸ªé—®é¢˜ï¼š1ã€ä»åº”ç”¨ç¨‹åºä¼ é€’åˆ°GPUçš„æ•°æ®ï¼Œåˆ†ä¸ºå›¾å…ƒä¿¡æ¯æ•°æ®(åœ¨GPUå¤„ç†çš„åŸºæœ¬æ•°æ®å¦‚é¡¶ç‚¹ä½ç½®ä¿¡æ¯ç­‰)å’Œå…¶ä»–çš„ç¦»æ•£æ•°æ®(åœ¨GPUè¿è¡Œæµç¨‹ä¸­ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¦‚æè´¨å¯¹å…‰çš„åå°„ã€æŠ˜å°„ä¿¡æ¯)ï¼Œè¿™ä¸¤ç§è¾“å…¥æ•°æ®å¦‚ä½•åŒºåˆ†ï¼Ÿ2ã€ä»åº”ç”¨ç¨‹åºä¼ é€’åˆ°GPUä¸­çš„å›¾å…ƒä¿¡æ¯å¦‚ä½•åŒºåˆ†ç±»å‹ï¼Œå³ï¼Œé¡¶ç‚¹ç¨‹åºæ€ä¹ˆçŸ¥é“ä¸€ä¸ªæ•°æ®æ˜¯ä½ç½®æ•°æ®ï¼Œè€Œä¸æ˜¯æ³•çº¿é‡æ•°æ®ï¼Ÿ3ã€é¡¶ç‚¹ç€è‰²ç¨‹åºä¸ç‰‡æ®µç€è‰²ç¨‹åºä¹‹é—´çš„æ•°æ®ä¼ é€’å¦‚ä½•è¿›è¡Œï¼Ÿcgå…³é”®å­—ä¸ä½†ç”¨äºæŒ‡å®šè¾“å…¥å›¾å…ƒçš„æ•°æ®å«ä¹‰(æ˜¯ä½ç½®ä¿¡æ¯ï¼Œè¿˜æ˜¯æ³•å‘é‡ä¿¡æ¯),æœ¬è´¨ä¹Ÿåˆ™å¯¹åº”ç€è¿™äº›å›¾å…ƒæ•°æ®å­˜æ”¾çš„ç¡¬ä»¶èµ„æº(å¯„å­˜å™¨æˆ–è€…çº¹ç†)ï¼Œç§°ä¹‹ä¸ºè¯­ä¹‰è¯(Semantics),é€šå¸¸ä¹Ÿæ ¹æ®å…¶ç”¨æ³•ç§°ä¹‹ä¸ºç»‘å®šè¯­ä¹‰è¯(binging semantics)ã€‚ é™¤è¯­ä¹‰è¯å¤–ï¼ŒCgä¸­è¿˜æä¾›äº†ä¸‰ä¸ªå…³é”®å­—ï¼Œintã€outã€inoutï¼Œç”¨äºè¡¨ç¤ºå‡½æ•°çš„è¾“å…¥å‚æ•°çš„ä¼ é€’æ–¹å¼ï¼Œç§°ä¸ºè¾“å…¥/è¾“å‡ºå…³é”®å­—ï¼Œè¿™ç»„å…³é”®å­—å¯ä»¥å’Œè¯­ä¹‰è¯åˆç”¨è¡¨è¾¾ç¡¬ä»¶ä¸Šä¸åŒçš„å­˜å‚¨ä½ç½®ï¼Œå³åŒä¸€ä¸ªè¯­ä¹‰è¯ï¼Œä½¿ç”¨inå…³é”®å­—ä¿®é¥°å’Œoutå…³é”®è¯ä¿®é¥°ï¼Œè¡¨ç¤ºçš„å›¾å½¢ç¡¬ä»¶ä¸Šä¸åŒçš„å¯„å­˜å™¨ã€‚ Cgè¯­è¨€è¿˜æä¾›ä¸¤ä¸ªä¿®é¥°ç¬¦ï¼šuniform,ç”¨äºæŒ‡å®šå˜é‡çš„æ•°æ®åˆå§‹åŒ–æ–¹å¼ï¼›constå…³é”®å­—çš„å«ä¹‰ä¸C/C++ä¸­ç›¸åŒï¼Œè¡¨ç¤ºè¢«ä¿®é¥°å˜é‡ä¸ºå¸¸é‡å˜é‡ã€‚ uniformCgè¯­è¨€å°†è¾“å…¥è¾“å‡ºæ•°æ®æµåˆ†ä¸ºä¸¤ç±»ï¼š Varying inputs,å³æ•°æ®æµè¾“å…¥å›¾å…ƒä¿¡æ¯çš„å„ç§ç»„æˆè¦ç´ ã€‚ä»åº”ç”¨ç¨‹åºè¾“å…¥åˆ°GPUçš„æ•°æ®é™¤äº†é¡¶ç‚¹ä½ç½®æ•°æ®ï¼Œè¿˜æœ‰é¡¶ç‚¹çš„æ³•å‘é‡æ•°æ®ï¼Œçº¹ç†åæ ‡æ•°æ®ç­‰ã€‚ Uniform inputs,è¡¨ç¤ºä¸€äº›ä¸ä¸‰ç»´æ¸²æŸ“æœ‰å…³çš„ç¦»æ•£ä¿¡æ¯æ•°æ®ï¼Œè¿™äº›æ•°æ®é€šå¸¸ç”±åº”ç”¨ç¨‹åºä¼ å…¥ï¼Œå¹¶é€šå¸¸ä¸ä¼šéšç€å›¾å…ƒä¿¡æ¯çš„å˜åŒ–è€Œå˜åŒ–ï¼Œå¦‚æè´¨å¯¹å…‰çš„åå°„ä¿¡æ¯ã€è¿åŠ¨çŸ©é˜µç­‰ã€‚Uniformä¿®é¥°ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºè¯¥å‚æ•°çš„å€¼ç”±å¤–éƒ¨åº”ç”¨ç¨‹åºåˆå§‹åŒ–å¹¶ä¼ å…¥ã€‚ä½¿ç”¨Uniformä¿®é¥°çš„å˜é‡ï¼Œé™¤äº†æ•°æ®æ¥æºä¸åŒå¤–ï¼Œä¸å…¶ä»–å˜é‡æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šuniformä¿®è¾çš„å˜é‡æ˜¯ä»å¤–éƒ¨ä¼ å…¥çš„ï¼Œæ‰€ä»¥åœ¨Cgç¨‹åº(é¡¶ç‚¹ç¨‹åºå’Œç‰‡æ®µç¨‹åº)ä¸­é€šå¸¸æ‰€æœ‰uniformå‚æ•°ä¿®è¾å‡½æ•°å½¢å‚ï¼Œä¸å®¹è®¸å£°æ˜ä¸€ä¸ªuniformä¿®è¾çš„å±€éƒ¨å˜é‡ï¼ Cgè¯­è¨€ä¸­å‚æ•°ä¼ é€’æ–¹å¼åŒæ ·åˆ†ä¸ºâ€å€¼ä¼ é€’â€å’Œâ€å¼•ç”¨ä¼ é€’â€ï¼Œä½†æŒ‡é’ˆæœºåˆ¶å¹¶ä¸è¢«GPUç¡¬ä»¶æ”¯æŒï¼Œæ‰€ä»¥Cgè¯­è¨€é‡‡ç”¨ä¸åŒçš„è¯­æ³•ä¿®è¾ç¬¦æ¥åŒºåˆ«â€å€¼ä¼ é€’â€å’Œâ€å¼•ç”¨ä¼ é€’â€.è¿™äº›ä¿®è¾ç¬¦åˆ†åˆ«ä¸ºï¼š in :ä¿®è¾ä¸€ä¸ªå½¢å‚åªæ˜¯ç”¨äºè¾“å…¥ï¼Œè¿›å…¥å‡½æ•°ä½“æ—¶è¢«åˆå§‹åŒ–ï¼Œä¸”è¯¥å½¢å‚å€¼çš„æ”¹å˜ä¸ä¼šå½±å“å®å‚å€¼ï¼Œè¿™æ˜¯å…¸å‹çš„å€¼ä¼ é€’æ–¹å¼ã€‚ out :ä¿®è¾ä¸€ä¸ªå½¢å‚åªæ˜¯ç”¨äºè¾“å‡ºçš„ï¼Œè¿›å…¥å‡½æ•°ä½“æ—¶å¹¶æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œè¿™ç§ç±»å‹çš„å½¢å‚ä¸€èˆ¬æ˜¯ä¸€ä¸ªå‡½æ•°çš„è¿è¡Œç»“æœï¼› inout:ä¿®è¾ä¸€ä¸ªå½¢å‚å³ç”¨äºè¾“å…¥ä¹Ÿç”¨äºè¾“å‡ºï¼Œè¿™æ˜¯å…¸å‹çš„å¼•ç”¨ä¼ é€’ã€‚ä¾‹å¦‚ï¼š void myFunction(float x); //ç­‰ä»·äºin float xï¼Œè¿™ç§ç”¨æ³•å’ŒC/C++å®Œå…¨ä¸€è‡´è¯­ä¹‰è¯(Semantic)ä¸è¯­ä¹‰ç»‘å®š(Binding semantics) è¯­ä¹‰è¯ï¼Œè¡¨ç¤ºè¾“å…¥å›¾å…ƒçš„æ•°æ®å«ä¹‰(æ˜¯ä½ç½®ä¿¡æ¯ï¼Œè¿˜æ˜¯æ³•å‘é‡ä¿¡æ¯)ï¼Œä¹Ÿè¡¨æ˜è¿™äº›å›¾å…ƒæ•°æ®å­˜æ”¾çš„ç¡¬ä»¶èµ„æº(å¯„å­˜å™¨æˆ–è€…çº¹ç†ç¼“å­˜åŒº)ã€‚é¡¶ç‚¹ç€è‰²ç¨‹åºå’Œç‰‡æ®µç€è‰²ç¨‹åºä¸­Varying inputsç±»å‹çš„è¾“å…¥ï¼Œå¿…é¡»å’Œä¸€ä¸ªè¯­ä¹‰è¯ç›¸ç»‘å®šï¼Œè¿™ç§°ä¹‹ä¸ºç»‘å®šè¯­ä¹‰(binding semantics)ã€‚ è®°ä½è¿™ä¸€ç‚¹ï¼šè¯­ä¹‰ï¼Œæ˜¯ä¸¤ä¸ªå¤„ç†é˜¶æ®µ(é¡¶ç‚¹ç¨‹åºã€ç‰‡æ®µç¨‹åº)ä¹‹é—´çš„è¾“å…¥/è¾“å‡ºæ•°æ®å’Œå¯„å­˜å™¨ä¹‹é—´çš„æ¡¥æ¢ï¼ŒåŒæ—¶è¯­ä¹‰é€šå¸¸ä¹Ÿè¡¨ç¤ºæ•°æ®çš„å«ä¹‰ï¼Œå¦‚POSITIONä¸€èˆ¬è¡¨ç¤ºå‚æ•°å­˜æ”¾çš„æ•°æ®æ˜¯é¡¶ç‚¹ä½ç½®ã€‚ è¯­ä¹‰ï¼Œåªå¯¹ä¸¤ä¸ªå¤„ç†é˜¶æ®µçš„è¾“å…¥/è¾“å‡ºæ•°æ®æœ‰æ„ä¹‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¯­ä¹‰åªæœ‰åœ¨å…¥å£å‡½æ•°ä¸­æ‰æœ‰æ•ˆï¼Œåœ¨å†…éƒ¨å‡½æ•°(ä¸€ä¸ªé˜¶æ®µçš„å†…éƒ¨å¤„ç†å‡½æ•°ï¼Œå’Œä¸‹ä¸€ä¸ªé˜¶æ®µæ²¡æœ‰æ•°æ®ä¼ é€’å…³ç³»)æ— æ•ˆï¼Œè¢«å¿½ç•¥ã€‚ é¡¶ç‚¹ç€è‰²ç¨‹åºå¿…é¡»å£°æ˜ä¸€ä¸ªè¾“å‡ºå˜é‡ï¼Œå¹¶ç»‘å®šPOSITIONè¯­ä¹‰è¯ï¼Œè¯¥å˜é‡ä¸­çš„æ•°æ®å°†è¢«ç”¨äºä¸”è‡³è¢«ç”¨äºå…‰æ …åŒ–ï¼ ä¸ºäº†ä¿æŒé¡¶ç‚¹ç¨‹åºè¾“å‡ºè¯­ä¹‰å’Œç‰‡æ®µç¨‹åºè¾“å…¥è¯­ä¹‰çš„ä¸€è‡´æ€§ï¼Œé€šå¸¸ä½¿ç”¨ç›¸åŒçš„structç±»å‹æ•°æ®ä½œä¸ºä¸¤è€…ä¹‹é—´çš„ä¼ é€’ï¼Œè¿™æ˜¯ä¸€ç§éå¸¸æ–¹ä¾¿çš„å†™æ³•ï¼Œæ¨èä½¿ç”¨ã€‚ æ³¨æ„ï¼šå½“ä½¿ç”¨structç»“æ„ä¸­æˆå‘˜å˜é‡ç»‘å®šè¯­ä¹‰æ—¶ï¼Œéœ€è¦ä¸»è¦åˆ°é¡¶ç‚¹ç€è‰²ç¨‹åºä¸­ä½¿ç”¨çš„POSITIONè¯­ä¹‰è¯ï¼Œæ˜¯ä¸ä¼šè¢«ç‰‡æ®µç¨‹åºæ‰€ä½¿ç”¨çš„ã€‚ éƒ½è¦è®°ä½vertex programä¸­çš„ç»‘å®šè¯­ä¹‰(POSITIONé™¤å¤–)çš„è¾“å‡ºå½¢å‚ä¸­çš„æ•°æ®ä¼šä¼ é€’åˆ°fragment programä¸­ç»‘å®šç›¸åŒè¯­ä¹‰çš„è¾“å…¥å½¢å‚ä¸­ã€‚ ç‰‡æ®µç€è‰²å™¨çš„è¾“å‡ºè¯­ä¹‰è¯è¾ƒå°‘ï¼Œé€šå¸¸æ˜¯COLORã€‚è¿™æ˜¯å› ä¸ºç‰‡æ®µç€è‰²ç¨‹åºè¿è¡Œå®Œæ¯•åï¼Œå°±åŸºæœ¬åˆ°äº†GPUæµæ°´çº¿çš„æœ«ç«¯äº†ã€‚ç‰‡æ®µç¨‹åºå¿…é¡»å£°æ˜ä¸€ä¸ªoutå‘é‡(ä¸‰å…ƒæˆ–å››å…ƒ),ç»‘å®šè¯­ä¹‰è¯COLORï¼Œè¿™ä¸ªå€¼å°†è¢«ç”¨ä½œè¯¥ç‰‡æ®µçš„æœ€ç»ˆé¢œè‰²å€¼ã€‚ è¯­ä¹‰ç»‘å®šæ–¹æ³•ç»‘å®šè¯­ä¹‰æ”¾åœ¨å‡½æ•°çš„å‚æ•°åˆ—è¡¨çš„å‚æ•°å£°æ˜åé¢ä¸­ï¼š [const][int|out|inout]&lt;type&gt;&lt;identifier&gt;[:&lt;binding-semantic&gt;][=&lt;initializer&gt;] ç»‘å®šè¯­ä¹‰å¯ä»¥æ”¾åœ¨ç»“æ„ä½“(struct)çš„æˆå‘˜å˜é‡åé¢ï¼š 1234struct &lt;struct-tag&gt;&#123; &lt;type&gt;&lt;identifier&gt; [:&lt;binding-semantic&gt;];&#125;; ç»‘å®šè¯­ä¹‰è¯å¯ä»¥æ”¾åœ¨å‡½æ•°å£°æ˜çš„åé¢ï¼Œå…¶å½¢å¼ä¸ºï¼š1234&lt;type&gt; &lt;identifier&gt;(&lt;parameter-list&gt;)[:&lt;binding-semantic&gt;]&#123; &lt;body&gt;&#125; æœ€åä¸€ç§è¯­ä¹‰ç»‘å®šçš„æ–¹æ³•æ˜¯ï¼Œå°†ç»‘å®šè¯­ä¹‰è¯æ”¾åœ¨å…¨å±€éé™æ€å˜é‡çš„å£°æ˜åé¢ã€‚å…¶å½¢å¼ä¸ºï¼š &lt;type&gt; &lt;identifer&gt;[:&lt;binding-semantic&gt;][=&lt;initializer&gt;];]]></content>
      <tags>
        <tag>CG</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity Mesh]]></title>
    <url>%2F2018%2F04%2F21%2FUnity-Mesh%2F</url>
    <content type="text"><![CDATA[Meshæ˜¯Unityå†…çš„ä¸€ä¸ªç»„ä»¶ï¼Œæˆä¸ºç½‘æ ¼ç»„ä»¶ã€‚ Meshç½‘æ ¼ MeshFilterç½‘æ ¼è¿‡æ»¤å™¨ Mesh Renderer ç½‘æ ¼æ¸²æŸ“å™¨ Mesh: æ˜¯æŒ‡æ¨¡å‹çš„ç½‘æ ¼ï¼Œå»ºæ¨¡å°±æ˜¯å»ºç½‘æ ¼ã€‚Meshçš„ä¸»è¦å±æ€§å†…å®¹åŒ…æ‹¬é¡¶ç‚¹åæ ‡ï¼Œæ³•çº¿ï¼Œçº¹ç†åæ ‡ï¼Œä¸‰è§’å½¢ç»˜åˆ¶åºåˆ—ç­‰å…¶ä»–æœ‰ç”¨å±æ€§å’ŒåŠŸèƒ½ã€‚å› æ­¤å»ºç½‘æ ¼ï¼Œå°±æ˜¯ç”»ä¸‰è§’å½¢ï¼›ç”»ä¸‰è§’å½¢å°±æ˜¯å®šä½ä¸‰ä¸ªç‚¹ã€‚Mesh Filter: å†…åŒ…å«ä¸€ä¸ªMeshç»„ä»¶ï¼Œå¯ä»¥æ ¹æ®MeshFilterè·å¾—ç½‘æ ¼çš„ç»„ä»¶ï¼Œä¹Ÿå¯ä»¥ä¸ºMeshFilterè®¾ç½®Meshå†…å®¹ã€‚Mesh Renderer: æ˜¯ç”¨äºæŠŠç½‘æ ¼æ¸²æŸ“å‡ºæ¥çš„ç»„ä»¶ã€‚MeshFilterçš„ä½œç”¨å°±æ˜¯æŠŠMeshæ‰”ç»™MeshRenderå°†æ¨¡å‹æˆ–è€…æ˜¯å‡ ä½•ä½“ç»˜åˆ¶æ˜¾ç¤ºå‡ºæ¥ã€‚ å®ƒä»¬ä¹‹é—´çš„å…³ç³»å¤§æ¦‚å°±æ˜¯GameObjectæŒ‚MeshFilterç»„ä»¶ï¼Œè¯¥ç»„ä»¶æœ‰Meshå±æ€§ï¼Œè¯¥å±æ€§å­˜é¡¶ç‚¹åæ ‡ï¼Œæ³•çº¿ç­‰å±æ€§ï¼Œç„¶åç”¨Mesh Renderer(SkinMeshRenderer)æ‰èƒ½å°†æ­¤ç½‘æ ¼æ¸²æŸ“å‡ºæ¥ã€‚ Meshå±æ€§ é¡¶ç‚¹åæ ‡(vertex) é¡¶ç‚¹åæ ‡æ•°ç»„å­˜æ”¾Meshçš„æ¯ä¸ªé¡¶ç‚¹ç©ºé—´åæ ‡ï¼Œå‡è®¾æŸmeshæœ‰nä¸ªé¡¶ç‚¹ï¼Œåˆ™vertexçš„sizeä¸ºn æ³•çº¿(normal) æ³•çº¿æ•°ç»„å­˜æ”¾meshæ¯ä¸ªé¡¶ç‚¹çš„æ³•çº¿ï¼Œå¤§å°ä¸é¡¶ç‚¹åæ ‡å¯¹åº”ï¼Œnormal[i]å¯¹åº”vector[i]çš„æ³•çº¿ çº¹ç†åæ ‡(uv) å®ƒå®šä¹‰äº†å›¾ç‰‡ä¸Šæ¯ä¸ªç‚¹çš„ä½ç½®çš„ä¿¡æ¯ï¼Œè¿™äº›ç‚¹ä¸3Dæ¨¡å‹æ˜¯äº’ç›¸è”ç³»çš„ï¼Œä»¥å†³å®šè¡¨é¢çº¹ç†è´´å›¾çš„ä½ç½®ï¼ŒUVå°±æ˜¯å°†å›¾åƒä¸Šæ¯ä¸ªç‚¹ç²¾ç¡®å¯¹åº”åˆ°æ¨¡å‹ç‰©ä½“çš„è¡¨é¢uv[i]å¯¹åº”vectex[i] ä¸‰è§’å½¢åºåˆ—(triangle) æ¯ä¸ªmeshéƒ½ç”±è‹¥å¹²ä¸ªä¸‰è§’å½¢ç»„æˆï¼Œè€Œä¸‰è§’å½¢çš„ä¸‰ä¸ªç‚¹å°±æ˜¯é¡¶ç‚¹åæ ‡é‡Œçš„ç‚¹ï¼Œä¸‰è§’å½¢çš„æ•°ç»„çš„size - ä¸‰è§’å½¢ä¸ªæ•° * 3 ä¾‹å¦‚ï¼šæŸmeshæœ‰å››ä¸ªé¡¶ç‚¹0,1,2,3v0( 1, 1, 0)v1(-1, 1, 0)V2( 1,-1, 0)V3(-1,-1, 0)é‚£ä¹ˆå®ƒä»¬å¯ä»¥ç»„æˆè¿™æ ·çš„ä¸€ä¸ªç½‘æ ¼tri[0] = v0,v3,v1, tri[1] = v0, v2, v3 æ³¨æ„ï¼šä¸‰è§’å½¢çš„é¡¶ç‚¹é¡ºåºå¿…é¡»æ˜¯é¡ºæ—¶é’ˆï¼Œé¡ºæ—¶é’ˆè¡¨ç¤ºæ­£é¢ï¼Œé€†æ—¶é’ˆè¡¨ç¤ºèƒŒé¢ï¼Œè€ŒUnity3Dåœ¨æ¸²æŸ“é»˜è®¤åªæ¸²æŸ“æ­£é¢ï¼ŒèƒŒé¢æ˜¯çœ‹ä¸è§çš„ã€‚(åŒé¢æ¸²æŸ“ä¸€èˆ¬ç”¨äºå¤´å‘ç­‰æè´¨çš„å¤„ç†)é‚£ä¹ˆè¯¥ä¸‰è§’å½¢å¯ä»¥è¡¨ç¤º: tri = new int[2 * 3]{0,3,1, 0, 2, 3}; å¦‚ä½•è¦è·å–ç¬¬Nä¸ªä¸‰è§’å½¢å¯¹åº”çš„ä¸‰ä¸ªé¡¶ç‚¹åæ ‡ï¼Œåˆ™:V1 = tri[N 3+0],v2 = tri[N 3 + 1], v3 = tri[N * 3 + 2] å®ä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748using UnityEngine;using System.Collections;//æ³¨æ„Unityæ˜¯å·¦æ‰‹åæ ‡ç³»ï¼ï¼ï¼ï¼ŒUnityé»˜è®¤æ˜¯ä¸æ¸²æŸ“èƒŒé¢çš„public class CreateMesh : MonoBehaviour &#123; private MeshFilter filter; private Mesh mesh; void Start () &#123; filter = GetComponent&lt;MeshFilter&gt;(); mesh = new Mesh(); filter.mesh = mesh; InitMesh(); &#125; void InitMesh() &#123; mesh.name = "MyMesh"; Vector3[] vertics = new Vector3[8]&#123; new Vector3(1,1,0), new Vector3(-1, 1, 0), new Vector3(1,-1,0), new Vector3(-1,-1,0), new Vector3(1,1,1), new Vector3(-1, 1, 1), new Vector3(1,-1,1), new Vector3(-1,-1,1) &#125;; mesh.vertices = vertics; int[] triangles = new int[12 * 3]&#123; 0, 3, 1, 0, 2, 3, 4, 7, 5, 4, 6, 7, 0, 1, 5, 0, 5, 4, 2, 3, 7, 2, 7, 6, 0, 4, 6, 0, 6, 2, 1, 3, 7, 1, 7, 5, &#125;; mesh.triangles = triangles; /*Vector2[] uv = new Vector2[4]&#123; new Vector2(1,1), new Vector2(0,1), new Vector2(1,0), new Vector2(0,0) &#125;; mesh.uv = uv;*/ &#125;&#125; æ•ˆæœå¦‚ä¸‹(ä¸€å®šè¦åŠ Mesh Rendererå› ä¸ºè¿™ç©æ„æ˜¯è´Ÿè´£æ¸²æŸ“çš„,Unityè¿™è´§æè´¨ç¼ºå¤±å°±æ˜¯æ˜¾ç¤ºç²‰è‰²çš„) ç½‘æ ¼å·²ç»ç”Ÿæˆäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç»™ç½‘æ ¼è´´å›¾äº†ï¼Œuvå±æ€§ä¼šç›´æ¥æ§åˆ¶è´´æ˜¾ç¤ºè´´å›¾çš„å“ªä¸€éƒ¨åˆ†ï¼Œä»¥åŠå¦‚ä½•æ˜¾ç¤ºè´´å›¾uvä¸­çš„æ¯ä¸€é¡¹å’Œverticesçš„æ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œunityåœ¨è´´å›¾çš„æ—¶å€™ï¼Œä¼šæŠŠuvä¸­çš„æ¯ä¸€ä¸ªç‚¹å’Œverticesä¸­å¯¹åº”çš„ç´¢å¼•çš„é¡¶ç‚¹ä¸€ä¸€å…³è”èµ·æ¥ï¼Œè¿™æ ·å¯ä»¥å®ç°è´´å›¾ä»»æ„å½¢çŠ¶å®ç°æœ€ç»ˆæ•ˆæœ sharedåœ¨æºå¯¹è±¡ä¸Šä¿®æ”¹å±æ€§ï¼Œésharedæ¯æ¬¡ä¿®æ”¹å±æ€§ä¼šä»æ–°ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ã€‚åœ¨ç¼–è¾‘å™¨ä¸‹éè¿è¡ŒæœŸå¦‚æœä½¿ç”¨sharedä¼šä¿®æ”¹æœ¬åœ°æ–‡ä»¶ï¼Œå¦‚æœä½¿ç”¨ésharedä¼šæç¤ºå†…å­˜æ³„æ¼ã€‚]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[cocos2d]]></title>
    <url>%2F2018%2F04%2F20%2Fcocos2d%2F</url>
    <content type="text"></content>
      <tags>
        <tag>Cocos2D</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¯»ä»™æ‰‹æ¸¸å®¢æˆ·ç«¯åˆ†æ]]></title>
    <url>%2F2018%2F04%2F20%2Fxxsy-client-framework%2F</url>
    <content type="text"><![CDATA[å¯»ä»™æ‰‹æ¸¸å®¢æˆ·ç«¯æ˜¯é‡‡ç”¨Unity5.3.8+uLuaå¼€å‘çš„ä¸€æ¬¾MMORPGæ‰‹æ¸¸ã€‚ æµç¨‹é¡ºåºåº”ç”¨ç¨‹åºå¯åŠ¨Handheld.PlayFullScreenMovieé€šè¿‡è¯¥æ–¹æ³•æ’­æ”¾è§†é¢‘æ–‡ä»¶è¿›å…¥æ›´æ–°æ¨¡å—SDKåˆå§‹åŒ–å®‰å“é€šè¿‡AndroidJavaClassè®¿é—®Javaå®ä¾‹ èµ„æºæ¨¡å—UIæ¨¡å—æ›´æ–°æ¨¡å—ç½‘ç»œæ¨¡å—è¿™é‡Œæ˜¯åœ¨å¤šçº¿ç¨‹ä¸­åšçš„ï¼Œä½¿ç”¨çš„æ˜¯NetworkStreamè¿™ä¸ªã€‚ Luaæ¨¡å—Lua æ³¨å†Œ1234567891011121314151617181920212223242526272829303132[MonoInvokeCallbackAttribute(typeof(LuaCSFunction))]static int call(System.IntPtr L)&#123; int upidx = LuaDLL.lua_upvalueindex(1); int fnidx = (int)LuaDLL.lua_touserdata(L, upidx); if (fnidx &lt;= || fnidx &gt; m_count) &#123; LuaDLL.luaL_error(L, "SafeCallApi : bad function index " + fnidx); return 0; &#125; var info = m_infos[fnidx - 1]; try &#123; if (L != LuaMgr.m_L) &#123; using (new GuardL &#123; L = LuaMgr.m_L&#125;) &#123; LuaMgr.m_L = L; int v = info.function(); return v; &#125; &#125; int r = info.function(); return r; &#125; catch (System.Exception err) &#123; LuaDLL.lua_pushstring(L, "SafeCallApi : exception \n" + err.ToString()); &#125; LuaDll.lua_error(L); return 0;&#125; æŠ€èƒ½æ¨¡å—è§’è‰²æ¨¡å—åŠ¨ç”»æ¨¡å—çŠ¶æ€æ¨¡å—CDæ¨¡å—çŠ¶æ€æ¨¡å—åœºæ™¯æ¨¡å—å­ç‰©ä½“æ¨¡å—åŒå±ç³»ç»Ÿæ¯ä¸ªåœºæ™¯é‡Œä¸€èˆ¬éƒ½æœ‰å¾ˆå¤šå¯¹è±¡ï¼Œå¯¹å…¶ä¸­ä¸€ä¸ªå¯¹è±¡è€Œè¨€ï¼Œå®ƒä¸€èˆ¬åªå…³æ³¨è‡ªå·±å‘¨å›´ä¸€å®šèŒƒå›´å†…çš„å…¶å®ƒå¯¹è±¡ã€‚åŒå±ç³»ç»Ÿçš„ä¸»è¦å·¥ä½œå°±æ˜¯å°†å¯¹è±¡å‘¨å›´ä¸€å®šèŒƒå›´å†…çš„å…¶å®ƒå¯¹è±¡ç²¾ç¡®ä¸”é«˜æ•ˆçš„ç»Ÿè®¡ï¼Œä¸ºå®¢æˆ·ç«¯çš„è¡¨ç°ä»¥åŠå…¶å®ƒç³»ç»Ÿæä¾›æœåŠ¡ã€‚ æˆ‘ä»¬é‡‡å–çš„æ€æƒ³æ˜¯æ¯ä¸ªå¯¹è±¡ç»´æŠ¤äº†ä¸€ä¸ªåŒå±ä¿¡æ¯ï¼ŒåŒå±ä¿¡æ¯ä¸»è¦åŒ…æ‹¬åŒå±å¯¹è±¡åˆ—è¡¨å’ŒåŒå±ç©å®¶åˆ—è¡¨ã€‚ å¯¼è‡´åŒå±ä¿¡æ¯è¡¨æ”¹å˜çš„åŸå› ä¸»è¦æœ‰ä¸‰ä¸ªï¼šæ–°å¯¹è±¡è¿›å…¥åœºæ™¯ï¼Œå¯¹è±¡ä½ç½®æ”¹å˜ï¼Œå¯¹è±¡ç¦»å¼€åœºæ™¯ã€‚é’ˆå¯¹ä»¥ä¸Šä¸‰ç§åŸå› æˆ‘ä»¬é‡‡å–äº†ä¸¤ç§å®ç°æœºåˆ¶ï¼šå®šæ—¶æ›´æ–°æœºåˆ¶ï¼Œç«‹åˆ»æ›´æ–°æœºåˆ¶ã€‚ç«‹åˆ»æ›´æ–°æœºåˆ¶ï¼š ä¸»è¦é’ˆå¯¹å¯¹è±¡ç¦»å¼€åœºæ™¯çš„æƒ…å†µã€‚ å®ç°æ­¥éª¤ä¸»è¦æ˜¯æ ¹æ®ç¦»å¼€å¯¹è±¡è®°å½•çš„åŒå±ä¿¡æ¯ï¼Œå†ç›¸å…³è”å¯¹è±¡å’Œè‡ªå·±çš„åŒå±ä¿¡æ¯å†…ç›¸äº’å»æ‰ã€‚å®šæ—¶æ›´æ–°æœºåˆ¶ï¼š ä¸»è¦é’ˆå¯¹å¯¹è±¡è¿›å…¥åœºæ™¯å’Œå¯¹è±¡ä½ç½®æ”¹å˜ä¸¤ä¸ªåŸå› ã€‚ é’ˆå¯¹å¯¹è±¡è¿›å…¥åœºæ™¯åŸå› å®ç°ä¸»è¦æ˜¯å¯¹è±¡è¿›å…¥åœºæ™¯æ—¶ï¼Œè®¾ç½®æ–°å¯¹è±¡æ ‡è®°ã€‚ç„¶åé€šè¿‡å®šæ—¶æ›´æ–°å®ç°åŒå±ä¿¡æ¯å˜åŒ–ã€‚ é’ˆå¯¹å¯¹è±¡ä½ç½®æ”¹å˜åŸå› å®ç°æ­¥éª¤ä¸»è¦æ˜¯å¯¹è±¡ä½ç½®æ”¹å˜ï¼Œè®¾ç½®ä½ç½®å˜æ›´æ ‡è®°ã€‚ç„¶åé€šè¿‡å®šæ—¶æ›´æ–°å®ç°åŒå±ä¿¡æ¯å˜åŒ–ã€‚ å®šæ—¶æ›´æ–°æœºåˆ¶æ˜¯æ¯ä¸ªtickå¯¹åœºæ™¯å†…æ‰€æœ‰æœ¬tickè¿›è¡Œè¿‡ä½ç½®å˜åŒ–æˆ–è€…æ–°è¿›å…¥çš„å¯¹è±¡è¿›è¡ŒåŒå±ä¿¡æ¯æ›´æ–°ã€‚æ›´æ–°çš„ä¸»è¦é€»è¾‘æ˜¯å†åŒå±ä¿¡æ¯å†…çš„å¯¹è±¡è‹¥ç¦»å¼€åŒå±åˆ™è¿›è¡Œæ¸…é™¤å’Œæœªåœ¨åŒå±ä¿¡æ¯å†…çš„ç©å®¶è‹¥æ»¡è¶³è¿›å…¥åŒå±åˆ™åŠ å…¥ã€‚ ç”±äºå®šæ—¶æ›´æ–°ä½¿ç”¨é¢‘ç¹ä¸”å®ç°å¤æ‚ï¼Œå› æ­¤é‡‡å–äº†æç¬‘çš„å®ç°æ–¹æ³•æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚ç”±äºå®šæ—¶æ›´æ–°éœ€è¦æ£€æµ‹å“ªäº›å¯¹è±¡è¿›å…¥åŒå±ï¼Œå¦‚æœæ•´ä¸ªæ£€æµ‹æ•´ä¸ªåœºæ™¯å†…çš„å¯¹è±¡ï¼Œæ¯”è¾ƒè´¹ï¼Œç”±æ­¤æå‡ºäº†å•å…ƒæ ¼æ¦‚å¿µ(CellSpace)ï¼Œå°±æ˜¯æŠŠåœºæ™¯åˆ’åˆ†N * Nçš„æ ¼å­ï¼Œæ¯ä¸ªå„è‡ªä½œä¸ºä¸€ä¸ªå•å…ƒæ ¼ï¼Œå•å…ƒæ ¼å†…ç»´æŠ¤å¯¹è±¡åˆ—è¡¨ã€‚ç„¶åå†æ ¹æ®ç©å®¶çš„åŒå±è·ç¦»ï¼Œé¦–å…ˆè·å¾—æ‰€åœ¨çš„å•å…ƒæˆˆï¼Œå†åˆ¤æ–­å¯¹åº”å•å…ƒæ ¼çš„å¯¹è±¡æ˜¯å¦è¿›å…¥å¯¹è±¡åŒå±ï¼Œå‡å°‘åˆ¤æ–­æ•°é‡ã€‚ æ¸¸æˆä¸“ç”¨å­ç³»ç»Ÿæ­¦å™¨ã€é“å…·ã€æ¸¸æˆä¸“ç”¨æ¸²æŸ“åœ°å½¢æ¸²æŸ“ã€æ°´ä½“æ¨¡æ‹ŸåŠæ¸²æŸ“ç©å®¶æœºåˆ¶çŠ¶æ€æœºåŠåŠ¨ç”»ã€ç›¸å¯¹æ‘„åƒæœºçš„æ“æ§ï¼ˆHIDï¼‰ã€ç¢°æ’æµè¡Œã€ç§»åŠ¨æ¸¸æˆæ‘„åƒæœºå›ºå®šè®¾æƒ³ã€è„šæœ¬/åŠ¨ç”»æ‘„åƒæœºã€è·Ÿè¸ªç©å®¶æ‘„åƒæœºã€è°ƒè¯•ç”¨é£è¡Œæ‘„åƒæœºäººå·¥æ™ºèƒ½ç›®æ ‡åŠå†³ç­–ã€åŠ¨ä½œï¼ˆå¼•æ“æ¥å£ï¼‰ã€è§†çº¿è¿½è¸ªåŠæ„ŸçŸ¥ã€è·¯å¾„æœå¯»ï¼ˆA* ï¼‰å‰ç«¯å¹³è§†æ˜¾ç¤ºå™¨ï¼ˆHUDï¼‰ã€å…¨åŠ¨è§†é¢‘ï¼ˆFMVï¼‰ã€æ¸¸æˆå†…ç½®ç”µå½±ï¼ˆIGCï¼‰ã€æ¸¸æˆå†…ç½®GUIã€æ¸¸æˆå†…ç½®èœå•ã€åŒ…è£¹/å¸å¼•æ¨¡å¼è§†è§‰æ•ˆæœå…‰ç…§è´´å›¾åŠåŠ¨æ€é˜´å½±ã€é«˜åŠ¨æ€å…‰ç…§ã€PRTå…‰ç…§æ­¤è¡¨é¢æ•£å°„ã€ç²’å­åŠè´´èŠ±ç³»ç»Ÿã€åå¤„ç†æ•ˆæœã€ç¯å¢ƒè´´å›¾åœºæ™¯å›¾/å‰”é™¤ä¼˜åŒ–ç©ºé—´éƒ¨åˆ†ï¼ˆBSPæ ‘ï¼‰ã€é®æŒ¡åŠæ½œåœ¨å¯è§é›†ã€çº¹ç†åŠè¡¨é¢ç®¡ç†ã€è°ƒè¯•ç»˜å›¾ï¼ˆç›´çº¿ç­‰ï¼‰ã€å›¾å½¢è®¾å¤‡æ¥å£æ€§èƒ½å‰–æåŠè°ƒè¯•å½•å½±åŠå›æ”¾ã€å†…å­˜åŠæ€§èƒ½ç»Ÿè®¡ã€æ¸¸æˆå†…èœå•æˆ–æ§åˆ¶å°æ¸¸æˆæ€§åŸºç¡€é«˜å±‚æ¬¡çš„æ¸¸æˆæµç¨‹ç³»ç»Ÿ/FSMè„šæœ¬ç³»ç»Ÿé™æ€ä¸–ç•Œå…ƒç´ ã€åŠ¨æ€æ¸¸æˆå¯¹è±¡æ¨¡å‹ã€å®æ—¶åŸºäºä»£ç†äººæ¨¡æ‹Ÿã€æ—¶é—´/ä¿¡æ¯ç³»ç»Ÿã€ä¸–ç•Œè½½å…¥/ä¸²æµéª¨éª¼åŠ¨ç”»åŠ¨ç”»çŠ¶æ€æ ‘åŠè¹­ã€åå‘åŠ¨åŠ›å­¦ï¼ˆIKï¼‰å±‚é˜¶å¼ç‰©ä½“ä¾é™„ã€æ¸¸æˆä¸“ç”¨çš„åæœŸå¤„ç†ã€çº¿æ€§æ’å€¼ã€åŠ¨ç”»æ’­æ”¾ã€å­éª¨éª¼æ’­æ”¾ã€åŠ¨ç”»è§£å‹ã€éª¨éª¼ç½‘æ ¼æ¸²æŸ“ã€å¸ƒå¨ƒå¨ƒç‰©ç†åœ¨çº¿å¤šäººå®‰æ’æ¯”èµ›åŠæ¸¸æˆç®¡ç†ã€å¯¹è±¡ç®¡è¾–æƒç­–ç•¥ã€æ¸¸æˆçŠ¶æ€å¤åˆ¶éŸ³é¢‘DSP/æ•ˆæœã€ä¸‰ç»´éŸ³é¢‘æ¨¡å‹ã€éŸ³é¢‘æ’­æ”¾/ç®¡ç†ä½é˜¶æ¸²æŸ“å™¨æè´¨åŠç€è‰²å™¨ã€é™æ€åŠåŠ¨æ€å…‰æºã€æ‘„åƒæœºã€æ–‡æœ¬åŠå­—ä½“ã€å‡ ä½•å›¾å…ƒæäº¤ã€è§†åŒºåŠè™šæ‹Ÿå±å¹•ã€çº¹ç†åŠè¡¨é¢ç®¡ç†ã€è°ƒè¯•ç»˜å›¾ï¼ˆç›´çº¿ç­‰ï¼‰ã€å›¾å½¢è®¾å¤‡æ¥å£ç¢°æ’åŠç‰©ç†åŠ›åŠçº¦æŸã€å…‰çº¿/å½¢çŠ¶æŠ•å½±ï¼ˆæŸ¥è¯¢ï¼‰ã€åˆšä½“ã€Phantomã€å½¢çŠ¶/å¯ç¢°æ’ä½“ã€ç‰©ç†/ç¢°æ’ä¸–ç•Œäººä½“å­¦æ¥å£è®¾å¤‡ï¼ˆHIDï¼‰æ¸¸æˆä¸“ç”¨æ¥å£ã€ç‰©ç†è®¾å¤‡I/Oèµ„æºï¼ˆæ¸¸æˆèµ„äº§ï¼‰ä¸‰ç»´æ¨¡å‹èµ„æºã€çº¹ç†èµ„æºã€æè´¨èµ„æºã€å­—ä½“èµ„æºã€éª¨éª¼èµ„æºã€ç¢°æ’èµ„æºã€ç‰©ç†å‚æ•°ã€æ¸¸æˆä¸–ç•Œ/åœ°å›¾ã€å…¶ä»–æ ¸å¿ƒç³»ç»Ÿæ¨¡å—å¯åŠ¨åŠç»ˆæ­¢ã€æ–­è¨€ã€å•å…ƒæµ‹è¯•ã€å†…å­˜åˆ†é…ã€æ•°å­¦åº“ã€å­—ç¬¦ä¸²åŠæ•£åˆ—å­—ç¬¦ä¸²æ ‡è¯†ç¬¦ã€è°ƒè¯•ç”¨æ‰“å°åŠæ—¥å¿—ã€æœ¬åœ°åŒ–æœåŠ¡ã€å½±ç‰‡æ’­æ”¾å™¨ã€è¯­æ³•åˆ†æå™¨ï¼ˆCSVã€XMLç­‰ï¼‰ã€æ€§èƒ½å‰–æ/ç»Ÿè®¡é‡‡é›†ã€å¼•æ“é…ç½®ï¼ˆINIæ–‡ä»¶ç­‰ï¼‰ã€éšæœºæ•°ç”Ÿæˆå™¨ã€æ›²çº¿åŠæ›²åœ†åº“ã€RITI/åå°„/åºåˆ—åŒ–ã€å¯¹è±¡å¥æŸ„/å”¯ä¸€æ ‡è¯†ç¬¦ã€å¼‚æ­¥æ–‡ä»¶I/Oå¹³å°ç‹¬ç«‹å±‚å¹³å°æ£€æµ‹ã€åŸå­æ•°æ®ç±»å‹ã€é›†åˆåŠè¿­ä»£å™¨ã€æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œä¼ æ’­å±‚ï¼ˆUDP/TCPï¼‰ã€é«˜åˆ†è¾¨ç‡æ—¶é’Ÿã€çº¿ç¨‹åº“ã€å›¾å½¢åŒ…è£¹ç±»ã€ç‰©ç†/ç¢°æ’åŒ…è£¹ç±»ç¬¬ä¸‰æ–¹è½¯ä»¶å¼€å‘åŒ…DirectX\OpenGLã€Boostã€STL/STLPort]]></content>
      <tags>
        <tag>Unity</tag>
        <tag>MMORPG</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[.Net .Net Framework mono]]></title>
    <url>%2F2018%2F04%2F18%2FNet-Net-Framework-mono%2F</url>
    <content type="text"><![CDATA[.netä»ä¸€ä¸ªæŠ½è±¡ä¸Šæ¥è¯´å…¶å®æ˜¯ä¸€ä¸ªç†å¿µï¼Œä½¿å¤šç§è¯­è¨€ç¼–å†™çš„ç¨‹åºèƒ½å¤Ÿé€šè¿‡ä¸€ä¸ªé€šç”¨çš„Runtimeè¿è¡Œåœ¨ä¸åŒçš„æ“ä½œç³»ç»ŸåŠç¡¬ä»¶å¹³å°ä¸Šã€‚æ¯”å¦‚.net frameworkæ˜¯åœ¨windowsä¸Šå®ç°çš„.net platform,monoæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„.net platformä¸€ä¸ª.net platformæƒ³åˆ°è¾¾åˆ°.netçš„ç›®æ ‡ï¼Œå°±éœ€è¦ä¸€äº›ç»„ä»¶ï¼Œæ¯”å¦‚CLR(Common Language Runtime),æ¯”å¦‚FCLåŸºç¡€ç±»åº“ï¼Œæ¯”å¦‚å„ç§è¯­è¨€ç¼–è¯‘å™¨ï¼Œç¼–è¯‘å™¨ç¼–è¯‘å‡ºæ¥çš„ä¸œè¥¿æƒ³è¦åœ¨CLRä¸­è¿è¡Œï¼Œé‚£ä¹Ÿéœ€è¦éµå¾ªä¸€å®šçš„æ ‡å‡†ï¼Œè¿™å°±æ˜¯CLIå’ŒCILï¼ŒCILè§„å®šäº†ç¼–è¯‘è¾“å‡ºçš„è§„åˆ™ï¼Œè€ŒCLIè§„å®šäº†ç¼–è¯‘å™¨è¾“å…¥è¯­è¨€çš„è§„åˆ™ï¼Œåªæœ‰ç¬¦åˆè¿™ç§æ ‡å‡†çš„è¯­è¨€æ‰èƒ½ç¼–è¯‘æˆCILè¯­è¨€è¿è¡Œåœ¨CLRä¸­ã€‚å¥½äº†ç°åœ¨æœ‰CILå’ŒCLRï¼Œå¯ä»¥ç”¨ç¬¦åˆCLIçš„è¯­è¨€æ¯”å¦‚C#ç¼–å†™ç¨‹åºäº†ï¼Œç„¶åå°†å…¶ç¼–è¯‘æˆCILï¼Œæœ€ååœ¨CLRä¸­è¿è¡ŒUnityèƒ½è·¨å¹³å°çš„åŸå› å°±æ˜¯å®ç°äº†å„ä¸ªå¹³å°çš„â€å³æ—¶ç¼–è¯‘å™¨â€(C#ä»£ç -&gt;ä¸­é—´è¯­è¨€-&gt;å„ä¸ªå¹³å°çš„åŸç”Ÿä»£ç )]]></content>
  </entry>
  <entry>
    <title><![CDATA[å‡å°‘è£…ç®±(Boxing)å’Œæ‹†ç®±(UnBoxing)æ“ä½œ]]></title>
    <url>%2F2018%2F04%2F17%2FC-0%2F</url>
    <content type="text"><![CDATA[.Netçš„ç±»å‹åˆ†å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹ï¼Œè¿™ä¸¤ä¸ªç±»å‹çš„æœ¬è´¨åŒºåˆ«ï¼Œå€¼ç±»å‹æ•°æ®æ˜¯åˆ†é…åœ¨æ ˆä¸­ï¼Œè€Œå¼•ç”¨ç±»å‹æ•°æ®åˆ†é…åœ¨å †ä¸Šï¼Œé‚£ä¹ˆå¦‚æœè¦æŠŠä¸€ä¸ªå€¼ç±»å‹æ•°æ®æ”¾åˆ°å †ä¸Šï¼Œå°±éœ€è¦è£…ç®±æ“ä½œï¼›åä¹‹ï¼ŒæŠŠä¸€ä¸ªæ”¾åœ¨å †ä¸Šçš„å€¼ç±»å‹æ•°æ®å–å‡ºæ¥ï¼Œåˆ™éœ€è¦æ‹†ç®±æ“ä½œã€‚å‡å°‘è£…ç®±å’Œæ‹†ç®±æ“ä½œçš„å¥½å¤„ å¯¹äºå †çš„æ“ä½œæ•ˆç‡æ¯”è¾ƒä½ å †ä¸Šåˆ†é…çš„å†…å­˜èµ„æºï¼Œéœ€è¦GCæ¥å›æ”¶ï¼Œä»è€Œé™ä½ç¨‹åºæ•ˆç‡ æ ¼å¼åŒ–æ“ä½œæœ‰è¾ƒå¤šçš„è£…ç®±æ‹†ç®±æ“ä½œï¼Œæ¯”å¦‚String.Format, Console.WriteLineä¹‹ç±»çš„è¯­å¥ï¼Œ Console.WriteLine(&quot;Number list:{0}, {1}, {2}&quot;, 1.ToString(), t.2ToString(), 3.ToString()) ç”±äº1.ToString()çš„ç»“æœæ˜¯Stringç±»å‹ï¼Œå±äºå¼•ç”¨ç±»å‹ï¼Œå› æ­¤ä¸æ¶‰åŠè£…ç®±æ‹†ç®±æ“ä½œï¼›]]></content>
      <tags>
        <tag>C#</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity ECS Readme]]></title>
    <url>%2F2018%2F04%2F17%2FUnity-ECS-README%2F</url>
    <content type="text"><![CDATA[Entitas - The Entity Component System Framework for C# and UnityEntitas is a super fast Entity Component System Framework (ECS) specifically made for C# and Unity. Internal caching and blazing fast component access makes it second to none. Several design decisions have been made to work optimal in a garbage collected environment and to go easy on the garbage collector. Entitas comes with an optional code generator which radically reduces the amount of code you have to write and makes your code read like well written prose. Â» DownloadÂ» DocumentationÂ» Ask a questionÂ» Wiki and example projectsÂ» #madeWithEntitas Video Tutorials &amp; Unity Unite Talks Entitas ECS Unity Tutorial Entitas ECS Unity Tutorial Entity system architecture with Unity ECS architecture with Unity by example Setup &amp; Basics Git &amp; Unit Tests Â» Open the slides on SlideShare: Unite Europe 2015 Â» Open the slides on SlideShare: Unite Europe 2016 First glimpseThe optional code generator lets you write code that is super fast, safe and literally screams its intent. 123456789public static GameEntity CreateRedGem(this GameContext context, Vector3 position) &#123; var entity = context.CreateEntity(); entity.isGameBoardElement = true; entity.isMovable = true; entity.AddPosition(position); entity.AddAsset("RedGem"); entity.isInteractive = true; return entity;&#125; 123456var entities = context.GetEntities(Matcher&lt;GameEntity&gt;.AllOf(GameMatcher.Position, GameMatcher.Velocity));foreach(var e in entities) &#123; var pos = e.position; var vel = e.velocity; e.ReplacePosition(pos.value + vel.value);&#125; OverviewEntitas is fast, light and gets rid of unnecessary complexity. There are less than a handful classes you have to know to rocket start your game or application: Entity Context Group Entity Collector Read moreâ€¦ Code GeneratorThe Code Generator generates classes and methods for you, so you can focus on getting the job done. It radically reduces the amount of code you have to write and improves readability by a huge magnitude. It makes your code less error-prone while ensuring best performance. I strongly recommend using it! Read moreâ€¦ Unity integrationThe optional Unity module integrates Entitas nicely into Unity and provides powerful editor extensions to inspect and debug contexts, groups, entities, components and systems. Read moreâ€¦ Entitas deep diveRead the wiki or checkout the example projects to see Entitas in action. These example projects illustrate how systems, groups, collectors and entities all play together seamlessly. Download EntitasEach release is published with zip files containing all source files you need. Show releases Thanks toBig shout out to @mzaks, @cloudjubei and @devboy for endless hours of discussion and helping making Entitas awesome! Maintainer(s) @sschmid | @s_schmid | @entitas_csharp Different language?Entitas is available in C# Swift C++ Objective-C Java Python Scala Go F# TypeScript Kotlin Haskell Erlang Clojure]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity ECS]]></title>
    <url>%2F2018%2F04%2F16%2FUnity-Coroutine%2F</url>
    <content type="text"><![CDATA[CoroutinesWaitForENdOffFrame å¸§æœ«å°¾æ‰§è¡Œyield return null è¡¨ç¤ºæš‚ç¼“ä¸€å¸§ï¼Œåœ¨ä¸‹ä¸€å¸§æ¥ç€å¾€ä¸‹å¤„ç†ï¼Œäºyield return 0 æˆ– yield return 1ä¸€æ ·çš„åŠŸèƒ½yield return new WaitForSecondsåç¨‹çš„çœŸæ­£ç”¨é€”æ˜¯åˆ†å¸ƒåšä¸€ä¸ªæ¯”è¾ƒè€—æ—¶çš„äº‹æƒ…ï¼Œæ¯”å¦‚æ¸¸æˆé‡Œé¢çš„åŠ è½½èµ„æº Unityé¢å¯¹çš„é—®é¢˜ é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ–¹å¼ï¼ˆæ›¾ç»çš„åœ£å…¸ï¼Œå·²ç»è·Ÿä¸ä¸Šæ—¶ä»£ï¼ŒOOPæœ€å¤§çš„é—®é¢˜æ˜¯æ•°æ®å’Œé€»è¾‘æ··åœ¨ä¸€èµ·ï¼Œè€Œç°åœ¨æˆ‘ä»¬è¦æ•°æ®é©±åŠ¨æ¨¡å‹ï¼‰ ç”±Monoç¼–è¯‘çš„éæœ€ä¼˜æœºå™¨ç  GCæœºåˆ¶ å•çº¿ç¨‹å¼€å‘ å·¥ä½œæµç¨‹ åˆ›å»ºä¸€ä¸ªGameObjectå¯¹è±¡ï¼› åœ¨å¯¹è±¡ä¸Šæ·»åŠ ç»„ä»¶ï¼šRendererï¼ŒColliderï¼ŒRigidbody physicsï¼› åˆ›å»ºMonoBehaviourè„šæœ¬å¹¶å°†å…¶æ·»åŠ åˆ°å¯¹è±¡ä¸­ï¼Œä»¥ä¾¿åœ¨è¿è¡Œæ—¶æ§åˆ¶å’Œæ›´æ”¹è¿™äº›ç»„ä»¶çš„çŠ¶æ€å±æ€§ï¼› ä»¥ä¸Š3ä¸ªæ­¥éª¤æ‰§è¡Œï¼Œæˆ‘ä»¬æˆä¸ºUnityçš„æ‰§è¡Œæµç¨‹ï¼Œä½œä¸ºUnityå¼€å‘è€…æ¥è¯´ï¼Œè¿™ä¸ªæ˜¯æœ€åŸºæœ¬çš„æµç¨‹ã€‚ä½†æ˜¯è¿™ç§åšæ³•æœ‰å®ƒè‡ªå·±çš„ç¼ºç‚¹å’Œæ€§èƒ½é—®é¢˜ã€‚æ¯”å¦‚æ•°æ®å’Œé€»è¾‘æ˜¯ç´§å¯†è€¦åˆçš„ï¼Œè¿™æ„å‘³ç€ä»£ç é‡ç”¨çš„é¢‘ç‡æ¯”è¾ƒä½ï¼Œå› ä¸ºé€»è¾‘ä¸ç‰¹å®šæ•°æ®ç›¸å…³è”ï¼Œæ— æ³•å•ç‹¬åˆ†ç¦»å‡ºæ¥ã€‚ä¾‹å¦‚ä¸‹å›¾æ‰€ç¤ºçš„GameObjectå’ŒComponentså®ä¾‹ä¸­ï¼ŒGameObjectä¾èµ–äºTransformã€Rendererã€Rigidbodyå’ŒCollderå¼•ç”¨ï¼Œè¿™äº›è„šæœ¬ä¸­çš„å¼•ç”¨å¯¹è±¡åˆ†æ•£åœ¨å †å†…å­˜ä¸­ã€‚ æ¸¸æˆå¯¹è±¡ã€å…¶è¡Œä¸ºåŠå…¶ç»„ä»¶ä¹‹é—´çš„å†…å­˜å¼•ç”¨ï¼š Unity GameObjectåœºæ™¯å¯ä»¥è®©æ¸¸æˆåœ¨éå¸¸çŸ­çš„æ—¶é—´å†…å®ŒæˆåŸå‹æ„å»ºå¹¶è¿è¡Œï¼Œè¿™ä¸ªä¹Ÿæ˜¯Unityçš„ç‰¹è‰²å¯ä»¥è®©å¼€å‘è€…å¿«é€Ÿå…¥æ‰‹ï¼Œä½†å®ƒå¯¹äºæ€§èƒ½æ¥è¯´ä¸å¤ªç†æƒ³ã€‚æˆ‘ä»¬åœ¨æ·±å±‚æ¬¡çš„æ¢è®¨è¿™ä¸ªé—®é¢˜ï¼Œæ¯ä¸ªå¼•ç”¨ç±»å‹éƒ½åŒ…å«å¯èƒ½ä¸éœ€è¦è®¿é—®çš„è®¸å¤šé¢å¤–æ•°æ®ï¼Œè¿™äº›æœªä½¿ç”¨çš„æˆå‘˜ä¹Ÿå ç”¨äº†å¤„ç†å™¨ç¼“å­˜ä¸­çš„å®è´µç©ºé—´ã€‚æ¯”å¦‚æˆ‘ä»¬ç»§æ‰¿çš„Monoå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„æ¡ˆä¾‹ï¼Œå¦‚æœåªéœ€è¦ç°æœ‰ç»„ä»¶çš„æå°‘åŠŸèƒ½æ¥å£å‡½æ•°æˆ–è€…å˜é‡ï¼Œåˆ™å¯ä»¥å°†å…¶ä½™éƒ¨åˆ†è§†ä¸ºæµªè´¹ç©ºé—´ï¼Œå¦‚ä¸‹é¢çš„â€œæµªè´¹ç©ºé—´â€å›¾æ‰€ç¤ºï¼š åœ¨ä¸Šå›¾ä¸­ï¼Œç²—ä½“è¡¨ç¤ºå®é™…ç”¨äºç§»åŠ¨æ“ä½œçš„æˆå‘˜ï¼Œå…¶ä½™çš„å°±æ˜¯æµªè´¹ç©ºé—´ï¼Œè‹¥è¦ç§»åŠ¨GameObjectï¼Œè„šæœ¬éœ€è¦ä»Transformç»„ä»¶è®¿é—®ä½ç½®å’Œæ—‹è½¬æ•°æ®æˆå‘˜ã€‚å½“ç¡¬ä»¶ä»å†…å­˜ä¸­è·å–æ•°æ®æ—¶ï¼Œç¼“å­˜èˆªä¸­ä¼šå¡«å……è®¸å¤šå¯èƒ½æ— ç”¨çš„æ•°æ®ï¼Œå¦‚æœåªæ˜¯ä¸ºæ‰€æœ‰åº”è¯¥ç§»åŠ¨çš„GameObjectsè®¾ç½®ä¸€ä¸ªåªæœ‰ä½ç½®å’Œæ—‹è½¬æˆå‘˜çš„é˜µåˆ—ï¼Œè¿™å°†èƒ½å¤Ÿåœ¨å¾ˆçŸ­çš„æ—¶é—´å†…æ‰§è¡Œï¼Œå¦‚ä½•å»æ‰æ— ç”¨çš„æ•°æ®ï¼ŸECSå°±æ˜¯å‘³è§£å†³æ­¤é—®é¢˜è€Œè®¾è®¡çš„ã€‚ ECSå®ä½“ç»„ä»¶ç³»ç»ŸUnityçš„æ–°å®ä½“ç»„ä»¶ç³»ç»Ÿå¯å¸®åŠ©æ¶ˆé™¤ä½æ•ˆçš„å¯¹è±¡å¼•ç”¨ï¼Œæˆ‘ä»¬è€ƒè™‘åªåŒ…å«å®ƒæ‰€éœ€æ•°æ®çš„å®ä½“ï¼Œè€Œä¸è€ƒè™‘è‡ªå¸¦é›†åˆçš„GameObjectsã€‚åœ¨ä¸‹é¢çš„å®ä½“ç»„ä»¶ç³»ç»Ÿä¸­ï¼Œè¯·æ³¨æ„Bulletå®ä½“æ²¡æœ‰é™„ä»¶Transformæˆ–Rigidbodyç»„ä»¶ï¼ŒBulletå®ä½“åªæ˜¯æ˜¾ç¤ºè¿è¡Œæ›´æ–°æ‰€éœ€çš„åŸå§‹æ•°æ®ï¼Œå€ŸåŠ©è¿™ä¸ªæ–°ç³»ç»Ÿï¼Œæ‚¨å¯ä»¥å°†é€»è¾‘ä¸å„ä¸ªå¯¹è±¡ç±»å‹å®Œå…¨åˆ†ç¦»ã€‚ è¿™ä¸ªç³»ç»Ÿå…·æœ‰å¾ˆå¤§çš„ä¼˜åŠ¿ï¼šå®ƒä¸ä»…å¯ä»¥æä¾›ç¼“å­˜æ•ˆç‡ï¼Œç¼©çŸ­è®¿é—®æ—¶é—´ï¼›å®ƒè¿˜æ”¯æŒåœ¨éœ€è¦ä½¿ç”¨è¿™ç§æ•°æ®å¯¹é½æ–¹å¼çš„ç°ä»£CPUä¸­é‡‡ç”¨å…ˆè¿›æŠ€æœ¯ï¼ˆè‡ªåŠ¨çŸ¢é‡åŒ–/SIMDï¼‰è¿™ä¸ºæ¸¸æˆæä¾›äº†æ‰€éœ€çš„é»˜è®¤æ€§èƒ½ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸Šå›¾è¯·æ³¨æ„ç¼“å†²è¡Œå­˜å‚¨ä¸­çš„ç¢ç‰‡å’Œç»§æ‰¿Monoç³»ç»Ÿç”Ÿæˆçš„ç©ºé—´æµªè´¹ï¼Œæ•°æ®å¯¹æ¯”å¦‚ä¸‹æ‰€ç¤ºï¼š ä¸Šå›¾æ˜¯å°†ä¸å•ä¸ªç§»åŠ¨æ“ä½œç›¸å…³çš„å†…å­˜ç©ºé—´ä¸å®ç°ç³»ç»Ÿç›®æ ‡çš„ä¸¤ä¸ªæ“ä½œè¿›è¡Œå¯¹æ¯”çš„ç»“æœã€‚]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity Manual]]></title>
    <url>%2F2018%2F04%2F16%2FUnity-Manual%2F</url>
    <content type="text"><![CDATA[public static float Mathf.Round(float f) å››èˆäº”å…¥ YieldInstruction ä¸­æ–­æŒ‡ä»¤æ‰€æœ‰yieldæŒ‡ä»¤çš„åŸºç±»å‚è€ƒWaitForSeconds, WaitForFixedUpdate, Coroutine and MonoBehaviour,StartCoroutine WaitForSeconds ç­‰å¾…å‡ ç§’Namespace: UnityEngineInherits from: YieldInstruction åœ¨ç»™å®šçš„ç§’æ•°å†…ï¼Œæš‚åœååŒç¨‹åºçš„æ‰§è¡Œã€‚WaitForSecondsåªèƒ½ç”¨åœ¨ååŒç¨‹åºä¸­çš„yieldå£°æ˜ã€‚ RequireComponentå½“ä½ æ·»åŠ äº†ä¸€ä¸ªç”¨äº†RequireComponentç»„ä»¶çš„è„šæœ¬ï¼Œéœ€è¦çš„ç»„ä»¶å°†ä¼šè‡ªåŠ¨è¢«æ·»åŠ åˆ°GameObjectä¸Šã€‚è¿™ä¸ªå¯ä»¥æœ‰æ•ˆé¿å…ç»„è£…é”™è¯¯ã€‚åœ¨æ–°å»ºç±»çš„å‰é¢åŠ  [RequireComponent(typeof(LineRenderer))] AssetDatabase.ImportAssetstatic function ImportAsset(path : string, options : ImportAssetOptions = ImportAssetOptions.Default):void å¯¼å…¥æŒ‡å®šè·¯å¾„çš„èµ„æºæ‰€æœ‰è·¯å¾„éƒ½æ˜¯ç›¸å¯¹äºå·¥ç¨‹ç›®å½•æ–‡ä»¶ï¼Œä¾‹å¦‚â€Assets/MyTexture/hello.pngâ€ AssetImporter.GetAtPathstatic function GetAtPath(path: string):AssetImporter é€šè¿‡æŒ‡å®šè·¯å¾„æ¥å¯¼å…¥èµ„æº TextureWrapModeåœ¨è¿›è¡Œçº¹ç†è´´å›¾æ—¶ï¼Œå›¾åƒä¼šå‡ºç°åœ¨ç‰©ä½“è¡¨é¢(u,v)ä½ç½®ä¸Šï¼Œè€Œè¿™äº›å€¼åœ¨[0.0,1.0]èŒƒå›´å†…ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¶…å‡ºè¿™ä¸ªèŒƒå›´ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µå‘¢ï¼Œè¿™ç”±çº¹ç†çš„æ˜ å°„å‡½æ•°æ¥å†³å®š.å¸¸è§æœ‰ä¸‹é¢å‡ ç§ï¼š é‡å¤(REPEAT):å›¾åƒåœ¨è¡¨é¢ä¸Šé‡å¤å‡ºç°ã€‚åœ¨ç®—æ³•ä¸Šï¼Œå¿½ç•¥çº¹ç†åæ ‡çš„æ•´æ•°éƒ¨åˆ†ï¼Œå¹¶å°†çº¹ç†å›¾çš„æ‹·è´ç²˜è´´åœ¨ç‰©ä½“è¡¨é¢ä¸Šã€‚å¯¹äºå¤§å¤šæ•°å¤åˆ¶çº¹ç†çš„ä½¿ç”¨ï¼Œåœ¨çº¹ç†é¡¶éƒ¨çš„çº¹ç†å•å…ƒåº”äºåº•éƒ¨çš„çº¹ç†å•å…ƒç›¸åŒ¹é…ï¼Œåœ¨çº¹ç†å·¦ä¾§çš„çº¹ç†å•å…ƒä¹Ÿåº”äºå³ä¾§çš„çº¹ç†å•å…ƒç›¸åŒ¹é…ã€‚ æˆªå–(CLAMP): å°†å¤§äº1.0çš„æ•°å€¼è®¾ç½®ä¸º1.0ï¼Œå°†å°äº0.0çš„æ•°å€¼è®¾ç½®ä¸º0.0ï¼Œå³å°†è¶…å‡º[0.0,1.0]èŒƒå›´çš„æ•°å€¼æˆªå–åˆ°[0.0,1.0]èŒƒå›´å†…ï¼Œè¿™æ ·ä¼šå¯¼è‡´çº¹ç†è¾¹ç¼˜çš„é‡å¤ã€‚ é•œåƒé‡å¤(MIRRORED_REPEAT_ARB) è¾¹ç•Œæˆªå–(CLAMP_TO_BORDER_ARB) è¾¹ç¼˜æˆªå–(CLAMP_TO_EDGE) CameraClearFlag12345678public enum CameraClearFlags&#123; Skybox = 1, // è¿™æ˜¯é»˜è®¤è®¾ç½®ï¼Œåœ¨å±å¹•ä¸Šç©ºçš„éƒ¨åˆ†æ˜¾ç¤ºå½“å‰ç›¸æœºçš„å¤©ç©ºç›’ã€‚å¦‚æœå½“å‰ç›¸æœºæ²¡æœ‰è®¾ç½®å¤©ç©ºç›’ï¼Œå®ƒä¼šé»˜è®¤ä½¿ç”¨Edit-&gt;Render Settingsé‡Œ)ä¸­é€‰æ‹©å¤©ç©ºç›’ã€‚ç„¶åå®ƒå°†é€€å›ä½¿ç”¨èƒŒæ™¯é¢œè‰²ï¼Œå¦å¤–å¤©ç©ºç›’ç»„ä»¶å¯ä»¥æ·»åŠ åˆ°ç›¸æœºä¸Šã€‚ SolidColor = 2, // å±å¹•ä¸Šçš„ä»»ä½•ç©ºçš„éƒ¨åˆ†æ˜¾ç¤ºå½“å‰ç›¸æœºçš„èƒŒæ™¯é¢œè‰² Color = 2, Depth = 3, // è¯¥æ·±åº¦çš„ä¸œè¥¿æ°¸è¿œéƒ½ä¸ä¼šè¢«è£å‰ª Nothing = 4, // ä»€ä¹ˆäº‹æƒ…éƒ½ä¸åš&#125; ProjectornearClipPlane è¿‘è£å‰ªé¢çš„è·ç¦» farClipPlane è¿œè£å‰ªé¢çš„è·ç¦» fieldOfView è¯¥æŠ•å½±çš„è§†é‡ï¼Œä»¥åº¦ä¸ºå•ä½ aspectRatio æŠ•å½±çš„å®½é«˜æ¯” orthographic æŠ•å°„æ˜¯æ­£äº¤è¿˜æ˜¯é€è§† orthographicSize åœ¨æ­£äº¤æ¨¡å¼ä¸‹æŠ•å°„çš„ä¸€åŠå°ºå¯¸ ignoreLayers å“ªä¸ªç‰©ä½“å±‚è¢«è¿™ä¸ªæŠ•å°„å™¨å¿½ç•¥ material è¦æŠ•å°„åˆ°æ¯ä¸ªç‰©ä½“çš„æè´¨ MeshMesh.RecalculateBoundsåœ¨ä¿®æ”¹å®Œé¡¶ç‚¹åä½ åº”è¯¥ç”¨è¿™ä¸ªå‡½æ•°ä»¥ç¡®ä¿åŒ…å›´ä½“æ˜¯æ°å½“çš„ã€‚èµ‹å€¼ä¸‰è§’å½¢å°†è‡ªåŠ¨é‡æ–°è®¡ç®—åŒ…å›´ä½“ã€‚ Mesh.RecalculateNormalsé‡æ–°è®¡ç®—ç½‘æ ¼çš„æ³•çº¿åœ¨ä¿®æ”¹å®Œå®šç‚¹åï¼Œé€šå¸¸ä¼šæ›´æ–°å‘ç°æ¥åæ˜ æ–°çš„å˜åŒ–ã€‚å‘ç°æ˜¯æ ¹æ®å…±äº«çš„é¡¶ç‚¹è®¡ç®—å‡ºæ¥çš„ã€‚å¯¼å…¥åˆ°ç½‘æ ¼æœ‰æ—¶ä¸å…±äº«æ‰€æœ‰é¡¶ç‚¹ã€‚ä¾‹å¦‚ï¼šä¸€ä¸ªé¡¶ç‚¹åœ¨ä¸€ä¸ªçº¹ç†åæ ‡çš„æ¥ç¼å¤„å°†ä¼šè¢«åˆ†ä¸ºä¸¤ä¸ªé¡¶ç‚¹ã€‚å› æ­¤è¿™ä¸ªRecalculateNormalså‡½æ•°å°†ä¼šåœ¨çº¹ç†åæ ‡æ¥ç¼å¤„åˆ›å»ºä¸€ä¸ªä¸å…‰æ»‘çš„æ³•çº¿ã€‚RecalculateNormalsä¸ä¼šè‡ªåŠ¨äº§ç”Ÿåˆ‡çº¿ï¼Œå› æ­¤bumpmapç€è‰²å™¨åœ¨è°ƒç”¨RecalculateNormalsä¹‹åä¸ä¼šå·¥ä½œã€‚ç„¶è€Œä½ å¯ä»¥æå–ä½ è‡ªå·±çš„åˆ‡çº¿ã€‚ æƒ¯æ€§åæ ‡ç³»å› ä¸ºåœ¨è¿›è¡Œç‰©ä½“åˆ°ä¸–ç•Œåæ ‡ç³»çš„è½¬æ¢æ—¶å€™ï¼Œå³éœ€è¦å¹³ç§»åŒæ—¶ä¹Ÿéœ€è¦è¿›è¡Œæ—‹è½¬ï¼Œä¸ºäº†ç®€åŒ–è¿™ç§å˜åŒ–ï¼Œåœ¨å…¶ä¸­å‡å¦‚æƒ¯æ€§åæ ‡ç³»ï¼Œå…¶ä¸­æƒ¯æ€§åæ ‡ç³»çš„åŸç‚¹ä¸æœ¬åœ°åæ ‡ç³»çš„åŸç‚¹é‡åˆå…¶è½´å’Œä¸–ç•Œåæ ‡ç³»å¹³è‹±ã€‚é‚£ä¹ˆæœ¬åœ°åæ ‡ç³»åˆ°æƒ¯æ€§åæ ‡ç³»åªéœ€è¦æ—‹è½¬æ“ä½œï¼ˆä¹‹å‰ä¹Ÿå¾—ç¼©æ”¾ï¼‰å†åˆ°ä¸–ç•Œåæ ‡ç³»åªéœ€è¦è¿›è¡Œå¹³ç§»ã€‚ æ„å»ºAssetBundlesåœ¨AssetBundleå·¥ä½œæµçš„æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªä»£ç ç¤ºä¾‹ï¼Œå®ƒå°†ä¸‰ä¸ªå‚æ•°ä¼ é€’ç»™BuildPipeline.BuildAssetBundleså‡½æ•°ã€‚è®©æˆ‘ä»¬æ›´æ·±å…¥å®é™…çš„äº†è§£ã€‚Assets/AssetBundles:è¿™æ˜¯AssetBundlesè¾“å‡ºçš„ç›®å½•ã€‚æ‚¨å¯ä»¥å°†å…¶æ›´æ”¹ä¸ºæ‚¨æƒ³è¦çš„ä»»ä½•è¾“å‡ºç›®å½•ï¼Œåªéœ€ç¡®ä¿åœ¨å°è¯•æ„å»ºä¹‹å‰æ–‡ä»¶å¤¹å®é™…å­˜åœ¨ã€‚ BuildAssetBundleOptionsBuildAssetBundleOptionsæ‚¨å¯ä»¥æŒ‡å®šå‡ ç§å…·æœ‰å„ç§æ•ˆæœçš„ä¸åŒã€‚æœ‰å…³æ‰€æœ‰é€‰é¡¹çš„è¡¨ï¼Œè¯·å‚é˜…]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unityä¼˜åŒ–]]></title>
    <url>%2F2018%2F04%2F12%2FUnity-Optimize%2F</url>
    <content type="text"><![CDATA[æ›´æ–°ä¸é€æ˜è´´å›¾çš„å‹ç¼©æ ¼å¼ä¸ºETC 4bitï¼Œå› ä¸ºandroidå¸‚åœºçš„æ‰‹æœºä¸­çš„GPUæœ‰å¤šç§ï¼Œæ¯å®¶çš„GPUæ”¯æŒä¸åŒçš„å‹ç¼©æ ¼å¼ï¼Œä½†ä»–ä»¬éƒ½å…¼å®¹ETCæ ¼å¼ã€‚ å¯¹äºé€æ˜è´´å›¾ï¼Œæˆ‘ä»¬åªèƒ½é€‰æ‹©RGBA 16bit æˆ–è€…RGBA 32bitã€‚ å‡å°‘FPSï¼Œåœ¨ProjectSetting-&gt; Qualityä¸­çš„VSync Count å‚æ•°ä¼šå½±å“ä½ çš„FPSï¼ŒEveryVBlankç›¸å½“äºFPS=60ï¼ŒEverySecondVBlank = 30ï¼›è¿™ä¸¤ç§æƒ…å†µéƒ½ä¸ç¬¦åˆæ¸¸æˆçš„FPSçš„è¯ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨è°ƒæ•´FPSï¼Œé¦–å…ˆå…³é—­å‚ç›´åŒæ­¥è¿™ä¸ªåŠŸèƒ½ï¼Œç„¶ååœ¨ä»£ç çš„Awakeæ–¹æ³•é‡Œæ‰‹åŠ¨è®¾ç½®FPSï¼ˆApplication.targetFrameRate = 45;ï¼‰é™ä½FPSçš„å¥½å¤„ï¼š1ï¼‰çœç”µï¼Œå‡å°‘æ‰‹æœºå‘çƒ­çš„æƒ…å†µï¼›2ï¼‰èƒ½éƒ½ç¨³å®šæ¸¸æˆFPSï¼Œå‡å°‘å‡ºç°å¡é¡¿çš„æƒ…å†µã€‚ å½“æˆ‘ä»¬è®¾ç½®äº†FPSåï¼Œå†è°ƒæ•´ä¸‹Fixed timestepè¿™ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°åœ¨ProjectSetting-&gt;Timeä¸­ï¼Œç›®çš„æ˜¯å‡å°‘ç‰©ç†è®¡ç®—çš„æ¬¡æ•°ï¼Œæ¥æé«˜æ¸¸æˆæ€§èƒ½ã€‚ å°½é‡å°‘ä½¿ç”¨Update LateUpdate FixedUpdateï¼Œè¿™æ ·ä¹Ÿå¯ä»¥æå‡æ€§èƒ½å’ŒèŠ‚çœç”µé‡ã€‚å¤šä½¿ç”¨äº‹ä»¶ï¼ˆä¸æ˜¯SendMessageï¼Œä½¿ç”¨è‡ªå·±å†™çš„ï¼Œæˆ–è€…C#ä¸­çš„äº‹ä»¶å§”æ‰˜ï¼‰ã€‚ å¾…æœºæ—¶ï¼Œè°ƒæ•´æ¸¸æˆçš„FPSä¸º1ï¼ŒèŠ‚çœç”µé‡ã€‚ å›¾é›†å¤§å°æœ€å¥½ä¸è¦é«˜äº1024ï¼Œå¦åˆ™æ¸¸æˆå®‰è£…ä¹‹åã€ä½ç«¯æœºç›´æ¥å´©æºƒã€åŸå› æ˜¯æ‰‹æœºç³»ç»Ÿç‰ˆæœ¬ä½äº2.2ã€è¶…è¿‡1000çš„å›¾é›†æ— æ³•è¯»å–ã€å¯¼è‡´ã€‚2.2 ä»¥ä¸Šæ²¡æœ‰é‡è§è¿™ä¸ªæƒ…å†µã€‚æ³¨æ„æ‰‹æœºçš„RAM ä¸ ROMã€å°äº 512Mçš„æ‰‹æœºã€ç›´æ¥æ”¾å¼ƒæœºå‹é€‚é…ã€‚ VSCount å‚ç›´åŒæ­¥Unity3Dä¸­æ–°å»ºä¸€ä¸ªç©ºåœºæ™¯çš„æ—¶å€™ï¼Œå¸§é€Ÿç‡ï¼ˆFPSæ€»æ˜¯å¾ˆä½ï¼‰ï¼Œå¤§æ¦‚åœ¨60~70ä¹‹é—´ã€‚åœ¨Unity3Dä¸­å½“è¿è¡Œåœºæ™¯æ‰“å¼€Profilerçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°VSync è¿™ä¸€é¡¹å äº†å¾ˆå¤§çš„æ¯”é‡ã€‚è¿™ä¸ªæ˜¯ä»€ä¹ˆå‘¢ï¼Œè¿™ä¸ªå°±æ˜¯å‚ç›´åŒæ­¥ã€‚æˆ‘ä»¬å¯ä»¥å…³é—­VSyncæ¥æé«˜å¸§é€Ÿç‡ï¼Œé€‰æ‹©edit-&gt;project settings-&gt;Qualityã€‚åœ¨å³ä¾§é¢æ¿ä¸­å¯ä»¥æ‰¾åˆ°VSync Count,æŠŠå®ƒé€‰æˆDonâ€™t Syncã€‚è¿™å°±å…³é—­äº†VSync(å‚ç›´åŒæ­¥)ï¼Œç°åœ¨åœ¨è¿è¡Œåœºæ™¯çœ‹çœ‹ï¼Œå¸§é€Ÿç‡æ˜¯ä¸æ˜¯æé«˜å¾ˆå¤šã€‚ç°åœ¨æ¥è¯´è¯´ä»€ä¹ˆæ˜¯å‚ç›´åŒæ­¥ï¼Œè¦çŸ¥é“ä»€ä¹ˆæ˜¯å‚ç›´åŒæ­¥ï¼Œå¿…é¡»è¦å…ˆæ˜ç™½æ˜¾ç¤ºå™¨çš„å·¥ä½œåŸç†ï¼Œæ˜¾ç¤ºå™¨ä¸Šçš„æ‰€æœ‰å›¾åƒéƒ½æ˜¯ä¸€çº¿ä¸€çº¿çš„æ‰«æä¸Šå»çš„ï¼Œæ— è®ºæ˜¯éš”è¡Œæ‰«æè¿˜æ˜¯é€è¡Œæ‰«æï¼Œæ˜¾ç¤ºå™¨éƒ½æœ‰ä¸¤ç§åŒæ­¥å‚æ•°â€”â€”æ°´å¹³åŒæ­¥å’Œå‚ç›´åŒæ­¥ã€‚ ä»€ä¹ˆå«æ°´å¹³åŒæ­¥ï¼Ÿä»€ä¹ˆå«å‚ç›´åŒæ­¥ï¼Ÿå‚ç›´å’Œæ°´å¹³æ˜¯CRTä¸­ä¸¤ä¸ªåŸºæœ¬çš„åŒæ­¥ä¿¡å·ï¼Œæ°´å¹³åŒæ­¥ä¿¡å·å†³å®šäº†CRTç”»å‡ºä¸€æ¡æ¨ªè¶Šå±å¹•çº¿çš„æ—¶é—´ï¼Œå‚ç›´åŒæ­¥ä¿¡å·å†³å®šäº†CRTä»å±å¹•é¡¶éƒ¨ç”»åˆ°åº•éƒ¨ï¼Œå†è¿”å›åŸå§‹ä½ç½®çš„æ—¶é—´ï¼Œè€Œæ°æ°æ˜¯å‚ç›´åŒæ­¥ä»£è¡¨ç€CRTæ˜¾ç¤ºå™¨çš„åˆ·æ–°ç‡æ°´å¹³ã€‚ ä¸ºä»€ä¹ˆå…³é—­å‚ç›´åŒæ­¥ä¿¡å·ä¼šå½±å“æ¸¸æˆä¸­çš„FPSæ•°å€¼ï¼Ÿå¦‚æœæˆ‘ä»¬é€‰æ‹©ç­‰å¾…å‚ç›´åŒæ­¥ä¿¡å·ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³æ—¶æ‰€è¯´çš„å‚ç›´åŒæ­¥æ‰“å¼€ï¼‰ï¼Œé‚£ä¹ˆåœ¨æ¸¸æˆä¸­æˆ–è®¸å¼ºåŠ²çš„æ˜¾å¡è¿…é€Ÿçš„ç»˜åˆ¶å®Œä¸€å±çš„å›¾åƒï¼Œä½†æ˜¯æ²¡æœ‰å‚ç›´åŒæ­¥ä¿¡å·çš„åˆ°è¾¾ï¼Œæ˜¾å¡æ— æ³•ç»˜åˆ¶ä¸‹ä¸€å±ï¼Œåªæœ‰ç­‰85å•ä½çš„ä¿¡å·åˆ°è¾¾ï¼Œæ‰å¯ä»¥ç»˜åˆ¶ã€‚è¿™æ ·FPSè‡ªç„¶è¦å—åˆ°æ“ä½œç³»ç»Ÿåˆ·æ–°ç‡è¿è¡Œå€¼çš„åˆ¶çº¦ã€‚ è€Œå¦‚æœæˆ‘ä»¬é€‰æ‹©ä¸ç­‰å¾…å‚ç›´åŒæ­¥ä¿¡å·ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³æ—¶æ‰€è¯´çš„å…³é—­å‚ç›´åŒæ­¥ï¼‰ï¼Œé‚£ä¹ˆæ¸¸æˆä¸­ä½œå®Œä¸€å±ç”»é¢ï¼Œæ˜¾å¡å’Œæ˜¾ç¤ºå™¨æ— éœ€ç­‰å¾…å‚ç›´åŒæ­¥ä¿¡å·å°±å¯ä»¥å¼€å§‹ä¸‹ä¸€å±å›¾åƒçš„ç»˜åˆ¶ï¼Œè‡ªç„¶å¯ä»¥å®Œå…¨å‘æŒ¥æ˜¾å¡çš„å®åŠ›ã€‚ä½†æ˜¯ä¸è¦å¿˜è®°ï¼Œæ­£æ˜¯å› ä¸ºå‚ç›´åŒæ­¥çš„å­˜åœ¨ï¼Œæ‰èƒ½ä½¿å¾—æ¸¸æˆè¿›ç¨‹å’Œæ˜¾ç¤ºå™¨åˆ·æ–°ç‡åŒæ­¥ï¼Œä½¿å¾—ç”»é¢æ›´åŠ å¹³æ»‘å’Œç¨³å®šã€‚å–æ¶ˆäº†å‚ç›´åŒæ­¥ä¿¡å·ï¼Œå›ºç„¶å¯ä»¥æ¢æ¥æ›´å¿«çš„é€Ÿåº¦ï¼Œä½†æ˜¯åœ¨å›¾åƒçš„è¿ç»­æ€§ä¸ŠåŠ¿å¿…æ‰“æŠ˜æ‰£ã€‚è¿™ä¹Ÿæ­£æ˜¯å¾ˆå¤šæœ‹å‹æŠ±æ€¨å…³é—­å‚ç›´åå‘ç°ç”»é¢ä¸è¿ç»­çš„ç†è®ºåŸå› ã€‚ åˆå¹¶æè´¨çƒUnity3Dä¸­æ¯å¯¼å…¥ä¸€æ¬¡æ¨¡å‹å°±å¤šä¸€ä¸ªæè´¨çƒï¼Œå¯æˆ‘çš„è¿™äº›æ¨¡å‹éƒ½æ˜¯å…±ç”¨ä¸€å¼ è´´å›¾çš„å°±æƒ³å…±ç”¨ä¸€ä¸ªæè´¨çƒï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½è¦åˆ é™¤å†é™„ä¸Šï¼Œå¾ˆéº»çƒ¦ã€‚æ€ä¹ˆæ‰èƒ½åˆå¹¶è¿™äº›æè´¨çƒï¼Ÿé‡‡ç”¨TexturePackingå§ éå†gameobjectï¼Œå–å‡ºmaterialï¼Œå¹¶æ ¹æ®shaderæ¥å°†materialåˆ†ç±»ï¼› è°ƒç”¨Unityè‡ªå¸¦çš„PackTextureså‡½æ•°æ¥åˆå¹¶æ¯ä¸ªshaderåˆ†ç±»ä¸­çš„materialæ‰€å¯¹åº”çš„texturesï¼ˆPackTextureså‡½æ•°æœ‰ç¼ºé™·ï¼Œä¸è¿‡å¯ä»¥å°†å°±ç”¨ï¼‰ï¼› æ ¹æ®åˆå¹¶çš„å¤§çš„textureæ¥æ›´æ–°åŸæœ‰æ¨¡å‹çš„textureã€materialå·²ç»uvåæ ‡å€¼ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼šéœ€è¦åˆå¹¶çš„çº¹ç†åº”è¯¥æ˜¯ç‰©ä½“åœ¨åœºæ™¯ä¸­è·ç¦»ç›¸è¿‘çš„ï¼Œå¦‚æœç‰©ä½“åœ¨åœºæ™¯ä¸­çš„è·ç¦»è¾ƒè¿œï¼Œåˆ™ä¸å»ºè®®åˆå¹¶çº¹ç†ï¼Œå› ä¸ºè¿™æ ·åšå¾ˆæœ‰å¯èƒ½éä½†èµ·ä¸åˆ°ä¼˜åŒ–çš„ä½œç”¨ï¼Œåè€Œé™ä½äº†è¿è¡Œæ•ˆç‡ã€‚ meshåˆå¹¶åˆ†ä¸º2ç§æ–¹å¼åˆå¹¶ è‡ªå¸¦çš„åˆå¹¶å¿…é¡»å‹¾é€‰é™æ€ã€‚ æ‰€æœ‰è¢«å‹¾é€‰äº†â€œStaticâ€çš„GameObjectï¼Œå…¶ä¸­çš„Mesh Filterä¸­çš„meshéƒ½ä¼šè¢«åˆå¹¶åˆ° â€œCombined Mesha (root: scene)â€ ä¸­ ä¹Ÿå¯ä»¥ç”¨è„šæœ¬æ¥åˆå¹¶mesh ã€‚ 12345678910111213141516171819202122using UnityEngine;using System.Collections; public class MyClass : MonoBehaviour&#123; void Start () &#123; MeshFilter [] meshFilters = GetComponentsInChildren&lt;MeshFilter&gt; (); CombineInstance[] combine = new CombineInstance[meshFilters.Length]; for(int i = 0; i &lt; meshFilters.Length; i++) &#123; combine[i].mesh = meshFilters[i].sharedMesh; combine[i].transform = meshFilters[i].transform.localToWorldMatrix; meshFilters[i].gameObject.active = false; &#125; transform.GetComponent&lt;MeshFilter&gt;().mesh = new Mesh (); transform.GetComponent&lt;MeshFilter&gt;().mesh.CombineMeshes (combine); transform.gameObject.active = true; &#125;&#125; å…ˆåœ¨ Unity ä¸­å»ºç«‹ç©ºç‰©ä»¶ ( Empty ) å†åˆ›å»º2ä¸ª Cube æ–¹å—ï¼Œå¹¶æ”¾å…¥ç©ºç‰©ä»¶åº•ä¸‹ (å¯ä»¥æ”¹æˆä½ è‡ªå·±çš„æ¨¡å‹) æŠŠ MyClass ä»£ç ä¸Ÿè¿›ç©ºç‰©ä»¶ä¸Š ã€‚ (å¯é€‰) å»ºç«‹ä¸€ä¸ª Material æè´¨ï¼Œå¹¶ä¸”ä¸¢è¿›ç©ºç‰©ä»¶ä¸Š æ‰§è¡Œ è§’è‰²Materialæ•°é‡2-3ä¸ªï¼Œéª¨éª¼æ•°é‡å°äº30ä¸ªï¼Œé¢ç‰‡æ•°é‡300-1500ï¼Œä¸€èˆ¬è§’è‰²åº”è¯¥æ²¡æœ‰IKç»“ç‚¹è¿™æ˜¯å› ä¸ºè§’è‰²çš„åŠ¨ä½œå¤§å¤šæ•°éƒ½æ˜¯äº‹å…ˆè®¾å®šå¥½çš„ï¼Œå¹¶ä¸éœ€è¦ç»è¿‡IKæ“ä½œæ¥è¿›è¡Œå®æ—¶è®¡ç®—ï¼ˆRogdollé™¤å¤–ï¼‰ï¼Œæ‰€ä»¥åœ¨æ¨¡å‹å¯¼å…¥æ—¶ï¼Œä¸è¦å°†IKç»“ç‚¹ä¸€èµ·å¯¼å…¥ã€‚ é™æ€å®ä½“ä¸è¦é™„åŠ Animation Componentåœ¨é™æ€å®ä½“ä¸Šé™„åŠ Animationéƒ¨ä»¶è™½ç„¶å¯¹ç»“æœæ²¡æœ‰å½±å“ï¼Œä½†å´ä¼šå¢åŠ ä¸€å®šçš„CPUå¼€é”€æ¥è°ƒç”¨è¿™ä¸€ç»„ä»¶ï¼Œæ‰€ä»¥å°½é‡å»æ‰è¯¥ç»„ä»¶ã€‚ç½‘æ ¼é¡¶ç‚¹æ•°å°äº500ï¼›UVå€¼èŒƒå›´å°½é‡ä¸è¦è¶…è¿‡ï¼ˆ0, 1ï¼‰åŒºé—´ï¼›å°½é‡ä¿è¯UVå€¼ä¸è¶Šç•Œï¼Œè¿™å¯¹äºå°†æ¥çš„çº¹ç†æ‹¼åˆä¼˜åŒ–å¾ˆæœ‰å¸®åŠ©ã€‚ åœ°å½¢åœ°å½¢çš„åˆ†è¾¨ç‡å¤§å°é•¿å®½å‡å°½é‡å°äº257ã€‚è¿™æ˜¯å› ä¸ºåœ°å½¢å¤ªå¤§ï¼Œä¼šé€ æˆå¤§é‡é¡¶ç‚¹æ•°æ®ï¼Œç»™ä½ çš„å†…å­˜å¸¦å®½é€ æˆä¸€å®šçš„å½±å“ï¼Œåœ¨ç›®å‰çš„iosè®¾å¤‡ä¸­ï¼Œå†…å­˜å¸¦å®½æ˜¯éå¸¸æœ‰é™çš„ï¼Œéœ€è¦å°½é‡èŠ‚çœã€‚åŒæ—¶ï¼Œå¦‚æœç”¨Unityè‡ªå¸¦çš„åœ°å½¢ï¼Œä¸€å®šä¹Ÿè¦ä½¿ç”¨Occlusion Cullingï¼Œå› ä¸ºUnityçš„åˆ·åœ°å½¢å·¥å…·è™½ç„¶æ–¹ä¾¿ï¼Œä½†å´æ˜¯framekillerï¼Œåˆ·è¿‡ä¹‹åï¼Œä½ ä¼šå‘ç°drawcallå¢åŠ çš„éå¸¸å¤šã€‚æ··åˆçº¹ç†æ•°é‡ä¸è¦è¶…è¿‡4ã€‚åœ°å½¢çš„æ··åˆæ“ä½œæ˜¯å¾ˆè€—æ—¶çš„ï¼Œåº”è¯¥å°½é‡é¿å…ã€‚èƒ½åˆå¹¶çš„çº¹ç†å°½é‡åˆå¹¶ã€‚ çº¹ç† çº¹ç†æ ¼å¼å»ºè®®pngæˆ–tgaã€‚ä¸ç”¨è½¬æˆiosç¡¬ä»¶æ”¯æŒçš„PVRTCæ ¼å¼ï¼Œå› ä¸ºUnityåœ¨å‘å¸ƒæ—¶ä¼šå¸®ä½ è‡ªåŠ¨è½¬çš„ã€‚ çº¹ç†å°ºå¯¸é•¿å®½å°äº1024ã€‚åŒæ—¶åº”è¯¥å°½å¯èƒ½åœ°å°ï¼Œå¤Ÿç”¨å°±å¥½ï¼Œä»¥ä¿è¯çº¹ç†å¯¹å†…å­˜å¸¦å®½çš„å½±å“è¾¾åˆ°æœ€å°ã€‚ æ”¯æŒMipmapï¼ˆUIä¸éœ€è¦è½¬ï¼Œä¸ç„¶ä¼šå¢å¤§å†…å­˜ï¼‰å»ºè®®ç”ŸæˆMipmapã€‚è™½ç„¶è¿™ç§åšæ³•ä¼šå¢åŠ ä¸€äº›åº”ç”¨ç¨‹åºçš„å¤§å°ï¼Œä½†åœ¨æ¸¸æˆè¿è¡Œæ—¶ï¼Œç³»ç»Ÿä¼šæ ¹æ®éœ€æ±‚åº”ç”¨Mipmapæ¥æ¸²æŸ“ï¼Œä»è€Œå‡å°‘å†…å­˜å¸¦å®½ã€‚ æ£€æŸ¥Alphaå€¼å¦‚æœçº¹ç†çš„alphaé€šé“å‡ä¸º1ï¼Œåˆ™ç”¨RGBçš„24ä½çº¹ç†æ¥ä»£æ›¿RGBAçš„32ä½çº¹ç†ã€‚ï¼ˆæ®è¯´Unityå†…éƒ¨ä¼šè¿›è¡Œè‡ªåŠ¨æ£€æµ‹ï¼‰ å…‰æºå…‰æºâ€œImportantâ€ä¸ªæ•°å»ºè®®1ä¸ªï¼Œä¸€èˆ¬ä¸ºæ–¹å‘å…‰ã€‚â€œImportantâ€ä¸ªæ•°åº”è¯¥è¶Šå°è¶Šå°‘ã€‚ä¸ªæ•°è¶Šå¤šï¼Œdrawcallè¶Šå¤šã€‚Pixel Lightæ•°ç›®1-2ä¸ªã€‚ ç²’å­ç‰¹æ•ˆå±å¹•ä¸Šçš„æœ€å¤§ç²’å­æ•°å»ºè®®å°äº200ä¸ªç²’å­ã€‚æ¯ä¸ªç²’å­å‘å°„å™¨å‘å°„çš„æœ€å¤§ç²’å­æ•°å»ºè®®ä¸è¶…è¿‡50ä¸ªã€‚ç²’å­å¤§å°å¦‚æœå¯ä»¥çš„è¯ï¼Œç²’å­çš„sizeåº”è¯¥å°½å¯èƒ½åœ°å°ã€‚å› ä¸ºUnityçš„ç²’å­ç³»ç»Ÿçš„shaderæ— è®ºæ˜¯alpha testè¿˜æ˜¯alpha blendingéƒ½æ˜¯ä¸€ç¬”ä¸å°çš„å¼€é”€ã€‚åŒæ—¶ï¼Œå¯¹äºéå¸¸å°çš„ç²’å­ï¼Œå»ºè®®ç²’å­çº¹ç†å»æ‰alphaé€šé“ã€‚å°½é‡ä¸è¦å¼€å¯ç²’å­çš„ç¢°æ’åŠŸèƒ½ã€‚éå¸¸è€—æ—¶ã€‚ éŸ³é¢‘æ¸¸æˆä¸­æ’­æ”¾æ—¶é—´è¾ƒé•¿çš„éŸ³ä¹ï¼ˆå¦‚èƒŒæ™¯éŸ³ä¹ï¼‰ä½¿ç”¨.oggæˆ–.mp3çš„å‹ç¼©æ ¼å¼ã€‚è¾ƒçŸ­éŸ³ä¹ï¼ˆå¦‚æªå£°ï¼‰ä½¿ç”¨.wavå’Œ.aifçš„æœªå‹ç¼©éŸ³é¢‘æ ¼å¼ã€‚ ç›¸æœºè£å‰ªå¹³é¢å°†è¿œå¹³é¢è®¾ç½®æˆåˆé€‚çš„è·ç¦»ã€‚è¿œå¹³é¢è¿‡å¤§ä¼šå°†ä¸€äº›ä¸å¿…è¦çš„ç‰©ä½“åŠ å…¥æ¸²æŸ“ï¼Œé™ä½æ•ˆç‡ã€‚æ ¹æ®ä¸åŒçš„ç‰©ä½“è®¾ç½®ä¸åŒçš„è¿œè£å‰ªå¹³é¢Unityæä¾›äº†å¯ä»¥æ ¹æ®ä¸åŒçš„layeræ¥è®¾ç½®ä¸åŒçš„view distanceï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å®ç°å°†ç‰©ä½“è¿›è¡Œåˆ†å±‚ï¼Œå¤§ç‰©ä½“å±‚è®¾ç½®çš„å¯è§†è·ç¦»å¤§äº›ï¼Œè€Œå°ç‰©ä½“å±‚å¯ä»¥è®¾ç½®åœ°å°äº›ï¼Œå¦å¤–ï¼Œä¸€äº›å¼€é”€æ¯”è¾ƒå¤§çš„å®ä½“ï¼ˆå¦‚ç²’å­ç³»ç»Ÿï¼‰å¯ä»¥è®¾ç½®å¾—æ›´å°äº›ç­‰ç­‰ã€‚ ç¢°æ’å°½é‡ä¸ç”¨MeshColliderå¦‚æœå¯ä»¥çš„è¯ï¼Œå°½é‡ä¸ç”¨MeshColliderï¼Œä»¥èŠ‚çœä¸å¿…è¦çš„å¼€é”€ã€‚å¦‚æœä¸èƒ½é¿å…çš„è¯ï¼Œå°½é‡ç”¨å‡å°‘Meshçš„é¢ç‰‡æ•°ï¼Œæˆ–ç”¨è¾ƒå°‘é¢ç‰‡çš„ä»£ç†ä½“æ¥ä»£æ›¿ã€‚ å…¶ä»–Drawcallå°½å¯èƒ½åœ°å‡å°‘Drawcallçš„æ•°é‡ã€‚IOSè®¾å¤‡ä¸Šå»ºè®®ä¸è¶…è¿‡100ã€‚å‡å°‘çš„æ–¹æ³•ä¸»è¦æœ‰å¦‚ä¸‹å‡ ç§ï¼šFrustum Cullingï¼ŒOcclusion Cullingï¼ŒTexture Packingã€‚Frustum Cullingæ˜¯Unityå†…å»ºçš„ï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯å¯»æ±‚ä¸€ä¸ªåˆé€‚çš„è¿œè£å‰ªå¹³é¢ï¼›Occlusion Cullingï¼Œé®æŒ¡å‰”é™¤ï¼ŒUnityå†…åµŒäº†Umbraï¼Œä¸€ä¸ªéå¸¸å¥½OCåº“ã€‚ä½†Occlusion Cullingä¹Ÿå¹¶ä¸æ˜¯æ”¾ä¹‹å››æµ·è€Œçš†å‡†çš„ï¼Œæœ‰æ—¶å€™è¿›è¡ŒOCåè€Œæ¯”ä¸è¿›è¡Œè¿˜è¦æ…¢ï¼Œå»ºè®®åœ¨OCä¹‹å‰å…ˆç¡®å®šè‡ªå·±çš„åœºæ™¯æ˜¯å¦é€‚åˆåˆ©ç”¨OCæ¥ä¼˜åŒ–ï¼›Texture Packingï¼Œæˆ–è€…å«Texture Atlasingï¼Œæ˜¯å°†åŒç§shaderçš„çº¹ç†è¿›è¡Œæ‹¼åˆï¼Œæ ¹æ®Unityçš„static batchingçš„ç‰¹æ€§æ¥å‡å°‘draw callã€‚å»ºè®®ä½¿ç”¨ï¼Œä½†ä¹Ÿæœ‰å¼Šç«¯ï¼Œé‚£å°±æ˜¯ä¸€å®šè¦å°†åœºæ™¯ä¸­è·ç¦»ç›¸è¿‘çš„å®ä½“çº¹ç†è¿›è¡Œæ‹¼åˆï¼Œå¦åˆ™ï¼Œæ‹¼åˆåå¾ˆå¯èƒ½ä¼šå¢åŠ æ¯å¸§æ¸²æŸ“æ‰€éœ€çš„çº¹ç†å¤§å°ï¼ŒåŠ å¤§å†…å­˜å¸¦å®½çš„è´Ÿæ‹…ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆä¼šå‡ºç°â€œDrawCallé™äº†ï¼Œæ¸²æŸ“é€Ÿåº¦ä¹Ÿå˜æ…¢äº†â€çš„åŸå› ã€‚ éè¿åŠ¨ç‰©ä½“å°½é‡æ‰“ä¸ŠStaticæ ‡ç­¾Unityåœ¨è¿è¡Œæ—¶ä¼šå¯¹staticç‰©ä½“è¿›è¡Œè‡ªåŠ¨ä¼˜åŒ–å¤„ç†ï¼Œæ‰€ä»¥åº”è¯¥å°½å¯èƒ½å°†éè¿è¡Œå®ä½“å‹¾ä¸Šstaticæ ‡ç­¾ã€‚ åœºæ™¯ä¸­å°½å¯èƒ½åœ°ä½¿ç”¨prefabå°½å¯èƒ½åœ°ä½¿ç”¨prefabçš„å®ä¾‹åŒ–ç‰©ä½“ï¼Œä»¥é™ä½å†…å­˜å¸¦å®½çš„è´Ÿæ‹…ã€‚æ£€æŸ¥å®ä½“çš„PrefabTypeï¼Œå°½é‡å°†å…¶å˜æˆPrefabInstanceï¼Œè€Œä¸æ˜¯ModelPrefabInstanceã€‚ ç§»åŠ¨å¹³å°ç›¸å¯¹äºPCæœºï¼Œå…·æœ‰ä½“ç§¯å°ï¼Œè®¡ç®—å¼±ï¼Œå¸¦å®½å°‘çš„ç‰¹ç‚¹ã€‚ å› æ­¤åšæ‰‹æœºæ¸¸æˆçš„å¼€å‘ï¼Œä¼˜åŒ–çš„æ–¹å‘ï¼Œä¸åŠ›åº¦å¯¹æ¯”PCæ¸¸æˆéƒ½æœ‰æ‰€åŒºåˆ«ã€‚ å¿…é¡»è¦åšåˆ°ä¼˜åŒ–æµç¨‹ï¼Œåˆç†åˆ©ç”¨èµ„æºã€‚ç›®å‰åœ¨æ‰‹æœºä¸Šé¢ï¼Œè¿˜ä¸èƒ½å¤ŸåƒPCæ¸¸æˆé‚£æ ·è¿½æ±‚é«˜è´¨é‡æ¸²æŸ“æ•ˆæœï¼Œä¸ºäº†è®©æ‰‹æœºä¸é‚£ä¹ˆå®¹æ˜“å‘çƒ«ï¼Œè¿˜è¦æ§åˆ¶cpuï¼Œgpuï¼Œä¸èƒ½è®©ä»–ä»¬å…¨é€Ÿè¿ç®—ã€‚ æè´¨æ–¹é¢ï¼šçº¹ç†æ–¹é¢ï¼Œå»ºè®®ä½¿ç”¨å‹ç¼©çº¹ç†ï¼Œ Androidä¸Šé¢ä½¿ç”¨ETC1ï¼Œè‹¹æœä¸Šé¢ä½¿ç”¨PVRTCã€‚UVåæ ‡æ§åˆ¶åœ¨0åˆ°1ä¹‹é—´ï¼Œäººç‰©æ¨¡å‹é¢æ•°æ§åˆ¶åœ¨1500å†…ï¼Œéª¨éª¼æ§åˆ¶åœ¨30ä¸ªä»¥å†…ã€‚åœºæ™¯ä¸­ä½¿ç”¨ä¸€ä¸ªä¸»å…‰ï¼ˆä¸èƒ½å†å¤šäº†ï¼‰ã€‚å°½é‡å‡å°‘alphaTestå’ŒalphaBlendæè´¨çš„ä½¿ç”¨ã€‚åœ¨æ‰‹æœºä¸Šï¼Œè¿™æ˜¯å¾ˆæ€æ•ˆç‡çš„ã€‚éª¨éª¼åŠ¨ç”»æ–¹é¢ï¼šåœ¨åŠ¨ç”»æ–¹é¢å¯ä»¥è€ƒè™‘ä¸ä½¿ç”¨æ’å€¼ï¼Œå›ºå®šçš„å¸§ç‡çš„åŠ¨ç”»ã€‚ å¦‚æœè¦åšæ’å€¼ï¼Œè€ƒè™‘ä½¿ç”¨å››å…ƒæ•°ï¼ˆè¡¨ç¤ºæ—‹è½¬ï¼‰å’Œå‘é‡ï¼ˆè¡¨ç¤ºä½ç§»ï¼‰æ¥åšæ’å€¼ã€‚ å››å…ƒæ•°åšæ’å€¼é€Ÿåº¦æ¯”çŸ©é˜µæ¥çš„å¿«ï¼ŒSlerpæä¾›äº†å¹³æ»‘æ’å€¼ã€‚ ä¼˜åŒ–çš„å¸¸è§„æŠ€å·§å‰–æä½ çš„æ¸¸æˆã€‚ä¸è¦èŠ±è´¹æ—¶é—´æ¥ä¼˜åŒ–é‚£äº›æ™¦æ¶©çš„ä»£ç æˆ–è€…ç¼©å‡å›¾å½¢æ–‡ä»¶çš„å¤§å°ï¼Œé™¤éè¿™æ˜¯ä½ æ¸¸æˆçš„ç“¶é¢ˆã€‚ç¬¬ä¸€æ¬¡å‰–æä½ çš„æ¸¸æˆå°†ä¼šä½¿ä½ å‘ç°ä½ æ¸¸æˆçš„ç“¶é¢ˆã€‚Appleâ€™s Sharkæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç”¨æ¥å‰–æåŸºäºOpenGLçš„ç¨‹åºçš„å·¥å…·ã€‚å†æ¬¡å‰–æä½ çš„æ¸¸æˆã€‚ä¼˜åŒ–ä¹‹åä¸è¦å¿˜è®°å†å‰–æä¸€æ¬¡ä½ çš„æ¸¸æˆï¼Œè¿™æ ·å¯ä»¥æ£€æŸ¥ä½ æ‰€åšçš„ä¼˜åŒ–æ˜¯å¦è¾¾åˆ°äº†é¢„æœŸçš„æ•ˆæœã€‚å½“ç„¶ï¼Œè¿™æ ·åšä¹Ÿå¯èƒ½ä¼šä½¿ä½ å‘ç°æ›´å¤šçš„ç“¶é¢ˆã€‚æµç¨‹ç¬¬ä¸€ã€æ€§èƒ½ç¬¬äºŒã€‚èŠ±è´¹æ—¶é—´æ¥ä½¿ä½ æ¸¸æˆçš„åˆ›å»ºå°½å¯èƒ½åœ°æµç•…ã€‚å°½å¯èƒ½å¿«åœ°ä¿®æ­£æ¸¸æˆä¸­çš„é”™è¯¯å°†ä¼šä½¿ä½ åæœŸæ›´å®¹æ˜“ä¼˜åŒ–ä½ çš„æ¸¸æˆã€‚åœ¨Scene Viewä¸­æµ‹è¯•åœºæ™¯ã€‚è¿™æ ·åšå°†ä¼šä½¿ä½ æ¸…æ¥šäº†è§£è¿™ä¸ªåœºæ™¯ä¸­çš„ç‰©ä½“æˆ–è€…é™„åŠ åœ¨ç‰©ä½“ä¸Šçš„è„šæœ¬æ˜¯å¦é™ä½äº†æ¸¸æˆæ€§èƒ½ã€‚å¦‚æœScene Viewååº”è¿Ÿé’ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½æ˜¯å›¾å½¢æ–¹é¢çš„åŸå› ï¼Œå¦‚æœScene Viewååº”ä¸è¿Ÿé’ï¼Œé‚£ä¹ˆç“¶é¢ˆå¯èƒ½å‡ºåœ¨è„šæœ¬æˆ–è€…ç‰©ç†ç³»ç»Ÿä¸Šã€‚ç¦ç”¨æŒ‡å®šæ¸¸æˆç‰©ä½“ã€‚åœ¨playæ¨¡å¼ä¸‹ï¼Œå°è¯•ç¦ç”¨å¹¶å¯ç”¨æ¸¸æˆç‰©ä½“æ¥æ’æŸ¥å‡ºæ¸¸æˆæ…¢çš„åŸå› ã€‚ ç½‘æ ¼å¦‚æœå¯èƒ½çš„è¯ï¼ŒæŠŠç›¸é‚»çš„ç‰©ä½“ï¼ˆç½‘æ ¼ï¼‰åˆå¹¶ä¸ºä¸€ä¸ªåªæœ‰ä¸€ä¸ªæè´¨çš„ç‰©ä½“ï¼ˆç½‘æ ¼ï¼‰ã€‚æ¯”å¦‚ï¼Œä½ çš„æ¸¸æˆä¸­åŒ…å«ä¸€ä¸ªæ¡Œå­ï¼Œä¸Šé¢æœ‰ä¸€å †ä¸œè¥¿ï¼Œä½ å®Œå…¨å¯ä»¥åœ¨3Dç¨‹åºä¸­å°†å®ƒä»¬åˆå¹¶åœ¨ä¸€èµ·ï¼ˆè¿™å¯èƒ½ä¹Ÿéœ€è¦ä½ å°†è¿™äº›ç‰©ä½“çš„çº¹ç†åˆå¹¶ä¸ºä¸€ä¸ªå¤§çš„çº¹ç†é›†ï¼‰ã€‚å‡å°‘éœ€è¦æ¸²æŸ“çš„ç‰©ä½“çš„æ•°é‡å¯ä»¥æå¤§åœ°æé«˜æ¸¸æˆæ€§èƒ½ã€‚ ä¸è¦æœ‰ä¸å¿…è¦çš„ç½‘æ ¼ã€‚å¦‚æœä½ çš„æ¸¸æˆåœºæ™¯ä¸­æœ‰ä¸€ä¸ªäººç‰©ï¼Œé‚£ä¹ˆä»–åº”è¯¥æ˜¯ä¸€ä¸ªç½‘æ ¼ã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªèˆ¹ï¼Œé‚£ä¹ˆå®ƒä¹Ÿåº”è¯¥åªæ˜¯ä¸€ä¸ªç½‘æ ¼ã€‚æ¯ä¸€ä¸ªç½‘æ ¼åªç”¨ä¸€ç§æè´¨ã€‚ä½¿ç”¨æå°‘çš„é¢æ•°çš„ç½‘æ ¼ï¼ˆæ¯”å¦‚500ä¸ªå¤šè¾¹å½¢ä»¥ä¸‹ï¼‰ã€‚æœ€å¥½æŠŠä½ äººç‰©çš„ä¸‰è§’é¢æ•°é‡æ§åˆ¶åœ¨1500-2000ä¸ªä¹‹é—´ã€‚è¿™ä¸ªæ•°é‡å¯ä»¥è¯´æ˜¯æ¸¸æˆè´¨é‡å’Œæ€§èƒ½ä¹‹é—´ä¸€ä¸ªå‡è¡¡å€¼ã€‚å¦‚æœä½ çš„æ¨¡å‹æœ‰å››è¾¹å½¢ï¼Œé‚£ä¹ˆåœ¨å¯¼å…¥æ¨¡å‹çš„æ—¶å€™ï¼Œå¼•æ“å°†ä¼šæŠŠæ¯ä¸ªå››è¾¹å½¢å˜ä¸ºä¸¤ä¸ªä¸‰è§’å½¢ã€‚ å…‰ç…§åƒç´ å…‰ã€‚åƒç´ å…‰å¯ä»¥è®©ä½ çš„æ¸¸æˆçœ‹èµ·æ¥æ•ˆæœå¾ˆç‰›é€¼ï¼Œä½†æ˜¯ä¸è¦ä½¿ç”¨è¿‡å¤šçš„åƒç´ å…‰ã€‚åœ¨ä½ çš„æ¸¸æˆä¸­å¯ä»¥ä½¿ç”¨è´¨é‡ç®¡ç†å™¨æ¥è°ƒèŠ‚åƒç´ å…‰çš„æ•°é‡æ¥å–å¾—ä¸€ä¸ªæ€§èƒ½å’Œè´¨é‡çš„å‡è¡¡ç‚¹. æ€§èƒ½å ç”¨é¡ºåºï¼šèšå…‰ç¯&gt;ç‚¹å…‰æº&gt;å¹³è¡Œå…‰ã€‚ä¸€ä¸ªå¥½çš„ç‚¹äº®åœºæ™¯çš„æ–¹æ³•å°±æ˜¯å…ˆå¾—åˆ°ä½ æƒ³è¦çš„æ•ˆæœï¼Œç„¶åçœ‹çœ‹å“ªäº›å…‰æ›´é‡è¦ï¼›åœ¨ä¿æŒå…‰æ•ˆçš„å‰æä¸‹çœ‹çœ‹å“ªäº›å…‰å¯ä»¥å»æ‰ã€‚ ç‚¹å…‰æºå’Œèšå…‰ç¯åªå½±å“å®ƒä»¬èŒƒå›´å†…çš„ç½‘æ ¼ã€‚å¦‚æœä¸€ä¸ªç½‘æ ¼å¤„äºç‚¹å…‰æºæˆ–è€…èšå…‰ç¯çš„ç…§å°„èŒƒå›´ä¹‹å¤–ï¼Œå¹¶ä¸”å…‰æºçš„attenuateå¼€å…³æ˜¯æ‰“å¼€çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªç½‘æ ¼å°†ä¸ä¼šè¢«å…‰æºæ‰€å½±å“ï¼Œè¿™æ ·å°±å¯ä»¥èŠ‚çœæ€§èƒ½å¼€é”€ã€‚è¿™æ ·åšç†è®ºä¸Šæ¥è®²å¯ä»¥ä½¿ç”¨å¾ˆå¤šå°çš„ç‚¹å…‰æºè€Œä¸”ä¾ç„¶èƒ½æœ‰ä¸€ä¸ªå¥½çš„æ€§èƒ½ï¼Œå› ä¸ºè¿™äº›å…‰æºåªå½±å“ä¸€å°éƒ¨åˆ†ç‰©ä½“ã€‚ä¸€ä¸ªç½‘æ ¼åœ¨æœ‰8ä¸ªä»¥ä¸Šå…‰æºå½±å“çš„æ—¶å€™ï¼Œåªå“åº”å‰8ä¸ªæœ€äº®çš„å…‰æºã€‚ è´´å›¾åœ¨å¤–è§‚ä¸å˜çš„å‰æä¸‹ï¼Œè´´å›¾å¤§å°è¶Šå°è¶Šå¥½ã€‚å¦‚æœä½ çš„æ˜¾å¡çš„æ˜¾å­˜ä¸å¤Ÿå¤§çš„è¯ï¼Œä½ æ¸¸æˆä¸­çš„è´´å›¾å°†ä¼šè¢«è½¬å­˜åˆ°ç³»ç»Ÿå†…å­˜ä¸­ï¼Œåœ¨æ˜¾å¡è°ƒç”¨å®ƒä»¬çš„æ—¶å€™å†ä¼ åˆ°æ˜¾å¡ä¸­ã€‚å¯¹äºæ¯”è¾ƒæ–°çš„ç”µè„‘æ¥è¯´ï¼Œå†…å­˜å’Œæ˜¾å¡ä¹‹é—´æœ‰è¶³å¤Ÿçš„å¸¦å®½æ¥è¾¾åˆ°ä¸€ä¸ªå¾ˆå¥½çš„æ€§èƒ½ï¼›å¦‚æœä½ å¾ˆæ— è€»åœ°ç”¨äº†å·¨å¤šçš„å¤§å›¾ç‰‡çš„è¯ï¼Œåœ¨ä½æ˜¾å­˜çš„ç”µè„‘ä¸Šè¿è¡Œä½ çš„æ¸¸æˆçš„æ—¶å€™ï¼Œä½ çš„æ¸¸æˆå¿…ç„¶ä¼šæŒ‚æ‰ã€‚å€’æ˜¯æ²¡æœ‰å¿…è¦åœ¨å›¾å½¢ç¼–è¾‘è½¯ä»¶ä¸­è°ƒæ•´è´´å›¾çš„å¤§å°ã€‚ä½ å¯ä»¥åœ¨unityå¯¼å…¥è´´å›¾çš„æ—¶å€™è¿›è¡Œè°ƒæ•´ã€‚ ä¸è¦ä½¿ç”¨ä½è´¨é‡çš„å›¾ç‰‡ã€‚åœ¨å°æ’­æ”¾ç•Œé¢çš„æ¸¸æˆä¸­ä½¿ç”¨ä½è´¨é‡çš„jpegå›¾ç‰‡æˆ–è€…ä½è‰²å½©çš„pngå›¾ç‰‡äº¦æˆ–æ˜¯gifå›¾ç‰‡æ²¡ä»€ä¹ˆé—®é¢˜ã€‚åœ¨å‘å¸ƒæ¸¸æˆçš„æ—¶å€™ï¼Œå¼•æ“ä¼šè‡ªåŠ¨å‹ç¼©è¿™äº›å›¾ç‰‡ï¼Œå¤šé‡å‹ç¼©å’Œè§£å‹å°†ä¼šé™ä½å›¾ç‰‡çš„è´¨é‡ï¼Œæ‰€ä»¥æœ€å¥½ä¿æŒè´´å›¾æ–‡ä»¶çš„åˆ†è¾¨ç‡ä¸ºåŸå§‹åˆ†è¾¨ç‡ã€‚è¿™æ ·å°±ä¼šå‡å°‘å¤šé‡å‹ç¼©å’Œè§£å‹æ‰€å¯¼è‡´çš„å›¾ç‰‡å¤±çœŸç°è±¡ã€‚ Shaderså¤šé‡æ•ˆæœçš„shaderå°±æ¯”çœ‹èµ·æ¥æ ·å¼å¾ˆå•ä¸€çš„shaderè¦æ›´è€—è´¹èµ„æºã€‚åŒæ ·åœ¨ä¸€ä¸ªæ‹¥æœ‰è´´å›¾å’Œå…‰åå°„çš„ç‰©ä½“ä¸Šï¼Œä½¿ç”¨VertexLit Diffuse shaderæ— ç–‘æ˜¯æœ€çœèµ„æºçš„ã€‚ åœ¨ç¾æœ¯åˆ¶ä½œåœºæ™¯çš„è¿‡ç¨‹ä¸­ï¼Œä¼šä½¿ç”¨åˆ°å¤§é‡çš„ç²’å­ç³»ç»Ÿã€‚æ¯”å¦‚åœºæ™¯ä¸­çš„ç«æŠŠã€‚åœ¨æˆ‘ä»¬çš„ä¸€ä¸ªåœ°ä¸‹åŸåœºæ™¯ä¸­ï¼Œç¾æœ¯ä»¬æ”¾ç½®äº†å¤§é‡çš„ç«æŠŠã€‚æ•´ä¸ªåœºæ™¯ä¸­çš„å„ä¸ªåœ°æ–¹ï¼Œæœ‰100æ¥ä¸ªç«æŠŠã€‚ unityä¸­ï¼Œåœ¨æ‘„åƒæœºèŒƒå›´å¤–çš„ç²’å­ç³»ç»Ÿè™½ç„¶ä¸ä¼šè¢«ç»˜åˆ¶ã€‚ä½†æ˜¯updateæ˜¯ä¸€ç›´æŒç»­çš„ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œè¿™100å¤šä¸ªç«æŠŠï¼Œä¸è®ºæ˜¯å¦å¯è§éƒ½åœ¨æ›´æ–°ã€‚ è¿™ä¸ªè®¾è®¡åº”è¯¥æ˜¯å¾ˆä¸åˆç†çš„ï¼Œåœ¨æˆ‘çœ‹è¿‡çš„å…¶ä»–å¼•æ“ä¸­ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªå¼€å…³ï¼Œæ¥æ§åˆ¶ä¸å¯è§çš„ç²’å­ç³»ç»Ÿæ˜¯å¦éœ€è¦updateã€‚æœ‰çš„ç²’å­ç³»ç»Ÿåœ¨ä¸å¯è§çš„æ—¶å€™éœ€è¦æ›´æ–°,æ¯”å¦‚çˆ†ç‚¸ã€‚æœ‰çš„ä¸éœ€è¦æ›´æ–°ï¼Œæ¯”å¦‚ç«å †ç«æŠŠã€‚ ä¸ºäº†é¿å…ä¸å¿…è¦çš„updateå¼€é”€ï¼Œå°¤å…¶æ˜¯æœ€åæ¸¸æˆæ˜¯è¦å‘å¸ƒåˆ°é¡µæ¸¸å¹³å°ï¼ˆweb playeråªèƒ½ä½¿ç”¨ä¸€ä¸ªcpuçš„æ ¸ï¼‰ã€‚äºæ˜¯å†™äº†ä¸€ä¸ªè„šæœ¬ï¼Œæ§åˆ¶ä¸å¯è§çš„ç²’å­ç³»ç»Ÿå°±ä¸æ›´æ–°ã€‚ è¯¥è„šæœ¬ä¸»è¦æ˜¯ç”¨åˆ°äº†2ä¸ªMonoBehaviourçš„å‡½æ•°ã€‚OnBecameInvisible() å½“å˜ä¸ºä¸å¯è§ å’Œ OnBecameVisible() å½“å˜æˆå¯è§ã€‚ è¦è¿™2ä¸ªå‡½æ•°èµ·ä½œç”¨çš„å‰ææ˜¯ï¼Œè¯¥GameObjectç»‘å®šäº†MeshRenderç»„ä»¶ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦åœ¨ç²’å­ç³»ç»Ÿçš„GameObjectæ”¾ç½®åœ¨ä¸€ä¸ªGameObject ä¸‹ï¼Œä¸”ç»™è¯¥GameObjectç»‘å®šä¸€ä¸ªMeshRender ä¸ MeshFilterã€‚MeshFilterä¸­çš„meshå¯ä»¥éšä¾¿æ‰¾ä¸ªcubeã€‚ åœ¨Startï¼ˆï¼‰ çš„æ—¶å€™ï¼ŒæŠŠæœ€GameObjectçš„scaleè®¾ç½®ä¸ºå¾ˆå°ï¼Œä»¥ä¿è¯è¯¥cubeä¸è¢«çœ‹è§ã€‚å…¶å®éå†æ‰€æœ‰çš„childï¼ŒæŠŠactiveè®¾ç½®ä¸ºfalseã€‚ åœ¨OnBecameVisible ä¸­ éå†æ‰€æœ‰childï¼ŒæŠŠactiveè®¾ç½®ä¸ºtrueã€‚åœ¨OnBecameInvisibleä¸­ éå†æ‰€æœ‰childï¼ŒæŠŠactiveè®¾ç½®ä¸ºfalseã€‚ Unity æ€§èƒ½ä¼˜åŒ– Draw Call Unityï¼ˆæˆ–è€…è¯´åŸºæœ¬æ‰€æœ‰å›¾å½¢å¼•æ“ï¼‰ç”Ÿæˆä¸€å¸§ç”»é¢çš„å¤„ç†è¿‡ç¨‹å¤§è‡´å¯ä»¥è¿™æ ·ç®€åŒ–æè¿°ï¼šå¼•æ“é¦–å…ˆç»è¿‡ç®€å•çš„å¯è§æ€§æµ‹è¯•ï¼Œç¡®å®šæ‘„åƒæœºå¯ä»¥çœ‹åˆ°çš„ç‰©ä½“ï¼Œç„¶åæŠŠè¿™äº›ç‰©ä½“çš„é¡¶ç‚¹ï¼ˆåŒ…æ‹¬æœ¬åœ°ä½ç½®ã€æ³•çº¿ã€UVç­‰ï¼‰ï¼Œç´¢å¼•ï¼ˆé¡¶ç‚¹å¦‚ä½•ç»„æˆä¸‰è§’å½¢ï¼‰ï¼Œå˜æ¢ï¼ˆå°±æ˜¯ç‰©ä½“çš„ä½ç½®ã€æ—‹è½¬ã€ç¼©æ”¾ã€ä»¥åŠæ‘„åƒæœºä½ç½®ç­‰ï¼‰ï¼Œç›¸å…³å…‰æºï¼Œçº¹ç†ï¼Œæ¸²æŸ“æ–¹å¼ï¼ˆç”±æè´¨/Shaderå†³å®šï¼‰ç­‰æ•°æ®å‡†å¤‡å¥½ï¼Œç„¶åé€šçŸ¥å›¾å½¢APIâ€”â€”æˆ–è€…å°±ç®€å•åœ°çœ‹ä½œæ˜¯é€šçŸ¥GPUâ€”â€”å¼€å§‹ç»˜åˆ¶ï¼ŒGPUåŸºäºè¿™äº›æ•°æ®ï¼Œç»è¿‡ä¸€ç³»åˆ—è¿ç®—ï¼Œåœ¨å±å¹•ä¸Šç”»å‡ºæˆåƒä¸Šä¸‡çš„ä¸‰è§’å½¢ï¼Œæœ€ç»ˆæ„æˆä¸€å¹…å›¾åƒã€‚ åœ¨Unityä¸­ï¼Œæ¯æ¬¡å¼•æ“å‡†å¤‡æ•°æ®å¹¶é€šçŸ¥GPUçš„è¿‡ç¨‹ç§°ä¸ºä¸€æ¬¡Draw Callã€‚è¿™ä¸€è¿‡ç¨‹æ˜¯é€ä¸ªç‰©ä½“è¿›è¡Œçš„ï¼Œå¯¹äºæ¯ä¸ªç‰©ä½“ï¼Œä¸åªGPUçš„æ¸²æŸ“ï¼Œå¼•æ“é‡æ–°è®¾ç½®æè´¨Shaderä¹Ÿæ˜¯ä¸€é¡¹éå¸¸è€—æ—¶çš„æ“ä½œã€‚å› æ­¤æ¯å¸§çš„Draw Callæ¬¡æ•°æ˜¯ä¸€é¡¹éå¸¸é‡è¦çš„æ€§èƒ½æŒ‡æ ‡ï¼Œå¯¹äºiOSæ¥è¯´åº”å°½é‡æ§åˆ¶åœ¨20æ¬¡ä»¥å†…ï¼Œè¿™ä¸ªå€¼å¯ä»¥åœ¨ç¼–è¾‘å™¨çš„Statisticçª—å£çœ‹åˆ°ã€‚ Unityå†…ç½®äº†Draw Call BatchingæŠ€æœ¯ï¼Œä»åå­—å°±å¯ä»¥çœ‹å‡ºï¼Œå®ƒçš„ä¸»è¦ç›®æ ‡å°±æ˜¯åœ¨ä¸€æ¬¡Draw Callä¸­æ‰¹é‡å¤„ç†å¤šä¸ªç‰©ä½“ã€‚åªè¦ç‰©ä½“çš„å˜æ¢å’Œæè´¨ç›¸åŒï¼ŒGPUå°±å¯ä»¥æŒ‰å®Œå…¨ç›¸åŒçš„æ–¹å¼è¿›è¡Œå¤„ç†ï¼Œå³å¯ä»¥æŠŠå®ƒä»¬æ”¾åœ¨ä¸€ä¸ªDraw Callä¸­ã€‚Draw Call BatchingæŠ€æœ¯çš„æ ¸å¿ƒå°±æ˜¯åœ¨å¯è§æ€§æµ‹è¯•ä¹‹åï¼Œæ£€æŸ¥æ‰€æœ‰è¦ç»˜åˆ¶çš„ç‰©ä½“çš„æè´¨ï¼ŒæŠŠç›¸åŒæè´¨çš„åˆ†ä¸ºä¸€ç»„ï¼ˆä¸€ä¸ªBatchï¼‰ï¼Œç„¶åæŠŠå®ƒä»¬ç»„åˆæˆä¸€ä¸ªç‰©ä½“ï¼ˆç»Ÿä¸€å˜æ¢ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ä¸€ä¸ªDraw Callä¸­å¤„ç†å¤šä¸ªç‰©ä½“äº†ï¼ˆå®é™…ä¸Šæ˜¯ç»„åˆåçš„ä¸€ä¸ªç‰©ä½“ï¼‰ã€‚ ä½†Draw Call Batchingå­˜åœ¨ä¸€ä¸ªç¼ºé™·ï¼Œå°±æ˜¯å®ƒéœ€è¦æŠŠä¸€ä¸ªBatchä¸­çš„æ‰€æœ‰ç‰©ä½“ç»„åˆåˆ°ä¸€èµ·ï¼Œç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªä¸è¿™äº›ç‰©ä½“åŠ èµ·æ¥ä¸€æ ·å¤§çš„ç‰©ä½“ï¼Œä¸æ­¤åŒæ—¶å°±éœ€è¦åˆ†é…ç›¸åº”å¤§å°çš„å†…å­˜ã€‚è¿™ä¸ä»…ä¼šæ¶ˆè€—æ›´å¤šå†…å­˜ï¼Œè¿˜éœ€è¦æ¶ˆè€—CPUæ—¶é—´ã€‚ç‰¹åˆ«æ˜¯å¯¹äºç§»åŠ¨çš„ç‰©ä½“ï¼Œæ¯ä¸€å¸§éƒ½å¾—é‡æ–°è¿›è¡Œç»„åˆï¼Œè¿™å°±éœ€è¦è¿›è¡Œä¸€äº›æƒè¡¡ï¼Œå¦åˆ™å¾—ä¸å¿å¤±ã€‚ä½†å¯¹äºé™æ­¢ä¸åŠ¨çš„ç‰©ä½“æ¥è¯´ï¼Œåªéœ€è¦è¿›è¡Œä¸€æ¬¡ç»„åˆï¼Œä¹‹åå°±å¯ä»¥ä¸€ç›´ä½¿ç”¨ï¼Œæ•ˆç‡è¦é«˜å¾—å¤šã€‚ Unityæä¾›äº†Dynamic Batchingå’ŒStatic Batchingä¸¤ç§æ–¹å¼ã€‚Dynamic Batchingæ˜¯å®Œå…¨è‡ªåŠ¨è¿›è¡Œçš„ï¼Œä¸éœ€è¦ä¹Ÿæ— æ³•è¿›è¡Œä»»ä½•å¹²é¢„ï¼Œå¯¹äºé¡¶ç‚¹æ•°åœ¨300ä»¥å†…çš„å¯ç§»åŠ¨ç‰©ä½“ï¼Œåªè¦ä½¿ç”¨ç›¸åŒçš„æè´¨ï¼Œå°±ä¼šç»„æˆBatchã€‚Static Batchingåˆ™éœ€è¦æŠŠé™æ­¢çš„ç‰©ä½“æ ‡è®°ä¸ºStaticï¼Œç„¶åæ— è®ºå¤§å°ï¼Œéƒ½ä¼šç»„æˆBatchã€‚å¦‚å‰æ–‡æ‰€è¯´ï¼ŒStatic Batchingæ˜¾ç„¶æ¯”Dynamic Batchingè¦é«˜æ•ˆå¾—å¤š è¦æœ‰æ•ˆåˆ©ç”¨Draw Call Batchingï¼Œé¦–å…ˆæ˜¯å°½é‡å‡å°‘åœºæ™¯ä¸­ä½¿ç”¨çš„æè´¨æ•°é‡ï¼Œå³å°½é‡å…±äº«æè´¨ï¼Œå¯¹äºä»…çº¹ç†ä¸åŒçš„æè´¨å¯ä»¥æŠŠçº¹ç†ç»„åˆåˆ°ä¸€å¼ æ›´å¤§çš„çº¹ç†ä¸­ï¼ˆç§°ä¸ºTexture Atlasingï¼‰ã€‚ç„¶åæ˜¯æŠŠä¸ä¼šç§»åŠ¨çš„ç‰©ä½“æ ‡è®°ä¸ºStaticã€‚æ­¤å¤–è¿˜å¯ä»¥é€šè¿‡CombineChildrenè„šæœ¬ï¼ˆStandard Assets/Scripts/Unity Scripts/CombineChildrenï¼‰æ‰‹åŠ¨æŠŠç‰©ä½“ç»„åˆåœ¨ä¸€èµ·ï¼Œä½†è¿™ä¸ªè„šæœ¬ä¼šå½±å“å¯è§æ€§æµ‹è¯•ï¼Œå› ä¸ºç»„åˆåœ¨ä¸€èµ·çš„ç‰©ä½“å§‹ç»ˆä¼šè¢«çœ‹ä½œä¸€ä¸ªç‰©ä½“ï¼Œä»è€Œä¼šå¢åŠ GPUè¦å¤„ç†çš„å‡ ä½•ä½“æ•°é‡ï¼Œå› æ­¤è¦å°å¿ƒä½¿ç”¨ã€‚ å¯¹äºå¤æ‚çš„é™æ€åœºæ™¯ï¼Œè¿˜å¯ä»¥è€ƒè™‘è‡ªè¡Œè®¾è®¡é®æŒ¡å‰”é™¤ç®—æ³•ï¼Œå‡å°‘å¯è§çš„ç‰©ä½“æ•°é‡åŒæ—¶ä¹Ÿå¯ä»¥å‡å°‘Draw Callã€‚ æ€»ä¹‹ï¼Œç†è§£Draw Callå’ŒDraw Call BatchingåŸç†ï¼Œæ ¹æ®åœºæ™¯ç‰¹ç‚¹è®¾è®¡ç›¸åº”çš„æ–¹æ¡ˆæ¥å°½é‡å‡å°‘Draw Callæ¬¡æ•°æ‰æ˜¯ç‹é“ï¼Œå…¶å®ƒæ–¹é¢äº¦ç„¶ã€‚ Draw Call Batching ï¼ˆç»˜åˆ¶è°ƒç”¨æ‰¹å¤„ç†ï¼‰ To draw an object on the screen, the engine has to issue a draw call to the graphics API (OpenGL ES in the case of iOS). Every single draw call requires a significant amount of work on the part of the graphics API, causing significant performance overhead on the CPU side.åœ¨å±å¹•ä¸Šæ¸²æŸ“ç‰©ä½“ï¼Œå¼•æ“éœ€è¦å‘å‡ºä¸€ä¸ªç»˜åˆ¶è°ƒç”¨æ¥è®¿é—®å›¾å½¢APIï¼ˆiOSç³»ç»Ÿä¸­ä¸ºOpenGL ESï¼‰ã€‚æ¯ä¸ªç»˜åˆ¶è°ƒç”¨éœ€è¦è¿›è¡Œå¤§é‡çš„å·¥ä½œæ¥è®¿é—®å›¾å½¢APIï¼Œä»è€Œå¯¼è‡´äº†CPUæ–¹é¢æ˜¾è‘—çš„æ€§èƒ½å¼€é”€ã€‚ Unity combines a number of objects at runtime and draws them together with a single draw call. This operation is called â€œbatchingâ€. The more objects Unity can batch together, the better rendering performance you will get.Unityåœ¨è¿è¡Œæ—¶å¯ä»¥å°†ä¸€äº›ç‰©ä½“è¿›è¡Œåˆå¹¶ï¼Œä»è€Œç”¨ä¸€ä¸ªç»˜åˆ¶è°ƒç”¨æ¥æ¸²æŸ“ä»–ä»¬ã€‚è¿™ä¸€æ“ä½œï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œæ‰¹å¤„ç†â€ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒUnityæ‰¹å¤„ç†çš„ç‰©ä½“è¶Šå¤šï¼Œä½ å°±ä¼šå¾—åˆ°è¶Šå¥½çš„æ¸²æŸ“æ€§èƒ½ã€‚ Built-in batching support in Unity has significant benefit over simply combining geometry in the modeling tool (or using theCombineChildren script from the Standard Assets package). Batching in Unity happensafter visibility determination step. The engine does culling on each object individually, and the amount of rendered geometry is going to be the same as without batching. Combining geometry in the modeling tool, on the other hand, prevents effecient culling and results in much higher amount of geometry being rendered.Unityä¸­å†…å»ºçš„æ‰¹å¤„ç†æœºåˆ¶æ‰€è¾¾åˆ°çš„æ•ˆæœè¦æ˜æ˜¾å¼ºäºä½¿ç”¨å‡ ä½•å»ºæ¨¡å·¥å…·ï¼ˆæˆ–ä½¿ç”¨Standard AssetsåŒ…ä¸­çš„CombineChildrenè„šæœ¬ï¼‰çš„æ‰¹å¤„ç†æ•ˆæœã€‚è¿™æ˜¯å› ä¸ºï¼ŒUnityå¼•æ“çš„æ‰¹å¤„ç†æ“ä½œæ˜¯åœ¨ç‰©ä½“çš„å¯è§†è£å‰ªæ“ä½œä¹‹åè¿›è¡Œçš„ã€‚Unityå…ˆå¯¹æ¯ä¸ªç‰©ä½“è¿›è¡Œè£å‰ªï¼Œç„¶åå†è¿›è¡Œæ‰¹å¤„ç†ï¼Œè¿™æ ·å¯ä»¥ä½¿æ¸²æŸ“çš„å‡ ä½•æ€»é‡åœ¨æ‰¹å¤„ç†å‰åä¿æŒä¸å˜ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨å‡ ä½•å»ºæ¨¡å·¥å…·æ¥æ‹¼åˆç‰©ä½“ï¼Œä¼šå¦¨ç¢å¼•æ“å¯¹å…¶è¿›è¡Œæœ‰æ•ˆçš„è£å‰ªæ“ä½œï¼Œä»è€Œå¯¼è‡´å¼•æ“éœ€è¦æ¸²æŸ“æ›´å¤šçš„å‡ ä½•é¢ç‰‡ã€‚ Materialsæè´¨Only objects sharing the same material can be batched together. Therefore, if you want to achieve good batching, you need to share as many materials among different objects as possible.åªæœ‰æ‹¥æœ‰ç›¸åŒæè´¨çš„ç‰©ä½“æ‰å¯ä»¥è¿›è¡Œæ‰¹å¤„ç†ã€‚å› æ­¤ï¼Œå¦‚æœä½ æƒ³è¦å¾—åˆ°è‰¯å¥½çš„æ‰¹å¤„ç†æ•ˆæœï¼Œä½ éœ€è¦åœ¨ç¨‹åºä¸­å°½å¯èƒ½åœ°å¤ç”¨æè´¨å’Œç‰©ä½“ã€‚ If you have two identical materials which differ only in textures, you can combine those textures into a single big texture - a process often calledtexture atlasing. Once textures are in the same atlas, you can use single material instead.å¦‚æœä½ çš„ä¸¤ä¸ªæè´¨ä»…ä»…æ˜¯çº¹ç†ä¸åŒï¼Œé‚£ä¹ˆä½ å¯ä»¥é€šè¿‡çº¹ç†æ‹¼åˆæ“ä½œæ¥å°†è¿™ä¸¤å¼ çº¹ç†æ‹¼åˆæˆä¸€å¼ å¤§çš„çº¹ç†ã€‚ä¸€æ—¦çº¹ç†æ‹¼åˆåœ¨ä¸€èµ·ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªå•ä¸€æè´¨æ¥æ›¿ä»£ä¹‹å‰çš„ä¸¤ä¸ªæè´¨äº†ã€‚ If you need to access shared material properties from the scripts, then it is important to note that modifyingRenderer.material will create a copy of the material. Instead, you should useRenderer.sharedMaterial to keep material shared.å¦‚æœä½ éœ€è¦é€šè¿‡è„šæœ¬æ¥è®¿é—®å¤ç”¨æè´¨å±æ€§ï¼Œé‚£ä¹ˆå€¼å¾—æ³¨æ„çš„æ˜¯æ”¹å˜Renderer.materialå°†ä¼šé€ æˆä¸€ä»½æè´¨çš„æ‹·è´ã€‚å› æ­¤ï¼Œä½ åº”è¯¥ä½¿ç”¨Renderer.sharedMaterialæ¥ä¿è¯æè´¨çš„å…±äº«çŠ¶æ€ã€‚ Dynamic BatchingåŠ¨æ€æ‰¹å¤„ç†Unity can automatically batch moving objects into the same draw call if they share the same material.å¦‚æœåŠ¨æ€ç‰©ä½“å…±ç”¨ç€ç›¸åŒçš„æè´¨ï¼Œé‚£ä¹ˆUnityä¼šè‡ªåŠ¨å¯¹è¿™äº›ç‰©ä½“è¿›è¡Œæ‰¹å¤„ç†ã€‚ Dynamic batching is done automatically and does not require any additional effort on your side.åŠ¨æ€æ‰¹å¤„ç†æ“ä½œæ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œå¹¶ä¸éœ€è¦ä½ è¿›è¡Œé¢å¤–çš„æ“ä½œã€‚ Tips:æé†’ï¼š1ã€Batching dynamic objects has certain overheadper vertex, so batching is applied only to meshes containing less than900 vertex attributes in total.æ‰¹å¤„ç†åŠ¨æ€ç‰©ä½“éœ€è¦åœ¨æ¯ä¸ªé¡¶ç‚¹ä¸Šè¿›è¡Œä¸€å®šçš„å¼€é”€ï¼Œæ‰€ä»¥åŠ¨æ€æ‰¹å¤„ç†ä»…æ”¯æŒå°äº900é¡¶ç‚¹çš„ç½‘æ ¼ç‰©ä½“ã€‚ 2ã€If your shader is using Vertex Position, Normal and single UV, then you can batch up to 300 verts and if your shader is using Vertex Position, Normal, UV0, UV1 and Tangent, then only 180 verts.Please note: attribute count limit might be changed in futureå¦‚æœä½ çš„ç€è‰²å™¨ä½¿ç”¨é¡¶ç‚¹ä½ç½®ï¼Œæ³•çº¿å’ŒUVå€¼ä¸‰ç§å±æ€§ï¼Œé‚£ä¹ˆä½ åªèƒ½æ‰¹å¤„ç†300é¡¶ç‚¹ä»¥ä¸‹çš„ç‰©ä½“ï¼›å¦‚æœä½ çš„ç€è‰²å™¨éœ€è¦ä½¿ç”¨é¡¶ç‚¹ä½ç½®ï¼Œæ³•çº¿ï¼ŒUV0ï¼ŒUV1å’Œåˆ‡å‘é‡ï¼Œé‚£ä½ åªèƒ½æ‰¹å¤„ç†180é¡¶ç‚¹ä»¥ä¸‹çš„ç‰©ä½“ã€‚è¯·æ³¨æ„ï¼šå±æ€§æ•°é‡çš„é™åˆ¶å¯èƒ½ä¼šåœ¨å°†æ¥è¿›è¡Œæ”¹å˜ã€‚ 4ã€Donâ€™t use scale. Objects with scale (1,1,1) and (2,2,2) wonâ€™t batch.ä¸è¦ä½¿ç”¨ç¼©æ”¾å°ºåº¦ï¼ˆscaleï¼‰ã€‚åˆ†åˆ«æ‹¥æœ‰ç¼©æ”¾å°ºåº¦(1,1,1)å’Œ(2,2,2)çš„ä¸¤ä¸ªç‰©ä½“å°†ä¸ä¼šè¿›è¡Œæ‰¹å¤„ç†ã€‚ 5ã€Uniformly scaled objects wonâ€™t be batched with non-uniformly scaled ones.ç»Ÿä¸€ç¼©æ”¾å°ºåº¦çš„ç‰©ä½“ä¸ä¼šä¸éç»Ÿä¸€ç¼©æ”¾å°ºåº¦çš„ç‰©ä½“è¿›è¡Œæ‰¹å¤„ç†ã€‚Objects with scale (1,1,1) and (1,2,1) wonâ€™t be batched. On the other hand (1,2,1) and (1,3,1) will be.ä½¿ç”¨ç¼©æ”¾å°ºåº¦(1,1,1)å’Œ (1,2,1)çš„ä¸¤ä¸ªç‰©ä½“å°†ä¸ä¼šè¿›è¡Œæ‰¹å¤„ç†ï¼Œä½†æ˜¯ä½¿ç”¨ç¼©æ”¾å°ºåº¦(1,2,1)å’Œ(1,3,1)çš„ä¸¤ä¸ªç‰©ä½“å°†å¯ä»¥è¿›è¡Œæ‰¹å¤„ç†ã€‚ 6ã€Using different material instances will cause batching to fail.ä½¿ç”¨ä¸åŒæè´¨çš„å®ä¾‹åŒ–ç‰©ä½“ï¼ˆinstanceï¼‰å°†ä¼šå¯¼è‡´æ‰¹å¤„ç†å¤±è´¥ã€‚ 7ã€Objects with lightmaps have additional (hidden) material parameter: offset/scale in lightmap, so lightmapped objects wonâ€™t be batched (unless they point to same portions of lightmap)æ‹¥æœ‰lightmapçš„ç‰©ä½“å«æœ‰é¢å¤–ï¼ˆéšè—ï¼‰çš„æè´¨å±æ€§ï¼Œæ¯”å¦‚ï¼šlightmapçš„åç§»å’Œç¼©æ”¾ç³»æ•°ç­‰ã€‚æ‰€ä»¥ï¼Œæ‹¥æœ‰lightmapçš„ç‰©ä½“å°†ä¸ä¼šè¿›è¡Œæ‰¹å¤„ç†ï¼ˆé™¤éä»–ä»¬æŒ‡å‘lightmapçš„åŒä¸€éƒ¨åˆ†ï¼‰ã€‚ 8ã€Multi-pass shaders will break batching. E.g. Almost all unity shaders supports several lights in forward rendering, effectively doing additional pass for themå¤šé€šé“çš„shaderä¼šå¦¨ç¢æ‰¹å¤„ç†æ“ä½œã€‚æ¯”å¦‚ï¼Œå‡ ä¹unityä¸­æ‰€æœ‰çš„ç€è‰²å™¨åœ¨å‰å‘æ¸²æŸ“ä¸­éƒ½æ”¯æŒå¤šä¸ªå…‰æºï¼Œå¹¶ä¸ºå®ƒä»¬æœ‰æ•ˆåœ°å¼€è¾Ÿå¤šä¸ªé€šé“ã€‚ 9ã€Using instances of a prefab automatically are using the same mesh and material.é¢„è®¾ä½“çš„å®ä¾‹ä¼šè‡ªåŠ¨åœ°ä½¿ç”¨ç›¸åŒçš„ç½‘æ ¼æ¨¡å‹å’Œæè´¨ã€‚ Static Batchingé™æ€æ‰¹å¤„ç† Static batching, on the other hand, allows the engine to reduce draw calls for geometry of any size (provided it does not move and shares the same material). Static batching is significantly more efficient than dynamic batching. You should choose static batching as it will require less CPU power.ç›¸å¯¹è€Œè¨€ï¼Œé™æ€æ‰¹å¤„ç†æ“ä½œå…è®¸å¼•æ“å¯¹ä»»æ„å¤§å°çš„å‡ ä½•ç‰©ä½“è¿›è¡Œæ‰¹å¤„ç†æ“ä½œæ¥é™ä½ç»˜åˆ¶è°ƒç”¨ï¼ˆåªè¦è¿™äº›ç‰©ä½“ä¸ç§»åŠ¨ï¼Œå¹¶ä¸”æ‹¥æœ‰ç›¸åŒçš„æè´¨ï¼‰ã€‚å› æ­¤ï¼Œé™æ€æ‰¹å¤„ç†æ¯”åŠ¨æ€æ‰¹å¤„ç†æ›´åŠ æœ‰æ•ˆï¼Œä½ åº”è¯¥å°½é‡ä½ä½¿ç”¨å®ƒï¼Œå› ä¸ºå®ƒéœ€è¦æ›´å°‘çš„CPUå¼€é”€ã€‚ In order to take advantage of static batching, you need explicitly specify that certain objects are static and willnot move, rotate or scale in the game. To do so, you can mark objects as static using the Static checkbox in the Inspector:ä¸ºäº†æ›´å¥½åœ°ä½¿ç”¨é™æ€æ‰¹å¤„ç†ï¼Œä½ éœ€è¦æ˜ç¡®æŒ‡å‡ºå“ªäº›ç‰©ä½“æ˜¯é™æ­¢çš„ï¼Œå¹¶ä¸”åœ¨æ¸¸æˆä¸­æ°¸è¿œä¸ä¼šç§»åŠ¨ã€æ—‹è½¬å’Œç¼©æ”¾ã€‚æƒ³å®Œæˆè¿™ä¸€æ­¥ï¼Œä½ åªéœ€è¦åœ¨æ£€æµ‹å™¨ï¼ˆInspectorï¼‰ä¸­å°†Staticå¤é€‰æ¡†æ‰“å‹¾å³å¯ï¼›Using static batching will require additional memory for storing the combined geometry. If several objects shared the same geometry before static batching, then a copy of geometry will be created for each object, either in the Editor or at runtime. This might not always be a good idea - sometimes you will have to sacrifice rendering performance by avoiding static batching for some objects to keep a smaller memory footprint. For example, marking trees as static in a dense forest level can have serious memory impact.ä½¿ç”¨é™æ€æ‰¹å¤„ç†æ“ä½œéœ€è¦é¢å¤–çš„å†…å­˜å¼€é”€æ¥å‚¨å­˜åˆå¹¶åçš„å‡ ä½•æ•°æ®ã€‚åœ¨é™æ€æ‰¹å¤„ç†ä¹‹å‰ï¼Œå¦‚æœä¸€äº›ç‰©ä½“å…±ç”¨äº†åŒæ ·çš„å‡ ä½•æ•°æ®ï¼Œé‚£ä¹ˆå¼•æ“ä¼šåœ¨ç¼–è¾‘ä»¥åŠè¿è¡ŒçŠ¶æ€å¯¹æ¯ä¸ªç‰©ä½“åˆ›å»ºä¸€ä¸ªå‡ ä½•æ•°æ®çš„å¤‡ä»½ã€‚è¿™å¹¶ä¸æ€»æ˜¯ä¸€ä¸ªå¥½çš„æƒ³æ³•ï¼Œå› ä¸ºæœ‰æ—¶å€™ï¼Œä½ å°†ä¸å¾—ä¸ç‰ºç‰²ä¸€ç‚¹æ¸²æŸ“æ€§èƒ½æ¥é˜²æ­¢ä¸€äº›ç‰©ä½“çš„é™æ€æ‰¹å¤„ç†ï¼Œä»è€Œä¿æŒè¾ƒå°‘çš„å†…å­˜å¼€é”€ã€‚æ¯”å¦‚ï¼Œå°†æµ“å¯†æ£®é‡Œä¸­æ ‘è®¾ä¸ºStaticï¼Œä¼šå¯¼è‡´ä¸¥é‡çš„å†…å­˜å¼€é”€ã€‚ Static batching is only available in Unity iOS Advanced.é™æ€æ‰¹å¤„ç†ç›®å‰åªæ”¯æŒUnity iOS Advancedã€‚ å‰ä¸¤å¤©ï¼ŒMadFingerï¼Œå°±æ˜¯å½“ä»ŠiOSä¸Androidä¸Šç”»è´¨æœ€ç‰›é€¼é—ªé—ªçš„æ¸¸æˆä¹‹ä¸€â€”â€”ShadowGunçš„å¼€å‘å•†ï¼Œä»¤äººæƒŠå¼‚åœ°æ”¾å‡ºäº†ä¸€ä¸ªShadowGunçš„æ ·ä¾‹å…³å¡ä»¥åŠè‹¥å¹²å¯å…è´¹ä½¿ç”¨çš„Shaderï¼Œå›½å¤–åŒè¡Œä»¬çš„åˆ†äº«ç²¾ç¥çœŸçš„æ˜¯ä»¤äººèµå¹ä¸å·²ã€‚åŸæ–‡åœ¨è¿™é‡Œï¼Œä»¥ä¸‹æ˜¯æˆ‘çš„ä¸€äº›æ‘˜å½•å’Œç¬”è®°ã€‚ é¦–å…ˆæ˜¯ä¸€äº›ä¼˜åŒ–å¸¸è¯†ã€‚é’ˆå¯¹å›¾å½¢æ–¹é¢çš„ä¼˜åŒ–ä¸»è¦åŒ…æ‹¬ä¸‰è§’å½¢æ•°é‡ï¼Œçº¹ç†æ‰€å å†…å­˜ï¼Œä»¥åŠShaderï¼Œå‰ä¸¤é¡¹åŸºæœ¬æ²¡ä»€ä¹ˆå¥½è®²çš„ï¼Œé’ˆå¯¹è®¾å¤‡æœºèƒ½çš„é™åˆ¶åˆ¶å®šç›¸åº”çš„æŒ‡æ ‡å³å¯ï¼Œæ‰€ä»¥Shaderå°±æˆä¸ºäº†å›¾å½¢æ€§èƒ½ä¼˜åŒ–çš„å…³é”®ã€‚ Alpha blending åœ¨Unityå®˜æ–¹æ–‡æ¡£ä¸­è®²ï¼Œç”±äºç¡¬ä»¶åŸå› ï¼Œåœ¨iOSè®¾å¤‡ä¸Šä½¿ç”¨alpha-testä¼šé€ æˆå¾ˆå¤§çš„æ€§èƒ½å¼€é”€ï¼Œåº”å°½é‡ä½¿ç”¨alpha-blendä»£æ›¿ã€‚è¿™é‡Œæåˆ°ï¼Œåœ¨åŒå±ä½¿ç”¨alpha-blendçš„é¢æ•°ï¼Œå°¤å…¶æ˜¯è¿™äº›é¢æ‰€å å±å¹•é¢ç§¯çš„å¤§å°ï¼Œå¯¹æ€§èƒ½ä¹Ÿä¼šé€ æˆå¾ˆå¤§å½±å“ã€‚åŸå› æ˜¯ä½¿ç”¨alpha-blendçš„é¢ä¼šé€ æˆoverdrawçš„å¢åŠ ï¼Œè¿™å°¤å…¶å¯¹ä½æ€§èƒ½è®¾å¤‡çš„å½±å“å¾ˆå¤§ã€‚ä¸è¿‡æ²¡æœ‰è´­ä¹°Proç‰ˆï¼Œæ²¡æœ‰Occlusion CullingåŠŸèƒ½çš„è¯ï¼Œå°±ä¸å¿…é¡¾è™‘è¿™ä¸€é—®é¢˜äº†ï¼Œåæ­£overdrawæ˜¯å¿…ç„¶çš„ã€‚ å¤æ‚çš„Per-pixel shader Per-pixel shaderå³Fragment shaderï¼Œé¡¾åæ€ä¹‰æ˜¯è¦å¯¹æ¯ä¸ªæ¸²æŸ“åˆ°å±å¹•ä¸Šçš„åƒç´ åšå¤„ç†çš„shaderï¼Œå¦‚æœper-pixel shaderæ¯”è¾ƒå¤æ‚ä¸”éœ€è¦å¤„ç†çš„åƒç´ å¾ˆå¤šæ—¶ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨è¯¥shaderçš„é¢å å±å¹•é¢ç§¯å¾ˆå¤§æ—¶ï¼Œå¯¹æ€§èƒ½çš„å½±å“ç”šè‡³è¦è¶…è¿‡alpha blendingã€‚å› æ­¤å¤æ‚çš„per-pixel shaderåªé€‚ç”¨äºå°ç‰©ä½“ã€‚ ä¸‹é¢æ˜¯å¯¹å‡ ä¸ªShaderçš„é€ä¸€è®²è§£ï¼š Environment specular maps(Shader Virtual Gloss Per Vertex Additive)Specular mapé€šå¸¸éƒ½æ˜¯åˆ©ç”¨è´´å›¾çš„alphaé€šé“æ¥å®šä¹‰ç‰©ä½“è¡¨é¢çš„å…‰æ»‘ç¨‹åº¦ï¼ˆåå…‰åº¦ï¼‰ï¼Œè¿™ä¸ªshaderçš„ç‰¹ç‚¹æ˜¯per-vertexè®¡ç®—åå…‰åº¦çš„ï¼Œæœ‰ç€ç›¸å½“ä¸é”™çš„æ•ˆæœçš„åŒæ—¶æ¯”per-pixelçš„shaderæ€§èƒ½è¦é«˜å¾—å¤šã€‚è¿™ä¸ªshaderå¾ˆé€‚ç”¨äºå…³å¡ç¯å¢ƒç­‰å å¾ˆå¤§åŒºåŸŸçš„æ¨¡å‹ã€‚ ç»è¿‡ä¼˜åŒ–çš„åŠ¨æ€è§’è‰²å…‰ç…§å’Œé˜´å½±(Light probeså’ŒBRDF Shader)ä¼ ç»Ÿçš„Lightmapsæ— æ³•æ”¯æŒåŠ¨æ€ç‰©ä½“ï¼Œå¯¹æ­¤Unityæä¾›äº†Light probesæŠ€æœ¯ï¼Œé¢„å…ˆæŠŠåŠ¨æ€ç‰©ä½“çš„å…‰ç…§ä¿¡æ¯ä¿å­˜åœ¨ä»£ç†å¯¹è±¡(å³Light probes)ä¸­ï¼Œè¿è¡Œæ—¶åŠ¨æ€ç‰©ä½“ä»è·ç¦»æœ€è¿‘çš„Probeä¸­è·å–å…‰ç…§ä¿¡æ¯ã€‚ Unityæœ¬èº«è¿˜æä¾›äº†ä¸€ä¸ªæ•ˆæœéå¸¸æ£’çš„ä¸“ä¸ºç§»åŠ¨è®¾å¤‡ä¼˜åŒ–è¿‡çš„è§’è‰²Shaderï¼Œæ”¯æŒDiffuseã€Specularå’ŒNormal mapsï¼Œå¹¶é€šè¿‡ä¸€ä¸ªç‰¹æ®Šçš„è„šæœ¬ç”Ÿæˆè´´å›¾ç”¨äºæ¨¡ä»¿BRDFå…‰ç…§æ•ˆæœã€‚æœ€ç»ˆäº§ç”Ÿçš„æ•ˆæœå ªæ¯”æ¬¡æ—¶ä»£å¤§ä½œä¸­çš„è§’è‰²å…‰å½±æ•ˆæœã€‚ é›¾å’Œä½“ç§¯å…‰(Shader Blinking Godrays)ç›®å‰åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šè¦å¼€å¯çœŸæ­£çš„é›¾æ•ˆåŸºæœ¬ä¸å¯è¡Œï¼ŒShadowGunçš„æ–¹æ¡ˆæ˜¯é€šè¿‡ç®€å•çš„ç½‘æ ¼ï¼‹é€æ˜è´´å›¾(ç§°ä¸ºé›¾é¢)æ¥æ¨¡æ‹Ÿé›¾æ•ˆã€‚åœ¨ç©å®¶é è¿‘æ—¶ï¼Œé›¾é¢é€æ¸å˜æ·¡ï¼ŒåŒæ—¶fog planeçš„é¡¶ç‚¹ä¹Ÿä¼šç§»å¼€(å³ä½¿å®Œå…¨é€æ˜çš„alphaé¢ä¹Ÿä¼šæ¶ˆè€—å¾ˆå¤šæ¸²æŸ“æ—¶é—´)ã€‚ ä½¿ç”¨è¿™ä¸ªShaderçš„ç½‘æ ¼éœ€è¦ç»è¿‡å¤„ç†ï¼š é¡¶ç‚¹çš„alphaå€¼ç”¨äºå†³å®šé¡¶ç‚¹æ˜¯å¦å¯ä»¥ç§»åŠ¨(åœ¨ä¾‹å­ä¸­0ä¸ºä¸å¯åŠ¨ï¼Œ1ä¸ºå¯åŠ¨)ã€‚é¡¶ç‚¹æ³•çº¿å†³å®šç§»åŠ¨çš„æ–¹å‘ç„¶åShaderé€šè¿‡è®¡ç®—ä¸è§‚å¯Ÿè€…çš„è·ç¦»æ¥æ§åˆ¶é›¾é¢çš„æ·¡å…¥/æ·¡å‡ºã€‚è¿™ä¸ªShaderè¿˜å¯ä»¥ç”¨æ¥åšä½“ç§¯å…‰å’Œå…¶å®ƒä¸€äº›alphaæ•ˆæœã€‚ é£æœºå æ¯çš„æµ“çƒŸæ•ˆæœ(Shader Scroll 2 Layers Sine Alpha-blended)é€šè¿‡ç²’å­äº§ç”Ÿæµ“çƒŸçš„ä»£ä»·å¤ªé«˜ï¼Œæ‰€ä»¥ShadowGunä¸­ä½¿ç”¨äº†ç½‘æ ¼ï¼‹è´´å›¾åŠ¨ç”»æ¥åˆ¶ä½œè¿™ä¸ªæ•ˆæœã€‚é€šè¿‡æ··åˆä¸¤å±‚è´´å›¾å¹¶è®©å®ƒä»¬äº¤é”™ç§»åŠ¨æ¥äº§ç”ŸåŠ¨ç”»æ•ˆæœã€‚å…¶ä¸­é¡¶ç‚¹alphaå€¼ç”¨äºè®©ç½‘æ ¼çš„è¾¹ç¼˜çœ‹èµ·æ¥æ¯”è¾ƒæŸ”å’Œï¼ŒåŒæ—¶ä½¿ç”¨é¡¶ç‚¹é¢œè‰²æ¥æ¨¡æ‹Ÿä»ç«ç„°åˆ°çƒŸé›¾çš„è¿‡æ¸¡æ•ˆæœã€‚ å¸¦åŠ¨æ€æ•ˆæœçš„å¤©ç©ºç›’(Shader Scroll 2 Layers Multiplicative)é€šè¿‡ä¸¤å¼ è´´å›¾çš„æ··åˆå’Œç§»åŠ¨äº§ç”Ÿäº‘çš„åŠ¨æ€æ•ˆæœã€‚ æ——å¸œå’Œè¡£æœçš„é£˜åŠ¨æ•ˆæœ(Shader Lightmap + Wind)åŒæ ·åˆ©ç”¨é¡¶ç‚¹alphaå€¼å†³å®šå“ªäº›é¡¶ç‚¹å¯ä»¥ç§»åŠ¨ï¼Œç„¶åshaderçš„å‚æ•°ç”¨äºè°ƒæ•´æ‘†åŠ¨çš„æ–¹å‘å’Œé€Ÿåº¦ã€‚ ä¸€ã€ç¨‹åºæ–¹é¢ 1. åŠ¡å¿…åˆ é™¤è„šæœ¬ä¸­ä¸ºç©ºæˆ–ä¸éœ€è¦çš„é»˜è®¤æ–¹æ³•ï¼› 2. åªåœ¨ä¸€ä¸ªè„šæœ¬ä¸­ä½¿ç”¨OnGUIæ–¹æ³•ï¼›ï¼ˆæœ€å¥½ä¸è¦åŠ ï¼‰ 3. é¿å…åœ¨OnGUIä¸­å¯¹å˜é‡ã€æ–¹æ³•è¿›è¡Œæ›´æ–°ã€èµ‹å€¼ï¼Œè¾“å‡ºå˜é‡å»ºè®®åœ¨Updateå†…ï¼› 4. åŒä¸€è„šæœ¬ä¸­é¢‘ç¹ä½¿ç”¨çš„å˜é‡å»ºè®®å£°æ˜å…¶ä¸ºå…¨å±€å˜é‡ï¼Œè„šæœ¬ä¹‹é—´é¢‘ç¹è°ƒç”¨çš„å˜é‡æˆ–æ–¹æ³•å»ºè®®å£°æ˜ä¸ºå…¨å±€é™æ€å˜é‡æˆ–æ–¹æ³•ï¼› 5. ä¸è¦å»é¢‘ç¹è·å–ç»„ä»¶ï¼Œå°†å…¶å£°æ˜ä¸ºå…¨å±€å˜é‡ï¼› 6. æ•°ç»„ã€é›†åˆç±»å…ƒç´ ä¼˜å…ˆä½¿ç”¨Arrayï¼Œå…¶æ¬¡æ˜¯Listï¼› 7. è„šæœ¬åœ¨ä¸ä½¿ç”¨æ—¶è„šæœ¬ç¦ç”¨ä¹‹ï¼Œéœ€è¦æ—¶å†å¯ç”¨ï¼› 8. å¯ä»¥ä½¿ç”¨Rayæ¥ä»£æ›¿OnMouseXXXç±»æ–¹æ³•ï¼› 9. éœ€è¦éšè—/æ˜¾ç¤ºæˆ–å®ä¾‹åŒ–æ¥å›åˆ‡æ¢çš„å¯¹è±¡ï¼Œå°½é‡ä¸è¦ä½¿ç”¨SetActiveRecursivelyæˆ–activeï¼Œè€Œä½¿ç”¨å°†å¯¹è±¡è¿œè¿œç§»å‡ºç›¸æœºèŒƒå›´å’Œç§»å›åŸä½çš„åšæ³•ï¼› 10. å°½é‡å°‘ç”¨æ¨¡è¿ç®—å’Œé™¤æ³•è¿ç®—ï¼Œæ¯”å¦‚a/5fï¼Œä¸€å®šè¦å†™æˆa * 0.2fã€‚ 11. å¯¹äºä¸ç»å¸¸è°ƒç”¨æˆ–æ›´æ”¹çš„å˜é‡æˆ–æ–¹æ³•å»ºè®®ä½¿ç”¨Coroutines &amp; Yieldï¼› 12. å°½é‡ç›´æ¥å£°æ˜è„šæœ¬å˜é‡ï¼Œè€Œä¸ä½¿ç”¨GetComponentæ¥è·å–è„šæœ¬ï¼›iPhone 13. å°½é‡ä½¿ç”¨æ•´æ•°æ•°å­—ï¼Œå› ä¸ºiPhoneçš„æµ®ç‚¹æ•°è®¡ç®—èƒ½åŠ›å¾ˆå·®ï¼› 14. ä¸è¦ä½¿ç”¨åŸç”Ÿçš„GUIæ–¹æ³•ï¼› 15. ä¸è¦å®ä¾‹åŒ–ï¼ˆInstantiateï¼‰å¯¹è±¡ï¼Œäº‹å…ˆå»ºå¥½å¯¹è±¡æ± ï¼Œå¹¶ä½¿ç”¨Translateâ€œç”Ÿæˆâ€å¯¹è±¡ï¼›äºŒã€æ¨¡å‹æ–¹é¢ 1. åˆå¹¶ä½¿ç”¨åŒè´´å›¾çš„æè´¨çƒï¼Œåˆå¹¶ä½¿ç”¨ç›¸åŒæè´¨çƒçš„Meshï¼› 2. è§’è‰²çš„è´´å›¾å’Œæè´¨çƒåªè¦ä¸€ä¸ªï¼Œè‹¥å¿…é¡»å¤šä¸ªåˆ™å°†æ¨¡å‹ç¦»åˆ†ç¦»ä¸ºå¤šä¸ªéƒ¨åˆ†ï¼› 2. éª¨éª¼ç³»ç»Ÿä¸è¦ä½¿ç”¨å¤ªå¤šï¼› 3. å½“ä½¿ç”¨å¤šè§’è‰²æ—¶ï¼Œå°†åŠ¨ç”»å•ç‹¬åˆ†ç¦»å‡ºæ¥ï¼› 4. ä½¿ç”¨å±‚è·ç¦»æ¥æ§åˆ¶æ¨¡å‹çš„æ˜¾ç¤ºè·ç¦»ï¼› 5. é˜´å½±å…¶å®åŒ…å«ä¸¤æ–¹é¢é˜´æš—å’Œå½±å­ï¼Œå»ºè®®ä½¿ç”¨å®æ—¶å½±å­æ—¶æŠŠé˜´æš—æ•ˆæœçƒ˜ç„™å‡ºæ¥ï¼Œä¸è¦ä½¿ç”¨ç¯å…‰æ¥è°ƒèŠ‚å…‰çº¿é˜´æš—ã€‚ 6. å°‘ç”¨åƒç´ ç¯å’Œä½¿ç”¨åƒç´ ç¯çš„Shaderï¼› 7. å¦‚æœç¡¬é˜´å½±å¯ä»¥è§£å†³é—®é¢˜å°±ä¸è¦ç”¨è½¯é˜´å½±ï¼Œå¹¶ä¸”ä½¿ç”¨ä¸å½±å“æ•ˆæœçš„ä½åˆ†è¾¨ç‡é˜´å½±ï¼› 08ã€å®æ—¶é˜´å½±å¾ˆè€—æ€§èƒ½ï¼Œå°½é‡å‡å°äº§ç”Ÿé˜´å½±çš„è·ç¦»ï¼› 09ã€å…è®¸çš„è¯åœ¨å¤§åœºæ™¯ä¸­ä½¿ç”¨çº¿æ€§é›¾ï¼Œè¿™æ ·å¯ä»¥ä½¿è¿œè·ç¦»å¯¹è±¡æˆ–é˜´å½±ä¸æ˜“å¯Ÿè§‰ï¼Œå› æ­¤å¯ä»¥é€šè¿‡å‡å°ç›¸æœºå’Œé˜´å½±è·ç¦»æ¥æé«˜æ€§èƒ½ï¼› 10ã€ä½¿ç”¨åœ†æ»‘ç»„æ¥å°½é‡å‡å°‘æ¨¡å‹çš„é¢æ•°ï¼› 11ã€é¡¹ç›®ä¸­å¦‚æœæ²¡æœ‰ç¯å…‰æˆ–å¯¹è±¡åœ¨ç§»åŠ¨é‚£ä¹ˆå°±ä¸è¦ä½¿ç”¨å®æ—¶ç¯å…‰ï¼› 12ã€æ°´é¢ã€é•œå­ç­‰å®æ—¶åå°„/æŠ˜å°„çš„æ•ˆæœå•ç‹¬æ”¾åœ¨Waterå›¾å±‚ä¸­ï¼Œå¹¶ä¸”æ ¹æ®å…¶å®æ—¶åå°„/æŠ˜å°„çš„èŒƒå›´æ¥è°ƒæ•´ï¼› 13ã€ç¢°æ’å¯¹æ•ˆç‡çš„å½±å“å¾ˆå°ï¼Œä½†ç¢°æ’è¿˜æ˜¯å»ºè®®ä½¿ç”¨Boxã€Sphereç¢°æ’ä½“ï¼› 14ã€å»ºæè´¨çƒæ—¶å°½é‡è€ƒè™‘ä½¿ç”¨Substanceï¼› 15ã€å°½é‡å°†æ‰€æœ‰çš„å®æ—¶åå°„/æŠ˜å°„ï¼ˆå¦‚æ°´é¢ã€é•œå­ã€åœ°æ¿ç­‰ç­‰ï¼‰éƒ½é›†åˆæˆä¸€ä¸ªé¢ï¼› 16ã€å‡åå°„/æŠ˜å°„æ²¡æœ‰å¿…è¦ä½¿ç”¨è¿‡å¤§åˆ†è¾¨ç‡ï¼Œä¸€èˆ¬6464å°±å¯ä»¥ï¼Œä¸å»ºè®®è¶…è¿‡256256ï¼› 17ã€éœ€è¦æ›´æ”¹çš„æè´¨çƒï¼Œå»ºè®®å®ä¾‹åŒ–ä¸€ä¸ªï¼Œè€Œä¸æ˜¯ä½¿ç”¨å…¬å…±çš„æè´¨çƒï¼› 18ã€å°†ä¸é¡»å°„çº¿æˆ–ç¢°æ’äº‹ä»¶çš„å¯¹è±¡ç½®äºIgnoreRaycastå›¾å±‚ï¼› 19ã€å°†æ°´é¢æˆ–ç±»ä¼¼æ•ˆæœç½®äºWaterå›¾å±‚ 20ã€å°†é€æ˜é€šé“çš„å¯¹è±¡ç½®äºTransparentFXå›¾å±‚ï¼› 21ã€å…»æˆè‰¯å¥½çš„æ ‡ç­¾ï¼ˆTagsï¼‰ã€å±‚æ¬¡ï¼ˆHieratchyï¼‰å’Œå›¾å±‚ï¼ˆLayerï¼‰çš„æ¡ç†åŒ–ä¹ æƒ¯ï¼Œå°†ä¸åŒçš„å¯¹è±¡ç½®äºä¸åŒçš„æ ‡ç­¾æˆ–å›¾å±‚ï¼Œä¸‰è€…æœ‰æ•ˆçš„ç»“åˆå°†å¾ˆæ–¹ä¾¿çš„æŒ‰åç§°ã€ç±»åˆ«å’Œå±æ€§æ¥æŸ¥æ‰¾ï¼› 22ã€é€šè¿‡Statså’ŒProfileæŸ¥çœ‹å¯¹æ•ˆç‡å½±å“æœ€å¤§çš„æ–¹é¢æˆ–å¯¹è±¡ï¼Œæˆ–è€…ä½¿ç”¨ç¦ç”¨éƒ¨åˆ†æ¨¡å‹çš„æ–¹å¼æŸ¥çœ‹é—®é¢˜åˆ°åº•åœ¨å“ªå„¿ï¼› 23ã€ä½¿ç”¨é®æŒ¡å‰”é™¤ï¼ˆOcclusion Cullingï¼‰å¤„ç†å¤§åœºæ™¯ï¼Œä¸€ç§è¾ƒåŸç”Ÿçš„ç±»LODæŠ€æœ¯ï¼Œå¹¶ä¸”èƒ½å¤Ÿâ€œåˆ†å‰²â€ä½œä¸ºæ•´ä½“çš„ä¸€ä¸ªæ¨¡å‹ã€‚ ä¸‰ã€å…¶å®ƒ åœºæ™¯ä¸­å¦‚æœæ²¡æœ‰ä½¿ç”¨ç¯å…‰å’Œåƒç´ ç¯ï¼Œå°±ä¸è¦ä½¿ç”¨æ³•çº¿è´´å›¾ï¼Œå› ä¸ºæ³•çº¿æ•ˆæœåªæœ‰åœ¨æœ‰å…‰æºï¼ˆDirect Light/Point Light/Angle Light/Pixel Lightï¼‰çš„æƒ…å†µä¸‹æ‰æœ‰æ•ˆæœã€‚]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[C# çº¿ç¨‹åŒæ­¥]]></title>
    <url>%2F2018%2F04%2F12%2FC-Thread-Sync%2F</url>
    <content type="text"><![CDATA[çº¿ç¨‹åŒæ­¥çš„æ–¹å¼çº¿ç¨‹åŒæ­¥æœ‰ï¼šä¸´ç•ŒåŒºã€äº’æ–¥åŒºã€äº‹ä»¶ã€ä¿¡å·é‡å››ç§æ–¹å¼ ä¸´ç•ŒåŒº(Critical Section)ï¼šä¸´ç•ŒåŒºï¼šé€šè¿‡å¯¹å¤šçº¿ç¨‹çš„ä¸²è¡ŒåŒ–æ¥è®¿é—®å…¬å…±èµ„æºæˆ–ä¸€æ®µä»£ç ï¼Œé€Ÿåº¦å¿«ï¼Œé€‚åˆæ§åˆ¶æ•°æ®è®¿é—®ã€‚åœ¨ä»»æ„æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºè¿›è¡Œè®¿é—®ï¼Œå¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹è¯•å›¾è®¿é—®å…¬å…±èµ„æºï¼Œé‚£ä¹ˆåœ¨æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥åï¼Œå…¶ä»–è¯•å›¾è®¿é—®å…¬å…±èµ„æºçš„çº¿ç¨‹å°†è¢«æŒ‚èµ·ï¼Œå¹¶ä¸€ç›´ç­‰åˆ°è¿›å…¥ä¸´ç•ŒåŒºçš„çº¿ç¨‹ç¦»å¼€ï¼Œä¸´ç•ŒåŒºåœ¨è¢«é‡Šæ”¾åï¼Œå…¶ä»–çº¿ç¨‹æ‰å¯ä»¥æŠ¢å ã€‚ äº’æ–¥é‡(Mutex)ï¼šé‡‡ç”¨äº’æ–¥å¯¹è±¡æœºåˆ¶ã€‚ åªæœ‰æ‹¥æœ‰äº’æ–¥å¯¹è±¡çš„çº¿ç¨‹æ‰æœ‰è®¿é—®å…¬å…±èµ„æºçš„æƒé™ï¼Œå› ä¸ºäº’æ–¥å¯¹è±¡åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥èƒ½ä¿è¯å…¬å…±èµ„æºä¸ä¼šåŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹è®¿é—®ã€‚äº’æ–¥ä¸ä»…èƒ½å®ç°åŒä¸€åº”ç”¨ç¨‹åºçš„å…¬å…±èµ„æºå®‰å…¨å…±äº«ï¼Œè¿˜èƒ½å®ç°ä¸åŒåº”ç”¨ç¨‹åºçš„å…¬å…±èµ„æºå®‰å…¨å…±äº« ä¿¡å·é‡(Semaphore)ï¼šå®ƒå…è®¸å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»è®¿é—®åŒä¸€èµ„æºï¼Œä½†æ˜¯éœ€è¦é™åˆ¶åœ¨åŒä¸€æ—¶åˆ»è®¿é—®æ­¤èµ„æºçš„æœ€å¤§çº¿ç¨‹æ•°ç›® äº‹ä»¶(Event)ï¼šé€šè¿‡é€šçŸ¥æ“ä½œçš„æ–¹å¼æ¥ä¿æŒçº¿ç¨‹çš„åŒæ­¥ï¼Œè¿˜å¯ä»¥æ–¹ä¾¿å®ç°å¯¹å¤šä¸ªçº¿ç¨‹çš„ä¼˜å…ˆçº§æ¯”è¾ƒçš„æ“ä½œ lock å…³é”®å­—lock å…³é”®å­—å°†è¯­å¥å—æ ‡è®°ä¸ºä¸´ç•ŒåŒºï¼Œæ–¹æ³•æ˜¯è·å–ç»™å®šå¯¹è±¡çš„äº’æ–¥é”ï¼Œæ‰§è¡Œè¯­å¥ï¼Œç„¶åé‡Šæ”¾è¯¥é”ã€‚lock ç¡®ä¿å½“ä¸€ä¸ªçº¿ç¨‹ä½äºä»£ç çš„ä¸´ç•ŒåŒºæ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸è¿›å…¥ä¸´ç•ŒåŒºã€‚å¦‚æœå…¶ä»–çº¿ç¨‹è¯•å›¾è¿›å…¥é”å®šçš„ä»£ç ï¼Œåˆ™å®ƒå°†ä¸€ç›´ç­‰å¾…ï¼ˆå³è¢«é˜»æ­¢ï¼‰ï¼Œç›´åˆ°è¯¥å¯¹è±¡è¢«é‡Šæ”¾ã€‚ åŒæ­¥äº‹ä»¶å’Œç­‰å¾…å¥æŸ„ä½¿ç”¨é”æˆ–ç›‘è§†å™¨å¯¹äºé˜²æ­¢åŒæ—¶æ‰§è¡ŒåŒºåˆ†çº¿ç¨‹çš„ä»£ç å—å¾ˆæœ‰ç”¨ï¼Œä½†æ˜¯è¿™äº›æ„é€ ä¸å…è®¸ä¸€ä¸ªçº¿ç¨‹å‘å¦ä¸€ä¸ªçº¿ç¨‹ä¼ è¾¾äº‹ä»¶ã€‚è¿™éœ€è¦â€œåŒæ­¥äº‹ä»¶â€ï¼Œå®ƒæ˜¯æœ‰ä¸¤ä¸ªçŠ¶æ€ï¼ˆç»ˆæ­¢å’Œéç»ˆæ­¢ï¼‰çš„å¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥æ¿€æ´»å’ŒæŒ‚èµ·çº¿ç¨‹ã€‚è®©çº¿ç¨‹ç­‰å¾…éç»ˆæ­¢çš„åŒæ­¥äº‹ä»¶å¯ä»¥å°†çº¿ç¨‹æŒ‚èµ·ï¼Œå°†äº‹ä»¶çŠ¶æ€æ›´æ”¹ä¸ºç»ˆæ­¢å¯ä»¥å°†çº¿ç¨‹æ¿€æ´»ã€‚å¦‚æœçº¿ç¨‹è¯•å›¾ç­‰å¾…å·²ç»ç»ˆæ­¢çš„äº‹ä»¶ï¼Œåˆ™çº¿ç¨‹å°†ç»§ç»­æ‰§è¡Œï¼Œè€Œä¸ä¼šå»¶è¿Ÿã€‚ åŒæ­¥äº‹ä»¶æœ‰ä¸¤ç§ï¼šAutoResetEvent å’Œ ManualResetEventã€‚å®ƒä»¬ä¹‹é—´å”¯ä¸€çš„ä¸åŒåœ¨äºï¼Œæ— è®ºä½•æ—¶ï¼Œåªè¦ AutoResetEvent æ¿€æ´»çº¿ç¨‹ï¼Œå®ƒçš„çŠ¶æ€å°†è‡ªåŠ¨ä»ç»ˆæ­¢å˜ä¸ºéç»ˆæ­¢ã€‚ç›¸åï¼ŒManualResetEvent å…è®¸å®ƒçš„ç»ˆæ­¢çŠ¶æ€æ¿€æ´»ä»»æ„å¤šä¸ªçº¿ç¨‹ï¼Œåªæœ‰å½“å®ƒçš„ Reset æ–¹æ³•è¢«è°ƒç”¨æ—¶æ‰è¿˜åŸåˆ°éç»ˆæ­¢çŠ¶æ€ã€‚ ç­‰å¾…å¥æŸ„ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ä¸€ç§ç­‰å¾…æ–¹æ³•ï¼Œå¦‚WaitOneã€WaitAny æˆ– WaitAllï¼Œè®©çº¿ç¨‹ç­‰å¾…äº‹ä»¶ã€‚System.Threading.WaitHandle.WaitOneä½¿çº¿ç¨‹ä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°å•ä¸ªäº‹ä»¶å˜ä¸ºç»ˆæ­¢çŠ¶æ€ï¼›System.Threading.WaitHandle.WaitAny é˜»æ­¢çº¿ç¨‹ï¼Œç›´åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ç¤ºçš„äº‹ä»¶å˜ä¸ºç»ˆæ­¢çŠ¶æ€ï¼›System.Threading.WaitHandle.WaitAll é˜»æ­¢çº¿ç¨‹ï¼Œç›´åˆ°æ‰€æœ‰æŒ‡ç¤ºçš„äº‹ä»¶éƒ½å˜ä¸ºç»ˆæ­¢çŠ¶æ€ã€‚å½“è°ƒç”¨äº‹ä»¶çš„ Set æ–¹æ³•æ—¶ï¼Œäº‹ä»¶å°†å˜ä¸ºç»ˆæ­¢çŠ¶æ€ã€‚ AutoResetEvent å…è®¸çº¿ç¨‹é€šè¿‡å‘ä¿¡å·äº’ç›¸é€šä¿¡ã€‚ é€šå¸¸ï¼Œå½“çº¿ç¨‹éœ€è¦ç‹¬å è®¿é—®èµ„æºæ—¶ä½¿ç”¨è¯¥ç±»ã€‚çº¿ç¨‹é€šè¿‡è°ƒç”¨ AutoResetEvent ä¸Šçš„ WaitOne æ¥ç­‰å¾…ä¿¡å·ã€‚ å¦‚æœ AutoResetEvent ä¸ºéç»ˆæ­¢çŠ¶æ€ï¼Œåˆ™çº¿ç¨‹ä¼šè¢«é˜»æ­¢ï¼Œå¹¶ç­‰å¾…å½“å‰æ§åˆ¶èµ„æºçš„çº¿ç¨‹é€šè¿‡è°ƒç”¨ Set æ¥é€šçŸ¥èµ„æºå¯ç”¨ã€‚è°ƒç”¨ Set å‘ AutoResetEvent å‘ä¿¡å·ä»¥é‡Šæ”¾ç­‰å¾…çº¿ç¨‹ã€‚ AutoResetEvent å°†ä¿æŒç»ˆæ­¢çŠ¶æ€ï¼Œç›´åˆ°ä¸€ä¸ªæ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹è¢«é‡Šæ”¾ï¼Œç„¶åè‡ªåŠ¨è¿”å›éç»ˆæ­¢çŠ¶æ€ã€‚ å¦‚æœæ²¡æœ‰ä»»ä½•çº¿ç¨‹åœ¨ç­‰å¾…ï¼Œåˆ™çŠ¶æ€å°†æ— é™æœŸåœ°ä¿æŒä¸ºç»ˆæ­¢çŠ¶æ€ã€‚å¦‚æœå½“ AutoResetEvent ä¸ºç»ˆæ­¢çŠ¶æ€æ—¶çº¿ç¨‹è°ƒç”¨ WaitOneï¼Œåˆ™çº¿ç¨‹ä¸ä¼šè¢«é˜»æ­¢ã€‚ AutoResetEvent å°†ç«‹å³é‡Šæ”¾çº¿ç¨‹å¹¶è¿”å›åˆ°éç»ˆæ­¢çŠ¶æ€ã€‚å¯ä»¥é€šè¿‡å°†ä¸€ä¸ªå¸ƒå°”å€¼ä¼ é€’ç»™æ„é€ å‡½æ•°æ¥æ§åˆ¶ AutoResetEvent çš„åˆå§‹çŠ¶æ€ï¼šå¦‚æœåˆå§‹çŠ¶æ€ä¸ºç»ˆæ­¢çŠ¶æ€ï¼Œåˆ™ä¸º trueï¼›å¦åˆ™ä¸º falseã€‚AutoResetEvent ä¹Ÿå¯ä»¥åŒ staticWaitAll å’Œ WaitAny æ–¹æ³•ä¸€èµ·ä½¿ç”¨ã€‚ WaitHandle.WaitOne()é˜»æ­¢å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°å½“å‰çš„ WaitHandle æ”¶åˆ°ä¿¡å·ä¸ºæ­¢ EventWaitHandle.Set()å°†äº‹ä»¶çŠ¶æ€è®¾ç½®ä¸ºæœ‰ä¿¡å·ï¼Œä»è€Œå…è®¸ä¸€ä¸ªæˆ–å¤šä¸ªç­‰å¾…çº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚]]></content>
      <tags>
        <tag>CSharp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ‰˜ç®¡ä»£ç å’Œéæ‰˜ç®¡ä»£ç ]]></title>
    <url>%2F2018%2F04%2F11%2Fmanaged-code-unmanaged-code%2F</url>
    <content type="text"><![CDATA[æ‰˜ç®¡ä»£ç æ˜¯-Microsoftçš„ä¸­é—´è¯­è¨€(IL)ï¼Œä»–ä¸»è¦ä½œç”¨æ˜¯åœ¨.Net FRAMEWORKçš„å…¬å…±è¯­è¨€è¿è¡Œåº“(CLR)æ‰§è¡Œä»£ç å‰å»ç¼–è¯‘æºä»£ç ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰˜ç®¡ä»£ç å……å½“ç€ç¿»è¯‘çš„ä½œç”¨ï¼Œæºä»£ç åœ¨è¿è¡Œæ—¶åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š æºä»£ç ç¼–è¯‘ä¸ºæ‰˜ç®¡ä»£ç ï¼Œ(æ‰€ä»¥æºä»£ç å¯ä»¥æœ‰å¾ˆå¤šç§ï¼Œå¦‚VB,C#,J#) æ‰˜ç®¡ä»£ç ç¼–è¯‘ä¸ºMicrosoftçš„å¹³å°ä¸“ç”¨è¯­è¨€ ç¼–è¯‘å™¨æŠŠä»£ç ç¼–è¯‘æˆä¸­é—´è¯­è¨€(IL),è€Œä¸æ˜¯èƒ½åœ¨ä½ çš„ç”µè„‘ä¸Šè¿è¡Œçš„æœºå™¨ç ã€‚ä¸­é—´è¯­è¨€è¢«å°è£…åœ¨ä¸€ä¸ªå«ç¨‹åºé›†(Assembly)çš„æ–‡ä»¶ä¸­ï¼Œç¨‹åºé›†ä¸­åŒ…å«äº†æè¿°ä½ æ‰€åˆ›å»ºçš„ç±»ï¼Œæ–¹æ³•å’Œå±æ€§(ä¾‹å¦‚å®‰å…¨éœ€æ±‚)çš„æ‰€æœ‰å…ƒæ•°æ®ã€‚ä½ å¯ä»¥æ‹·è´è¿™ä¸ªç¨‹åºé›†åˆ°å¦ä¸€å°æœåŠ¡å™¨ä¸Šéƒ¨ç½²å®ƒã€‚ æ‰˜ç®¡ä»£ç åœ¨å…¬å…±è¯­è¨€è¿è¡Œåº“(CLR)ä¸­è¿è¡Œã€‚è¿™ä¸ªè¿è¡Œåº“ç»™ä½ çš„è¿è¡Œä»£ç æä¾›å„ç§å„æ ·çš„æœåŠ¡ï¼Œé€šå¸¸æ¥è¯´ï¼Œä»–ä¼šåŠ è½½å’ŒéªŒè¯ç¨‹åºé›†ï¼Œä»¥æ­¤æ¥ä¿è¯ä¸­é—´è¯­è¨€çš„æ­£ç¡®æ€§ æ‰˜ç®¡ä»£ç æ˜¯ä¸€ç§ä¸­é—´è¯­è¨€ï¼Œè¿è¡Œåœ¨CLRä¸Šï¼›éæ‰˜ç®¡ä»£ç è¢«ç¼–è¯‘ä¸ºæœºå™¨ç ï¼Œè¿è¡Œåœ¨æœºå™¨ä¸Š æ‰˜ç®¡ä»£ç ç‹¬ç«‹äºå¹³å°å’Œè¯­è¨€ï¼Œèƒ½æ›´å¥½çš„å®ç°ä¸åŒè¯­è¨€å¹³å°ä¹‹é—´çš„å…¼å®¹ï¼›éæ‰˜ç®¡ä»£ç ä¾èµ–äºå¹³å°å’Œè¯­è¨€ã€‚ æ‰˜ç®¡ä»£ç å¯äº«å—CLRæä¾›çš„æœåŠ¡ï¼ˆå¦‚å®‰å…¨æ£€æµ‹ï¼Œåƒåœ¾å›æ”¶ï¼‰ï¼Œä¸éœ€è¦è‡ªå·±å®Œæˆè¿™äº›æ“ä½œéæ‰˜ç®¡ä»£ç éœ€è¦è‡ªå·±æä¾›å®‰å…¨æ£€æµ‹ã€åƒåœ¾å›æ”¶ç­‰æ“ä½œã€‚]]></content>
      <tags>
        <tag>C#</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[UnityåŠ è½½å’Œå†…å­˜ç®¡ç†]]></title>
    <url>%2F2018%2F04%2F11%2FAssetBundle%2F</url>
    <content type="text"><![CDATA[Unityæœ‰ä¸¤ç§åŠ¨æ€åŠ è½½æœºåˆ¶ï¼šResources.Loadå’ŒAssetBundleï¼ŒäºŒè€…æœ¬è´¨å¹¶æ— åŒºåˆ«ã€‚Resources.Loadå°±æ˜¯ä»ä¸€ä¸ªç¼ºçœæ‰“è¿›ç¨‹ç¨‹åºåŒ…çš„AssetBundle(Resourece)é‡ŒåŠ è½½èµ„æºï¼Œè€Œä¸€èˆ¬AssetBundleæ–‡ä»¶éœ€è¦ä½ è‡ªå·±åˆ›å»ºï¼Œè¿è¡Œæ—¶åŠ è½½ã€‚ AssetBundleåŠ è½½åŸºç¡€é€šè¿‡AssetBunldeåŠ è½½èµ„æºï¼Œåˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯è·å–AssetBundleå¯¹è±¡ï¼Œç¬¬äºŒæ­¥æ˜¯é€šè¿‡è¯¥å¯¹è±¡åŠ è½½éœ€è¦çš„èµ„æºã€‚è€Œç¬¬ä¸€æ­¥åˆåˆ†ä¸ºä¸¤ç§æ–¹å¼ï¼Œä¸‹æ–‡ä¸­å°†ç»“åˆå¸¸ç”¨çš„APIè¿›è¡Œè¯¦ç»†åœ°æè¿°ã€‚ ç¬¬ä¸€æ­¥ï¼Œè·å–AssetBundleå¯¹è±¡å¸¸ç”¨åœ°APIæ–¹å¼ä¸€ï¼Œå…ˆè·å–WWWå¯¹è±¡ï¼Œå†é€šè¿‡WWW.assetBundleè·å–AssetBundleå¯¹è±¡ï¼špublic WWW(string uri); åŠ è½½Bundleæ–‡ä»¶å¹¶è·å–WWWå¯¹è±¡ï¼Œå®Œæˆåä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºè¾ƒå¤§åœ°WebStream(è§£å‹åçš„å†…å®¹ï¼Œé€šå¸¸ä¸ºåŸBundleæ–‡ä»¶çš„4~5å€å¤§å°ï¼Œçº¹ç†èµ„æºæ¯”ä¾‹å¯èƒ½æ›´å¤§),å› æ­¤åç»­çš„AssetBundle.Loadå¯ä»¥ç›´æ¥åœ¨å†…å­˜ä¸­è¿›è¡Œã€‚ public static WWW LoadFromCacheOrDownload(string uri, int version, unit crc = 0); åŠ è½½Bundleæ–‡ä»¶å¹¶è·å–WWWå¯¹è±¡ï¼ŒåŒæ—¶å°†è§£å‹å½¢å¼çš„Bundleå†…å®¹å­˜å…¥ç£ç›˜ä¸­ä½œä¸ºç¼“å­˜ï¼ˆå¦‚æœè¯¥Bundleå·²åœ¨ç¼“å­˜ä¸­ï¼Œåˆ™çœå»è¿™ä¸€æ­¥ï¼‰ï¼Œå®Œæˆååªä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºè¾ƒå°çš„SerializedFileï¼Œè€Œåç»­çš„AssetBundle.Loadéœ€è¦é€šè¿‡IOä»ç£ç›˜ä¸­çš„ç¼“å­˜è·å–ã€‚ public AssetBundle assetBundle; é€šè¿‡ä¹‹å‰ä¸¤ä¸ªæ¥å£è·å–WWWå¯¹è±¡åï¼Œå³å¯é€šè¿‡WWW.assetBundleè·å–AssetBundleå¯¹è±¡ã€‚ æ–¹å¼äºŒï¼Œç›´æ¥è·å–AssetBundle:public static AssetBundle LoadFromFile(string path); public static AssetBundle LoadFromFileAsync(string path); é€šè¿‡æœªå‹ç¼©çš„Bundleæ–‡ä»¶ï¼ŒåŒæ­¥åˆ›å»ºAssetBundleå¯¹è±¡ï¼Œè¿™æ˜¯æœ€å¿«çš„æ–¹å¼ã€‚åˆ›å»ºå®Œæˆååªä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºè¾ƒå°çš„SerializedFileï¼Œè€Œåç»­çš„AssetBundle.Loadéœ€è¦é€šè¿‡IOä»ç£ç›˜ä¸­è·å–ã€‚å¦‚æœAssetBundleæ˜¯æœªå‹ç¼©ï¼Œæˆ–è€…æ˜¯æ•°æ®å—å½¢å¼ï¼ˆLZ4ç®—æ³•å‹ç¼©ï¼‰çš„ï¼ŒLoadFromFileå°†ä»ç£ç›˜ä¸­ç›´æ¥åŠ è½½å®ƒã€‚å¦‚æœAssetBundleæ˜¯é«˜åº¦å‹ç¼©(LZMAç®—æ³•å‹ç¼©)çš„ï¼Œå†å°†å®ƒåŠ è½½è¿›å…¥å†…å­˜å‰ï¼Œä¼šé¦–å…ˆå°†å®ƒè§£å‹ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667void LoadAssetBundles(string baseDir)&#123; if (assetBundleInfos != null) &#123; for (int i = 0; i &lt; assetBundleInfos.Length; i++) &#123; var bInfo = assetBundleInfos[i]; if (bInfo.assetBundle != null) &#123; bInfo.assetBundle.Unload(false); &#125; &#125; assetBundleInfos = null; &#125; var abInfos = new List&lt;AssetBundleInfo&gt;(50); var files = Directory.GetFiles(m_dir_update, "*.bytes"); for (int i = 0; i &lt; files.Length; i++) &#123; string f = files[i]; string n = Path.GetFileName(f); if (!CheckABName(abInfos, n)) contine; abInfos.Add(new AssetBundleInfo&#123;name = n, uri = f&#125;); &#125; if (baseDir != null) &#123; files = Directory.GetFiles(baseDir, "*.bytes"); for (int i = 0; i &lt; files.Length; i++) &#123; string f = files[i]; string n = Path.GetFileName(f); if (!CheckABName(abInfos, n)) continue; abInfos.Add(new AssetBundleInfo&#123;name = n, uri = f&#125;); &#125; &#125; files = LoadConfigLines("res_idx"); for (int i = 0; i &lt; files.Length; i++) &#123; string n = files[i].Trim(); if (!CheckABName(abInfos, n)) continue; string f = streamAssetsPath + n; abInfos.Add(new AssetBundleInfo&#123;name = n, uri = f&#125;); &#125; if (abInfos.Count == 0) return; string prefix = "assets/res/"; int cprefix = prefix.Length; for (int i = 0; i &lt; abInfos.Count;) &#123; var abInfo = abInfos[i]; var ab = AssetBundle.LoadFromFile(abInfo.uri); if (ab == null) &#123; abInfos.RemoveAt(i); sbError.Append("\nfail ab : "); sbError.Append(abInfo) &#125; &#125;&#125; public static AssetBundle LoadFromMemory(byte[] binary) é€šè¿‡Bundleçš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå¼‚æ­¥åˆ›å»ºAssetBundleå¯¹è±¡ï¼Œå®Œæˆåä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºè¾ƒå¤§çš„WebStreamã€‚è°ƒç”¨æ—¶ï¼ŒBundleçš„è§£å‹æ˜¯å¼‚æ­¥è¿›è¡Œçš„ï¼Œå› æ­¤å¯¹äºæœªå‹ç¼©çš„Bundleæ–‡ä»¶ï¼Œè¯¥æ¥å£äºLoadFromMemoryAsyncæ˜¯ç­‰ä»·çš„ã€‚ public static AssetBundle LoadFromMemoryAsync è¯¥æ¥å£æ˜¯ CreateFromMemory çš„åŒæ­¥ç‰ˆæœ¬ï¼Œè¿™ä¸ªæ–¹æ³•çš„å‚æ•°æ˜¯åŒ…å«äº†AssetBundleæ•°æ®çš„å­—èŠ‚æ•°ç»„ã€‚å¦‚æœéœ€è¦çš„è¯ï¼Œä½ è¿˜å¯ä»¥ä¼ å…¥ä¸€ä¸ªCRC(å¾ªç¯å†—ä½™æ ¡éªŒç )å‚æ•°ã€‚å¦‚æœAssetBundleä½¿ç”¨äº†LZMAç®—æ³•å‹ç¼©ï¼Œé‚£ä¹ˆAssetBundleåœ¨åŠ è½½çš„æ—¶å€™ä¼šè¢«è§£å‹ã€‚å¦‚æœAssetBundleä½¿ç”¨äº†LZ4ç®—æ³•å‹ç¼©ï¼Œå®ƒå°†ç›´æ¥ä»¥å‹ç¼©å½¢å¼è¢«åŠ è½½ã€‚ 12345678IEnumerator LoadFromMemoryAsync(string path)&#123; AssetBundleCreateRequest createRequest = AssetBundle.LoadFromMemoryAsync(File.ReadAllBytes(path)); yield return createRequest; AssetBundle bundle = createRequest.assetBundle; var prefab = bundle.LoadAsset&lt;GameObject&gt;("MyObject"); Instantiate(prefab);&#125; ç¬¬äºŒæ­¥ï¼Œä»AssetBundleåŠ è½½èµ„æºçš„å¸¸ç”¨APIpublic Object Load(string name, Type type); é€šè¿‡ç»™å®šçš„åå­—å’Œèµ„æºç±»å‹ï¼ŒåŠ è½½èµ„æºã€‚åŠ è½½æ—¶ä¼šè‡ªåŠ¨åŠ è½½å…¶ä¾èµ–çš„èµ„æºï¼Œå³Loadä¸€ä¸ªPrefabæ—¶ï¼Œä¼šè‡ªåŠ¨Loadå…¶å¼•ç”¨çš„Textureèµ„æºã€‚ public Object[] LoadAll(Type type); public AssetBundleRequest LoadAllAssetsAsync(); ä¸€æ¬¡æ€§åŠ è½½Bundleä¸­ç»™å®šèµ„æºç±»å‹çš„æ‰€æœ‰èµ„æº public AssetBundleRequest LoadAsync(string name, Type type) AssetBundleçš„å‹ç¼©ç±»å‹Unity3Då¼•æ“ä¸ºæˆ‘ä»¬æä¾›äº†ä¸‰ç§å‹ç¼©ç­–ç•¥æ¥å¤„ç†AssetBundleçš„å‹ç¼©ï¼Œå³ï¼š LZMAæ ¼å¼ LZ4æ ¼å¼ ä¸å‹ç¼© LZ4æ˜¯å—å‹ç¼©(chunk-based)ï¼ŒLZMAæ˜¯æµå‹ç¼©(stream-based)ã€‚æµå‹ç¼©(LZMA)åœ¨å¤„ç†æ•´ä¸ªæ•°æ®å—æ—¶ä½¿ç”¨åŒä¸€ä¸ªå­—å…¸ï¼Œå®ƒæä¾›äº†æœ€å¤§å¯èƒ½çš„å‹ç¼©ç‡ä½†åªæ”¯æŒé¡ºåºè¯»å–ã€‚å—å‹ç¼©(LZ4)æŒ‡çš„æ˜¯åŸå§‹æ•°æ®è¢«åˆ†æˆå¤§å°ç›¸åŒçš„å­å—å¹¶å•ç«¯å‹ç¼©ã€‚å¦‚æœä½ æƒ³è¦å®æ—¶è§£å‹/éšæœºè¯»å–å¼€é”€å°ï¼Œåˆ™åº”è¯¥ä½¿ç”¨è¿™ç§ã€‚ LZMAå‹ç¼©æ–¹å¼çš„ä¼˜ç‚¹åœ¨äºä½¿ç”¨åŒä¸€ä¸ªå­—å…¸å‹ç¼©ç‡è¾ƒé«˜ï¼Œä½†åªèƒ½é¡ºåºè¯»å–æ„å‘³ç€åŠ è½½ä»»æ„ä¸€ä¸ªèµ„æºæ—¶ï¼Œéƒ½éœ€è¦å°†æ•´ä¸ªAssetBundleè§£å‹ï¼Œé€ æˆå¡é¡¿å’Œé¢å¤–å†…å­˜å ç”¨ã€‚LZ4åŸºäºå¿«å‹ç¼©ç‡è¾ƒä½ï¼ˆæµ‹è¯•LZMAæ¢LZ4ï¼š86.9M-&gt;108Mï¼‰ï¼Œä½†åªéœ€è§£å‹éœ€è¦å—å³å¯ï¼Œä¸ä¼šæœ‰å¤§çš„å¡é¡¿å’Œé¢å¤–å†…å­˜å ç”¨ã€‚ LZMA(stream-based)åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰“åŒ…ç”Ÿæˆçš„AssetBundleéƒ½ä¼šè¢«å‹ç¼©ã€‚åœ¨U3Dä¸­ï¼ŒAssetBundleçš„æ ‡å‡†å‹ç¼©æ ¼å¼ä¾¿æ˜¯LZMAï¼ˆLZMAæ˜¯ä¸€ç§åºåˆ—åŒ–æµæ–‡ä»¶ï¼‰ï¼Œå› æ­¤åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰“å‡ºçš„AssetBundleåŒ…å¤„äºLZMAæ ¼å¼çš„å‹ç¼©çŠ¶æ€ã€‚ LZ4(chunk-based)Unity 5.3ä¹‹åçš„ç‰ˆæœ¬å¢åŠ äº†LZ4æ ¼å¼å‹ç¼©ï¼Œæ˜¯ä¸€ç§å—å‹ç¼©æ–¹å¼ï¼Œç”±äºLZ4çš„å‹ç¼©æ¯”ä¸€èˆ¬ï¼Œå› æ­¤ç»è¿‡å‹ç¼©ä¹‹åçš„AssetBundleåŒ…ä½“çš„ä½“ç§¯è¾ƒå¤§ï¼ˆè¯¥ç®—æ³•åŸºäºchunkï¼‰ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨LZ4æ ¼å¼çš„å¥½å¤„åœ¨äºè§£å‹ç¼©çš„æ—¶é—´ç›¸å¯¹è¦çŸ­ã€‚ ä½¿ç”¨LZ4æ ¼å¼å‹ç¼©ï¼Œéœ€è¦æ‰“åŒ…è®¾ç½® BuildPipeline.BuildAssetBundles(Application.streamingAssetPath, BuildAssetBundleOptions.ChunkBasedCompression); ä¸å‹ç¼©å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸å¯¹AssetBundleè¿›è¡Œå‹ç¼©ã€‚æ²¡æœ‰ç»è¿‡å‹ç¼©çš„èƒä½“ç³»æœ€å¤§ï¼Œä½†æ˜¯è®¿é—®é€Ÿåº¦æœ€å¿«ã€‚ è‹¥è¦ä½¿ç”¨ä¸å‹ç¼©çš„ç­–ç•¥ï¼Œåªéœ€è¦åœ¨æ‰“åŒ…çš„æ—¶å€™å¼€å¯ BuildPipeline.BuildAsetBundles(Application.streamingAssetPath, BuildAssetBundleOptions.UncompressedAssetBundle); äº” AssetBundleåŸç†åˆ†æ5.2 AssetBundleåŠAssetsçš„å¸è½½åœ¨AssetBundleçš„ä¸‹è½½å’ŒåŠ è½½è¿‡ç¨‹ä¸­ï¼Œä»¥åŠAssetsåŠ è½½å’Œå®ä¾‹åŒ–è¿‡ç¨‹ä¸­ï¼ŒAssetBundleä»¥åŠåŠ è½½çš„Assetséƒ½ä¼šå ç”¨å†…å­˜ã€‚ AssetBundleçš„å¸è½½é‡‡ç”¨Assetbundle.Unload(bool)æ¥å£ã€‚ Assetsçš„å¸è½½æœ‰ä¸¤ç§æ–¹å¼: AssetBundle.Unload(true); // è¿™ä¼šå¼ºåˆ¶å¸è½½æ‰æ‰€æœ‰ä»AssetBundleåŠ è½½çš„Assetsã€‚ Resource.UnloadUnusedAssets()å’ŒResources.UnloadAssetã€‚è¿™ä¼šå¸è½½æ‰æ‰€æœ‰æ²¡æœ‰ç”¨åˆ°çš„Assetsã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥æ¥å£ä½œç”¨äºæ•´ä¸ªç³»ç»Ÿï¼Œè€Œä¸ä»…ä»…æ˜¯å½“å‰çš„AssetBundleï¼Œè€Œä¸”ä¸ä¼šå¸è½½ä»å½“å‰AssetBundleæ–‡ä»¶ä¸­åŠ è½½å¹¶ä»åœ¨ä½¿ç”¨çš„Assetsã€‚ å¯¹äºå®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨GameObject.Destroyæ´»GameObject.DestroyImmediateã€‚æ³¨æ„çš„æ˜¯ï¼šå®˜æ–¹è¯´æ³•æ˜¯è¿™æ ·çš„ï¼Œå¦‚æœä½¿ç”¨GameObject.Destroyæ¥å£ï¼ŒUnityä¼šå°†çœŸæ­£çš„åˆ é™¤æ“ä½œå»¶ååˆ°ä¸€ä¸ªåˆé€‚çš„æ—¶æœºç»Ÿä¸€è¿›è¡Œå¤„ç†ï¼Œä½†ä¼šåœ¨æ¸²æŸ“ä¹‹å‰ã€‚ å¯¹äºWWWå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨www=nullæˆ–www.disposeã€‚è¿™ä¸¤è€…æ˜¯ç”±åŒºåˆ«çš„ï¼Œwww=nullä¸ä¼šç«‹å³é‡Šæ”¾å†…å­˜ï¼Œè€Œæ˜¯ç³»ç»Ÿè‡ªåŠ¨å›æ”¶æœºåˆ¶å¯åŠ¨æ—¶å›æ”¶ã€‚www.disposeåˆ™ä¼šç«‹å³è°ƒç”¨ç³»ç»Ÿçš„å›æ”¶æœºåˆ¶æ¥é‡Šæ”¾å†…å­˜ã€‚å½“WWWå¯¹è±¡è¢«é‡Šæ”¾åï¼Œå…¶å¯¹äºWeb Streamæ•°æ®çš„å¼•ç”¨è®¡æ•°ä¹Ÿä¼šç›¸åº”å‡1ã€‚ å¯¹äºWeb Streamæ•°æ®ï¼Œå®ƒæ‰€å ç”¨çš„å†…å­˜ä¼šåœ¨å…¶å¼•ç”¨è®¡æ•°ä¸º0æ—¶ï¼Œè¢«ç³»ç»Ÿè‡ªåŠ¨å›æ”¶ã€‚ä¾‹å¦‚ï¼šå½“ä¸Šå›¾ä¸­çš„AssetBundleå¯¹è±¡å’ŒWWWå¯¹è±¡è¢«é‡Šæ”¾åï¼ŒWeb Streamæ•°æ®æ‰€å å†…å­˜ä¹Ÿä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨å›æ”¶ã€‚ AssetBundleä¾èµ–åŠ è½½å¦‚æœä¸€ä¸ªæˆ–è€…å¤šä¸ªUnityEngine.Objectså¼•ç”¨äº†å…¶ä»–AssetBundleä¸­çš„UnityEngine.Objectï¼Œé‚£ä¹ˆAssetBundleä¹‹é—´å°±äº§ç”Ÿäº†ä¾èµ–å…³ç³»äº†ã€‚å¦‚æœUnityEngine.ObjectAæ‰€å¼•ç”¨çš„UnityEngine.ObjectBä¸æ˜¯å…¶ä»–çš„AssetBundleä¸­çš„ï¼Œé‚£ä¹ˆä¾èµ–å°±ä¸ä¼šäº§ç”Ÿã€‚å¦‚æœäº§ç”Ÿä¾èµ–ï¼Œè¢«ä¾èµ–å¯¹è±¡(UnityEngine.ObjectB)å°†è¢«æ‹·è´è¿›ä½ åˆ›å»ºçš„AssetBundle(æŒ‡åŒ…å«UnityEngine.ObjectAçš„AssetBundle) æ›´è¿‘ä¸€æ­¥ï¼Œå¦‚æœæœ‰å¤šä¸ªå¯¹è±¡(UnityEngine.ObjectA1ã€UnityEngine.ObjectA2ã€UnityEngine.ObjectA3â€¦)å¼•ç”¨äº†åŒä¸€ä¸ªè¢«ä¾èµ–å¯¹è±¡(UnityEngine.ObjectB)ï¼Œé‚£ä¹ˆè¢«ä¾èµ–å¯¹è±¡å°†è¢«æ‹·è´å¤šä»½ï¼Œæ‰“åŒ…è¿›å„ä¸ªå¯¹è±¡å„è‡ªçš„AssetBundleã€‚ å¦‚æœä¸€ä¸ªAssetBundleå­˜åœ¨ä¾èµ–æ€§ï¼Œé‚£ä¹ˆè¦æ³¨æ„çš„æ˜¯ï¼Œé‚£äº›åŒ…å«äº†è¢«ä¾èµ–å¯¹è±¡çš„AssetBundlesï¼Œéœ€è¦åœ¨ä½ æƒ³è¦å®ä¾‹åŒ–çš„å¯¹è±¡çš„åŠ è½½ä¹‹å‰åŠ è½½ã€‚Unityä¸ä¼šè‡ªåŠ¨å¸®ä½ åŠ è½½è¿™äº›ä¾èµ–ã€‚]]></content>
      <tags>
        <tag>Unity3D</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity3Dç¬”è®°]]></title>
    <url>%2F2018%2F04%2F11%2FUnity-Note%2F</url>
    <content type="text"><![CDATA[åœ¨Updateä¸­ä½¿ç”¨Time.deltaTimeï¼Œè·å–åˆ°çš„æ˜¯è¿™ä¸€å¸§çš„æ—¶é—´ï¼Œå¦‚æœæ¸¸æˆå¡ï¼Œå¸§ç‡ä½ï¼Œé‚£è¿™ä¸ªå€¼å°±å¤§ã€‚å¦‚æœæ¸¸æˆæµç•…ï¼Œå¸§ç‡é«˜ï¼Œè¿™ä¸ªå€¼å°±å°ï¼ŒTime.deltaTime=1.0f/å¸§ç‡ 1ã€MonoBehaviour.Update æ›´æ–°æ¸²æŸ“å¸§å½“MonoBehaviourå¯ç”¨æ—¶ï¼Œå…¶Updateåœ¨æ¯ä¸€å¸§è¢«è°ƒç”¨ã€‚ 2ã€MonoBehaviour.FixedUpdate å›ºå®šæ›´æ–°é€»è¾‘å¸§å½“MonoBehaviourå¯ç”¨æ—¶ï¼Œå…¶ FixedUpdateåœ¨æ¯ä¸€å¸§è¢«è°ƒç”¨ã€‚å¤„ç†Rigidbodyæ—¶ï¼Œéœ€è¦ç”¨FixedUpdateä»£æ›¿Updateã€‚ä¾‹å¦‚ï¼šç»™åˆšä½“åŠ ä¸€ä¸ªä½œç”¨åŠ›æ—¶ï¼Œä½ å¿…é¡»åº”ç”¨ä½œç”¨åŠ›åœ¨FixedUpdateé‡Œçš„å›ºå®šå¸§ï¼Œè€Œä¸æ˜¯Updateä¸­çš„å¸§(ä¸¤è€…å¸§é•¿ä¸åŒ)ã€‚ 3ã€MonoBehaviour.LateUpdate æ™šäºæ›´æ–°æ¸²æŸ“å¸§æœ«å°¾å½“Behaviourå¯ç”¨æ—¶ï¼Œå…¶LateUpdateåœ¨æ¯ä¸€å¸§è¢«è°ƒç”¨ã€‚LateUpdateæ˜¯åœ¨æ‰€æœ‰Updateå‡½æ•°è°ƒç”¨åè¢«è°ƒç”¨ã€‚è¿™å¯ç”¨äºè°ƒæ•´è„šæœ¬æ‰§è¡Œé¡ºåºã€‚ä¾‹å¦‚:å½“ç‰©ä½“åœ¨Updateé‡Œç§»åŠ¨æ—¶ï¼Œè·Ÿéšç‰©ä½“çš„ç›¸æœºå¯ä»¥åœ¨LateUpdateé‡Œå®ç°ã€‚ Updateå’ŒFixedUpdateçš„åŒºåˆ«Updateè·Ÿå½“å‰å¹³å°çš„å¸§æ•°æœ‰å…³ï¼Œè€ŒFixedUpdateæ˜¯CPU tick çš„æ—¶é—´ï¼Œæ‰€ä»¥å¤„ç†ç‰©ç†é€»è¾‘çš„æ—¶å€™è¦æŠŠä»£ç æ”¾åœ¨FixedUpdateè€Œä¸æ˜¯Updateã€‚Updateæ˜¯åœ¨æ¯æ¬¡æ¸²æŸ“æ–°çš„ä¸€å¸§çš„æ—¶å€™æ‰ä¼šè°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªå‡½æ•°çš„æ›´æ–°é¢‘ç‡å’Œè®¾å¤‡çš„æ€§èƒ½æœ‰å…³ä»¥åŠè¢«æ¸²æŸ“çš„ç‰©ä½“ï¼ˆå¯ä»¥è®¤ä¸ºæ˜¯ä¸‰è§’å½¢çš„æ•°é‡ï¼‰ã€‚åœ¨æ€§èƒ½å¥½çš„æœºå™¨ä¸Šå¯èƒ½fps 30ï¼Œå·®çš„å¯èƒ½å°äº›ã€‚è¿™ä¼šå¯¼è‡´åŒä¸€ä¸ªæ¸¸æˆåœ¨ä¸åŒçš„æœºå™¨ä¸Šæ•ˆæœä¸ä¸€è‡´ï¼Œæœ‰çš„å¿«æœ‰çš„æ…¢ã€‚å› ä¸ºUpdateçš„æ‰§è¡Œé—´éš”ä¸ä¸€æ ·äº†ã€‚è€ŒFixedUpdateï¼Œæ˜¯åœ¨å›ºå®šçš„æ—¶é—´é—´éš”æ‰§è¡Œï¼Œä¸å—æ¸¸æˆå¸§ç‡çš„å½±å“ã€‚æœ‰ç‚¹åƒTickã€‚æ‰€ä»¥å¤„ç†Rigidbodyçš„æ—¶å€™æœ€å¥½ç”¨FixedUpdateã€‚ FixedUpdateçš„æ—¶é—´é—´éš”å¯ä»¥åœ¨é¡¹ç›®è®¾ç½®ä¸­æ›´æ”¹ï¼ŒEdit-&gt;ProjectSetting-&gt;time æ‰¾åˆ°Fixedtimestepã€‚å°±å¯ä»¥ä¿®æ”¹äº†ã€‚ Updateå’ŒLateUpdateçš„åŒºåˆ«LateUpdateæ˜¯åœ¨æ‰€æœ‰Updateå‡½æ•°è°ƒç”¨åè¢«è°ƒç”¨ã€‚è¿™å¯ç”¨äºè°ƒæ•´è„šæœ¬æ‰§è¡Œé¡ºåºã€‚ä¾‹å¦‚ï¼šå½“ç‰©ä½“åœ¨Updateé‡Œç§»åŠ¨æ—¶ï¼Œè·Ÿéšç‰©ä½“çš„ç›¸æœºå¯ä»¥åœ¨LateUpdateé‡Œå®ç°ã€‚LateUpdateæ˜¯æ™šäºæ‰€æœ‰Updateæ‰§è¡Œçš„ã€‚ä¾‹å¦‚ï¼šæ¸¸æˆä¸­æœ‰2ä¸ªè„šæ­¥ï¼Œè„šæ­¥1å«æœ‰Updateå’ŒLateUpdateï¼Œè„šæ­¥2å«æœ‰Updateï¼Œé‚£ä¹ˆå½“æ¸¸æˆæ‰§è¡Œæ—¶ï¼Œæ¯ä¸€å¸§éƒ½æ˜¯æŠŠ2ä¸ªè„šæ­¥ä¸­çš„Updateæ‰§è¡Œå®Œåæ‰æ‰§è¡ŒLateUpdate ã€‚è™½ç„¶æ˜¯åœ¨åŒä¸€å¸§ä¸­æ‰§è¡Œçš„ï¼Œä½†æ˜¯Updateï¼ˆæ¸²æŸ“å¸§ï¼‰ä¼šå…ˆæ‰§è¡Œï¼ŒLateUpdateï¼ˆæ¸²æŸ“å¸§æœ«å°¾ï¼‰ä¼šæ™šæ‰§è¡Œã€‚ç°åœ¨å‡è®¾æœ‰2ä¸ªä¸åŒçš„è„šæœ¬åŒæ—¶åœ¨Updateä¸­æ§åˆ¶ä¸€ä¸ªç‰©ä½“ï¼Œé‚£ä¹ˆå½“å…¶ä¸­ä¸€ä¸ªè„šæœ¬æ”¹å˜ç‰©ä½“æ–¹ä½ã€æ—‹è½¬æˆ–è€…å…¶ä»–å‚æ•°æ—¶ï¼Œå¦ä¸€ä¸ªè„šæ­¥ä¹Ÿåœ¨æ”¹å˜è¿™äº›ä¸œè¥¿ï¼Œé‚£ä¹ˆè¿™ä¸ªç‰©ä½“çš„æ–¹ä½ã€æ—‹è½¬å°±ä¼šå‡ºç°ä¸€å®šçš„åå¤ã€‚å¦‚æœè¿˜æœ‰ä¸ªç‰©ä½“åœ¨Updateä¸­è·Ÿéšè¿™ä¸ªç‰©ä½“ç§»åŠ¨ã€æ—‹è½¬çš„è¯ï¼Œé‚£è·Ÿéšçš„ç‰©ä½“å°±ä¼šå‡ºç°æŠ–åŠ¨ã€‚ å¦‚æœæ˜¯åœ¨LateUpdateä¸­è·Ÿéšçš„è¯å°±ä¼šåªè·Ÿéšæ‰€æœ‰Updateæ‰§è¡Œå®Œåçš„æœ€åä½ç½®ã€æ—‹è½¬ï¼Œè¿™æ ·å°±é˜²æ­¢äº†æŠ–åŠ¨ã€‚ å½±å“æ¸²æŸ“é¡ºåºå› ç´ åœ°æ€»ç»“ Camrea Depth ç›¸æœºç»„ä»¶ä¸Šè®¾ç½®çš„ç›¸æœºæ·±åº¦ï¼Œæ·±åº¦è¶Šå¤§è¶Šé åæ¸²æŸ“ã€‚ Sorting Layer åœ¨Tags &amp; Layersè®¾ç½®ä¸­å¯è§ã€‚ Order In Layer ç›¸å½“äºSorting Layerçš„å­æ’åºï¼Œç”¨è¿™ä¸ªå€¼åšæ¯”è¾ƒæ—¶åªæœ‰éƒ½åœ¨åŒä¸€å±‚æ—¶æ‰æœ‰æ•ˆã€‚ RenderQueue Shaderä¸­å¯¹Tagsè®¾ç½®çš„â€Queueâ€ Camera Depthæ°¸è¿œæœ€é«˜ã€‚Camera Depthå°çš„ä¸€å®šå…ˆè¿›æ¸²æŸ“ç®¡çº¿ã€‚å½“Sorting Layerå’ŒOrder in Layerç›¸åŒæ—¶RenderQueueå°çš„å…ˆè¿›æ¸²æŸ“ç®¡çº¿ã€‚ å½“Sorting Layerå’ŒOrder In Layerä¸ç›¸åŒæ—¶ï¼å½“ä¸¤ä¸ªæè´¨ä½¿ç”¨äº†ä¸åŒçš„RenderQueue,ä¸”è¿™ä¸¤ä¸ªRenderQueueéƒ½åœ¨[0~2500]æˆ–[2501~5000]æ—¶ï¼ŒSortingLayerå’ŒOrderInLayerçš„æ’åºç”Ÿæ•ˆã€‚å½“ä¸¤ä¸ªæè´¨ä½¿ç”¨äº†ä¸åŒçš„RenderQueue,ä¸”è¿™ä¸¤ä¸ªRenderQueueåˆ†åˆ«å†[0~2500]æˆ–[2501~5000]æ—¶ï¼Œåˆ™ä¸€å®šä¼šæŒ‰ç…§RenderQueueç»˜åˆ¶ï¼Œæ— è§†SortingLayer,OrderInLayerçš„æ’åºã€‚]]></content>
      <tags>
        <tag>Unity3D</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[çº¦æŸ]]></title>
    <url>%2F2018%2F04%2F11%2Fconstraint%2F</url>
    <content type="text"><![CDATA[T:struct ç±»å‹å‚æ•°å¿…é¡»æ˜¯å€¼ç±»å‹ã€‚å¯ä»¥æŒ‡å®šé™¤Nullableä»¥å¤–çš„ä»»ä½•å€¼ç±»å‹ã€‚ T:class ç±»å‹å‚æ•°å¿…é¡»æ˜¯å¼•ç”¨ç±»å‹ï¼ŒåŒ…æ‹¬ä»»ä½•ç±»ã€æ¥å£ã€å§”æ‰˜æˆ–æ•°ç»„ç±»å‹ã€‚ T:new() ç±»å‹å‚æ•°å¿…é¡»å…·æœ‰æ— å‚æ•°çš„å…¬å…±æ„é€ å‡½æ•°ã€‚å½“ä¸å…¶ä»–çº¦æŸä¸€èµ·ä½¿ç”¨æ—¶ï¼Œnew()çº¦æŸå¿…é¡»æœ€åæŒ‡å®šã€‚ T:&lt;æ¥å£åç§°&gt; ç±»å‹å‚æ•°å¿…é¡»æ˜¯æŒ‡å®šçš„æ¥å£æˆ–å®ç°æŒ‡å®šçš„æ¥å£ã€‚å¯ä»¥æŒ‡å®šå¤šä¸ªæ¥å£çº¦æŸã€‚çº¦æŸæ¥å£ä¹Ÿå¯ä»¥æ˜¯æ³›å‹çš„ã€‚ T:U ä¸ºTæä¾›çš„ç±»å‹å‚æ•°å¿…é¡»æ˜¯ä¸ºUæä¾›çš„å‚æ•°æˆ–æ´¾ç”Ÿè‡ªä¸ºUæä¾›çš„å‚æ•°ã€‚è¿™ç§°ä¸ºèºç±»å‹çº¦æŸã€‚ public class MyGenericClass&lt;T&gt; where T:IComparable {} class MyClassy&lt;T, U&gt; where T : class where U : struct {} public class MyGenericClass&lt;T&gt; where T: IComparable, new() { T item = new T(); } 12345678910interface MyI &#123;&#125;class Dictionary&lt;TKey, TVal&gt;where TKey: IComparable, IEnumerablewhere TVal: MyI&#123; public void Add(Tkey key, TVal val) &#123; &#125;&#125; public bool MyMethod&lt;T&gt; (T t) where T: IMyInterface {} 1234567class List&lt;T&gt;&#123; void Add&lt;U&gt;(List&lt;U&gt; items) where U: T &#123; &#125;&#125; default ä¹‹æ‰€ä»¥ä¼šç”¨åˆ°defaultå…³é”®å­—ï¼Œæ˜¯å› ä¸ºéœ€è¦åœ¨ä¸çŸ¥é“ç±»å‹å‚æ•°ä¸ºå€¼ç±»å‹è¿˜æ˜¯å¼•ç”¨ç±»å‹çš„æƒ…å†µä¸‹ï¼Œä¸ºå¯¹è±¡å®ä¾‹èµ‹åˆå€¼ã€‚ ```class TestDefault{ public T foo() { return default(T); }}]]></content>
      <tags>
        <tag>C#</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[23ç§è®¾è®¡æ¨¡å¼]]></title>
    <url>%2F2018%2F04%2F11%2F23-Design-Patterns%2F</url>
    <content type="text"><![CDATA[è®¾è®¡æ¨¡å¼åˆ†ä¸ºä¸‰å¤§ç±»ï¼šåˆ›å»ºå‹æ¨¡å¼ï¼Œå…±äº”ç§ï¼šå·¥å‚æ–¹æ³•æ¨¡å¼ã€æŠ½è±¡å·¥å‚æ¨¡å¼ã€å•ä¾‹æ¨¡å¼ã€å»ºé€ è€…æ¨¡å¼ã€åŸå‹æ¨¡å¼ã€‚ç»“æ„æ€§æ¨¡å¼ï¼Œå…±ä¸ƒç§ï¼šé€‚é…å™¨æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼ã€ä»£ç†æ¨¡å¼ã€å¤–è§‚æ¨¡å¼ã€æ¡¥æ¥æ¨¡å¼ã€ç»„åˆæ¨¡å¼ã€äº«å…ƒæ¨¡å¼ã€‚è¡Œä¸ºå‹æ¨¡å¼ï¼Œå…±åä¸€ç§ï¼šç­–ç•¥æ¨¡å¼ã€æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€è¿­ä»£å­æ¨¡å¼ã€è´£ä»»é“¾æ¨¡å¼ã€å‘½ä»¤æ¨¡å¼ã€å¤‡å¿˜å½•æ¨¡å¼ã€çŠ¶æ€æ¨¡å¼ã€è®¿é—®è€…æ¨¡å¼ã€ä¸­ä»‹æ¨¡å¼ã€è§£é‡Šå™¨æ¨¡å¼ã€‚å…¶å®è¿˜æœ‰ä¸¤ç±»ï¼šå¹¶å‘å‹æ¨¡å¼å’Œçº¿ç¨‹æ± æ¨¡å¼ã€‚ è®¾è®¡æ¨¡å¼å…­å¤§åŸåˆ™ï¼šæ€»åŸåˆ™-å¼€é—­åŸåˆ™å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­ã€‚åœ¨ç¨‹åºéœ€è¦è¿›è¡Œæ‰©å±•çš„æ—¶å€™ï¼Œä¸èƒ½å»ä¿®æ”¹åŸæœ‰çš„ä»£ç ï¼Œè€Œæ˜¯æ‰©å±•åŸæœ‰ä»£ç ï¼Œå®ç°ä¸€ä¸ªçƒ­æ’æ‹”çš„æ•ˆæœã€‚æ‰€ä»¥ä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯ï¼šä¸ºäº†ä½¿ç¨‹åºçš„æ‰©å±•æ€§å¥½ï¼Œæ˜“äºç»´æŠ¤å’Œå‡çº§ã€‚æƒ³è¦è¾¾åˆ°è¿™æ ·çš„æ•ˆæœï¼Œå¤–é¢éœ€è¦ä½¿ç”¨æ¥å£å’ŒæŠ½è±¡ç±»ç­‰ï¼Œåé¢çš„å…·ä½“è®¾è®¡ä¸­æˆ‘ä»¬ä¼šæåˆ°è¿™ç‚¹ã€‚ 1ã€å•ä¸€èŒè´£åŸåˆ™ä¸è¦å­˜åœ¨å¤šä½™ä¸€ä¸ªå¯¼è‡´ç±»å˜æ›´çš„åŸå› ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªç±»åº”è¯¥å®ç°å•ä¸€çš„èŒè´£ï¼Œå¦åˆ™å°±åº”è¯¥æŠŠç±»æ‹†åˆ†ã€‚ 2.é‡Œæ°æ›¿æ¢åŸåˆ™(Liskov Substitution Principle)ä»»ä½•ç§¯ç´¯å¯ä»¥å‡ºç°çš„åœ°æ–¹ï¼Œå­ç±»ä¸€å®šå¯ä»¥å‡ºç° 6.åˆæˆå¤ç”¨åŸåˆ™(Composite Reuse Principle)å°½é‡é¦–å…ˆä½¿ç”¨åˆæˆ/èšåˆçš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç»§æ‰¿ã€‚ å•çº¿ç¨‹å•ä¾‹æ¨¡å¼12345678910111213141516171819public sealed class Singleton // å¯†å°é˜²æ­¢ç»§æ‰¿&#123; private static Singleton uniqueInstance; // å”¯ä¸€çš„å®ä¾‹ // ç§æœ‰æ„é€ å‡½æ•°å¤–éƒ¨æ— æ³•åˆ›å»ºå®ä¾‹ private Singleton() &#123; &#125; // å…¨å±€å”¯ä¸€è®¿é—®ç‚¹ public static Singleton GetInstance() &#123; if (uniqueInstance == null) &#123; uniqueInstance = new Singleton(); &#125; return uniqueInstance; &#125;&#125; å•çº¿ç¨‹å•ä¾‹æ¨¡å¼çš„å‡ ä¸ªè¦ç‚¹ï¼š Singletonæ¨¡å¼çš„å®ä¾‹æ„é€ å™¨å¯ä»¥è®¾ç½®ä¸ºprotectedä»¥å…è®¸å­ç±»æ´¾ç”Ÿã€‚ Singletonæ¨¡å¼ä¸€èˆ¬ä¸è¦ICloneableæ¥å£ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šå¯¼è‡´å¤šä¸ªå¯¹è±¡å®ä¾‹ï¼Œä¸Singletonæ¨¡å¼çš„åˆè¡·è¿èƒŒã€‚ Singletonæ¨¡å¼ä¸€èˆ¬ä¸è¦æ”¯æŒåºåˆ—åŒ–ï¼Œå› ä¸ºè¿™ä¹Ÿæœ‰å¯èƒ½å¯¼è‡´å¤šä¸ªå¯¹è±¡å®ä¾‹ï¼ŒåŒæ ·ä¸Singletonæ¨¡å¼çš„åˆè¡·è¿èƒŒã€‚ Singletonæ¨¡å¼åªè€ƒè™‘åˆ°äº†å¯¹è±¡åˆ›å»ºçš„å·¥ä½œï¼Œæ²¡æœ‰è€ƒè™‘åˆ°å¯¹è±¡æ•ˆæœçš„å·¥ä½œã€‚å…¨å±€é™æ€çš„æ”¾åˆ°æ‰˜ç®¡å †ä¸­è¿˜å¯ä»¥æ¥å—ï¼Ÿ ä¸èƒ½åº”å¯¹å¤šçº¿ç¨‹ç¯å¢ƒï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œä½¿ç”¨Singletonæ¨¡å¼ä»ç„¶æœ‰å¯èƒ½å¾—åˆ°Singletonç±»çš„å¤šä¸ªå®ä¾‹å¯¹è±¡ã€‚ å·¥å‚è®¾è®¡æ¨¡å¼ç®€å•å·¥å‚è®¾è®¡æ¨¡å¼123456789101112131415161718192021222324252627282930313233343536373839404142434445public enum FruitKind&#123; Apple, Pear,&#125;public interface Fruit&#123; void WhatIm();&#125;public class Apple : Fruit&#123; public void WhatIm() &#123; Console.WriteLine(&quot;I am Apple&quot;); &#125;&#125;public class Pear : Fruit&#123; public void WhatIm() &#123; Console.WriteLine(&quot;I am pear&quot;); &#125;&#125;public class FruitFactory&#123; public static Fruit CreateFruit(FruitKind type) &#123; switch(type) &#123; case FruitKind.Apple: return new Apple(); case FruitKind.Pear: return new Pear(); &#125; return null; &#125;&#125;class Program&#123; static void Main(string[] args) &#123; Fruit a = FruitFactory.CreateFruit(FruitKind.Pear); a.WhatIm(); &#125;&#125; ä¸å¤ªå–œæ¬¢æŸå¤±æ€§èƒ½å’Œä¸å®¹æ˜“çœ‹åˆ°å†…éƒ¨çš„é€»è¾‘ï¼Œæ‰€ä»¥ä¸Šè¿°ä¸å¤ªå–œæ¬¢ã€‚ä¸Šè¿°å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œäº§å“å†…éƒ¨éšä¾¿æŠ˜è…¾æ²¡å•¥é—®é¢˜ï¼Œä½†æ˜¯åšä¸€ä¸ªæ–°çš„äº§å“å°±è›‹ç–¼äº†ã€‚ å·¥å‚æ–¹æ³•è®¾è®¡æ¨¡å¼ æŠ½è±¡äº§å“ç±» å…·ä½“äº§å“ç±» æŠ½è±¡å·¥å‚ç±» å…·ä½“å·¥å‚ç±»12345678910111213141516171819202122232425262728293031323334public enum FruitKind&#123; Apple, Pear,&#125;public interface Fruit&#123; void WhatIm();&#125;public class Apple : Fruit&#123; public void WhatIm() &#123; Console.WriteLine(&quot;I am Apple&quot;); &#125;&#125;public class Pear : Fruit&#123; public void WhatIm() &#123; Console.WriteLine(&quot;I am pear&quot;); &#125;&#125;public interface FruitFactory&#123; Fruit CreateFruit();&#125;public class PearFactory : FruitFactory&#123; public Fruit CreateFruit() &#123; return new Apple(); &#125;&#125; ä¸Šè¿°ä»£ç è§£è€¦äº†ï¼Œ]]></content>
      <tags>
        <tag>C#</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é¢è¯•]]></title>
    <url>%2F2018%2F04%2F11%2FInterface%2F</url>
    <content type="text"><![CDATA[æ¥å£(Interface)æ˜¯ä¸€ç§è§„åˆ’ï¼Œä¸ºä½ å®šä¹‰äº†ä¸€ç³»åˆ—çš„è§„åˆ™å’Œä»»åŠ¡ï¼Œä½†ä¸å»å®ç°å®ƒç±»å’Œç»“æ„ä½“å¯ä»¥ç»§æ‰¿å¤šä¸ªæ¥å£æŠ½è±¡ç±»è¡¨ç¤ºè¯¥ç±»ä¸­å¯èƒ½å·²ç»æœ‰ä¸€äº›çš„å…·ä½“å®šä¹‰ç”Ÿæˆçš„åº“åœ¨è¿™é‡Œï¼š Temp\StagingArea\libs\armeabi-v7a\libil2cpp.so ç¬¦å·è¡¨åœ¨è¿™é‡Œï¼Œéœ€è¦æŠŠæ‰©å±•åå¼„æˆ.soï¼Œæ‰èƒ½è¢«buglyçš„ç¬¦å·å·¥å…·è½¬æ¢ã€‚ Temp\StagingArea\libs\armeabi-v7a\libil2cpp.so.debug C++ä»£ç ç”Ÿæˆåˆ°è¿™é‡Œï¼Œæœ€å¥½ä¿å­˜è¿™ä¸ªç›®å½•ï¼Œä»¥ä¾¿å¯¹åº”çœ‹è°ƒç”¨æ ˆï¼š Temp\StagingArea\Il2Cpp\il2cppOutput ArrayListä¼šæŠŠæ‰€æœ‰æ’å…¥å…¶ä¸­çš„æ•°æ®éƒ½å½“æˆäº†objectç±»å‹æ¥å¤„ç†ã€‚å¼Šç«¯ï¼š1ã€ä¸æ˜¯ç±»å‹å®‰å…¨çš„ï¼›2ã€å­˜åœ¨è£…ç®±æ‹†ç®±æ“ä½œ12345678910Add() //å‘æ•°ç»„ä¸­æ·»åŠ ä¸€ä¸ªå…ƒç´ Remove() //åˆ é™¤æ•°ç»„ä¸­çš„ä¸€ä¸ªå…ƒç´ RemoveAt(int i);////ä¸æ˜¯éª¨éª¼åŠ¨ç”»,å¯ä»¥ç”¨animator,///éª¨éª¼åŠ¨ç”» animatoråªèƒ½ç”¨ä¸€ä¸ª,Reverse()//åè½¬æ•°ç»„çš„å…ƒç´ Sort()//ä»å°åˆ°å¤§æ’åºæ•°ç»„çš„å…ƒç´ Clone()//å¤åˆ¶ä¸€ä¸ªæ•°ç»„//List//å¯é€šè¿‡ç´¢å¼•è®¿é—® åœ¨å†³å®šä½¿ç”¨Listè¿˜æ˜¯ä½¿ç”¨ArrayList ç±»(ä¸¤è€…å…·æœ‰ç±»ä¼¼çš„åŠŸèƒ½)æ—¶,è®°ä½Listç±»åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ‰§è¡Œçš„æ›´å¥½å¹¶ä¸”æ˜¯ç±»å‹å®‰å…¨çš„,å¦‚æœå¯¹Listç±»å‹Tä½¿ç”¨å€¼ç±»å‹,åˆ™éœ€è¦è€ƒè™‘å®ç°å’Œè£…ç®±é—®é¢˜å¦‚æœå¯¹ç±»å‹Tå®ç”¨å€¼ç±»å‹,åˆ™ç¼–è¯‘å™¨å°†ç‰¹åˆ«é’ˆå¯¹è¯¥å€¼ç±»å‹ç”ŸæˆListç±»çš„å®ç°,è¿™æ„å‘³ç€ä¸å¿…å¯¹å†æé†’ä¸€ä¸‹ï¼Œæ¨¡æ¿å®¹å™¨é‡Œä¸è¦ä½¿ç”¨æšä¸¾ã€‚æ¯”å¦‚Dictionaryä¹‹ç±»çš„ï¼Œæšä¸¾ä¼šboxingï¼Œäº§ç”Ÿæ— ç”¨çš„GCå°±ç”¨intæ›¿ä»£å§ è¯·æè¿°æ¸¸æˆåŠ¨ç”»æœ‰å“ªå‡ ç§ï¼Œä»¥åŠå…¶åŸç†ã€‚ç­”:ä¸»è¦æœ‰å…³èŠ‚åŠ¨ç”»,å•ä¸€ç½‘ç»œæ¨¡å‹åŠ¨ç”»(å…³é”®å¸§åŠ¨ç”»),éª¨éª¼åŠ¨ç”».å…³èŠ‚åŠ¨ç”»æŠŠè§’è‰²åˆ†ä¸ºè‹¥å¹²ç‹¬ç«‹éƒ¨åˆ†,ä¸€ä¸ªéƒ¨åˆ†å¯¹åº”ä¸€ä¸ªç½‘ç»œæ¨¡å‹,éƒ¨åˆ†çš„åŠ¨ç”»è¿æ¥æˆä¸€ä¸ªæ•´ä½“çš„åŠ¨ç”»,è§’è‰²æ¯”è¾ƒçµæ´»Quake2ä¸­å®ç”¨äº†è¿™ç§åŠ¨ç”».å•ä¸€ç½‘ç»œæ¨¡å‹åŠ¨ç”»ç”±ä¸€ä¸ªå®Œæ•´çš„ç½‘ç»œæ¨¡å‹æ„æˆ,åœ¨åŠ¨ç”»åºåˆ—çš„å…³é”®å¸§é‡Œè®°å½•å„ä¸ªé¡¶ç‚¹çš„åŸä½ç½®åŠå…¶æ”¹å˜é‡,ç„¶åæ’å€¼è¿ç®—å®ç°åŠ¨ç”»æ•ˆæœ,è§’è‰²åŠ¨ç”»è¾ƒçœŸå®.éª¨éª¼åŠ¨ç”»,å¹¿æ³›åº”ç”¨çš„åŠ¨ç”»æ–¹å¼,é›†æˆäº†ä»¥ä¸Šä¸¤ä¸ªæ–¹å¼çš„ä¼˜ç‚¹,éª¨éª¼æŒ‰è§’è‰²ç‰¹ç‚¹ç»„æˆä¸€å®šçš„å±‚æ¬¡ç»“æ„,ç”±å…³èŠ‚ç›¸è¿,å¯åšç›¸å¯¹è¿åŠ¨,çš®è‚¤ä½œä¸ºå•ä¸€ç½‘ç»œè’™åœ¨éª¨éª¼ä¹‹å¤–,å†³å®šè§’è‰²çš„å¤–è§‚,çš®è‚¤ç½‘ç»œæ¯ä¸€ä¸ªé¡¶ç‚¹éƒ½ä¼šæ”¶åˆ°éª¨éª¼çš„å½±å“,ä»è€Œå®ç°å®Œç¾çš„åŠ¨ç”». alpha blend å·¥ä½œåŸç†alpha blendç”¨äºåšåŠé€æ˜æ•ˆæœ.Color=(æºé¢œè‰² æºç³»æ•°)OP(ç›®æ ‡é¢œè‰² ç›®æ ‡ç³»æ•°);å…¶ä¸­OP(æ··åˆæ–¹å¼)æœ‰åŠ ,å‡,åå‡,å–æœ€å°,å–æœ€å¤§ OpenGL Alphaæ··åˆå‡è®¾ä¸€ç§ä¸é€æ˜çš„ä¸œè¥¿çš„é¢œè‰²æ˜¯Aï¼Œå¦ä¸€ç§é€æ˜çš„ä¸œè¥¿é¢œè‰²æ˜¯Bï¼Œé‚£ä¹ˆé€è¿‡Bçœ‹Aï¼Œçœ‹ä¸Šå»çš„é¢œè‰²Cå°±æ˜¯Bå’ŒAçš„æ··åˆé¢œè‰²ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹å…¬å¼æ¥æ¨¡æ‹Ÿï¼Œè®¾Bç‰©ä½“çš„é€æ˜åº¦ä¸ºalphaï¼ˆå–å€¼ä¸º0-1ï¼Œ0ä¸ºå®Œå…¨é€æ˜ï¼Œ1ä¸ºå®Œå…¨ä¸é€æ˜ï¼‰ R(C)=alpha*R(B)+(1-alpha)R(A) G(C)=alpha*G(B)+(1-alpha)G(A) B(C)=alpha*B(B)+(1-alpha)G(A) å†™å…‰ç…§è®¡ç®—ä¸­çš„diffuseçš„è®¡ç®—å…¬å¼ç­”:æ¼«åå°„å…‰(diffuse)è®¡ç®—å…¬å¼ä¸º:ldiffuse = DintensityDcolorN.L;(Dintensity)è¡¨ç¤ºæ¼«åå°„å¼ºåº¦,Dcolorè¡¨ç¤ºæ¼«åå°„å…‰é¢œè‰²,Nä¸ºè¯¥ç‚¹çš„æ³•å‘é‡,Lä¸ºå…‰æºå‘é‡å…¶ä»–,3Dæ¸²æŸ“ä¸­,ç‰©ä½“è¡¨é¢çš„å…‰ç…§è®¡ç®—å…¬å¼ä¸º:I = ç¯å¢ƒå…³(lambient) + æ¼«åå°„å…‰(ldiffuse) + é•œé¢é«˜å…‰(lspecular);å…¶ä¸­,ç¯å¢ƒå…‰(ambient)è®¡ç®—å…¬å¼ä¸º: lambient = Aintensity*Acolor;(Aintensity)è¡¨ç¤ºç¯å¢ƒå…‰å¼ºåº¦,Acolorè¡¨ç¤ºç¯å¢ƒå…‰é¢œè‰² é•œé¢é«˜å…‰(specular)è®¡ç®—å…¬å¼ä¸º:lspecular = SintensityScolor(R.V)n;(Sintensity)è¡¨ç¤ºé•œé¢å…‰ç…§å¼ºåº¦,Scolorè¡¨ç¤ºé•œé¢å…‰é¢œè‰²,Rä¸ºå…‰çš„åå°„å‘é‡,Vä¸ºè§‚å¯Ÿè€…å‘é‡ MipMapæ˜¯ä»€ä¹ˆï¼Ÿä½œç”¨ï¼Ÿç­”:åœ¨ä¸‰ç»´è®¡ç®—æœºå›¾å½¢çš„è´´å›¾æ¸²æŸ“ä¸­æœ‰ä¸€ä¸ªå¸¸ç”¨çš„æŠ€æœ¯æˆä¸ºMipmapping,ä¸ºäº†åŠ å¿«æ¸²æŸ“é€Ÿåº¦å’Œå‡å°‘å›¾åƒé”¯é½¿,è´´å›¾è¢«å¤„ç†æˆç”±ä¸€ç³»åˆ—è¢«é¢„å…ˆè®¡ç®—å’Œä¼˜åŒ–è¿‡çš„å›¾ç‰‡ç»„æˆçš„æ–‡ä»¶,è¿™æ ·çš„è´´å›¾è¢«ç§°ä¸ºmipmap ç”¨u3då®ç°2dæ¸¸æˆï¼Œæœ‰å‡ ç§æ–¹å¼ï¼Ÿç­”ï¼šä¸€ç§ç”¨UIå®ç°(GUI,NGUIâ€¦)ï¼Œä¸€ç§æ˜¯é‡‡ç”¨3då®ä½“å¯¹è±¡ï¼ˆplaneï¼‰ï¼Œç»˜åˆ¶åœ¨3då¯¹è±¡ä¸Šï¼Œè°ƒèŠ‚æ‘„åƒæœºï¼Œé‡‡ç”¨å¹³è¡ŒæŠ•å½±æ¨¡å¼æˆ–åˆ™å›ºå®šè§†è§’ã€‚ u3dä¸­ç¢°æ’å™¨å’Œè§¦å‘å™¨çš„åŒºåˆ«ï¼Ÿç­”ï¼šè§¦å‘å™¨åªæ˜¯ç¢°æ’å™¨èº«ä¸Šçš„ä¸€ä¸ªå±æ€§ï¼Œç¢°æ’å™¨æ˜¯è§¦å‘å™¨çš„è½½ä½“ã€‚ ç‰©ä½“å‘ç”Ÿç¢°æ’çš„å¿…è¦æ¡ä»¶ç­”ï¼šéœ€è¦æ£€æµ‹ç¢°æ’çš„ç‰©ä½“èº«ä¸Šå­˜åœ¨åˆšä½“ç»„ä»¶ï¼ˆæˆ–è¢«æ£€æµ‹ç‰©ä½“ï¼‰ï¼Œä¹Ÿè¦ç¢°æ’å™¨collider CharacterControllerå’ŒRigidbodyçš„åŒºåˆ« ç‰©ä½“å‘ç”Ÿç¢°æ’æ—¶ï¼Œæœ‰å‡ ä¸ªé˜¶æ®µï¼Œåˆ†åˆ«å¯¹åº”çš„å‡½æ•°ç­”ï¼šæ’é™¤è§¦å‘ï¼Œæœ‰3ç§ï¼ŒOnCollisionEnter(),OnCollisionStay(); OnCollisionExit() u3dä¸­ï¼Œå‡ ç§æ–½åŠ åŠ›çš„æ–¹å¼ï¼Œæè¿°å‡ºæ¥ã€‚ç­”ï¼ša)çˆ†ç‚¸åŠ›ï¼ˆAddExplosionForce(force : float, forcePos : Vector3ï¼Œradius : float, upwards : float, mode : ForceMode)ï¼‰ï¼Œåº”ç”¨ä¸€ä¸ªåŠ›åˆ°åˆšä½“æ¥æ¨¡æ‹Ÿçˆ†ç‚¸æ•ˆæœ,å°±æ˜¯åœ¨çˆ†ç‚¸åŠ›ä¸­å¿ƒåæ ‡position,æœç´¢åœ¨radiusèŒƒå›´å†…çš„åˆšä½“ï¼Œå¯¹å…¶é‡Šæ”¾åŠ›ä½œç”¨ï¼Œè¶…å‡ºradiusèŒƒå›´çš„åˆšä½“ä¸å—åŠ›ä½œç”¨ï¼Œçˆ†ç‚¸åŠ›å°†éšç€åˆšä½“çš„è·ç¦»çº¿æ€§å‡å¼±ã€‚b)åŠ›AddForce(force : Vector3, mode : ForceMode),ä¸»è¦æ–½åŠ›ç»™ä¸€ä¸ªåˆšï¼Œä½¿å…¶ç§»åŠ¨ã€‚c)ä½ç½®åŠ›AddForceAtPosition(force : Vector3, position : Vector3, mode : ForceMode), åœ¨positionæ–½åŠ ä¸€ä¸ªåŠ›ï¼Œæ–½åŠ›çš„ä¸»ä½“å°†ä¼šå—åˆ°ä¸€ä¸ªåŠ›å’ŒåŠ›çŸ©ã€‚d)ç›¸å¯¹åŠ›AddRelativeForce(force : Vector3, mode : ForceMode),ç±»ä¼¼äºAddForceï¼› ä»€ä¹ˆå«åšé“¾æ¡å…³èŠ‚ç­”:Hinge Joint ,ä»–å¯ä»¥æ¨¡æ‹Ÿä¸¤ä¸ªç‰©ä½“è§ ç‰©ä½“è‡ªæ—‹è½¬ä½¿ç”¨çš„å‡½æ•°å«ä»€ä¹ˆç­”ï¼štransform.Rotate(eulerAngles : Vector3, relativeTo : Space = Space.self); ç‰©ä½“ç»•æŸç‚¹æ—‹è½¬ä½¿ç”¨å‡½æ•°å«ä»€ä¹ˆç­”ï¼štransform.RotateAround(point : Vector3, axis : Vector3, angles : float) u3dæä¾›äº†ä¸€ä¸ªç”¨äºä¿å­˜è¯»å–æ•°æ®çš„ç±»ï¼Œï¼ˆplayerPrefsï¼‰ï¼Œè¯·åˆ—å‡ºä¿å­˜è¯»å–æ•´å½¢æ•°æ®çš„å‡½æ•°ç­”ï¼šPlayerPrefs.GetInt(key : string, defaultValue : int = 0); unity3dæä¾›äº†å‡ ç§å…‰æºï¼Œåˆ†åˆ«æ˜¯ä»€ä¹ˆç­”ï¼šå¹³è¡Œå…‰,ç‚¹å…‰æºï¼Œèšå…‰ç¯ï¼Œç¯å¢ƒå…‰ unity3dä»å”¤é†’åˆ°é”€æ¯æœ‰ä¸€æ®µç”Ÿå‘½å‘¨æœŸï¼Œè¯·åˆ—å‡ºç³»ç»Ÿè‡ªå·±è°ƒç”¨çš„å‡ ä¸ªé‡è¦æ–¹æ³•ã€‚ç­”ï¼švoid Awake(),void Start(), void Update(), void FixedUpdate(),void LateUpdate(), void OnGUI() ï¼Œvoid Reset(), OnDisable(), void OnDestroy() ç‰©ç†æ›´æ–°ä¸€èˆ¬åœ¨å“ªä¸ªç³»ç»Ÿå‡½æ•°é‡Œï¼Ÿç­”ï¼švoid FixedUpdate() ç§»åŠ¨ç›¸æœºåŠ¨ä½œåœ¨å“ªä¸ªå‡½æ•°é‡Œï¼Œä¸ºä»€ä¹ˆåœ¨è¿™ä¸ªå‡½æ•°é‡Œã€‚ç­”ï¼švoid LateUpdate(),å› ä¸ºè¿™ä¸ªå‡½æ•°æ˜¯åœ¨Updateæ‰§è¡Œå®Œæ¯•æ‰æ‰§è¡Œçš„ï¼Œä¸ç„¶çš„è¯å°±æœ‰å¯èƒ½å‡ºç°æ‘„åƒæœºé‡Œé¢ä»€ä¹ˆéƒ½çœ‹åˆ°çš„æƒ…å†µã€‚ å½“æ¸¸æˆä¸­éœ€è¦é¢‘ç¹åˆ›å»ºä¸€ä¸ªç‰©ä½“å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ€ä¹ˆåšæ¥èŠ‚çœå†…å­˜ã€‚Unityé‡Œæœ‰ä¸¤ç§åŠ¨æ€åŠ è½½æœºåˆ¶:ä¸€ä¸ªæ˜¯Resources.Load,å¦å¤–ä¸€ä¸ªé€šè¿‡AssetBundle,å…¶å®ä¸¤è€…åŒºåˆ«ä¸å¤§,Resources.Loadå°±æ˜¯ä»ä¸€ä¸ªç¼ºçœæ‰“è¿›ç¨‹åºåŒ…é‡Œçš„AssetBundleé‡ŒåŠ è½½èµ„æº,è€Œä¸€èˆ¬AssetBundleæ–‡ä»¶éœ€è¦ä½ è‡ªå·±åˆ›å»º,è¿è¡Œæ—¶åŠ¨æ€åŠ è½½AssetBundleè¿è¡Œæ—¶åŠ è½½AssetBundle.Unload(flase)æ˜¯é‡Šæ”¾AssetBundleæ–‡ä»¶ ä¸€ä¸ªåœºæ™¯æ”¾ç½®å¤šä¸ªcameraå¹¶åŒæ—¶å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆ23.ç®€è¿°prefabçš„ç”¨å¤„å’Œç¯å¢ƒ24.å¦‚ä½•é”€æ¯ä¸€ä¸ªUnityEngine.Objectä»¥åŠå…¶å­ç±»25.ä¸ºä»€ä¹ˆu3dä¼šå‡ºç°ç»„ä»¶ä¸Šæ•°æ®ä¸¢å¤±çš„æƒ…å†µ26.u3dä¸‹å¦‚ä½•å®‰å…¨çš„åœ¨ä¸åŒå·¥ç¨‹è¿ç§»assetæ•°æ®DrawCallä¼˜åŒ–ä¸€ Mesh RendereräºŒ Skinned Mesh Rendererä¸‰ åˆå¹¶è¦æ±‚å¯¹æ¯”å›› æ€»ç»“äº” åœºæ™¯åˆ¶ä½œå»ºè®®DrawCallä¼˜åŒ–åˆå¹¶,å³DrawCall Batching.é€šè¿‡å‡å°‘Draw callæ•°å’Œå¯¹æ˜¾å¡æ€§èƒ½çš„æ¶ˆè€—æ¥æé«˜æ€§èƒ½ä¸€ Mesh Rendereråˆ†ä¸ºDynamic Batching å’Œ Static BatchingDynamic Batchingä¸éœ€è¦ä»»ä½•æ“ä½œ,åªè¦å…±äº«æè´¨(å³ä½¿æ˜¯ä¸åŒçš„Meshæ¨¡å‹ä¹Ÿå¯ä»¥)Unityä¸­çš„å†…å­˜ç§ç±»å®é™…ä¸ŠUnityæ¸¸æˆä½¿ç”¨çš„å†…å­˜ä¸€å…±æœ‰ä¸‰ç§:ç¨‹åºä»£ç ,æ‰˜ç®¡å †(Managed Heap)ä»¥åŠæœ¬æœºå †(Native Heap)ç¨‹åºä»£ç åŒ…æ‹¬äº†æ‰€æœ‰çš„Unityå¼•æ“,ä½¿ç”¨çš„åº“,ä»¥åŠä½ æ‰€å†™çš„æ‰€æœ‰çš„æ¸¸æˆä»£ç ,åœ¨ç¼–è¯‘å,å¾—åˆ°çš„è¿è¡Œæ–‡ä»¶å°†ä¼šè¢«åŠ è½½åˆ°è®¾å¤‡ä¸­æ‰§è¡Œ,å¹¶å ç”¨ä¸€å®šå†…å­˜.è¿™éƒ¨åˆ†å†…å­˜å®é™…ä¸Šæ˜¯æ²¡æœ‰åŠæ³•å»â€ç®¡ç†çš„â€ æ³•çº¿è´´å›¾ä¸€: æ³•çº¿è´´å›¾çš„åŸç†å…‰ç…§æ•ˆæœå¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ç”±å‚ç›´äºç‰©ä½“è¡¨é¢çš„æ³•çº¿å†³å®šçš„,å› ä¸ºæ³•çº¿å½±å“åå°„å…‰çš„æ–¹å‘,å‡åŒ€å‚ç›´çš„æ³•çº¿æ˜¯é•œé¢è´´å›¾ä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬ä¼šç»™ä¸€ä¸ªå¹³é¢ä½¿ç”¨ç –å¢™è´´å›¾,ç –å¢™åº”è¯¥æ˜¯å‡¹å‡¸ä¸å¹³çš„,è€Œå¦‚æœè®©ç –å¢™ä½¿ç”¨è¯¥å¹³é¢çš„æ³•çº¿çš„è¯,ç”»é¢å°±å¾ˆå‡,è€Œå¦‚æœæŒ‰çœŸå®ç –å¢™å»åšæ¨¡å‹çš„è¯,å³åšé«˜ç²¾åº¦æ¨¡å‹,ä¸€æ–¹é¢åˆ¶ä½œéº»çƒ¦,å¦ä¸€æ–¹é¢è¿è¡Œæ—¶å¯¹æ€§èƒ½çš„æŸè€—å¾ˆå¤§.æ³•çº¿è´´å›¾å°±æ˜¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„.æ³•çº¿è´´å›¾å°±æ˜¯æŠŠæ³•çº¿ä¿¡æ¯å­˜å‚¨åœ¨ä¸€å¼ å›¾é‡Œ.ä½¿ç”¨å‘ç°è´´å›¾æ—¶,é€šå¸¸é¡¶ç‚¹æ•°å’Œä¸‰è§’å½¢é¢æ•°åªæœ‰é«˜ç²¾åº¦æ¨¡å‹çš„ååˆ†ä¹‹ä¸€ä¸åˆ°.äºŒ: æ³•çº¿è´´å›¾çš„å®ç°å°†æè´¨è´´å›¾å¯¹åº”çš„æ³•çº¿ç»˜åˆ¶åœ¨ä¸€å¼ è´´å›¾ä¸Š,å°†è´´å›¾å¯¹åº”ç‚¹çš„å•ä½æ³•çº¿å‘é‡ä¿¡æ¯float3(x,y,z)å­˜å‚¨åœ¨é€”ä¸­å¯¹åº”çš„é¢œè‰²é‡Œå‹ç¼©æ³•çº¿è´´å›¾çš„å¥½å¤„:å‹ç¼©åçš„æ³•çº¿è´´å›¾,å¤§å°åªæœ‰åŸæ¥çš„1/4å·¦å³,æ•…å¯ä»¥ä½¿ç”¨æ›´å¤§æˆ–è€…æ›´å¤šçš„è´´å›¾æ¥æå‡ç”»é¢å“è´¨.Unity3Dçš„æ³•çº¿è´´å›¾Unity3Dä½¿ç”¨çš„å‹ç¼©æ³•çº¿è´´å›¾æ˜¯DXT5nmæ ¼å¼çš„,æœ‰Aå’ŒGä¸¤ä¸ªé€šé“,å¯¹äºæ³•çº¿(x,y,z) Aå¯¹åº”x,Gå¯¹åº”yå¯¹å‹ç¼©æ³•çº¿è´´å›¾çš„é‡‡æ ·ä¾ç„¶æ˜¯å¦‚ä¸‹å‡½æ•° float4 packedNormal = tex2D(_NormalMap, IN.uv_MainTex); packedNormal.wå¯¹åº”Aé€šé“,æ—¢æ³•çº¿çš„xpackedNormal.yå¯¹åº”Gé€šé“,æ—¢æ³•çº¿çš„yUnity3Dçƒ­æ›´æ–°å…¨ä¹¦-åŠ è½½(ä¸€)ä»AssetBundleè¯´èµ·æˆ‘ä»¬è¯•å…¨é¢åˆ†æä¸€ä¸‹Unity3Dæä¾›çš„èµ„æºåŠ è½½æœºåˆ¶ Resourecs//å†…åµŒèµ„æº,ä½¿ç”¨æ–¹æ³•Resources.Load,å¯ä»¥åŠ è½½ä»»æ„ç§ç±»çš„èµ„æº,ä¸èƒ½åŠ¨æ€ä¿®æ”¹ StreamingAssets//éšåŒ…èµ„æº,ä½¿ç”¨æ–¹æ³•IOæˆ–WWW.Load,WWW.Loadå¯ä»¥åŠ è½½ä»»æ„ç§ç±»èµ„æº,IOä»…é™byteså’Œtext WWWä»ç½‘ç»œä¸‹è½½å¹¶åŠ è½½ WWWä»ç½‘ç»œåŠ è½½AssetBundleä¸€å’ŒäºŒæ˜¾ç„¶ä¸å…·æœ‰çƒ­æ›´æ–°çš„æ•ˆæœ,è¿™é‡Œå°±ä¸åšè®¨è®º3 4éƒ½æ˜¯ä»ç½‘ç»œåŠ è½½çš„,ä»–ä»¬æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢é¦–å…ˆè¯´3,è¿™æ˜¯æ²¡æœ‰ç¼“å†²çš„,æˆ‘ä»¬æ˜¾ç„¶ä¸æƒ³è®©ç”¨æˆ·é‡å¤çš„æµªè´¹æµé‡,ä¸å¯å–ç„¶åæ˜¯4,assetbundleæä¾›äº†ä¸€ä¸ªç‰ˆæœ¬å·æ¥åšç¼“å†²å¯¹æ¯”,å¯ä»¥æ¯”è¾ƒå¥½çš„èµ·åˆ°æ›´æ–°çš„ç›®æ ‡assetbundleåŸæ¥å°±æ˜¯Unity3Dä¸ºæˆ‘ä»¬å‡†å¤‡çš„æ–¹æ¡ˆ,éš¾æ€ªæ¯æœ¬ä¹¦éƒ½ä¼šå¤§ç¯‡ä»‹ç»AssetBundle,åæ–‡ç®€ç§°ABæ¯æœ¬ä¹¦éƒ½å‘Šè¯‰ä½ ,ABå¾ˆå¼ºå¤§,ABå¸®ä½ è§£å†³äº†è·¨å¹³å°é—®é¢˜,å¸®ä½ è§£å†³äº†ä¾èµ–å…³ç³».é¦–å…ˆABçš„ç¡®å¾ˆå¥½å¾ˆå¼ºå¤§,ä»–èƒ½æ”¶çº³Unityè‡ªå·±çš„æ‰€æœ‰èµ„æºç§ç±»,è´´å›¾,æè´¨,shaderé¢„è®¾ç„¶åå¯ä»¥æ¯å¹³å°æ”¯æŒ,è¿™å°±æ˜¯ç¬¬ä¸€ä¸ªé™·è¿›,æ³¨æ„æ˜¯æ¯å¹³å°éƒ½æ”¯æŒ,ä¸æ˜¯å¤šå¹³å°æ”¯æŒæ¯ä¸ªå¹³å°éƒ½è¦å•ç‹¬å¯¼å‡º,è€Œæ¯ä¸ªå¹³å°åˆ°åº•å·®äº†äº›ä»€ä¹ˆå‘¢?nothingè€Œæœ€å¤§çš„è´¨é‡å·®å¼‚,æºè‡ªè´´å›¾æœ‰äº›å¹³å°è´´å›¾ä¸å‹ç¼©,æœ‰äº›å¹³å°è´´å›¾è¦å‹ç¼©,è€Œä¸”æ ¹æ®ä¸é€šçš„å¹³å°ç‰¹æ€§,å¥—ç”¨ä¸é€šçš„å‹ç¼©ç®—æ³•,å…ˆå‹è¿‡å†å­˜åˆ°åŒ…é‡Œè¿™å°±æ˜¯ABå¸®ä½ å¹²çš„æœ€ä¸»è¦çš„äº‹æƒ…å¬èµ·æ¥å¾ˆè´´å¿ƒå‘¢,ç­‰ç­‰,ä½ æ˜¯ä¸æ˜¯å¿˜äº†ä¸€ä¸ªç‰¹å®šçš„å‘½é¢˜,è¿™ä¸ªå‘½é¢˜å«åšUIå‹ç¼©çš„å›¾ç‰‡ä¼šæœ‰è´¨é‡æŸå¤±,UIè´´å›¾æˆ‘ä»¬é€šå¸¸æ˜¯ä¸å‹ç¼©çš„ç„¶åUIè¿˜ä¼šè§¦åŠåˆ°ABçš„å¦ä¸€ä¸ªé—®é¢˜ä»¥NGUIä¸ºä¾‹,NGUIçš„èµ„æºå…³ç³»æ¯”è¾ƒå¤æ‚,æœ‰è´´å›¾-&gt;å›¾é›†-&gt;å¸ƒå±€ä¸åŒçš„å¸ƒå±€ç»å¸¸äº¤å‰åº”ç”¨è´´å›¾å¦‚æœç”¨ABæƒ³æŠŠæ¯ä¸ªç•Œé¢åˆ†å¼€æ‰“åŒ…,ç»™ç”¨æˆ·æœ€å°çš„èµ„æºæ›´æ–°é‡,è¿™ä¸ªä»»åŠ¡å¯ä»¥ç”¨æ¥ç¾éš¾æ¥å½¢å®¹æœ€ç»ˆçƒ­æ›´æ–°æ¨é€ç»™ç”¨æˆ·çš„ä¸œè¥¿æ˜¯ä»¥æ–‡ä»¶ä¸ºå•ä½çš„,è€ŒABåœ¨å°ç²’åº¦æ–‡ä»¶å¹¶ä¸”ä¹‹é—´æœ‰è¾ƒä¸ºå¤æ‚çš„åº”ç”¨å…³ç³»è¿™ç§éœ€æ±‚çš„ä¸‹çš„ä½¿ç”¨æ˜¯ä¸€åœºç¾éš¾ABå¯¹æ¯ä¸ªå¹³å°çš„å·®å¼‚ç¼–è¯‘ä¸æ˜¯å¯é€‰çš„,è€Œæ˜¯å¼ºåˆ¶çš„,å‡å¦‚ä½ æœ‰web,ios,android,ä¸‰ä¸ªå¹³å°,æ— è®ºå¦‚ä½•ä½ éƒ½è¦å¯¼å‡ºä¸‰æ¬¡æ²¡äº†AssetBundle,æˆ‘ä»¬æ€ä¹ˆåŠæŠŠç¢ç‰‡æ–‡ä»¶ä¸‹è½½å›æ¥,å¹¶ä¸”ç»„è£…å¯¹äºUIè¿™ä¸ªæƒ…æ™¯,æ˜¯å®Œå…¨å¯è¡Œçš„,æŠŠå¸ƒå±€å’Œå›¾é›†ä¿å­˜ä¸ºæ–‡æœ¬å½¢å¼,æŠŠæ–‡æœ¬å’Œè´´å›¾ä¸‹è½½å›æ¥,ç„¶åç»„è£…å¯¹äºå…¶ä»–åœºæ™¯ç‰‡æ®µ,åœ¨æœ‰åŠ¨ç”»å’Œè´´å›¾éœ€è¦å‹ç¼©çš„æƒ…å†µä¸‹,ABä¾ç„¶æ˜¯å”¯ä¸€çš„é€‰æ‹©unityæ²¡æœ‰æä¾›åœ¨è¿è¡Œæ—¶å‹ç¼©å‹ç¼©è´´å›¾çš„æ‰‹æ®µ,åŠ¨ç”»ä¹Ÿä¸å®¹æ˜“å­˜å‚¨,åªèƒ½è¿è¡Œæ—¶å‹ç¼©DXT,åªæœ‰pcå’Œwp8æ”¯æŒå¯¹äºå„ç§å„æ ·çš„èµ„æºåŠ è½½å›ç‰¹åˆ«å‡Œä¹±ä¹ˆ,ä¸ä¼šå…¶å®æœ¬è´¨ä¸Šå¯ä»¥ç»Ÿä¸€æˆbytesçš„å¤„ç†textureå¯ä»¥ä»bytesåŠ è½½å­—ç¬¦ä¸²å¯ä»¥ä»bytesåŠ è½½ABå¯ä»¥ä»bytesåŠ è½½è‡ªå®šä¹‰äºŒè¿›åˆ¶å­˜å‚¨,æœ¬èº«å°±æ˜¯bytesUnity3Dçƒ­æ›´æ–°å…¨ä¹¦-åŠ è½½(äºŒ)å¦‚ä½•åœ¨ä¸ç”¨AssetBundleçš„å‰æä¸‹åŠ¨æ€åŠ è½½é¢„è®¾Unity3Dçš„ä¸»è¦æ„æˆå¤§å®¶éƒ½çŸ¥é“,é¦–å…ˆæ˜¯åœºæ™¯å›¾,åœºæ™¯å›¾ä¸Šçš„èŠ‚ç‚¹æ„æˆä¸€æ£µæ ‘æ¯ä¸ªèŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªGameObjectå¯¹è±¡ç„¶åæ¯ä¸ªGameObjectæœ‰è‹¥å¹²ä¸ªç»„ä»¶æœ‰ä¸€äº›ç»„ä»¶ä¼šä¸èµ„æºäº§ç”Ÿå…³ç³»,æ¯”å¦‚MeshRendererä¼šå…³è”æè´¨,æè´¨å›å…³è”shaderå’Œè´´å›¾åœºæ™¯å›¾çš„ä¸€éƒ¨åˆ†å›ä¿å­˜ä¸ºä¸€ä¸ªé¢„è®¾,prefabæœ‰æ—¶å€™æˆ‘ä»¬ä¼šéœ€è¦é¢„è®¾å»å¤ç”¨,è€Œé¢„è®¾çš„åŠ è½½ä¼¼ä¹åªèƒ½é€šè¿‡ABå»æ‰“åŒ…,å…¶å®ä¸ç„¶,è¿™é‡Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå¼€æºçš„åº“å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ä¸ºä»€ä¹ˆä¸ä½¿ç”¨AB,å¯ä»¥è§ä¸Šä¸€ç¯‡,åŠ è½½(ä¸€),ä¸ä½¿ç”¨ABä¸€ä»½èµ„æºå…¨å¹³å°åŒæ„,ä¹Ÿæ²¡æœ‰ç—›è‹¦çš„æ‰“åŒ…æ—¶é—´,èµ„æºä¾èµ–ä¹Ÿå¾ˆå®¹æ˜“å¤„ç½® ç‰©ç†æ›´æ–°ä¸€èˆ¬åœ¨FixedUpdateé‡Œ,æ¯å›ºå®šå¸§ç»˜åˆ¶æ—¶æ‰§è¡Œä¸€æ¬¡,å’Œupdateä¸åŒçš„æ˜¯FixedUpdateæ˜¯æ¸²æŸ“å¸§æ‰§è¡Œ,å¦‚æœä½ çš„æ¸²æŸ“æ•ˆç‡ä½ä¸‹çš„æ—¶å€™FixedUpdateè°ƒç”¨æ¬¡æ•°å°±ä¼šè·Ÿç€ä¸‹é™,FixedUpdateæ¯”è¾ƒé€‚ç”¨äºç‰©ç†å¼•æ“çš„è®¡ç®—,å› ä¸ºæ˜¯è·Ÿæ¯å¸§æ¸²æŸ“æœ‰å…³,Updateå°±æ¯”è¾ƒé€‚åˆåšæ§åˆ¶.ç§»åŠ¨ç›¸æœºåŠ¨ä½œåœ¨LateUpdateå‡½æ•°,å½“æ‰€æœ‰Updateç»“æŸæ‰è°ƒç”¨,æ¯”è¾ƒé€‚åˆç”¨äºå‘½ä»¤è„šæœ¬çš„æ‰§è¡Œ,å½“æ¸¸æˆä¸­éœ€è¦é¢‘ç¹åˆ›å»ºä¸€ä¸ªç‰©ä½“å¯¹è±¡æ—¶,åšä¸€ä¸ªpool,æ¸¸æˆå¼€å§‹æ—¶é¢„å…ˆå®ä¾‹åŒ–è¶³å¤Ÿçš„æ•°é‡,ç”¨çš„æ—¶å€™å–,ä¸ç”¨çš„æ—¶å€™å›æ”¶. ä»€ä¹ˆæ˜¯æ¸²æŸ“ç®¡é“?æ¸²æŸ“ç®¡é“ä¸­æœ‰å¾ˆå¤šæ­¥éª¤,éƒ½è¦å°†å‡ ä½•ä½“ä»ä¸€ä¸ªåæ ‡ç³»ä¸­å˜æ¢åˆ°å¦ä¸€ä¸ªåæ ‡ç³»ä¸­.æœ¬åœ°åæ ‡-&gt;è§†å›¾åæ ‡-&gt;èƒŒé¢è£å‰ª-&gt;å…‰ç…§-&gt;è£å‰ª-&gt;æŠ•å½±-&gt;è§†å›¾å˜æ¢-&gt;å…‰æ …åŒ–ä¼˜åŒ–å†…å­˜: è‡ªå¸¦å‹ç¼©ç±»åº“ å°†æš‚æ—¶ä¸ç”¨çš„ä»¥åè¿˜éœ€è¦å®ç”¨çš„ç‰©ä½“éšè—èµ·æ¥è€Œä¸æ˜¯ç›´æ¥Destroyæ‰ é‡Šæ”¾AssetBundleå ç”¨çš„èµ„æº é™ä½æ¨¡å‹çš„ç‰‡é¢æ•°,é™ä½æ¨¡å‹çš„éª¨éª¼æ•°é‡,é™ä½è´´å›¾çš„å¤§å° ä½¿ç”¨å…‰ç…§è´´å›¾,ä½¿ç”¨å¤šå±‚æ¬¡ç»†èŠ‚(LOD),ä½¿ç”¨ç€è‰²å™¨(Shader),ä½¿ç”¨é¢„è®¾(Prefab)èµ„æºåŠ è½½: Resources.Load(); AssetBundlelocalPosition:è‡ªèº«ä½ç½®,ç›¸å¯¹äºçˆ¶çº§çš„å˜æ¢ä½ç½®,Position:åœ¨ä¸–ç•Œåæ ‡transformçš„ä½ç½®é™æ€æ„é€ å‡½æ•°ä¸å…è®¸è®¿é—®ä¿®é¥°ç¬¦,ä¹Ÿä¸æ¥å—ä»»ä½•å‚æ•°ç¢°æ’å™¨(Collider)æœ‰ç¢°æ’æ•ˆæœ,IsTrigger=false,å¯ä»¥è°ƒç”¨OnCollisionEnter/Stay/Exitå‡½æ•°è§¦å‘å™¨(Trigger)æ²¡æœ‰ç¢°æ’æ•ˆæœ,IsTrigger=true,å¯ä»¥è°ƒç”¨OnTriggerEnter/Stay/Exitå‡½æ•° ç‰©ä½“å‘ç”Ÿç¢°æ’çš„å¿…è¦æ¡ä»¶?å¿…é¡»å¸¦æœ‰colliderç¢°æ’èµ·å’Œrigibodyåˆšä½“å±æ€§æˆ–è€…äººç‰©æ§åˆ¶å™¨å…¶å®äººç‰©æ§åˆ¶å™¨å°±åŒ…å«äº†å‰ä¸¤è€…,å¦å¤–ä¸€ä¸ªä¹Ÿè¦å¸¦æœ‰Collider,Collideråˆ†ç±»:ç½‘æ ¼ç¢°æ’å™¨,ç›’å­ç¢°æ’å™¨,èƒ¶å›Šç¢°æ’å™¨,çƒå‹ç¢°æ’å™¨,åœ°å½¢ç¢°æ’å™¨ CharacterControllerå’ŒRigidbodyçš„åŒºåˆ«?Rigidbodyå…·æœ‰å®Œå…¨çœŸæ˜¯ç‰©ç†çš„ç‰¹æ€§,è€ŒCharacterControllerå¯ä»¥è¯´æ˜¯å—é™çš„Rigidbody,å…·æœ‰ä¸€å®šçš„ç‰©ç†æ•ˆæœä½†ä¸æ˜¯å®Œå…¨çœŸå®çš„.4.ç‰©ä½“å‘ç”Ÿç¢°æ’æ—¶,å‡ ç§æ–½åŠ åŠ›çš„æ–¹å¼,æè¿°å‡ºæ¥?rigidbody.AddForce/AddForceAtPosition,éƒ½æ˜¯rigidbodyçš„æˆå‘˜å‡½æ•° ç‰©ä½“å‘ç”Ÿç¢°æ’æ—¶,æœ‰å‡ ä¸ªé˜¶æ®µ,åˆ†åˆ«å¯¹åº”çš„å‡½æ•°ä¸‰ä¸ªé˜¶æ®µ,OnCollsionEnter/Stay/Exitå‡½æ•° Unity3dæä¾›äº†å‡ ç§å…‰æº,åˆ†åˆ«æ˜¯ä»€ä¹ˆå…±4ä¸­,DirectrionaLight,PointLight,SpotLight,AreaLight(ç”¨äºçƒ˜åŸ¹) ä½¿ç”¨Unity3då®ç°2dæ¸¸æˆ,æœ‰å‡ ç§æ–¹å¼?(1).ä½¿ç”¨æœ¬èº«GUI(2).æŠŠç›¸æœºçš„Projection(æŠ•å½±)å€¼è°ƒä½Orthographic(æ­£äº¤æŠ•å½±),ä¸è€ƒè™‘zè½´;(3).ä½¿ç”¨2dæ’ä»¶,å¦‚:2DTollKit9.ä¸‹åˆ—ä»£ç åœ¨è¿è¡Œä¸­å›äº§ç”Ÿå‡ ä¸ªä¸´æ—¶å¯¹è±¡?string a = new string(â€œabcâ€);a = (a.ToUpper() + â€œ123â€).SubString(0, 2);ç­”:å…¶å®åœ¨C#ç¬¬ä¸€è¡Œæ˜¯ä¼šå‡ºé”™çš„(Javaä¸­å€’æ˜¯å¯è¡Œ),åº”è¯¥è¿™æ ·åˆå§‹åŒ–string b = new string(new char[]{â€˜aâ€™, â€˜bâ€™, â€˜câ€™}} è¯·ç®€è¿°å…³é”®å­—Sealedç”¨åœ¨ç±»å£°æ˜å’Œå‡½æ•°å£°æ˜æ—¶çš„ä½œç”¨ç­”:ç±»å£°æ˜æ—¶å¯é˜²æ­¢å…¶ä»–ç±»ç»§æ‰¿æ­¤ç±»,åœ¨æ–¹æ³•ä¸­å£°æ˜åˆ™å¯é˜²æ­¢æ´¾ç”Ÿç±»é‡å†™æ­¤æ–¹æ³• ç®€è¿°å››å…ƒæ•°çš„ä½œç”¨,å››å…ƒæ•°å¯¹æ¬§æ‹‰è§’çš„ä¼˜ç‚¹?ç­”:å››å…ƒæ•°ç”¨äºè¡¨ç¤ºæ—‹è½¬ç›¸å¯¹äºæ¬§æ‹‰è§’çš„ä¼˜ç‚¹:(1).èƒ½è¿›è¡Œå¢é‡æ—‹è½¬(2).é¿å…æ–¹å‘é”(3)ç»™å®šæ–¹ä½çš„è¡¨è¾¾æ–¹å¼æœ‰ä¸¤ç§,äº’ä¸ºè´Ÿ(æ¬§æ‹‰è§’æœ‰æ— æ•°ç§è¡¨è¾¾æ–¹å¼)12.å¦‚ä½•å®‰å…¨çš„åœ¨ä¸ç”¨å·¥ç¨‹é—´å®‰å…¨çš„è¿ç§»assetæ•°æ®,ä¸‰ç§æ–¹æ³•ç­”(1).å°†Assetsç›®å½•å’ŒLibraryç›®å½•ä¸€èµ·è¿ç§»(2)å¯¼å‡ºåŒ…(3)ç”¨unityè‡ªå¸¦çš„assert serveråŠŸèƒ½13.å½“ä¸€ä¸ªç»†å°çš„é«˜é€Ÿç‰©ä½“ç¢°æ’å¦ä¸€ä¸ªè¾ƒå¤§çš„ç‰©ä½“æ—¶,ä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µ?å¦‚ä½•é¿å…?ç©¿é€(ç¢°æ’æ£€æµ‹å¤±è´¥)14.MipMapæ˜¯ä»€ä¹ˆ?ä½œç”¨?åœ¨ä¸‰ç»´è®¡ç®—æœºå›¾å½¢çš„è´´å›¾æ¸²æŸ“ä¸­æœ‰ä¸€ä¸ªå¸¸ç”¨çš„æŠ€æœ¯è¢«æˆä¸ºMipmapping,ä¸ºäº†åŠ å¿«æ¸²æŸ“é€Ÿåº¦å’Œå‡å°‘å›¾åƒé”¯é½¿,è´´å›¾è¢«å¤„ç†æˆä¸º åå°„å®ç°åŸç†ï¼šåœ¨è¿è¡Œæ—¶æ ¹æ®ç¨‹åºé›†å’Œå…¶ä¸­çš„ç±»å‹å¾—åˆ°å…ƒæ•°æ®12345678910using System.Reflection;Assembly.Load("ç¨‹åºé›†");//åŠ è½½ä¸€ä¸ªç¨‹åºé›†ï¼Œè¿”å›ç±»å‹æ˜¯ä¸€ä¸ªAssemblyforeach(Type type in assembly.GetType())&#123; stromh t = type.name;&#125;Type type = assembly.GetType("ç¨‹åºé›†.ç±»å"); //è·å–å½“å‰ç±»çš„ç±»å‹var activator = System.Activator.CreateInstance(type); // åˆ›å»ºæ­¤ç±»å‹å®ä¾‹MethodInfo mInfo = type.GetMethod("æ–¹æ³•å");//è·å–å½“å‰æ–¹æ³•mInfo.Invok(null, æ–¹æ³•å‚æ•°);]]></content>
      <tags>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[unity-nature-review]]></title>
    <url>%2F2018%2F04%2F10%2Funity-nature-review%2F</url>
    <content type="text"><![CDATA[æ˜¯å¦æœ‰å¤šç»´å­æè´¨ï¼šå¤šç»´å­æè´¨æè´¨æµ‹è¯•ï¼Œä¸‰ä¸ªå­æè´¨ï¼Œ50ä¸ªç‰©ä½“ï¼Œä½¿ç”¨å¤šç»´å­æè´¨12å¸§ï¼Œ330ä¸ªdcï¼Œ343é¢ã€‚æ‹†å¼€ä¹‹å20å¸§ï¼Œ154dcï¼Œ134é¢ã€‚å¤šç»´å­æè´¨Unityæ— æ³•åŠ¨æ€åˆå¹¶ã€‚å åŠ æ¨¡å¼è´´å›¾ï¼Œå¯ä»¥ä¸ç”¨Alphaé€šé“ç‰¹æ•ˆç²’å­è´´å›¾æ˜¯å¦åˆå¹¶æ˜¯å¦æœ‰äº›ç²’å­èƒ½ä½¿ç”¨åºåˆ—å¸§ï¼Œä¸è¿‡å’Œè§†è§’æœ‰å…³ï¼Œå»æ‰alphaè´´å›¾åˆå¹¶ã€‚åŠ¨ç”»boneweight,æ²¡æœ‰ç‰¹æ®Šéœ€è¦çš„æƒ…å†µä¸‹å—ä¸¤ä¸ªéª¨éª¼å½±å“å°±å¤Ÿäº†ã€‚]]></content>
  </entry>
  <entry>
    <title><![CDATA[Luaå‚è€ƒæ‰‹å†Œä¸ŠåŠéƒ¨åˆ†]]></title>
    <url>%2F2018%2F04%2F02%2FLua-5-1-refer-manual%2F</url>
    <content type="text"><![CDATA[Lua æ˜¯ä¸€ä¸ªæ‰©å±•å¼ç¨‹åºè®¾è®¡è¯­è¨€ï¼Œå®ƒè¢«è®¾è®¡æˆæ”¯æŒé€šç”¨çš„è¿‡ç¨‹å¼ç¼–ç¨‹ï¼Œå¹¶æœ‰ç›¸å…³æ•°æ®æè¿°çš„è®¾æ–½ã€‚ Lua ä¹Ÿèƒ½å¯¹é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå‡½æ•°å¼ç¼–ç¨‹ï¼Œæ•°æ®é©±åŠ¨å¼ç¼–ç¨‹æä¾›å¾ˆå¥½çš„æ”¯æŒã€‚ å®ƒå¯ä»¥ä½œä¸ºä¸€ä¸ªå¼ºå¤§ã€è½»é‡çš„è„šæœ¬è¯­è¨€ï¼Œä¾›ä»»ä½•éœ€è¦çš„ç¨‹åºä½¿ç”¨ã€‚ Lua ä»¥ä¸€ä¸ªç”¨ clean C å†™æˆçš„åº“å½¢å¼æä¾›ã€‚ï¼ˆæ‰€è°“ Clean C ï¼ŒæŒ‡çš„ ANSI C å’Œ C++ ä¸­å…±é€šçš„ä¸€ä¸ªå­é›†ï¼‰ä½œä¸ºä¸€ä¸ªæ‰©å±•å¼è¯­è¨€ï¼ŒLua æ²¡æœ‰ â€œmainâ€ ç¨‹åºçš„æ¦‚å¿µï¼šå®ƒåªèƒ½ åµŒå…¥ ä¸€ä¸ªå®¿ä¸»ç¨‹åºä¸­å·¥ä½œï¼Œè¿™ä¸ªå®¿ä¸»ç¨‹åºè¢«ç§°ä½œ embedding program æˆ–ç®€ç§°ä¸º host ã€‚ å®¿ä¸»ç¨‹åºå¯ä»¥é€šè¿‡è°ƒç”¨å‡½æ•°æ‰§è¡Œä¸€å°æ®µ Lua ä»£ç ï¼Œå¯ä»¥è¯»å†™ Lua å˜é‡ï¼Œå¯ä»¥æ³¨å…¥ C å‡½æ•°è®© Lua ä»£ç è°ƒç”¨ã€‚ è¿™äº›æ‰©å±•çš„ C å‡½æ•°ï¼Œå¯ä»¥å¤§å¤§çš„æ‰©å±•äº† Lua å¯ä»¥å¤„ç†äº‹åŠ¡çš„é¢†åŸŸï¼Œè¿™æ ·å°±å¯ä»¥è®¢åˆ¶å‡ºå„ç§è¯­è¨€ï¼Œ è€Œå®ƒä»¬å…±äº«ä¸€ä¸ªç»Ÿä¸€çš„å¥æ³•æ ¼å¼çš„æ¡†æ¶ã€‚ Lua çš„å®˜æ–¹å‘å¸ƒç‰ˆå°±åŒ…å«äº†ä¸€ä¸ªå«åš lua çš„ç®€å•çš„å®¿ä¸»ç¨‹åºï¼Œå®ƒç”¨ Lua åº“æä¾›äº†ä¸€ä¸ªä¿è¯ç‹¬ç«‹çš„ Lua è§£é‡Šå™¨ã€‚Lua æ˜¯ä¸€ä¸ªè‡ªç”±è½¯ä»¶ï¼Œå®ƒçš„ä½¿ç”¨è®¸å¯å†³å®šäº†å¯¹å®ƒçš„ä½¿ç”¨è¿‡ç¨‹ä¸€èˆ¬æ²¡æœ‰ä»»ä½•ä¿è¯ã€‚ è¿™ä»½æ‰‹å†Œä¸­æè¿°çš„ä¸œè¥¿çš„å®ç°ï¼Œå¯ä»¥åœ¨ Lua çš„å®˜æ–¹ç½‘ç«™ www.lua.org æ‰¾åˆ°ï¼Œè·Ÿå…¶å®ƒçš„è®¸å¤šå‚è€ƒæ‰‹å†Œä¸€æ ·ï¼Œè¿™ä»½æ–‡æ¡£æœ‰äº›åœ°æ–¹æ¯”è¾ƒæ¯ç‡¥ã€‚ å…³äº Lua çš„è®¾è®¡æƒ³æ³•çš„æ¢è®¨ï¼Œå¯ä»¥çœ‹çœ‹ Lua ç½‘ç«™ä¸Šæä¾›çš„æŠ€æœ¯è®ºæ–‡ã€‚ æœ‰å…³ç”¨ Lua ç¼–ç¨‹çš„ç»†èŠ‚ä»‹ç»ï¼Œå¯ä»¥è¯»ä¸€ä¸‹ Roberto çš„ä¹¦ï¼ŒProgramming in Lua (Second Edition) ã€‚ è¿™ä¸€èŠ‚ä»è¯æ³•ã€è¯­æ³•ã€å¥æ³•ä¸Šæè¿° Lua ã€‚ æ¢å¥è¯è¯´ï¼Œè¿™ä¸€èŠ‚æè¿°äº†å“ªäº› token ï¼ˆç¬¦è®°ï¼‰æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒä»¬å¦‚ä½•è¢«ç»„åˆèµ·æ¥ï¼Œè¿™äº›ç»„åˆæ–¹å¼æœ‰ä»€ä¹ˆå«ä¹‰ã€‚å…³äºè¯­è¨€çš„æ„æˆæ¦‚å¿µå°†ç”¨å¸¸è§çš„æ‰©å±• BNF è¡¨è¾¾å¼å†™å‡ºã€‚ä¹Ÿå°±æ˜¯è¿™ä¸ªæ ·å­ï¼š {a} æ„æ€æ˜¯ 0 æˆ–å¤šä¸ª a ï¼Œ [a] æ„æ€æ˜¯ä¸€ä¸ªå¯é€‰çš„ a ã€‚ éæœ€ç»ˆçš„ç¬¦å·ä¼šä¿ç•™åŸæ¥çš„æ ·å­ï¼Œå…³é”®å­—åˆ™çœ‹èµ·æ¥åƒè¿™æ · kword ï¼Œ å…¶å®ƒæœ€ç»ˆçš„ç¬¦å·åˆ™å†™æˆ `=Â´ ã€‚ å®Œæ•´çš„ Lua è¯­æ³•å¯ä»¥åœ¨æœ¬æ‰‹å†Œæœ€åæ‰¾åˆ°ã€‚ Lua ä¸­ç”¨åˆ°çš„ åå­—ï¼ˆä¹Ÿç§°ä½œ æ ‡è¯†ç¬¦ï¼‰å¯ä»¥æ˜¯ä»»ä½•éæ•°å­—å¼€å¤´çš„å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ç»„æˆçš„å­—ç¬¦ä¸²ã€‚ è¿™ç¬¦åˆå‡ ä¹æ‰€æœ‰ç¼–ç¨‹è¯­è¨€ä¸­å…³äºåå­—çš„å®šä¹‰ã€‚ ï¼ˆå­—æ¯çš„å®šä¹‰ä¾èµ–äºå½“å‰ç¯å¢ƒï¼šç³»ç»Ÿç¯å¢ƒä¸­å®šä¹‰çš„å­—æ¯è¡¨ä¸­çš„å­—æ¯éƒ½å¯ä»¥è¢«ç”¨äºæ ‡è¯†ç¬¦ã€‚ï¼‰ æ ‡è¯†ç¬¦ç”¨æ¥å‘½åå˜é‡ï¼Œæˆ–ä½œä¸ºè¡¨çš„åŸŸåã€‚ ä¸‹é¢çš„å…³é”®å­—æ˜¯ä¿ç•™çš„ï¼Œä¸èƒ½ç”¨ä½œåå­—ï¼š and break do else elseif end false for function if in local nil not or repeat return then true until while Lua æ˜¯ä¸€ä¸ªå¤§å°å†™æ•æ„Ÿçš„è¯­è¨€ï¼š and æ˜¯ä¸€ä¸ªä¿ç•™å­—ï¼Œä½†æ˜¯ And å’Œ AND åˆ™æ˜¯ä¸¤ä¸ªä¸åŒçš„åˆæ³•çš„åå­—ã€‚ ä¸€èˆ¬çº¦å®šï¼Œä»¥ä¸‹åˆ’çº¿å¼€å¤´è¿æ¥ä¸€ä¸²å¤§å†™å­—æ¯çš„åå­—ï¼ˆæ¯”å¦‚ _VERSIONï¼‰è¢«ä¿ç•™ç”¨äº Lua å†…éƒ¨å…¨å±€å˜é‡ã€‚ ä¸‹é¢è¿™äº›æ˜¯å…¶å®ƒçš„ token ï¼š + - * / % ^ # == ~= &lt;= &gt;= &lt; &gt; = ( ) { } [ ] ; : , . .. ... å­—ç¬¦ä¸²æ—¢å¯ä»¥ç”¨ä¸€å¯¹å•å¼•å·å¼•èµ·ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒå¼•å·ï¼Œé‡Œé¢è¿˜å¯ä»¥åŒ…å«ç±»ä¼¼ C çš„è½¬ä¹‰ç¬¦ï¼š â€˜\aâ€™ ï¼ˆå“é“ƒï¼‰ï¼Œ â€˜\bâ€™ ï¼ˆé€€æ ¼ï¼‰ï¼Œ â€˜\fâ€™ ï¼ˆè¡¨å•ï¼‰ï¼Œ â€˜\nâ€™ ï¼ˆæ¢è¡Œï¼‰ï¼Œ â€˜\râ€™ ï¼ˆå›è½¦ï¼‰ï¼Œ â€˜\tâ€™ ï¼ˆæ¨ªå‘åˆ¶è¡¨ï¼‰ï¼Œ â€˜\vâ€™ ï¼ˆçºµå‘åˆ¶è¡¨ï¼‰ï¼Œ â€˜\\â€™ ï¼ˆåæ–œæ ï¼‰ï¼Œ â€˜\â€â€˜ ï¼ˆåŒå¼•å·ï¼‰ï¼Œ ä»¥åŠ â€˜\â€™â€™ ï¼ˆå•å¼•å·)ã€‚ è€Œä¸”ï¼Œå¦‚æœåœ¨ä¸€ä¸ªåæ–œæ åè·Ÿäº†ä¸€ä¸ªçœŸæ­£çš„æ¢è¡Œç¬¦ï¼Œå…¶ç»“æœå°±æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­äº§ç”Ÿä¸€ä¸ªæ¢è¡Œç¬¦ã€‚ æˆ‘ä»¬è¿˜å¯ä»¥ç”¨åæ–œæ åŠ æ•°å­—çš„å½¢å¼ \ddd æ¥æè¿°ä¸€ä¸ªå­—ç¬¦ã€‚è¿™é‡Œï¼Œ ddd æ˜¯ä¸€ä¸²æœ€å¤šä¸‰ä½çš„åè¿›åˆ¶æ•°å­—ã€‚ï¼ˆæ³¨æ„ï¼Œå¦‚æœéœ€è¦åœ¨è¿™ç§æè¿°æ–¹æ³•åæ¥ä¸€ä¸ªæ˜¯æ•°å­—çš„å­—ç¬¦ï¼Œ é‚£ä¹ˆåæ–œæ åå¿…é¡»å†™æ»¡ä¸‰ä¸ªæ•°å­—ã€‚ï¼‰Lua ä¸­çš„å­—ç¬¦ä¸²å¯ä»¥åŒ…å«ä»»ä½• 8 ä½çš„å€¼ã€‚åŒ…æ‹¬ç”¨ â€˜\0â€™ è¡¨ç¤ºçš„é›¶ã€‚åªæœ‰åœ¨ä½ éœ€è¦æŠŠä¸åŒçš„å¼•å·ã€æ¢è¡Œã€åæ–œæ ã€æˆ–æ˜¯é›¶ç»“æŸç¬¦è¿™äº›å­—ç¬¦ç½®å…¥å­—ç¬¦ä¸²æ—¶ï¼Œ ä½ æ‰å¿…é¡»ä½¿ç”¨è½¬ä¹‰ç¬¦ã€‚åˆ«çš„ä»»ä½•å­—ç¬¦éƒ½å¯ä»¥ç›´æ¥å†™åœ¨æ–‡æœ¬é‡Œã€‚ï¼ˆä¸€äº›æ§åˆ¶ç¬¦å¯ä»¥ä¼šå½±å“æ–‡ä»¶ç³»ç»Ÿé€ æˆæŸäº›é—®é¢˜ï¼Œ ä½†æ˜¯ä¸ä¼šå¼•èµ· Lua çš„ä»»ä½•é—®é¢˜ã€‚ï¼‰å­—ç¬¦ä¸²è¿˜å¯ä»¥ç”¨ä¸€ç§é•¿æ‹¬å·æ‹¬èµ·æ¥çš„æ–¹å¼å®šä¹‰ã€‚ æˆ‘ä»¬æŠŠä¸¤ä¸ªæ­£çš„æ–¹æ‹¬å·é—´æ’å…¥ n ä¸ªç­‰å·å®šä¹‰ä¸ºç¬¬ n çº§æ­£é•¿æ‹¬å·ã€‚ å°±æ˜¯è¯´ï¼Œ0 çº§æ­£çš„é•¿æ‹¬å·å†™ä½œ [[ ï¼Œ ä¸€çº§æ­£çš„é•¿æ‹¬å·å†™ä½œ [=[ ï¼Œå¦‚æ­¤ç­‰ç­‰ã€‚ åçš„é•¿æ‰©å±•ä¹Ÿä½œç±»ä¼¼å®šä¹‰ï¼› ä¸¾ä¸ªä¾‹å­ï¼Œ4 çº§åçš„é•¿æ‹¬å·å†™ä½œ ]====] ã€‚ ä¸€ä¸ªé•¿å­—ç¬¦ä¸²å¯ä»¥ç”±ä»»ä½•ä¸€çº§çš„æ­£çš„é•¿æ‹¬å·å¼€å§‹ï¼Œè€Œç”±ç¬¬ä¸€ä¸ªç¢°åˆ°çš„åŒçº§åçš„é•¿æ‹¬å·ç»“æŸã€‚ æ•´ä¸ªè¯æ³•åˆ†æè¿‡ç¨‹å°†ä¸å—åˆ†è¡Œé™åˆ¶ï¼Œä¸å¤„ç†ä»»ä½•è½¬æ„ç¬¦ï¼Œå¹¶ä¸”å¿½ç•¥æ‰ä»»ä½•ä¸åŒçº§åˆ«çš„é•¿æ‹¬å·ã€‚ è¿™ç§æ–¹å¼æè¿°çš„å­—ç¬¦ä¸²å¯ä»¥åŒ…å«ä»»ä½•ä¸œè¥¿ï¼Œå½“ç„¶ç‰¹å®šçº§åˆ«çš„åé•¿æ‹¬å·é™¤å¤–ã€‚å¦ä¸€ä¸ªçº¦å®šæ˜¯ï¼Œå½“æ­£çš„é•¿æ‹¬å·åé¢ç«‹å³è·Ÿäº†ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œ è¿™ä¸ªæ¢è¡Œç¬¦å°±ä¸åŒ…å«åœ¨è¿™ä¸ªå­—ç¬¦ä¸²å†…ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä¸€ä¸ªç³»ç»Ÿä½¿ç”¨ ASCII ç  ï¼ˆè¿™æ—¶ï¼Œâ€™aâ€™ ç¼–ç ä¸º 97 ï¼Œæ¢è¡Œç¬¦ç¼–ç ä¸º 10 ï¼Œâ€™1â€™ ç¼–ç ä¸º 49 ï¼‰ï¼Œ ä¸‹é¢äº”ç§æ–¹å¼æè¿°äº†å®Œå…¨ç›¸åŒçš„å­—ç¬¦ä¸²ï¼š a = &#39;alo\n123&quot;&#39; a = &quot;alo\n123\&quot;&quot; a = &#39;\97lo\10\04923&quot;&#39; a = [[alo 123&quot;]] a = [==[ alo 123&quot;]==] æ•°å­—å¸¸é‡å¯ä»¥åˆ†ä¸¤éƒ¨åˆ†å†™ï¼Œåè¿›åˆ¶åº•æ•°éƒ¨åˆ†å’Œåè¿›åˆ¶çš„æŒ‡æ•°éƒ¨åˆ†ã€‚æŒ‡æ•°éƒ¨åˆ†æ˜¯å¯é€‰çš„ã€‚ Lua ä¹Ÿæ”¯æŒåå…­è¿›åˆ¶æ•´æ•°å¸¸é‡ï¼Œåªéœ€è¦åœ¨å‰é¢åŠ ä¸Šå‰ç¼€ 0x ã€‚ ä¸‹é¢æ˜¯ä¸€äº›åˆæ³•çš„æ•°å­—å¸¸é‡çš„ä¾‹å­ï¼š 3 3.0 3.1416 314.16e-2 0.31416E1 0xff 0x56 æ³¨é‡Šå¯ä»¥åœ¨é™¤å­—ç¬¦ä¸²å†…çš„ä»»ä½•åœ°æ–¹æ˜¯ä»¥ä¸¤æ¨ª (â€”) å¼€å§‹ã€‚ å¦‚æœè·Ÿåœ¨ä¸¤æ¨ªåé¢çš„ä¸æ˜¯ä¸€ä¸ªé•¿æ‹¬å·ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªçŸ­æ³¨é‡Šï¼Œå®ƒçš„ä½œç”¨èŒƒå›´ç›´åˆ°è¡Œæœ«ï¼› å¦åˆ™å°±æ˜¯ä¸€ä¸ªé•¿æ³¨é‡Šï¼Œå…¶ä½œç”¨èŒƒå›´ç›´åˆ°é‡åˆ°åçš„é•¿æ‹¬å·ã€‚ é•¿æ³¨é‡Šé€šå¸¸è¢«ç”¨æ¥ä¸´æ—¶å±è”½ä»£ç å—ã€‚Lua æ˜¯ä¸€ç§ åŠ¨æ€ç±»å‹è¯­è¨€ã€‚ è¿™æ„å‘³ç€å˜é‡æ²¡æœ‰ç±»å‹ï¼Œåªæœ‰å€¼æ‰æœ‰ç±»å‹ã€‚ è¯­è¨€ä¸­ä¸å­˜åœ¨ç±»å‹å®šä¹‰ã€‚è€Œæ‰€æœ‰çš„å€¼æœ¬èº«æºå¸¦å®ƒä»¬è‡ªå·±çš„ç±»å‹ä¿¡æ¯ã€‚Lua ä¸­çš„æ‰€æœ‰å€¼éƒ½æ˜¯ä¸€è‡´ (first-class) çš„ã€‚ è¿™æ„å‘³ç€æ‰€æœ‰çš„å€¼éƒ½å¯ä»¥è¢«æ”¾åœ¨å˜é‡é‡Œï¼Œå½“ä½œå‚æ•°ä¼ é€’åˆ°å¦ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œå¹¶è¢«å‡½æ•°ä½œä¸ºç»“æœè¿”å›ã€‚Lua ä¸­æœ‰å…«ç§åŸºæœ¬ç±»å‹ï¼š nil, boolean, number, string, function, userdata, thread, and table. Nil ç±»å‹åªæœ‰ä¸€ç§å€¼ nil ï¼Œå®ƒçš„ä¸»è¦ç”¨é€”ç”¨äºæ ‡è¡¨è¯†å’Œåˆ«çš„ä»»ä½•å€¼çš„å·®å¼‚ï¼› é€šå¸¸ï¼Œå½“éœ€è¦æè¿°ä¸€ä¸ªæ— æ„ä¹‰çš„å€¼æ—¶ä¼šç”¨åˆ°å®ƒã€‚ Boolean ç±»å‹åªæœ‰ä¸¤ç§å€¼ï¼šfalse å’Œ trueã€‚ nil å’Œ false éƒ½èƒ½å¯¼è‡´æ¡ä»¶ä¸ºå‡ï¼›è€Œå¦å¤–æ‰€æœ‰çš„å€¼éƒ½è¢«å½“ä½œçœŸã€‚ Number è¡¨ç¤ºå®æ•°ï¼ˆåŒç²¾åº¦æµ®ç‚¹æ•°ï¼‰ã€‚ ï¼ˆç¼–è¯‘ä¸€ä¸ªå…¶å®ƒå†…éƒ¨æ•°å­—ç±»å‹çš„ Lua è§£é‡Šå™¨æ˜¯ä»¶å¾ˆå®¹æ˜“çš„äº‹ï¼›æ¯”å¦‚æŠŠå†…éƒ¨æ•°å­—ç±»å‹æ”¹ä½œ å•ç²¾åº¦æµ®ç‚¹æ•°æˆ–é•¿æ•´å‹ã€‚å‚è§æ–‡ä»¶ luaconf.h ã€‚ï¼‰ String è¡¨ç¤ºä¸€ä¸²å­—ç¬¦çš„æ•°ç»„ã€‚ Lua æ˜¯ 8-bit clean çš„ï¼š å­—ç¬¦ä¸²å¯ä»¥åŒ…å«ä»»ä½• 8 ä½å­—ç¬¦ï¼Œ åŒ…æ‹¬é›¶ç»“æŸç¬¦ (â€˜\0â€™) ï¼ˆå‚è§ Â§2.1ï¼‰ã€‚Lua å¯ä»¥è°ƒç”¨ï¼ˆå’Œå¤„ç†ï¼‰ç”¨ Lua å†™çš„å‡½æ•°ä»¥åŠç”¨ C å†™çš„å‡½æ•°userdata ç±»å‹ç”¨æ¥å°†ä»»æ„ C æ•°æ®ä¿å­˜åœ¨ Lua å˜é‡ä¸­ã€‚ è¿™ä¸ªç±»å‹ç›¸å½“äºä¸€å—åŸç”Ÿçš„å†…å­˜ï¼Œé™¤äº†èµ‹å€¼å’Œç›¸åŒæ€§åˆ¤æ–­ï¼ŒLua æ²¡æœ‰ä¸ºä¹‹é¢„å®šä¹‰ä»»ä½•æ“ä½œã€‚ ç„¶è€Œï¼Œé€šè¿‡ä½¿ç”¨ metatable ï¼ˆå…ƒè¡¨ï¼‰ ï¼Œç¨‹åºå‘˜å¯ä»¥ä¸º userdata è‡ªå®šä¹‰ä¸€ç»„æ“ä½œã€‚ userdata ä¸èƒ½åœ¨ Lua ä¸­åˆ›å»ºå‡ºæ¥ï¼Œä¹Ÿä¸èƒ½åœ¨ Lua ä¸­ä¿®æ”¹ã€‚è¿™æ ·çš„æ“ä½œåªèƒ½é€šè¿‡ C APIã€‚ è¿™ä¸€ç‚¹ä¿è¯äº†å®¿ä¸»ç¨‹åºå®Œå…¨æŒç®¡å…¶ä¸­çš„æ•°æ®ã€‚thread ç±»å‹ç”¨æ¥åŒºåˆ«ç‹¬ç«‹çš„æ‰§è¡Œçº¿ç¨‹ï¼Œå®ƒè¢«ç”¨æ¥å®ç° coroutine ï¼ˆååŒä¾‹ç¨‹ï¼‰ã€‚ ä¸è¦æŠŠ Lua çº¿ç¨‹è·Ÿæ“ä½œç³»ç»Ÿçš„çº¿ç¨‹ææ··ã€‚ Lua å¯ä»¥åœ¨æ‰€æœ‰çš„ç³»ç»Ÿä¸Šæä¾›å¯¹ coroutine çš„æ”¯æŒï¼Œå³ä½¿ç³»ç»Ÿå¹¶ä¸æ”¯æŒçº¿ç¨‹ã€‚table ç±»å‹å®ç°äº†ä¸€ä¸ªå…³è”æ•°ç»„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ æ•°ç»„å¯ä»¥ç”¨ä»»ä½•ä¸œè¥¿ï¼ˆé™¤äº†nilï¼‰åšç´¢å¼•ï¼Œè€Œä¸é™äºæ•°å­—ã€‚ table å¯ä»¥ä»¥ä¸åŒç±»å‹çš„å€¼æ„æˆï¼›å®ƒå¯ä»¥åŒ…å«æ‰€æœ‰çš„ç±»å‹çš„å€¼ï¼ˆé™¤ nil å¤–ï¼‰ã€‚ table æ˜¯ lua ä¸­å”¯ä¸€çš„ä¸€ç§æ•°æ®ç»“æ„ï¼›å®ƒå¯ä»¥ç”¨æ¥æè¿°åŸå§‹çš„æ•°ç»„ã€ç¬¦å·è¡¨ã€é›†åˆã€ è®°å½•ã€å›¾ã€æ ‘ã€ç­‰ç­‰ã€‚ ç”¨äºè¡¨è¿°è®°å½•æ—¶ï¼Œlua ä½¿ç”¨åŸŸåä½œä¸ºç´¢å¼•ã€‚ è¯­è¨€æœ¬èº«é‡‡ç”¨ä¸€ç§è¯­æ³•ç³–ï¼Œæ”¯æŒä»¥ a.name çš„å½¢å¼è¡¨ç¤º a[â€œnameâ€]ã€‚ æœ‰å¾ˆå¤šå½¢å¼ç”¨äºåœ¨ lua ä¸­åˆ›å»ºä¸€ä¸ª table ï¼ˆå‚è§ Â§2.5.7ï¼‰ã€‚è·Ÿç´¢å¼•ä¸€æ ·ï¼Œ table æ¯ä¸ªåŸŸä¸­çš„å€¼ä¹Ÿå¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼ˆé™¤ nilå¤–ï¼‰ã€‚ ç‰¹åˆ«çš„ï¼Œå› ä¸ºå‡½æ•°æœ¬èº«ä¹Ÿæ˜¯å€¼ï¼Œæ‰€ä»¥ table çš„åŸŸä¸­ä¹Ÿå¯ä»¥æ”¾å‡½æ•°ã€‚ è¿™æ · table ä¸­å°±å¯ä»¥æœ‰ä¸€äº› methods äº† ã€‚tableï¼Œ function ï¼Œthread ï¼Œå’Œ (full) userdata è¿™äº›ç±»å‹çš„å€¼æ˜¯æ‰€è°“çš„å¯¹è±¡ï¼š å˜é‡æœ¬èº«å¹¶ä¸ä¼šçœŸæ­£çš„å­˜æ”¾å®ƒä»¬çš„å€¼ï¼Œè€Œåªæ˜¯æ”¾äº†ä¸€ä¸ªå¯¹å¯¹è±¡çš„å¼•ç”¨ã€‚ èµ‹å€¼ï¼Œå‚æ•°ä¼ é€’ï¼Œå‡½æ•°è¿”å›ï¼Œéƒ½æ˜¯å¯¹è¿™äº›å¯¹è±¡çš„å¼•ç”¨è¿›è¡Œæ“ä½œï¼› è¿™äº›æ“ä½œä¸ä¼šåšæš—åœ°é‡Œåšä»»ä½•æ€§è´¨çš„æ‹·è´ã€‚åº“å‡½æ•° type å¯ä»¥è¿”å›ä¸€ä¸ªæè¿°ç»™å®šå€¼çš„ç±»å‹çš„å­—ç¬¦ä¸²ã€‚Lua æä¾›è¿è¡Œæ—¶å­—ç¬¦ä¸²åˆ°æ•°å­—çš„è‡ªåŠ¨è½¬æ¢ã€‚ ä»»ä½•å¯¹å­—ç¬¦ä¸²çš„æ•°å­¦è¿ç®—æ“ä½œéƒ½ä¼šå°è¯•ç”¨ä¸€èˆ¬çš„è½¬æ¢è§„åˆ™æŠŠè¿™ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆä¸€ä¸ªæ•°å­—ã€‚ ç›¸åï¼Œæ— è®ºä½•æ—¶ï¼Œä¸€ä¸ªæ•°å­—éœ€è¦ä½œä¸ºå­—ç¬¦ä¸²æ¥ä½¿ç”¨æ—¶ï¼Œæ•°å­—éƒ½ä¼šä»¥åˆç†çš„æ ¼å¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚ éœ€è¦å®Œå…¨æ§åˆ¶æ•°å­—æ€æ ·è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²åº“ä¸­çš„ format å‡½æ•° ï¼ˆå‚è§ string.formatï¼‰ã€‚å†™ä¸Šå˜é‡çš„åœ°æ–¹æ„å‘³ç€å½“ä»¥å…¶ä¿å­˜çš„å€¼æ¥æ›¿ä»£ä¹‹ã€‚ Lua ä¸­æœ‰ä¸‰ç±»å˜é‡ï¼šå…¨å±€å˜é‡ï¼Œå±€éƒ¨å˜é‡ï¼Œè¿˜æœ‰ table çš„åŸŸã€‚ä¸€ä¸ªå•ä¸€çš„åå­—å¯ä»¥è¡¨ç¤ºä¸€ä¸ªå…¨å±€å˜é‡ï¼Œä¹Ÿå¯ä»¥è¡¨ç¤ºä¸€ä¸ªå±€éƒ¨å˜é‡ ï¼ˆæˆ–è€…æ˜¯ä¸€ä¸ªå‡½æ•°çš„å‚æ•°ï¼Œè¿™æ˜¯ä¸€ç§ç‰¹æ®Šå½¢å¼çš„å±€éƒ¨å˜é‡ï¼‰ï¼š var ::= Name Name å°±æ˜¯æ‰€å®šä¹‰çš„æ ‡è¯†ç¬¦ã€‚ä»»ä½•å˜é‡éƒ½è¢«å‡å®šä¸ºå…¨å±€å˜é‡ï¼Œé™¤éæ˜¾å¼çš„ä»¥ local ä¿®é¥°å®šä¹‰ã€‚ å±€éƒ¨å˜é‡æœ‰å…¶ä½œç”¨èŒƒå›´ï¼š å±€éƒ¨å˜é‡å¯ä»¥è¢«å®šä¹‰åœ¨å®ƒä½œç”¨èŒƒå›´ä¸­çš„å‡½æ•°è‡ªç”±ä½¿ç”¨ã€‚åœ¨å˜é‡çš„é¦–æ¬¡èµ‹å€¼ä¹‹å‰ï¼Œå˜é‡çš„å€¼å‡ä¸º nilã€‚æ–¹æ‹¬å·è¢«ç”¨æ¥å¯¹ table ä½œç´¢å¼•ï¼š var ::= prefixexp `[Â´ exp `]Â´ å¯¹å…¨å±€å˜é‡ä»¥åŠ table åŸŸä¹‹è®¿é—®çš„å«ä¹‰å¯ä»¥é€šè¿‡ metatable æ¥æ”¹å˜ã€‚ ä»¥å–ä¸€ä¸ªå˜é‡ä¸‹æ ‡æŒ‡å‘çš„é‡ t[i] ç­‰ä»·äºè°ƒç”¨ gettable_event(t,i)ã€‚ ï¼ˆå‚è§ Â§2.8 ï¼Œæœ‰ä¸€ä»½å®Œæ•´çš„å…³äº gettable_event å‡½æ•°çš„è¯´æ˜ã€‚ è¿™ä¸ªå‡½æ•°å¹¶æ²¡æœ‰åœ¨ lua ä¸­å®šä¹‰å‡ºæ¥ï¼Œä¹Ÿä¸èƒ½åœ¨ lua ä¸­è°ƒç”¨ã€‚ è¿™é‡Œæˆ‘ä»¬æŠŠå®ƒåˆ—å‡ºæ¥åªæ˜¯æ–¹ä¾¿è¯´æ˜ã€‚ï¼‰ var.Name è¿™ç§è¯­æ³•åªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œç”¨æ¥è¡¨ç¤º var[â€œNameâ€]ï¼š var ::= prefixexp `.Â´ Name æ‰€æœ‰çš„å…¨å±€å˜é‡éƒ½æ˜¯æ”¾åœ¨ä¸€ä¸ªç‰¹å®š lua table çš„è¯¸ä¸ªåŸŸä¸­ï¼Œè¿™ä¸ªç‰¹å®šçš„ table å«ä½œ environment ï¼ˆç¯å¢ƒï¼‰table æˆ–è€…ç®€ç§°ä¸º ç¯å¢ƒ ï¼ˆå‚è§ Â§2.9ï¼‰ã€‚ æ¯ä¸ªå‡½æ•°éƒ½æœ‰å¯¹ä¸€ä¸ªç¯å¢ƒçš„å¼•ç”¨ï¼Œ æ‰€ä»¥ä¸€ä¸ªå‡½æ•°ä¸­å¯è§çš„æ‰€æœ‰å…¨å±€å˜é‡éƒ½æ”¾åœ¨è¿™ä¸ªå‡½æ•°æ‰€å¼•ç”¨çš„ç¯å¢ƒè¡¨ï¼ˆenvironment tableï¼‰ä¸­ã€‚ å½“ä¸€ä¸ªå‡½æ•°è¢«åˆ›å»ºå‡ºæ¥ï¼Œå®ƒä¼šä»åˆ›å»ºå®ƒçš„å‡½æ•°ä¸­ç»§æ‰¿å…¶ç¯å¢ƒï¼Œä½ å¯ä»¥è°ƒç”¨ getfenv å–å¾—å…¶ç¯å¢ƒã€‚ å¦‚æœæƒ³æ”¹å˜ç¯å¢ƒï¼Œå¯ä»¥è°ƒç”¨ setfenvã€‚ ï¼ˆå¯¹äº C å‡½æ•°ï¼Œä½ åªèƒ½é€šè¿‡ debug åº“æ¥æ”¹å˜å…¶ç¯å¢ƒï¼› å‚è§ Â§5.9ï¼‰ã€‚ å¯¹ä¸€ä¸ªå…¨å±€å˜é‡ x çš„è®¿é—® ç­‰ä»·äº _env.xï¼Œè€Œè¿™åˆå¯ä»¥ç­‰ä»·äº gettable_event(_env, &quot;x&quot;) è¿™é‡Œï¼Œ_env æ˜¯å½“å‰è¿è¡Œçš„å‡½æ•°çš„ç¯å¢ƒã€‚ ï¼ˆå‡½æ•° gettable_event çš„å®Œæ•´è¯´æ˜å‚è§ Â§2.8ã€‚ è¿™ä¸ªå‡½æ•°å¹¶æ²¡æœ‰åœ¨ lua ä¸­å®šä¹‰å‡ºæ¥ï¼Œä¹Ÿä¸èƒ½è°ƒç”¨ã€‚ å½“ç„¶ï¼Œ_env è¿™ä¸ªå˜é‡ä¹ŸåŒæ ·æ²¡æœ‰åœ¨ Lua ä¸­å®šä¹‰å‡ºæ¥ã€‚ æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨å®ƒä»¬ï¼Œä»…ä»…åªæ˜¯æ–¹ä¾¿è§£é‡Šè€Œå·²ã€‚ï¼‰ 2.4 - è¯­å¥æ®µï¼ˆStatementï¼‰Lua æ”¯æŒæƒ¯ä¾‹å½¢å¼çš„è¯­å¥æ®µï¼Œå®ƒå’Œ Pascal æˆ–æ˜¯ C å¾ˆç›¸è±¡ã€‚ è¿™ä¸ªé›†åˆåŒ…æ‹¬èµ‹å€¼ï¼Œæ§åˆ¶ç»“æ„ï¼Œå‡½æ•°è°ƒç”¨ï¼Œè¿˜æœ‰å˜é‡å£°æ˜ã€‚ 2.4.1 - Chunkï¼ˆè¯­å¥ç»„ï¼‰Lua çš„ä¸€ä¸ªæ‰§è¡Œå•å…ƒè¢«ç§°ä½œ chunkã€‚ ä¸€ä¸ª chunk å°±æ˜¯ä¸€ä¸²è¯­å¥æ®µï¼Œå®ƒä»¬ä¼šè¢«å¾ªåºçš„æ‰§è¡Œã€‚ æ¯ä¸ªè¯­å¥æ®µå¯ä»¥ä»¥ä¸€ä¸ªåˆ†å·ç»“æŸï¼š chunk ::= {stat [`;Â´]} è¿™å„¿ä¸å…è®¸æœ‰ç©ºçš„è¯­å¥æ®µï¼Œæ‰€ä»¥ â€˜;;â€™ æ˜¯éæ³•çš„ã€‚ lua æŠŠä¸€ä¸ª chunk å½“ä½œä¸€ä¸ªæ‹¥æœ‰ä¸å®šå‚æ•°çš„åŒ¿åå‡½æ•° ï¼ˆå‚è§ Â§2.5.9ï¼‰å¤„ç†ã€‚ æ­£æ˜¯è¿™æ ·ï¼Œchunk å†…å¯ä»¥å®šä¹‰å±€éƒ¨å˜é‡ï¼Œæ¥æ”¶å‚æ•°ï¼Œå¹¶ä¸”è¿”å›å€¼ã€‚ chunk å¯ä»¥è¢«ä¿å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯ä»¥ä¿å­˜åœ¨å®¿ä¸»ç¨‹åºçš„ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚ å½“ä¸€ä¸ª chunk è¢«æ‰§è¡Œï¼Œé¦–å…ˆå®ƒä¼šè¢«é¢„ç¼–è¯‘æˆè™šæ‹Ÿæœºä¸­çš„æŒ‡ä»¤åºåˆ—ï¼Œ ç„¶åè¢«è™šæ‹Ÿæœºè§£é‡Šè¿è¡Œè¿™äº›æŒ‡ä»¤ã€‚ chunk ä¹Ÿå¯ä»¥è¢«é¢„ç¼–è¯‘æˆäºŒè¿›åˆ¶å½¢å¼ï¼›ç»†èŠ‚å‚è€ƒç¨‹åº luacã€‚ ç”¨æºç å½¢å¼æä¾›çš„ç¨‹åºå’Œè¢«ç¼–è¯‘è¿‡çš„äºŒè¿›åˆ¶å½¢å¼çš„ç¨‹åºæ˜¯å¯ä»¥ç›¸äº’æ›¿æ¢çš„ï¼› Lua ä¼šè‡ªåŠ¨è¯†åˆ«æ–‡ä»¶ç±»å‹å¹¶åšæ­£ç¡®çš„å¤„ç†ã€‚ è¯­å¥å—æ˜¯ä¸€åˆ—è¯­å¥æ®µï¼›ä»è¯­æ³•ä¸Šæ¥è¯´ï¼Œä¸€ä¸ªè¯­å¥å—è·Ÿä¸€ä¸ª chunk ç›¸åŒï¼š block ::= chunk ä¸€ä¸ªè¯­å¥å—å¯ä»¥è¢«æ˜¾å¼çš„å†™æˆä¸€ä¸ªå•ç‹¬çš„è¯­å¥æ®µï¼š stat ::= do block end æ˜¾å¼çš„è¯­å¥å—å¯¹äºæ§åˆ¶å˜é‡çš„ä½œç”¨èŒƒå›´å¾ˆæœ‰ç”¨ã€‚ æœ‰æ—¶å€™ï¼Œæ˜¾å¼çš„è¯­å¥å—è¢«ç”¨æ¥åœ¨å¦ä¸€ä¸ªè¯­å¥å—ä¸­æ’å…¥ return æˆ–æ˜¯ break ï¼ˆå‚è§ Â§2.4.4ï¼‰ã€‚ Lua å…è®¸å¤šé‡èµ‹å€¼ã€‚ å› æ­¤ï¼Œèµ‹å€¼çš„è¯­æ³•å®šä¹‰æ˜¯ç­‰å·å·¦è¾¹æ”¾ä¸€ç³»åˆ—å˜é‡ï¼Œ è€Œç­‰å·å³è¾¹æ”¾ä¸€ç³»åˆ—çš„è¡¨è¾¾å¼ã€‚ ä¸¤è¾¹çš„å…ƒç´ éƒ½ç”¨é€—å·é—´å¼€ï¼š stat ::= varlist1 `=Â´ explist1 varlist1 ::= var {`,Â´ var} explist1 ::= exp {`,Â´ exp} åœ¨ä½œèµ‹å€¼æ“ä½œä¹‹å‰ï¼Œ é‚£ä¸€ç³»åˆ—çš„å³å€¼ä¼šè¢«å¯¹é½åˆ°å·¦è¾¹å˜é‡éœ€è¦çš„ä¸ªæ•°ã€‚ å¦‚æœå³å€¼æ¯”éœ€è¦çš„æ›´å¤šçš„è¯ï¼Œå¤šä½™çš„å€¼å°±è¢«æ‰”æ‰ã€‚ å¦‚æœå³å€¼çš„æ•°é‡ä¸å¤Ÿéœ€æ±‚ï¼Œ å°†ä¼šæŒ‰æ‰€éœ€æ‰©å±•è‹¥å¹²ä¸ª nilã€‚ å¦‚æœè¡¨è¾¾å¼åˆ—è¡¨ä»¥ä¸€ä¸ªå‡½æ•°è°ƒç”¨ç»“æŸï¼Œ è¿™ä¸ªå‡½æ•°æ‰€è¿”å›çš„æ‰€æœ‰å€¼éƒ½ä¼šåœ¨å¯¹é½æ“ä½œä¹‹å‰è¢«ç½®å…¥å³å€¼åºåˆ—ä¸­ã€‚ ï¼ˆé™¤éè¿™ä¸ªå‡½æ•°è°ƒç”¨è¢«ç”¨æ‹¬å·æ‹¬äº†èµ·æ¥ï¼›å‚è§ Â§2.5ï¼‰ã€‚ èµ‹å€¼æ®µé¦–å…ˆä¼šåšè¿ç®—å®Œæ‰€æœ‰çš„è¡¨è¾¾å¼ï¼Œç„¶åä»…ä»…åšèµ‹å€¼æ“ä½œã€‚ å› æ­¤ï¼Œä¸‹é¢è¿™æ®µä»£ç  i = 3 i, a[i] = i+1, 20 ä¼šæŠŠ a[3] è®¾ç½®ä¸º 20ï¼Œè€Œä¸ä¼šå½±å“åˆ° a[4] ã€‚ è¿™æ˜¯å› ä¸º a[i] ä¸­çš„ i åœ¨è¢«èµ‹å€¼ä¸º 4 ä¹‹å‰å°±è¢«æ‹¿å‡ºæ¥äº†ï¼ˆé‚£æ—¶æ˜¯ 3 ï¼‰ã€‚ ç®€å•è¯´ ï¼Œè¿™æ ·ä¸€è¡Œ x, y = y, x å¯ä»¥ç”¨æ¥äº¤æ¢ x å’Œ y ä¸­çš„å€¼ã€‚ å¯¹å…¨å±€å˜é‡ä»¥åŠ table ä¸­çš„åŸŸçš„èµ‹å€¼æ“ä½œçš„å«ä¹‰å¯ä»¥é€šè¿‡ metatable æ¥æ”¹å˜ã€‚ å¯¹å˜é‡ä¸‹æ ‡æŒ‡å‘çš„èµ‹å€¼ï¼Œå³ t[i] = val ç­‰ä»·äº settable_event(t,i,val)ã€‚ ï¼ˆå…³äºå‡½æ•° settable_event çš„è¯¦ç»†è¯´æ˜ï¼Œå‚è§ Â§2.8ã€‚ è¿™ä¸ªå‡½æ•°å¹¶æ²¡æœ‰åœ¨ Lua ä¸­å®šä¹‰å‡ºæ¥ï¼Œä¹Ÿä¸å¯ä»¥è¢«è°ƒç”¨ã€‚ è¿™é‡Œæˆ‘ä»¬åˆ—å‡ºæ¥ï¼Œä»…ä»…å‡ºäºæ–¹ä¾¿è§£é‡Šçš„ç›®çš„ï¼‰ å¯¹äºå…¨å±€å˜é‡çš„èµ‹å€¼ x = val ç­‰ä»·äº _env.x = valï¼Œè¿™ä¸ªåˆå¯ä»¥ç­‰ä»·äº settable_event(_env, &quot;x&quot;, val) è¿™é‡Œï¼Œ_env æŒ‡çš„æ˜¯æ­£åœ¨è¿è¡Œä¸­çš„å‡½æ•°çš„ç¯å¢ƒã€‚ ï¼ˆå˜é‡ _env å¹¶æ²¡æœ‰åœ¨ Lua ä¸­å®šä¹‰å‡ºæ¥ã€‚ æˆ‘ä»¬ä»…ä»…å‡ºäºè§£é‡Šçš„ç›®çš„åœ¨è¿™é‡Œå†™å‡ºæ¥ã€‚ï¼‰ ifã€ whileã€ä»¥åŠ repeat è¿™äº›æ§åˆ¶ç»“æ„ç¬¦åˆé€šå¸¸çš„æ„ä¹‰ï¼Œè€Œä¸”ä¹Ÿæœ‰ç±»ä¼¼çš„è¯­æ³•ï¼š stat ::= while exp do block end stat ::= repeat block until exp stat ::= if exp then block {elseif exp then block} [else block] end Lua ä¹Ÿæœ‰ä¸€ä¸ª for è¯­å¥ï¼Œå®ƒæœ‰ä¸¤ç§å½¢å¼ã€‚æ§åˆ¶ç»“æ„ä¸­çš„æ¡ä»¶è¡¨è¾¾å¼å¯ä»¥è¿”å›ä»»ä½•å€¼ã€‚ false å’Œ nil ä¸¤è€…éƒ½è¢«è®¤ä¸ºæ˜¯å‡æ¡ä»¶ã€‚ æ‰€æœ‰ä¸åŒäº nil å’Œ false çš„å…¶å®ƒå€¼éƒ½è¢«è®¤ä¸ºæ˜¯çœŸ ï¼ˆç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ•°å­— 0 å’Œç©ºå­—ç¬¦ä¸²ä¹Ÿè¢«è®¤ä¸ºæ˜¯çœŸï¼‰ã€‚åœ¨ repeatâ€“until å¾ªç¯ä¸­ï¼Œ å†…éƒ¨è¯­å¥å—çš„ç»“æŸç‚¹ä¸æ˜¯åœ¨ until è¿™ä¸ªå…³é”®å­—å¤„ï¼Œ å®ƒè¿˜åŒ…æ‹¬äº†å…¶åçš„æ¡ä»¶è¡¨è¾¾å¼ã€‚ å› æ­¤ï¼Œæ¡ä»¶è¡¨è¾¾å¼ä¸­å¯ä»¥ä½¿ç”¨å¾ªç¯å†…éƒ¨è¯­å¥å—ä¸­çš„å®šä¹‰çš„å±€éƒ¨å˜é‡ã€‚return è¢«ç”¨äºä»å‡½æ•°æˆ–æ˜¯ chunkï¼ˆå…¶å®å®ƒå°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰ä¸­ è¿”å›å€¼ã€‚ å‡½æ•°å’Œ chunk å¯ä»¥è¿”å›ä¸åªä¸€ä¸ªå€¼ï¼Œ æ‰€ä»¥ return çš„è¯­æ³•ä¸º stat ::= return [explist1] break è¢«ç”¨æ¥ç»“æŸ whileã€ repeatã€æˆ– for å¾ªç¯ï¼Œ å®ƒå°†å¿½ç•¥æ‰å¾ªç¯ä¸­ä¸‹é¢çš„è¯­å¥æ®µçš„è¿è¡Œï¼š stat ::= break break è·³å‡ºæœ€å†…å±‚çš„å¾ªç¯ã€‚return å’Œ break åªèƒ½è¢«å†™åœ¨ä¸€ä¸ªè¯­å¥å—çš„æœ€åä¸€å¥ã€‚ å¦‚æœä½ çœŸçš„éœ€è¦ä»è¯­å¥å—çš„ä¸­é—´ return æˆ–æ˜¯ break ï¼Œ ä½ å¯ä»¥ä½¿ç”¨æ˜¾å¼çš„å£°åä¸€ä¸ªå†…éƒ¨è¯­å¥å—ã€‚ ä¸€èˆ¬å†™ä½œ do return end æˆ–æ˜¯ do break endï¼Œ å¯ä»¥è¿™æ ·å†™æ˜¯å› ä¸ºç°åœ¨ return æˆ– break éƒ½æˆäº†ä¸€ä¸ªè¯­å¥å—çš„æœ€åä¸€å¥äº†ã€‚ for æœ‰ä¸¤ç§å½¢å¼ï¼šä¸€ç§æ˜¯æ•°å­—å½¢å¼ï¼Œå¦ä¸€ç§æ˜¯ä¸€èˆ¬å½¢å¼ã€‚ æ•°å­—å½¢å¼çš„ for å¾ªç¯ï¼Œé€šè¿‡ä¸€ä¸ªæ•°å­¦è¿ç®—ä¸æ–­çš„è¿è¡Œå†…éƒ¨çš„ä»£ç å—ã€‚ ä¸‹é¢æ˜¯å®ƒçš„è¯­æ³•ï¼š stat ::= for Name `=Â´ exp `,Â´ exp [`,Â´ exp] do block end block å°†æŠŠ name ä½œå¾ªç¯å˜é‡ã€‚ä»ç¬¬ä¸€ä¸ª exp å¼€å§‹èµ·ï¼Œç›´åˆ°ç¬¬äºŒä¸ª exp çš„å€¼ä¸ºæ­¢ï¼Œå…¶æ­¥é•¿ä¸º ç¬¬ä¸‰ä¸ª exp ã€‚ æ›´ç¡®åˆ‡çš„è¯´ï¼Œä¸€ä¸ª for å¾ªç¯çœ‹èµ·æ¥æ˜¯è¿™ä¸ªæ ·å­ for v = e1, e2, e3 do block end è¿™ç­‰ä»·äºä»£ç ï¼š do local var, limit, step = tonumber(e1), tonumber(e2), tonumber(e3) if not (var and limit and step) then error() end while (step &gt; 0 and var &lt;= limit) or (step &lt;= 0 and var &gt;= limit) do local v = var block var = var + step end end æ³¨æ„ä¸‹é¢è¿™å‡ ç‚¹ï¼š æ‰€æœ‰ä¸‰ä¸ªæ§åˆ¶è¡¨è¾¾å¼éƒ½åªè¢«è¿ç®—ä¸€æ¬¡ï¼Œè¡¨è¾¾å¼çš„è®¡ç®—åœ¨å¾ªç¯å¼€å§‹ä¹‹å‰ã€‚ è¿™äº›è¡¨è¾¾å¼çš„ç»“æœå¿…é¡»æ˜¯æ•°å­—ã€‚var ã€limit ã€ä»¥åŠ step éƒ½æ˜¯ä¸€äº›ä¸å¯è§çš„å˜é‡ã€‚ è¿™é‡Œç»™å®ƒä»¬èµ·çš„åå­—éƒ½ä»…ä»…ç”¨äºè§£é‡Šæ–¹ä¾¿ã€‚å¦‚æœç¬¬ä¸‰ä¸ªè¡¨è¾¾å¼ï¼ˆæ­¥é•¿ï¼‰æ²¡æœ‰ç»™å‡ºï¼Œä¼šæŠŠæ­¥é•¿è®¾ä¸º 1 ã€‚ä½ å¯ä»¥ç”¨ break æ¥é€€å‡º for å¾ªç¯ã€‚å¾ªç¯å˜é‡ v æ˜¯ä¸€ä¸ªå¾ªç¯å†…éƒ¨çš„å±€éƒ¨å˜é‡ï¼› å½“ for å¾ªç¯ç»“æŸåï¼Œä½ å°±ä¸èƒ½åœ¨ä½¿ç”¨å®ƒã€‚ å¦‚æœä½ éœ€è¦è¿™ä¸ªå€¼ï¼Œåœ¨é€€å‡ºå¾ªç¯å‰æŠŠå®ƒèµ‹ç»™å¦ä¸€ä¸ªå˜é‡ã€‚ä¸€èˆ¬å½¢å¼çš„ for é€šè¿‡ä¸€ä¸ªå«ä½œè¿­ä»£å™¨ï¼ˆiteratorsï¼‰çš„å‡½æ•°å·¥ä½œã€‚ æ¯æ¬¡è¿­ä»£ï¼Œè¿­ä»£å™¨å‡½æ•°éƒ½ä¼šè¢«è°ƒç”¨ä»¥äº§ç”Ÿä¸€ä¸ªæ–°çš„å€¼ï¼Œ å½“è¿™ä¸ªå€¼ä¸º nil æ—¶ï¼Œå¾ªç¯åœæ­¢ã€‚ ä¸€èˆ¬å½¢å¼çš„ for å¾ªç¯çš„è¯­æ³•å¦‚ä¸‹ï¼š stat ::= for namelist in explist1 do block end namelist ::= Name {`,Â´ Name} for è¯­å¥å¥½ä¼¼è¿™æ · for var_1, Â·Â·Â·, var_n in explist do block end å®ƒç­‰ä»·äºè¿™æ ·ä¸€æ®µä»£ç ï¼š do local f, s, var = explist while true do local var_1, Â·Â·Â·, var_n = f(s, var) var = var_1 if var == nil then break end block end end æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š explist åªä¼šè¢«è®¡ç®—ä¸€æ¬¡ã€‚ å®ƒè¿”å›ä¸‰ä¸ªå€¼ï¼Œ ä¸€ä¸ªè¿­ä»£å™¨å‡½æ•°ï¼Œä¸€ä¸ªçŠ¶æ€ï¼Œä¸€ä¸ªè¿­ä»£å™¨çš„åˆå§‹å€¼ã€‚fã€ sã€ ä»¥åŠ var éƒ½æ˜¯ä¸å¯è§çš„å˜é‡ã€‚ è¿™é‡Œç»™å®ƒä»¬èµ·çš„åå­—éƒ½åªæ˜¯ä¸ºäº†è§£è¯´æ–¹ä¾¿ã€‚ä½ å¯ä»¥ä½¿ç”¨ break æ¥è·³å‡º for å¾ªç¯ã€‚å¾ªç¯å˜é‡ var_i å¯¹äºå¾ªç¯æ¥è¯´æ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼› ä½ ä¸å¯ä»¥åœ¨ for å¾ªç¯ç»“æŸåç»§ç»­ä½¿ç”¨ã€‚ å¦‚æœä½ éœ€è¦ä¿ç•™è¿™äº›å€¼ï¼Œé‚£ä¹ˆå°±åœ¨å¾ªç¯ç»“æŸå‰èµ‹å€¼åˆ°åˆ«çš„å˜é‡é‡Œå»ã€‚2.4.6 - æŠŠå‡½æ•°è°ƒç”¨ä½œä¸ºè¯­å¥æ®µä¸ºäº†å…è®¸ä½¿ç”¨å¯èƒ½çš„å‰¯ä½œç”¨ï¼Œ å‡½æ•°è°ƒç”¨å¯ä»¥è¢«ä½œä¸ºä¸€ä¸ªè¯­å¥æ®µæ‰§è¡Œï¼š stat ::= functioncall åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„è¿”å›å€¼éƒ½è¢«èˆå¼ƒã€‚ å‡½æ•°è°ƒç”¨åœ¨ Â§2.5.8 ä¸­è§£é‡Šã€‚ 2.4.7 - å±€éƒ¨å˜é‡å£°åå±€éƒ¨å˜é‡å¯ä»¥åœ¨è¯­å¥å—ä¸­ä»»ä½•åœ°æ–¹å£°åã€‚ å£°åå¯ä»¥åŒ…å«ä¸€ä¸ªåˆå§‹åŒ–èµ‹å€¼æ“ä½œï¼š stat ::= local namelist [`=Â´ explist1] å¦‚æœæœ‰çš„è¯ï¼Œåˆå§‹åŒ–èµ‹å€¼æ“ä½œçš„è¡Œä¸ºç­‰åŒäºèµ‹å€¼æ“ä½œï¼ˆå‚è§ Â§2.4.3ï¼‰ã€‚ å¦åˆ™ï¼Œæ‰€æœ‰çš„å˜é‡å°†è¢«åˆå§‹åŒ–ä¸º nilã€‚ ä¸€ä¸ª chunk åŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªè¯­å¥å—ï¼ˆå‚è§ Â§2.4.1ï¼‰ï¼Œ æ‰€ä»¥å±€éƒ¨å˜é‡å¯ä»¥æ”¾åœ¨ chunk ä¸­é‚£äº›æ˜¾å¼æ³¨æ˜çš„è¯­å¥å—ä¹‹å¤–ã€‚ è¿™äº›å±€éƒ¨å˜é‡çš„ä½œç”¨èŒƒå›´ä»å£°æ˜èµ·ä¸€ç›´å»¶ä¼¸åˆ° chunk æœ«å°¾ã€‚ å±€éƒ¨å˜é‡çš„å¯è§è§„åˆ™åœ¨ Â§2.6 ä¸­è§£é‡Šã€‚ 2.5 - è¡¨è¾¾å¼Lua ä¸­æœ‰è¿™äº›åŸºæœ¬è¡¨è¾¾å¼ï¼š exp ::= prefixexp exp ::= nil | false | true exp ::= Number exp ::= String exp ::= function exp ::= tableconstructor exp ::= `...Â´ exp ::= exp binop exp exp ::= unop exp prefixexp ::= var | functioncall | `(Â´ exp `)Â´ æ•°å­—å’Œå­—ç¬¦ä¸²åœ¨ Â§2.1 ä¸­è§£é‡Šï¼› å˜é‡åœ¨ Â§2.3 ä¸­è§£é‡Šï¼› å‡½æ•°å®šä¹‰åœ¨ Â§2.5.9 ä¸­è§£é‡Šï¼› å‡½æ•°è°ƒç”¨åœ¨ Â§2.5.8 ä¸­è§£é‡Šï¼› table çš„æ„é€ åœ¨ Â§2.5.7 ä¸­è§£é‡Šï¼› å¯å˜å‚æ•°çš„è¡¨è¾¾å¼å†™ä½œä¸‰ä¸ªç‚¹ (â€˜â€¦â€™) ï¼Œå®ƒåªèƒ½è¢«ç”¨åœ¨æœ‰å¯å˜å‚æ•°çš„å‡½æ•°ä¸­ï¼› è¿™äº›åœ¨ Â§2.5.9 ä¸­è§£é‡Šã€‚ äºŒå…ƒæ“ä½œç¬¦åŒ…å«æœ‰æ•°å­¦è¿ç®—æ“ä½œç¬¦ï¼ˆå‚è§ Â§2.5.1ï¼‰ï¼Œ æ¯”è¾ƒæ“ä½œç¬¦ï¼ˆå‚è§ Â§2.5.2ï¼‰ï¼Œé€»è¾‘æ“ä½œç¬¦ï¼ˆå‚è§ Â§2.5.3ï¼‰ï¼Œ ä»¥åŠè¿æ¥æ“ä½œç¬¦ï¼ˆå‚è§ Â§2.5.4ï¼‰ã€‚ ä¸€å…ƒæ“ä½œç¬¦åŒ…æ‹¬è´Ÿå·ï¼ˆå‚è§see Â§2.5.1ï¼‰ï¼Œ å–å notï¼ˆå‚è§ Â§2.5.3ï¼‰ï¼Œ å’Œå–é•¿åº¦æ“ä½œç¬¦ï¼ˆå‚è§ Â§2.5.5ï¼‰ã€‚ å‡½æ•°è°ƒç”¨å’Œå¯å˜å‚æ•°è¡¨è¾¾å¼éƒ½å¯ä»¥æ”¾åœ¨å¤šé‡è¿”å›å€¼ä¸­ã€‚ å¦‚æœè¡¨è¾¾å¼ä½œä¸ºä¸€ä¸ªç‹¬ç«‹è¯­å¥æ®µå‡ºç°ï¼ˆå‚è§ Â§2.4.6ï¼‰ ï¼ˆè¿™åªèƒ½æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼‰ï¼Œ å®ƒä»¬çš„è¿”å›åˆ—è¡¨å°†è¢«å¯¹é½åˆ°é›¶ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯å¿½ç•¥æ‰€æœ‰è¿”å›å€¼ã€‚ å¦‚æœè¡¨è¾¾å¼ç”¨äºè¡¨è¾¾å¼åˆ—è¡¨çš„æœ€åï¼ˆæˆ–è€…æ˜¯å”¯ä¸€ï¼‰çš„å…ƒç´ ï¼Œ å°±ä¸ä¼šæœ‰ä»»ä½•çš„å¯¹é½æ“ä½œï¼ˆé™¤éå‡½æ•°è°ƒç”¨ç”¨æ‹¬å·æ‹¬èµ·æ¥ï¼‰ã€‚ åœ¨ä»»ä½•å…¶å®ƒçš„æƒ…å†µä¸‹ï¼ŒLua å°†æŠŠè¡¨è¾¾å¼ç»“æœçœ‹æˆå•ä¸€å…ƒç´ ï¼Œ å¿½ç•¥é™¤ç¬¬ä¸€ä¸ªä¹‹å¤–çš„ä»»ä½•å€¼ã€‚ è¿™é‡Œæœ‰ä¸€äº›ä¾‹å­ï¼š f() -- è°ƒæ•´åˆ° 0 ä¸ªç»“æœ g(f(), x) -- f() è¢«è°ƒæ•´åˆ°ä¸€ä¸ªç»“æœ g(x, f()) -- g è¢«ä¼ å…¥ x åŠ ä¸Šæ‰€æœ‰ f() çš„è¿”å›å€¼ a,b,c = f(), x -- f() è¢«è°ƒæ•´åˆ°ä¸€ä¸ªç»“æœ ï¼ˆ c åœ¨è¿™é‡Œè¢«èµ‹ä¸º nil ï¼‰ a,b = ... -- a è¢«èµ‹å€¼ä¸ºå¯å˜å‚æ•°ä¸­çš„ç¬¬ä¸€ä¸ªï¼Œ -- b è¢«èµ‹å€¼ä¸ºç¬¬äºŒä¸ª ï¼ˆå¦‚æœå¯å˜å‚æ•°ä¸­å¹¶æ²¡æœ‰å¯¹åº”çš„å€¼ï¼Œ -- è¿™é‡Œ a å’Œ b éƒ½æœ‰å¯èƒ½è¢«èµ‹ä¸º nilï¼‰ a,b,c = x, f() -- f() è¢«è°ƒæ•´ä¸ºä¸¤ä¸ªç»“æœ a,b,c = f() -- f() è¢«è°ƒæ•´ä¸ºä¸‰ä¸ªç»“æœ return f() -- è¿”å› f() è¿”å›çš„æ‰€æœ‰ç»“æœ return ... -- è¿”å›æ‰€æœ‰ä»å¯å˜å‚æ•°ä¸­æ¥æ”¶æ¥çš„å€¼ return x,y,f() -- è¿”å› x, y, ä»¥åŠæ‰€æœ‰ f() çš„è¿”å›å€¼ {f()} -- ç”¨ f() çš„æ‰€æœ‰è¿”å›å€¼åˆ›å»ºä¸€ä¸ªåˆ—è¡¨ {...} -- ç”¨å¯å˜å‚æ•°ä¸­çš„æ‰€æœ‰å€¼åˆ›å»ºä¸€ä¸ªåˆ—è¡¨ {f(), nil} -- f() è¢«è°ƒæ•´ä¸ºä¸€ä¸ªç»“æœ è¢«æ‹¬å·æ‹¬èµ·æ¥çš„è¡¨è¾¾å¼æ°¸è¿œè¢«å½“ä½œä¸€ä¸ªå€¼ã€‚æ‰€ä»¥ï¼Œ (f(x,y,z)) å³ä½¿ f è¿”å›å¤šä¸ªå€¼ï¼Œè¿™ä¸ªè¡¨è¾¾å¼æ°¸è¿œæ˜¯ä¸€ä¸ªå•ä¸€å€¼ã€‚ ï¼ˆ(f(x,y,z)) çš„å€¼æ˜¯ f è¿”å›çš„ç¬¬ä¸€ä¸ªå€¼ã€‚å¦‚æœ f ä¸è¿”å›å€¼çš„è¯ï¼Œé‚£ä¹ˆå®ƒçš„å€¼å°±æ˜¯ nil ã€‚ï¼‰ 2.5.1 - æ•°å­¦è¿ç®—æ“ä½œç¬¦Lua æ”¯æŒå¸¸è§çš„æ•°å­¦è¿ç®—æ“ä½œç¬¦ï¼š äºŒå…ƒæ“ä½œ + ï¼ˆåŠ æ³•ï¼‰ï¼Œ - ï¼ˆå‡æ³•ï¼‰ï¼Œ* ï¼ˆä¹˜æ³•ï¼‰ï¼Œ / ï¼ˆé™¤æ³•ï¼‰ï¼Œ % ï¼ˆå–æ¨¡ï¼‰ï¼Œä»¥åŠ ^ ï¼ˆå¹‚ï¼‰ï¼› å’Œä¸€å…ƒæ“ä½œ - ï¼ˆå–è´Ÿï¼‰ã€‚ å¦‚æœå¯¹æ•°å­—æ“ä½œï¼Œæˆ–æ˜¯å¯ä»¥è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²ï¼ˆå‚è§ Â§2.2.1ï¼‰ï¼Œ æ‰€æœ‰è¿™äº›æ“ä½œéƒ½ä¾èµ–å®ƒé€šå¸¸çš„å«ä¹‰ã€‚ å¹‚æ“ä½œå¯ä»¥å¯¹ä»»ä½•å¹‚å€¼éƒ½æ­£å¸¸å·¥ä½œã€‚æ¯”å¦‚ï¼Œ x^(-0.5) å°†è®¡ç®—å‡º x å¹³æ–¹æ ¹çš„å€’æ•°ã€‚ å–æ¨¡æ“ä½œè¢«å®šä¹‰ä¸º a % b == a - math.floor(a/b)*b è¿™å°±æ˜¯è¯´ï¼Œå…¶ç»“æœæ˜¯å•†ç›¸å¯¹è´Ÿæ— ç©·åœ†æ•´åçš„ä½™æ•°ã€‚ï¼ˆè¯‘æ³¨ï¼šè´Ÿæ•°å¯¹æ­£æ•°å–æ¨¡çš„ç»“æœä¸ºæ­£æ•°ï¼‰ 2.5.2 - æ¯”è¾ƒæ“ä½œç¬¦Lua ä¸­çš„æ¯”è¾ƒæ“ä½œç¬¦æœ‰ == ~= &lt; &gt; &lt;= &gt;= è¿™äº›æ“ä½œçš„ç»“æœä¸æ˜¯ false å°±æ˜¯ trueã€‚ ç­‰äºæ“ä½œ (==) é¦–å…ˆæ¯”è¾ƒæ“ä½œæ•°çš„ç±»å‹ã€‚ å¦‚æœç±»å‹ä¸åŒï¼Œç»“æœå°±æ˜¯ falseã€‚ å¦åˆ™ï¼Œç»§ç»­æ¯”è¾ƒå€¼ã€‚ æ•°å­—å’Œå­—ç¬¦ä¸²éƒ½ç”¨å¸¸è§„çš„æ–¹å¼æ¯”è¾ƒã€‚ å¯¹è±¡ ï¼ˆtable ï¼Œuserdata ï¼Œthread ï¼Œä»¥åŠå‡½æ•°ï¼‰ä»¥å¼•ç”¨çš„å½¢å¼æ¯”è¾ƒï¼š ä¸¤ä¸ªå¯¹è±¡åªæœ‰åœ¨å®ƒä»¬æŒ‡å‘åŒä¸€ä¸ªä¸œè¥¿æ—¶æ‰è®¤ä¸ºç›¸ç­‰ã€‚ æ¯æ¬¡ä½ åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼ˆä¸€ä¸ª table æˆ–æ˜¯ userdata ï¼Œthread å‡½æ•°ï¼‰ï¼Œ å®ƒä»¬éƒ½å„ä¸ç›¸åŒï¼Œå³ä¸åŒäºä¸Šæ¬¡åˆ›å»ºçš„ä¸œè¥¿ã€‚ ä½ å¯ä»¥æ”¹å˜ Lua æ¯”è¾ƒ table å’Œ userdata çš„æ–¹å¼ï¼Œè¿™éœ€è¦ä½¿ç”¨ â€œeqâ€ è¿™ä¸ªåŸæ–¹æ³• ï¼ˆå‚è§ Â§2.8ï¼‰ã€‚ Â§2.2.1 ä¸­æåŠçš„è½¬æ¢è§„åˆ™å¹¶ä¸ä½œç”¨äºæ¯”è¾ƒæ“ä½œã€‚ æ‰€ä»¥ï¼Œ â€œ0â€==0 ç­‰äº falseï¼Œ è€Œä¸” t[0] å’Œ t[â€œ0â€] æè¿°çš„æ˜¯ table ä¸­ä¸åŒçš„åŸŸã€‚ æ“ä½œç¬¦ ~= å®Œå…¨ç­‰ä»·äº (==) æ“ä½œçš„åå€¼ã€‚ å¤§å°æ¯”è¾ƒæ“ä½œä»¥ä»¥ä¸‹æ–¹å¼è¿›è¡Œã€‚ å¦‚æœå‚æ•°éƒ½æ˜¯æ•°å­—ï¼Œé‚£ä¹ˆå°±ç›´æ¥åšæ•°å­—æ¯”è¾ƒã€‚ å¦åˆ™ï¼Œå¦‚æœå‚æ•°éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œå°±ç”¨å­—ç¬¦ä¸²æ¯”è¾ƒçš„æ–¹å¼è¿›è¡Œã€‚ å†åˆ™ï¼ŒLua å°±è¯•ç€è°ƒç”¨ â€œltâ€ æˆ–æ˜¯ â€œleâ€ å…ƒæ–¹æ³• ï¼ˆå‚è§ Â§2.8ï¼‰ã€‚ 2.5.3 - é€»è¾‘æ“ä½œç¬¦Lua ä¸­çš„é€»è¾‘æ“ä½œç¬¦æœ‰ and, or, ä»¥åŠ notã€‚ å’Œæ§åˆ¶ç»“æ„ï¼ˆå‚è§ Â§2.4.4ï¼‰ä¸€æ ·ï¼Œ æ‰€æœ‰çš„é€»è¾‘æ“ä½œç¬¦æŠŠ false å’Œ nil éƒ½ä½œä¸ºå‡ï¼Œ è€Œå…¶å®ƒçš„ä¸€åˆ‡éƒ½å½“ä½œçœŸã€‚ å–åæ“ä½œ not æ€»æ˜¯è¿”å› false æˆ– true ä¸­çš„ä¸€ä¸ªã€‚ ä¸æ“ä½œç¬¦ and åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸º false æˆ– nil æ—¶ è¿”å›è¿™ç¬¬ä¸€ä¸ªå‚æ•°ï¼› å¦åˆ™ï¼Œand è¿”å›ç¬¬äºŒä¸ªå‚æ•°ã€‚ æˆ–æ“ä½œç¬¦ or åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸ä¸º nil ä¹Ÿä¸ä¸º false æ—¶ï¼Œ è¿”å›è¿™ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¦åˆ™è¿”å›ç¬¬äºŒä¸ªå‚æ•°ã€‚ and å’Œ or éƒ½éµå¾ªçŸ­è·¯è§„åˆ™ï¼› ä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬äºŒä¸ªæ“ä½œæ•°åªåœ¨éœ€è¦çš„æ—¶å€™å»æ±‚å€¼ã€‚ è¿™é‡Œæœ‰ä¸€äº›ä¾‹å­ï¼š 10 or 20 --&gt; 10 10 or error() --&gt; 10 nil or &quot;a&quot; --&gt; &quot;a&quot; nil and 10 --&gt; nil false and error() --&gt; false false and nil --&gt; false false or nil --&gt; nil 10 and 20 --&gt; 20 ï¼ˆåœ¨è¿™æœ¬æ‰‹å†Œä¸­ï¼Œ â€”&gt; æŒ‡å‰é¢è¡¨è¾¾å¼çš„ç»“æœã€‚ï¼‰ 2.5.4 - è¿æ¥ç¬¦Lua ä¸­å­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œç¬¦å†™ä½œä¸¤ä¸ªç‚¹ (â€˜..â€™)ã€‚ å¦‚æœä¸¤ä¸ªæ“ä½œæ•°éƒ½æ˜¯å­—ç¬¦ä¸²æˆ–éƒ½æ˜¯æ•°å­—ï¼Œè¿æ¥æ“ä½œå°†ä»¥ Â§2.2.1 ä¸­æåˆ°çš„è§„åˆ™æŠŠå…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚ å¦åˆ™ï¼Œä¼šå–è°ƒç”¨å…ƒæ–¹æ³• â€œconcatâ€ ï¼ˆå‚è§ Â§2.8ï¼‰ã€‚ 2.5.5 - å–é•¿åº¦æ“ä½œç¬¦å–é•¿åº¦æ“ä½œç¬¦å†™ä½œä¸€å…ƒæ“ä½œ #ã€‚ å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯å®ƒçš„å­—èŠ‚æ•°ï¼ˆå°±æ˜¯ä»¥ä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—èŠ‚è®¡ç®—çš„å­—ç¬¦ä¸²é•¿åº¦ï¼‰ã€‚ table t çš„é•¿åº¦è¢«å®šä¹‰æˆä¸€ä¸ªæ•´æ•°ä¸‹æ ‡ n ã€‚ å®ƒæ»¡è¶³ t[n] ä¸æ˜¯ nil è€Œ t[n+1] ä¸º nilï¼› æ­¤å¤–ï¼Œå¦‚æœ t[1] ä¸º nil ï¼Œn å°±å¯èƒ½æ˜¯é›¶ã€‚ å¯¹äºå¸¸è§„çš„æ•°ç»„ï¼Œé‡Œé¢ä» 1 åˆ° n æ”¾ç€ä¸€äº›éç©ºçš„å€¼çš„æ—¶å€™ï¼Œ å®ƒçš„é•¿åº¦å°±ç²¾ç¡®çš„ä¸º nï¼Œå³æœ€åä¸€ä¸ªå€¼çš„ä¸‹æ ‡ã€‚ å¦‚æœæ•°ç»„æœ‰ä¸€ä¸ªâ€œç©ºæ´â€ ï¼ˆå°±æ˜¯è¯´ï¼Œnil å€¼è¢«å¤¹åœ¨éç©ºå€¼ä¹‹é—´ï¼‰ï¼Œ é‚£ä¹ˆ #t å¯èƒ½æ˜¯æŒ‡å‘ä»»ä½•ä¸€ä¸ªæ˜¯ nil å€¼çš„å‰ä¸€ä¸ªä½ç½®çš„ä¸‹æ ‡ ï¼ˆå°±æ˜¯è¯´ï¼Œä»»ä½•ä¸€ä¸ª nil å€¼éƒ½æœ‰å¯èƒ½è¢«å½“æˆæ•°ç»„çš„ç»“æŸï¼‰ã€‚ 2.5.6 - ä¼˜å…ˆçº§Lua ä¸­æ“ä½œç¬¦çš„ä¼˜å…ˆçº§å†™åœ¨ä¸‹è¡¨ä¸­ï¼Œä»ä½åˆ°é«˜ä¼˜å…ˆçº§æ’åºï¼š or and &lt; &gt; &lt;= &gt;= ~= == .. + - * / % not # - (unary) ^ é€šå¸¸ï¼Œä½ å¯ä»¥ç”¨æ‹¬å·æ¥æ”¹å˜è¿ç®—æ¬¡åºã€‚ è¿æ¥æ“ä½œç¬¦ (â€˜..â€™) å’Œå¹‚æ“ä½œ (â€˜^â€™) æ˜¯ä»å³è‡³å·¦çš„ã€‚ å…¶å®ƒæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯ä»å·¦è‡³å³ã€‚ 2.5.7 - Table æ„é€ table æ„é€ å­æ˜¯ä¸€ä¸ªæ„é€  table çš„è¡¨è¾¾å¼ã€‚ æ¯æ¬¡æ„é€ å­è¢«æ‰§è¡Œï¼Œéƒ½ä¼šæ„é€ å‡ºä¸€ä¸ªæ–°çš„ table ã€‚ æ„é€ å­å¯ä»¥è¢«ç”¨æ¥æ„é€ ä¸€ä¸ªç©ºçš„ tableï¼Œ ä¹Ÿå¯ä»¥ç”¨æ¥æ„é€ ä¸€ä¸ª table å¹¶åˆå§‹åŒ–å…¶ä¸­çš„ä¸€äº›åŸŸã€‚ ä¸€èˆ¬çš„æ„é€ å­çš„è¯­æ³•å¦‚ä¸‹ tableconstructor ::= `{Â´ [fieldlist] `}Â´ fieldlist ::= field {fieldsep field} [fieldsep] field ::= `[Â´ exp `]Â´ `=Â´ exp | Name `=Â´ exp | exp fieldsep ::= `,Â´ | `;Â´ æ¯ä¸ªå½¢å¦‚ [exp1] = exp2 çš„åŸŸå‘ table ä¸­å¢åŠ æ–°çš„ä¸€é¡¹ï¼Œ å…¶é”®å€¼ä¸º exp1 è€Œå€¼ä¸º exp2ã€‚ å½¢å¦‚ name = exp çš„åŸŸç­‰ä»·äº [â€œnameâ€] = expã€‚ æœ€åï¼Œå½¢å¦‚ exp çš„åŸŸç­‰ä»·äº [i] = exp ï¼Œ è¿™é‡Œçš„ i æ˜¯ä¸€ä¸ªä» 1 å¼€å§‹ä¸æ–­å¢é•¿çš„æ•°å­—ã€‚ è¿™è¿™ä¸ªæ ¼å¼ä¸­çš„å…¶å®ƒåŸŸä¸ä¼šç ´åå…¶è®°æ•°ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š a = { [f(1)] = g; &quot;x&quot;, &quot;y&quot;; x = 1, f(x), [30] = 23; 45 } ç­‰ä»·äº do local t = {} t[f(1)] = g t[1] = &quot;x&quot; -- 1st exp t[2] = &quot;y&quot; -- 2nd exp t.x = 1 -- t[&quot;x&quot;] = 1 t[3] = f(x) -- 3rd exp t[30] = 23 t[4] = 45 -- 4th exp a = t end å¦‚æœè¡¨å•ä¸­æœ€åä¸€ä¸ªåŸŸçš„å½¢å¼æ˜¯ exp ï¼Œ è€Œä¸”å…¶è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨æˆ–è€…æ˜¯ä¸€ä¸ªå¯å˜å‚æ•°ï¼Œ é‚£ä¹ˆè¿™ä¸ªè¡¨è¾¾å¼æ‰€æœ‰çš„è¿”å›å€¼å°†è¿ç»­çš„è¿›å…¥åˆ—è¡¨ ï¼ˆå‚è§ Â§2.5.8ï¼‰ã€‚ ä¸ºäº†é¿å…è¿™ä¸€ç‚¹ï¼Œä½ å¯ä»¥ç”¨æ‹¬å·æŠŠå‡½æ•°è°ƒç”¨ï¼ˆæˆ–æ˜¯å¯å˜å‚æ•°ï¼‰æ‹¬èµ·æ¥ ï¼ˆå‚è§ Â§2.5ï¼‰ã€‚ åˆå§‹åŒ–åŸŸè¡¨å¯ä»¥åœ¨æœ€åå¤šä¸€ä¸ªåˆ†å‰²ç¬¦ï¼Œ è¿™æ ·è®¾è®¡å¯ä»¥æ–¹ä¾¿ç”±æœºå™¨ç”Ÿæˆä»£ç ã€‚ 2.5.8 - å‡½æ•°è°ƒç”¨Lua ä¸­çš„å‡½æ•°è°ƒç”¨çš„è¯­æ³•å¦‚ä¸‹ï¼š functioncall ::= prefixexp args å‡½æ•°è°ƒç”¨æ—¶ï¼Œç¬¬ä¸€æ­¥ï¼Œprefixexp å’Œ args å…ˆè¢«æ±‚å€¼ã€‚ å¦‚æœ prefixexp çš„å€¼çš„ç±»å‹æ˜¯ functionï¼Œ é‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±è¢«ç”¨ç»™å‡ºçš„å‚æ•°è°ƒç”¨ã€‚ å¦åˆ™ prefixexp çš„å…ƒæ–¹æ³• â€œcallâ€ å°±è¢«è°ƒç”¨ï¼Œ ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ prefixexp çš„å€¼ï¼Œè·Ÿä¸‹æ¥çš„æ˜¯åŸæ¥çš„è°ƒç”¨å‚æ•° ï¼ˆå‚è§ Â§2.8ï¼‰ã€‚ è¿™æ ·çš„å½¢å¼ functioncall ::= prefixexp `:Â´ Name args å¯ä»¥ç”¨æ¥è°ƒç”¨ â€œæ–¹æ³•â€ã€‚ è¿™æ˜¯ Lua æ”¯æŒçš„ä¸€ç§è¯­æ³•ç³–ã€‚åƒ v:name(args) è¿™ä¸ªæ ·å­ï¼Œè¢«è§£é‡Šæˆ v.name(v,args)ï¼Œ è¿™é‡Œ v åªä¼šè¢«æ±‚å€¼ä¸€æ¬¡ã€‚ å‚æ•°çš„è¯­æ³•å¦‚ä¸‹ï¼š args ::= `(Â´ [explist1] `)Â´ args ::= tableconstructor args ::= String æ‰€æœ‰å‚æ•°çš„è¡¨è¾¾å¼æ±‚å€¼éƒ½åœ¨å‡½æ•°è°ƒç”¨ä¹‹å‰ã€‚ è¿™æ ·çš„è°ƒç”¨å½¢å¼ f{fields} æ˜¯ä¸€ç§è¯­æ³•ç³–ç”¨äºè¡¨ç¤º f({fields})ï¼› è¿™é‡ŒæŒ‡å‚æ•°åˆ—è¡¨æ˜¯ä¸€ä¸ªå•ä¸€çš„æ–°åˆ›å»ºå‡ºæ¥çš„åˆ—è¡¨ã€‚ è€Œè¿™æ ·çš„å½¢å¼ fâ€™stringâ€™ ï¼ˆæˆ–æ˜¯ fâ€stringâ€ äº¦æˆ–æ˜¯ f[[string]]ï¼‰ ä¹Ÿæ˜¯ä¸€ç§è¯­æ³•ç³–ï¼Œç”¨äºè¡¨ç¤º f(â€˜stringâ€™)ï¼› è¿™é‡ŒæŒ‡å‚æ•°åˆ—è¡¨æ˜¯ä¸€ä¸ªå•ç‹¬çš„å­—ç¬¦ä¸²ã€‚ å› ä¸ºè¡¨è¾¾å¼è¯­æ³•åœ¨ Lua ä¸­æ¯”è¾ƒè‡ªç”±ï¼Œ æ‰€ä»¥ä½ ä¸èƒ½åœ¨å‡½æ•°è°ƒç”¨çš„ â€˜(â€˜ å‰æ¢è¡Œã€‚ è¿™ä¸ªé™åˆ¶å¯ä»¥é¿å…è¯­è¨€ä¸­çš„ä¸€äº›æ­§ä¹‰ã€‚ æ¯”å¦‚ä½ è¿™æ ·å†™ a = f (g).x(a) Lua å°†æŠŠå®ƒå½“ä½œä¸€ä¸ªå•ä¸€è¯­å¥æ®µï¼Œ a = f(g).x(a) ã€‚ å› æ­¤ï¼Œå¦‚æœä½ çœŸçš„æƒ³ä½œä¸ºæˆä¸¤ä¸ªè¯­å¥æ®µï¼Œä½ å¿…é¡»åœ¨å®ƒä»¬ä¹‹é—´å†™ä¸Šä¸€ä¸ªåˆ†å·ã€‚ å¦‚æœä½ çœŸçš„æƒ³è°ƒç”¨ fï¼Œ ä½ å¿…é¡»ä» (g) å‰ç§»å»æ¢è¡Œã€‚ è¿™æ ·ä¸€ç§è°ƒç”¨å½¢å¼ï¼šreturn functioncall å°†è§¦å‘ä¸€ä¸ªå°¾è°ƒç”¨ã€‚ Lua å®ç°äº†é€‚å½“çš„å°¾éƒ¨è°ƒç”¨ï¼ˆæˆ–æ˜¯é€‚å½“çš„å°¾é€’å½’ï¼‰ï¼š åœ¨å°¾è°ƒç”¨ä¸­ï¼Œ è¢«è°ƒç”¨çš„å‡½æ•°é‡ç”¨è°ƒç”¨å®ƒçš„å‡½æ•°çš„å †æ ˆé¡¹ã€‚ å› æ­¤ï¼Œå¯¹äºç¨‹åºæ‰§è¡Œçš„åµŒå¥—å°¾è°ƒç”¨çš„å±‚æ•°æ˜¯æ²¡æœ‰é™åˆ¶çš„ã€‚ ç„¶è€Œï¼Œå°¾è°ƒç”¨å°†åˆ é™¤è°ƒç”¨å®ƒçš„å‡½æ•°çš„ä»»ä½•è°ƒè¯•ä¿¡æ¯ã€‚ æ³¨æ„ï¼Œå°¾è°ƒç”¨åªå‘ç”Ÿåœ¨ç‰¹å®šçš„è¯­æ³•ä¸‹ï¼Œ è¿™æ—¶ï¼Œ return åªæœ‰å•ä¸€å‡½æ•°è°ƒç”¨ä½œä¸ºå‚æ•°ï¼› è¿™ç§è¯­æ³•ä½¿å¾—è°ƒç”¨å‡½æ•°çš„ç»“æœå¯ä»¥ç²¾ç¡®è¿”å›ã€‚ å› æ­¤ï¼Œä¸‹é¢è¿™äº›ä¾‹å­éƒ½ä¸æ˜¯å°¾è°ƒç”¨ï¼š return (f(x)) -- è¿”å›å€¼è¢«è°ƒæ•´ä¸ºä¸€ä¸ª return 2 * f(x) return x, f(x) -- æœ€åŠ è‹¥å¹²è¿”å›å€¼ f(x); return -- æ— è¿”å›å€¼ return x or f(x) -- è¿”å›å€¼è¢«è°ƒæ•´ä¸ºä¸€ä¸ª 2.5.9 - å‡½æ•°å®šä¹‰å‡½æ•°å®šä¹‰çš„è¯­æ³•å¦‚ä¸‹ï¼š function ::= function funcbody funcbody ::= `(Â´ [parlist1] `)Â´ block end å¦å¤–å®šä¹‰äº†ä¸€äº›è¯­æ³•ç³–ç®€åŒ–å‡½æ•°å®šä¹‰çš„å†™æ³•ï¼š stat ::= function funcname funcbody stat ::= local function Name funcbody funcname ::= Name {`.Â´ Name} [`:Â´ Name] è¿™æ ·çš„å†™æ³•ï¼š function f () body end è¢«è½¬æ¢æˆ f = function () body end è¿™æ ·çš„å†™æ³•ï¼š function t.a.b.c.f () body end è¢«è½¬æ¢æˆ t.a.b.c.f = function () body end è¿™æ ·çš„å†™æ³•ï¼š local function f () body end è¢«è½¬æ¢æˆ local f; f = function () body end æ³¨æ„ï¼Œå¹¶ä¸æ˜¯è½¬æ¢æˆ local f = function () body end ï¼ˆè¿™ä¸ªå·®åˆ«åªåœ¨å‡½æ•°ä½“å†…éœ€è¦å¼•ç”¨ f æ—¶æ‰æœ‰ã€‚ï¼‰ ä¸€ä¸ªå‡½æ•°å®šä¹‰æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œçš„è¡¨è¾¾å¼ï¼Œ æ‰§è¡Œç»“æœæ˜¯ä¸€ä¸ªç±»å‹ä¸º function çš„å€¼ã€‚ å½“ Lua é¢„ç¼–è¯‘ä¸€ä¸ª chunk çš„æ—¶å€™ï¼Œ chunk ä½œä¸ºä¸€ä¸ªå‡½æ•°ï¼Œæ•´ä¸ªå‡½æ•°ä½“ä¹Ÿå°±è¢«é¢„ç¼–è¯‘äº†ã€‚ é‚£ä¹ˆï¼Œæ— è®ºä½•æ—¶ Lua æ‰§è¡Œäº†å‡½æ•°å®šä¹‰ï¼Œ è¿™ä¸ªå‡½æ•°æœ¬èº«å°±è¢«å®ä¾‹åŒ–äº†ï¼ˆæˆ–è€…è¯´æ˜¯å…³é—­äº†ï¼‰ã€‚ è¿™ä¸ªå‡½æ•°çš„å®ä¾‹ï¼ˆæˆ–è€…è¯´æ˜¯ closureï¼ˆé—­åŒ…ï¼‰ï¼‰ æ˜¯è¡¨è¾¾å¼çš„æœ€ç»ˆå€¼ã€‚ ç›¸åŒå‡½æ•°çš„ä¸åŒå®ä¾‹æœ‰å¯èƒ½å¼•ç”¨ä¸åŒçš„å¤–éƒ¨å±€éƒ¨å˜é‡ï¼Œ ä¹Ÿå¯èƒ½æ‹¥æœ‰ä¸åŒçš„ç¯å¢ƒè¡¨ã€‚ å½¢å‚ï¼ˆå‡½æ•°å®šä¹‰éœ€è¦çš„å‚æ•°ï¼‰æ˜¯ä¸€äº›ç”±å®å‚ï¼ˆå®é™…ä¼ å…¥å‚æ•°ï¼‰çš„å€¼åˆå§‹åŒ–çš„å±€éƒ¨å˜é‡ï¼š parlist1 ::= namelist [`,Â´ `...Â´] | `...Â´ å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨ï¼Œ å¦‚æœå‡½æ•°æ²¡æœ‰è¢«å®šä¹‰ä¸ºæ¥æ”¶ä¸å®šé•¿å‚æ•°ï¼Œå³åœ¨å½¢å‚åˆ—è¡¨çš„æœ«å°¾æ³¨æ˜ä¸‰ä¸ªç‚¹ (â€˜â€¦â€™)ï¼Œ é‚£ä¹ˆå®å‚åˆ—è¡¨å°±ä¼šè¢«è°ƒæ•´åˆ°å½¢å‚åˆ—è¡¨çš„é•¿åº¦ï¼Œ å˜é•¿å‚æ•°å‡½æ•°ä¸ä¼šè°ƒæ•´å®å‚åˆ—è¡¨ï¼› å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œå®ƒå°†æŠŠæ‰€æœ‰é¢å¤–çš„å‚æ•°æ”¾åœ¨ä¸€èµ·é€šè¿‡å˜é•¿å‚æ•°è¡¨è¾¾å¼ä¼ é€’ç»™å‡½æ•°ï¼Œ å…¶å†™æ³•ä¾æ—§æ˜¯ä¸‰ä¸ªç‚¹ã€‚ è¿™ä¸ªè¡¨è¾¾å¼çš„å€¼æ˜¯ä¸€ä¸²å®å‚å€¼çš„åˆ—è¡¨ï¼Œçœ‹èµ·æ¥å°±è·Ÿä¸€ä¸ªå¯ä»¥è¿”å›å¤šä¸ªç»“æœçš„å‡½æ•°ä¸€æ ·ã€‚ å¦‚æœä¸€ä¸ªå˜é•¿å‚æ•°è¡¨è¾¾å¼æ”¾åœ¨å¦ä¸€ä¸ªè¡¨è¾¾å¼ä¸­ä½¿ç”¨ï¼Œæˆ–æ˜¯æ”¾åœ¨å¦ä¸€ä¸²è¡¨è¾¾å¼çš„ä¸­é—´ï¼Œ é‚£ä¹ˆå®ƒçš„è¿”å›å€¼å°±ä¼šè¢«è°ƒæ•´ä¸ºå•ä¸ªå€¼ã€‚ è‹¥è¿™ä¸ªè¡¨è¾¾å¼æ”¾åœ¨äº†ä¸€ç³»åˆ—è¡¨è¾¾å¼çš„æœ€åä¸€ä¸ªï¼Œå°±ä¸ä¼šåšè°ƒæ•´äº†ï¼ˆé™¤éç”¨æ‹¬å·ç»™æ‹¬äº†èµ·æ¥ï¼‰ã€‚ æˆ‘ä»¬å…ˆåšå¦‚ä¸‹å®šä¹‰ï¼Œç„¶åå†æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š function f(a, b) end function g(a, b, ...) end function r() return 1,2,3 end ä¸‹é¢çœ‹çœ‹å®å‚åˆ°å½¢å‚æ•°ä»¥åŠå¯å˜é•¿å‚æ•°çš„æ˜ å°„å…³ç³»ï¼š CALL PARAMETERS f(3) a=3, b=nil f(3, 4) a=3, b=4 f(3, 4, 5) a=3, b=4 f(r(), 10) a=1, b=10 f(r()) a=1, b=2 g(3) a=3, b=nil, ... --&gt; (nothing) g(3, 4) a=3, b=4, ... --&gt; (nothing) g(3, 4, 5, 8) a=3, b=4, ... --&gt; 5 8 g(5, r()) a=5, b=1, ... --&gt; 2 3 ç»“æœç”± return æ¥è¿”å›ï¼ˆå‚è§ Â§2.4.4ï¼‰ã€‚ å¦‚æœæ‰§è¡Œåˆ°å‡½æ•°æœ«å°¾ä¾æ—§æ²¡æœ‰é‡åˆ°ä»»ä½• return è¯­å¥ï¼Œ å‡½æ•°å°±ä¸ä¼šè¿”å›ä»»ä½•ç»“æœã€‚ å†’å·è¯­æ³•å¯ä»¥ç”¨æ¥å®šä¹‰æ–¹æ³•ï¼Œ å°±æ˜¯è¯´ï¼Œå‡½æ•°å¯ä»¥æœ‰ä¸€ä¸ªéšå¼çš„å½¢å‚ selfã€‚ å› æ­¤ï¼Œå¦‚ä¸‹å†™æ³•ï¼š function t.a.b.c:f (params) body end æ˜¯è¿™æ ·ä¸€ç§å†™æ³•çš„è¯­æ³•ç³–ï¼š t.a.b.c.f = function (self, params) body end 2.6 - å¯è§†è§„åˆ™Lua æ˜¯ä¸€ä¸ªæœ‰è¯æ³•ä½œç”¨èŒƒå›´çš„è¯­è¨€ã€‚ å˜é‡çš„ä½œç”¨èŒƒå›´å¼€å§‹äºå£°æ˜å®ƒä»¬ä¹‹åçš„ç¬¬ä¸€ä¸ªè¯­å¥æ®µï¼Œ ç»“æŸäºåŒ…å«è¿™ä¸ªå£°æ˜çš„æœ€å†…å±‚è¯­å¥å—çš„ç»“æŸç‚¹ã€‚ çœ‹ä¸‹é¢è¿™äº›ä¾‹å­ï¼š x = 10 -- å…¨å±€å˜é‡ do -- æ–°çš„è¯­å¥å— local x = x -- æ–°çš„ä¸€ä¸ª &#39;x&#39;, å®ƒçš„å€¼ç°åœ¨æ˜¯ 10 print(x) --&gt; 10 x = x+1 do -- å¦ä¸€ä¸ªè¯­å¥å— local x = x+1 -- åˆä¸€ä¸ª &#39;x&#39; print(x) --&gt; 12 end print(x) --&gt; 11 end print(x) --&gt; 10 ï¼ˆå–åˆ°çš„æ˜¯å…¨å±€çš„é‚£ä¸€ä¸ªï¼‰ æ³¨æ„è¿™é‡Œï¼Œç±»ä¼¼ local x = x è¿™æ ·çš„å£°æ˜ï¼Œ æ–°çš„ x æ­£åœ¨è¢«å£°æ˜ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰è¿›å…¥å®ƒçš„ä½œç”¨èŒƒå›´ï¼Œ æ‰€ä»¥ç¬¬äºŒä¸ª x æŒ‡å‘çš„æ˜¯å¤–é¢ä¸€å±‚çš„å˜é‡ã€‚ å› ä¸ºæœ‰è¿™æ ·ä¸€ä¸ªè¯æ³•ä½œç”¨èŒƒå›´çš„è§„åˆ™ï¼Œ æ‰€ä»¥å¯ä»¥åœ¨å‡½æ•°å†…éƒ¨è‡ªç”±çš„å®šä¹‰å±€éƒ¨å˜é‡å¹¶ä½¿ç”¨å®ƒä»¬ã€‚ å½“ä¸€ä¸ªå±€éƒ¨å˜é‡è¢«æ›´å†…å±‚çš„å‡½æ•°ä¸­ä½¿ç”¨çš„æ—¶å€™ï¼Œ å®ƒè¢«å†…å±‚å‡½æ•°ç§°ä½œ upvalueï¼ˆä¸Šå€¼ï¼‰ï¼Œæˆ–æ˜¯ å¤–éƒ¨å±€éƒ¨å˜é‡ã€‚ æ³¨æ„ï¼Œæ¯æ¬¡æ‰§è¡Œåˆ°ä¸€ä¸ª local è¯­å¥éƒ½ä¼šå®šä¹‰å‡ºä¸€ä¸ªæ–°çš„å±€éƒ¨å˜é‡ã€‚ çœ‹çœ‹è¿™æ ·ä¸€ä¸ªä¾‹å­ï¼š a = {} local x = 20 for i=1,10 do local y = 0 a[i] = function () y=y+1; return x+y end end è¿™ä¸ªå¾ªç¯åˆ›å»ºäº†åä¸ª closureï¼ˆè¿™æŒ‡åä¸ªåŒ¿åå‡½æ•°çš„å®ä¾‹ï¼‰ã€‚ è¿™äº› closure ä¸­çš„æ¯ä¸€ä¸ªéƒ½ä½¿ç”¨äº†ä¸åŒçš„ y å˜é‡ï¼Œ è€Œå®ƒä»¬åˆå…±äº«äº†åŒä¸€ä»½ xã€‚ errorerror(message[, level]) Level = 1[é»˜è®¤]ï¼šä¸ºè°ƒç”¨errorä½ç½®(æ–‡ä»¶+è¡Œå·) Level = 2ï¼šæŒ‡å‡ºå“ªä¸ªè°ƒç”¨errorçš„å‡½æ•°çš„å‡½æ•° Level = 0ï¼šä¸æ·»åŠ é”™è¯¯ä½ç½®ä¿¡æ¯å› ä¸º Lua æ˜¯ä¸€ä¸ªåµŒå…¥å¼çš„æ‰©å±•è¯­è¨€ï¼Œ æ‰€æœ‰çš„ Lua åŠ¨ä½œéƒ½æ˜¯ä»å®¿ä¸»ç¨‹åºçš„ C ä»£ç è°ƒç”¨ Lua åº“ ï¼ˆå‚è§ lua_pcallï¼‰ä¸­çš„ä¸€ä¸ªå‡½æ•°å¼€å§‹çš„ã€‚ åœ¨ Lua ç¼–è¯‘æˆ–è¿è¡Œçš„ä»»ä½•æ—¶å€™å‘ç”Ÿäº†é”™è¯¯ï¼Œæ§åˆ¶æƒéƒ½ä¼šäº¤è¿˜ç»™ C ï¼Œ è€Œ C å¯ä»¥æ¥åšä¸€äº›æ°å½“çš„æªæ–½ï¼ˆæ¯”å¦‚æ‰“å°å‡ºä¸€æ¡é”™è¯¯ä¿¡æ¯ï¼‰ã€‚Lua ä»£ç å¯ä»¥æ˜¾å¼çš„è°ƒç”¨ error å‡½æ•°æ¥äº§ç”Ÿä¸€æ¡é”™è¯¯ã€‚ å¦‚æœä½ éœ€è¦åœ¨ Lua ä¸­æ•è·å‘ç”Ÿçš„é”™è¯¯ï¼Œ ä½ å¯ä»¥ä½¿ç”¨ pcall å‡½æ•°ã€‚ MetatableLua ä¸­çš„æ¯ä¸ªå€¼éƒ½å¯ä»¥ç”¨ä¸€ä¸ª metatableã€‚ è¿™ä¸ª metatable å°±æ˜¯ä¸€ä¸ªåŸå§‹çš„ Lua table ï¼Œ å®ƒç”¨æ¥å®šä¹‰åŸå§‹å€¼åœ¨ç‰¹å®šæ“ä½œä¸‹çš„è¡Œä¸ºã€‚ ä½ å¯ä»¥é€šè¿‡åœ¨ metatable ä¸­çš„ç‰¹å®šåŸŸè®¾ä¸€äº›å€¼æ¥æ”¹å˜æ‹¥æœ‰è¿™ä¸ª metatable çš„å€¼ çš„æŒ‡å®šæ“ä½œä¹‹è¡Œä¸ºã€‚ ä¸¾ä¾‹æ¥è¯´ï¼Œå½“ä¸€ä¸ªéæ•°å­—çš„å€¼ä½œåŠ æ³•æ“ä½œçš„æ—¶å€™ï¼Œ Lua ä¼šæ£€æŸ¥å®ƒçš„ metatable ä¸­ â€œ__addâ€ åŸŸä¸­çš„æ˜¯å¦æœ‰ä¸€ä¸ªå‡½æ•°ã€‚ å¦‚æœæœ‰è¿™ä¹ˆä¸€ä¸ªå‡½æ•°çš„è¯ï¼ŒLua è°ƒç”¨è¿™ä¸ªå‡½æ•°æ¥æ‰§è¡Œä¸€æ¬¡åŠ æ³•ã€‚æˆ‘ä»¬å« metatable ä¸­çš„é”®åä¸º äº‹ä»¶ (event) ï¼ŒæŠŠå…¶ä¸­çš„å€¼å«ä½œ å…ƒæ–¹æ³• (metamethod)ã€‚ åœ¨ä¸Šä¸ªä¾‹å­ä¸­ï¼Œäº‹ä»¶æ˜¯ â€œaddâ€ è€Œå…ƒæ–¹æ³•å°±æ˜¯é‚£ä¸ªæ‰§è¡ŒåŠ æ³•æ“ä½œçš„å‡½æ•°ã€‚ä½ å¯ä»¥é€šè¿‡ getmetatable å‡½æ•°æ¥æŸ¥è¯¢åˆ°ä»»ä½•ä¸€ä¸ªå€¼çš„ metatableã€‚ä½ å¯ä»¥é€šè¿‡ setmetatable å‡½æ•°æ¥æ›¿æ¢æ‰ table çš„ metatable ã€‚ ä½ ä¸èƒ½ä» Lua ä¸­æ”¹å˜å…¶å®ƒä»»ä½•ç±»å‹çš„å€¼çš„ metatable ï¼ˆä½¿ç”¨ debug åº“ä¾‹å¤–ï¼‰ï¼› è¦è¿™æ ·åšçš„è¯å¿…é¡»ä½¿ç”¨ C API ã€‚æ¯ä¸ª table å’Œ userdata æ‹¥æœ‰ç‹¬ç«‹çš„ metatable ï¼ˆå½“ç„¶å¤šä¸ª table å’Œ userdata å¯ä»¥å…±äº«ä¸€ä¸ªç›¸åŒçš„è¡¨ä½œå®ƒä»¬çš„ metatableï¼‰ï¼› å…¶å®ƒæ‰€æœ‰ç±»å‹çš„å€¼ï¼Œæ¯ç§ç±»å‹éƒ½åˆ†åˆ«å…±äº«å”¯ä¸€çš„ä¸€ä¸ª metatableã€‚ å› æ­¤ï¼Œæ‰€æœ‰çš„æ•°å­—ä¸€èµ·åªæœ‰ä¸€ä¸ª metatable ï¼Œæ‰€æœ‰çš„å­—ç¬¦ä¸²ä¹Ÿæ˜¯ï¼Œç­‰ç­‰ã€‚ä¸€ä¸ª metatable å¯ä»¥æ§åˆ¶ä¸€ä¸ªå¯¹è±¡åšæ•°å­¦è¿ç®—æ“ä½œã€æ¯”è¾ƒæ“ä½œã€è¿æ¥æ“ä½œã€å–é•¿åº¦æ“ä½œã€å–ä¸‹æ ‡æ“ä½œæ—¶çš„è¡Œä¸ºï¼Œ metatable ä¸­è¿˜å¯ä»¥å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè®© userdata ä½œåƒåœ¾æ”¶é›†æ—¶è°ƒç”¨å®ƒã€‚ å¯¹äºè¿™äº›æ“ä½œï¼ŒLua éƒ½å°†å…¶å…³è”ä¸Šä¸€ä¸ªè¢«ç§°ä½œäº‹ä»¶çš„æŒ‡å®šå¥ã€‚ å½“ Lua éœ€è¦å¯¹ä¸€ä¸ªå€¼å‘èµ·è¿™äº›æ“ä½œä¸­çš„ä¸€ä¸ªæ—¶ï¼Œ å®ƒä¼šå»æ£€æŸ¥å€¼ä¸­ metatable ä¸­æ˜¯å¦æœ‰å¯¹åº”äº‹ä»¶ã€‚ å¦‚æœæœ‰çš„è¯ï¼Œé”®åå¯¹åº”çš„å€¼ï¼ˆå…ƒæ–¹æ³•ï¼‰å°†æ§åˆ¶ Lua æ€æ ·åšè¿™ä¸ªæ“ä½œã€‚metatable å¯ä»¥æ§åˆ¶çš„æ“ä½œå·²åœ¨ä¸‹é¢åˆ—å‡ºæ¥ã€‚ æ¯ä¸ªæ“ä½œéƒ½ç”¨ç›¸åº”çš„åå­—åŒºåˆ†ã€‚ æ¯ä¸ªæ“ä½œçš„é”®åéƒ½æ˜¯ç”¨æ“ä½œåå­—åŠ ä¸Šä¸¤ä¸ªä¸‹åˆ’çº¿ â€˜â€˜ å‰ç¼€çš„å­—ç¬¦ä¸²ï¼› ä¸¾ä¾‹æ¥è¯´ï¼Œâ€addâ€ æ“ä½œçš„é”®åå°±æ˜¯å­—ç¬¦ä¸² â€œaddâ€ã€‚ è¿™äº›æ“ä½œçš„è¯­ä¹‰ç”¨ä¸€ä¸ª Lua å‡½æ•°æ¥æè¿°è§£é‡Šå™¨å¦‚ä½•æ‰§è¡Œæ›´ä¸ºæ°å½“ã€‚è¿™é‡Œå±•ç¤ºçš„ç”¨ Lua å†™çš„ä»£ç ä»…ä½œè§£è¯´ç”¨ï¼› å®é™…çš„è¡Œä¸ºå·²ç»ç¡¬ç¼–ç åœ¨è§£é‡Šå™¨ä¸­ï¼Œå…¶æ‰§è¡Œæ•ˆç‡è¦è¿œé«˜äºè¿™äº›æ¨¡æ‹Ÿä»£ç ã€‚ è¿™äº›ç”¨äºæè¿°çš„çš„ä»£ç ä¸­ç”¨åˆ°çš„å‡½æ•° ï¼ˆ rawget ï¼Œ tonumber ï¼Œç­‰ç­‰ã€‚ï¼‰ éƒ½å¯ä»¥åœ¨ Â§5.1 ä¸­æ‰¾åˆ°ã€‚ ç‰¹åˆ«æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™æ ·ä¸€ä¸ªè¡¨è¾¾å¼æ¥ä»ç»™å®šå¯¹è±¡ä¸­æå–å…ƒæ–¹æ³• metatable(obj)[event] è¿™ä¸ªåº”è¯¥è¢«è§£è¯»ä½œ rawget(getmetatable(obj) or {}, event) è¿™å°±æ˜¯è¯´ï¼Œè®¿é—®ä¸€ä¸ªå…ƒæ–¹æ³•ä¸å†ä¼šè§¦å‘ä»»ä½•çš„å…ƒæ–¹æ³•ï¼Œ è€Œä¸”è®¿é—®ä¸€ä¸ªæ²¡æœ‰ metatable çš„å¯¹è±¡ä¹Ÿä¸ä¼šå¤±è´¥ï¼ˆè€Œåªæ˜¯ç®€å•è¿”å› nilï¼‰ã€‚ â€œaddâ€: + æ“ä½œã€‚ä¸‹é¢è¿™ä¸ª getbinhandler å‡½æ•°å®šä¹‰äº† Lua æ€æ ·é€‰æ‹©ä¸€ä¸ªå¤„ç†å™¨æ¥ä½œäºŒå…ƒæ“ä½œã€‚ é¦–å…ˆï¼ŒLua å°è¯•ç¬¬ä¸€ä¸ªæ“ä½œæ•°ã€‚ å¦‚æœè¿™ä¸ªä¸œè¥¿çš„ç±»å‹æ²¡æœ‰å®šä¹‰è¿™ä¸ªæ“ä½œçš„å¤„ç†å™¨ï¼Œç„¶å Lua ä¼šå°è¯•ç¬¬äºŒä¸ªæ“ä½œæ•°ã€‚ function getbinhandler (op1, op2, event) return metatable(op1)[event] or metatable(op2)[event] end é€šè¿‡è¿™ä¸ªå‡½æ•°ï¼Œ op1 + op2 çš„è¡Œä¸ºå°±æ˜¯ function add_event (op1, op2) local o1, o2 = tonumber(op1), tonumber(op2) if o1 and o2 then -- ä¸¤ä¸ªæ“ä½œæ•°éƒ½æ˜¯æ•°å­—ï¼Ÿ return o1 + o2 -- è¿™é‡Œçš„ &#39;+&#39; æ˜¯åŸç”Ÿçš„ &#39;add&#39; else -- è‡³å°‘ä¸€ä¸ªæ“ä½œæ•°ä¸æ˜¯æ•°å­—æ—¶ local h = getbinhandler(op1, op2, &quot;__add&quot;) if h then -- ä»¥ä¸¤ä¸ªæ“ä½œæ•°æ¥è°ƒç”¨å¤„ç†å™¨ return h(op1, op2) else -- æ²¡æœ‰å¤„ç†å™¨ï¼šç¼ºçœè¡Œä¸º error(Â·Â·Â·) end end end &quot;sub&quot;: - æ“ä½œã€‚ å…¶è¡Œä¸ºç±»ä¼¼äº &quot;add&quot; æ“ä½œã€‚ &quot;mul&quot;: * æ“ä½œã€‚ å…¶è¡Œä¸ºç±»ä¼¼äº &quot;add&quot; æ“ä½œã€‚ &quot;div&quot;: / æ“ä½œã€‚ å…¶è¡Œä¸ºç±»ä¼¼äº &quot;add&quot; æ“ä½œã€‚ &quot;mod&quot;: % æ“ä½œã€‚ å…¶è¡Œä¸ºç±»ä¼¼äº &quot;add&quot; æ“ä½œï¼Œ å®ƒçš„åŸç”Ÿæ“ä½œæ˜¯è¿™æ ·çš„ o1 - floor(o1/o2)*o2 &quot;pow&quot;: ^ ï¼ˆå¹‚ï¼‰æ“ä½œã€‚ å…¶è¡Œä¸ºç±»ä¼¼äº &quot;add&quot; æ“ä½œï¼Œ å®ƒçš„åŸç”Ÿæ“ä½œæ˜¯è°ƒç”¨ pow å‡½æ•°ï¼ˆé€šè¿‡ C math åº“ï¼‰ã€‚ &quot;unm&quot;: ä¸€å…ƒ - æ“ä½œã€‚ function unm_event (op) local o = tonumber(op) if o then -- æ“ä½œæ•°æ˜¯æ•°å­—ï¼Ÿ return -o -- è¿™é‡Œçš„ &#39;-&#39; æ˜¯ä¸€ä¸ªåŸç”Ÿçš„ &#39;unm&#39; else -- æ“ä½œæ•°ä¸æ˜¯æ•°å­—ã€‚ -- å°è¯•ä»æ“ä½œæ•°ä¸­å¾—åˆ°å¤„ç†å™¨ local h = metatable(op).__unm if h then -- ä»¥æ“ä½œæ•°ä¸ºå‚æ•°è°ƒç”¨å¤„ç†å™¨ return h(op) else -- æ²¡æœ‰å¤„ç†å™¨ï¼šç¼ºçœè¡Œä¸º error(Â·Â·Â·) end end end &quot;concat&quot;: .. ï¼ˆè¿æ¥ï¼‰æ“ä½œï¼Œ function concat_event (op1, op2) if (type(op1) == &quot;string&quot; or type(op1) == &quot;number&quot;) and (type(op2) == &quot;string&quot; or type(op2) == &quot;number&quot;) then return op1 .. op2 -- åŸç”Ÿå­—ç¬¦ä¸²è¿æ¥ else local h = getbinhandler(op1, op2, &quot;__concat&quot;) if h then return h(op1, op2) else error(Â·Â·Â·) end end end &quot;len&quot;: # æ“ä½œã€‚ function len_event (op) if type(op) == &quot;string&quot; then return strlen(op) -- åŸç”Ÿçš„å–å­—ç¬¦ä¸²é•¿åº¦ elseif type(op) == &quot;table&quot; then return #op -- åŸç”Ÿçš„å– table é•¿åº¦ else local h = metatable(op).__len if h then -- è°ƒç”¨æ“ä½œæ•°çš„å¤„ç†å™¨ return h(op) else -- æ²¡æœ‰å¤„ç†å™¨ï¼šç¼ºçœè¡Œä¸º error(Â·Â·Â·) end end end å…³äº table çš„é•¿åº¦å‚è§ Â§2.5.5 ã€‚ â€œeqâ€: == æ“ä½œã€‚ å‡½æ•° getcomphandler å®šä¹‰äº† Lua æ€æ ·é€‰æ‹©ä¸€ä¸ªå¤„ç†å™¨æ¥ä½œæ¯”è¾ƒæ“ä½œã€‚ å…ƒæ–¹æ³•ä»…ä»…åœ¨å‚äºæ¯”è¾ƒçš„ä¸¤ä¸ªå¯¹è±¡ç±»å‹ç›¸åŒä¸”æœ‰å¯¹åº”æ“ä½œç›¸åŒçš„å…ƒæ–¹æ³•æ—¶æ‰èµ·æ•ˆã€‚ function getcomphandler (op1, op2, event) if type(op1) ~= type(op2) then return nil end local mm1 = metatable(op1)[event] local mm2 = metatable(op2)[event] if mm1 == mm2 then return mm1 else return nil end endâ€œeqâ€ äº‹ä»¶æŒ‰å¦‚ä¸‹æ–¹å¼å®šä¹‰ï¼š function eq_event (op1, op2) if type(op1) ~= type(op2) then -- ä¸åŒçš„ç±»å‹ï¼Ÿ return false -- ä¸åŒçš„å¯¹è±¡ end if op1 == op2 then -- åŸç”Ÿçš„ç›¸ç­‰æ¯”è¾ƒç»“æœï¼Ÿ return true -- å¯¹è±¡ç›¸ç­‰ end -- å°è¯•ä½¿ç”¨å…ƒæ–¹æ³• local h = getcomphandler(op1, op2, &quot;__eq&quot;) if h then return h(op1, op2) else return false end end a ~= b ç­‰ä»·äº not (a == b) ã€‚ &quot;lt&quot;: &lt; æ“ä½œã€‚ function lt_event (op1, op2) if type(op1) == &quot;number&quot; and type(op2) == &quot;number&quot; then return op1 &lt; op2 -- æ•°å­—æ¯”è¾ƒ elseif type(op1) == &quot;string&quot; and type(op2) == &quot;string&quot; then return op1 &lt; op2 -- å­—ç¬¦ä¸²æŒ‰é€å­—ç¬¦æ¯”è¾ƒ else local h = getcomphandler(op1, op2, &quot;__lt&quot;) if h then return h(op1, op2) else error(Â·Â·Â·); end end end a &gt; b ç­‰ä»·äº b &lt; a. &quot;le&quot;: &lt;= æ“ä½œã€‚ function le_event (op1, op2) if type(op1) == &quot;number&quot; and type(op2) == &quot;number&quot; then return op1 &lt;= op2 -- æ•°å­—æ¯”è¾ƒ elseif type(op1) == &quot;string&quot; and type(op2) == &quot;string&quot; then return op1 &lt;= op2 -- å­—ç¬¦ä¸²æŒ‰é€å­—ç¬¦æ¯”è¾ƒ else local h = getcomphandler(op1, op2, &quot;__le&quot;) if h then return h(op1, op2) else h = getcomphandler(op1, op2, &quot;__lt&quot;) if h then return not h(op2, op1) else error(Â·Â·Â·); end end end end a &gt;= b ç­‰ä»·äº b &lt;= a ã€‚ æ³¨æ„ï¼Œå¦‚æœå…ƒæ–¹æ³• â€œleâ€ æ²¡æœ‰æä¾›ï¼ŒLua å°±å°è¯• â€œltâ€ ï¼Œ å®ƒå‡å®š a &lt;= b ç­‰ä»·äº not (b &lt; a) ã€‚ â€œindexâ€: å–ä¸‹æ ‡æ“ä½œç”¨äºè®¿é—® table[key] ã€‚12345678910111213141516171819function gettable_event (table, key) local h if type(table) == "table" then local v = rawget(table, key) if v ~= nil then return v end h = metatable(table).__index if h == nil then return nil end else h = metatable(table).__index if h == nil then error(Â·Â·Â·); end end if type(h) == "function" then return h(table, key) -- è°ƒç”¨å¤„ç†å™¨ else return h[key] -- æˆ–æ˜¯é‡å¤ä¸Šè¿°æ“ä½œ endend newindexèµ‹å€¼ç»™æŒ‡å®šä¸‹æ ‡ table[key] = value 12345678910111213141516171819202122232425function settable_event (table, key, value) local h if type(table) == "table" then local v = rawget(table, key) if v ~= nil then rawset(table, key, value) return end h = metatable(table).__newindex if h == nil then rawset(table, key, value) return end else h = metatable(table).__newindex if h == nil then error(Â·Â·Â·) end end if type(h) == "function" then return h(table, key,value) -- è°ƒç”¨å¤„ç†å™¨ else h[key] = value -- æˆ–æ˜¯é‡å¤ä¸Šè¿°æ“ä½œ endend â€œcallâ€: å½“ Lua è°ƒç”¨ä¸€ä¸ªå€¼æ—¶è°ƒç”¨ã€‚123456789101112function function_event (func, ...) if type(func) == &quot;function&quot; then return func(...) -- åŸç”Ÿçš„è°ƒç”¨ else local h = metatable(func).__call if h then return h(func, ...) else error(Â·Â·Â·) end endend 2.9 - ç¯å¢ƒç±»å‹ä¸º thread ï¼Œfunction ï¼Œä»¥åŠ userdata çš„å¯¹è±¡ï¼Œé™¤äº† metatable å¤–è¿˜å¯ä»¥ç”¨å¦å¤–ä¸€ä¸ªä¸ä¹‹å…³è”çš„è¢«ç§°ä½œ å®ƒä»¬çš„ç¯å¢ƒçš„ä¸€ä¸ªè¡¨ï¼Œ åƒ metatable ä¸€æ ·ï¼Œç¯å¢ƒä¹Ÿæ˜¯ä¸€ä¸ªå¸¸è§„çš„ table ï¼Œå¤šä¸ªå¯¹è±¡å¯ä»¥å…±äº« åŒä¸€ä¸ªç¯å¢ƒã€‚userdata çš„ç¯å¢ƒåœ¨ Lua ä¸­æ²¡æœ‰æ„ä¹‰ã€‚ è¿™ä¸ªä¸œè¥¿åªæ˜¯ä¸ºäº†åœ¨ç¨‹åºå‘˜æƒ³æŠŠä¸€ä¸ªè¡¨å…³è”åˆ°ä¸€ä¸ª userdata ä¸Šæ—¶æä¾›ä¾¿åˆ©ã€‚å…³è”åœ¨çº¿ç¨‹ä¸Šçš„ç¯å¢ƒè¢«ç§°ä½œå…¨å±€ç¯å¢ƒã€‚ å…¨å±€ç¯å¢ƒè¢«ç”¨ä½œå®ƒå…¶ä¸­çš„çº¿ç¨‹ä»¥åŠçº¿ç¨‹åˆ›å»ºçš„éåµŒå¥—å‡½æ•° ï¼ˆé€šè¿‡ loadfile ï¼Œ loadstring æˆ–æ˜¯ load ï¼‰çš„ç¼ºçœç¯å¢ƒã€‚ è€Œä¸”å®ƒå¯ä»¥è¢« C ä»£ç ç›´æ¥è®¿é—®ï¼ˆå‚è§ Â§3.3ï¼‰ã€‚å…³è”åœ¨ C å‡½æ•°ä¸Šçš„ç¯å¢ƒå¯ä»¥ç›´æ¥è¢« C ä»£ç è®¿é—®ï¼ˆå‚è§ Â§3.3ï¼‰ã€‚ å®ƒä»¬ä¼šä½œä¸ºè¿™ä¸ª C å‡½æ•°ä¸­åˆ›å»ºçš„å…¶å®ƒå‡½æ•°çš„ç¼ºçœç¯å¢ƒã€‚å…³è”åœ¨ Lua å‡½æ•°ä¸Šçš„ç¯å¢ƒç”¨æ¥æ¥ç®¡åœ¨å‡½æ•°å†…å¯¹å…¨å±€å˜é‡ï¼ˆå‚è§ Â§2.3ï¼‰çš„æ‰€æœ‰è®¿é—®ã€‚ å®ƒä»¬ä¹Ÿä¼šä½œä¸ºè¿™ä¸ªå‡½æ•°å†…åˆ›å»ºçš„å…¶å®ƒå‡½æ•°çš„ç¼ºçœç¯å¢ƒã€‚ä½ å¯ä»¥é€šè¿‡è°ƒç”¨ setfenv æ¥æ”¹å˜ä¸€ä¸ª Lua å‡½æ•° æˆ–æ˜¯æ­£åœ¨è¿è¡Œä¸­çš„çº¿ç¨‹çš„ç¯å¢ƒã€‚ è€Œæƒ³æ“æ§å…¶å®ƒå¯¹è±¡ï¼ˆuserdataã€C å‡½æ•°ã€å…¶å®ƒçº¿ç¨‹ï¼‰çš„ç¯å¢ƒçš„è¯ï¼Œå°±å¿…é¡»ä½¿ç”¨ C API ã€‚ 2.10 - åƒåœ¾æ”¶é›†Lua æä¾›äº†ä¸€ä¸ªè‡ªåŠ¨çš„å†…å­˜ç®¡ç†ã€‚ è¿™å°±æ˜¯è¯´ä½ ä¸éœ€è¦å…³å¿ƒåˆ›å»ºæ–°å¯¹è±¡çš„åˆ†é…å†…å­˜æ“ä½œï¼Œä¹Ÿä¸éœ€è¦åœ¨è¿™äº›å¯¹è±¡ä¸å†éœ€è¦æ—¶çš„ä¸»åŠ¨é‡Šæ”¾å†…å­˜ã€‚ Lua é€šè¿‡è¿è¡Œä¸€ä¸ªåƒåœ¾æ”¶é›†å™¨æ¥è‡ªåŠ¨ç®¡ç†å†…å­˜ï¼Œä»¥æ­¤ä¸€éåˆä¸€éçš„å›æ”¶æ­»æ‰çš„å¯¹è±¡ ï¼ˆè¿™æ˜¯æŒ‡ Lua ä¸­ä¸å†è®¿é—®çš„åˆ°çš„å¯¹è±¡ï¼‰å ç”¨çš„å†…å­˜ã€‚ Lua ä¸­æ‰€æœ‰å¯¹è±¡éƒ½è¢«è‡ªåŠ¨ç®¡ç†ï¼ŒåŒ…æ‹¬ï¼š table, userdataã€ å‡½æ•°ã€çº¿ç¨‹ã€å’Œå­—ç¬¦ä¸²ã€‚Lua å®ç°äº†ä¸€ä¸ªå¢é‡æ ‡è®°æ¸…é™¤çš„æ”¶é›†å™¨ã€‚ å®ƒç”¨ä¸¤ä¸ªæ•°å­—æ¥æ§åˆ¶åƒåœ¾æ”¶é›†å‘¨æœŸï¼š garbage-collector pause å’Œ garbage-collector step multiplier ã€‚garbage-collector pause æ§åˆ¶äº†æ”¶é›†å™¨åœ¨å¼€å§‹ä¸€ä¸ªæ–°çš„æ”¶é›†å‘¨æœŸä¹‹å‰è¦ç­‰å¾…å¤šä¹…ã€‚ éšç€æ•°å­—çš„å¢å¤§å°±å¯¼è‡´æ”¶é›†å™¨å·¥ä½œå·¥ä½œçš„ä¸é‚£ä¹ˆä¸»åŠ¨ã€‚ å°äº 1 çš„å€¼æ„å‘³ç€æ”¶é›†å™¨åœ¨æ–°çš„å‘¨æœŸå¼€å§‹æ—¶ä¸å†ç­‰å¾…ã€‚ å½“å€¼ä¸º 2 çš„æ—¶å€™æ„å‘³ç€åœ¨æ€»ä½¿ç”¨å†…å­˜æ•°é‡è¾¾åˆ°åŸæ¥çš„ä¸¤å€æ—¶å†å¼€å¯æ–°çš„å‘¨æœŸã€‚step multiplier æ§åˆ¶äº†æ”¶é›†å™¨ç›¸å¯¹å†…å­˜åˆ†é…çš„é€Ÿåº¦ã€‚ æ›´å¤§çš„æ•°å­—å°†å¯¼è‡´æ”¶é›†å™¨å·¥ä½œçš„æ›´ä¸»åŠ¨çš„åŒæ—¶ï¼Œä¹Ÿä½¿æ¯æ­¥æ”¶é›†çš„å°ºå¯¸å¢åŠ ã€‚ å°äº 1 çš„å€¼ä¼šä½¿æ”¶é›†å™¨å·¥ä½œçš„éå¸¸æ…¢ï¼Œå¯èƒ½å¯¼è‡´æ”¶é›†å™¨æ°¸è¿œéƒ½ç»“æŸä¸äº†å½“å‰å‘¨æœŸã€‚ ç¼ºçœå€¼ä¸º 2 ï¼Œè¿™æ„å‘³ç€æ”¶é›†å™¨å°†ä»¥å†…å­˜åˆ†é…å™¨çš„ä¸¤å€é€Ÿè¿è¡Œã€‚ä½ å¯ä»¥é€šè¿‡åœ¨ C ä¸­è°ƒç”¨ lua_gc æˆ–æ˜¯åœ¨ Lua ä¸­è°ƒç”¨ collectgarbage æ¥æ”¹å˜è¿™äº›æ•°å­—ã€‚ ä¸¤è€…éƒ½æ¥å—ç™¾åˆ†æ¯”æ•°å€¼ï¼ˆå› æ­¤ä¼ å…¥å‚æ•° 100 æ„å‘³ç€å®é™…å€¼ 1 ï¼‰ã€‚ é€šè¿‡è¿™äº›å‡½æ•°ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥æ§åˆ¶æ”¶é›†å™¨ï¼ˆä¾‹å¦‚ï¼Œåœæ­¢æˆ–æ˜¯é‡å¯ï¼‰ã€‚ 2.10.1 - åƒåœ¾æ”¶é›†çš„å…ƒæ–¹æ³•ä½¿ç”¨ C API ï¼Œ ä½ å¯ä»¥ç»™ userdata ï¼ˆå‚è§ Â§2.8ï¼‰è®¾ç½®ä¸€ä¸ªåƒåœ¾æ”¶é›†çš„å…ƒæ–¹æ³•ã€‚ è¿™ä¸ªå…ƒæ–¹æ³•ä¹Ÿè¢«ç§°ä¸ºç»“æŸå­ã€‚ ç»“æŸå­å…è®¸ä½ ç”¨é¢å¤–çš„èµ„æºç®¡ç†å™¨å’Œ Lua çš„å†…å­˜ç®¡ç†å™¨ååŒå·¥ä½œ ï¼ˆæ¯”å¦‚å…³é—­æ–‡ä»¶ã€ç½‘ç»œè¿æ¥ã€æˆ–æ˜¯æ•°æ®åº“è¿æ¥ï¼Œä¹Ÿå¯ä»¥è¯´é‡Šæ”¾ä½ è‡ªå·±çš„å†…å­˜ï¼‰ã€‚ä¸€ä¸ª userdata å¯è¢«å›æ”¶ï¼Œè‹¥å®ƒçš„ metatable ä¸­æœ‰ __gc è¿™ä¸ªåŸŸ ï¼Œ åƒåœ¾æ”¶é›†å™¨å°±ä¸ç«‹å³æ”¶å›å®ƒã€‚ å–è€Œä»£ä¹‹çš„æ˜¯ï¼ŒLua æŠŠå®ƒä»¬æ”¾åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ã€‚ æœ€æ”¶é›†ç»“æŸåï¼ŒLua é’ˆå¯¹åˆ—è¡¨ä¸­çš„æ¯ä¸ª userdata æ‰§è¡Œäº†ä¸‹é¢è¿™ä¸ªå‡½æ•°çš„ç­‰ä»·æ“ä½œï¼š function gc_event (udata) local h = metatable(udata).__gc if h then h(udata) end end åœ¨æ¯ä¸ªåƒåœ¾æ”¶é›†å‘¨æœŸçš„ç»“å°¾ï¼Œæ¯ä¸ªåœ¨å½“å‰å‘¨æœŸè¢«æ”¶é›†èµ·æ¥çš„ userdata çš„ç»“æŸå­ä¼šä»¥ å®ƒä»¬æ„é€ æ—¶çš„é€†åºä¾æ¬¡è°ƒç”¨ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæ”¶é›†åˆ—è¡¨ä¸­ï¼Œæœ€åä¸€ä¸ªåœ¨ç¨‹åºä¸­è¢«åˆ›å»ºçš„ userdata çš„ ç»“æŸå­ä¼šè¢«ç¬¬ä¸€ä¸ªè°ƒç”¨ã€‚ 2.10.2 - Weak Tableï¼ˆå¼±è¡¨ï¼‰weak table æ˜¯ä¸€ä¸ªè¿™æ ·çš„ tableï¼Œå®ƒå…¶ä¸­çš„å…ƒç´ éƒ½è¢«å¼±å¼•ç”¨ã€‚ å¼±å¼•ç”¨å°†è¢«åƒåœ¾æ”¶é›†å™¨å¿½ç•¥æ‰ï¼Œ æ¢å¥è¯è¯´ï¼Œ å¦‚æœå¯¹ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨åªæœ‰å¼±å¼•ç”¨ï¼Œ åƒåœ¾æ”¶é›†å™¨å°†å›æ”¶è¿™ä¸ªå¯¹è±¡ã€‚ weak table çš„é”®å’Œå€¼éƒ½å¯ä»¥æ˜¯ weak çš„ã€‚ å¦‚æœä¸€ä¸ª table åªæœ‰é”®æ˜¯ weak çš„ï¼Œé‚£ä¹ˆå°†è¿è¡Œæ”¶é›†å™¨å›æ”¶å®ƒä»¬çš„é”®ï¼Œ ä½†æ˜¯ä¼šé˜»æ­¢å›æ”¶å™¨å›æ”¶å¯¹åº”çš„å€¼ã€‚ è€Œä¸€ä¸ª table çš„é”®å’Œå€¼éƒ½æ˜¯ weak æ—¶ï¼Œå°±å³å…è®¸æ”¶é›†å™¨å›æ”¶é”®åˆå…è®¸æ”¶å›å€¼ã€‚ ä»»ä½•æƒ…å†µä¸‹ï¼Œå¦‚æœé”®å’Œå€¼ä¸­ä»»ä¸€ä¸ªè¢«å›æ”¶äº†ï¼Œæ•´ä¸ªé”®å€¼å¯¹å°±ä¼šä» table ä¸­æ‹¿æ‰ã€‚ table çš„ weak ç‰¹æ€§å¯ä»¥é€šè¿‡åœ¨å®ƒçš„ metatable ä¸­è®¾ç½® mode åŸŸæ¥æ”¹å˜ã€‚ å¦‚æœ mode åŸŸä¸­æ˜¯ä¸€ä¸ªåŒ…å«æœ‰å­—ç¬¦ â€˜kâ€™ çš„å­—ç¬¦ä¸²æ—¶ï¼Œ table çš„é”®å°±æ˜¯ weak çš„ã€‚ å¦‚æœ __mode åŸŸä¸­æ˜¯ä¸€ä¸ªåŒ…å«æœ‰å­—ç¬¦ â€˜vâ€™ çš„å­—ç¬¦ä¸²æ—¶ï¼Œ table çš„å€¼å°±æ˜¯ weak çš„ã€‚ åœ¨ä½ æŠŠä¸€ä¸ª table å½“ä½œä¸€ä¸ª metatable ä½¿ç”¨ä¹‹åï¼Œ å°±ä¸èƒ½å†ä¿®æ”¹ __mode åŸŸçš„å€¼ã€‚ å¦åˆ™ï¼Œå—è¿™ä¸ª metatable æ§åˆ¶çš„ table çš„ weak è¡Œä¸ºå°±æˆäº†æœªå®šä¹‰çš„ã€‚ 2.11 - Coroutine ï¼ˆååŒä¾‹ç¨‹ï¼‰Lua æ”¯æŒ coroutine ï¼Œè¿™ä¸ªä¸œè¥¿ä¹Ÿè¢«ç§°ä¸ºååŒå¼å¤šçº¿ç¨‹ (collaborative multithreading) ã€‚ Lua ä¸ºæ¯ä¸ª coroutine æä¾›ä¸€ä¸ªç‹¬ç«‹çš„è¿è¡Œçº¿è·¯ã€‚ ç„¶è€Œå’Œå¤šçº¿ç¨‹ç³»ç»Ÿä¸­çš„çº¿ç¨‹ä¸åŒï¼Œcoroutine åªåœ¨æ˜¾å¼çš„è°ƒç”¨äº† yield å‡½æ•°æ—¶æ‰ä¼šæŒ‚èµ·ã€‚ åˆ›å»ºä¸€ä¸ª coroutine éœ€è¦è°ƒç”¨ä¸€æ¬¡ coroutine.create ã€‚ å®ƒåªæ¥æ”¶å•ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æ˜¯ coroutine çš„ä¸»å‡½æ•°ã€‚ create å‡½æ•°ä»…ä»…åˆ›å»ºä¸€ä¸ªæ–°çš„ coroutine ç„¶åè¿”å›å®ƒçš„æ§åˆ¶å™¨ ï¼ˆä¸€ä¸ªç±»å‹ä¸º thread çš„å¯¹è±¡ï¼‰ï¼› å®ƒå¹¶ä¸ä¼šå¯åŠ¨ coroutine çš„è¿è¡Œã€‚ å½“ä½ ç¬¬ä¸€æ¬¡è°ƒç”¨ coroutine.resume æ—¶ï¼Œ æ‰€éœ€ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ coroutine.create çš„è¿”å›å€¼ã€‚ è¿™æ—¶ï¼Œcoroutine ä»ä¸»å‡½æ•°çš„ç¬¬ä¸€è¡Œå¼€å§‹è¿è¡Œã€‚ æ¥ä¸‹æ¥ä¼ å…¥ coroutine.resume çš„å‚æ•°å°†è¢«ä¼ è¿› coroutine çš„ä¸»å‡½æ•°ã€‚ åœ¨ coroutine å¼€å§‹è¿è¡Œåï¼Œå®ƒè®²è¿è¡Œåˆ°è‡ªèº«ç»ˆæ­¢æˆ–æ˜¯é‡åˆ°ä¸€ä¸ª yields ã€‚ coroutine å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ¥ç»ˆæ­¢è¿è¡Œï¼š ä¸€ç§æ˜¯æ­£å¸¸é€€å‡ºï¼ŒæŒ‡å®ƒçš„ä¸»å‡½æ•°è¿”å›ï¼ˆæœ€åä¸€æ¡æŒ‡ä»¤è¢«è¿è¡Œåï¼Œæ— è®ºæœ‰æ²¡æœ‰æ˜¾å¼çš„è¿”å›æŒ‡ä»¤ï¼‰; å¦ä¸€ç§æ˜¯éæ­£å¸¸é€€å‡ºï¼Œå®ƒå‘ç”Ÿåœ¨æœªä¿æŠ¤çš„é”™è¯¯å‘ç”Ÿçš„æ—¶å€™ã€‚ ç¬¬ä¸€ç§æƒ…å†µä¸­ï¼Œ coroutine.resume è¿”å› true ï¼Œ æ¥ä¸‹æ¥ä¼šè·Ÿç€ coroutine ä¸»å‡½æ•°çš„ä¸€ç³»åˆ—è¿”å›å€¼ã€‚ ç¬¬äºŒç§å‘ç”Ÿé”™è¯¯çš„æƒ…å†µä¸‹ï¼Œ coroutine.resume è¿”å› false ï¼Œ ç´§æ¥ç€æ˜¯ä¸€æ¡é”™è¯¯ä¿¡æ¯ã€‚ coroutine ä¸­åˆ‡æ¢å‡ºå»ï¼Œå¯ä»¥è°ƒç”¨ coroutine.yieldã€‚ å½“ coroutine åˆ‡å‡ºï¼Œä¸ä¹‹é…åˆçš„ coroutine.resume å°±ç«‹å³è¿”å›ï¼Œ ç”šè‡³åœ¨ yield å‘ç”Ÿåœ¨å†…å±‚çš„å‡½æ•°è°ƒç”¨ä¸­ä¹Ÿå¯ä»¥ï¼ˆå°±æ˜¯è¯´ï¼Œ è¿™ä¸é™äºå‘ç”Ÿåœ¨ä¸»å‡½æ•°ä¸­ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸»å‡½æ•°ç›´æ¥æˆ–é—´æ¥è°ƒç”¨çš„æŸä¸ªå‡½æ•°é‡Œï¼‰ã€‚ åœ¨ yield çš„æƒ…å†µä¸‹ï¼Œcoroutine.resume ä¹Ÿæ˜¯è¿”å› trueï¼Œ ç´§è·Ÿç€é‚£äº›è¢«ä¼ å…¥ coroutine.yield çš„å‚æ•°ã€‚ ç­‰åˆ°ä¸‹æ¬¡ä½ åœ¨ç»§ç»­åŒæ ·çš„ coroutine ï¼Œå°†ä»è°ƒç”¨ yield çš„æ–­ç‚¹å¤„è¿è¡Œä¸‹å»ã€‚ æ–­ç‚¹å¤„ yield çš„è¿”å›å€¼å°†æ˜¯ coroutine.resume ä¼ å…¥çš„å‚æ•°ã€‚ ç±»ä¼¼ coroutine.create ï¼Œ coroutine.wrap è¿™ä¸ªå‡½æ•°ä¹Ÿå°†åˆ›å»ºä¸€ä¸ª coroutine ï¼Œ ä½†æ˜¯å®ƒå¹¶ä¸è¿”å› coroutine æœ¬èº«ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªå‡½æ•°å–è€Œä»£ä¹‹ã€‚ä¸€æ—¦ä½ è°ƒç”¨è¿™ä¸ªè¿”å›å‡½æ•°ï¼Œå°±ä¼šåˆ‡å…¥ coroutine è¿è¡Œã€‚ æ‰€æœ‰ä¼ å…¥è¿™ä¸ªå‡½æ•°çš„å‚æ•°ç­‰åŒäºä¼ å…¥ coroutine.resume çš„å‚æ•°ã€‚ coroutine.wrap ä¼šè¿”å›æ‰€æœ‰åº”è¯¥ç”±é™¤ç¬¬ä¸€ä¸ªï¼ˆé”™è¯¯ä»£ç çš„é‚£ä¸ªå¸ƒå°”é‡ï¼‰ ä¹‹å¤–çš„ç”± coroutine.resume è¿”å›çš„å€¼ã€‚ å’Œ coroutine.resume ä¸åŒï¼Œ coroutine.wrap ä¸æ•è·ä»»ä½•é”™è¯¯ï¼› æ‰€æœ‰çš„é”™è¯¯éƒ½åº”è¯¥ç”±è°ƒç”¨è€…è‡ªå·±ä¼ é€’ã€‚ çœ‹ä¸‹é¢è¿™æ®µä»£ç å±•ç¤ºçš„ä¸€ä¸ªä¾‹å­ï¼š function foo (a) print(&quot;foo&quot;, a) return coroutine.yield(2*a) end co = coroutine.create(function (a,b) print(&quot;co-body&quot;, a, b) local r = foo(a+1) print(&quot;co-body&quot;, r) local r, s = coroutine.yield(a+b, a-b) print(&quot;co-body&quot;, r, s) return b, &quot;end&quot; end) print(&quot;main&quot;, coroutine.resume(co, 1, 10)) print(&quot;main&quot;, coroutine.resume(co, &quot;r&quot;)) print(&quot;main&quot;, coroutine.resume(co, &quot;x&quot;, &quot;y&quot;)) print(&quot;main&quot;, coroutine.resume(co, &quot;x&quot;, &quot;y&quot;)) å½“ä½ è¿è¡Œå®ƒï¼Œå°†å¾—åˆ°å¦‚ä¸‹è¾“å‡ºç»“æœï¼š co-body 1 10 foo 2 main true 4 co-body r main true 11 -9 co-body x y main true 10 end main false cannot resume dead coroutine 3 - ç¨‹åºæ¥å£ï¼ˆAPIï¼‰è¿™ä¸ªéƒ¨åˆ†æè¿°äº† Lua çš„ C API ï¼Œ ä¹Ÿå°±æ˜¯å®¿ä¸»ç¨‹åºè·Ÿ Lua é€šè®¯ç”¨çš„ä¸€ç»„ C å‡½æ•°ã€‚ æ‰€æœ‰çš„ API å‡½æ•°æŒ‰ç›¸å…³çš„ç±»å‹ä»¥åŠå¸¸é‡éƒ½å£°æ˜åœ¨å¤´æ–‡ä»¶ lua.h ä¸­ã€‚ è™½ç„¶æˆ‘ä»¬è¯´çš„æ˜¯â€œå‡½æ•°â€ï¼Œä½†ä¸€éƒ¨åˆ†ç®€å•çš„ API æ˜¯ä»¥å®çš„å½¢å¼æä¾›çš„ã€‚ æ‰€æœ‰çš„è¿™äº›å®éƒ½åªä½¿ç”¨å®ƒä»¬çš„å‚æ•°ä¸€æ¬¡ ï¼ˆé™¤äº†ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ lua çŠ¶æ€æœºï¼‰ï¼Œ å› æ­¤ä½ ä¸éœ€æ‹…å¿ƒè¿™äº›å®çš„å±•å¼€ä¼šå¼•èµ·ä¸€äº›å‰¯ä½œç”¨ã€‚ åœ¨æ‰€æœ‰çš„ C åº“ä¸­ï¼ŒLua API å‡½æ•°éƒ½ä¸å»æ£€æŸ¥å‚æ•°çš„æœ‰æ•ˆæ€§å’Œåšå›ºæ€§ã€‚ ç„¶è€Œï¼Œä½ å¯ä»¥åœ¨ç¼–è¯‘ Lua æ—¶åŠ ä¸Šæ‰“å¼€ä¸€ä¸ªå®å¼€å…³æ¥ å¼€å¯ luaconf.h æ–‡ä»¶ä¸­çš„å® luai_apicheck ä»¥æ”¹å˜è¿™ä¸ªè¡Œä¸ºã€‚ å †æ ˆLua ä½¿ç”¨ä¸€ä¸ªè™šæ‹Ÿæ ˆæ¥å’Œ C ä¼ é€’å€¼ã€‚ æ ˆä¸Šçš„çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ª Lua å€¼ ï¼ˆnilï¼Œæ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œç­‰ç­‰ï¼‰ã€‚ æ— è®ºä½•æ—¶ Lua è°ƒç”¨ Cï¼Œè¢«è°ƒç”¨çš„å‡½æ•°éƒ½å¾—åˆ°ä¸€ä¸ªæ–°çš„æ ˆï¼Œ è¿™ä¸ªæ ˆç‹¬ç«‹äº C å‡½æ•°æœ¬èº«çš„å †æ ˆï¼Œä¹Ÿç‹¬ç«‹äºä»¥å‰çš„æ ˆã€‚ ï¼ˆè¯‘æ³¨ï¼šåœ¨ C å‡½æ•°é‡Œï¼Œç”¨ Lua API ä¸èƒ½è®¿é—®åˆ° Lua çŠ¶æ€æœºä¸­æœ¬æ¬¡è°ƒç”¨ä¹‹å¤–çš„å †æ ˆä¸­çš„æ•°æ®ï¼‰ å®ƒé‡Œé¢åŒ…å«äº† Lua ä¼ é€’ç»™ C å‡½æ•°çš„æ‰€æœ‰å‚æ•°ï¼Œ è€Œ C å‡½æ•°åˆ™æŠŠè¦è¿”å›çš„ç»“æœä¹Ÿæ”¾å…¥å †æ ˆä»¥è¿”å›ç»™è°ƒç”¨è€… ï¼ˆå‚è§ lua_CFunctionï¼‰ã€‚ æ–¹ä¾¿èµ·è§ï¼Œæ‰€æœ‰é’ˆå¯¹æ ˆçš„ API æŸ¥è¯¢æ“ä½œéƒ½ä¸ä¸¥æ ¼éµå¾ªæ ˆçš„æ“ä½œè§„åˆ™ã€‚ è€Œæ˜¯å¯ä»¥ç”¨ä¸€ä¸ªç´¢å¼•æ¥æŒ‡å‘æ ˆä¸Šçš„ä»»ä½•å…ƒç´ ï¼š æ­£çš„ç´¢å¼•æŒ‡çš„æ˜¯æ ˆä¸Šçš„ç»å¯¹ä½ç½®ï¼ˆä»ä¸€å¼€å§‹ï¼‰ï¼› è´Ÿçš„ç´¢å¼•åˆ™æŒ‡ä»æ ˆé¡¶å¼€å§‹çš„åç§»é‡ã€‚ æ›´è¯¦ç»†çš„è¯´æ˜ä¸€ä¸‹ï¼Œå¦‚æœå †æ ˆæœ‰ n ä¸ªå…ƒç´ ï¼Œ é‚£ä¹ˆç´¢å¼• 1 è¡¨ç¤ºç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆä¹Ÿå°±æ˜¯æœ€å…ˆè¢«å‹å…¥å †æ ˆçš„å…ƒç´ ï¼‰ è€Œç´¢å¼• n åˆ™æŒ‡æœ€åä¸€ä¸ªå…ƒç´ ï¼› ç´¢å¼• -1 ä¹Ÿæ˜¯æŒ‡æœ€åä¸€ä¸ªå…ƒç´ ï¼ˆå³æ ˆé¡¶çš„å…ƒç´ ï¼‰ï¼Œ ç´¢å¼• -n æ˜¯æŒ‡ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ å¦‚æœç´¢å¼•åœ¨ 1 åˆ°æ ˆé¡¶ä¹‹é—´ï¼ˆä¹Ÿå°±æ˜¯ï¼Œ1 â‰¤ abs(index) â‰¤ topï¼‰ æˆ‘ä»¬å°±è¯´è¿™æ˜¯ä¸ªæœ‰æ•ˆçš„ç´¢å¼•ã€‚ å †æ ˆå°ºå¯¸å½“ä½ ä½¿ç”¨ Lua API æ—¶ï¼Œå°±æœ‰è´£ä»»ä¿è¯å…¶åšå›ºæ€§ã€‚ ç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½ æœ‰è´£ä»»æ§åˆ¶ä¸è¦å †æ ˆæº¢å‡ºã€‚ä½ å¯ä»¥ä½¿ç”¨ lua_checkstack è¿™ä¸ªå‡½æ•°æ¥æ‰©å¤§å¯ç”¨å †æ ˆçš„å°ºå¯¸ã€‚æ— è®ºä½•æ—¶ Lua è°ƒç”¨ C ï¼Œ å®ƒéƒ½åªä¿è¯ LUA_MINSTACK è¿™ä¹ˆå¤šçš„å †æ ˆç©ºé—´å¯ä»¥ä½¿ç”¨ã€‚ LUA_MINSTACK ä¸€èˆ¬è¢«å®šä¹‰ä¸º 20 ï¼Œå› æ­¤ï¼Œåªè¦ä½ ä¸æ˜¯ä¸æ–­çš„æŠŠæ•°æ®å‹æ ˆï¼Œé€šå¸¸ä½ ä¸ç”¨å…³å¿ƒå †æ ˆå¤§å°ã€‚æ‰€æœ‰çš„æŸ¥è¯¢å‡½æ•°éƒ½å¯ä»¥æ¥æ”¶ä¸€ä¸ªç´¢å¼•ï¼Œåªè¦è¿™ä¸ªç´¢å¼•æ˜¯ä»»ä½•æ ˆæä¾›çš„ç©ºé—´ä¸­çš„å€¼ã€‚ æ ˆèƒ½æä¾›çš„æœ€å¤§ç©ºé—´æ˜¯é€šè¿‡ lua_checkstack æ¥è®¾ç½®çš„ã€‚ è¿™äº›ç´¢å¼•è¢«ç§°ä½œå¯æ¥å—çš„ç´¢å¼•ï¼Œé€šå¸¸æˆ‘ä»¬æŠŠå®ƒå®šä¹‰ä¸ºï¼š (index &lt; 0 &amp;&amp; abs(index) &lt;= top) || (index &gt; 0 &amp;&amp; index &lt;= stackspace) æ³¨æ„ï¼Œ0 æ°¸è¿œéƒ½ä¸æ˜¯ä¸€ä¸ªå¯æ¥å—çš„ç´¢å¼•ã€‚ï¼ˆè¯‘æ³¨ï¼šä¸‹æ–‡ä¸­å‡¡æåˆ°çš„ç´¢å¼•ï¼Œæ²¡æœ‰ç‰¹åˆ«æ³¨æ˜çš„è¯ï¼Œéƒ½æŒ‡å¯æ¥å—çš„ç´¢å¼•ã€‚ï¼‰ LUA_GLOBALSINDEXé™¤äº†ç‰¹åˆ«å£°æ˜å¤–ï¼Œä»»ä½•ä¸€ä¸ªå‡½æ•°éƒ½å¯ä»¥æ¥å—å¦ä¸€ç§æœ‰æ•ˆçš„ç´¢å¼•ï¼Œå®ƒä»¬è¢«ç§°ä½œâ€œä¼ªç´¢å¼•â€ã€‚ è¿™ä¸ªå¯ä»¥å¸®åŠ© C ä»£ç è®¿é—®ä¸€äº›å¹¶ä¸åœ¨æ ˆä¸Šçš„ Lua å€¼ã€‚ ä¼ªç´¢å¼•è¢«ç”¨æ¥è®¿é—®çº¿ç¨‹çš„ç¯å¢ƒï¼Œå‡½æ•°çš„ç¯å¢ƒï¼Œæ³¨å†Œè¡¨ï¼Œè¿˜æœ‰ C å‡½æ•°çš„ upvalueã€‚çº¿ç¨‹çš„ç¯å¢ƒï¼ˆä¹Ÿå°±æ˜¯å…¨å±€å˜é‡æ”¾çš„åœ°æ–¹ï¼‰é€šå¸¸åœ¨ä¼ªç´¢å¼• LUA_GLOBALSINDEX å¤„ã€‚ æ­£åœ¨è¿è¡Œçš„ C å‡½æ•°çš„ç¯å¢ƒåˆ™æ”¾åœ¨ä¼ªç´¢å¼• LUA_ENVIRONINDEX ä¹‹å¤„ã€‚å¯ä»¥ç”¨å¸¸è§„çš„ table æ“ä½œæ¥è®¿é—®å’Œæ”¹å˜å…¨å±€å˜é‡çš„å€¼ï¼Œåªéœ€è¦æŒ‡å®šç¯å¢ƒè¡¨çš„ä½ç½®ã€‚ ä¸¾ä¾‹è€Œè¨€ï¼Œè¦è®¿é—®å…¨å±€å˜é‡çš„å€¼ï¼Œè¿™æ ·åšï¼š lua_getfield(L, LUA_GLOBALSINDEX, varname); C Closureå½“ C å‡½æ•°è¢«åˆ›å»ºå‡ºæ¥ï¼Œæˆ‘ä»¬æœ‰å¯èƒ½ä¼šæŠŠä¸€äº›å€¼å…³è”åœ¨ä¸€èµ·ï¼Œ ä¹Ÿå°±æ˜¯åˆ›å»ºä¸€ä¸ª C closure ï¼› è¿™äº›è¢«å…³è”èµ·æ¥çš„å€¼è¢«å«åš upvalue ï¼Œå®ƒä»¬å¯ä»¥åœ¨å‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™è®¿é—®çš„åˆ°ã€‚ ï¼ˆå‚è§ lua_pushcclosure ï¼‰ã€‚æ— è®ºä½•æ—¶å»è°ƒç”¨ C å‡½æ•°ï¼Œå‡½æ•°çš„ upvalue éƒ½è¢«æ”¾åœ¨æŒ‡å®šçš„ä¼ªç´¢å¼•å¤„ã€‚ æˆ‘ä»¬å¯ä»¥ç”¨ lua_upvalueindex è¿™ä¸ªå®æ¥ç”Ÿæˆè¿™äº›ä¼ªç´¢å¼•ã€‚ ç¬¬ä¸€ä¸ªå…³è”åˆ°å‡½æ•°çš„å€¼æ”¾åœ¨ lua_upvalueindex(1) ä½ç½®å¤„ï¼Œä¾æ¬¡ç±»æ¨ã€‚ ä»»ä½•æƒ…å†µä¸‹éƒ½å¯ä»¥ç”¨ lua_upvalueindex(n) äº§ç”Ÿä¸€ä¸ª upvalue çš„ç´¢å¼•ï¼Œ å³ä½¿ n å¤§äºå®é™…çš„ upvalue æ•°é‡ä¹Ÿå¯ä»¥ã€‚å®ƒéƒ½å¯ä»¥äº§ç”Ÿä¸€ä¸ªå¯æ¥å—ä½†ä¸ä¸€å®šæœ‰æ•ˆçš„ç´¢å¼•ã€‚ LUA_REGISTRYINDEXLuaæä¾›äº†ä¸€ä¸ªæ³¨å†Œè¡¨ï¼Œè¿™æ˜¯ä¸€ä¸ªé¢„å®šä¹‰å‡ºæ¥çš„è¡¨ï¼Œå¯ä»¥ç”¨æ¥ä¿å­˜ä»»ä½•Cä»£ç æƒ³ä¿å­˜çš„Luaå€¼ã€‚è¿™ä¸ªè¡¨å¯ä»¥ç”¨ä¼ªç´¢å¼•LUA_REGISTRYINDEXæ¥å®šä½ã€‚ ä»»ä½•Cåº“éƒ½å¯ä»¥åœ¨è¿™å¼ è¡¨é‡Œä¿å­˜æ•°æ®ï¼Œä¸ºäº†é˜²æ­¢å†²çªï¼Œä½ éœ€è¦ç‰¹åˆ«å°å¿ƒçš„é€‰æ‹©é”®åã€‚ ä¸€èˆ¬çš„ç”¨æ³•æ˜¯ï¼Œä½ å¯ä»¥ç”¨ä¸€ä¸ªåŒ…å«ä½ çš„åº“åçš„å­—ç¬¦ä¸²åšä¸ºé”®åï¼Œæˆ–è€…å¯ä»¥å–ä½ è‡ªå·±Cä»£ç ä¸­çš„ä¸€ä¸ªåœ°å€ï¼Œä»¥ light userdata çš„å½¢å¼åšé”®ã€‚æ³¨å†Œè¡¨é‡Œçš„æ•´æ•°å¥è¢«ç”¨äºè¡¥å……åº“ä¸­å®ç°çš„å¼•ç”¨ç³»ç»Ÿçš„å·¥ä½œï¼Œä¸€èˆ¬è¯´æ¥ä¸è¦æŠŠå®ƒä»¬ç”¨äºåˆ«çš„ç”¨é€”ã€‚ C ä¸­çš„é”™è¯¯å¤„ç†åœ¨å†…éƒ¨å®ç°ä¸­ï¼ŒLua ä½¿ç”¨äº† C çš„ longjmp æœºåˆ¶æ¥å¤„ç†é”™è¯¯ã€‚ ï¼ˆå¦‚æœä½ ä½¿ç”¨ C++ çš„è¯ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©æ¢ç”¨å¼‚å¸¸ï¼›å‚è§ luaconf.h æ–‡ä»¶ã€‚ï¼‰ å½“ Lua ç¢°åˆ°ä»»ä½•é”™è¯¯ï¼ˆæ¯”å¦‚å†…å­˜åˆ†é…é”™è¯¯ã€ç±»å‹é”™è¯¯ã€è¯­æ³•é”™è¯¯ã€è¿˜æœ‰ä¸€äº›è¿è¡Œæ—¶é”™è¯¯ï¼‰ å®ƒéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯å‡ºå»ï¼› ä¹Ÿå°±æ˜¯è°ƒç”¨ä¸€ä¸ª long jump ã€‚ åœ¨ä¿æŠ¤ç¯å¢ƒä¸‹ï¼ŒLua ä½¿ç”¨ setjmp æ¥è®¾ç½®ä¸€ä¸ªæ¢å¤ç‚¹ï¼› ä»»ä½•å‘ç”Ÿçš„é”™è¯¯éƒ½ä¼šæ¿€æ´»æœ€è¿‘çš„ä¸€ä¸ªæ¢å¤ç‚¹ã€‚å‡ ä¹æ‰€æœ‰çš„ API å‡½æ•°éƒ½å¯èƒ½äº§ç”Ÿé”™è¯¯ï¼Œä¾‹å¦‚å†…å­˜åˆ†é…é”™è¯¯ã€‚ ä½†ä¸‹é¢çš„ä¸€äº›å‡½æ•°è¿è¡Œåœ¨ä¿æŠ¤ç¯å¢ƒä¸­ï¼ˆä¹Ÿå°±æ˜¯è¯´å®ƒä»¬åˆ›å»ºäº†ä¸€ä¸ªä¿æŠ¤ç¯å¢ƒå†åœ¨å…¶ä¸­è¿è¡Œï¼‰ï¼Œ å› æ­¤å®ƒä»¬ä¸ä¼šäº§ç”Ÿé”™è¯¯å‡ºæ¥ï¼š lua_newstate, lua_close, lua_load, lua_pcall, and lua_cpcallã€‚ åœ¨ C å‡½æ•°é‡Œï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ lua_error äº§ç”Ÿä¸€ä¸ªé”™è¯¯ã€‚ lua_Alloctypedef void * (*lua_Alloc) (void *ud, void *ptr, size_t osize, size_t nsize); Lua çŠ¶æ€æœºä¸­ä½¿ç”¨çš„å†…å­˜åˆ†é…å™¨å‡½æ•°çš„ç±»å‹ã€‚ å†…å­˜åˆ†é…å‡½æ•°å¿…é¡»æä¾›ä¸€ä¸ªåŠŸèƒ½ç±»ä¼¼äº realloc ä½†åˆä¸å®Œå…¨ç›¸åŒçš„å‡½æ•°ã€‚ å®ƒçš„å‚æ•°æœ‰ ud ï¼Œä¸€ä¸ªç”± lua_newstate ä¼ ç»™å®ƒçš„æŒ‡é’ˆï¼› ptr ï¼Œä¸€ä¸ªæŒ‡å‘å·²åˆ†é…å‡ºæ¥æˆ–æ˜¯å°†è¢«é‡æ–°åˆ†é…æˆ–æ˜¯è¦é‡Šæ”¾çš„å†…å­˜å—æŒ‡é’ˆï¼› osize ï¼Œå†…å­˜å—åŸæ¥çš„å°ºå¯¸ï¼› nsize ï¼Œæ–°å†…å­˜å—çš„å°ºå¯¸ã€‚ å¦‚æœä¸”åªæœ‰ osize æ˜¯é›¶æ—¶ï¼Œptr ä¸º NULL ã€‚ å½“ nsize æ˜¯é›¶ï¼Œåˆ†é…å™¨å¿…é¡»è¿”å› NULLï¼› å¦‚æœ osize ä¸æ˜¯é›¶ï¼Œåˆ†é…å™¨åº”å½“é‡Šæ”¾æ‰ ptr æŒ‡å‘çš„å†…å­˜å—ã€‚ å½“ nsize ä¸æ˜¯é›¶ï¼Œè‹¥åˆ†é…å™¨ä¸èƒ½æ»¡è¶³è¯·æ±‚æ—¶ï¼Œåˆ†é…å™¨è¿”å› NULL ã€‚ å½“ nsize ä¸æ˜¯é›¶è€Œ osize æ˜¯é›¶æ—¶ï¼Œåˆ†é…å™¨åº”è¯¥å’Œ malloc æœ‰ç›¸åŒçš„è¡Œä¸ºã€‚ å½“ nsize å’Œ osize éƒ½ä¸æ˜¯é›¶æ—¶ï¼Œåˆ†é…å™¨åˆ™åº”å’Œ realloc ä¿æŒä¸€æ ·çš„è¡Œä¸ºã€‚ Lua å‡è®¾åˆ†é…å™¨åœ¨ osize &gt;= nsize æ—¶æ°¸è¿œä¸ä¼šå¤±è´¥ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„åˆ†é…å™¨å‡½æ•°çš„å®ç°ã€‚ è¿™ä¸ªå®ç°è¢«æ”¾åœ¨è¡¥å……åº“ä¸­ï¼Œç”± luaL_newstate æä¾›ã€‚ static void *l_alloc (void *ud, void *ptr, size_t osize, size_t nsize) { (void)ud; (void)osize; /* not used */ if (nsize == 0) { free(ptr); return NULL; } else return realloc(ptr, nsize); } è¿™æ®µä»£ç å‡è®¾ free(NULL) å•¥ä¹Ÿä¸å½±å“ï¼Œè€Œä¸” realloc(NULL, size) ç­‰ä»·äº malloc(size)ã€‚ è¿™ä¸¤ç‚¹æ˜¯ ANSI C ä¿è¯çš„è¡Œä¸ºã€‚ lua_atpaniclua_CFunction lua_atpanic (lua_State *L, lua_CFunction panicf); è®¾ç½®ä¸€ä¸ªæ–°çš„ panic ï¼ˆææ…Œï¼‰ å‡½æ•°ï¼Œå¹¶è¿”å›å‰ä¸€ä¸ªã€‚å¦‚æœåœ¨ä¿æŠ¤ç¯å¢ƒä¹‹å¤–å‘ç”Ÿäº†ä»»ä½•é”™è¯¯ï¼Œ Lua å°±ä¼šè°ƒç”¨ä¸€ä¸ª panic å‡½æ•°ï¼Œæ¥ç€è°ƒç”¨ exit(EXIT_FAILURE)ï¼Œ è¿™æ ·å°±å¼€å§‹é€€å‡ºå®¿ä¸»ç¨‹åºã€‚ ä½ çš„ panic å‡½æ•°å¯ä»¥æ°¸è¿œä¸è¿”å›ï¼ˆä¾‹å¦‚ä½œä¸€æ¬¡é•¿è·³è½¬ï¼‰æ¥é¿å…ç¨‹åºé€€å‡ºã€‚panic å‡½æ•°å¯ä»¥ä»æ ˆé¡¶å–åˆ°å‡ºé”™ä¿¡æ¯ã€‚ lua_callvoid lua_call (lua_State *L, int nargs, int nresults); è°ƒç”¨ä¸€ä¸ªå‡½æ•°ã€‚è¦è°ƒç”¨ä¸€ä¸ªå‡½æ•°è¯·éµå¾ªä»¥ä¸‹åè®®ï¼š é¦–å…ˆï¼Œè¦è°ƒç”¨çš„å‡½æ•°åº”è¯¥è¢«å‹å…¥å †æ ˆï¼› æ¥ç€ï¼ŒæŠŠéœ€è¦ä¼ é€’ç»™è¿™ä¸ªå‡½æ•°çš„å‚æ•°æŒ‰æ­£åºå‹æ ˆï¼› è¿™æ˜¯æŒ‡ç¬¬ä¸€ä¸ªå‚æ•°é¦–å…ˆå‹æ ˆã€‚ æœ€åè°ƒç”¨ä¸€ä¸‹ lua_callï¼› nargs æ˜¯ä½ å‹å…¥å †æ ˆçš„å‚æ•°ä¸ªæ•°ã€‚ å½“å‡½æ•°è°ƒç”¨å®Œæ¯•åï¼Œæ‰€æœ‰çš„å‚æ•°ä»¥åŠå‡½æ•°æœ¬èº«éƒ½ä¼šå‡ºæ ˆã€‚ è€Œå‡½æ•°çš„è¿”å›å€¼è¿™æ—¶åˆ™è¢«å‹å…¥å †æ ˆã€‚ è¿”å›å€¼çš„ä¸ªæ•°å°†è¢«è°ƒæ•´ä¸º nresults ä¸ªï¼Œ é™¤é nresults è¢«è®¾ç½®æˆ LUA_MULTRETã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„è¿”å›å€¼éƒ½è¢«å‹å…¥å †æ ˆä¸­ã€‚ Lua ä¼šä¿è¯è¿”å›å€¼éƒ½æ”¾å…¥æ ˆç©ºé—´ä¸­ã€‚ å‡½æ•°è¿”å›å€¼å°†æŒ‰æ­£åºå‹æ ˆï¼ˆç¬¬ä¸€ä¸ªè¿”å›å€¼é¦–å…ˆå‹æ ˆï¼‰ï¼Œ å› æ­¤åœ¨è°ƒç”¨ç»“æŸåï¼Œæœ€åä¸€ä¸ªè¿”å›å€¼å°†è¢«æ”¾åœ¨æ ˆé¡¶ã€‚ è¢«è°ƒç”¨å‡½æ•°å†…å‘ç”Ÿçš„é”™è¯¯å°†ï¼ˆé€šè¿‡ longjmpï¼‰ä¸€ç›´ä¸ŠæŠ›ã€‚ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œè¿™è¡Œ Lua ä»£ç ç­‰ä»·äºåœ¨å®¿ä¸»ç¨‹åºç”¨ C ä»£ç åšä¸€äº›å·¥ä½œï¼š a = f(&quot;how&quot;, t.x, 14) è¿™é‡Œæ˜¯ C é‡Œçš„ä»£ç ï¼š lua_getfield(L, LUA_GLOBALSINDEX, &quot;f&quot;); /* å°†è°ƒç”¨çš„å‡½æ•° */ lua_pushstring(L, &quot;how&quot;); /* ç¬¬ä¸€ä¸ªå‚æ•° */ lua_getfield(L, LUA_GLOBALSINDEX, &quot;t&quot;); /* table çš„ç´¢å¼• */ lua_getfield(L, -1, &quot;x&quot;); /* å‹å…¥ t.x çš„å€¼ï¼ˆç¬¬ 2 ä¸ªå‚æ•°ï¼‰*/ lua_remove(L, -2); /* ä»å †æ ˆä¸­ç§»å» &#39;t&#39; */ lua_pushinteger(L, 14); /* ç¬¬ 3 ä¸ªå‚æ•° */ lua_call(L, 3, 1); /* è°ƒç”¨ &#39;f&#39;ï¼Œä¼ å…¥ 3 ä¸ªå‚æ•°ï¼Œå¹¶ç´¢å– 1 ä¸ªè¿”å›å€¼ */ lua_setfield(L, LUA_GLOBALSINDEX, &quot;a&quot;); /* è®¾ç½®å…¨å±€å˜é‡ &#39;a&#39; */ æ³¨æ„ä¸Šé¢è¿™æ®µä»£ç æ˜¯â€œå¹³è¡¡â€çš„ï¼š åˆ°äº†æœ€åï¼Œå †æ ˆæ¢å¤æˆåŸç”±çš„é…ç½®ã€‚ lua_CFunctiontypedef int (*lua_CFunction) (lua_State *L); C å‡½æ•°çš„ç±»å‹ã€‚ä¸ºäº†æ­£ç¡®çš„å’Œ Lua é€šè®¯ï¼ŒC å‡½æ•°å¿…é¡»ä½¿ç”¨ä¸‹åˆ— å®šä¹‰äº†å‚æ•°ä»¥åŠè¿”å›å€¼ä¼ é€’æ–¹æ³•çš„åè®®ï¼š C å‡½æ•°é€šè¿‡ Lua ä¸­çš„å †æ ˆæ¥æ¥å—å‚æ•°ï¼Œå‚æ•°ä»¥æ­£åºå…¥æ ˆï¼ˆç¬¬ä¸€ä¸ªå‚æ•°é¦–å…ˆå…¥æ ˆï¼‰ã€‚ å› æ­¤ï¼Œå½“å‡½æ•°å¼€å§‹çš„æ—¶å€™ï¼Œ lua_gettop(L) å¯ä»¥è¿”å›å‡½æ•°æ”¶åˆ°çš„å‚æ•°ä¸ªæ•°ã€‚ ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰åœ¨ç´¢å¼• 1 çš„åœ°æ–¹ï¼Œè€Œæœ€åä¸€ä¸ªå‚æ•°åœ¨ç´¢å¼• lua_gettop(L) å¤„ã€‚ å½“éœ€è¦å‘ Lua è¿”å›å€¼çš„æ—¶å€™ï¼ŒC å‡½æ•°åªéœ€è¦æŠŠå®ƒä»¬ä»¥æ­£åºå‹åˆ°å †æ ˆä¸Šï¼ˆç¬¬ä¸€ä¸ªè¿”å›å€¼æœ€å…ˆå‹å…¥ï¼‰ï¼Œ ç„¶åè¿”å›è¿™äº›è¿”å›å€¼çš„ä¸ªæ•°ã€‚ åœ¨è¿™äº›è¿”å›å€¼ä¹‹ä¸‹çš„ï¼Œå †æ ˆä¸Šçš„ä¸œè¥¿éƒ½ä¼šè¢« Lua ä¸¢æ‰ã€‚ å’Œ Lua å‡½æ•°ä¸€æ ·ï¼Œä» Lua ä¸­è°ƒç”¨ C å‡½æ•°ä¹Ÿå¯ä»¥æœ‰å¾ˆå¤šè¿”å›å€¼ã€‚ ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­çš„å‡½æ•°å°†æ¥æ”¶è‹¥å¹²æ•°å­—å‚æ•°ï¼Œå¹¶è¿”å›å®ƒä»¬çš„å¹³å‡æ•°ä¸å’Œï¼š static int foo (lua_State *L) { int n = lua_gettop(L); /* å‚æ•°çš„ä¸ªæ•° */ lua_Number sum = 0; int i; for (i = 1; i &lt;= n; i++) { if (!lua_isnumber(L, i)) { lua_pushstring(L, &quot;incorrect argument&quot;); lua_error(L); } sum += lua_tonumber(L, i); } lua_pushnumber(L, sum/n); /* ç¬¬ä¸€ä¸ªè¿”å›å€¼ */ lua_pushnumber(L, sum); /* ç¬¬äºŒä¸ªè¿”å›å€¼ */ return 2; /* è¿”å›å€¼çš„ä¸ªæ•° */ } lua_checkstackint lua_checkstack (lua_State *L, int extra); ç¡®ä¿å †æ ˆä¸Šè‡³å°‘æœ‰ extra ä¸ªç©ºä½ã€‚ å¦‚æœä¸èƒ½æŠŠå †æ ˆæ‰©å±•åˆ°ç›¸åº”çš„å°ºå¯¸ï¼Œå‡½æ•°è¿”å› false ã€‚ è¿™ä¸ªå‡½æ•°æ°¸è¿œä¸ä¼šç¼©å°å †æ ˆï¼› å¦‚æœå †æ ˆå·²ç»æ¯”éœ€è¦çš„å¤§äº†ï¼Œé‚£ä¹ˆå°±æ”¾åœ¨é‚£é‡Œä¸ä¼šäº§ç”Ÿå˜åŒ–ã€‚ lua_closevoid lua_close (lua_State *L); é”€æ¯æŒ‡å®š Lua çŠ¶æ€æœºä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼ˆå¦‚æœæœ‰åƒåœ¾æ”¶é›†ç›¸å…³çš„å…ƒæ–¹æ³•çš„è¯ï¼Œä¼šè°ƒç”¨å®ƒä»¬ï¼‰ï¼Œå¹¶ä¸”é‡Šæ”¾çŠ¶æ€æœºä¸­ä½¿ç”¨çš„æ‰€æœ‰åŠ¨æ€å†…å­˜ã€‚ åœ¨ä¸€äº›å¹³å°ä¸Šï¼Œä½ å¯ä»¥ä¸å¿…è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œ å› ä¸ºå½“å®¿ä¸»ç¨‹åºç»“æŸçš„æ—¶å€™ï¼Œæ‰€æœ‰çš„èµ„æºå°±è‡ªç„¶è¢«é‡Šæ”¾æ‰äº†ã€‚ å¦ä¸€æ–¹é¢ï¼Œé•¿æœŸè¿è¡Œçš„ç¨‹åºï¼Œæ¯”å¦‚ä¸€ä¸ªåå°ç¨‹åºæˆ–æ˜¯ä¸€ä¸ª web æœåŠ¡å™¨ï¼Œ å½“ä¸å†éœ€è¦å®ƒä»¬çš„æ—¶å€™å°±åº”è¯¥é‡Šæ”¾æ‰ç›¸å…³çŠ¶æ€æœºã€‚è¿™æ ·å¯ä»¥é¿å…çŠ¶æ€æœºæ‰©å¼ çš„è¿‡å¤§ã€‚ lua_concatvoid lua_concat (lua_State *L, int n); è¿æ¥æ ˆé¡¶çš„ n ä¸ªå€¼ï¼Œ ç„¶åå°†è¿™äº›å€¼å‡ºæ ˆï¼Œå¹¶æŠŠç»“æœæ”¾åœ¨æ ˆé¡¶ã€‚å¦‚æœ n ä¸º 1 ï¼Œç»“æœå°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ”¾åœ¨æ ˆä¸Šï¼ˆå³ï¼Œå‡½æ•°ä»€ä¹ˆéƒ½ä¸åšï¼‰ï¼› å¦‚æœ n ä¸º 0 ï¼Œç»“æœæ˜¯ä¸€ä¸ªç©ºä¸²ã€‚ è¿æ¥ä¾ç…§ Lua ä¸­åˆ›å»ºè¯­ä¹‰å®Œæˆï¼ˆå‚è§ Â§2.5.4 ï¼‰ã€‚ lua_cpcallint lua_cpcall (lua_State *L, lua_CFunction func, void *ud); ä»¥ä¿æŠ¤æ¨¡å¼è°ƒç”¨ C å‡½æ•° func ã€‚ func åªæœ‰èƒ½ä»å †æ ˆä¸Šæ‹¿åˆ°ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯åŒ…å«æœ‰ ud çš„ light userdataã€‚ å½“æœ‰é”™è¯¯æ—¶ï¼Œ lua_cpcall è¿”å›å’Œ lua_pcall ç›¸åŒçš„é”™è¯¯ä»£ç ï¼Œ å¹¶åœ¨æ ˆé¡¶ç•™ä¸‹é”™è¯¯å¯¹è±¡ï¼› å¦åˆ™å®ƒè¿”å›é›¶ï¼Œå¹¶ä¸ä¼šä¿®æ”¹å †æ ˆã€‚ æ‰€æœ‰ä» func å†…è¿”å›çš„å€¼éƒ½ä¼šè¢«æ‰”æ‰ã€‚ lua_createtablevoid lua_createtable (lua_State *L, int narr, int nrec); åˆ›å»ºä¸€ä¸ªæ–°çš„ç©º table å‹å…¥å †æ ˆã€‚ è¿™ä¸ªæ–° table å°†è¢«é¢„åˆ†é… narr ä¸ªå…ƒç´ çš„æ•°ç»„ç©ºé—´ ä»¥åŠ nrec ä¸ªå…ƒç´ çš„éæ•°ç»„ç©ºé—´ã€‚ å½“ä½ æ˜ç¡®çŸ¥é“è¡¨ä¸­éœ€è¦å¤šå°‘ä¸ªå…ƒç´ æ—¶ï¼Œé¢„åˆ†é…å°±éå¸¸æœ‰ç”¨ã€‚ å¦‚æœä½ ä¸çŸ¥é“ï¼Œå¯ä»¥ä½¿ç”¨å‡½æ•° lua_newtableã€‚ lua_dumpint lua_dump (lua_State *L, lua_Writer writer, void *data); æŠŠå‡½æ•° dump æˆäºŒè¿›åˆ¶ chunk ã€‚ å‡½æ•°æ¥æ”¶æ ˆé¡¶çš„ Lua å‡½æ•°åšå‚æ•°ï¼Œç„¶åç”Ÿæˆå®ƒçš„äºŒè¿›åˆ¶ chunk ã€‚ è‹¥è¢« dump å‡ºæ¥çš„ä¸œè¥¿è¢«å†æ¬¡åŠ è½½ï¼ŒåŠ è½½çš„ç»“æœå°±ç›¸å½“äºåŸæ¥çš„å‡½æ•°ã€‚ å½“å®ƒåœ¨äº§ç”Ÿ chunk çš„æ—¶å€™ï¼Œlua_dump é€šè¿‡è°ƒç”¨å‡½æ•° writer ï¼ˆå‚è§ lua_Writerï¼‰ æ¥å†™å…¥æ•°æ®ï¼Œåé¢çš„ data å‚æ•°ä¼šè¢«ä¼ å…¥ writer ã€‚æœ€åä¸€æ¬¡ç”±å†™å…¥å™¨ (writer) è¿”å›å€¼å°†ä½œä¸ºè¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼è¿”å›ï¼› 0 è¡¨ç¤ºæ²¡æœ‰é”™è¯¯ã€‚ è¿™ä¸ªå‡½æ•°ä¸ä¼šæŠŠ Lua è¿”å›å¼¹å‡ºå †æ ˆã€‚ lua_equalint lua_equal (lua_State *L, int index1, int index2); å¦‚æœä¾ç…§ Lua ä¸­ == æ“ä½œç¬¦è¯­ä¹‰ï¼Œç´¢å¼• index1 å’Œ index2 ä¸­çš„å€¼ç›¸åŒçš„è¯ï¼Œè¿”å› 1 ã€‚ å¦åˆ™è¿”å› 0 ã€‚ å¦‚æœä»»ä½•ä¸€ä¸ªç´¢å¼•æ— æ•ˆä¹Ÿä¼šè¿”å› 0ã€‚ lua_errorint lua_error (lua_State *L); äº§ç”Ÿä¸€ä¸ª Lua é”™è¯¯ã€‚ é”™è¯¯ä¿¡æ¯ï¼ˆå®é™…ä¸Šå¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„ Lua å€¼ï¼‰å¿…é¡»è¢«ç½®å…¥æ ˆé¡¶ã€‚ è¿™ä¸ªå‡½æ•°ä¼šåšä¸€æ¬¡é•¿è·³è½¬ï¼Œå› æ­¤å®ƒä¸ä¼šå†è¿”å›ã€‚ ï¼ˆå‚è§ luaL_errorï¼‰ã€‚ lua_gcint lua_gc (lua_State *L, int what, int data); æ§åˆ¶åƒåœ¾æ”¶é›†å™¨ã€‚è¿™ä¸ªå‡½æ•°æ ¹æ®å…¶å‚æ•° what å‘èµ·å‡ ç§ä¸åŒçš„ä»»åŠ¡ï¼š LUA_GCSTOP: åœæ­¢åƒåœ¾æ”¶é›†å™¨ã€‚LUA_GCRESTART: é‡å¯åƒåœ¾æ”¶é›†å™¨ã€‚LUA_GCCOLLECT: å‘èµ·ä¸€æ¬¡å®Œæ•´çš„åƒåœ¾æ”¶é›†å¾ªç¯ã€‚LUA_GCCOUNT: è¿”å› Lua ä½¿ç”¨çš„å†…å­˜æ€»é‡ï¼ˆä»¥ K å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚LUA_GCCOUNTB: è¿”å›å½“å‰å†…å­˜ä½¿ç”¨é‡é™¤ä»¥ 1024 çš„ä½™æ•°ã€‚LUA_GCSTEP: å‘èµ·ä¸€æ­¥å¢é‡åƒåœ¾æ”¶é›†ã€‚ æ­¥æ•°ç”± data æ§åˆ¶ï¼ˆè¶Šå¤§çš„å€¼æ„å‘³ç€è¶Šå¤šæ­¥ï¼‰ï¼Œ è€Œå…¶å…·ä½“å«ä¹‰ï¼ˆå…·ä½“æ•°å­—è¡¨ç¤ºäº†å¤šå°‘ï¼‰å¹¶æœªæ ‡å‡†åŒ–ã€‚ å¦‚æœä½ æƒ³æ§åˆ¶è¿™ä¸ªæ­¥æ•°ï¼Œå¿…é¡»å®éªŒæ€§çš„æµ‹è¯• data çš„å€¼ã€‚ å¦‚æœè¿™ä¸€æ­¥ç»“æŸäº†ä¸€ä¸ªåƒåœ¾æ”¶é›†å‘¨æœŸï¼Œè¿”å›è¿”å› 1 ã€‚LUA_GCSETPAUSE: æŠŠ data/100 è®¾ç½®ä¸º garbage-collector pause çš„æ–°å€¼ï¼ˆå‚è§ Â§2.10ï¼‰ã€‚ å‡½æ•°è¿”å›ä»¥å‰çš„å€¼ã€‚LUA_GCSETSTEPMUL: æŠŠ arg/100 è®¾ç½®æˆ step multiplier ï¼ˆå‚è§ Â§2.10ï¼‰ã€‚ å‡½æ•°è¿”å›ä»¥å‰çš„å€¼ã€‚ lua_getallocflua_Alloc lua_getallocf (lua_State *L, void **ud); è¿”å›ç»™å®šçŠ¶æ€æœºçš„å†…å­˜åˆ†é…å™¨å‡½æ•°ã€‚ å¦‚æœ ud ä¸æ˜¯ NULL ï¼ŒLua æŠŠè°ƒç”¨ lua_newstate æ—¶ä¼ å…¥çš„é‚£ä¸ªæŒ‡é’ˆæ”¾å…¥ *ud ã€‚ lua_getfenvvoid lua_getfenv (lua_State *L, int index); æŠŠç´¢å¼•å¤„å€¼çš„ç¯å¢ƒè¡¨å‹å…¥å †æ ˆã€‚ lua_getfieldvoid lua_getfield (lua_State *L, int index, const char *k); æŠŠ t[k] å€¼å‹å…¥å †æ ˆï¼Œ è¿™é‡Œçš„ t æ˜¯æŒ‡æœ‰æ•ˆç´¢å¼• index æŒ‡å‘çš„å€¼ã€‚ åœ¨ Lua ä¸­ï¼Œè¿™ä¸ªå‡½æ•°å¯èƒ½è§¦å‘å¯¹åº” â€œindexâ€ äº‹ä»¶çš„å…ƒæ–¹æ³• ï¼ˆå‚è§ Â§2.8ï¼‰ã€‚ lua_getglobalvoid lua_getglobal(lua_State *L, const char *name); æŠŠå…¨å±€å˜é‡nameé‡Œçš„å€¼å‹å…¥å †æ ˆã€‚ è¿™ä¸ªæ˜¯ç”¨ä¸€ä¸ªå®å®šä¹‰å‡ºæ¥çš„ï¼š #define lua_getglobal(L,s) lua_getfield(L, LUA_GLOBALSINDEX, s) lua_getmetatableint lua_getmetatable (lua_State *L, int index); æŠŠç»™å®šç´¢å¼•æŒ‡å‘çš„å€¼çš„å…ƒè¡¨å‹å…¥å †æ ˆã€‚ å¦‚æœç´¢å¼•æ— æ•ˆï¼Œæˆ–æ˜¯è¿™ä¸ªå€¼æ²¡æœ‰å…ƒè¡¨ï¼Œ å‡½æ•°å°†è¿”å› 0 å¹¶ä¸”ä¸ä¼šå‘æ ˆä¸Šå‹ä»»ä½•ä¸œè¥¿ã€‚ lua_gettablevoid lua_gettable (lua_State *L, int index); æŠŠt[k] å€¼å‹å…¥å †æ ˆï¼Œ è¿™é‡Œçš„tæ˜¯æŒ‡æœ‰æ•ˆç´¢å¼• index æŒ‡å‘çš„å€¼ï¼Œ è€Œ k åˆ™æ˜¯æ ˆé¡¶æ”¾çš„å€¼ã€‚è¿™ä¸ªå‡½æ•°ä¼šå¼¹å‡ºå †æ ˆä¸Šçš„ key ï¼ˆæŠŠç»“æœæ”¾åœ¨æ ˆä¸Šç›¸åŒä½ç½®ï¼‰ã€‚ åœ¨ Lua ä¸­ï¼Œè¿™ä¸ªå‡½æ•°å¯èƒ½è§¦å‘å¯¹åº” â€œindexâ€ äº‹ä»¶çš„å…ƒæ–¹æ³•ã€‚ lua_gettopint lua_gettop(lua_State *L); è¿”å›æ ˆé¡¶å…ƒç´ çš„ç´¢å¼•ã€‚ å› ä¸ºç´¢å¼•æ˜¯ä» 1 å¼€å§‹ç¼–å·çš„ï¼Œ æ‰€ä»¥è¿™ä¸ªç»“æœç­‰äºå †æ ˆä¸Šçš„å…ƒç´ ä¸ªæ•°ï¼ˆå› æ­¤è¿”å› 0 è¡¨ç¤ºå †æ ˆä¸ºç©ºï¼‰ã€‚ lua_insertvoid lua_insert (lua_State *L, int index); æŠŠæ ˆé¡¶å…ƒç´ æ’å…¥æŒ‡å®šçš„æœ‰æ•ˆç´¢å¼•å¤„ï¼Œ å¹¶ä¾æ¬¡ç§»åŠ¨è¿™ä¸ªç´¢å¼•ä¹‹ä¸Šçš„å…ƒç´ ã€‚ ä¸è¦ç”¨ä¼ªç´¢å¼•æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œ å› ä¸ºä¼ªç´¢å¼•ä¸æ˜¯çœŸæ­£æŒ‡å‘å †æ ˆä¸Šçš„ä½ç½®ã€‚ lua_Integertypedef ptrdiff_t lua_Integer; è¿™ä¸ªç±»å‹è¢«ç”¨äº Lua API æ¥æ”¶æ•´æ•°å€¼ã€‚ç¼ºçœæ—¶è¿™ä¸ªè¢«å®šä¹‰ä¸º ptrdiff_t ï¼Œ è¿™ä¸ªä¸œè¥¿é€šå¸¸æ˜¯æœºå™¨èƒ½å¤„ç†çš„æœ€å¤§æ•´æ•°ç±»å‹ã€‚ lua_isbooleanint lua_isboolean (lua_State *L, int index); å½“ç»™å®šç´¢å¼•çš„å€¼ç±»å‹ä¸º boolean æ—¶ï¼Œè¿”å› 1 ï¼Œå¦åˆ™è¿”å› 0 ã€‚ lua_iscfunctionint lua_iscfunction (lua_State *L, int index); å½“ç»™å®šç´¢å¼•çš„å€¼æ˜¯ä¸€ä¸ª C å‡½æ•°æ—¶ï¼Œè¿”å› 1 ï¼Œå¦åˆ™è¿”å› 0 ã€‚ lua_isfunctionint lua_isfunction (lua_State *L, int index); å½“ç»™å®šç´¢å¼•çš„å€¼æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ˆ C æˆ– Lua å‡½æ•°å‡å¯ï¼‰æ—¶ï¼Œè¿”å› 1 ï¼Œå¦åˆ™è¿”å› 0 ã€‚ lua_islightuserdataint lua_islightuserdata (lua_State *L, int index); å½“ç»™å®šç´¢å¼•çš„å€¼æ˜¯ä¸€ä¸ª light userdata æ—¶ï¼Œè¿”å› 1 ï¼Œå¦åˆ™è¿”å› 0 ã€‚ lua_isnilint lua_isnil (lua_State *L, int index); å½“ç»™å®šç´¢å¼•çš„å€¼æ˜¯ nil æ—¶ï¼Œè¿”å› 1 ï¼Œå¦åˆ™è¿”å› 0 ã€‚ lua_isnumberint lua_isnumber (lua_State *L, int index); å½“ç»™å®šç´¢å¼•çš„å€¼æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œæˆ–æ˜¯ä¸€ä¸ªå¯è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²æ—¶ï¼Œè¿”å› 1 ï¼Œå¦åˆ™è¿”å› 0 ã€‚ lua_isstringint lua_isstring (lua_State *L, int index); å½“ç»™å®šç´¢å¼•çš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–æ˜¯ä¸€ä¸ªæ•°å­—ï¼ˆæ•°å­—æ€»èƒ½è½¬æ¢æˆå­—ç¬¦ä¸²ï¼‰æ—¶ï¼Œè¿”å› 1 ï¼Œå¦åˆ™è¿”å› 0 ã€‚ lua_istableint lua_istable (lua_State *L, int index); å½“ç»™å®šç´¢å¼•çš„å€¼æ˜¯ä¸€ä¸ª table æ—¶ï¼Œè¿”å› 1 ï¼Œå¦åˆ™è¿”å› 0 ã€‚ lua_isthreadint lua_isthread (lua_State *L, int index); å½“ç»™å®šç´¢å¼•çš„å€¼æ˜¯ä¸€ä¸ª thread æ—¶ï¼Œè¿”å› 1 ï¼Œå¦åˆ™è¿”å› 0 ã€‚ lua_isuserdataint lua_isuserdata (lua_State *L, int index); å½“ç»™å®šç´¢å¼•çš„å€¼æ˜¯ä¸€ä¸ª userdata ï¼ˆæ— è®ºæ˜¯å®Œæ•´çš„ userdata è¿˜æ˜¯ light userdata ï¼‰æ—¶ï¼Œè¿”å› 1 ï¼Œå¦åˆ™è¿”å› 0 ã€‚ lua_lessthanint lua_lessthan (lua_State *L, int index1, int index2); å¦‚æœç´¢å¼• index1 å¤„çš„å€¼å°äº ç´¢å¼• index2 å¤„çš„å€¼æ—¶ï¼Œè¿”å› 1 ï¼› å¦åˆ™è¿”å› 0 ã€‚ å…¶è¯­ä¹‰éµå¾ª Lua ä¸­çš„ &lt; æ“ä½œç¬¦ï¼ˆå°±æ˜¯è¯´ï¼Œæœ‰å¯èƒ½è°ƒç”¨å…ƒæ–¹æ³•ï¼‰ã€‚ å¦‚æœä»»ä½•ä¸€ä¸ªç´¢å¼•æ— æ•ˆï¼Œä¹Ÿä¼šè¿”å› 0 ã€‚ lua_loadint lua_load (lua_State *L, lua_Reader reader, void *data, const char *chunkname); åŠ è½½ä¸€ä¸ª Lua chunk ã€‚ å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œ lua_load æŠŠä¸€ä¸ªç¼–è¯‘å¥½çš„ chunk ä½œä¸ºä¸€ä¸ª Lua å‡½æ•°å‹å…¥å †æ ˆã€‚ å¦åˆ™ï¼Œå‹å…¥å‡ºé”™ä¿¡æ¯ã€‚ lua_load çš„è¿”å›å€¼å¯ä»¥æ˜¯ï¼š 0: æ²¡æœ‰é”™è¯¯ï¼›LUA_ERRSYNTAX: åœ¨é¢„ç¼–è¯‘æ—¶ç¢°åˆ°è¯­æ³•é”™è¯¯ï¼›LUA_ERRMEM: å†…å­˜åˆ†é…é”™è¯¯ã€‚è¿™ä¸ªå‡½æ•°ä»…ä»…åŠ æ ½ chunk ï¼›è€Œä¸ä¼šå»è¿è¡Œå®ƒã€‚ lua_load ä¼šè‡ªåŠ¨æ£€æµ‹ chunk æ˜¯æ–‡æœ¬çš„è¿˜æ˜¯äºŒè¿›åˆ¶çš„ï¼Œ ç„¶ååšå¯¹åº”çš„åŠ è½½æ“ä½œï¼ˆå‚è§ç¨‹åº luacï¼‰ã€‚lua_load å‡½æ•°ä½¿ç”¨ä¸€ä¸ªç”¨æˆ·æä¾›çš„ reader å‡½æ•°æ¥ è¯»å– chunk ï¼ˆå‚è§ lua_Readerï¼‰ã€‚ data å‚æ•°ä¼šè¢«ä¼ å…¥è¯»å–å™¨å‡½æ•°ã€‚chunkname è¿™ä¸ªå‚æ•°å¯ä»¥èµ‹äºˆ chunk ä¸€ä¸ªåå­—ï¼Œ è¿™ä¸ªåå­—è¢«ç”¨äºå‡ºé”™ä¿¡æ¯å’Œè°ƒè¯•ä¿¡æ¯ã€‚ lua_newstatelua_State *lua_newstate (lua_Alloc f, void *ud); åˆ›å»ºçš„ä¸€ä¸ªæ–°çš„ç‹¬ç«‹çš„çŠ¶æ€æœºã€‚ å¦‚æœåˆ›å»ºä¸äº†ï¼ˆå› ä¸ºå†…å­˜é—®é¢˜ï¼‰è¿”å› NULL ã€‚ å‚æ•° f æ˜¯ä¸€ä¸ªåˆ†é…å™¨å‡½æ•°ï¼› Lua å°†é€šè¿‡è¿™ä¸ªå‡½æ•°åšçŠ¶æ€æœºå†…æ‰€æœ‰çš„å†…å­˜åˆ†é…æ“ä½œã€‚ ç¬¬äºŒä¸ªå‚æ•° ud ï¼Œè¿™ä¸ªæŒ‡é’ˆå°†åœ¨æ¯æ¬¡è°ƒç”¨åˆ†é…å™¨æ—¶è¢«ç›´æ¥ä¼ å…¥ã€‚ lua_newtablevoid lua_newtable (lua_State *L); åˆ›å»ºä¸€ä¸ªç©ºtableï¼Œå¹¶å°†ä¹‹å‹å…¥å †æ ˆã€‚å®ƒç­‰ä»·äºlua_createtable(L, 0, 0)ã€‚ lua_pushglobaltable[-0, +1, â€“] void lua_pushglobaltable (lua_State *L); Pushes the global environment onto the stack. lua_newthreadlua_State *lua_newthread (lua_State *L); åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œå¹¶å°†å…¶å‹å…¥å †æ ˆï¼Œ å¹¶è¿”å›ç»´æŠ¤è¿™ä¸ªçº¿ç¨‹çš„ lua_State æŒ‡é’ˆã€‚ è¿™ä¸ªå‡½æ•°è¿”å›çš„æ–°çŠ¶æ€æœºå…±äº«åŸæœ‰çŠ¶æ€æœºä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼ˆæ¯”å¦‚ä¸€äº› tableï¼‰ï¼Œ ä½†æ˜¯å®ƒæœ‰ç‹¬ç«‹çš„æ‰§è¡Œå †æ ˆã€‚æ²¡æœ‰æ˜¾å¼çš„å‡½æ•°å¯ä»¥ç”¨æ¥å…³é—­æˆ–é”€æ¯æ‰ä¸€ä¸ªçº¿ç¨‹ã€‚ çº¿ç¨‹è·Ÿå…¶å®ƒ Lua å¯¹è±¡ä¸€æ ·æ˜¯åƒåœ¾æ”¶é›†çš„æ¡ç›®ä¹‹ä¸€ã€‚ lua_newuserdatavoid *lua_newuserdata (lua_State *L, size_t size); è¿™ä¸ªå‡½æ•°åˆ†é…åˆ†é…ä¸€å—æŒ‡å®šå¤§å°çš„å†…å­˜å—ï¼Œ æŠŠå†…å­˜å—åœ°å€ä½œä¸ºä¸€ä¸ªå®Œæ•´çš„ userdata å‹å…¥å †æ ˆï¼Œå¹¶è¿”å›è¿™ä¸ªåœ°å€ã€‚userdata ä»£è¡¨ Lua ä¸­çš„ C å€¼ã€‚ å®Œæ•´çš„ userdata ä»£è¡¨ä¸€å—å†…å­˜ã€‚ å®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆå°±åƒ table é‚£æ ·çš„å¯¹è±¡ï¼‰ï¼š ä½ å¿…é¡»åˆ›å»ºå®ƒï¼Œå®ƒæœ‰ç€è‡ªå·±çš„å…ƒè¡¨ï¼Œè€Œä¸”å®ƒåœ¨è¢«å›æ”¶æ—¶ï¼Œå¯ä»¥è¢«ç›‘æµ‹åˆ°ã€‚ ä¸€ä¸ªå®Œæ•´çš„ userdata åªå’Œå®ƒè‡ªå·±ç›¸ç­‰ï¼ˆåœ¨ç­‰äºçš„åŸç”Ÿä½œç”¨ä¸‹ï¼‰ã€‚å½“ Lua é€šè¿‡ gc å…ƒæ–¹æ³•å›æ”¶ä¸€ä¸ªå®Œæ•´çš„ userdata æ—¶ï¼Œ Lua è°ƒç”¨è¿™ä¸ªå…ƒæ–¹æ³•å¹¶æŠŠ userdata æ ‡è®°ä¸ºå·²ç»ˆæ­¢ã€‚ ç­‰åˆ°è¿™ä¸ª userdata å†æ¬¡è¢«æ”¶é›†çš„æ—¶å€™ï¼ŒLua ä¼šé‡Šæ”¾æ‰ç›¸å…³çš„å†…å­˜ã€‚ lua_nextint lua_next (lua_State *L, int index); ä»æ ˆä¸Šå¼¹å‡ºä¸€ä¸ª keyï¼ˆé”®ï¼‰ï¼Œ ç„¶åæŠŠç´¢å¼•æŒ‡å®šçš„è¡¨ä¸­ key-valueï¼ˆå¥å€¼ï¼‰å¯¹å‹å…¥å †æ ˆ ï¼ˆæŒ‡å®š key åé¢çš„ä¸‹ä¸€ (next) å¯¹ï¼‰ã€‚ å¦‚æœè¡¨ä¸­ä»¥æ— æ›´å¤šå…ƒç´ ï¼Œ é‚£ä¹ˆ lua_next å°†è¿”å› 0 ï¼ˆä»€ä¹ˆä¹Ÿä¸å‹å…¥å †æ ˆï¼‰ã€‚å…¸å‹çš„éå†æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼š /* table æ”¾åœ¨ç´¢å¼• &#39;t&#39; å¤„ */ lua_pushnil(L); /* ç¬¬ä¸€ä¸ª key */ while (lua_next(L, t) != 0) { /* ç”¨ä¸€ä¸‹ &#39;key&#39; ï¼ˆåœ¨ç´¢å¼• -2 å¤„ï¼‰ å’Œ &#39;value&#39; ï¼ˆåœ¨ç´¢å¼• -1 å¤„ï¼‰ */ printf(&quot;%s - %s\n&quot;, lua_typename(L, lua_type(L, -2)), lua_typename(L, lua_type(L, -1))); /* ç§»é™¤ &#39;value&#39; ï¼›ä¿ç•™ &#39;key&#39; åšä¸‹ä¸€æ¬¡è¿­ä»£ */ lua_pop(L, 1); } åœ¨éå†ä¸€å¼ è¡¨çš„æ—¶å€™ï¼Œ ä¸è¦ç›´æ¥å¯¹ key è°ƒç”¨ lua_tolstring ï¼Œ é™¤éä½ çŸ¥é“è¿™ä¸ª key ä¸€å®šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ è°ƒç”¨ lua_tolstring æœ‰å¯èƒ½æ”¹å˜ç»™å®šç´¢å¼•ä½ç½®çš„å€¼ï¼› è¿™ä¼šå¯¹ä¸‹ä¸€æ¬¡è°ƒç”¨ lua_next é€ æˆå½±å“ã€‚ lua_Numbertypedef double lua_Number; Lua ä¸­æ•°å­—çš„ç±»å‹ã€‚ ç¡®çœæ˜¯ double ï¼Œä½†æ˜¯ä½ å¯ä»¥åœ¨ luaconf.h ä¸­ä¿®æ”¹å®ƒã€‚é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶ä½ å¯ä»¥æ”¹å˜ Lua è®©å®ƒæ“ä½œå…¶å®ƒæ•°å­—ç±»å‹ï¼ˆä¾‹å¦‚ï¼šfloat æˆ–æ˜¯ long ï¼‰ã€‚ lua_objlen &amp; luaS_rawlensize_t lua_objlen (lua_State *L, int index); -- 5.1 size_t lua_rawlen (lua_State *L, int index); -- 5.3 è¿”å›æŒ‡å®šçš„ç´¢å¼•å¤„çš„å€¼çš„é•¿åº¦ã€‚ å¯¹äº string ï¼Œé‚£å°±æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ï¼› å¯¹äº table ï¼Œæ˜¯å–é•¿åº¦æ“ä½œç¬¦ (â€˜#â€™) çš„ç»“æœï¼› å¯¹äº userdata ï¼Œå°±æ˜¯ä¸ºå…¶åˆ†é…çš„å†…å­˜å—çš„å°ºå¯¸ï¼› å¯¹äºå…¶å®ƒå€¼ï¼Œä¸º 0 ã€‚ lua_pcalllua_pcall (lua_State *L, int nargs, int nresults, int errfunc); ä»¥ä¿æŠ¤æ¨¡å¼è°ƒç”¨ä¸€ä¸ªå‡½æ•°ã€‚nargs å’Œ nresults çš„å«ä¹‰ä¸ lua_call ä¸­çš„ç›¸åŒã€‚ å¦‚æœåœ¨è°ƒç”¨è¿‡ç¨‹ä¸­æ²¡æœ‰å‘ç”Ÿé”™è¯¯ï¼Œ lua_pcall çš„è¡Œä¸ºå’Œ lua_call å®Œå…¨ä¸€è‡´ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæœ‰é”™è¯¯å‘ç”Ÿçš„è¯ï¼Œ lua_pcall ä¼šæ•è·å®ƒï¼Œ ç„¶åæŠŠå•ä¸€çš„å€¼ï¼ˆé”™è¯¯ä¿¡æ¯ï¼‰å‹å…¥å †æ ˆï¼Œç„¶åè¿”å›é”™è¯¯ç ã€‚ åŒ lua_call ä¸€æ ·ï¼Œ lua_pcall æ€»æ˜¯æŠŠå‡½æ•°æœ¬èº«å’Œå®ƒçš„å‚æ•°ä»æ ˆä¸Šç§»é™¤ã€‚å¦‚æœ errfunc æ˜¯ 0 ï¼Œ è¿”å›åœ¨æ ˆé¡¶çš„é”™è¯¯ä¿¡æ¯å°±å’ŒåŸå§‹é”™è¯¯ä¿¡æ¯å®Œå…¨ä¸€è‡´ã€‚ å¦åˆ™ï¼Œerrfunc å°±è¢«å½“æˆæ˜¯é”™è¯¯å¤„ç†å‡½æ•°åœ¨æ ˆä¸Šçš„ç´¢å¼•ã€‚ ï¼ˆåœ¨å½“å‰çš„å®ç°é‡Œï¼Œè¿™ä¸ªç´¢å¼•ä¸èƒ½æ˜¯ä¼ªç´¢å¼•ã€‚ï¼‰ åœ¨å‘ç”Ÿè¿è¡Œæ—¶é”™è¯¯æ—¶ï¼Œ è¿™ä¸ªå‡½æ•°ä¼šè¢«è°ƒç”¨è€Œå‚æ•°å°±æ˜¯é”™è¯¯ä¿¡æ¯ã€‚ é”™è¯¯å¤„ç†å‡½æ•°çš„è¿”å›å€¼å°†è¢« lua_pcall ä½œä¸ºå‡ºé”™ä¿¡æ¯è¿”å›åœ¨å †æ ˆä¸Šã€‚å…¸å‹çš„ç”¨æ³•ä¸­ï¼Œé”™è¯¯å¤„ç†å‡½æ•°è¢«ç”¨æ¥åœ¨å‡ºé”™ä¿¡æ¯ä¸ŠåŠ ä¸Šæ›´å¤šçš„è°ƒè¯•ä¿¡æ¯ï¼Œæ¯”å¦‚æ ˆè·Ÿè¸ªä¿¡æ¯ (stack traceback) ã€‚ è¿™äº›ä¿¡æ¯åœ¨ lua_pcall è¿”å›åï¼Œå› ä¸ºæ ˆå·²ç»å±•å¼€ (unwound) ï¼Œ æ‰€ä»¥æ”¶é›†ä¸åˆ°äº†ã€‚lua_pcall å‡½æ•°åœ¨è°ƒç”¨æˆåŠŸæ—¶è¿”å› 0 ï¼Œ å¦åˆ™è¿”å›ä»¥ä¸‹ï¼ˆå®šä¹‰åœ¨ lua.h ä¸­çš„ï¼‰é”™è¯¯ä»£ç ä¸­çš„ä¸€ä¸ªï¼š LUA_ERRRUN: è¿è¡Œæ—¶é”™è¯¯ã€‚LUA_ERRMEM: å†…å­˜åˆ†é…é”™è¯¯ã€‚ å¯¹äºè¿™ç§é”™ï¼ŒLua è°ƒç”¨ä¸äº†é”™è¯¯å¤„ç†å‡½æ•°ã€‚LUA_ERRERR: åœ¨è¿è¡Œé”™è¯¯å¤„ç†å‡½æ•°æ—¶å‘ç”Ÿçš„é”™è¯¯ã€‚ lua_popvoid lua_pop (lua_State *L, int n); ä»å †æ ˆä¸­å¼¹å‡º n ä¸ªå…ƒç´ ã€‚ lua_pushbooleanvoid lua_pushboolean (lua_State *L, int b); æŠŠ b ä½œä¸ºä¸€ä¸ª boolean å€¼å‹å…¥å †æ ˆã€‚ lua_pushcclosurevoid lua_pushcclosure (lua_State *L, lua_CFunction fn, int n); æŠŠä¸€ä¸ªæ–°çš„ C closure å‹å…¥å †æ ˆã€‚å½“åˆ›å»ºäº†ä¸€ä¸ª C å‡½æ•°åï¼Œä½ å¯ä»¥ç»™å®ƒå…³è”ä¸€äº›å€¼ï¼Œè¿™æ ·å°±æ˜¯åœ¨åˆ›å»ºä¸€ä¸ª C closure ï¼› æ¥ä¸‹æ¥æ— è®ºå‡½æ•°ä½•æ—¶è¢«è°ƒç”¨ï¼Œè¿™äº›å€¼éƒ½å¯ä»¥è¢«è¿™ä¸ªå‡½æ•°è®¿é—®åˆ°ã€‚ ä¸ºäº†å°†ä¸€äº›å€¼å…³è”åˆ°ä¸€ä¸ª C å‡½æ•°ä¸Šï¼Œ é¦–å…ˆè¿™äº›å€¼éœ€è¦å…ˆè¢«å‹å…¥å †æ ˆï¼ˆå¦‚æœæœ‰å¤šä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªå…ˆå‹ï¼‰ã€‚ æ¥ä¸‹æ¥è°ƒç”¨ lua_pushcclosure æ¥åˆ›å»ºå‡º closure å¹¶æŠŠè¿™ä¸ª C å‡½æ•°å‹åˆ°å †æ ˆä¸Šã€‚ å‚æ•° n å‘Šä¹‹å‡½æ•°æœ‰å¤šå°‘ä¸ªå€¼éœ€è¦å…³è”åˆ°å‡½æ•°ä¸Šã€‚ lua_pushcclosure ä¹Ÿä¼šæŠŠè¿™äº›å€¼ä»æ ˆä¸Šå¼¹å‡ºã€‚ lua_pushcfunctionvoid lua_pushcfunction (lua_State *L, lua_CFunction f); å°†ä¸€ä¸ª C å‡½æ•°å‹å…¥å †æ ˆã€‚ è¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸€ä¸ª C å‡½æ•°æŒ‡é’ˆï¼Œå¹¶å°†ä¸€ä¸ªç±»å‹ä¸º function çš„ Lua å€¼ å‹å…¥å †æ ˆã€‚å½“è¿™ä¸ªæ ˆé¡¶çš„å€¼è¢«è°ƒç”¨æ—¶ï¼Œå°†è§¦å‘å¯¹åº”çš„ C å‡½æ•°ã€‚æ³¨å†Œåˆ° Lua ä¸­çš„ä»»ä½•å‡½æ•°éƒ½å¿…é¡»éµå¾ªæ­£ç¡®çš„åè®®æ¥æ¥æ”¶å‚æ•°å’Œè¿”å›å€¼ ï¼ˆå‚è§ lua_CFunctionï¼‰ã€‚ lua_pushcfunction æ˜¯ä½œä¸ºä¸€ä¸ªå®å®šä¹‰å‡ºç°çš„ï¼š #define lua_pushcfunction(L,f) lua_pushcclosure(L,f,0) lua_pushfstringconst char *lua_pushfstring (lua_State *L, const char *fmt, ...); æŠŠä¸€ä¸ªæ ¼å¼åŒ–è¿‡çš„å­—ç¬¦ä¸²å‹å…¥å †æ ˆï¼Œç„¶åè¿”å›è¿™ä¸ªå­—ç¬¦ä¸²çš„æŒ‡é’ˆã€‚ å®ƒå’Œ C å‡½æ•° sprintf æ¯”è¾ƒåƒï¼Œä¸è¿‡æœ‰ä¸€äº›é‡è¦çš„åŒºåˆ«ï¼šæ‘¸ä½ éœ€è¦ä¸ºç»“æœåˆ†é…ç©ºé—´ï¼š å…¶ç»“æœæ˜¯ä¸€ä¸ª Lua å­—ç¬¦ä¸²ï¼Œç”± Lua æ¥å…³å¿ƒå…¶å†…å­˜åˆ†é… ï¼ˆåŒæ—¶é€šè¿‡åƒåœ¾æ”¶é›†æ¥é‡Šæ”¾å†…å­˜ï¼‰ã€‚è¿™ä¸ªè½¬æ¢éå¸¸çš„å—é™ã€‚ ä¸æ”¯æŒ flag ï¼Œå®½åº¦ï¼Œæˆ–æ˜¯æŒ‡å®šç²¾åº¦ã€‚ å®ƒåªæ”¯æŒä¸‹é¢è¿™äº›ï¼š â€˜%%â€™ ï¼ˆæ’å…¥ä¸€ä¸ª â€˜%â€™ï¼‰ï¼Œ â€˜%sâ€™ ï¼ˆæ’å…¥ä¸€ä¸ªå¸¦é›¶ç»ˆæ­¢ç¬¦çš„å­—ç¬¦ä¸²ï¼Œæ²¡æœ‰é•¿åº¦é™åˆ¶ï¼‰ï¼Œ â€˜%fâ€™ ï¼ˆæ’å…¥ä¸€ä¸ª lua_Numberï¼‰ï¼Œ â€˜%pâ€™ ï¼ˆæ’å…¥ä¸€ä¸ªæŒ‡é’ˆæˆ–æ˜¯ä¸€ä¸ªåå…­è¿›åˆ¶æ•°ï¼‰ï¼Œ â€˜%dâ€™ ï¼ˆæ’å…¥ä¸€ä¸ª int)ï¼Œ â€˜%câ€™ ï¼ˆæŠŠä¸€ä¸ª int ä½œä¸ºä¸€ä¸ªå­—ç¬¦æ’å…¥ï¼‰ã€‚ lua_pushintegervoid lua_pushinteger (lua_State *L, lua_Integer n); æŠŠ n ä½œä¸ºä¸€ä¸ªæ•°å­—å‹æ ˆã€‚ lua_pushlightuserdatavoid lua_pushlightuserdata (lua_State *L, void *p); æŠŠä¸€ä¸ª light userdata å‹æ ˆã€‚userdata åœ¨ Lua ä¸­è¡¨ç¤ºä¸€ä¸ª C å€¼ã€‚ light userdata è¡¨ç¤ºä¸€ä¸ªæŒ‡é’ˆã€‚ å®ƒæ˜¯ä¸€ä¸ªåƒæ•°å­—ä¸€æ ·çš„å€¼ï¼š ä½ ä¸éœ€è¦ä¸“é—¨åˆ›å»ºå®ƒï¼Œå®ƒä¹Ÿæ²¡æœ‰ç‹¬ç«‹çš„ metatable ï¼Œ è€Œä¸”ä¹Ÿä¸ä¼šè¢«æ”¶é›†ï¼ˆå› ä¸ºä»æ¥ä¸éœ€è¦åˆ›å»ºï¼‰ã€‚ åªè¦è¡¨ç¤ºçš„ C åœ°å€ç›¸åŒï¼Œä¸¤ä¸ª light userdata å°±ç›¸ç­‰ã€‚ lua_pushlstringvoid lua_pushlstring (lua_State *L, const char *s, size_t len); æŠŠæŒ‡é’ˆ s æŒ‡å‘çš„é•¿åº¦ä¸º len çš„å­—ç¬¦ä¸²å‹æ ˆã€‚ Lua å¯¹è¿™ä¸ªå­—ç¬¦ä¸²åšä¸€æ¬¡å†…å­˜æ‹·è´ï¼ˆæˆ–æ˜¯å¤ç”¨ä¸€ä¸ªæ‹·è´ï¼‰ï¼Œ å› æ­¤ s å¤„çš„å†…å­˜åœ¨å‡½æ•°è¿”å›åï¼Œå¯ä»¥é‡Šæ”¾æ‰æˆ–æ˜¯é‡ç”¨äºå…¶å®ƒç”¨é€”ã€‚ å­—ç¬¦ä¸²å†…å¯ä»¥ä¿å­˜æœ‰é›¶å­—ç¬¦ã€‚ lua_pushnilvoid lua_pushnil (lua_State *L); æŠŠä¸€ä¸ª nil å‹æ ˆã€‚ lua_pushnumbervoid lua_pushnumber (lua_State *L, lua_Number n); æŠŠä¸€ä¸ªæ•°å­— n å‹æ ˆã€‚ lua_pushstringvoid lua_pushstring (lua_State *L, const char *s); æŠŠæŒ‡é’ˆsæŒ‡å‘çš„ä»¥é›¶ç»“å°¾çš„å­—ç¬¦ä¸²å‹æ ˆã€‚ Lua è¿™ä¸ªå­—ç¬¦ä¸²åšä¸€æ¬¡å†…å­˜æ‹·è´ï¼ˆæˆ–æ˜¯å¤ç”¨ä¸€ä¸ªæ‹·è´ï¼‰ï¼Œ å› æ­¤ s å¤„çš„å†…å­˜åœ¨å‡½æ•°è¿”å›åï¼Œå¯ä»¥é‡Šæ”¾æ‰æˆ–æ˜¯é‡ç”¨äºå…¶å®ƒç”¨é€”ã€‚ å­—ç¬¦ä¸²ä¸­ä¸èƒ½åŒ…å«æœ‰é›¶å­—ç¬¦ï¼›ç¬¬ä¸€ä¸ªç¢°åˆ°çš„é›¶å­—ç¬¦ä¼šè®¤ä¸ºæ˜¯å­—ç¬¦ä¸²çš„ç»“æŸã€‚ lua_pushthreadint lua_pushthread (lua_State *L); æŠŠ L ä¸­æä¾›çš„çº¿ç¨‹å‹æ ˆã€‚ å¦‚æœè¿™ä¸ªçº¿ç¨‹æ˜¯å½“å‰çŠ¶æ€æœºçš„ä¸»çº¿ç¨‹çš„è¯ï¼Œè¿”å› 1 ã€‚ lua_pushvaluevoid lua_pushvalue(lua_State *L, int index); æŠŠå †æ ˆä¸Šç»™å®šæœ‰æ•ˆå¤„ç´¢å¼•å¤„çš„å…ƒç´ ä½œä¸€ä¸ªæ‹·è´å‹æ ˆã€‚ lua_pushvfstringconst char *lua_pushvfstring (lua_State *L, const char *fmt, va_list argp); ç­‰ä»·äº lua_pushfstringï¼Œ ä¸è¿‡æ˜¯ç”¨ va_list æ¥æ”¶å‚æ•°ï¼Œè€Œä¸æ˜¯ç”¨å¯å˜æ•°é‡çš„å®é™…å‚æ•°ã€‚ lua_rawequalint lua_rawequal (lua_State *L, int index1, int index2); å¦‚æœä¸¤ä¸ªç´¢å¼• index1 å’Œ index2 å¤„çš„å€¼ç®€å•åœ°ç›¸ç­‰ ï¼ˆä¸è°ƒç”¨å…ƒæ–¹æ³•ï¼‰åˆ™è¿”å› 1 ã€‚ å¦åˆ™è¿”å› 0 ã€‚ å¦‚æœä»»ä½•ä¸€ä¸ªç´¢å¼•æ— æ•ˆä¹Ÿè¿”å› 0 ã€‚ lua_rawgetvoid lua_rawget (lua_State *L, int index); ç±»ä¼¼äº lua_gettableï¼Œä½†æ˜¯ä½œä¸€æ¬¡ç›´æ¥è®¿é—®ï¼ˆä¸è§¦å‘å…ƒæ–¹æ³•ï¼‰ã€‚ lua_rawgetivoid lua_rawgeti (lua_State *L, int index, int n); æŠŠ t[n] çš„å€¼å‹æ ˆï¼Œ è¿™é‡Œçš„ t æ˜¯æŒ‡ç»™å®šç´¢å¼• index å¤„çš„ä¸€ä¸ªå€¼ã€‚è¿™æ˜¯ä¸€ä¸ªç›´æ¥è®¿é—®ï¼›å°±æ˜¯è¯´ï¼Œå®ƒä¸ä¼šè§¦å‘å…ƒæ–¹æ³•ã€‚ lua_rawsetvoid lua_rawset (lua_State *L, int index); ç±»ä¼¼äº lua_settable ï¼Œä½†æ˜¯æ˜¯ä½œä¸€ä¸ªç›´æ¥èµ‹å€¼ï¼ˆä¸è§¦å‘å…ƒæ–¹æ³•ï¼‰ã€‚ lua_rawsetivoid lua_rawseti (lua_State *L, int index, int n); ç­‰ä»·äº t[n] = vï¼Œ è¿™é‡Œçš„ t æ˜¯æŒ‡ç»™å®šç´¢å¼• index å¤„çš„ä¸€ä¸ªå€¼ï¼Œ è€Œ v æ˜¯æ ˆé¡¶çš„å€¼ã€‚å‡½æ•°å°†æŠŠè¿™ä¸ªå€¼å¼¹å‡ºæ ˆã€‚ èµ‹å€¼æ“ä½œæ˜¯ç›´æ¥çš„ï¼›å°±æ˜¯è¯´ï¼Œä¸ä¼šè§¦å‘å…ƒæ–¹æ³•ã€‚]]></content>
      <categories>
        <category>Lua</category>
      </categories>
      <tags>
        <tag>Lua</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¤§ç«¯æ¨¡å¼ä¸å°ç«¯æ¨¡å¼]]></title>
    <url>%2F2018%2F04%2F02%2FUnix%2F</url>
    <content type="text"><![CDATA[å­—èŠ‚åº Little-Endian ä½ä½å­—èŠ‚æ”¾åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ï¼Œé«˜ä½å­—èŠ‚æ”¾åœ¨å†…å­˜çš„é«˜åœ°å€ç«¯ã€‚ Big-Endian é«˜ä½å­—èŠ‚æ”¾åœ¨å†…å­˜çš„é«˜åœ°å€ç«¯ï¼Œä½ä½å­—èŠ‚æ”¾åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ã€‚ Network byte order TPC/IPå„å±‚åè®®å°†å­—èŠ‚åºå®šä¹‰ä¸ºBig-Endianï¼Œå› æ­¤TCP/IPåè®®ä¸­ä½¿ç”¨çš„å­—èŠ‚åºé€šå¸¸ç§°ä¹‹ä¸ºç½‘ç»œå­—èŠ‚åºã€‚ é«˜/ä½åœ°å€ç«¯é¦–å…ˆè¦çŸ¥é“Cç¨‹åºä¸­å†…å­˜çš„ç©ºé—´å¸ƒå±€æƒ…å†µï¼šåœ¨ã€ŠCä¸“å®¶ç¼–ç¨‹ã€‹å’Œã€ŠUnixç¯å¢ƒé«˜çº§ç¼–ç¨‹ã€‹ä¸­å…³äºå†…å­˜ç©ºé—´å¸ƒå±€æƒ…å†µçš„è¯´æ˜ï¼Œå¤§è‡´å¦‚ä¸‹å›¾ï¼š â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” æœ€é«˜å†…å­˜åœ°å€ 0xffffffffæ ˆåº•æ ˆæ ˆé¡¶NULLï¼ˆç©ºæ´ï¼‰å †æœªåˆå§‹åŒ–çš„æ•°æ®æ­£æ–‡æ®µï¼ˆä»£ç æ®µâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” æœ€é«˜å†…å­˜åœ°å€ 0x00000000 åœ¨å†…å­˜åˆ†å¸ƒä¸­ï¼Œæ ˆæ˜¯å‘ä¸‹å¢é•¿çš„ï¼Œè€Œå †æ˜¯å‘ä¸Šå¢é•¿çš„ã€‚ åŠ å…¥åœ¨æ ˆåˆ†é…unisgned char buf[4]ï¼Œä»–åœ¨æ ˆä¸Šåˆ†å¸ƒå¦‚ä¸‹æ ˆåº•ï¼ˆé«˜åœ°å€ï¼‰buf[3]buf[2]buf[1]buf[0]æ ˆé¡¶ï¼ˆä½åœ°å€ï¼‰ é«˜/ä½ä½å­—èŠ‚åœ¨åè¿›åˆ¶ä¸­é å·¦è¾¹çš„æ˜¯é«˜ä½ï¼Œé å³è¾¹çš„åœ°å€ï¼Œåœ¨å…¶å®ƒè¿›åˆ¶ä¹Ÿæ˜¯å¦‚æ­¤ unisgned int value = 0x12345678; Big-Endian:ä½åœ°å€å­˜æ”¾é«˜ä½æ ˆåº•ï¼ˆé«˜åœ°å€ï¼‰buf[3] (0x78)buf[2] (0x56)buf[1] (0x34)buf[0] (0x12)æ ˆé¡¶ï¼ˆä½åœ°å€ï¼‰ Litter-Endian:é«˜åœ°å€å­˜é«˜ä½æ ˆé¡¶ï¼ˆé«˜åœ°å€ï¼‰buf[0] (0x78)buf[1] (0x56)buf[2] (0x34)buf[3] (0x12)æ ˆåº•ï¼ˆä½åœ°å€ï¼‰ ä¸»æœºåºï¼ˆHost Orderï¼‰å°±æ˜¯éµå¾ªLittle-Endianè§„åˆ™ã€‚æ‰€ä»¥å½“ä¸¤å°ä¸»æœºä¹‹é—´é€šè¿‡TCP/IPåè®®è¿›è¡Œé€šä¿¡çš„æ—¶å€™å°±éœ€è¦è°ƒç”¨ç›¸åº”çš„å‡½æ•°è¿›è¡Œä¸»æœºåºï¼ˆLittle-Endianï¼‰å’Œç½‘ç»œï¼ˆBig-Endianï¼‰çš„è½¬æ¢ã€‚ Big-Endianå’ŒLittle-Endianä¼˜ç¼ºç‚¹Big-Endian ä¼˜ç‚¹ï¼š é é¦–å…ˆæå–é«˜ä½å­—èŠ‚ï¼Œæ€»æ˜¯å¯ä»¥åœ¨åç§»ä½ç½®ä¸º0çš„å­—èŠ‚æ¥ç¡®å®šè¿™ä¸ªæ•°å­—æ˜¯æ­£æ•°è¿˜æ˜¯è´Ÿæ•°ã€‚ æ•°å€¼æ‰“å°æ˜¯æŒ‰é¡ºåºå­˜æ”¾çš„ Litter-Endian ä¼˜ç‚¹ï¼š æ•°å­¦è®¡ç®—ï¼Œç²¾åº¦å¤„ç†ã€‚]]></content>
      <tags>
        <tag>Unix</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSharp]]></title>
    <url>%2F2018%2F04%2F02%2FCSharp%2F</url>
    <content type="text"><![CDATA[internalã€sealedinternalï¼šæœ¬åº”ç”¨ç¨‹åºä½¿ç”¨ï¼Œå…¶å®ƒè¿›ç¨‹æ— æ³•ä½¿ç”¨ sealedï¼ˆå¯†å°ï¼‰ï¼šç”±å®ƒä¿®é¥°çš„ç±»ã€æ–¹æ³•ã€å±æ€§å°†ä¸èƒ½è¢«ç»§æ‰¿æˆ–æ˜¯é‡å†™ã€‚sealed å¿…é¡»å’Œoverrideä¸€èµ·ä½¿ç”¨sealedä¿®é¥°ç¬¦è¡¨ç¤ºå¯†å°ç”¨äºç±»æ—¶ï¼Œè¡¨ç¤ºè¯¥ç±»ä¸èƒ½è¢«ç»§æ‰¿ï¼Œä¸èƒ½å’ŒabstractåŒæ—¶ä½¿ç”¨ï¼Œä¸èƒ½è¢«å®ä¾‹åŒ–ã€‚å¯†å°ç±»ä¸èƒ½ç”¨ä½œåŸºç±»ã€ä¹Ÿä¸èƒ½ç»§æ‰¿ï¼Œè€ŒæŠ½è±¡ç±»æ€»æ˜¯å¸Œæœ›è¢«ç»§æ‰¿çš„ã€‚ fixedfixed è¯­å¥å¯é˜²æ­¢åƒåœ¾å›æ”¶å™¨é‡æ–°å®šä½å¯ç§»åŠ¨çš„å˜é‡ã€‚ fixed è¯­å¥ä»…å…è®¸å­˜åœ¨äºä¸å®‰å…¨çš„ä¸Šä¸‹æ–‡ä¸­ã€‚ Fixed è¿˜å¯ç”¨äºåˆ›å»ºå›ºå®šå¤§å°çš„ç¼“å†²åŒºã€‚ fixed è¯­å¥å°†ä¸ºæ‰˜ç®¡å˜é‡è®¾ç½®ä¸€ä¸ªæŒ‡é’ˆï¼Œå¹¶åœ¨è¯¥è¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹ä¸­â€œå•è¾¹é”å®šâ€è¯¥å˜é‡ã€‚ å¦‚æœæ²¡æœ‰ fixedï¼ŒæŒ‡å‘å¯ç§»åŠ¨çš„æ‰˜ç®¡å˜é‡çš„æŒ‡é’ˆå°†å‡ ä¹æ²¡æœ‰ä»€ä¹ˆç”¨å¤„ï¼Œå› ä¸ºåƒåœ¾å›æ”¶å¯èƒ½ä¼šä¸å¯é¢„è§åœ°é‡æ–°å®šä½å˜é‡ã€‚ C# ç¼–è¯‘å™¨åªå…è®¸å°†æŒ‡é’ˆåˆ†é…ç»™ fixed è¯­å¥ä¸­çš„æ‰˜ç®¡å˜é‡ã€‚ ä¸æ”¯æŒæŒå¤šç»§æ‰¿ï¼ŒC#ç±»å§‹ç»ˆç»§æ‰¿ä¸€ä¸ªåŸºç±»ï¼ˆå¦‚æœæœªåœ¨å£°æ˜ä¸­æŒ‡å®šä¸€ä¸ªåŸºç±»ï¼Œåˆ™ç»§æ‰¿è‡ªSystem.Object) å¦‚æœå¯¹ç±»æ²¡æœ‰å®šä¹‰æ˜¾ç¤ºæ„é€ å‡½æ•°ï¼Œåˆ™ç¼–è¯‘å™¨å°†æä¾›é»˜è®¤çš„æ„é€ å‡½æ•°ï¼Œä»¥åˆå§‹åŒ–è¿™äº›ç±»çš„æˆå‘˜å­—æ®µã€‚ä½†æ˜¯ï¼Œå¦‚æœæ˜¾å¼æ·»åŠ äº†æ„é€ å‡½æ•°ï¼Œå°±å¯ä»¥æœ‰æ•ˆæ§åˆ¶æ•´ä¸ªæ„é€ è¿‡ç¨‹ã€‚æ´¾ç”Ÿç±»é€šè¿‡ä½¿ç”¨:base()è¯­æ³•å¯ä»¥æ˜¾å¼è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•° override å…·æœ‰overrideå…³é”®å­—ä¿®é¥°ç¬¦çš„æ–¹æ³•æ˜¯å¯¹åŸºç±»ä¸­åŒåæ–¹æ³•çš„æ–°å®ç°ï¼ŒåŸºç±»ä¸­çš„åŒåæ–¹æ³•å¿…é¡»å£°æ˜ä¸ºvirtualæˆ–abstractç±»å‹ã€‚ç»™åŸºç±»ä¸­çš„æ–¹æ³•æ·»åŠ virtualå…³é”®å­—è¡¨ç¤ºå¯ä»¥é‡å†™å®ƒçš„å®ç°ã€‚new static å’Œ virtualå…³é”®å­—ä¸èƒ½ä¸overrideè®¿é—®ä¿®é¥°ç¬¦åŒæ—¶ä½¿ç”¨ã€‚ virtual æ”¯æŒå¤šæ€ï¼Œä¸èƒ½ä¸static overrideåŒæ—¶ä½¿ç”¨ abstract ä¸€ä¸ªæŠ½è±¡ç±»åŒ…å«æŠ½è±¡æ–¹æ³•å’ŒéæŠ½è±¡æ–¹æ³•ï¼ŒæŠ½è±¡æ–¹æ³•åªå­˜æ”¾å‡½æ•°åŸå‹ï¼Œä¸æ¶‰åŠä¸»ä½“ä»£ç ï¼Œoverrideå…³é”®å­—å¯åœ¨æ´¾ç”Ÿç±»ä¸­æŠ½è±¡æ–¹æ³•ï¼Œç»overrideå£°æ˜é‡å†™çš„æ–¹æ³•ç§°ä¸ºé‡å†™åŸºç±»æ–¹æ³•ï¼Œå…¶ç­¾åå¿…é¡»ä¸overrideæ–¹æ³•çš„ç­¾åç›¸åŒã€‚åªæ˜¯ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œé™¤æ­¤ä»¥å¤–å…·æœ‰ç±»çš„å…¶ä»–ç‰¹æ€§ï¼Œé‡è¦çš„æ˜¯æŠ½è±¡ç±»å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œè¿™æ˜¯æ™®é€šç±»æ‰€ä¸èƒ½çš„ã€‚æŠ½è±¡æ–¹æ³•åªèƒ½å£°æ˜äºæŠ½è±¡æ–¹æ³•ä¸­ï¼Œä¸”ä¸åŒ…å«ä»»ä½•å®ç°ï¼Œæ´¾ç”Ÿç±»å¿…é¡»è¦†ç›–å®ƒä»¬ã€‚ interface åŒ…å«æœªå®ç°çš„æ–¹æ³•å£°æ˜ï¼Œæ´¾ç”Ÿç±»å¿…é¡»å®ç°æœªå®ç°çš„æ–¹æ³•ï¼ŒæŠ½è±¡ç±»æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œæ¥å£åˆ™æ˜¯æ‰€æœ‰æˆå‘˜ï¼Œæ¥å£åŒ…å«å±æ€§ï¼Œç´¢å¼•å™¨äº‹ä»¶ ç´¢å¼•å™¨ç´¢å¼•å™¨å…è®¸ç±»æˆ–è€…ç»“æ„çš„å®ä¾‹æŒ‰ç…§äºæ•°ç»„ç›¸åŒçš„æ–¹æ³•è¿›è¡Œç´¢å¼•å–å€¼ï¼Œç´¢å¼•å™¨ä¸å±æ€§ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯ç´¢å¼•å™¨çš„è®¿é—®æ—¶å¸¦å‚çš„ ç´¢å¼•å™¨çš„ç´¢å¼•å€¼(Index)ç±»å‹ä¸å—é™åˆ¶ ç´¢å¼•å™¨å…è®¸é‡è½½ ç´¢å¼•å™¨ä¸æ˜¯ä¸€ä¸ªå˜é‡ ç´¢å¼•å™¨å’Œå±æ€§çš„ä¸åŒç‚¹ å±æ€§ä»¥åç§°æ¥æ ‡è¯†ï¼Œç´¢å¼•å™¨ä»¥å‡½æ•°å½¢å¼æ ‡è¯† ç´¢å¼•å™¨å¯ä»¥è¢«é‡è½½ï¼Œå±æ€§ä¸å¯ä»¥ ç´¢å¼•å™¨ä¸èƒ½å£°æ˜ä¸ºstaticï¼Œå±æ€§å¯ä»¥ interfaceã€abstract abstract interface èƒ½å¦å®ä¾‹åŒ– ä¸èƒ½ ä¸èƒ½ æŠ½è±¡ç±»å’Œæ¥å£çš„åŒºåˆ«ï¼š ç±»æ˜¯å¯¹å¯¹è±¡çš„æŠ½è±¡ï¼Œå¯ä»¥æŠŠæŠ½è±¡ç±»ç†è§£ä¸ºæŠŠç±»å½“ä½œå¯¹è±¡ï¼ŒæŠ½è±¡æˆçš„ç±»å«æŠ½è±¡ç±»ï¼Œè€Œæ¥å£åªæ˜¯ä¸€ä¸ªè¡Œä¸ºçš„è§„èŒƒæˆ–è§„å®šï¼Œ æ¥å£åŸºæœ¬ä¸Šä¸å…·å¤‡ç±»å‹çš„ä»»ä½•å…·ä½“ç‰¹ç‚¹ï¼Œå®ƒä»…ä»…æ‰¿è¯ºäº†èƒ½å¤Ÿè°ƒç”¨çš„æ–¹æ³• æŠ½è±¡ç±»æ¯”è¾ƒç»†ï¼Œè€Œæ¥å£æ¯”è¾ƒç®€å• æŠ½è±¡ç±»å’Œæ¥å£çš„ä½¿ç”¨ å¦‚æœé¢„è®¡è¦åˆ›å»ºç»„ä»¶çš„å¤šä¸ªç‰ˆæœ¬ï¼Œåˆ™åˆ›å»ºæŠ½è±¡ç±»ã€‚æŠ½è±¡ç±»æä¾›ç®€å•çš„æ–¹æ³•æ¥æ§åˆ¶ç»„ä»¶ç‰ˆæœ¬ã€‚ æŠ½è±¡ç±»ä¸»è¦ç”¨äºå…³ç³»å¯†åˆ‡çš„å¯¹è±¡ï¼›è€Œæ¥å£é€‚åˆä¸ºä¸ç›¸å…³çš„ç±»æä¾›é€šç”¨åŠŸèƒ½ Marshalæä¾›äº†ä¸€ä¸ªæ–¹æ³•é›†åˆï¼Œè¿™äº›æ–¹æ³•ç”¨äºåˆ†é…éæ‰˜ç®¡å†…å­˜ã€å¤åˆ¶éæ‰˜ç®¡å†…å­˜å—ã€å°†æ‰˜ç®¡ç±»å‹è½¬æ¢ä¸ºéæ‰˜ç®¡ç±»å‹ï¼Œæ­¤å¤–è¿˜æä¾›äº†åœ¨äºéæ‰˜ç®¡ä»£ç äº¤äº’æ—¶ä½¿ç”¨çš„å…¶ä»–æ–¹æ³• å‘½åç©ºé—´ï¼šSystem.Runtime.InteropServicesç¨‹åºé›†ï¼šmscorlib AllocHGlobal(int32); // é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„å­—èŠ‚æ•°ï¼Œä»è¿›ç¨‹çš„éæ‰˜ç®¡å†…å­˜ä¸­åˆ†é…å†…å­˜SizeOf(Type)è¿”å›éæ‰˜ç®¡ç±»å‹çš„å¤§å°(ä»¥å­—èŠ‚ä¸ºå•ä½) this12345678910111213public static class PGExt&#123; public static T PG_GetComponent(this List&lt;Component&gt; components) where T : Component &#123; int c = components.Count; for (int i = 0; i &lt; c; ++i) &#123; var p = components[i] as T; if ((object)p != null) return p; &#125; return null; &#125;&#125; ä¸ºä»€ä¹ˆè¿™é‡Œä¼šæœ‰ä¸€ä¸ªthiså…³é”®å­—ï¼Œåšä»€ä¹ˆç”¨ï¼Ÿå…¶å®è¿™å°±æ˜¯æ‰©å±•æ–¹æ³•ï¼è¿™ä¸ªæ‰©å±•æ–¹æ³•åœ¨é™æ€ç±»ä¸­å£°æ˜ï¼Œå®šä¹‰ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°å®šä¹‰å¯å®ƒçš„æ‰©å±•ç±»å‹ï¼ŒPG_GetComponentæ–¹æ³•æ‰©å±•äº†Listç±»ï¼Œå› ä¸ºå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°å®šä¹‰äº†Listç±»å‹ï¼Œä¸ºäº†åŒºåˆ†æ‰©å±•æ–¹æ³•å’Œä¸€èˆ¬çš„é™æ€æ–¹æ³•ï¼Œæ‰©å±•æ–¹æ³•è¿˜éœ€è¦ç»™ç¬¬ä¸€ä¸ªå‚æ•°ä½¿ç”¨thiså…³é”®å­—ã€‚ ç°åœ¨å°±å¯ä»¥ä½¿ç”¨å¸¦Listç±»å‹çš„PG_GetComponentæ–¹æ³•äº†ï¼š var mf = cacheComponents.PG_GetComponent&lt;MeshFilter&gt;(); volatilevolatileå…³é”®å­—æŒ‡ç¤ºä¸€ä¸ªå­—æ®µå¯ä»¥ç”±å¤šä¸ªåŒæ—¶æ‰§è¡Œçš„çº¿ç¨‹ä¿®æ”¹ã€‚å£°æ˜volatileçš„å­—æ®µä¸å—ç¼–è¯‘å™¨ä¼˜åŒ–çš„é™åˆ¶ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿è¯¥å­—æ®µåœ¨ä»»ä½•æ—¶é—´å‘ˆç°çš„éƒ½æ˜¯æœ€æ–°çš„å€¼ã€‚volatileä¿®é¥°ç¬¦é€šå¸¸ç”¨äºç”±å¤šä¸ªçº¿ç¨‹è®¿é—®ä½†ä¸ä½¿ç”¨lockè¯­å¥å¯¹è®¿é—®è¿›è¡Œåºåˆ—åŒ–çš„å­—æ®µã€‚volatileå…³é”®å­—å¯åº”ç”¨äºä»¥ä¸‹ç±»å‹çš„å­—æ®µï¼š å¼•ç”¨ç±»å‹ æŒ‡é’ˆç±»å‹ï¼ˆåœ¨ä¸å®‰å…¨çš„ä¸Šä¸‹æ–‡ä¸­ï¼‰ã€‚è¯·æ³¨æ„ï¼Œè™½ç„¶æŒ‡é’ˆæœ¬èº«å¯ä»¥æ˜¯å¯å˜çš„ï¼Œä½†æ˜¯å®ƒæŒ‡å‘çš„å¯¹è±¡ä¸èƒ½æ˜¯å¯å˜çš„ã€‚æ¢å¥è¯è¯´ï¼Œæ— æ³•å£°æ˜â€œæŒ‡å‘å¯å˜å¯¹è±¡çš„æŒ‡é’ˆâ€ã€‚ ç±»å‹ï¼Œå¦‚sbyteã€byteã€shortã€ushortã€intã€uintã€ã€‚ å¼•ç”¨ç±»å‹çš„æ³›å‹ç±»å‹å‚æ•°ã€‚ IntPtrå’ŒUIntPtr äº‹ä»¶å’Œå§”æ‰˜1234567891011121314151617181920212223242526272829public delegate void Print();class Test&#123; public event Print print; // å»æ‰eventå°±æ˜¯ä¸€ä¸ªå§”æ‰˜ public void Start() &#123; if (print == null) return; print(); &#125;&#125;class Program&#123; static void Print1() &#123; Console.WriteLine("Hello"); &#125; static void Print2() &#123; Console.WriteLine("World"); &#125; static void Main(string[] args) &#123; var obj = new Test(); obj.print += Print1; // äº‹ä»¶æ— æ³•ä½¿ç”¨= obj.print += Print2; // å§”æ‰˜ä¼šæ¸…æ‰ä¹‹å‰çš„å…³è” obj.Start(); &#125;&#125; äº‹ä»¶å®é™…ä¸Šæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å§”æ‰˜å®ä¾‹ï¼Œä¸ç”¨äº‹ä»¶ä¹Ÿæ²¡æœ‰å…³ç³»ã€‚å®é™…ä¸Šäº‹ä»¶åªæ˜¯å‰Šå¼±äº†å§”æ‰˜çš„åŠŸèƒ½ï¼Œeventåœ¨ç¼–è¾‘å™¨è§’åº¦ä¿æŠ¤äº†ç¨‹åºçš„å®‰å…¨ï¼Œå› ä¸ºä½ åªèƒ½ç”¨+=ã€-=æ¥æ³¨å†Œäº‹ä»¶äº†ï¼Œè€Œä¸èƒ½ä½¿ç”¨=ä¸ºäº‹ä»¶å…³è”æ–¹æ³•ã€‚ï¼ˆåœ¨å§”æ‰˜ä¸­è¿˜å¯ä»¥ä½¿ç”¨=æ¥ç»‘å®šæ–¹æ³•ï¼Œä¸è¿‡=æ˜¯ä¸€ç§ç ´åæ€§ä»£ç ï¼Œä¸ç®¡ä¹‹å‰æ˜¯å¦å·²ç»ç»‘å®šæ–¹æ³•ï¼Œä»–éƒ½ä¼šå°†å…¶æ¸…é™¤ï¼‰ extern:æŒ‡ç¤ºæ–¹æ³•åœ¨å¤–éƒ¨å®ç° å †æ ˆå’Œå † Heap &amp; Stacké¦–å…ˆå †æ ˆå’Œå †ï¼ˆæ‰˜ç®¡å †ï¼‰éƒ½åœ¨è¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜ä¸­ã€‚ï¼ˆåœ¨32ä½å¤„ç†å™¨ä¸Šæ¯ä¸ªè¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜ä¸º4GBï¼‰æ ˆæ˜¯å†…å­˜ä¸­å®Œå…¨ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡æˆ–æˆå‘˜ï¼ˆå€¼ç±»å‹æ•°æ®ï¼‰çš„é«˜æ•ˆåŒºåŸŸï¼Œä½†å…¶å¤§å°æœ‰é™åˆ¶ã€‚æ‰˜ç®¡å †å å†…å­˜æ¯”æ ˆå¤§å¾—å¤šï¼Œå½“è®¿é—®é€Ÿåº¦è¾ƒæ…¢ã€‚æ‰˜ç®¡å †åªç”¨äºåˆ†é…å†…å­˜ã€‚åœ¨åˆ›å»ºå€¼ç±»å‹æ•°æ®æ—¶ï¼Œåœ¨æ ˆä¸Šåˆ†é…å†…å­˜ï¼›å½“åˆ›å»ºå¼•ç”¨å‹ç±»å‹æ•°æ®æ—¶ï¼Œåœ¨æ‰˜ç®¡å †ä¸Šåˆ†é…å¹¶è¿”å›å¯¹è±¡çš„å¼•ç”¨ã€‚æ³¨æ„è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œåƒå…¶ä»–å±€éƒ¨å˜é‡ä¸€æ ·ä¹Ÿæ˜¯ä¿å­˜åœ¨æ ˆä¸­ï¼Œè¯¥å¼•ç”¨æŒ‡å‘çš„å€¼åˆ™ä½äºæ‰˜ç®¡å †ä¸­ã€‚å¦‚æœåˆ›å»ºä¸€ä¸ªåŒ…å«å€¼ç±»å‹çš„å¼•ç”¨ç±»å‹ï¼Œæ¯”å¦‚æ•°ç»„ï¼Œå…¶å…ƒç´ çš„å€¼ä¹Ÿæ˜¯å­˜æ”¾åœ¨æ‰˜ç®¡å †ä¸­çš„æŸä¸ªåœ°æ–¹ï¼Œç”±ä½¿ç”¨è¯¥å®ä½“çš„å˜é‡å¼•ç”¨ï¼›è€Œå€¼ç±»å‹å­˜å‚¨åœ¨ä½¿ç”¨å®ƒä»¬çš„åœ°æ–¹ï¼Œæœ‰å‡ å¤„åœ¨ä½¿ç”¨ï¼Œå°±æœ‰å‡ ä¸ªå‰¯æœ¬å­˜åœ¨ã€‚å¯¹äºå¼•ç”¨ç±»å‹ï¼Œå¦‚æœåœ¨å£°æ˜å˜é‡çš„æ—¶å€™æ²¡æœ‰ä½¿ç”¨newè¿ç®—ç¬¦ï¼Œè¿è¡Œæ—¶ä¸ä¼šç»™å®ƒåˆ†é…æ‰˜ç®¡å †çš„å†…å­˜ç©ºé—´ï¼Œè€Œæ˜¯åœ¨æ ˆä¸Šç»™å®ƒåˆ†é…ä¸€ä¸ªåŒ…å«nullçš„å€¼çš„å¼•ç”¨ã€‚å¯¹äºå€¼ç±»å‹ï¼Œè¿è¡Œæ—¶ä¼šç»™å®ƒåˆ†é…æ ˆä¸Šçš„ç©ºé—´ï¼Œå¹¶ä¸”è°ƒç”¨æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–å¯¹è±¡çš„çŠ¶æ€ã€‚ å †æ ˆstackå †æ ˆä¸­å­˜å‚¨å€¼ç±»å‹å †æ ˆå®é™…ä¸Šæ˜¯å‘ä¸‹å¡«å……ï¼Œå³ç”±é«˜å†…å­˜åœ°å€æŒ‡å‘ä½å†…å­˜åœ°å€å¡«å……ã€‚å †æ ˆçš„å·¥ä½œæ–¹å¼æ˜¯å…ˆåˆ†é…å†…å­˜çš„å˜é‡ååé‡Šæ”¾ï¼ˆå…ˆè¿›åå‡ºåŸåˆ™ï¼‰ã€‚å †æ ˆçš„å˜é‡æ˜¯ä»ä¸‹å‘ä¸Šé‡Šæ”¾ï¼Œè¿™æ ·å°±ä¿è¯äº†å †æ ˆä¸­å…ˆè¿›åå‡ºçš„è§„åˆ™ä¸ä¸å˜é‡çš„ç”Ÿå‘½å‘¨æœŸèµ·å†²çªå †æ ˆçš„æ€§èƒ½éå¸¸é«˜ï¼Œä½†æ˜¯å¯¹äºæ‰€æœ‰çš„å˜é‡æ¥è¯´ä¸å¤ªçµæ´»ï¼Œè€Œä¸”å˜é‡çš„ç”Ÿå‘½å‘¨æœŸå¿…é¡»åµŒå¥—ã€‚é€šå¸¸æˆ‘ä»¬å¸Œæœ›ä½¿ç”¨ä¸€ç§æ–¹æ³•åˆ†é…å†…å­˜æ¥å­˜å‚¨æ•°æ®ï¼Œå¹¶ä¸”æ–¹æ³•é€€å‡ºåå¾ˆé•¿ä¸€æ®µæ—¶é—´å†…æ•°æ®ä»ç„¶å¯ä»¥ä½¿ç”¨ã€‚æ­¤æ—¶å°±è¦ç”¨åˆ°å †ï¼ˆæ‰˜ç®¡å †ï¼‰ å †ï¼ˆæ‰˜ç®¡å †ï¼‰heapå †ï¼ˆæ‰˜ç®¡å †ï¼‰å­˜å‚¨å¼•ç”¨ç±»å‹ã€‚å¼•ç”¨ç±»å‹å…±æœ‰å››ç§ï¼šç±»ç±»å‹ã€æ¥å£ç±»å‹ã€æ•°ç»„ç±»å‹å’Œå§”æ‰˜ç±»å‹ã€‚æ‰€æœ‰å¼•ç”¨ç±»å‹å˜é‡æ‰€å¼•ç”¨çš„å¯¹è±¡ï¼Œå…¶å†…å­˜éƒ½æ˜¯æ‰˜ç®¡å †ä¸­åˆ†é…çš„ã€‚ä¸¥æ ¼åœ°è¯´ï¼Œæˆ‘ä»¬å¸¸è¯´çš„â€œå¯¹è±¡å˜é‡â€å…¶å®æ˜¯ç±»ç±»å‹çš„å¼•ç”¨å˜é‡ã€‚ä½†åœ¨å®é™…ä¸­äººä»¬ç»å¸¸å°†å¼•ç”¨ç±»å‹çš„å˜é‡ç®€ç§°ä¸ºâ€œå¯¹è±¡å˜é‡â€ï¼Œç”¨å®ƒæ¥æŒ‡ä»£æ‰€æœ‰å››ç§ç±»å‹çš„å¼•ç”¨å˜é‡ã€‚æ­¤å †éå½¼å †ï¼Œ.NETä¸­çš„å †ç”±åƒåœ¾æ”¶é›†å™¨è‡ªåŠ¨ç®¡ç†ã€‚ä¸å †æ ˆä¸åŒï¼Œå †æ˜¯ä»ä¸‹å¾€ä¸Šåˆ†é…ï¼Œæ‰€ä»¥è‡ªåŠ¨çš„ç©ºé—´éƒ½åœ¨å·²ç”¨ç©ºé—´çš„ä¸Šé¢ã€‚æ¯”å¦‚åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼š Customer cus; cus = new Customer(); å£°æ˜ä¸€ä¸ªCustomerçš„å¼•ç”¨cusï¼Œåœ¨å †æ ˆä¸Šç»™è¿™ä¸ªå¼•ç”¨åˆ†é…å­˜å‚¨ç©ºé—´ã€‚è¿™ä»…ä»…åªæ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œä¸æ˜¯å®é™…çš„Customerå¯¹è±¡ï¼cuså 4ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼ŒåŒ…å«äº†å­˜å‚¨Customerçš„å¼•ç”¨åœ°å€ã€‚æ¥ç€åˆ†é…å †ä¸Šçš„å†…å­˜ä»¥å­˜å‚¨Customerå¯¹è±¡çš„å®ä¾‹ï¼Œå‡å®šCustomerå¯¹è±¡çš„å®ä¾‹æ˜¯32å­—èŠ‚ï¼Œä¸ºäº†åœ¨å †ä¸Šæ‰¾åˆ°ä¸€ä¸ªå­˜å‚¨Customerå¯¹è±¡çš„å­˜å‚¨ä½ç½®ã€‚.NETè¿è¡Œåº“åœ¨å †ä¸­æœç´¢ç¬¬ä¸€ä¸ªä»æœªä½¿ç”¨çš„ï¼Œ32å­—èŠ‚çš„è¿ç»­å—å­˜å‚¨Customerå¯¹è±¡çš„å®ä¾‹ã€‚ç„¶åæŠŠåˆ†é…ç»™Customerå¯¹è±¡å®ä¾‹çš„åœ°å€èµ‹ç»™cuså˜é‡ã€‚ ä»è¿™ä¸ªä¾‹å­ä¸­å¯ä»¥çœ‹å‡ºï¼Œå»ºç«‹å¯¹è±¡å¼•ç”¨çš„è¿‡ç¨‹æ¯”å»ºç«‹å€¼å˜é‡çš„è¿‡ç¨‹å¤æ‚ï¼Œä¸”ä¸èƒ½é¿å…æ€§èƒ½çš„é™ä½ï¼å®é™…ä¸Šå°±æ˜¯.NETè¿è¡Œåº“ä¸­ä¿å­˜å †çš„çŠ¶æ€ä¿¡æ¯ï¼Œåœ¨å †ä¸­æ·»åŠ æ–°æ•°æ®æ—¶ï¼Œå †æ ˆä¸­çš„å¼•ç”¨å˜é‡ä¹Ÿè¦æ›´æ–°ã€‚æ€§èƒ½ä¸ŠæŸå¤±å¾ˆå¤šã€‚æœ‰ç§æœºåˆ¶åœ¨åˆ†é…å˜é‡å†…å­˜çš„æ—¶å€™ï¼Œä¸ä¼šå—åˆ°å †æ ˆçš„é™åˆ¶ï¼šæŠŠä¸€ä¸ªå¼•ç”¨å˜é‡çš„å€¼èµ‹ç»™ä¸€ä¸ªç›¸åŒç±»å‹çš„å˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå˜é‡å°±å¼•ç”¨åŒä¸€ä¸ªå †ä¸­å¯¹è±¡ã€‚å½“ä¸€ä¸ªåº”ç”¨å˜é‡å‡ºä½œç”¨åŸŸæ—¶ï¼Œå®ƒä¼šä»å †æ ˆä¸­åˆ é™¤ã€‚ä½†å¼•ç”¨å¯¹è±¡çš„æ•°æ®ä»ç„¶ä¿ç•™åœ¨å †ä¸­ï¼Œä¸€ç›´åˆ°ç¨‹åºç»“æŸæˆ–è€…è¯¥æ•°æ®ä¸è¢«ä»»ä½•å˜é‡åº”ç”¨æ—¶ï¼Œåƒåœ¾æ”¶é›†å™¨ä¼šåˆ é™¤å®ƒã€‚ è£…ç®±è½¬åŒ–123456789101112using System;class Boxing&#123; public static void Main() &#123; int i = 110; object obj = i; Console.WriteLine(&quot;i=&#123;0&#125;,obj = &#123;1&#125;&quot;,i,obj); obj = 330; Console.WriteLine(&quot;i = &#123;0&#125;,obj=&#123;1&#125;&quot;,i,obj); &#125;&#125; å®šä¹‰æ•´æ•°ç±»å‹å˜é‡çš„æ—¶å€™ï¼Œè¿™ä¸ªå˜é‡å ç”¨çš„å†…å­˜æ˜¯å†…å­˜å ä¸­åˆ†é…çš„ï¼Œç¬¬äºŒå¥æ˜¯è£…ç®±æ“ä½œå°†å˜é‡110å­˜æ”¾åˆ°äº†å†…å­˜å †ä¸­ï¼Œè€Œå®šä¹‰objectå¯¹è±¡ç±»å‹çš„å˜é‡Objåˆ™åœ¨å†…å­˜æ ˆä¸­ï¼Œå¹¶æŒ‡å‘intç±»å‹çš„æ•°å€¼110ï¼Œè€Œè¯¥æ•°å€¼æ˜¯èµ‹ç»™å˜é‡içš„æ•°å€¼å‰¯æœ¬ã€‚å†…å­˜æ ¼å±€é€šå¸¸åˆ†ä¸ºå››ä¸ªåŒºå…¨å±€æ•°æ®åŒºï¼šå­˜æ”¾å…¨å±€å˜é‡ï¼Œé™æ€æ•°æ®ï¼Œå¸¸é‡ä»£ç åŒºï¼šå­˜æ”¾æ‰€æœ‰çš„ç¨‹åºä»£ç æ ˆåŒºï¼šå­˜æ”¾ä¸ºè¿è¡Œè€Œåˆ†é…çš„å±€éƒ¨å˜é‡ï¼Œå‚æ•°ï¼Œè¿”å›æ•°æ®ï¼Œè¿”å›åœ°å€ç­‰ã€‚ å€¼ç±»å‹å˜é‡å’Œå¼•ç”¨ç±»å‹å˜é‡çš„å†…å­˜åˆ†é…æ¨¡å‹ä¹Ÿä¸ä¸€æ ·ã€‚ä¸ºäº†ç†è§£æ¸…æ¥šè¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆå…ˆåŒºåˆ†ä¸¤ç§ä¸åŒç±»å‹çš„å†…å­˜åŒºåŸŸï¼šçº¿ç¨‹å †æ ˆï¼ˆThread Stackï¼‰å’Œæ‰˜ç®¡å †ï¼ˆManaged Heapï¼‰ã€‚æ¯ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åºéƒ½å¯¹åº”ç€ä¸€ä¸ªè¿›ç¨‹ï¼ˆprocessï¼‰ï¼Œåœ¨ä¸€ä¸ªè¿›ç¨‹å†…éƒ¨ï¼Œå¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ï¼ˆthreadï¼‰ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æ‹¥æœ‰ä¸€å—â€œè‡ªç•™åœ°â€ï¼Œç§°ä¸ºâ€œçº¿ç¨‹å †æ ˆâ€ï¼Œå¤§å°ä¸º1Mï¼Œç”¨äºä¿å­˜è‡ªèº«çš„ä¸€äº›æ•°æ®ï¼Œæ¯”å¦‚å‡½æ•°ä¸­å®šä¹‰çš„å±€éƒ¨å˜é‡ã€å‡½æ•°è°ƒç”¨çš„ä¼ å‚å€¼ï¼Œè¿™éƒ¨åˆ†å†…å­˜åŒºåŸŸçš„åˆ†é…ä¸å›æ”¶ä¸éœ€è¦äººä¸ºå¹²æ¶‰ã€‚ æ‰€æœ‰å€¼ç±»å‹çš„å˜é‡éƒ½æ˜¯åœ¨çº¿ç¨‹å †æ ˆä¸­åˆ†é…çš„ã€‚å¦ä¸€å—å†…å­˜åŒºåŸŸæˆä¸ºâ€œå †ï¼ˆheapï¼‰â€ï¼Œåœ¨.NETæ‰˜ç®¡ç¯å¢ƒä¸‹ï¼Œå †ç”±CLRè¿›è¡Œç®¡ç†ï¼Œæ‰€ä»¥åˆç§°ä¸ºâ€œæ‰˜ç®¡å †ï¼ˆmanaged heapï¼‰â€ã€‚ ç”¨newå…³é”®å­—åˆ›å»ºçš„ç±»çš„å¯¹è±¡æ—¶ï¼Œåˆ†é…ç»™å¯¹è±¡çš„å†…å­˜å•å…ƒå°±ä½äºæ‰˜ç®¡å †ä¸­ã€‚åœ¨ç¨‹åºä¸­æˆ‘ä»¬å¯ä»¥éšæ„åœ°ä½¿ç”¨new å…³é”®å­—åˆ›å»ºå¤šä¸ªå¯¹è±¡ï¼Œå› æ­¤ï¼Œæ‰˜ç®¡å †ä¸­çš„å†…å­˜èµ„æºæ˜¯å¯ä»¥åŠ¨æ€ç”³è¯·å¹¶ä½¿ç”¨çš„ï¼Œå½“ç„¶ä½¿ç”¨å®Œäº†å¿…é¡»å½’è¿˜ã€‚ å¯¹è±¡å˜é‡çš„ç›¸äº’èµ‹å€¼ä¸ä¼šå¯¼è‡´å¯¹è±¡è‡ªèº«è¢«å¤åˆ¶ï¼Œå…¶ç»“æœæ˜¯ä¸¤ä¸ªå¯¹è±¡å˜é‡æŒ‡å‘åŒä¸€å¯¹è±¡ã€‚å¦å¤–ï¼Œç”±äºå¯¹è±¡å˜é‡æ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œå› ä¸ºï¼Œå¯¹è±¡å˜é‡æœ¬èº«æ˜¯ä½äºçº¿ç¨‹å †æ ˆä¸­çš„ã€‚ä¸¥æ ¼åŒºåˆ†å¯¹è±¡å˜é‡å’Œå¯¹è±¡å˜é‡æ‰€å¼•ç”¨çš„å¯¹è±¡ï¼Œæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å…³é”®ä¹‹ä¸€ã€‚ æ‰˜ç®¡å †.NETæ¡†æ¶åŒ…å«ä¸€ä¸ªæ‰˜ç®¡å †ï¼Œæ‰€æœ‰çš„.NETè¯­è¨€åœ¨åˆ†é…å¼•ç”¨ç±»å‹å¯¹è±¡æ—¶éƒ½è¦ä½¿ç”¨å®ƒã€‚åƒå€¼ç±»å‹è¿™æ ·çš„è½»é‡çº§å¯¹è±¡å§‹ç»ˆåˆ†é…åœ¨æ ˆä¸­ï¼Œä½†æ˜¯æ‰€æœ‰çš„ç±»å®ä¾‹å’Œæ•°ç»„éƒ½è¢«ç”Ÿæˆåœ¨ä¸€ä¸ªå†…å­˜æ± ä¸­ï¼Œè¿™ä¸ªå†…å­˜æ± å°±æ˜¯æ‰˜ç®¡å †ã€‚ åƒåœ¾æ”¶é›†å™¨ç®—æ³•ï¼š å°†æ‰€æœ‰çš„æ‰˜ç®¡å†…å­˜æ ‡è®°ä¸ºåƒåœ¾ å¯»æ‰¾æ­£è¢«ä½¿ç”¨çš„å†…å­˜å—ï¼Œå¹¶å°†ä»–ä»¬æ ‡è®°ä¸ºæœ‰æ•ˆ é‡Šæ”¾æ‰€æœ‰æ²¡æœ‰è¢«ä½¿ç”¨çš„å†…å­˜å— æ•´ç†å †ä»¥å‡å°‘ç¢ç‰‡ æ‰˜ç®¡å †ä¼˜åŒ–çœ‹ä¸Šå»å¾ˆç®€å•ï¼Œä½†æ˜¯åƒåœ¾æ”¶é›†å™¨å®é™…é‡‡ç”¨çš„æ­¥éª¤å’Œå †ç®¡ç†ç³»ç»Ÿçš„å…¶å®ƒéƒ¨åˆ†å¹¶éå¾®ä¸è¶³é“ï¼Œå…¶ä¸­å°å°æ¶‰åŠä¸ºæé«˜æ€§èƒ½è€Œä½œçš„ä¼˜åŒ–è®¾è®¡ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œåƒåœ¾æ”¶é›†éå†æ•´ä¸ªå†…å­˜æ± å…·æœ‰å¾ˆé«˜çš„å¼€é”€ã€‚ç„¶è€Œï¼Œç ”ç©¶è¡¨æ˜å¤§éƒ¨åˆ†çš„æ‰˜ç®¡å †ä¸Šåˆ†é…çš„å¯¹è±¡åªæœ‰å¾ˆçŸ­çš„ç”Ÿå­˜æœŸï¼Œå› æ­¤å †è¢«åˆ†ä¸ºä¸‰ä¸ªæ®µï¼Œç§°ä½œgenerationsã€‚æ–°åˆ†é…çš„å¯¹è±¡è¢«æ”¾åœ¨generation 0ä¸­ã€‚è¿™ä¸ªgenerationæ˜¯æœ€å…ˆè¢«å›æ”¶çš„-åœ¨è¿™ä¸ªgenerationä¸­æœ€æœ‰å¯èƒ½æ‰¾åˆ°ä¸å†ä½¿ç”¨çš„å†…å­˜ï¼Œç”±äºå®ƒçš„å°ºå¯¸å¾ˆå°ï¼ˆå°åˆ°è¶³ä»¥æ”¾è¿›å¤„ç†å™¨çš„L2 cacheä¸­ï¼‰ï¼Œå› æ­¤åœ¨å®ƒé‡Œé¢çš„å›æ”¶å°†æ˜¯æœ€å¿«å’Œæœ€é«˜æ•ˆçš„ã€‚æ‰˜ç®¡å †çš„å¦å¤–ä¸€ç§ä¼˜åŒ–æ“ä½œä¸locality of referenceè§„åˆ™æœ‰å…³ã€‚è¯¥è§„åˆ™è¡¨æ˜ï¼Œä¸€èµ·åˆ†é…çš„å¯¹è±¡ç»å¸¸è¢«ä¸€èµ·ä½¿ç”¨ã€‚å¦‚æœå¯¹è±¡ä»¬åœ¨å †ä¸­ä½ç½®å¾ˆç´§å‡‘çš„è¯ï¼Œé«˜é€Ÿç¼“å­˜çš„æ€§èƒ½å°†ä¼šå¾—åˆ°æé«˜ã€‚ç”±äºæ‰˜ç®¡å †çš„å¤©æ€§ï¼Œå¯¹è±¡ä»¬æ€»æ˜¯è¢«åˆ†é…åœ¨è¿ç»­çš„åœ°å€ä¸Šï¼Œæ‰˜ç®¡å †æ€»æ˜¯ä¿æŒç´§å‡‘ï¼Œç»“æœä½¿å¾—å¯¹è±¡ä»¬å§‹ç»ˆå½¼æ­¤é è¿‘ï¼Œæ°¸è¿œä¸ä¼šåˆ†å¾—å¾ˆè¿œã€‚è¿™ä¸€ç‚¹ä¸æ ‡å‡†æä¾›çš„éæ‰˜ç®¡ä»£ç å½¢æˆäº†é²œæ˜çš„å¯¹æ¯”ï¼Œåœ¨æ ‡å‡†å †ä¸­ï¼Œå †å¾ˆå®¹æ˜“å˜æˆç¢ç‰‡ï¼Œè€Œä¸”ä¸€èµ·åˆ†é…çš„å¯¹è±¡ç»å¸¸åˆ†å¾—å¾ˆè¿œã€‚è¿˜æœ‰ä¸€ç§ä¼˜åŒ–æ˜¯ä¸å¤§å¯¹è±¡æœ‰å…³çš„ã€‚é€šå¸¸ï¼Œå¤§å¯¹è±¡å…·æœ‰å¾ˆé•¿çš„ç”Ÿå­˜æœŸã€‚å½“ä¸€ä¸ªå¤§å¯¹è±¡åœ¨.NETæ‰˜ç®¡å †ä¸­äº§ç”Ÿæ—¶ï¼Œå®ƒè¢«åˆ†é…åœ¨å †çš„ä¸€ä¸ªç‰¹æ®Šéƒ¨åˆ†ä¸­ï¼Œè¿™éƒ¨åˆ†å †æ°¸è¿œä¸ä¼šè¢«æ•´ç†ã€‚å› æ­¤ç§»åŠ¨å¤§å¯¹è±¡æ‰€å¸¦æ¥çš„å¼€é”€è¶…è¿‡äº†æ•´ç†è¿™éƒ¨åˆ†å †æ‰€èƒ½æé«˜çš„æ€§èƒ½ã€‚ å…³äºå¤–éƒ¨èµ„æºï¼ˆExternal Resourcesï¼‰çš„é—®é¢˜åƒåœ¾æ”¶é›†å™¨èƒ½å¤Ÿæœ‰æ•ˆåœ°ç®¡ç†ä»æ‰˜ç®¡å †ä¸­é‡Šæ”¾çš„èµ„æºï¼Œä½†æ˜¯èµ„æºå›æ”¶æ“ä½œåªæœ‰åœ¨å†…å­˜ç´§å¼ è€Œè§¦å‘ä¸€ä¸ªå›æ”¶åŠ¨ä½œæ—¶æ‰æ‰§è¡Œã€‚é‚£ä¹ˆï¼Œç´¯æ—¶æ€æ ·æ¥ç®¡ç†åƒæ•°æ®åº“è¿æ¥æˆ–è€…çª—å£å¥æŸ„è¿™æ ·æœ‰é™çš„èµ„æºçš„å‘¢ï¼Ÿç­‰å¾…ï¼Œç›´åˆ°åƒåœ¾å›æ”¶è¢«è§¦å‘ä¹‹ååœ¨æ¸…ç†æ•°æ®åº“è¿æ¥æˆ–è€…æ–‡ä»¶å¥æŸ„å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½æ–¹æ³•ï¼Œè¿™ä¼šä¸¥é‡é™ä½ç³»ç»Ÿçš„æ€§èƒ½ã€‚æ‰€æœ‰æ‹¥æœ‰å¤–éƒ¨èµ„æºçš„ç±»ï¼Œåœ¨è¿™äº›èµ„æºå·²ç»ä¸å†ç”¨åˆ°çš„æ—¶å€™ï¼Œéƒ½åº”å½“æ‰§è¡ŒCloseæˆ–è€…Disposeæ–¹æ³•ã€‚éœ€è¦æ¸…ç†å¤–éƒ¨èµ„æºçš„ç±»è¿˜åº”å½“å®ç°ä¸€ä¸ªç»ˆæ­¢æ“ä½œï¼ˆfinalizerï¼‰ã€‚åœ¨C#ä¸­ï¼Œåˆ›å»ºç»ˆæ­¢æ“ä½œçš„é¦–é€‰æ–¹å¼æ˜¯åœ¨ææ„å‡½æ•°ä¸­å®ç°ï¼Œè€Œåœ¨Frameworkå±‚ï¼Œç»ˆæ­¢æ“ä½œçš„å®ç°åˆ™æ˜¯é€šè¿‡é‡è½½System.Object.Finalizeæ–¹æ³•ã€‚ä»¥ä¸‹ä¸¤ç§å®ç°ç»ˆæ­¢æ“ä½œçš„æ–¹æ³•æ˜¯ç­‰æ•ˆçš„ï¼š123456789~OverdueBookLocator()&#123; Dispose(false);&#125;public void Finalize()&#123; base.Finalize(); Dispose(false);&#125; åœ¨C#ä¸­ï¼ŒåŒæ—¶åœ¨Finalizeæ–¹æ³•å’Œææ„å‡½æ•°å®ç°ç»ˆæ­¢æ“ä½œå°†ä¼šå¯¼è‡´é”™è¯¯çš„äº§ç”Ÿã€‚é™¤éä½ æœ‰è¶³å¤Ÿçš„ç†ç”±ï¼Œå¦åˆ™ä½ ä¸åº”è¯¥åˆ›å»ºææ„å‡½æ•°æˆ–è€…Finalizeæ–¹æ³•ã€‚ç»ˆæ­¢æ“ä½œä¼šé™ä½ç³»ç»Ÿçš„æ€§èƒ½ï¼Œå¹¶ä¸”å¢åŠ æ‰§è¡ŒæœŸçš„å†…å­˜å¼€é”€ã€‚åŒæ—¶ï¼Œç”±äºç»ˆæ­¢æ“ä½œè¢«æ‰§è¡Œçš„æ–¹å¼ï¼Œä½ å¹¶ä¸èƒ½ä¿è¯ä½•æ—¶ä¸€ä¸ªç»ˆæ­¢æ“ä½œè¢«æ‰§è¡Œã€‚ å†…å­˜åˆ†é…å’Œåƒåœ¾å›æ”¶çš„ç»†èŠ‚å¯¹GCæœ‰äº†ä¸€ä¸ªæ€»ä½“å°è±¡ä¹‹åï¼Œè®©æˆ‘ä»¬æ¥è®¨è®ºå…³äºæ‰˜ç®¡å †ä¸­çš„åˆ†é…ä¸å›æ”¶å·¥ä½œçš„ç»†èŠ‚ã€‚æ‰˜ç®¡å †çœ‹èµ·æ¥ä¸æˆ‘ä»¬å·²ç»ç†Ÿæ‚‰çš„C++ç¼–ç¨‹ä¸­çš„ä¼ ç»Ÿçš„å †ä¸€ç‚¹éƒ½ä¸åƒã€‚åœ¨ä¼ ç»Ÿçš„å †ä¸­ï¼Œæ•°æ®ç»“æ„ä¹ æƒ¯äºä½¿ç”¨å¤§å—çš„ç©ºé—²å†…å­˜ã€‚åœ¨å…¶ä¸­æŸ¥æ‰¾ç‰¹å®šå¤§å°çš„å†…å­˜å—æ˜¯ä¸€ä»¶å¾ˆè€—æ—¶çš„å·¥ä½œï¼Œå°¤å…¶æ˜¯å½“å†…å­˜ä¸­å……æ»¡ç¢ç‰‡çš„æ—¶å€™ã€‚ä¸æ­¤ä¸åŒï¼Œåœ¨æ‰˜ç®¡å †ä¸­ï¼Œå†…å­˜è¢«ç»„æˆè¿ç»­çš„æ•°ç»„ï¼ŒæŒ‡é’ˆæ€»æ˜¯å·¡ç€å·²ç»è¢«ä½¿ç”¨çš„å†…å­˜å’Œæœªè¢«ä½¿ç”¨çš„å†…å­˜ä¹‹é—´çš„è¾¹ç•Œç§»åŠ¨ã€‚å½“å†…å­˜è¢«åˆ†é…çš„æ—¶å€™ï¼ŒæŒ‡é’ˆåªæ˜¯ç®€å•åœ°é€’å¢â€”ç”±æ­¤è€Œæ¥çš„ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œåˆ†é…æ“ä½œçš„æ•ˆç‡å¾—åˆ°äº†å¾ˆå¤§çš„æå‡ã€‚å½“å¯¹è±¡è¢«åˆ†é…çš„æ—¶å€™ï¼Œå®ƒä»¬ä¸€å¼€å§‹è¢«generation 0ä¸­ã€‚å½“generation 0çš„å¤§å°å¿«è¦è¾¾åˆ°å®ƒçš„ä¸Šé™çš„æ—¶å€™ï¼Œä¸€ä¸ªåªåœ¨generation 0ä¸­æ‰§è¡Œçš„å›æ”¶æ“ä½œè¢«è§¦å‘ã€‚ç”±äºgeneration 0çš„å¤§å°å¾ˆå°ï¼Œå› æ­¤è¿™å°†æ˜¯ä¸€ä¸ªéå¸¸å¿«çš„GCè¿‡ç¨‹ã€‚è¿™ä¸ªGCè¿‡ç¨‹çš„ç»“æœæ˜¯å°†generation 0å½»åº•çš„åˆ·æ–°äº†ä¸€éã€‚ä¸å†ä½¿ç”¨çš„å¯¹è±¡è¢«é‡Šæ”¾ï¼Œæ­£åœ¨ä½¿ç”¨çš„å¯¹è±¡è¢«æ•´ç†å¹¶ç§»å…¥generation 1ä¸­ã€‚å½“generation 1çš„å¤§å°éšç€generation 0ä¸­ç§»å…¥çš„å¯¹è±¡æ•°é‡çš„å¢åŠ è€Œæ¥è¿‘å®ƒçš„ä¸Šé™çš„æ—¶å€™ï¼Œä¸€ä¸ªå›æ”¶åŠ¨ä½œè¢«è§¦å‘åœ¨generation 0å’Œgeneration 1ä¸­æ‰§è¡ŒGCè¿‡ç¨‹ã€‚å¦‚åŒåœ¨generation 0ä¸­ä¸€æ ·ï¼Œä¸å†ä½¿ç”¨çš„å¯¹è±¡è¢«é‡Šæ”¾ï¼Œæ­£åœ¨è¢«ä½¿ç”¨çš„å¯¹è±¡è¢«æ•´ç†å¹¶ç§»å…¥ä¸‹ä¸€ä¸ªgenerationä¸­ã€‚å¤§éƒ¨åˆ†GCè¿‡ç¨‹çš„ä¸»è¦ç›®æ ‡æ˜¯generation 0ï¼Œå› ä¸ºåœ¨generation 0ä¸­æœ€ä¼˜å¯èƒ½å­˜åœ¨å¤§é‡çš„å·²ä¸å†ä½¿ç”¨çš„ä¸´æ—¶å¯¹è±¡ã€‚å¯¹generation 2çš„å›æ”¶è¿‡ç¨‹å…·æœ‰å¾ˆé«˜çš„å¼€é”€ï¼Œå¹¶ä¸”æ­¤è¿‡ç¨‹åªæœ‰åœ¨generation 0å’Œgeneration 1çš„GCè¿‡ç¨‹ä¸èƒ½é‡Šæ”¾è¶³å¤Ÿçš„å†…å­˜æ—¶æ‰ä¼šè¢«è§¦å‘ã€‚å¦‚æœå¯¹generation 2çš„GCè¿‡ç¨‹ä»ç„¶ä¸èƒ½é‡Šæ”¾è¶³å¤Ÿçš„å†…å­˜ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±ä¼šæŠ›å‡ºOutOfMemoryExceptionå¼‚å¸¸ã€‚å¸¦æœ‰ç»ˆæ­¢æ“ä½œçš„å¯¹è±¡çš„åƒåœ¾æ”¶é›†è¿‡ç¨‹è¦ç¨å¾®å¤æ‚ä¸€äº›ã€‚å½“ä¸€ä¸ªå¸¦æœ‰ç»ˆæ­¢æ“ä½œçš„å¯¹è±¡è¢«æ ‡è®°ä¸ºåƒåœ¾æ—¶ï¼Œå®ƒå¹¶ä¸ä¼šè¢«ç«‹å³é‡Šæ”¾ã€‚ç›¸åï¼Œå®ƒä¼šè¢«æ”¾ç½®ä¸€ä¸ªç»ˆæ­¢é˜Ÿåˆ—ï¼ˆfinalizetion queueï¼‰ä¸­ï¼Œæ­¤é˜Ÿåˆ—ä¸ºè¿™ä¸ªå¯¹è±¡å»ºç«‹ä¸€ä¸ªå¼•ç”¨ï¼Œæ¥é¿å…è¿™ä¸ªå¯¹è±¡è¢«å›æ”¶ã€‚åå°çº¿ç¨‹ä¸ºé˜Ÿåˆ—ä¸­çš„æ¯ä¸ªå¯¹è±¡æ‰§è¡Œå®ƒä»¬å„è‡ªçš„ç»ˆæ­¢æ“ä½œï¼Œå¹¶ä¸”å°†å·²ç»æ‰§è¡Œè¿‡ç»ˆæ­¢æ“ä½œçš„å¯¹è±¡ä»ç»ˆæ­¢é˜Ÿåˆ—ä¸­åˆ é™¤ã€‚åªæœ‰é‚£äº›å·²ç»æ‰§è¡Œè¿‡ç»ˆæ­¢æ“ä½œçš„å¯¹è±¡æ‰ä¼šåœ¨ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶è¿‡ç¨‹ä¸­è¢«å†…å­˜ä¸­åˆ é™¤ã€‚è¿™æ ·åšçš„ä¸€ä¸ªåæœæ˜¯ï¼Œç­‰å¾…è¢«ç»ˆæ­¢çš„å¯¹è±¡æœ‰å¯èƒ½åœ¨å®ƒè¢«æ¸…é™¤ä¹‹å‰ï¼Œè¢«ç§»å…¥æ›´é«˜ä¸€çº§çš„generationä¸­ï¼Œä»è€Œå¢åŠ å®ƒè¢«æ¸…é™¤çš„å»¶è¿Ÿæ—¶é—´ã€‚éœ€è¦æ‰§è¡Œç»ˆæ­¢æ“ä½œçš„å¯¹è±¡åº”å½“äº‹å…ˆIDisposableæ¥å£ï¼Œä»¥ä¾¿ç¨‹åºé€šè¿‡æ­¤æ¥å£å¿«é€Ÿæ‰§è¡Œç»ˆæ­¢åŠ¨ä½œã€‚IDisposableæ¥å£åŒ…å«ä¸€ä¸ªDisposeæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•è¢«ç”¨æ¥é‡Šæ”¾å¤–éƒ¨èµ„æºå¹¶æŠ‘åˆ¶ç»ˆæ­¢æ“ä½œã€‚123456789101112131415161718public class OverdueBookLocator:IDisposable&#123; ~OverdueBookLocator() &#123; InternalDispose(false); &#125; public void Dispose() &#123; InternalDispose(true); &#125; protected void InternalDispose(bool disposing) &#123; if (disposing) &#123; GC.SuppressFinalize(this); &#125; &#125;&#125; æ ˆå’Œæ‰˜ç®¡å †é€šç”¨ç±»å‹ç³»ç»Ÿï¼ˆCTSï¼‰åŒºåˆ†ä¸¤ç§åŸºæœ¬ç±»å‹ï¼šå€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹ã€‚å®ƒä»¬ä¹‹é—´çš„æ ¹æœ¬åŒºåˆ«åœ¨äºå®ƒä»¬åœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ–¹å¼ã€‚.NETä½¿ç”¨ä¸¤ç§ä¸åŒçš„ç‰©ç†å†…å­˜æ¥å­˜å‚¨æ•°æ®æ ˆå’Œæ‰˜ç®¡å †å€¼ç±»å‹æ€»æ˜¯å†…å­˜ä¸­å ç”¨ä¸€ä¸ªé¢„å®šä¹‰çš„å­—èŠ‚æ•°ï¼ˆä¾‹å¦‚ï¼Œintç±»å‹å 4ä¸ªå­—èŠ‚ï¼Œè€Œstringç±»å‹å ç”¨çš„å­—èŠ‚æ•°ä¼šæ ¹æ®å­—ç¬¦ä¸²çš„é•¿åº¦è€Œä¸åŒï¼‰ã€‚å½“å£°æ˜ä¸€ä¸ªå€¼ç±»å‹å˜é‡æ—¶ï¼Œä¼šåœ¨æ ˆä¸­åˆ†é…é€‚å½“å¤§å°çš„å†…å­˜ï¼ˆé™¤äº†å¼•ç”¨ç±»å‹çš„å€¼ç±»å‹æˆå‘˜å¤–ï¼Œå¦‚ç±»çš„intå­—æ®µï¼‰ã€‚å†…å­˜ä¸­çš„è¿™ä¸ªç©ºé—´ç”¨æ¥å­˜å‚¨å˜é‡æ‰€åŒ…å«çš„å€¼ã€‚.NETç»´æŠ¤ä¸€ä¸ªæ ˆæŒ‡é’ˆï¼Œå®ƒåŒ…å«æ ˆä¸­ä¸‹ä¸€ä¸ªå¯ç”¨çš„å†…å­˜ç©ºé—´çš„åœ°å€ã€‚å½“ä¸€ä¸ªå˜é‡ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œæ ˆæŒ‡é’ˆæŒ‡å‘ä¸‹ç§»åŠ¨è¢«é‡Šæ”¾å˜é‡æ‰€å ç”¨çš„å­—èŠ‚æ•°ã€‚æ‰€ä»¥å®ƒä»æŒ‡å‘ä¸‹ä¸€ä¸ªå¯ç”¨åœ°å€ã€‚å¼•ç”¨å˜é‡ä¹Ÿåˆ©ç”¨æ ˆï¼Œä½†è¿™æ—¶å€™æ ˆåŒ…å«çš„åªæ˜¯å¯¹å¦ä¸€ä¸ªå†…å­˜ä½ç½®çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯å®é™…å€¼ã€‚è¿™ä¸ªä½ç½®æ˜¯æ‰˜ç®¡å †ä¸­çš„ä¸€ä¸ªåœ°å€ï¼Œå’Œæ ˆä¸€æ ·ï¼Œä»–ä¹Ÿç»´æŠ¤ä¸€ä¸ªæŒ‡é’ˆï¼ŒåŒ…å«å †ä¸­ä¸‹ä¸€ä¸ªå¯ç”¨çš„å†…å­˜åœ°å€ã€‚ä½†æ˜¯ï¼Œå †ä¸æ˜¯å…ˆå…¥åå‡ºçš„ï¼Œå› ä¸ºå¯¹å¯¹è±¡çš„å¼•ç”¨å¯åœ¨æˆ‘ä»¬çš„ç¨‹åºä¸­ä¼ é€’ï¼ˆä¾‹å¦‚ï¼Œä½œä¸ºå‚æ•°ä¼ é€’ç»™æ–¹æ³•è°ƒç”¨ï¼‰ã€‚å †ä¸­çš„å¯¹è±¡ä¸ä¼šåœ¨ç¨‹åºçš„ä¸€ä¸ªé¢„å®šç‚¹ç¦»å¼€ä½œç”¨åŸŸã€‚ä¸ºäº†åœ¨ä¸é€‚ç”¨åœ¨å †ä¸­åˆ†é…çš„å†…å­˜æ—¶å°†å®ƒé‡Šæ”¾ã€‚.NETå®šæœŸæ‰§è¡Œåƒåœ¾å›æ”¶å™¨ï¼Œåƒåœ¾åƒåœ¾é€’å½’æ£€æŸ¥åº”ç”¨ç¨‹åºä¸­æ‰€æœ‰å¯¹è±¡çš„å¼•ç”¨ã€‚å¼•ç”¨ä¸å†æœ‰æ•ˆçš„å¯¹è±¡ä½¿ç”¨çš„å†…å­˜æ— æ³•ä»ç¨‹åºä¸­è®¿é—®ï¼Œè¯¥å†…å­˜å°±å¯ä»¥å›æ”¶ã€‚ ç±»å‹å±‚æ¬¡ç»“æ„CTSå®šä¹‰äº†ä¸€ç§ç±»å‹å±‚çº§ç»“æ„ï¼Œè¯¥ç»“æ„ä¸ä»…ä»…æè¿°äº†ä¸åŒé¢„å®šä¹‰ç±»å‹ï¼Œè¿˜æŒ‡å‡ºäº†ç”¨æˆ·å®šä¹‰ç±»å‹çš„å±‚æ¬¡ç»“æ„çš„ä½ç½®ã€‚ æšä¸¾å¯ä»¥å®šä¹‰é™¤Charä»¥å¤–çš„æ‰€æœ‰æ•´æ•°ç±»å‹ï¼Œé»˜è®¤ç±»å‹æ˜¯int123456enum Color : byte&#123; Red, Green, Blue,&#125;; readonlyä¸constreadonlyæ˜¯è¿è¡Œæ—¶å¸¸é‡ï¼Œç¨‹åºè¿è¡Œæ—¶è¿›è¡Œèµ‹å€¼ï¼Œèµ‹å€¼å®Œä¹‹åæ— æ³•æ›´æ”¹ï¼Œä¹Ÿè¢«ç§°ä¸ºåªè¯»å˜é‡ã€‚constè¡¨ç¤ºç¼–è¯‘æ—¶å¸¸é‡ï¼Œç¨‹åºç¼–è¯‘æ—¶å°†å¯¹å¸¸é‡å€¼è¿›è¡Œè§£æï¼Œå¹¶å°†æ‰€æœ‰å¸¸é‡å€¼å¼•ç”¨æ›¿æ¢ä¸ºç›¸åº”å€¼ã€‚ using è¯­å¥æä¾›å¯ç¡®ä¿æ­£ç¡®ä½¿ç”¨IDisposableå¯¹è±¡çš„æ–¹ä¾¿è¯­æ³•ã€‚ ç¤ºä¾‹1234using (Font font1 = new Font("Arial", 10.0f))&#123; byte charset = font1.GdiCharSet;&#125; å¤‡æ³¨Fileå’ŒFontæ˜¯è®¿é—®éæ‰˜ç®¡èµ„æºï¼ˆæœ¬ä¾‹ä¸­ä¸ºæ–‡ä»¶å¥æŸ„å’Œè®¾å¤‡ä¸Šä¸‹æ–‡ï¼‰çš„æ‰˜ç®¡ç±»å‹çš„ç¤ºä¾‹ã€‚æœ‰è®¸å¤šå…¶ä»–ç±»åˆ«çš„éæ‰˜ç®¡èµ„æºå’Œå°è£…è¿™äº›èµ„æºçš„ç±»åº“ç±»å‹ã€‚æ‰€æœ‰æ­¤ç±»å‹éƒ½å¿…é¡»å®ç°IDisposableæ¥å£ã€‚IDisposableå¯¹è±¡çš„ç”Ÿå­˜æœŸé™äºå•ä¸ªæ–¹æ³•æ—¶ï¼Œåº”åœ¨usingè¯­å¥ä¸­å£°æ˜å¹¶å®ä¾‹åŒ–å®ƒã€‚usingè¯­å¥æŒ‰ç…§æ­£ç¡®çš„æ–¹å¼è°ƒç”¨å¯¹è±¡ä¸Šçš„Disposeæ–¹æ³•ï¼Œå¹¶ï¼ˆåœ¨æŒ‰ç…§å‰é¢æ‰€ç¤ºæ–¹å¼ä½¿ç”¨å®ƒæ—¶ï¼‰ä¼šå¯¼è‡´åœ¨è°ƒç”¨Disposeæ—¶å¯¹è±¡è‡ªèº«å¤„äºèŒƒå›´ä¹‹å¤–ã€‚åœ¨usingå—ä¸­ï¼Œå¯¹è±¡æ˜¯åªè¯»çš„å¹¶ä¸”æ— æ³•è¿›è¡Œä¿®æ”¹æˆ–é‡æ–°åˆ†é…ã€‚ usingè¯­å¥å¯ç¡®ä¿è°ƒç”¨Disposeï¼Œå³ä½¿usingå—ä¸­å‘ç”Ÿå¼‚å¸¸ä¹Ÿæ˜¯å¦‚æ­¤ã€‚é€šè¿‡å°†å¯¹è±¡æ”¾å…¥tryå—ä¸­ï¼Œç„¶åè°ƒç”¨finallyå—ä¸­çš„Disposeï¼Œå¯ä»¥å®ç°ç›¸åŒçš„ç»“æœï¼›å®é™…ä¸Šï¼Œè¿™å°±æ˜¯ç¼–è¯‘å™¨è½¬æ¢usingè¯­å¥çš„æ–¹å¼ã€‚å‰é¢çš„ä»£ç ç¤ºä¾‹åœ¨ç¼–è¯‘æ—¶å°†æ‰©å±•åˆ°ä»¥ä¸‹ä»£ç ï¼ˆè¯·æ³¨æ„ï¼Œä½¿ç”¨é¢å¤–çš„å¤§æ‹¬å·ä¸ºå¯¹è±¡åˆ›å»ºæœ‰é™èŒƒå›´ï¼‰ï¼›123456789101112&#123; Font font1 = new Font("Arial", 10.0f); try &#123; byte charset = font1.GdiCharSet; &#125; finally &#123; if (font1 != null) ((IDsiposable)font1).Dispose(); &#125;&#125; å¯åœ¨usingè¯­å¥ä¸­å£°æ˜ä¸€ä¸ªç±»å‹çš„å¤šä¸ªå®ä¾‹ï¼Œå¦‚ä¸‹é¢çš„ç¤ºä¾‹ä¸­æ‰€ç¤ºï¼š1234using (Font font3 = new Font("Arial", 10.0f), font4 = new Font("Arial", 10.0f))&#123; // Use font3 and font4.&#125; å¯ä»¥åœ¨å®ä¾‹åŒ–èµ„æºå¯¹è±¡ï¼Œç„¶åå°†å˜é‡ä¼ é€’åˆ°usingè¯­å¥ï¼Œä½†è¿™ä¸æ˜¯æœ€ä½³åšæ³•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ§ä»¶é€€å‡ºusingå—ä»¥åï¼Œå¯¹è±¡ä¿ç•™åœ¨ä½œç”¨åŸŸä¸­ï¼Œä½†æ˜¯å¯èƒ½æ²¡æœ‰è®¿é—®å…¶æœªæ‰˜ç®¡èµ„æºçš„åŠé™ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒä¸å†æ˜¯å®Œå…¨åˆå§‹åŒ–çš„ã€‚å¦‚æœå°è¯•åœ¨usingå—å¤–éƒ¨ä½¿ç”¨è¯¥å¯¹è±¡ï¼Œåˆ™å¯èƒ½å¯¼è‡´å¼•å‘å¼‚å¸¸ã€‚å› æ­¤ï¼Œé€šå¸¸æœ€å¥½åœ¨usingè¯­å¥ä¸­å®ä¾‹åŒ–è¯¥å¯¹è±¡å¹¶å°†å…¶èŒƒå›´é™åˆ¶åœ¨usingå—ä¸­ã€‚12345678Font font2 = new Font("Arial", 10.0f);using (font2) // not recommended&#123; // use font2&#125;// font2 is still in scope// but the method call throws an exceptionfloat f = font2.GetHeight();]]></content>
      <categories>
        <category>CSharp</category>
      </categories>
      <tags>
        <tag>CSharp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[xxsy-sence-merge-render]]></title>
    <url>%2F2018%2F04%2F02%2Fxxsy-sence-merge-render%2F</url>
    <content type="text"></content>
  </entry>
  <entry>
    <title><![CDATA[PJ04]]></title>
    <url>%2F2018%2F04%2F02%2Fxxsy-skill%2F</url>
    <content type="text"><![CDATA[normal_logic Index Type Data1 Data2 Data3 Data4 Data5 1 éšæœºç§»åŠ¨ 2 å›ºå®šçº¿è·¯ 3 è·Ÿéšé€»è¾‘ 4 ææƒ§é€»è¾‘ 5 é£è¡Œé€»è¾‘ 6 7 8 æ€ªç‰©é—²èŠ talk_list.id èµ·å§‹å»¶è¿Ÿæ—¶é—´ é—´éš”æ—¶é—´ 9 å® ç‰©è·Ÿéš 20 æ€ªç‰©è¾¹èŠè¾¹èµ° refresh_table ç‰©ä½“id åˆ·æ–°æ–¹å¼ cha_list.id 0æ‰‹åŠ¨1åˆ·ä¸€æ¬¡2æ­»äº¡å¤åˆ3æ¡ä»¶ talk_list äº‹ä»¶ç±»å‹ äº‹ä»¶id 4ï¼Œé©¾äº‘/ç¬ç§» trans_cmn.id]]></content>
      <tags>
        <tag>Pj04</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[OpenGL]]></title>
    <url>%2F2018%2F04%2F01%2Fopengl%2F</url>
    <content type="text"><![CDATA[æ ¸å¿ƒæ¨¡å¼å’Œç«‹å³æ¸²æŸ“æ¨¡å¼æ—©æœŸçš„OpenGLä½¿ç”¨ç«‹å³æ¸²æŸ“æ¨¡å¼ï¼ˆImmediate modeï¼Œä¹Ÿå°±æ˜¯å›ºå®šæ¸²æŸ“ç®¡çº¿ï¼‰ï¼Œç«‹å³æ¸²æŸ“æ¨¡å¼å®¹æ˜“ä½¿ç”¨å’Œç†è§£ï¼Œä½†æ˜¯æ•ˆç‡å¤ªä½ã€‚å› æ­¤ä»OpenGL3.2å¼€å§‹ï¼Œè§„èŒƒæ–‡æ¡£å¼€å§‹åºŸå¼ƒç«‹å³æ¸²æŸ“æ¨¡å¼ï¼Œæ¨å‡ºæ ¸å¿ƒæ¨¡å¼(Core-profile)ï¼Œè¿™ä¸ªæ¨¡å¼å®Œå…¨ç§»é™¤äº†æ—§çš„ç‰¹æ€§ã€‚ çŠ¶æ€æœºOpenGLè‡ªèº«æ˜¯ä¸€ä¸ªå·¨å¤§çš„çŠ¶æ€æœº(State Machine)ï¼šä¸€ç³»åˆ—çš„å˜è„¸æè¿°OpenGLæ­¤åˆ»åº”å½“å¦‚ä½•è¿è¡Œã€‚ é¢œè‰²ç¼“å†²åŒºé¢œè‰²ç¼“å†²åŒºï¼ˆCOLOR_BUFFERï¼‰å°±æ˜¯å¸§ç¼“å†²åŒºï¼ˆFRAME_BUFFERï¼‰ï¼Œä½ éœ€è¦æ¸²æŸ“çš„åœºæ™¯æœ€ç»ˆæ¯ä¸€ä¸ªåƒç´ éƒ½è¦å†™å…¥è¯¥ç¼“å†²åŒºï¼Œç„¶åç”±å®ƒæ¸²æŸ“åˆ°å±å¹•ä¸Šæ˜¾ç¤ºã€‚ æ·±åº¦ç¼“å†²åŒºæ·±åº¦ç¼“å†²åŒºï¼ˆDEPTH_BUFFERï¼‰ä¸å¸§ç¼“å†²åŒºå¯¹åº”ï¼Œç”¨äºè®°å½•ä¸Šé¢æ¯ä¸ªåƒç´ çš„æ·±åº¦å€¼ï¼Œé€šè¿‡æ·±åº¦ç¼“å†²åŒºï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œæ·±åº¦æµ‹è¯•ï¼Œä»è€Œç¡®å®šåƒç´ çš„é®æŒ¡å…³ç³»ï¼Œä¿è¯æ¸²æŸ“æ­£ç¡®ã€‚ æ¨¡ç‰ˆç¼“å†²åŒºæ¨¡ç‰ˆç¼“å†²åŒºï¼ˆSTENCIL_BUFFERï¼‰ä¸æ·±åº¦ç¼“å†²å¤§å°ç›¸åŒï¼Œé€šè¿‡è®¾ç½®æ¨¡ç‰ˆç¼“å†²æ¯ä¸ªåƒç´ çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šåœ¨æ¸²æŸ“çš„æ—¶å€™åªæ¸²æŸ“æŸäº›åƒç´ ï¼Œä»è€Œå¯ä»¥è¾¾åˆ°ä¸€äº›ç‰¹æ®Šçš„æ•ˆæœã€‚ Texture Wrappingé€šå¸¸ï¼Œçº¹ç†åæ ‡çš„èŒƒå›´åœ¨(0,0)åˆ°(1,1)ä¹‹é—´ï¼Œä½†æ˜¯å‡å¦‚æˆ‘ä»¬åˆ¶å®šçš„åæ ‡åœ¨è¿™ä¹‹å¤–å‘¢ï¼ŸOpenGLä¼šå¦‚ä½•åšå‡ºååº”ï¼Ÿé»˜è®¤æƒ…å†µä¸‹ï¼ŒOpenGLä¼šé‡å¤ç»˜åˆ¶çº¹ç†å›¾ï¼Œä¸è¿‡ï¼ŒOpenGLä¹Ÿæä¾›äº†æ›´å¤šçš„é€‰æ‹©æ–¹æ¡ˆï¼š GL_REPEATï¼šé»˜è®¤æ–¹æ¡ˆï¼Œé‡å¤çº¹ç†å›¾ç‰‡ GL_MIRRORED_REPEATï¼šç±»ä¼¼äºé»˜è®¤æ–¹æ³•ï¼Œä¸è¿‡æ¯æ¬¡é‡å¤çš„æ—¶å€™è¿›è¡Œé•œåƒé‡å¤ã€‚ GL_CLAMP_TP_EDGEï¼šå°†åæ ‡é™åˆ¶åœ¨0åˆ°1ä¹‹é—´ã€‚è¶…å‡ºçš„åæ ‡ä¼šé‡å¤ç»˜åˆ¶è¾¹ç¼˜çš„åƒç´ ï¼Œå˜æˆä¸€ç§æ‰©å±•è¾¹ç¼˜çš„å›¾æ¡ˆã€‚ GL_CLAMP_TO_BORDERï¼šè¶…å‡ºçš„åæ ‡å°†ä¼šè¢«ç»˜åˆ¶æˆç”¨æˆ·æŒ‡å®šçš„è¾¹ç•Œé¢œè‰²]]></content>
      <tags>
        <tag>OpenGL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ•°æ®ç»“æ„ä¸ç®—æ³•]]></title>
    <url>%2F2018%2F03%2F29%2FRed-Black-Tree%2F</url>
    <content type="text"><![CDATA[çº¢é»‘æ ‘çº¢é»‘æ ‘æ˜¯ä¸€ç§è‡ªå¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ã€‚ æ€§è´¨1.èŠ‚ç‚¹æ˜¯çº¢è‰²æˆ–é»‘è‰²ã€‚2.æ ¹èŠ‚ç‚¹æ˜¯é»‘è‰²3.æ¯ä¸ªå¶èŠ‚ç‚¹ï¼ˆNILæˆ–ç©ºèŠ‚ç‚¹ï¼‰æ˜¯é»‘è‰²4.æ¯ä¸ªçº¢è‰²èŠ‚ç‚¹çš„ä¸¤ä¸ªå­èŠ‚ç‚¹éƒ½æ˜¯é»‘è‰²çš„ï¼ˆä¹Ÿå°±æ˜¯è¯´ä¸å­˜åœ¨ä¸¤ä¸ªè¿ç»­çš„çº¢è‰²èŠ‚ç‚¹ï¼‰ï¼›5.ä»ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹åˆ°å…¶å¶å­èŠ‚ç‚¹éƒ½åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘è‰²èŠ‚ç‚¹ï¼› AVLæ ‘æ€§è´¨1.æœ¬èº«é¦–å…ˆæ˜¯ä¸€æ£µäºŒå‰æœç´¢æ ‘2.å¸¦æœ‰å¹³è¡¡æ¡ä»¶ï¼šæ¯ä¸ªèŠ‚ç‚¹çš„å·¦å³å­æ ‘çš„é«˜åº¦ä¹‹å·®çš„ç»å¯¹å€¼ï¼ˆå¹³è¡¡å› å­ï¼‰æœ€å¤šä¸º1. èŠ‚ç‚¹æ•°STLå’ŒLinuxéƒ½ä½¿ç”¨çº¢é»‘æ ‘ä½œä¸ºå¹³è¡¡æ ‘çš„å®ç°1.å¦‚æœæ’å…¥ä¸€ä¸ªnodeå¼•èµ·äº†æ ‘çš„ä¸å¹³è¡¡ï¼ŒAVLå’ŒRB-Treeéƒ½æ˜¯æœ€å¤šåªéœ€è¦2æ¬¡æ—‹è½¬æ“ä½œï¼Œå³ä¸¤è€…éƒ½æ˜¯O(1)ï¼›ä½†æ˜¯åœ¨åˆ é™¤nodeå¼•èµ·æ ‘çš„ä¸å¹³è¡¡æ—¶ï¼Œæœ€åæƒ…å†µä¸‹ï¼ŒAVLéœ€è¦ç»´æŠ¤ä»è¢«åˆ nodeåˆ°rootè¿™æ¡è·¯å¾„ä¸Šæ‰€æœ‰nodeçš„å¹³è¡¡æ€§ï¼Œå› æ­¤éœ€è¦æ—‹è½¬çš„ä¸¤çº§O(logN)ï¼Œè€ŒRB-Treeæœ€å¤šåªéœ€è¦3æ¬¡æ—‹è½¬ï¼Œåªéœ€è¦O(1)çš„å¤æ‚åº¦ã€‚2.å…¶æ¬¡ï¼ŒAVLçš„ç»“æ„ç›¸è¾ƒRB-Treeæ¥è¯´æ›´ä¸ºå¹³è¡¡ï¼Œåœ¨æ’å…¥å’Œåˆ é™¤nodeæ›´å®¹æ˜“å¼•èµ·Treeçš„unbalanceï¼Œå› æ­¤åœ¨å¤§é‡æ•°æ®éœ€è¦æ’å…¥æˆ–åˆ é™¤æ—¶ï¼ŒAVLéœ€è¦rebalanceçš„é¢‘ç‡ä¼šæ›´é«˜ã€‚å› æ­¤ï¼ŒRB-Treeåœ¨éœ€è¦å¤§é‡æ’å…¥å’Œåˆ é™¤nodeçš„åœºæ™¯ä¸‹ï¼Œæ•ˆç‡æ›´é«˜ã€‚è‡ªç„¶ï¼Œç”±äºAVLé«˜åº¦å¹³è¡¡ï¼Œå› æ­¤AVLçš„searchæ•ˆç‡æ›´é«˜ã€‚3.mapçš„å®ç°åªæ˜¯æŠ˜è¡·äº†ä¸¤è€…åœ¨searchã€insertä»¥åŠdeleteä¸‹çš„æ•ˆç‡ã€‚æ€»ä½“æ¥è¯´ï¼ŒRB-treeçš„ç»Ÿè®¡è¡Œèƒ½æ˜¯é«˜äºAVLçš„ã€‚ äºŒå‰æŸ¥æ‰¾æ ‘å®šä¹‰1.è‹¥å·¦å­æ ‘ä¸ç©ºï¼Œåˆ™å·¦å­æ ‘æ‰€æœ‰èŠ‚ç‚¹çš„å€¼å‡å°äºæˆ–ç­‰äºå®ƒçš„æ ¹èŠ‚ç‚¹çš„å€¼ï¼›2.è‹¥å³å­æ ‘ä¸ç©ºï¼Œåˆ™å³å­æ ‘æ‰€æœ‰èŠ‚ç‚¹çš„å€¼å‡å¤§äºæˆ–ç­‰äºå®ƒçš„æ ¹èŠ‚ç‚¹çš„å€¼ï¼›3.å·¦ã€å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æ’åºæ ‘ï¼› æŸ¥æ‰¾æ­¥éª¤ï¼šè‹¥æ ¹èŠ‚ç‚¹çš„å…³é”®å­—å€¼ç­‰äºæŸ¥æ‰¾çš„å…³é”®å­—ï¼ŒæˆåŠŸã€‚å¦åˆ™ï¼Œè‹¥å°äºæ ¹èŠ‚ç‚¹çš„å…³é”®å­—å€¼ï¼Œé€’å½’æŸ¥å·¦å­æ ‘ã€‚P(n)=O(logn) éé€’å½’éå†å‰åºéé€’å½’éå†123456789101112131415161718192021222324252627282930void preorder_traversal_iteratively(TreeNode* root)&#123; if (root == 0) &#123; return; &#125; stack&lt;TreeNode*&gt; s; s.push(root); cout &lt;&lt; root-&gt;val &lt;&lt; ' '; TreeNode* last_pop = root; while (!s.empty()) &#123; TreeNode* top = s.top(); if (top-&gt;left != 0 &amp;&amp; top-&gt;left != last_pop &amp;&amp; top-&gt;right != last_pop) &#123; s.push(top-&gt;left); cout &gt;&gt; top-&gt;left-&gt;val &lt;&lt; ' '; &#125; else if (top-&gt;right != 0 &amp;&amp; top-&gt;right != last_pop &amp;&amp; (top-&gt;left == 0 || top-&gt;left == last_pop)) &#123; s.push(top-&gt;right); cout &gt;&gt; top-&gt;right-&gt;val &lt;&lt; ' '; &#125; else &#123; s.pop(); last_pop = top; &#125; &#125;&#125; Hash(æ•£åˆ—å‡½æ•°)ç»™å®šMï¼Œå­˜åœ¨å‡½æ•°f(key)ï¼Œå¯¹ä»»æ„ç»™å®šç»™å®šçš„å…³é”®å­—keyï¼Œä»£å…¥å‡½æ•°åšè‹¥èƒ½å¾—åˆ°åŒ…å«è¯¥å…³é”®å­—çš„è®°å½•åœ¨è¡¨ä¸­çš„åœ°å€ï¼Œåˆ™ç§°è¡¨Mä¸ºå“ˆå¸Œ(Hash)è¡¨ï¼Œå‡½æ•°(key)ä¸ºå“ˆå¸Œ(Hash)å‡½æ•°ã€‚å¦‚æœkeyä¸ç›¸åŒï¼Œä½†æ˜¯f(k1)=f(k2),è¿™ç§ç°è±¡æˆä¸ºç¢°æ’(Collision) å“ˆå¸Œå‡½æ•°1.ç›´æ¥å¯»å€å‘ï¼šå–å…³é”®å­—æˆ–å…³é”®å­—çš„æŸä¸ªçº¿æ€§å‡½æ•°å€¼ä¸ºæ•£åˆ—åœ°å€ã€‚å³H(key)=keyæˆ–H(key) = a * key + b,å…¶ä¸­aå’Œbä¸ºå¸¸ç†Ÿï¼ˆè¿™ç§æ•£åˆ—å‡½æ•°å«åšè‡ªèº«å‡½æ•°ï¼‰ã€‚]]></content>
      <tags>
        <tag>æ•°æ®ç»“æ„ä¸ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Objective-C]]></title>
    <url>%2F2018%2F03%2F24%2FObjective-C%2F</url>
    <content type="text"><![CDATA[Objective-C: Cçš„è¶…é›†Objective-Cæ˜¯Cè¯­è¨€çš„ä¸¥æ ¼è¶…é›†â€”ä»»ä½•Cè¯­è¨€ä¸ç»ä¿®æ”¹å¯ä»¥ç›´æ¥é€šè¿‡Objective-Cç¼–è¯‘å™¨ Objective-Cä»£ç æ–‡ä»¶çš„æ‰©å±•å.h å¤´æ–‡ä»¶.m æºä»£ç æ–‡ä»¶ï¼ŒåŒ…å«Objective-Cå’ŒCä»£ç .mm æºä»£ç æ–‡ä»¶ï¼ŒåŒ…å«Objective-Cã€Cã€C++ä»£ç ï¼Œä»…åœ¨ä½ çš„Objective-Cä»£ç ä¸­ç¡®å®éœ€è¦ä½¿ç”¨C++ç±»æˆ–è€…ç‰¹æ€§çš„æ—¶å€™é‡‡ç”¨è¿™ç§æ‰©å±•å å½“ä½ éœ€è¦åœ¨æºä»£ç ä¸­åŒ…å«å¤´æ–‡ä»¶çš„æ—¶å€™ï¼Œä½ å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„#includeç¼–è¯‘é€‰é¡¹ï¼Œä½†æ˜¯Objective-Cæä¾›äº†æ›´å¥½çš„æ–¹æ³•ã€‚#importé€‰é¡¹å’Œ#includeé€‰é¡¹å®Œå…¨ç›¸åŒï¼Œåªæ˜¯å®ƒå¯ä»¥ç¡®ä¿ç›¸åŒçš„æ–‡ä»¶åªä¼šè¢«åŒ…å«ä¸€æ¬¡ã€‚Objective-Cçš„ä¾‹å­å’Œæ–‡æ¡£éƒ½å€¾å‘äºä½¿ç”¨#importã€‚ è¯­æ³•C++è°ƒç”¨æ–¹æ³• obj.method(argument); Objective-Cè°ƒç”¨æ–¹æ³• [obj method: argument]; ç±»å£°æ˜æ€»æ˜¯ç”±@interfaceç¼–è¯‘é€‰é¡¹å¼€å§‹ï¼Œç”±@endé€‰é¡¹ç»“æŸã€‚ 123456789101112@interface MyObject: NSObject&#123; int memberVar1; // å®ä½“å˜é‡ id &#125;+(return_type) class_method; //ç±»æ–¹æ³•-(return_type) instance_method1; //å®ä¾‹æ–¹æ³•-(void)fbSendInviteByID: (NSDictionary*)info&#123;&#125;@end æ–¹æ³•å‰é¢+/-å·ä»£è¡¨å‡½æ•°çš„ç±»å‹ï¼šåŠ å·(+)ä»£è¡¨ç±»æ–¹æ³•(class method),ä¸éœ€è¦å®ä¾‹å°±å¯ä»¥è°ƒç”¨ï¼Œä¸C++çš„é™æ€å‡½æ•°(static member function)ç›¸ä¼¼ã€‚å‡å·(-)å³æ˜¯ä¸€èˆ¬çš„å®ä¾‹æ–¹æ³•(instance method)1-(void)setColorToRed: (float)red Green: () pragma mark]]></content>
  </entry>
  <entry>
    <title><![CDATA[Unityçƒ­æ›´æ–°æ–¹æ¡ˆ-ILRuntime]]></title>
    <url>%2F2018%2F03%2F23%2FUnity-ILRuntime%2F</url>
    <content type="text"><![CDATA[ILRuntimeçš„ä¼˜åŠ¿åŒå¸‚é¢ä¸Šçš„å…¶ä»–çƒ­æ›´æ–¹æ¡ˆç›¸æ¯”ï¼ŒILRuntimeä¸»è¦æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š æ— ç¼è®¿é—®C#å·¥ç¨‹çš„çº¿ç¨‹ä»£ç ï¼Œæ— éœ€é¢å¤–æŠ½è±¡è„šæœ¬API ç›´æ¥ä½¿ç”¨VS2015è¿›è¡Œå¼€å‘ï¼ŒILRuntimeçš„è§£é‡Šç¼–è¯‘å¼•æ“æ”¯æŒ.Net 4.6ç¼–è¯‘çš„DLL æ‰§è¡Œæ•ˆç‡æ˜¯L#çš„10-20å€ é€‰æ‹©æ€§çš„CLRç»‘å®šä½¿è·¨åŸŸè°ƒç”¨æ›´å¿«é€Ÿï¼Œç»‘å®šåè·¨åŸŸè°ƒç”¨çš„æ€§èƒ½èƒ½è¾¾åˆ°sluaçš„2å€å·¦å³(ä»è„šæœ¬è°ƒç”¨GameObjectä¹‹ç±»çš„æ¥å£) æ”¯æŒè·¨åŸŸé›†æˆ å®Œæ•´çš„æ³›å‹æ”¯æŒ æ‹¥æœ‰Vs2015è°ƒè¯•æ’ä»¶ï¼Œå¯ä»¥å®ç°çœŸæœºæºç çº§è°ƒè¯•(WIP) https://github.com/Ourpalm/ILRuntimehttps://ourpalm.github.io/ILRuntime/public/v1/guide/tutorial.html å¦‚æœä½ å¸Œæœ›åœ¨Unityä¸­ä½¿ç”¨ILRuntime,æ¨èçš„æ–¹å¼æ˜¯ç›´æ¥ä½¿ç”¨ILRuntimeæºä»£ç ï¼Œè¿™æ ·ILRuntimeå¯ä»¥æ ¹æ®ä½ çš„å‘å¸ƒè®¾ç½®è‡ªåŠ¨è¿›è¡Œä¼˜åŒ–ã€‚ ä½ éœ€è¦å°†ä¸‹åˆ—æºä»£ç ç›®å½•å¤åˆ¶åˆ°Unityå·¥ç¨‹çš„Assetsç›®å½•ï¼š Mono.Cecil.20 Mono.Cecil.Pdb ILRuntime éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œéœ€è¦åˆ é™¤è¿™äº›ç›®å½•é‡Œé¢çš„binã€objã€Propertieså­ç›®å½•ï¼Œä»¥åŠ.csprojæ–‡ä»¶ã€‚æ­¤å¤–ç”±äºILRuntimeä½¿ç”¨äº†unsafeä»£ç æ¥ä¼˜åŒ–æ‰§è¡Œæ•ˆç‡ï¼Œæ‰€ä»¥ä½ éœ€è¦åœ¨Unityä¸­å¼€å¯unsafeæ¨¡å¼ï¼š åœ¨Assetsç›®å½•é‡Œå»ºç«‹ä¸€ä¸ªåä¸ºsmcs.rspçš„æ–‡æœ¬æ–‡ä»¶ åœ¨smcs.rspæ–‡ä»¶ä¸­å‡å¦‚-unsafe å¦‚æœä½ ä½¿ç”¨çš„æ˜¯Unity5.4åŠä»¥å‰çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨çš„ç¼–è¯‘è®¾ç½®æ˜¯.Net 2.0è€Œä¸æ˜¯.Net 2.0 Subsetçš„è¯ï¼Œä½ éœ€è¦å°†ä¸Šè¿°è¯´æ˜ä¸­çš„smcs.rspæ–‡ä»¶åæ”¹ä¸ºgmcs.rspã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯Unity5.5ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œä½ éœ€è¦å°†ä¸Šè¿°è¯´æ˜çš„smcs.rspæ–‡ä»¶åæ”¹ä¸ºmcs.rsp ä»Visual Studioå¼€å§‹å¦‚æœä½ å¸Œæœ›åœ¨VisiualStudioçš„C#é¡¹ç›®ä¸­ä½¿ç”¨ILRuntimeï¼Œä½ åªéœ€è¦å¼•ç”¨ç¼–è¯‘å¥½çš„ILRuntime.dll,Mono.Cecil.20.dllä»¥åŠMono.Cecil.Pdbå³å¯ã€‚ ä½¿ç”¨ä¹‹å‰ILRuntimeé¡¹ç›®æä¾›äº†ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹å·¥ç¨‹ILRuntimeTest,ç”¨æ¥éªŒè¯ILRuntimeçš„æ­£å¸¸è¿è¡Œï¼Œåœ¨è¿è¡Œæµ‹è¯•ç”¨ä¾‹å‰ï¼Œéœ€è¦æ‰‹åŠ¨ç”Ÿæˆä¸€ä¸‹TestCasesé‡Œé¢çš„å·¥ç¨‹ï¼Œç”ŸæˆDLLæ–‡ä»¶ã€‚]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Skinned MeshåŸç†è§£æ]]></title>
    <url>%2F2018%2F03%2F23%2FUnity-Skinned-Mesh%2F</url>
    <content type="text"><![CDATA[ä¸€ã€3Dæ¨¡å‹åŠ¨ç”»åŸºæœ¬åŸç†å’Œåˆ†ç±»3Dæ¨¡å‹åŠ¨ç”»çš„åŸºæœ¬åŸç†æ˜¯è®©æ¨¡å‹ä¸­å„å®šç‚¹çš„ä½ç½®éšæ—¶é—´å˜åŒ–ã€‚ä¸»è¦ç§ç±»ç”±MorphåŠ¨ç”»ï¼Œå…³èŠ‚åŠ¨ç”»å’Œéª¨éª¼è’™çš®åŠ¨ç”»(Skinned Mesh)ã€‚ä»åŠ¨ç”»æ•°æ®çš„è§’åº¦æ¥è¯´ï¼Œä¸‰è€…ä¸€èˆ¬éƒ½é‡‡ç”¨å…³é”®å¸§æŠ€æœ¯ï¼Œå³åªç»™å‡ºå…³é”®å¸§çš„æ•°æ®ï¼Œå…¶ä»–å¸§çš„æ•°æ®ä½¿ç”¨æ’å€¼å¾—åˆ°ã€‚ä½†ç”±äºè¿™ä¸‰ç§æŠ€æœ¯çš„ä¸åŒï¼Œå…³é”®å¸§çš„æ•°æ®æ˜¯ä¸ä¸€æ ·çš„ã€‚ Morph(æ¸å˜ï¼Œå˜å½¢)åŠ¨ç”»æ˜¯ç›´æ¥æŒ‡å®šåŠ¨ç”»æ¯ä¸€å¸§çš„é¡¶ç‚¹ä½ç½®ï¼Œå…¶åŠ¨ç”»å…³é”®ä¸­å­˜å‚¨çš„æ˜¯Meshæ‰€æœ‰é¡¶ç‚¹åœ¨å…³é”®å¸§å¯¹åº”æ—¶åˆ»çš„ä½ç½®ã€‚ å…³èŠ‚åŠ¨ç”»çš„æ¨¡å‹ä¸æ˜¯ä¸€ä¸ªæ•´ä½“çš„Meshï¼Œè€Œæ˜¯åˆ†æˆå¾ˆå¤šéƒ¨åˆ†(Mesh),é€šè¿‡ä¸€ä¸ªçˆ¶å­å±‚çº§ç»“æ„å°†è¿™äº›åˆ†æ•£çš„Meshç»„ç»‡åœ¨ä¸€èµ·ï¼Œçˆ¶Meshå¸¦åŠ¨å…¶å­Meshè¿åŠ¨ï¼Œå„meshä¸­çš„é¡¶ç‚¹åæ ‡å®šä¹‰åœ¨è‡ªå·±çš„åæ ‡ç³»ä¸­ï¼Œè¿™æ ·å„ä¸ªMeshæ˜¯ä½œä¸ºä¸€ä¸ªæ•´ä½“å‚ä¸è¿åŠ¨çš„ã€‚åŠ¨ç”»å¸§ä¸­è®¾ç½®å„å­Meshç›¸å¯¹äºMeshçš„å˜åŒ–ï¼ˆä¸»è¦æ˜¯æ—‹è½¬ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åŒ…æ‹¬ç§»åŠ¨å’Œç¼©æ”¾ï¼‰ï¼Œé€šè¿‡å­åˆ°çˆ¶ï¼Œä¸€çº§çº§çš„å˜åŒ–ç´¯åŠ ï¼ˆå½“ç„¶ä»æŠ€æœ¯ä¸Šï¼Œå¦‚æœæ˜¯çŸ©é˜µæ“ä½œæ˜¯ç´¯ä¹˜ï¼‰å¾—åˆ°è¯¥Meshåœ¨æ•´ä¸ªåŠ¨ç”»æ¨¡å‹æ‰€åœ¨çš„åæ ‡ç©ºé—´ä¸­çš„å˜æ¢ï¼ˆä»æœ¬æ–‡çš„è§†è§’æ¥è¯´å°±æ˜¯ä¸–ç•Œåæ ‡ç³»äº†ï¼Œä¸‹åŒï¼‰ï¼Œä»è€Œç¡®å®šæ¯ä¸ªMeshåœ¨ä¸–ç•Œåæ ‡ç³»ä¸­çš„ä½ç½®å’Œæ–¹å‘ï¼Œç„¶åä»¥Meshä¸ºå•ä½æ¸²æŸ“å³å¯ã€‚å…³èŠ‚åŠ¨ç”»çš„é—®é¢˜æ˜¯ï¼Œå„éƒ¨åˆ†Meshä¸­çš„é¡¶ç‚¹æ—¶å›ºå®šåœ¨å…¶Meshåæ ‡ç³»ä¸­çš„ï¼Œè¿™æ ·åœ¨ä¸¤ä¸ªmeshç»“åˆå¤„å°±å¯èƒ½äº§ç”Ÿè£‚ç¼ã€‚ ç¬¬ä¸‰ç±»å°±æ˜¯éª¨éª¼è’™çš®åŠ¨ç”»å³Skinned Meshäº†ï¼Œéª¨éª¼è’™çš®åŠ¨ç”»çš„å‡ºç°è§£å†³äº†å…³èŠ‚åŠ¨ç”»çš„è£‚ç¼é—®é¢˜ï¼Œè€Œä¸”æ•ˆæœéå¸¸é…·ï¼Œéª¨éª¼åŠ¨ç”»çš„åŸºæœ¬åŸç†å¯æ¦‚æ‹¬ä¸ºï¼šåœ¨éª¨éª¼æ§åˆ¶ä¸‹ï¼Œé€šè¿‡é¡¶ç‚¹æ··åˆåŠ¨æ€è®¡ç®—è’™çš®ç½‘æ ¼çš„é¡¶ç‚¹ï¼Œè€Œéª¨éª¼çš„è¿åŠ¨ç›¸å¯¹äºå…¶çˆ¶éª¨éª¼ï¼Œå¹¶ç”±åŠ¨ç”»å…³é”®å¸§æ•°æ®é©±åŠ¨ã€‚ä¸€ä¸ªéª¨éª¼åŠ¨ç”»é€šå¸¸åŒ…æ‹¬éª¨éª¼å±‚æ¬¡ç»“æ„æ•°æ®ï¼Œç½‘æ ¼(Mesh)æ•°æ®ï¼Œç½‘æ ¼è’™çš®æ•°æ®(skin info)å’Œéª¨éª¼çš„åŠ¨ç”»(å…³é”®å¸§)æ•°æ®ã€‚ äºŒã€Skinned Mesh åŸç†å’Œç»“æ„åˆ†æSkinned Meshä¸­æ–‡ä¸€èˆ¬ä¹˜åéª¨éª¼è’™çš®åŠ¨ç”»ï¼Œè¿™ç§åŠ¨ç”»åŒ…å«éª¨éª¼(Bone)å’Œè’™çš®(Skinned Mesh)ä¸¤ä¸ªéƒ¨åˆ†ï¼ŒBoneçš„å±‚æ¬¡ç»“æ„å’Œå…³èŠ‚åŠ¨ç”»ç±»ä¼¼ï¼ŒMeshåˆ™å’Œå…³èŠ‚åŠ¨ç”»ä¸åŒï¼šå…³èŠ‚åŠ¨ç”»ä¸­æ—¶ä½¿ç”¨å¤šä¸ªåˆ†æ•£çš„Mesh,è€ŒSkinned Meshä¸­çš„Meshæ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰ä¸€ä¸ªmesh,å®é™…ä¸Šå¦‚æœæ²¡æœ‰éª¨éª¼è®©Meshè¿åŠ¨å˜å½¢ï¼ŒMeshå°±å’Œé™æ€æ¨¡å‹ä¸€æ ·äº†ï¼ŒSkinned MeshæŠ€æœ¯çš„ç²¾ååœ¨äºè’™çš®ï¼Œæ‰€è°“çš„çš®å¹¶ä¸æ˜¯æ¨¡å‹çš„è´´å›¾ï¼Œè€Œæ˜¯meshæœ¬èº«ï¼Œè’™çš®æ˜¯å°†meshä¸­çš„é¡¶ç‚¹é™„ç€ï¼ˆç»‘å®šï¼‰åœ¨éª¨éª¼ä¹‹ä¸Šï¼Œè€Œä¸”æ¯ä¸ªé¡¶ç‚¹å¯ä»¥è¢«å¤šä¸ªéª¨éª¼æ‰€æ§åˆ¶ï¼Œè¿™æ ·çš„å…³èŠ‚å¤„çš„é¡¶ç‚¹ç”±äºåŒæ—¶æ”¶åˆ°äº†çˆ¶å­éª¨éª¼çš„æ‹‰æ‰¯è€Œæ”¹å˜ä½ç½®å°±æ¶ˆé™¤äº†è£‚ç¼ã€‚ 1.ç†è§£éª¨éª¼å’Œéª¨éª¼å±‚æ¬¡ç»“æ„(Bone Hierarchy)é¦–å…ˆè¦æ˜ç¡®ä¸€ä¸ªè§‚å¿µï¼šéª¨éª¼å†³å®šäº†æ¨¡å‹æ•´ä½“åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­çš„ä½ç½®å’Œæœå‘ã€‚å…ˆçœ‹çœ‹é™æ€æ¨¡å‹å§ï¼Œé™æ€æ¨¡å‹æ²¡æœ‰éª¨éª¼ï¼Œæˆ‘ä»¬åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­æ”¾ç½®é™æ€æ¨¡å‹æ—¶ï¼Œåªè¦æŒ‡å®šæ¨¡å‹è‡ªèº«åæ ‡ç³»åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­çš„ä½ç½®å’Œæœå‘ã€‚åœ¨éª¨éª¼åŠ¨ç”»ä¸­ï¼Œä¸æ˜¯æŠŠMeshç›´æ¥æ”¾åˆ°ä¸–ç•Œåæ ‡ç³»ä¸­ï¼ŒMeshåªæ˜¯ä½œä¸ºSkinä½¿ç”¨çš„ï¼Œæ˜¯ä¾é™„éª¨éª¼çš„ï¼ŒçœŸæ­£å†³å®šæ¨¡å‹åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­çš„ä½ç½®å’Œæœå‘çš„æ˜¯éª¨éª¼ã€‚åœ¨æ¸²æŸ“é™æ€æ¨¡å‹æ—¶ï¼Œç”±äºæ¨¡å‹çš„é¡¶ç‚¹éƒ½æ˜¯å®šä¹‰åœ¨æ¨¡å‹åæ ‡ç³»ä¸­çš„ï¼Œæ‰€ä»¥å„é¡¶ç‚¹åªè¦ç»è¿‡æ¨¡å‹åæ ‡ç³»åˆ°ä¸–ç•Œåæ ‡ç³»çš„å˜æ¢å°±å¯ä»¥è¿›è¡Œæ¸²æŸ“ã€‚è€Œå¯¹äºéª¨éª¼åŠ¨ç”»ï¼Œè®¾ç½®æ¨¡å‹çš„ä½ç½®å’Œæœå‘ï¼Œå®é™…å®åœ¨è®¾ç½®æ ¹éª¨éª¼çš„ä½ç½®å’Œæœå‘ï¼Œç„¶åæ ¹æ®éª¨éª¼å±‚çº§ç»“æ„ä¸­çˆ¶å­éª¨éª¼ä¹‹é—´çš„å˜æ¢å…³ç³»è®¡ç®—å‡ºå„ä¸ªéª¨éª¼çš„ä½ç½®å’Œæœå‘ï¼Œç„¶åæ ¹æ®éª¨éª¼å †Meshä¸­é¡¶ç‚¹çš„ç»‘å®šè®¡ç®—å‡ºé¡¶ç‚¹åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­çš„åæ ‡ï¼Œä»è€Œå †é¡¶ç‚¹è¿›è¡Œæ¸²æŸ“ï¼Œè¦è®°ä½ï¼Œåœ¨éª¨éª¼åŠ¨ç”»ä¸­ï¼Œéª¨éª¼æ‰æ˜¯æ¨¡å‹ä¸»é¢˜ï¼ŒMeshä¸è¿‡æ˜¯ä¸€å±‚çš®ï¼Œä¸€ä»¶è¡£æœã€‚å¦‚ä½•ç†è§£éª¨éª¼ï¼Ÿè¯·çœ‹ç¬¬äºŒä¸ªç®¡å¨˜ï¼šéª¨éª¼å¯ç†è§£ä¸ºä¸€ä¸ªåæ ‡ç©ºé—´ã€‚åœ¨ä¸€äº›æ–‡ç« ä¸­å¾€å¾€ä¼šæåˆ°å…³èŠ‚å’Œéª¨éª¼ï¼Œé‚£ä¹ˆå…³èŠ‚æ˜¯ä»€ä¹ˆï¼Ÿéª¨éª¼æœ‰äº‹ä»€ä¹ˆï¼Ÿä¸‹å›¾æ˜¯ä¸€ä¸ªæ‰‹è‡‚çš„éª¨éª¼å±‚æ¬¡çš„å®ä¾‹ã€‚éª¨éª¼åªæ˜¯ä¸€ä¸ªå½¢è±¡çš„è¯´æ³•ï¼Œå®é™…ä¸Šéª¨éª¼å¯ç†è§£ä¸ºä¸€ä¸ªåæ ‡ç©ºé—´ï¼Œå…³èŠ‚å¯ç†è§£ä¸ºéª¨éª¼åæ ‡ç©ºé—´çš„è¿œç‚¹ã€‚å…³èŠ‚çš„ä½ç½®ç”±å®ƒåœ¨çˆ¶éª¨éª¼åæ ‡ç©ºé—´ä¸­æè¿°ï¼Œä¸Šå›¾ä¸­ç”±ä¸‰å—éª¨éª¼ï¼Œåˆ†åˆ«æ˜¯æ‰‹è‡‚ï¼Œå‰è‡‚å’Œä¸¤ä¸ªæ‰‹æŒ‡ã€‚Clavicle(éª¨é”)æ˜¯ä¸€ä¸ªå…³èŠ‚ï¼Œå®ƒæ˜¯ä¸Šè‡‚çš„åŸç‚¹ï¼ŒåŒæ ·è‚˜å…³èŠ‚(elbow joint)æ˜¯å‰è‡‚çš„åŸç‚¹ï¼Œè…•å…³èŠ‚(wrist)æ˜¯æ‰‹æŒ‡éª¨éª¼çš„è¿œç‚¹ã€‚å…³èŠ‚æ—¢å†³å®šäº†éª¨éª¼ç©ºé—´çš„ä½ç½®ï¼Œæ—‹è½¬å’Œç¼©æ”¾åˆ†é‡å†³å®šäº†éª¨éª¼ç©ºé—´çš„æ—‹è½¬å’Œç¼©æ”¾ã€‚æˆ‘ä»¬æ¥çœ‹å‰è‡‚è¿™ä¸ªéª¨éª¼ï¼Œå…¶åŸç‚¹ä½ç½®ä½äºä¸Šè‡‚ä¸ŠæŸå¤„çš„ï¼Œå¯¹äºä¸Šè‡‚æ¥è¯´ï¼Œå®ƒçŸ¥é“è‡ªå·±çš„åæ ‡ç©ºé—´æŸå¤„(å³è‚˜å…³èŠ‚æ‰€åœ¨çš„ä½ç½®)æœ‰ä¸€ä¸ªå­ç©ºé—´ï¼Œé‚£å°±æ˜¯å‰è‡‚ï¼Œè‡³äºå‰è‡‚é‡Œé¢æ˜¯å•¥å°±ä¸è€ƒè™‘äº†ã€‚å½“å‰è‡‚ç»•è‚˜å…³èŠ‚æ—‹è½¬æ—¶ï¼Œå®é™…æ˜¯å‰è‡‚åæ ‡ç©ºé—´åœ¨æ—‹è½¬ï¼Œä»è€Œå…¶ä¸­åŒ…å«çš„å­ç©ºé—´ä¹Ÿåœ¨ç»•è‚˜å…³èŠ‚æ—‹è½¬ï¼Œè¿™ä¸ªä¾‹å­ä¸­æ˜¯fingeréª¨éª¼ã€‚å’Œå®é™…ç”Ÿç‰©éª¨éª¼ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬è¿™é‡Œçš„éª¨éª¼å¹¶æ²¡æœ‰å®è´¨çš„éª¨å¤´ï¼Œæ‰€ä»¥å‰è‡‚æ—‹è½¬æ—¶ï¼Œä»–è‡ªå·±æ²¡å•¥å¯è½¬çš„ï¼Œæ”¹å˜çš„åªæ˜¯åæ ‡ç©ºé—´çš„æœå‘ã€‚ä½ å¯ä»¥è¯´ä¸Šå›¾è“çº¿åœ¨è½¬ï¼Œä½†å®é™…è“çº¿å¹¶ä¸å­˜åœ¨ï¼Œè“çº¿åªæ˜¯ç”»ä¸Šå»è¡¨ç¤ºéª¨éª¼ä¹‹é—´å…³ç³»çš„ï¼ŒçœŸæ­£è½¬çš„æ˜¯éª¨éª¼ç©ºé—´ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°åœ¨è½¬çš„æ˜¯wrist joint,ä¹Ÿå°±æ˜¯ä¸¤ä¸ªfingeréª¨éª¼çš„åæ ‡ç©ºé—´ï¼Œå› ä¸ºä»–ä»¬æ˜¯å­ç©ºé—´ï¼Œä¼šè·Ÿéšçˆ¶ç©ºé—´è¿åŠ¨ï¼Œå°±å¥½æ¯”è·Ÿç€åœ°çƒè½¬ä¸€æ ·ã€‚ éª¨éª¼å°±æ˜¯åæ ‡ç©ºé—´ï¼Œéª¨éª¼å±‚æ¬¡å°±æ˜¯åµŒå¥—çš„åæ ‡ç©ºé—´ã€‚å…³èŠ‚åªæ˜¯æè¿°éª¨éª¼çš„ä½ç½®å³éª¨éª¼è‡ªå·±çš„åæ ‡ç©ºé—´åŸç‚¹å†å…¶çˆ¶ç©ºé—´ä¸­çš„ä½ç½®ï¼Œç»•å…³èŠ‚æ—‹è½¬æ˜¯æŒ‡éª¨éª¼åæ ‡ç©ºé—´(åŒ…æ‹¬æ‰€æœ‰å­ç©ºé—´)è‡ªèº«çš„æ—‹è½¬ã€‚ä½†è¿˜æœ‰ä¸¤ä¸ªå¯èƒ½çš„ç–‘é—®ï¼Œä¸€æ˜¯éª¨éª¼çš„é•¿åº¦ï¼Œç”±äºéª¨éª¼æ˜¯åæ ‡ç©ºé—´æ²¡æœ‰æ‰€è°“çš„é•¿åº¦å’Œå®½åº¦é™åˆ¶ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„é•¿åº¦ä¸€æ–¹é¢æ˜¯è’™çš®åçš„ç»“æœï¼Œè€Œå¦ä¸€æ–¹é¢å­éª¨éª¼çš„åŸç‚¹(ä¹Ÿå°±æ˜¯å…³èŠ‚)çš„ä½ç½®å¾€å¾€å†³å®šäº†è§†è§‰ä¸Šçˆ¶éª¨éª¼çš„é•¿åº¦ï¼Œæ¯”å¦‚è¿™é‡Œupper armçº¿æ®µçš„é•¿åº¦å®é™…æ˜¯ç”±elbow jointçš„ä½ç½®å†³å®šçš„ã€‚ç¬¬äºŒä¸ªé—®é¢˜ï¼Œå®é™…ä¸Šæˆ‘ä»¬çš„ä¾‹å­ä¸­æ‰‹æŒ‡æ²¡æœ‰å­éª¨éª¼ï¼Œæ‰€ä»¥é‚£ä¸ªç«¯ç‚¹å¹¶ä¸å­˜åœ¨ï¼Œé‚£æ˜¯ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºç”»ä¸Šå»çš„ã€‚å®é™…é—®é¢˜ä¸­æ€»æœ‰æœ€ä¸‹å±‚çš„éª¨éª¼ï¼Œä»–ä»¬ä¸èƒ½å†³å®šå…¶ä»–éª¨éª¼äº†ï¼Œä»–ä»¬çš„ä½œç”¨åªå‰©ä¸‹æ§åˆ¶Meshé¡¶ç‚¹äº†ã€‚å¯¹äº†ï¼Œé‚£ä¹ˆæ‰‹æŒ‡çš„é•¿åº¦å¦‚ä½•ç¡®å®šï¼Ÿæˆ‘ä»¬çœ‹åˆ°çš„é•¿åº¦åº”è¯¥æ˜¯æ‰‹æŒ‡éƒ¨åˆ†çš„é¡¶ç‚¹å’Œè’™çš®å†³å®šçš„ï¼Œä¹Ÿå°±æ˜¯ç”±Meshä¸­å±äºæ‰‹æŒ‡çš„é‚£äº›ç‚¹ç¦»è…•å…³èŠ‚çš„è·ç¦»å†³å®šã€‚ ç»è¿‡ä¸€æ®µé•¿ç¯‡å¤§è®ºï¼Œæˆ‘ä»¬ç»ˆäºå¼„æ¸…æ¥šéª¨éª¼å’Œéª¨éª¼å±‚æ¬¡ç»“æ„äº†ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¦å°†éª¨éª¼ç»„ç»‡æˆå±‚æ¬¡ç»“æ„å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä¸ºäº†åšåŠ¨ç”»æ–¹ä¾¿ï¼Œè®¾æƒ³å¦‚æœåªæœ‰ä¸€å—éª¨éª¼ï¼Œé‚£ä¹ˆè®©ä»–åŠ¨èµ·æ¥å¤ªç®€å•äº†ï¼ŒåŠ¨ç”»æ¯ä¸€å¸§ç›´æ¥æŒ‡å®šä»–çš„ä½ç½®å³å¯ï¼Œå¦‚æœæ˜¯nå—å‘¢ï¼Ÿé€šè¿‡ç»„æˆä¸€ä¸ªå±‚æ¬¡ç»“æ„ï¼Œå°±å¯ä»¥é€šè¿‡çˆ¶éª¨éª¼æ§åˆ¶å­éª¨éª¼çš„è¿åŠ¨ï¼Œç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ï¼Œæ”¹å˜æŸéª¨éª¼æ—¶å¹¶ä¸éœ€è¦è®¾ç½®å…¶å­éª¨éª¼çš„ä½ç½®ï¼Œå­éª¨éª¼çš„ä½ç½®ä¼šé€šè¿‡è®¡ç®—è‡ªåŠ¨å¾—åˆ°ï¼Œä¸Šé—®å·²ç»è¯´è¿‡ï¼Œçˆ¶å­éª¨éª¼ä¹‹é—´çš„å…³ç³»å¯ä»¥ç†è§£ä¸ºï¼Œå­éª¨éª¼ä½äºçˆ¶éª¨éª¼çš„åæ ‡ç³»ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ç‰©ä½“åœ¨åæ ‡ç³»ä¸­å¯ä»¥å¹³ç§»å˜æ¢ï¼Œä»¥åŠè‡ªèº«çš„æ—‹è½¬å’Œç¼©æ”¾ã€‚å­éª¨éª¼åœ¨çˆ¶éª¨éª¼çš„åæ ‡ç³»ä¸­ä¹Ÿå¯ä»¥åšè¿™äº›å˜æ¢æ¥æ”¹å˜è‡ªå·±åœ¨å…¶çˆ¶éª¨éª¼åæ ‡ç³»ä¸­çš„ä½ç½®å’Œæœå‘ç­‰ï¼Œé‚£ä¹ˆå¦‚ä½•è¡¨ç¤ºå‘¢ï¼Ÿç”±äº4x4çŸ©é˜µå¯ä»¥åŒæ—¶è¡¨ç¤ºä¸Šè¿°ä¸‰ç§å˜æ¢ï¼Œæ‰€ä»¥ä¸€èˆ¬æè¿°éª¨éª¼åœ¨å…¶çˆ¶éª¨éª¼åæ ‡ç³»æ—¶ä½¿ç”¨ä¸€ä¸ªä¸¾è¯ï¼Œä¹Ÿå°±æ˜¯DirectX SkinnedMeshä¸­çš„FramrTrnsformMatrixã€‚å®é™…ä¸Šè¿™ä¸æ˜¯å”¯ä¸€çš„æ–¹æ³•ï¼Œä½†åº”è¯¥æ˜¯å…¬è®¤çš„æ–¹æ³•å› ä¸ºçŸ©é˜µä¸å…‰å¯ä»¥åŒæ—¶è¡¨ç¤ºå¤šç§å˜æ¢è¿˜å¯ä»¥æ–¹ä¾¿çš„é€šè¿‡è¿ä¹˜è¿›è¡Œå˜æ¢çš„ç»„åˆï¼Œè¿™åœ¨å±‚æ¬¡ç»“æ„ä¸­éå¸¸æ–¹ä¾¿ã€‚åœ¨æœ¬æ–‡çš„ä¾‹å­-æœ€ç®€å•çš„skinned meshç¤ºä¾‹ä¸­ï¼Œæˆ‘åªæ¼”ç¤ºäº†è¯„è®®å˜æ¢ï¼Œæ‰€ä»¥åªç”¨ä¸€ä¸ª3dåæ ‡å°±å¯ä»¥è¡¨ç¤ºå­éª¨éª¼åœ¨çˆ¶éª¨éª¼çš„ä½ç½®ã€‚ä¸‹é¢æ˜¯Bone Classæœ€åˆçš„å®šä¹‰ï¼š12345class Bone&#123; public: float m_x, m_y, m_z;//è¿™ä¸ªåæ ‡æ˜¯å®šä¹‰åœ¨çˆ¶éª¨éª¼åæ ‡ç³»ä¸­&#125; åŒæ—¶å¢åŠ äº†ä¸€ç»„åæ ‡ï¼Œå­˜æ”¾è®¡ç®—å¥½çš„ä¸–ç•Œåæ ‡ç³»ã€‚å°†å„ä¸ªéª¨éª¼ç›¸å…³äºç›¸å¯¹äºçˆ¶éª¨éª¼æ‘†æ”¾å¥½ï¼Œå°±å½¢æˆäº†ä¸€ä¸ªéª¨éª¼å±‚æ¬¡ç»“æ„çš„åˆå§‹åæ ‡ï¼Œæ‰€è°“åˆå§‹æ˜¯æŒ‡å®šä¹‰éª¨éª¼å±‚æ¬¡æ—¶ï¼Œåæ¥åŠ¨ç”»æ”¹å˜äº†éª¨éª¼çš„ç›¸å¯¹ä½ç½®ï¼Œå‡†ç¡®çš„è¯´ä¸€èˆ¬æ˜¯æ”¹å˜äº†éª¨éª¼è‡ªèº«çš„æ—‹è½¬è€Œä½ç½®ä¿æŒä¸å˜ã€‚ å‡è®¾æˆ‘ä»¬é€šè¿‡æŸç§æ–¹æ³•å»ºç«‹äº†éª¨éª¼å±‚æ¬¡ç»“æ„ï¼Œé‚£ä¹ˆæ¯ä¸€å—éª¨éª¼çš„ä½ç½®éƒ½ä¾èµ–äºå…¶çˆ¶éª¨éª¼çš„ä½ç½®ï¼Œè€Œè·Ÿéª¨éª¼æ²¡æœ‰çˆ¶ï¼Œä»–çš„ä½ç½®å°±æ˜¯æ•´ä¸ªéª¨éª¼ä½“ç³»åœ¨ä¸–ç•Œåæ ‡ç³»ä¸­çš„ä½ç½®ã€‚å¯ä»¥è®¤ä¸ºrootçš„çˆ¶å°±æ˜¯ä¸–ç•Œåæ ‡ç³»ã€‚ä½†æ˜¯åˆå§‹ä½ç½®æ—¶ï¼Œè·Ÿéª¨éª¼ä¸€èˆ¬ä¸æ˜¯ä¸–ç•ŒåŸç‚¹çš„ï¼Œæ¯”å¦‚ä½¿ç”¨3d max character studioåˆ›å»ºçš„bipedéª¨æ¶æ—¶ï¼Œä¸€èˆ¬ä¸¤è„šä¹‹é—´æ—¶ä¸–ç•ŒåŸç‚¹ï¼Œè€Œæ ¹éª¨éª¼-éª¨ç›†ä½äºåŸç‚¹ä¸Šæ–¹(+zè½´ä¸Š)ã€‚è¿™æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Œå…¶å®ä¹Ÿæ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Œåªæ˜¯æˆ‘ä»¬åœ¨æŒ‡å®šéª¨éª¼åŠ¨ç”»æ¨¡å‹æ•´ä½“åæ ‡æ—¶ï¼Œæ¯”å¦‚è®¾å®šåæ ‡(0,0,0),åˆ™æ ¹éª¨éª¼-éª¨ç›†è¢«ç½®äºä¸–ç•ŒåŸç‚¹ï¼Œå‡å¦‚xyå¹³é¢æ—¶åœ°é¢ï¼Œé‚£ä¹ˆäººä¸‹ä¸ªèº«å­åˆ°åœ°é¢ä¸‹äº†ã€‚æˆ‘ä»¬æƒ³è®©ä¸¤è„šä¹‹é—´ç®—ä½œäººçš„åŸç‚¹ï¼Œè¿™æ ·è®¾å®š(0,0,0)çš„åæ ‡æ—¶äººå°±ç«™åœ¨åœ°é¢ä¸Šäº†ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ä¸¤è„šä¹‹é—´è®¾å®šä¸€ä¸ªé¢å¤–çš„æ ¹éª¨éª¼æ”¾åˆ°ä¸–ç•ŒåŸç‚¹ä¸Šï¼Œæˆ–è€…è¿™ä¸ªéª¨éª¼å¹¶ä¸éœ€è¦çœŸå®å­˜åœ¨ï¼Œåªæ˜¯åœ¨ä½ çš„éª¨éª¼æ¨¡å‹ç»“æ„ä¸­ä¿å­˜éª¨ç›†éª¨éª¼åˆ°ä¸–ç•ŒåŸç‚¹çš„å˜æ¢çŸ©é˜µã€‚åœ¨å¾®è½¯Xæ–‡ä»¶ä¸­ï¼Œä¸€èˆ¬æœ‰ä¸€ä¸ªScene_RootèŠ‚ç‚¹ï¼Œè¿™ç®—ä¸€ä¸ªé¢å¤–çš„éª¨éª¼å§ï¼Œä»–çš„å˜æ¢çŸ©é˜µä¸ºå•ä½é˜µï¼Œè¡¨ç¤ºä»–åˆå§‹ä½äºä¸–ç•ŒåŸç‚¹ï¼Œè€ŒçœŸæ­£éª¨éª¼çš„è·ŸBip01,ä½œä¸ºScene_rootçš„å­éª¨éª¼ï¼Œå…¶å˜æ¢çŸ©é˜µè¡¨ç¤ºç›¸å¯¹äºrootçš„ä½ç½®ã€‚è¯´è¿™ä¹ˆå¤šå…¶å®æˆ‘åªæ˜¯åƒè§£é‡Šä¸‹ï¼Œä¸ºä»€ä¹ˆè¦å­˜åœ¨Scenen_Rootè¿™ç§é¢å¤–çš„éª¨éª¼ï¼Œä»¥åŠåŠ æ·±ç†è§£éª¨éª¼å®šä½éª¨éª¼åŠ¨ç”»æ¨¡å‹æ•´ä½“çš„ä¸–ç•Œåæ ‡çš„ä½œç”¨ã€‚ æœ‰äº†éª¨éª¼ç±»ï¼Œç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å»ºç«‹éª¨éª¼å±‚æ¬¡çš„ä»£ç ï¼Œåœ¨bone classä¸­å¢åŠ ä¸€ä¸ªæ„é€ å‡½æ•°å’Œä¸¤ä¸ªæˆå‘˜å‡½æ•°ï¼š 1234567891011121314151617class Bone&#123;public: Bone(float x, float y, float z): m_pSibling(NULL),m_pFirstChild(NULL),m_pFather(NULL), m_x(x),m_y(y),m_z(z)&#123;&#125; void SetFirstChild(Bone *pChild) &#123; m_pFirstChild = pChild; m_pFirstChild-&gt;m_pFather = this; &#125; void SetSibling(Bone *pSibling) &#123; m_pSibling = pSibling; m_pSibling-&gt;m_pFather = m_pFather; &#125;&#125; æ³¨æ„æˆ‘å¢åŠ äº†ä¸€ä¸ªæˆå‘˜å˜é‡ï¼ŒBone* m_pFather,è¿™æ˜¯æŒ‡å‘çˆ¶éª¨éª¼çš„æŒ‡é’ˆï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­è®¡ç®—éª¨éª¼åŠ¨ç”»æ—¶æœ¬ä¸éœ€è¦è¿™ä¸ªæŒ‡é’ˆï¼Œä½†æˆ‘ä¸ºäº†ç”»ä¸€æ¡ä»çˆ¶éª¨éª¼å…³èŠ‚åˆ°å­éª¨éª¼å…³èŠ‚çš„è¿çº¿ï¼Œå¢åŠ äº†å®ƒï¼Œå› ä¸ºæ¯ä¸ªéª¨éª¼åªæœ‰ç¬¬ä¸€å­éª¨éª¼çš„æŒ‡é’ˆï¼Œç»˜åˆ¶çˆ¶éª¨éª¼æ—¶ä»çˆ¶åˆ°å­ç”»çº¿å°±åªèƒ½ç”»ä¸€æ¡ï¼Œæ‰€ä»¥è®°å½•æ¯ä¸ªéª¨éª¼çš„çˆ¶ï¼Œåœ¨èƒ¡å­hiå­éª¨éª¼æ—¶ç”»è¿™æ ¹çº¿ã€‚ æœ‰äº†è¿™ä¸ªå‡½æ•°ï¼Œå°±å¯ä»¥åˆ›å»ºéª¨éª¼å±‚æ¬¡äº†ï¼Œä¾‹å¦‚ï¼š1234567891011121314Bone * g_boneRoot;Bone * g_bone1, *g_bone32, *g_bone22;void buildBones()&#123; g_boneRoot = new Bone(0,0,0); g_bone1 = new Bone(0.1,0,0); g_bone21 = new Bone(0,0,0.1,0); g_bone22 = new Bone(0.1, 0.0,0); g_boneRoot-&gt;SetFirstChild(g_bone1); gbone1-&gt;SetFirstChild(g_bone21); g_bone21-&gt;SetSibling(g_bone22);&#125; æ¥ä¸‹æ¥æ˜¯éª¨éª¼å±‚æ¬¡ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œæ›´æ–°éª¨éª¼ï¼ç”±äºåŠ¨ç”»çš„ä½œç”¨ï¼ŒæŸä¸ªéª¨éª¼çš„å˜åŒ–(TransformMatrix)å˜äº†ï¼Œè¿™æ—¶å°±è¦æ ¹æ®æ–°çš„å˜åŒ–æ¥è®¡ç®—ï¼Œæ‰€ä»¥è¿™ä¸ªè¿‡ç¨‹ä¸€èˆ¬ä¹˜åUpdateBoneMatrixã€‚å› ä¸ºéª¨éª¼çš„å˜åŒ–éƒ½æ˜¯ç›¸å¯¹çˆ¶çš„ï¼Œè¦å˜æ¢é¡¶ç‚¹å¿…é¡»ä½¿ç”¨ä¸–ç•Œå˜æ¢çŸ©é˜µï¼Œæ‰€ä»¥è¿™ä¸ªè¿‡ç¨‹æ ¹æ®æ›´æ–°äº†æŸäº›éª¨éª¼çš„éª¨éª¼å˜æ¢çŸ©é˜µ(TransformMatrix)è®¡ç®—å‡ºæ‰€æœ‰éª¨éª¼çš„ä¸–ç•Œå˜æ¢çŸ©é˜µ(CombinedMatrix)ã€‚åœ¨æœ¬æ–‡çš„ä¾‹å­ä¸­ï¼Œéª¨éª¼åªèƒ½å¹³ç§»ï¼Œç”šè‡³æˆ‘ä»¬æ²¡æœ‰ç”¨çŸ©é˜µï¼Œæ‰€ä»¥å½“æœ‰éª¨éª¼å˜åŠ¨æ—¶è¦åšçš„åªæ˜¯ç›´æ¥è®¡ç®—éª¨éª¼çš„ä¸–ç•Œåæ ‡ï¼Œå› æ­¤å‡½æ•°å‘½åä¸ºComputeWorldPos,ç›¸å½“äºUpdateBoneMatrixåå†ç”¨é¡¶ç‚¹ç›¸ä¹˜CombinedMatrixã€‚123456789101112131415class Bone&#123; //give father's world pos, compute the bone's world pos void ComputeWorldPos(float fatherWX, float fatherWY, float WZ) &#123; m_wx = fatherWX + m_x; m_wy = fatherWY + m_y; m_wz = fatherWZ + m_z; if (m_pSibling != NULL) m_pSibling-&gt;ComputeWorldPos(fatherWX, fatherWY, fatherWZ); if (m_pFirstChild != NULL) m_pFirstChild-&gt;ComputreWorldPos(m_wx, m_wy, m_wz); &#125;&#125; å…¶ä¸­çš„é€’å½’è°ƒç”¨ä½¿ç”¨äº†å¾®è½¯ä¾‹å­çš„æ€æƒ³ã€‚ æœ‰äº†ä¸Šè¿°å‡½æ•°ï¼Œå½“æŸéª¨éª¼è¿åŠ¨æ—¶å°±å¯ä»¥è®©å…¶å­éª¨éª¼è·Ÿéšè¿åŠ¨äº†ï¼Œä½†æ˜¯æ€ä¹ˆè®©éª¨éª¼è¿åŠ¨å‘¢ï¼Ÿè¿™å°±æ˜¯åŠ¨ç”»é—®é¢˜äº†ï¼Œæˆ‘ä¸æ‰“ç®—åœ¨è¿™ä¸ªç®€å•çš„ä¾‹å­ä¸­ä½¿ç”¨å…³é”®å¸§åŠ¨ç”»ï¼Œè€Œåªæ˜¯é€šè¿‡ç¨‹åºæ¯å¸§æ”¹å˜æŸäº›éª¨éª¼çš„ä½ç½®ï¼ŒDEMOä¸­çš„animateBoneså°±æ˜¯åšè¿™ä¸ªçš„ï¼Œä½ å¯ä»¥åœ¨é‡Œé¢æ”¹å˜ä¸åŒçš„éª¨éª¼çœ‹çœ‹æ•ˆæœã€‚åœ¨æœ¬æ–‡ä¸‹é¢ä¼šå¯¹éª¨éª¼çš„å…³é”®å¸§åŠ¨ç”»åšç®€å•çš„è®¨è®ºã€‚ 2.è’™çš®ä¿¡æ¯å’Œè’™çš®è¿‡ç¨‹2-1 Skin infoçš„å®šä¹‰ä¸Šæ–‡æ›¾è®¨è®ºè¿‡ï¼ŒSkinned Meshä¸­Meshæ—¶ä½œä¸ºçš®è‚¤ä½¿ç”¨ï¼Œè’™åœ¨éª¨éª¼ä¹‹ä¸Šçš„ã€‚ä¸ºäº†è®©æ™®é€šçš„Meshå…·æœ‰è’™çš®çš„åŠŸèƒ½ï¼Œå¿…é¡»æ·»åŠ è’™çš®ä¿¡æ¯ï¼Œå³Skin infoã€‚æˆ‘ä»¬çŸ¥é“meshæ˜¯ç”±é¡¶ç‚¹æ„æˆçš„ï¼Œå»ºæ¨¡æ—¶é¡¶ç‚¹æ˜¯å®šä¹‰åœ¨æ¨¡å‹è‡ªèº«åæ ‡ç³»çš„ï¼Œå³ç›¸å¯¹äºMeshåŸç‚¹çš„ï¼Œè€Œéª¨éª¼åŠ¨ç”»ä¸­å†³å®šæ¨¡å‹é¡¶ç‚¹æœ€ç»ˆä¸–ç•Œåæ ‡çš„æ˜¯éª¨éª¼ï¼Œæ‰€ä»¥è¦è®©éª¨éª¼å†³å®šé¡¶ç‚¹çš„ä¸–ç•Œåæ ‡ï¼Œè¿™å°±è¦å°†é¡¶ç‚¹å’Œéª¨éª¼è”ç³»èµ·æ¥ï¼ŒSkin infoæ­£æ˜¯èµ·äº†è¿™ä¸ªä½œç”¨ã€‚ä¸‹é¢æ˜¯DEMOä¸­é¡¶ç‚¹ç±»çš„å®šä¹‰çš„ä»£ç ç‰‡æ®µï¼š 1234567891011#define MAX_BONE_PER_VERTEX 4class Vertex&#123; float m_x, m_y, m_z;//local pos in mesh space float m_wX, m_wY, m_wZ; // blended vertex pos, in world space // skin info int m_boneNum; Bone * m_bones[MAX_BONE_PER_VERTEX]; float m_boneWeights[MAX_BONE_PER_VERTEX];&#125; é¡¶ç‚¹çš„Skin infoåŒ…å«å½±å“è¯¥é¡¶ç‚¹çš„éª¨éª¼æ•°ç›®ï¼Œåªæƒ³è¿™äº›éª¨éª¼çš„æŒ‡é’ˆï¼Œè¿™äº›éª¨éª¼ä½œç”¨äºè¯¥é¡¶ç‚¹çš„æƒé‡(Skin weight)ã€‚ç”±äºåªæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œè¿™å„¿æ²¡æœ‰è€ƒè™‘ä¼˜åŒ–ï¼Œæ‰€ä»¥ç”¨é™æ€æ•°ç»„å­˜æ”¾éª¨éª¼æŒ‡é’ˆå’Œæƒé‡ï¼Œä¸”å®é™…å¼•æ“ä¸­Skin infoçš„å®šä¹‰æ–¹å¼ä¸ä¸€å®šæ˜¯è¿™æ ·çš„ï¼Œä½†åŸºæœ¬åŸç†ä¸€è‡´ã€‚ MAX_BONE_PER_VERTEXåœ¨è¿™å„¿ç”¨æ¥è®¾ç½®å¯åŒæ—¶å½±å“é¡¶ç‚¹çš„æœ€å¤§éª¨éª¼æ•°ï¼Œå®é™…ä¸Šç”±äºè¿™ä¸ªDEMOæ˜¯æ‰‹å·¥è¿›è¡ŒVertex Blendingå¹¶ä¸”æ²¡æœ‰ç¡¬ä»¶åŠ é€Ÿï¼Œä»¥åŠä¸ºäº†ç¡®ä¿é€Ÿåº¦ï¼Œä¸€èˆ¬ä¼šå®šä¹‰æœ€å¤§éª¨éª¼æ•°ã€‚å¦å¤–åœ¨æœ¬Demoä¸­ï¼ŒSkin infoæ˜¯æ‰‹å·¥è®¾å®šçš„ï¼Œè€Œå®é™…é¡¹ç›®ä¸­ï¼Œä¸€èˆ¬æ˜¯åœ¨å»ºæ¨¡è½¯ä»¶ä¸­ç”Ÿæˆè¿™äº›ä¿¡æ¯å¹¶å¯¼å‡ºã€‚ Skin info çš„ä½œç”¨æ˜¯ä½¿ç”¨å„ä¸ªéª¨éª¼çš„å˜æ¢çŸ©é˜µå¯¹é¡¶ç‚¹è¿›è¡Œå˜æ¢å¹¶ä¹˜ä»¥æƒé‡ï¼Œè¿™æ ·æŸå—éª¨éª¼åªèƒ½å¯¹è¯¥é¡¶ç‚¹äº§ç”Ÿéƒ¨åˆ†å½±å“ã€‚å„éª¨éª¼æƒé‡ä¹‹å’Œåº”è¯¥ä¸º1. Skin infoæ˜¯é’ˆå¯¹é¡¶ç‚¹çš„ï¼Œç„¶ååœ¨ä½¿ç”¨Skin infoå‰æˆ‘ä»¬å¿…é¡»è¦ä½¿ç”¨Bone Offset Matrixå¯¹é¡¶ç‚¹è¿›è¡Œå˜æ¢ï¼Œä¸‹é¢å…·ä½“è®¨è®ºBone offset Matrixã€‚ï¼ˆå†™ä¸‹è¿™å¥è¯çš„æ—¶å€™æˆ‘æ„Ÿè§‰ä¸å¦¥ï¼Œå› ä¸ºå®é™…æ˜¯å…ˆå°†æ‰€æœ‰çš„çŸ©é˜µç›¸ä¹˜æœ€ååœ¨ç”¨ä½œé¡¶ç‚¹ï¼Œè¿™å„¿æ˜¯æŒ‰ç…§ç†è®ºä¸Šçš„é¡ºåºè¿›è¡Œè®²è¿°å§ï¼Œè¯·ä¸è¦ä¸å®é™…æƒ…å†µæ··è‚´ï¼Œå…¶å®ä»–ä»¬ä¹Ÿå¹¶ä¸çŸ›ç›¾ã€‚è€Œä¸”åœ¨æˆ‘ä»¬çš„DEMOä¸­ç”±äºæ²¡æœ‰ä½¿ç”¨çŸ©é˜µï¼Œæ‰€ä»¥å˜æ¢çš„é¡ºåºå’Œç†è®ºé¡ºåºæ˜¯ä¸€è‡´çš„ï¼‰ 2-2 Bone Offset Matrixçš„å«ä¹‰å’Œè®¡ç®—æ–¹æ³•ä¸Šæ–‡å·²ç»è¯´è¿‡ï¼šâ€œéª¨éª¼åŠ¨ç”»ä¸­å†³å®šæ¨¡å‹é¡¶ç‚¹æœ€ç»ˆä¸–ç•Œåæ ‡çš„æ˜¯éª¨éª¼ï¼Œæ‰€ä»¥è¦è®©éª¨éª¼å†³å®šé¡¶ç‚¹çš„ä¸–ç•Œåæ ‡â€ï¼Œç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸‹é¡¶ç‚¹å—ä¸€å—éª¨éª¼çš„ä½œç”¨çš„åæ ‡å˜æ¢è¿‡ç¨‹ï¼š mesh vertex(defined in mesh space)â€”â€”&gt;Bone spaceâ€”â€”&gt;worldä»è¿™ä¸ªè¿‡ç¨‹ä¸­å¯ä»¥çœ‹å‡ºï¼Œéœ€è¦é¦–å…ˆå°†æ¨¡å‹é¡¶ç‚¹ä»æ¨¡å‹ç©ºé—´å˜æ¢åˆ°æŸå—éª¨éª¼è‡ªèº«çš„éª¨éª¼ç©ºé—´ï¼Œç„¶åæ‰èƒ½åˆ©ç”¨éª¨éª¼çš„ä¸–ç•Œå˜æ¢è®¡ç®—é¡¶ç‚¹çš„ä¸–ç•Œåæ ‡ã€‚Bone Offset Matrixçš„ä½œç”¨æ­£æ˜¯å°†æ¨¡å‹ä»é¡¶ç‚¹ç©ºé—´å˜æ¢åˆ°éª¨éª¼ç©ºé—´ã€‚é‚£ä¹ˆBone Offset Matrixå¦‚ä½•å¾—åˆ°å‘¢ï¼Ÿä¸‹é¢å…·ä½“åˆ†æï¼š Mesh spaceæ˜¯å»ºæ¨¡æ—¶ä½¿ç”¨çš„ç©ºé—´ï¼Œmeshä¸­é¡¶ç‚¹çš„ä½ç½®ç›¸å¯¹äºè¿™ä¸ªç©ºé—´çš„åŸç‚¹å®šä¹‰ã€‚æ¯”å¦‚åœ¨3dmaxä¸­å»ºæ¨¡æ—¶(è§†xyå¹³é¢ä¸ºåœ°é¢ï¼Œ+zæœä¸Š)ï¼Œå¯å°†æ¨¡å‹ä¸¤è„šä¹‹é—´çš„ä¸­ç‚¹ä½œä¸ºMeshç©ºé—´çš„åŸç‚¹ï¼Œå¹¶å°†å…¶æ”¾ç½®åœ¨ä¸–ç•ŒåŸç‚¹ï¼Œè¿™æ ·å·¦è„šä¸ŠæŸä¸€é¡¶ç‚¹åæ ‡æ˜¯(10,10,2),å³è„šä¸Šå †æˆçš„ä¸€ç‚¹åæ ‡æ˜¯(-10,10,2)ï¼Œå¤´é¡¶çš„åæ ‡æ˜¯(0,0,170)ã€‚ç”±äºæ­¤æ—¶Meshç©ºé—´å’Œä¸–ç•Œç©ºé—´é‡åˆï¼Œä¸Šè¿°åæ ‡å³åœ¨Meshç©ºé—´ä¹Ÿæ˜¯ä¸–ç•Œç©ºé—´ï¼Œæ¢å¥è¯è¯´ï¼Œæ­¤æ—¶å®é™…æ˜¯ä»¥ä¸–ç•Œç©ºé—´ä½œä¸ºMeshç©ºé—´äº†ã€‚åœ¨éª¨éª¼åŠ¨ç”»ä¸­ï¼Œåœ¨ä¸–ç•Œä¸­æ”¾ç½®çš„æ˜¯éª¨éª¼è€Œä¸æ˜¯Meshï¼Œæ‰€ä»¥è¿™ä¸ªåŒºåˆ«å¹¶ä¸é‡è¦ã€‚åœ¨3d maxä¸­æ·»åŠ éª¨éª¼çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯å°†éª¨éª¼æ”¾å…¥ä¸–ç•Œç©ºé—´ä¸­ï¼Œå¹¶è°ƒæ•´éª¨éª¼çš„ç›¸å¯¹ä½ç½®æ˜¯å¾—å’Œmeshç›¸å»åˆï¼ˆå³è®¾ç½®éª¨éª¼çš„TransformMatrix),å¾—åˆ°è‚¡ä»·çš„åˆå§‹å§¿åŠ¿ä»¥åŠç›¸åº”çš„Transform Matrix(æŒ‰æƒ¯ä¾‹æ¨¡å‹åšæˆä¸¤è‡‚ä¾§å¹³ä¸¾ç›´ç«‹ï¼Œéª¨éª¼ä¹Ÿè¦é€‚åˆè¿™ä¸ªå§¿æ€)ã€‚ç”±äºéª¨éª¼çš„Transform Matrix(ä½œç”¨æ˜¯å°†é¡¶ç‚¹ä»éª¨éª¼ç©ºé—´å˜æ¢åˆ°ä¸Šå±‚ç©ºé—´)æ˜¯åŸºäºå…¶çˆ¶éª¨éª¼ç©ºé—´çš„ï¼Œåªæœ‰æ ¹éª¨éª¼çš„Transformæ˜¯åŸºäºä¸–ç•Œç©ºé—´çš„ï¼Œæ‰€ä»¥è¦é€šè¿‡è‡ªä¸‹è€Œä¸Šä¸€å±‚å±‚Tranformå˜æ¢(å¦‚æœä½¿ç”¨è¡Œå‘é‡å³ä¹˜çŸ©é˜µï¼Œè¿™ä¸ªTransformçš„ç´¯è®¡è¿‡ç¨‹å°±æ˜¯C=MboneMfatherMgrandpar..Mroot),å¾—åˆ°è¯¥éª¨éª¼åœ¨ä¸–ç•Œç©ºé—´ä¸Šçš„å˜æ¢çŸ©é˜µ-Combined Transform Matrix,å³é€šè¿‡è¿™ä¸ªçŸ©é˜µå¯å°†è¯¥é¡¶ç‚¹ä»éª¨éª¼ç©ºé—´å˜æ¢åˆ°ä¸–ç•Œç©ºé—´ã€‚é‚£ä¹ˆè¿™ä¸ªçŸ©é˜µçš„é€†çŸ©é˜µå°±å¯ä»¥å°†ä¸–ç•Œç©ºé—´ä¸­çš„é¡¶ç‚¹å˜æ¢åˆ°æŸå—éª¨éª¼çš„éª¨éª¼ç©ºé—´ã€‚ç”±äºMeshå®é™…ä¸Šå°±æ˜¯å®šä¹‰åœ¨ä¸–ç•Œç©ºé—´äº†ï¼Œæ‰€ä»¥è¿™ä¸ªé€†çŸ©é˜µå°±æ˜¯Offset Matrixã€‚å³OffsetMatrixå°±æ˜¯éª¨éª¼åœ¨åˆå§‹ä½ç½®ï¼ˆæ²¡æœ‰ç»è¿‡ä»»ä½•åŠ¨ç”»æ”¹å˜ï¼‰æ—¶å°†boneå˜æ¢åˆ°ä¸–ç•Œç©ºé—´çš„çŸ©é˜µ(CombinedTransformMatrix)çš„é€†çŸ©é˜µï¼Œæœ‰ä¸€äº›èµ„æ–™ç§°ä¹‹ä¸ºInverseMatrixã€‚åœ¨å‡ ä½•æµæ°´çº¿ä¸­ï¼Œæ˜¯é€šè¿‡å˜æ¢çŸ©é˜µå°†é¡¶ç‚¹å˜æ¢åˆ°ä¸Šå±‚ç©ºé—´ï¼Œæœ€ç»ˆå¾—åˆ°ä¸–ç•Œåæ ‡ï¼Œé€†çŸ©é˜µåˆ™ä½œç›¸åçš„äº‹ï¼Œæ‰€ä»¥Inverseè¿™ç§ææ³•ä¹Ÿç¬¦åˆæƒ¯ä¾‹ã€‚é‚£ä¹ˆOffsetè¿™ç§ææ³•ä»å­—é¢ä¸Šæ€ä¹ˆç†è§£å‘¢ï¼ŸOffsetå³éª¨éª¼ç›¸å¯¹ä¸–ç•ŒåŸç‚¹çš„åç§»ï¼Œä¸–ç•ŒåŸç‚¹åŠ ä¸Šè¿™ä¸ªåç§»å°±å˜æˆéª¨éª¼ç©ºé—´çš„åŸç‚¹ï¼ŒåŒæ ·å®šä¹‰åœ¨ä¸–ç•Œç©ºé—´ä¸­çš„ç‚¹ç»è¿‡è¿™ä¸ªåç§»çŸ©é˜µçš„ä½œç”¨ä¹Ÿè¢«å˜æ¢æˆéª¨éª¼ç©ºé—´äº†ã€‚ä»å¦ä¸€è§’åº¦ç†è§£ï¼Œåœ¨åŠ¨ç”»ä¸­æ¨¡å‹ä¸­é¡¶ç‚¹çš„ä½ç½®æ˜¯æ ¹æ®éª¨éª¼ä½ç½®åŠ¨æ€è®¡ç®—çš„ï¼Œä¹Ÿå°±æ˜¯è¯´é¡¶ç‚¹è·Ÿç€éª¨éª¼åŠ¨ï¼Œä½†é¦–å…ˆå¿…é¡»ç¡®å®šé¡¶ç‚¹å’Œéª¨éª¼ä¹‹é—´çš„ç›¸å¯¹ä½ç½®ï¼ˆå³é¡¶ç‚¹åœ¨è¯¥éª¨éª¼åæ ‡ç³»ä¸­çš„ä½ç½®ï¼‰ï¼Œä¸€ä¸ªéª¨éª¼å¯èƒ½å¯¹åº”å¾ˆå¤šé¡¶ç‚¹ï¼Œå¦‚æœè¦ä¿å­˜è¿™ä¸ªç›¸å¯¹ä½ç½®æ¯ä¸ªé¡¶ç‚¹å¯¹äºæ¯å—å—æ§åˆ¶çš„éª¨éª¼éƒ½è¦ä¿å­˜ï¼Œè¿™æ ·å°±è¦ä¿å­˜å¤ªå¤šçš„çŸ©é˜µäº†ã€‚ã€‚æ‰€ä»¥åªä¿å­˜meshç©ºé—´åˆ°éª¨éª¼ç©ºé—´çš„å˜æ¢ï¼ˆå³OffsetMatrix),ç„¶åé€šè¿‡è¿™ä¸ªå˜æ¢è®¡ç®—æ¯ä¸ªé¡¶ç‚¹åœ¨è¯¥éª¨éª¼ç©ºé—´ä¸­çš„åæ ‡ï¼Œæ‰€ä»¥OffsetMatrixä¹Ÿååº”äº†meshå’Œæ¯å—éª¨éª¼çš„ç›¸å¯¹ä½ç½®ï¼Œåªæ˜¯è¿™ä¸ªä½ç½®æ˜¯é—´æ¥çš„é€šè¿‡å’Œä¸–ç•Œåæ ‡ç©ºé—´çš„å…³ç³»è¡¨è¾¾çš„ï¼Œåœ¨åˆå§‹ä½ç½®å°†éª¨éª¼æŒ‰ç…§æ¨¡å‹çš„å½¢çŠ¶æ‘†å¥½çš„å…³é”®ä¹‹å¤„ã€‚ ä»¥ä¸Šçš„åˆ†ææ˜¯é€šè¿‡mesh spaceå’Œworld spaceé‡åˆå¾—åˆ°Offset Matrixçš„è®¡ç®—æ–¹æ³•ã€‚é‚£ä¹ˆå¦‚æœä»–ä»¬ä¸é‡åˆå‘¢ï¼Ÿé‚£å°±è¦å…ˆè®¡ç®—é¡¶ç‚¹ä»mesh spaceå˜æ¢åˆ°world spaceçš„å˜æ¢çŸ©é˜µï¼Œå¹¶ä¹˜ä¸Šï¼ˆè¿˜æ˜¯å³ä¹˜ä¸ºä¾‹ï¼‰Combined Matrixçš„Inverse Matrixä»è€Œå¾—åˆ°Offset Matrixã€‚ä½†æ˜¯è¿™ä¸æ˜¯æ‰¾éº»çƒ¦å—ï¼Œå› ä¸ºMeshçš„åŸç‚¹åœ¨å“ªé‡Œå¹¶ä¸é‡è¦ï¼Œä¸ºå•¥ä¸è®©ä»–ä»¬é‡åˆå‘¢ï¼Ÿ è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œæ—¢ç„¶Offset Matrixå¯ä»¥è®¡ç®—å‡ºæ¥ï¼Œä¸ºå•¥è¿˜è¦åœ¨éª¨éª¼åŠ¨ç”»æ–‡ä»¶ä¸­åŒæ—¶æä¾›TransformMatrixå’ŒOffsetMatrixå‘¢ï¼Ÿå®é™…ä¸Šæ–‡ä»¶ä¸­ç¡®å®å¯ä»¥ä¸æä¾›OffsetMatrix,è€Œåªåœ¨è½½å…¥æ—¶è®¡ç®—ï¼Œä½†TransformMatrixä¸å¯ç¼ºå°‘ï¼ŒåŠ¨ç”»å…³é”®å¸§æ•°æ®ä¸€èˆ¬åªå­˜å‚¨éª¨éª¼çš„æ—‹è½¬å’Œè·Ÿéª¨éª¼çš„ä½ç½®ï¼Œéª¨éª¼è§çš„ç›¸å¯¹ä½ç½®è¿˜æ˜¯è¦é TransformMatrixæä¾›ã€‚åœ¨å¾®è½¯çš„Xæ–‡ä»¶ç»“æ„ä¸­æä¾›äº†OffsetMatrix,åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä¸çŸ¥é“ã€‚æˆ‘çŒœæƒ³ä¸€ä¸ªå¯èƒ½çš„åŸå› æ˜¯ä¸ºäº†å…¼å®¹æ€§å’Œçµæ´»æ€§ï¼Œæ¯”å¦‚meshå¹¶æ²¡æœ‰å®šä¹‰åœ¨ä¸–ç•Œåæ ‡ç³»ï¼Œè€Œæ˜¯ä½œä¸ºä¸€ä¸ªobjectæ”¾ç½®åœ¨3d maxä¸­ï¼Œåœ¨å¯¼å‡ºéª¨éª¼åŠ¨ç”»æ—¶ä¸èƒ½ç®€å•çš„è®¤ä¸ºmeshçš„é¡¶ç‚¹åæ ‡æ—¶ç›¸å¯¹äºä¸–ç•Œè¿œç‚¹çš„ï¼Œè¿˜è¦æŠŠè¿™ä¸ªobjectçš„ä½ç½®è€ƒè™‘è¿›å»ï¼Œäºæ˜¯å¯¼å‡ºæ’ä»¶è¦è®¡ç®—OffsetMatrixå¹¶ä¿å­˜åœ¨xæ–‡ä»¶ä¸­ä»¥é¿å…å…¼å®¹æ€§é—®é¢˜ã€‚ å…³äºOffsetMatrixå’ŒTransformMatrixå«æœ‰è¯„è®®ï¼Œæ—‹è½¬å’Œç¼©æ”¾çš„è®¨è®ºï¼š é¦–å…ˆï¼ŒOffsetMatrixå–å†³äºéª¨éª¼çš„åˆå§‹ä½ç½®(å³TransformMatrix),ç”±äºéª¨éª¼åŠ¨ç”»ä¸­æˆ‘ä»¬ä½¿ç”¨çš„åŠ¨ç”»ä¸­çš„ä½ç½®ï¼Œåˆå§‹ä½ç½®æ—¶ä»€ä¹ˆæ ·å¹¶ä¸é‡è¦ï¼Œæ‰€ä»¥å¯ä»¥åœ¨åˆå§‹ä½ç½®ä¸­åŒ…å«å¹³ç§»ï¼Œè€Œæ—‹è½¬å’Œç¼©æ”¾åœ¨åŠ¨ç”»ä¸­è®¾ç½®(ä¸€èˆ¬ä¹Ÿä»…ä»…ä½¿ç”¨æ—‹è½¬ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºå•¥åŠ¨ç”»é€šå¸¸ä¸­å¯ä»¥ç”¨ä¸€ä¸ªå››å…ƒæ•°è¡¨ç¤ºéª¨éª¼çš„å…³é”®å¸§)ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒOffsetMatrixåªåŒ…å«å¹³ç§»å³å¯ã€‚å› æ­¤ä¸€äº›å¼•æ“çš„Boneä¸­ä¸å­˜æ”¾TransformçŸ©é˜µï¼Œè€Œåªå­˜æ”¾éª¨éª¼åœ¨çˆ¶éª¨éª¼ç©ºé—´çš„åæ ‡ï¼Œç„¶åæ—‹è½¬åªåœ¨åŠ¨ç”»å¸§ä¸­è®¾ç½®ï¼Œæœ€åŸºæœ¬çš„éª¨éª¼åŠ¨ç”»å³å¯å®ç°ã€‚ä½†ä¹Ÿå¯åœ¨Transformå’ŒOffset Matrixä¸­åŒ…æ‹¬æ—‹è½¬å’Œç¼©æ”¾ï¼Œè¿™æ ·å¯ä»¥æä¾›åˆ›å»ºåŠ¨ç”»æ—¶çš„å®¹é”™æ€§ã€‚ åœ¨æœ¬æ–‡çš„DEMOä¸­ï¼Œæˆ‘ä»¬ä¹Ÿæ²¡æœ‰ä½¿ç”¨çŸ©é˜µä¿å­˜Bone Offsetï¼Œè€Œåªç”¨äº†ä¸€ä¸ªåæ ‡ä¿å­˜åç§»ä½ç½®ã€‚ 123456789101112131415161718192021222324class BoneOffset&#123;public: float m_offx, m_offy, m_offz;;//åœ¨Bone classä¸­ï¼Œæœ‰ä¸€ä¸ªæ–¹æ³•ç”¨æ¥è®¡ç®—Bone Offsetclass Bone&#123;public: BoneOffset m_boneOffset; //called after ComputeWorldPos() when bone loaded but not animated void ComputeBoneOffset() &#123; m_boneOffset.m_offx = -m_wx; m_boneOffset.m_offy = -m_wy; m_boneOffset.m_offz = -m_wz; if (m_pSibling != NULL) m_pSibing-&gt;ComputeBoneOffset(); if (m_pFirstChild != NULL) m_pFirstChild-&gt;ComputeBoneOffset(); &#125;&#125;; åœ¨ComputeBoneOffset()ä¸­ï¼Œä½¿ç”¨è®¡ç®—å¥½çš„éª¨éª¼çš„ä¸–ç•Œåæ ‡æ¥è®¡ç®—bone offset,è¿™å„¿çš„è®¡ç®—åªæ˜¯å–ä¸€ä¸ªè´Ÿæ•°ï¼Œåœ¨å®é™…å¼•æ“ä¸­ï¼Œå¦‚æœbone offsetæ˜¯ä¸€ä¸ªçŸ©é˜µï¼Œè¿™å„¿å°±åº”è¯¥æ˜¯æ±‚é€†çŸ©é˜µï¼Œå…¶å®ç”±äºæ—‹è½¬çŸ©é˜µæ˜¯æ­£äº¤çš„ï¼Œåªè¦æ±‚å‡ºæ—‹è½¬çŸ©é˜µçš„è½¬ç½®çŸ©é˜µã€‚æ³¨æ„ç”±äºæˆ‘ä»¬è®¡ç®—Bone offsetæ—¶æ˜¯ä½¿ç”¨è®¡ç®—å¥½çš„ä¸–ç•Œåæ ‡ï¼Œæ‰€ä»¥åœ¨è¿™ä¹‹å‰å¿…é¡»åœ¨åˆå§‹ä½ç½®æ—¶å¯¹æ ¹éª¨éª¼è°ƒç”¨ComputeWorldPos()ä»¥è®¡ç®—å‡ºå„ä¸ªéª¨éª¼åœ¨åˆå§‹ä½ç½®æ—¶çš„ä¸–ç•Œåæ ‡ã€‚ 2-3 æœ€ç»ˆï¼šé¡¶ç‚¹æ··åˆ(vertex blending)ç°åœ¨æˆ‘ä»¬æœ‰äº†Skin info,æœ‰äº†Bone Offsetã€‚ç°åœ¨å¼€å§‹åšé¡¶ç‚¹æ··åˆï¼Œè¿™æ˜¯éª¨éª¼åŠ¨ç”»çš„ç²¾é«“æ‰€åœ¨ï¼Œæ­£æ˜¯è¿™ä¸ªæŠ€æœ¯æ¶ˆé™¤äº†å…³èŠ‚å¤„çš„è£‚ç¼ã€‚é¡¶ç‚¹æ··åˆåå¾—åˆ°äº†é¡¶ç‚¹æ–°çš„ä¸–ç•Œåæ ‡ï¼Œå¯¹æ‰€æœ‰çš„é¡¶ç‚¹æ‰§è¡Œvertex blendingåï¼Œä»Meshçš„è§’åº¦çœ‹ï¼ŒMesh deform(å˜å½¢)äº†ï¼Œå˜æˆåŠ¨ç”»éœ€è¦çš„å½¢çŠ¶äº†ã€‚ é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä½¿ç”¨å•å—éª¨éª¼å¯¹é¡¶ç‚¹è¿›è¡Œä½œç”¨çš„è¿‡ç¨‹ä»¥ä¸‹æ˜¯DEMOä¸­çš„ç›¸å…³ä»£ç ï¼š12345678910111213141516class Vertex&#123;public: void ComputerWorldPosByBone(Bone *pBone, float &amp;outx, float &amp;outY, float &amp;outZ) &#123; //step1: transform vertex from mesh space to bone space outX = m_x + pBone-&gt;m_boneOffset.m_offx; outY = m_y + pBone-&gt;m_boneOffset.m_offy; outZ = m_z + pBone-&gt;m_boneOffset.m_offz; //step2: transform vertex bone space to world space outX += pBone-&gt;m_wx; outY += pBone-&gt;m_wy; outZ += pBone-&gt;m_wz; &#125;&#125;; è¿™ä¸ªå‡½æ•°ä½¿ç”¨ä¸€å—éª¨éª¼å¯¹é¡¶ç‚¹è¿›è¡Œå˜æ¢ï¼Œå°†é¡¶ç‚¹Meshåæ ‡ç³»å˜æ¢åˆ°ä¸–ç•Œåæ ‡ç³»ï¼Œè¿™å„¿ä½¿ç”¨äº†éª¨éª¼çš„Bone Offset Matrixå’ŒCombined Transform Matrix å¯¹äºå¤šå—éª¨éª¼ï¼Œå¯¹æ¯å—éª¨éª¼æ‰§è¡Œè¿™ä¸ªè¿‡ç¨‹å¹¶å°†ç»“æœæ ¹æ®æƒé‡æ··åˆ(å³vertex blending)å°±å¾—åˆ°é¡¶ç‚¹æœ€ç»ˆçš„ä¸–ç•Œåæ ‡ã€‚è¿›è¡Œvertex blendingçš„ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223class Vertex&#123; void BlendVertex() &#123; //do the vertex blending,get the vertex's pos in world space m_wX = 0; m_wY = 0; m_wZ = 0; for (int i = 0; i &lt; m_boneNum; ++i) &#123; float tx, ty, tz; ComputeWorldPosByBone(m_bones[i], tx, ty, tz); tx *= m_boneWeights[i]; ty *= m_boneWeights[i]; tz *= m_boneWeights[i]; m_wX += tx; m_wY += ty; m_wZ += tz; &#125; &#125;&#125; è¿™äº›å‡½æ•°æˆ‘éƒ½æ”¾åœ¨Vertexç±»ä¸­äº†ï¼Œå› ä¸ºåªæ˜¯ä¸€ä¸ªç®€å•DEMOæ‰€ä»¥æ²¡æœ‰ç‰¹åˆ«è€ƒè™‘ç±»ç»“æ„é—®é¢˜ï¼Œåœ¨BlendVertex()ä¸­ï¼Œéå†å½±å“è¯¥é¡¶ç‚¹çš„æ‰€æœ‰éª¨éª¼ï¼Œç”¨æ¯å—éª¨éª¼è®¡ç®—å‡ºé¡¶ç‚¹çš„ä¸–ç•Œåæ ‡ï¼Œç„¶åä½¿ç”¨Skin Weightå¯¹è¿™äº›åæ ‡è¿›è¡ŒåŠ æƒå¹³å‡ã€‚tx,ty,tzæ˜¯æŸå—éª¨éª¼ä½œç”¨åé¡¶ç‚¹çš„ä¸–ç•Œåæ ‡ä¹˜ä»¥æƒé‡åçš„å€¼ï¼Œè¿™äº›å€¼ç›¸åŠ åå°±æ˜¯æœ€ç»ˆçš„ä¸–ç•Œåæ ‡äº†ã€‚ ç°åœ¨è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªå·¥æ—¶å›é¡¾ä»¥ä¸‹Vertex blendingçš„æ•´ä¸ªè¿‡ç¨‹(ä½¿ç”¨çŸ©é˜µå˜æ¢) 1234Vworld = Vmesh * BoneOffsetMatrix1 * CombindMatrix1 * Weight1+ Vmesh* BoneOffsetMatrix2 * CombineMatrix2*Wright2+ ...+ Vmesh * BoneOffsetMatrixn * CombindMatrixN * WeightN 4 æ€»ç»“ä»ç»“æ„ä¸Šçœ‹ï¼ŒSkinnedMeshåŒ…æ‹¬ï¼šåŠ¨ç”»æ•°æ®ï¼Œéª¨éª¼æ•°æ®ï¼ŒåŒ…æ‹¬Skin infoçš„Meshæ•°æ®ï¼Œä»¥åŠBone Offset Matrixã€‚ ä»è¿‡ç¨‹ä¸Šçœ‹ï¼Œè½½å…¥é˜¶æ®µï¼šè½½å…¥å¹¶å»ºç«‹éª¨éª¼å±‚æ¬¡ç»“æ„ï¼Œè®¡ç®—æˆ–è½½å…¥Bone Offset Matrix,è½½å…¥Meshæ•°æ®å’ŒSkin info(å…·ä½“çš„å®ç°ä¸åŒçš„å¼•æ“å¯èƒ½éƒ½ä¸ä¸€æ ·)ã€‚è¿è¡Œé˜¶æ®µï¼šæ ¹æ®æ—¶é—´ä»åŠ¨ç”»æ•°æ®ä¸­è·å–éª¨éª¼å½“å‰æ—¶åˆ»çš„Transfrom Matrixï¼Œè°ƒç”¨UpdateBoneMatrixè®¡ç®—å‡ºå„éª¨éª¼çš„CombineMatrix,å¯¹äºæ¯ä¸ªé¡¶ç‚¹æ ¹æ®Skin infoè¿›è¡ŒVertex Blendingè®¡ç®—å‡ºé¡¶ç‚¹çš„ä¸–ç•Œåæ ‡ï¼Œæœ€ç»ˆè¿›è¡Œæ¨¡å‹çš„æ¸²æŸ“ã€‚ ä¸‰ã€å…³äºæœ¬æ–‡çš„ä¾‹å­è¿™ä¸ªä¾‹å­åšäº†å°½å¯èƒ½çš„ç®€åŒ–ï¼ŒåªåŒ…å«ä¸€ä¸ªcppæ–‡ä»¶ï¼Œä½¿ç”¨OpenGLå’ŒGLUTä½œä¸ºæ¸²æŸ“å™¨å’Œæ¡†æ¶ï¼Œä»…æœ‰400å¤šè¡Œä»£ç ã€‚ä¾‹å­ä¸­æ‰‹å·¥åˆ›å»ºäº†ä¸€ä¸ªéª¨éª¼å±‚æ¬¡å’ŒMeshï¼Œæ‰‹å·¥è®¾ç½®Skin infoå¹¶è‡ªåŠ¨è®¡ç®—BoneOffset,ä½¿ç”¨ç¨‹åºæ§åˆ¶éª¨éª¼å¹³ç§»æ¼”ç¤ºäº†éª¨éª¼å±‚æ¬¡çš„è¿åŠ¨å’Œéª¨éª¼å½±å“ä¸‹Meshé¡¶ç‚¹çš„è¿åŠ¨ï¼Œä¾‹å­ä¸­ç”šè‡³æ²¡æœ‰ä½¿ç”¨çŸ©é˜µã€‚æœ¬ä¾‹å­ä»…ä½œç†è§£éª¨éª¼åŠ¨ç”»åªç”¨ã€‚æˆªå›¾ä¸­ç»¿è‰²ç½‘æ ¼æ˜¯æ¨¡å‹åŸå§‹å½¢çŠ¶ï¼Œè“è‰²æ˜¯éª¨éª¼ï¼Œçº¢è‰²æ˜¯åŠ¨ç”»æ—¶æ¨¡å‹å½¢çŠ¶ï¼ŒDEMOä¸­å·¦æ•°ç¬¬äºŒä¸ªéª¨éª¼åšä¸Šä¸‹è¿åŠ¨ï¼Œæœ€ä¸‹æ–¹çš„éª¨éª¼åšxæ–¹å‘å¹³ç§»ã€‚DEMOæ²¡æœ‰ä½¿ç”¨æ—‹è½¬ï¼Œè€Œå®é™…çš„éª¨éª¼åŠ¨ç”»ä¸­å¾€å¾€æ²¡æœ‰å¹³ç§»åªæœ‰æ—‹è½¬çš„ï¼Œå› ä¸ºèƒ³è†Šåªèƒ½è½¬ä¸èƒ½è¾¹é•¿ï¼Œä½†åŸç†ä¸€è‡´ã€‚(è¿™ä¸ªå…¬å¼ä½¿ç”¨çš„æ˜¯è¡Œå‘é‡å·¦ä¹˜çŸ©é˜µ)ç”±äºBoneOffsetMatrixå’ŒCombined Matrixéƒ½æ˜¯çŸ©é˜µï¼Œå¯ä»¥å…ˆç›¸ä¹˜è¿™æ ·å°±å‡å°‘äº†å¾ˆå¤šè®¡ç®—äº†ï¼Œåœ¨å®é™…æ¸¸æˆä¸­å¯ä»¥VSè¿›è¡Œç¡¬ä»¶åŠ é€Ÿè®¡ç®—ã€‚ä»£ç çš„æ‰§è¡Œè¿‡ç¨‹ä¸ºï¼Œåˆå§‹åŒ–æ—¶ï¼š12345678910111213141516171819202122buildBones();//åˆ›å»ºéª¨éª¼å±‚æ¬¡buildMesh();//åˆ›å»ºmesh,è®¾ç½®skin infoï¼Œè®¡ç®—bone offset ``` æ¯å¸§è¿è¡Œæ—¶ï¼š```C++//draw original meshg_mesh-&gt;DrawStaticMesh(0,0,0);//move bonesanimateBones();//update all bone's pos in bone treeg_boneRoot-&gt;ComputeWorldPos(0,0,0);//update vertex pos by bones,using vertex blendingg_mesh-&gt;UpdateVertices();//draw deformed meshg_mesh-&gt;Draw();//draw boneg_boneRoot-&gt;Draw(); ä¸ºä¿è¯æ–‡æœ¬çš„å®Œæ•´æ€§ï¼Œä¸‹é¢è´´å‡ºæ‰€æœ‰ä»£ç ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382// A simplest Skinned Mesh demo#include &lt;GL/glut.h&gt;#define NULL 0class BoneOffset&#123;public : //BoneOffset transform a vertex from mesh space to bone space. //In other words, it is the offset from mesh space to a bone's space. //For each bone, there is a BoneOffest. //If we add the offset to the vertex's pos (in mesh space), we get the vertex's pos in bone space //For example: if a vertex's pos in mesh space is (100,0,0), the bone offset is (-20,0,0), so the vertex's pos in bone space is (80,0,0) //Actually, BoneOffset is the invert transform of that we place a bone in mesh space, that is (-20,0,0) means the bone is at (20,0,0) in mesh space float m_offx , m_offy , m_offz ;&#125;;//----------------------------------------------------------------class Bone&#123;public : Bone () &#123;&#125; Bone ( float x , float y , float z ):m_pSibling (NULL ),m_pFirstChild (NULL ),m_pFather (NULL ),m_x (x ),m_y (y ),m_z (z )&#123;&#125; ~Bone () &#123;&#125; Bone * m_pSibling ; Bone * m_pFirstChild ; Bone * m_pFather ; //only for draw bone void SetFirstChild (Bone * pChild ) &#123; m_pFirstChild = pChild ; m_pFirstChild -&gt;m_pFather = this ; &#125; void SetSibling (Bone * pSibling ) &#123; m_pSibling = pSibling ; m_pSibling -&gt;m_pFather = m_pFather ; &#125; float m_x , m_y , m_z ; //pos in its parent's space float m_wx , m_wy , m_wz ; //pos in world space //give father's world pos, compute the bone's world pos void ComputeWorldPos ( float fatherWX , float fatherWY , float fatherWZ ) &#123; m_wx = fatherWX +m_x ; m_wy = fatherWY +m_y ; m_wz = fatherWZ +m_z ; if (m_pSibling !=NULL ) m_pSibling -&gt;ComputeWorldPos (fatherWX , fatherWY , fatherWZ ); if (m_pFirstChild !=NULL ) m_pFirstChild -&gt;ComputeWorldPos (m_wx , m_wy , m_wz ); &#125; BoneOffset m_boneOffset ; //called after compute world pos when bone loaded but not animated void ComputeBoneOffset () &#123; m_boneOffset .m_offx = -m_wx ; m_boneOffset .m_offy = -m_wy ; m_boneOffset .m_offz = -m_wz ; if (m_pSibling !=NULL ) m_pSibling -&gt;ComputeBoneOffset (); if (m_pFirstChild !=NULL ) m_pFirstChild -&gt;ComputeBoneOffset (); &#125; void Draw () &#123; glColor3f (0,0,1.0); glPointSize (4); glBegin (GL_POINTS ); glVertex3f (m_wx ,m_wy ,m_wz ); glEnd (); if (m_pFather !=NULL ) &#123; glBegin (GL_LINES ); glVertex3f (m_pFather -&gt;m_wx ,m_pFather -&gt;m_wy ,m_pFather -&gt;m_wz ); glVertex3f (m_wx ,m_wy ,m_wz ); glEnd (); &#125; if (m_pSibling !=NULL ) m_pSibling -&gt;Draw (); if (m_pFirstChild !=NULL ) m_pFirstChild -&gt;Draw (); &#125;&#125;;//--------------------------------------------------------------#define MAX_BONE_PER_VERTEX 4class Vertex&#123;public : Vertex ():m_boneNum (0) &#123; &#125; void ComputeWorldPosByBone (Bone * pBone , float &amp; outX , float &amp; outY , float &amp; outZ ) &#123; //step1: transform vertex from mesh space to bone space outX = m_x +pBone -&gt;m_boneOffset .m_offx ; outY = m_y +pBone -&gt;m_boneOffset .m_offy ; outZ = m_z +pBone -&gt;m_boneOffset .m_offz ; //step2: transform vertex from bone space to world sapce outX += pBone -&gt;m_wx ; outY += pBone -&gt;m_wy ; outZ += pBone -&gt;m_wz ; &#125; void BlendVertex () &#123; //do the vertex blending,get the vertex's pos in world space m_wX = 0; m_wY = 0; m_wZ = 0; for ( int i =0; i &lt;m_boneNum ; ++i ) &#123; float tx , ty , tz ; ComputeWorldPosByBone (m_bones [i ], tx , ty , tz ); tx *= m_boneWeights [i ]; ty *= m_boneWeights [i ]; tz *= m_boneWeights [i ]; m_wX += tx ; m_wY += ty ; m_wZ += tz ; &#125; &#125; float m_x , m_y , m_z ; //local pos in mesh space float m_wX , m_wY , m_wZ ; //blended vertex pos, in world space //skin info int m_boneNum ; Bone * m_bones [MAX_BONE_PER_VERTEX ]; float m_boneWeights [MAX_BONE_PER_VERTEX ]; void SetBoneAndWeight ( int index , Bone * pBone , float weight ) &#123; m_bones [index ] = pBone ; m_boneWeights [index ] = weight ; &#125; &#125;; //----------------------------------------------------------- class SkinMesh &#123; public : SkinMesh ():m_vertexNum (0) &#123; &#125; SkinMesh ( int vertexNum ):m_vertexNum (vertexNum ) &#123; m_vertexs = new Vertex [vertexNum ]; &#125; ~SkinMesh () &#123; if (m_vertexNum &gt;0) delete [] m_vertexs ; &#125; void UpdateVertices () &#123; for ( int i =0; i &lt;m_vertexNum ; ++i ) &#123; m_vertexs [i ].BlendVertex (); &#125; &#125; void DrawStaticMesh ( float x , float y , float z ) &#123; glColor3f (0,1.0,0); glPointSize (4); glBegin (GL_POINTS ); for ( int i =0; i &lt;m_vertexNum ; ++i ) glVertex3f (m_vertexs [i ].m_x +x ,m_vertexs [i ].m_y +y ,m_vertexs [i ].m_z +z ); glEnd (); glBegin (GL_LINE_LOOP ); for ( int i =0; i &lt;m_vertexNum ; ++i ) glVertex3f (m_vertexs [i ].m_x +x ,m_vertexs [i ].m_y +y ,m_vertexs [i ].m_z +z ); glEnd (); &#125; void Draw () &#123; glColor3f (1.0,0, 0); glPointSize (4); glBegin (GL_POINTS ); for ( int i =0; i &lt;m_vertexNum ; ++i ) glVertex3f (m_vertexs [i ].m_wX ,m_vertexs [i ].m_wY ,m_vertexs [i ].m_wZ ); glEnd (); glBegin (GL_LINE_LOOP ); for ( int i =0; i &lt;m_vertexNum ; ++i ) glVertex3f (m_vertexs [i ].m_wX ,m_vertexs [i ].m_wY ,m_vertexs [i ].m_wZ ); glEnd (); &#125; int m_vertexNum ; Vertex * m_vertexs ; //array of vertices in mesh &#125;; //-------------------------------------------------------------- Bone * g_boneRoot ; Bone * g_bone1 , *g_bone2 , *g_bone31 , *g_bone32 ; void buildBones () &#123; g_boneRoot = new Bone (0, 0, 0); g_bone1 = new Bone (0.2, 0, 0); g_bone2 = new Bone (0.2, 0, 0); g_bone31 = new Bone (0.2, 0.1, 0); g_bone32 = new Bone (0.2, -0.1, 0); g_boneRoot -&gt;SetFirstChild (g_bone1 ); g_bone1 -&gt;SetFirstChild (g_bone2 ); g_bone2 -&gt;SetFirstChild (g_bone31 ); g_bone31 -&gt;SetSibling (g_bone32 );&#125;void deleteBones ()&#123; delete g_boneRoot ; delete g_bone1 ; delete g_bone2 ; delete g_bone31 ; delete g_bone32 ;&#125;void animateBones ()&#123; static int dir =-1, dir2 =-1; //animate bones manually g_bone1 -&gt;m_y +=0.00001f*dir ; if (g_bone1 -&gt;m_y m_y &gt;0.2) dir *=-1; g_bone32 -&gt;m_x +=0.00001f*dir2 ; if (g_bone32 -&gt;m_x m_x &gt;0.2) dir2 *=-1;&#125;SkinMesh * g_mesh ;void buildMesh ()&#123; float _meshData []= &#123; //x,y,z -0.1,0.05,0, 0.1,0.05,0, 0.3,0.05,0, 0.45,0.06,0, 0.6,0.15,0, 0.65,0.1,0, 0.5,0,0, 0.65,-0.1,0, 0.6,-0.15,0, 0.45,-0.06,0, 0.3,-0.05,0, 0.1,-0.05,0, -0.1,-0.05,0, &#125;; float _skinInfo []= &#123; //bone_num,bone id(0,1,2,31 or 32), bone weight 1~4, 1, 0, -1, -1, -1, 1.0, 0.0, 0.0, 0.0, 2, 0, 1, -1, -1, 0.5, 0.5, 0.0, 0.0, 2, 1, 2, -1, -1, 0.5, 0.5, 0.0, 0.0, 2, 2, 31, -1, -1, 0.3, 0.7, 0.0, 0.0, 2, 2, 31, -1, -1, 0.2, 0.8, 0.0, 0.0, 1, 31, -1, -1, -1, 1.0, 0.0, 0.0, 0.0, 2, 31, 32, -1, -1, 0.5, 0.5, 0.0, 0.0, 1, 32, -1, -1, -1, 1.0, 0.0, 0.0, 0.0, 2, 2, 32, -1, -1, 0.2, 0.8, 0.0, 0.0, 2, 2, 32, -1, -1, 0.3, 0.7, 0.0, 0.0, 2, 1, 2, -1, -1, 0.5, 0.5, 0.0, 0.0, 2, 0, 1, -1, -1, 0.5, 0.5, 0.0, 0.0, 1, 0, -1, -1, -1, 1.0, 0.0, 0.0, 0.0, &#125;; int vertexNum = sizeof (_meshData )/( sizeof ( float )*3); g_mesh = new SkinMesh (vertexNum ); for ( int i =0; i m_vertexs [i ].m_x = _meshData [i *3]; g_mesh -&gt;m_vertexs [i ].m_y = _meshData [i *3+1]; g_mesh -&gt;m_vertexs [i ].m_z = _meshData [i *3+2]; &#125; //set skin info for ( int i =0; i m_vertexs [i ].m_boneNum = _skinInfo [i *9]; for ( int j =0; j &lt;g_mesh -&gt;m_vertexs [i ].m_boneNum ; ++j ) &#123; Bone * pBone = g_boneRoot ; if (_skinInfo [i *9+1+j ]==1) pBone = g_bone1 ; else if (_skinInfo [i *9+1+j ]==2) pBone = g_bone2 ; else if (_skinInfo [i *9+1+j ]==31) pBone = g_bone31 ; else if (_skinInfo [i *9+1+j ]==32) pBone = g_bone32 ; g_mesh -&gt;m_vertexs [i ].SetBoneAndWeight (j , pBone , _skinInfo [i *9+5+j ]); &#125; &#125; //compute bone offset g_boneRoot -&gt;ComputeWorldPos (0, 0, 0); g_boneRoot -&gt;ComputeBoneOffset ();&#125;void deleteMesh ()&#123; delete g_mesh ;&#125;void myInit ()&#123; buildBones (); buildMesh ();&#125;void myQuit ()&#123; deleteBones (); deleteMesh ();&#125;void myReshape ( int width , int height )&#123; GLfloat h = (GLfloat ) height / (GLfloat ) width ; glViewport (0, 0, (GLint ) width , (GLint ) height ); glMatrixMode (GL_PROJECTION ); glLoadIdentity ();// glFrustum(-1.0, 1.0, -h, h, 5.0, 60.0); glFrustum (-1.0, 1.0, -h , h , 1.0, 100.0); glMatrixMode (GL_MODELVIEW ); glLoadIdentity (); glTranslatef (0.0, 0.0, -1.0);&#125;void myDisplay ( void )&#123; glClear (GL_COLOR_BUFFER_BIT ); //draw original mesh g_mesh -&gt;DrawStaticMesh (0,0,0); //move bones animateBones (); //update all bone's pos in bone tree g_boneRoot -&gt;ComputeWorldPos (0, 0, 0); //update vertex pos by bones, using vertex blending g_mesh -&gt;UpdateVertices (); //draw deformed mesh g_mesh -&gt;Draw (); //draw bone g_boneRoot -&gt;Draw (); glFlush (); glutSwapBuffers ();&#125;void myIdle ( void )&#123; myDisplay ();&#125;int main ( int argc , char *argv [])&#123; glutInit (&amp;argc , argv ); glutInitDisplayMode (GLUT_RGB | GLUT_DEPTH | GLUT_DOUBLE ); glutInitWindowPosition (100, 100); glutInitWindowSize (640, 480); glutCreateWindow ( "A simplest skinned mesh DEMO, by happyfirecn@yahoo.com.cn" ); glutDisplayFunc (myDisplay ); glutReshapeFunc (myReshape ); glutIdleFunc (myIdle ); myInit (); glutMainLoop (); myQuit (); return 0;&#125; //]]></content>
  </entry>
  <entry>
    <title><![CDATA[Actoræ¨¡å‹åŸç†]]></title>
    <url>%2F2018%2F03%2F23%2Factor%2F</url>
    <content type="text"><![CDATA[1.Actoræ¨¡å‹åœ¨ä½¿ç”¨Javaè¿›è¡Œå¹¶å‘ç¼–ç¨‹æ—¶éœ€è¦ç‰¹åˆ«çš„å…³æ³¨é”å’Œå†…å­˜åŸå­æ€§ç­‰ä¸€ç³»åˆ—çº¿ç¨‹é—®é¢˜ï¼Œè€ŒActoræ¨¡å‹å†…éƒ¨çš„çŠ¶æ€ç”±å®ƒè‡ªå·±ç»´æŠ¤å³å®ƒå†…éƒ¨æ•°æ®åªèƒ½ç”±å®ƒè‡ªå·±ä¿®æ”¹ï¼ˆé€šè¿‡æ¶ˆæ¯ä¼ é€’æ¥è¿›è¡ŒçŠ¶æ€ä¿®æ”¹ï¼‰ï¼Œæ‰€ä»¥ä½¿ç”¨Actorsæ¨¡å‹è¿›è¡Œå¹¶å‘ç¼–ç¨‹å¯ä»¥å¾ˆå¥½é¿å…è¿™äº›é—®é¢˜ï¼ŒActorç”±çŠ¶æ€(state),è¡Œä¸º(Behavior)å’Œé‚®ç®±(mailBox)ä¸‰éƒ¨åˆ†ç»„æˆ1.çŠ¶æ€(state):Actorä¸­çš„çŠ¶æ€æŒ‡çš„æ˜¯Actorå¯¹è±¡çš„å˜é‡ä¿¡æ¯ï¼ŒçŠ¶æ€ç”±Actorè‡ªå·±ç®¡ç†ï¼Œé¿å…äº†å¹¶å‘ç¯å¢ƒä¸‹çš„é”å’Œå†…å­˜åŸå­æ€§ç­‰é—®é¢˜2.è¡Œä¸º(Behavior):è¡Œä¸ºæŒ‡çš„æ˜¯Actorä¸­è®¡ç®—é€»è¾‘ï¼Œé€šè¿‡Actoræ¥æ”¶åˆ°æ¶ˆæ¯æ¥æ”¹å˜Actorçš„çŠ¶æ€3.é‚®ç®±(mailBox):é‚®ç®±æ˜¯Actorå’ŒActorä¹‹é—´çš„é€šä¿¡æ¡¥æ¢ï¼Œé‚®ç®±å†…éƒ¨é€šè¿‡FIFOæ¶ˆæ¯é˜Ÿåˆ—æ¥å­˜å‚¨å‘é€å‘Actoræ¶ˆæ¯ï¼Œæ¥æ”¶æ–¹Actorä»é‚®ç®±é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ Actorçš„åŸºç¡€å°±æ˜¯æ¶ˆæ¯ä¼ é€’ 2.ä½¿ç”¨Actoræ¨¡å‹çš„å¥½å¤„1.äº‹ä»¶é©±åŠ¨â€”Actorä¹‹é—´çš„é€šä¿¡æ˜¯å¼‚æ­¥çš„ï¼Œå³ä½¿Actoråœ¨å‘é€æ¶ˆæ¯åä¹Ÿæ— éœ€é˜»å¡æˆ–è€…ç­‰å¾…å°±èƒ½å¤Ÿå¤„ç†å…¶ä»–äº‹ä»¶2.å¼ºéš”ç¦»æ€§â€”Actorä¸­çš„æ–¹æ³•ä¸èƒ½ç”±å¤–éƒ¨éƒ¨ç½²ç›´æ¥è°ƒç”¨ï¼Œæ‰€æœ‰çš„ä¸€åˆ‡éƒ½é€šè¿‡æ¶ˆæ¯ä¼ é€’è¿›è¡Œçš„ï¼Œä»è€Œé¿å…äº†Actorä¹‹é—´çš„æ•°æ®å…±äº«ï¼Œæƒ³è¦è§‚å¯Ÿåˆ°å¦ä¸€ä¸ªActorçš„çŠ¶æ€å˜åŒ–åªèƒ½é€šè¿‡æ¶ˆæ¯ä¼ é€’è¿›è¡Œè¯¢é—®3.ä½ç½®é€æ˜â€”æ— è®ºActoråœ°å€å®åœ¨æœ¬åœ°è¿˜æ˜¯åœ¨è¿œç¨‹æœºä¸Šå¯¹äºä»£ç æ¥è¯´éƒ½æ˜¯ä¸€æ ·çš„4.è½»é‡æ€§â€”Actoræ˜¯éå¸¸è½»é‡çš„è®¡ç®—å•æœºï¼Œå•ä¸ªActorä»…å 400å¤šå­—èŠ‚ï¼Œåªéœ€å°‘é‡å†…å­˜å°±èƒ½è¾¾åˆ°é«˜å¹¶å‘ 3.Actoræ¨¡å‹åŸç†ä»¥ä¸‹é€šè¿‡å­¦ç”Ÿäºæ•™å¸ˆä¹‹é—´çš„é‚®ä»¶é€šä¿¡æ¥ç†è§£akkaä¸­çš„Actoræ¨¡å‹ å­¦ç”Ÿ-æ•™å¸ˆçš„æ¶ˆæ¯ä¼ é€’é¦–å…ˆåªè€ƒè™‘å­¦ç”Ÿå•å‘å‘é€æ¶ˆæ¯ç»™æ•™å¸ˆï¼ˆå­¦ç”Ÿâ€”ã€‹æ•™å¸ˆï¼‰ï¼Œå¦‚ä¸‹å›¾ï¼šå›¾è§£ï¼š1.å­¦ç”Ÿåˆ›å»ºä¸€ä¸ªActorSystem2.é€šè¿‡ActorSystemåˆ›å»ºActorRefï¼Œå°†QuoteRequestæ¶ˆæ¯å‘é€åˆ°ActorRef(æ•™å¸ˆä»£ç†)3.ActorRef(æ•™å¸ˆä»£ç†)æ¶ˆæ¯ä¼ åˆ°Dispatcherä¸­4.Dispatherä¾æ¬¡çš„å°†æ¶ˆæ¯å‘é€åˆ°TeacherActoré‚®ç®±ä¸­5.Dispatherå°†é‚®ç®±æ¨é€åˆ°ä¸€æ¡çº¿ç¨‹ä¸­6.é‚®ç®±å–å‡ºä¸€æ¡æ¶ˆæ¯å¹¶å§”æ´¾ç»™TeacherActorçš„Receiveræ–¹æ³•]]></content>
  </entry>
  <entry>
    <title><![CDATA[ç®€å•ä»‹ç»å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹æœåŠ¡å™¨]]></title>
    <url>%2F2018%2F03%2F22%2Fthread-process%2F</url>
    <content type="text"><![CDATA[é¦–å…ˆè´´ä¸‹å¤šè¿›ç¨‹å•çº¿ç¨‹å’Œå•è¿›ç¨‹å¤šçº¿ç¨‹çš„ç‰¹ç‚¹ï¼šå¤šè¿›ç¨‹ï¼šæœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œè¿›ç¨‹ä¹‹é—´ä¸å…±äº«å†…å­˜å’Œå˜é‡ï¼Œä½†å¯ä»¥é€šè¿‡å…±äº«å†…å­˜å®ç°ï¼Œæ¯ä¸ªè¿›ç¨‹åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œä¸€èˆ¬ç”¨äºå•æœºç³»ç»Ÿå¼€å‘ã€‚å¤šçº¿ç¨‹ï¼šåœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸‹æ‰€æœ‰çº¿ç¨‹å¯ä»¥å…±äº«å†…å­˜å’Œå˜é‡ã€‚è€Œå…±åŒç‚¹æ˜¯ï¼ŒåŒå¼€è¾Ÿçš„è¿›ç¨‹æ•°/çº¿ç¨‹æ•°å¤šä½™ç³»ç»Ÿcpuæ ¸æ•°æ—¶ï¼Œæ— æ³•ç»§ç»­æä¾›åº”ç”¨çš„æ€§èƒ½ã€‚è€Œå¤šçº¿ç¨‹æ¶æ„çš„æœåŠ¡å™¨ï¼Œåªè¦é€‚å½“å°†ä¸€äº›ä»»åŠ¡åˆ†å‡ºæ¥ç”¨æ–°çš„è¿›ç¨‹å¯åŠ¨ï¼Œå°±å¯ä»¥æ‰©å±•æˆåˆ†å¸ƒå¼æ¶æ„ï¼Œä½¿ç”¨tcpé€šä¿¡å³å¯ã€‚å½“ç„¶å¤šè¿›ç¨‹ä¹Ÿå¯ä»¥è¿™ä¹ˆå¹²ï¼Œé€šä¿¡æ–¹å¼ä¹Ÿæ˜¯ä½¿ç”¨tcpã€‚è€Œæ“ä½œç³»ç»Ÿå¯¹äºçº¿ç¨‹çš„åˆ‡æ¢æ˜¯æ¯”è¿›ç¨‹çš„åˆ‡æ¢è¦å¿«ã€‚ ä¸‹é¢å…ˆä»‹ç»ä¸‹å¤šè¿›ç¨‹å•çº¿ç¨‹æœåŠ¡å™¨æ¶æ„ï¼Œä»¥å•æœºç³»ç»Ÿä¸ºä¾‹ï¼šä¸‹è´´æ¶æ„å›¾ï¼šä¸€ä¸ªæ¸¸æˆæœå¤§æ¦‚å°±æœ‰è¿™å‡ ä¸ªè¿›ç¨‹ã€‚router:ä½œç”¨å¦‚å…¶åï¼Œè·¯ç”±ã€‚æ¯ä¸ªåŠŸèƒ½è¿›ç¨‹å¯åŠ¨æ—¶ï¼Œä¼šå…ˆè¿æ¥router,routerä¼šç»™è¿ä¸Šæ¥çš„è¿›ç¨‹åˆ†é…ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œæ‰€æœ‰åŠŸèƒ½è¿›ç¨‹éƒ½æ˜¯é è¿™ä¸ªrouterè¿›ç¨‹é€šä¿¡ã€‚login:ç™»å½•æœåŠ¡å™¨ï¼Œclientç™»å½•éªŒè¯åœ¨è¿™ä¸ªè¿›ç¨‹è¿›è¡Œã€‚login:ç©å®¶å•äººé€»è¾‘æ“ä½œå¤„ç†è¿›ç¨‹ï¼Œloginä¼šå°†ç™»å½•çš„ç©å®¶å¹³å°åˆ°è¿™äº›logicä¸Šã€‚global_login:å…¨å±€æ“ä½œè¿›ç¨‹ï¼Œå¤šäººç©æ³•çš„åŠŸèƒ½ï¼Œä¾‹å¦‚æˆ˜æ–—åŒ¹é…ï¼Œå·¥ä¼šç­‰æ“ä½œä¼šæ”¾åœ¨è¿™é‡Œè¿›è¡Œã€‚log:æ¸¸æˆæ—¥å¿—è¾“å‡ºè¿›ç¨‹ï¼Œæ‰€æœ‰åŠŸèƒ½è¿›ç¨‹çš„æ—¥å¿—è¾“å‡ºéƒ½å‘åˆ°è¿™ä¸ªè¿›ç¨‹ï¼Œlogè¿›ç¨‹ä¼šè¾“å‡ºåˆ°ç£ç›˜æ–‡ä»¶ã€‚db:redisä½œä¸ºå†…å­˜æ•°æ®åº“ï¼ŒMysqlä½œä¸ºæ•°æ®æŒä¹…åŒ–ï¼Œå…¶å®ƒåŠŸèƒ½è¿›ç¨‹å–æ•°æ®éƒ½ä¼šå‘é€è¯·æ±‚åˆ°dbã€‚back:åå°è¿›ç¨‹ï¼Œé›†æˆäº†ä¸€ä¸ªhttpæœåŠ¡å™¨ã€‚å¤„ç†httpè¯·æ±‚ï¼Œè¿™é‡Œå¯ä»¥é›†æˆä¸€äº›ç¬¬ä¸‰æ–¹æœåŠ¡åŠŸèƒ½ï¼Œå¦‚gmæŒ‡ä»¤ã€‚ ä»¥ä¸Šæ¯ä¸ªè¿›ç¨‹éƒ½æ˜¯å•çº¿ç¨‹ï¼Œæ‰€ä»¥æ— éœ€è€ƒè™‘é”çš„é—®é¢˜ã€‚å¯¹äºæ¯ä¸ªè¿›ç¨‹æ”¶å‘æ•°æ®ï¼š å‘æ•°æ®ï¼šç›´æ¥æŠŠ{target_id:data}å‘é€åˆ°router æ”¶æ•°æ®ï¼šå¸§é©±åŠ¨ï¼Œå¦‚100msä¸»åŠ¨å‘routerè¯¢é—®æ˜¯å¦æœ‰æ•°æ®ï¼Œæœ‰åˆ™å–è¿‡æ¥å¤„ç†ã€‚å•æœºç³»ç»Ÿä¸‹ï¼Œå¦‚æœé‡‡ç”¨å…±äº«å†…å­˜æ–¹å¼ï¼Œé€šä¿¡æ•ˆç‡å°†éå¸¸é«˜ã€‚æ‰€ä»¥å¤šè¿›ç¨‹çš„æœåŠ¡å™¨æ¶æ„è®¾è®¡èµ·æ¥è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚ åœ¨ä»‹ç»ä¸‹å¤šçº¿ç¨‹æœåŠ¡å™¨æ¶æ„ï¼Œè¿™é‡Œæˆ‘æƒ³ä»‹ç»actoræ¨¡å‹ã€‚ä¸€ä¸ªActoræŒ‡çš„æ˜¯ä¸€ä¸ªæœ€åŸºæœ¬çš„è®¡ç®—å•å…ƒã€‚å®ƒèƒ½æ¥æ”¶ä¸€ä¸ªæ¶ˆæ¯å¹¶ä¸”åŸºäºå…¶æ‰§è¡Œè®¡ç®—ã€‚è¿™ä¸ªç†å¿µå¾ˆåƒé¢å‘å¯¹è±¡è¯­è¨€ï¼Œä¸€ä¸ªå¯¹è±¡æ¥å—ä¸€æ¡æ¶ˆæ¯ï¼ˆæ–¹æ³•è°ƒç”¨ï¼‰ï¼Œç„¶åæ ¹æ®æ¥å—çš„æ¶ˆæ¯åšäº‹ï¼ˆè°ƒç”¨äº†å“ªä¸ªæ–¹æ³•ï¼‰ã€‚Actorsä¸€å¤§é‡è¦ç‰¹å¾åœ¨äºactorsä¹‹é—´ç›¸äº’éš”ç¦»ï¼Œå®ƒä»¬å¹¶ä¸äº’ç›¸å…±äº«å†…å­˜ã€‚è¿™ç‚¹åŒºåˆ«äºä¸Šè¿°çš„å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªactorèƒ½ç»´æŒä¸€ä¸ªç§æœ‰çš„çŠ¶æ€ï¼Œå¹¶ä¸”è¿™ä¸ªçŠ¶æ€ä¸å¯èƒ½è¢«å¦ä¸€ä¸ªactoræ‰€æ”¹å˜ã€‚æ¯ä¸ªActoréƒ½æœ‰ä¸€ä¸ªé‚®ç®±ï¼Œç”¨äºæ¥å—å…¶ä»–actorå‘é€çš„æ¶ˆæ¯ã€‚ è¿™é‡Œé‡ç‚¹è®²ä¸€ä¸‹Actoræ¨¡å‹çš„è°ƒåº¦æ˜¯æ€æ ·åšçš„ã€‚Actoræ¨¡å‹å®é™…ä¸Šå¯ä»¥æœ‰æˆåƒä¸Šä¸‡ä¸ªï¼Œä½†ç›®å‰ä¸€å°é€šç”¨æœåŠ¡å™¨æœ€å¤šåªæœ‰24æ ¸ï¼Œå½“ç„¶ä¸å¯èƒ½ä¹Ÿå¼€æˆåƒä¸Šä¸‡ä¸ªçº¿ç¨‹ã€‚ æˆ‘ä»¬å¯ä»¥æŠŠActorç®€å•æƒ³è±¡æˆè¿™æ ·ä¸€ä¸ªç±»å®ä¾‹ï¼š 1234567891011class Actor&#123; public: void process_1(); void process_2(); void fetch_msg(); private: int actor_id; string actor_name; list&lt;msg&gt; msg_queue;&#125; æ¯ä¸ªActorå®šä¹‰äº†è‡ªå·±å®ç°çš„åŠŸèƒ½(process_1,process_2)å½“msg_queueé‚®ç®±æœ‰æ¶ˆæ¯åˆ°æ¥çš„æ—¶å€™ï¼Œå°±è°ƒç”¨fetch_msgå–è·å–è¿™äº›æ¶ˆæ¯è¿›ç¨‹å¤„ç†ã€‚è¿™ä¸€æ­¥å°±é è°ƒåº¦çº¿ç¨‹æ¥åšäº†ã€‚ Actoræ¨¡å‹çš„è°ƒåº¦å®ç°èµ·ç è¦æœ‰ï¼š 1.ä¸€ä¸ªä½äºä¸»çº¿ç¨‹çš„Actoré˜Ÿåˆ—ï¼Œå¦‚global_queue gq,å½“æŸä¸ªActoræ”¶åˆ°æ¶ˆæ¯æ—¶ï¼Œå°±ä¼šè¢«æ”¾è¿›è¿™ä¸ªgpï¼Œç­‰å¾…å·¥ä½œçº¿ç¨‹è¿›è¡Œè°ƒåº¦ã€‚ 2.nä¸ªå·¥ä½œçº¿ç¨‹ï¼Œè¿™ä¸ªå°±è¦æ ¹æ®æœºå™¨çš„æ ¸æ•°æ¥å†³å®šå¼€å¤šå°‘ä¸ªäº†ï¼Œä¾‹å¦‚åªæ˜¯ä¸€å°åŒæ ¸çš„æœºå™¨ï¼Œé‚£ä¹ˆå¼€ä¸€ä¸ªå°±å¥½äº†ï¼Œå¼€å¤šäº†ä¼šæµªè´¹æ—¶é—´åœ¨çº¿ç¨‹åˆ‡æ¢ä¸Šï¼Œå¾—ä¸å°è¯•ã€‚æ¯ä¸ªå·¥ä½œçº¿ç¨‹åšçš„äº‹ä»¶å¾ˆç®€å•ï¼Œå‘ä¸»çº¿ç¨‹è¯¢é—®ä»»åŠ¡ï¼Œè·å–ä»»åŠ¡ï¼Œå¤„ç†ä»»åŠ¡ï¼Œç„¶ååˆç»§ç»­è¯¢é—®ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š12345while(true)&#123; task_list = fetch_task(); process_task(task_list);&#125; æ‰€ä»¥ä¸€ä¸ªActorçš„åˆ›å»ºå’Œè°ƒåº¦è¿‡ç¨‹å¦‚ä¸‹ï¼š1.åœ¨ä¸»çº¿ç¨‹åˆ›å»ºå¹¶æ”¾å…¥ç®¡ç†åˆ—è¡¨2.å…¶ä»–actorå¾€æœ¬actorå‘é€æ¶ˆæ¯ï¼Œæ¶ˆæ¯è¿›å…¥msg_queue,æœ¬actorè¿›å…¥global_queueç­‰å¾…è°ƒåº¦ã€‚3.æœ‰å·¥ä½œçº¿ç¨‹å¤„ç†å®Œä¸€å †ä»»åŠ¡äº†ï¼Œå‘ä¸»çº¿ç¨‹è¯¢é—®ä»»åŠ¡ï¼Œä¸»çº¿ç¨‹æŠŠæœ¬actoråˆ†é…ç»™è¿™ä¸ªå·¥ä½œçº¿ç¨‹ã€‚4.è¯¥å·¥ä½œçº¿ç¨‹å–å‡ºmsgï¼Œè°ƒç”¨actorç›¸åº”å¤„ç†å‡½æ•°å¤„ç†è¿™ä¸ªæ¶ˆæ¯ã€‚ æ‰€ä»¥å¯è§ï¼Œactoræ•°ç›®äºå·¥ä½œçº¿ç¨‹æ•°ç›®æ²¡æœ‰å¿…ç„¶çš„å…³ç³»ï¼Œå½“ç„¶ç†æƒ³çŠ¶æ€æ˜¯ï¼Œæ¯ä¸ªactoréƒ½æœ‰è‡ªå·±çš„å¤„ç†çº¿ç¨‹ï¼Œè¿™é‡Œæœ‰æ¶ˆæ¯æ¥åˆ°æ—¶ï¼Œå°±å¯ä»¥é©¬ä¸Šå¤„ç†ï¼Œä¸ç”¨ç­‰å¾…ã€‚ ç†è®ºä¸Šï¼Œactorå¼€çš„è¶Šå¤šï¼Œä¸šåŠ¡é€»è¾‘å°±åˆ†çš„è¶Šç»†ï¼Œæ¯æ¬¡å¤„ç†çš„æ—¶é—´å°±è¶ŠçŸ­ï¼Œåªè¦actorçš„æ•°ç›®è¶…è¿‡çº¿ç¨‹æ•°ï¼Œå°±å¯ä»¥æœ€å¤§é™åº¦åˆ©ç”¨å¤šæ ¸çš„ä¼˜åŠ¿ï¼Œcpuçš„è°ƒåº¦å°±è¶Šå……åˆ†ã€‚æ‰€ä»¥actoræ¨¡å‹è®¾è®¡å…³é”®åœ¨äºå¦‚ä½•å°†ä¸šåŠ¡é€»è¾‘å¹³æ‘Šåˆ°æ›´å¤šçš„actorä¸Šï¼Œè€Œä¸æ˜¯é›†ä¸­ï¼Œä¾‹å¦‚ä¸Šé¢æåˆ°global_logicæ˜¯å¤šäººç©æ³•çš„ä¸šåŠ¡é€»è¾‘ï¼Œåªè¦ä¸€ç»†åˆ†ï¼Œå¯ä»¥åˆ†æˆå¸®ä¼šactor,ç»„é˜Ÿactor,æˆ˜æ–—actorç­‰ç­‰ï¼Œè¿™æ ·ä¸‰ä¸ªæ¶ˆæ¯åŒæ—¶å°±æœ‰æœºä¼šè¢«ä¸‰ä¸ªcpuå¤„ç†ï¼Œè€Œä¸æ˜¯å›ºå®šåªæœ‰ä¸€ä¸ªã€‚ Actorå¯ä»¥ç†è§£æˆç”¨æˆ·çº§åˆ«çš„è¿›ç¨‹ï¼Œäºæ“ä½œç³»ç»Ÿçº§åˆ«çš„è¿›ç¨‹åˆ†ç¦»ï¼Œå³ä½¿å¼€å¾ˆå¤šActorï¼Œåªè¦å·¥ä½œçº¿ç¨‹æ•°ç›®è®¾è®¡åˆç†ï¼ˆ&lt;=ç³»ç»Ÿcpuæ ¸æ•°),å°±èƒ½ä¿è¯çº¿ç¨‹èƒ½ä¸€ç›´åœ¨åŒä¸€ä¸ªcpuä¸Šè¿›è¡Œæ“ä½œï¼Œå‡å°‘çº¿ç¨‹åˆ‡æ¢çš„æ¶ˆè€—ï¼Œè¿™å¯¹äºcpuæ ¸æ•°å°çš„æœºå™¨éå¸¸æ¸¸æ³³ï¼Œè€Œå¯¹äºåƒ24æ ¸çš„æœºå™¨ï¼Œå› ä¸ºå¼€è¾Ÿçš„çº¿ç¨‹æ•°æ˜¯é…ç½®çš„ï¼Œæ‰€ä»¥ä¹Ÿå¾ˆå¥½è§„åˆ’ä¸€å°æœºå™¨èƒ½éƒ¨ç½²å¤šå°‘ä¸ªæœã€‚è€Œå¤šçº¿ç¨‹å¦‚æœè¦å¯¹æŸäº›åŠŸèƒ½è¿›ç¨‹æ‰©å±•ï¼Œå¦‚å¢åŠ login,å¢åŠ Logic,å°±æ˜¯è¦å¢åŠ ä¸€ä¸ªç³»ç»Ÿçº¿ç¨‹ï¼Œä¸€æ—¦è¿›ç¨‹è¶…è¿‡cpuæ ¸ï¼Œå°±ä¼šæœ‰æ—¶é—´æµªè´¹åœ¨åˆ‡æ¢çº¿ç¨‹ä¸Šäº†ï¼Œè¿™æ˜¯ä¸€ä¸ªç¼ºç‚¹ã€‚è€ŒActoræ¨¡å‹æœ¬èº«æ˜¯ä¼˜ç§€çš„ï¼Œä½†æ˜¯Actorçš„è°ƒåº¦ç®—æ³•ä¼šæœ‰å¾ˆå¤šä¸­å®ç°ï¼Œè€Œä¸”å¿…ç„¶æ¶‰åŠåˆ°é”çš„æ¶‰åŠï¼Œè¿™å°±éœ€è¦è®¾è®¡è€…çš„è®¾è®¡åŠŸåŠ›äº†ã€‚]]></content>
      <tags>
        <tag>Server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JVMçš„æ–°ç”Ÿä»£ã€è€å¹´ä»£ã€MinorGCã€MajorGC]]></title>
    <url>%2F2018%2F03%2F21%2FJVM-heap%2F</url>
    <content type="text"><![CDATA[JVMä¸­çš„å †ï¼Œä¸€èˆ¬åˆ†ä¸ºä¸‰å¤§éƒ¨åˆ†ï¼šæ–°ç”Ÿä»£ã€è€å¹´ä»£ã€æ°¸ä¹…ä»£ï¼šä¸€ã€æ–°ç”Ÿä»£ä¸»è¦æ—¶ç”¨æ¥å­˜æ”¾æ–°ç”Ÿçš„å¯¹è±¡ã€‚ä¸€èˆ¬å æ®å †çš„1/3ç©ºé—´ã€‚ç”±äºé¢‘ç¹åˆ›å»ºå¯¹è±¡ï¼Œæ‰€ä»¥æ–°ç”Ÿä»£ä¼šé¢‘ç¹å‘MinorGCè¿›è¡Œåƒåœ¾å›æ”¶ã€‚æ–°ç”Ÿä»£åˆåˆ†ä¸ºEdenåŒºã€ServivorFromã€ServivorToä¸‰ä¸ªåŒºã€‚]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JVMåˆæ¢ï¼šå†…å­˜åˆ†é…ã€GCåŸç†ä¸åƒåœ¾æ”¶é›†å™¨]]></title>
    <url>%2F2018%2F03%2F21%2FJVM%2F</url>
    <content type="text"><![CDATA[JVMå†…å­˜çš„åˆ†é…ä¸å›æ”¶å¤§è‡´å¯åˆ†ä¸ºå¦‚ä¸‹4ä¸ªæ­¥éª¤ï¼šä½•æ—¶åˆ†é…-ã€‹æ€æ ·åˆ†é…-ã€‹ä½•æ—¶å›æ”¶-ã€‹æ€æ ·å›æ”¶ï¼Œé™¤äº†åœ¨æ¦‚å¿µä¸Šå¯ç®€å•è®¤ä¸ºnewæ—¶åˆ†é…å¤–ï¼Œæˆ‘ä»¬ç€é‡ä»‹ç»åé¢ä¸‰ä¸ªæ­¥éª¤ 1.æ€æ ·åˆ†é…-ã€‹JVMå†…å­˜åˆ†é…ç­–ç•¥å¯¹è±¡å†…å­˜ä¸»è¦åˆ†é…åœ¨EdenåŒºï¼Œå¦‚æœå¯ç”¨äº†æœ¬åœ°çº¿ç¨‹åˆ†é…ç¼“å­˜ï¼Œåˆ™æœ‰é™åœ¨TLABä¸Šåˆ†é…ï¼Œå°‘æ•°æƒ…å†µèƒ½ä¼šç›´æ¥åˆ†é…åœ¨è€å¹´ä»£ï¼Œæˆ–è¢«æ‹†åˆ†æˆæ ‡é‡ç±»å‹åœ¨æ ˆä¸Šåˆ†é…ï¼ˆJITä¼˜åŒ–ï¼‰ã€‚åˆ†é…çš„è§„åˆ™å¹¶ä¸æ˜¯ç™¾åˆ†ç™¾å›ºå®šï¼Œç»†èŠ‚ä¸»è¦å–å†³äºåƒåœ¾æ”¶é›†å™¨ç»„åˆï¼Œä»¥åŠVMå†…å­˜ç›¸å…³çš„å‚æ•°ã€‚]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[String-StringBuffer-StringBuilder]]></title>
    <url>%2F2018%2F03%2F21%2FString-StringBuffer-StringBuilder%2F</url>
    <content type="text"><![CDATA[JAVAString å­—ç¬¦ä¸²å¸¸é‡StringBuffer å­—ç¬¦ä¸²å˜é‡ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰StringBuilder å­—ç¬¦ä¸²å˜é‡ï¼ˆéçº¿ç¨‹å®‰å…¨ï¼‰Stringç±»å‹å’ŒStringBufferç±»å‹çš„ä¸»è¦æ€§èƒ½åŒºåˆ«å…¶å®åœ¨äºStringæ˜¯ä¸å¯å˜çš„å¯¹è±¡ï¼Œå› æ­¤æ¯æ¬¡å¯¹Stringç±»å‹è¿›è¡Œæ”¹å˜çš„æ—¶å€™å…¶å®éƒ½ç­‰åŒäºç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ï¼Œç„¶åå°†æŒ‡é’ˆæŒ‡å‘æ–°çš„Stringå¯¹è±¡ï¼Œæ‰€ä»¥ç»å¸¸æ”¹å˜å†…å®¹çš„å­—ç¬¦ä¸²æœ€å¥½ä¸è¦ç”¨Stringï¼Œå› ä¸ºæ¯æ¬¡ç”Ÿæˆå¯¹è±¡éƒ½ä¼šå¯¹ç³»ç»Ÿæ€§èƒ½äº§ç”Ÿå½±å“ï¼Œç‰¹åˆ«å½“å†…å­˜ä¸­æ— å¼•ç”¨å¯¹è±¡å¤šäº†ä»¥åï¼ŒJVMçš„GCå°±ä¼šå¼€å§‹å·¥ä½œï¼Œ CStringå’ŒJAVAä¸­çš„ä¸€æ ·]]></content>
  </entry>
  <entry>
    <title><![CDATA[Unityæ‰‹æ¸¸å¼€å‘-ä½¿ç”¨Luaæ¥å¼€å‘å¤§å‹æ¸¸æˆï¼ˆä¸‹ï¼‰]]></title>
    <url>%2F2018%2F03%2F19%2FUnity-Lua-2%2F</url>
    <content type="text"><![CDATA[åŸºæœ¬åŸç†Hotfixçš„åŸºæœ¬åŸç†ä¾ç„¶æ˜¯åŸºäºåŠ¨æ€è¯­è¨€çš„ReloadåŠŸèƒ½ï¼Œæ›´åŠ å‡†ç¡®çš„è¯´æ˜¯Function Reloadã€‚ä¸‹å›¾ç®€å•æè¿°äº†æ•´ä¸ªHotfixçš„æµç¨‹ï¼šæ›´åŠ å…·ä½“åœ°å¯ä»¥æè¿°ä¸ºï¼š1.ç¨‹åºå‘ç°è¦ä¿®å¤çš„bugï¼Œç¼–å†™ç‰¹æ®Šçš„Hotfixä»£ç è¿›è¡Œä¿®å¤ï¼Œæµ‹è¯•é€šè¿‡åä¸Šä¼ svnæœåŠ¡å™¨ï¼›2.é€šè¿‡å‘å¸ƒæŒ‡ä»¤ï¼Œå°†svnä¸Šæ›´æ–°åçš„Hotfixä»£ç åŒæ­¥åˆ°æœåŠ¡å™¨ä¸Šï¼›3.æœåŠ¡å™¨å‘ç°Hotfixä»£ç æœ‰æ›´æ–°ï¼Œåˆ™å°†å…¶å‹ç¼©åºåˆ—åŒ–åé€šè¿‡socketå‘é€ç»™æ‰€æœ‰åœ¨çº¿çš„å®¢æˆ·ç«¯ï¼ŒåŒæ—¶å¸¦ä¸Šå­—ç¬¦ä¸²çš„MD5å€¼ä¾›å®¢æˆ·ç«¯éªŒè¯ï¼›4.å®¢æˆ·ç«¯æ”¶åˆ°Hotfixæ¶ˆæ¯ä¹‹åï¼Œé¦–å…ˆååºåˆ—åŒ–æ•°æ®å¾—åˆ°ä»£ç å†…å®¹ï¼Œæ ¡éªŒMD5å€¼ä¹‹åï¼Œå¦‚æœå’Œæœ¬åœ°å·²ç»æ‰§è¡Œè¿‡çš„Hotfixçš„MD5å€¼ï¼Œåˆ™æ‰§è¡Œæ›¿æ¢é€»è¾‘ï¼Œå¹¶è®°å½•å½“å‰å·²ç»æ‰§è¡Œè¿‡çš„Hotfixçš„MD5å€¼ï¼Œå¦‚æœç›¸åŒåˆ™ä¸å†æ‰§è¡Œï¼›5.å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨çš„æ—¶å€™ä¼šä¸»åŠ¨è¯·æ±‚ä¸€æ¬¡Hotfixã€‚ å®ç°æ–¹å¼(é¡¹ç›®é€šè¿‡æ‰“ä¸€ä¸ªæ›´æ–°åŒ…æ¥å®ç°ï¼Œå¦‚æœæ˜¯è¡¨æ ¼çš„è¯å¯ä»¥èµ°Hotfix)æ‰§è¡ŒHotfixæ‰§è¡Œçš„ä»£ç éå¸¸ç®€å•ï¼ŒåŸºäºloadstringå‡½æ•°å³å¯ï¼š1234local f = loadstring(GameContent.HotfixData)if f then ClientUtils.trycall(f)end è¿™é‡Œçš„å®ç°å°±æ²¡æœ‰reloadé‚£ä¹ˆå¤æ‚ï¼Œä½†æ˜¯ä¹Ÿæ˜¯æœ‰ä¸€å®šçš„é™åˆ¶ï¼Œæ¯”å¦‚localçš„å‡½æ•°æˆ–è€…åœ¨é—­åŒ…çš„å‡½æ•°ä¾ç„¶å¾ˆéš¾åšæ­£ç¡®çš„hotfix,éœ€è¦ç¼–å†™ç‰¹æ®Šçš„Hotfixä»£ç ã€‚ å‘luaä¸­æ³¨å†Œcå‡½æ•°çš„è¿‡ç¨‹æ˜¯é€šè¿‡lua_pushcclosure(luaState, fn, n)å‡½æ•°å®ç°çš„]]></content>
      <tags>
        <tag>Lua</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Markdown]]></title>
    <url>%2F2018%2F03%2F19%2Fmarkdown%2F</url>
    <content type="text"><![CDATA[ä»£ç å¼•ç”¨ éœ€è¦å¼•ç”¨ä»£ç æ—¶ï¼Œå¦‚æœå¼•ç”¨çš„è¯­å¥åªæœ‰ä¸€æ®µï¼Œä¸åˆ†è¡Œï¼Œå¯ä»¥ç”¨`å°†è¯­å¥åŒ…èµ·æ¥ã€‚ å¦‚æœå¼•ç”¨çš„è¯­å¥ä¸ºå¤šè¡Œï¼Œå¯ä»¥å°†```ç½®äºè¿™æ®µä»£ç çš„é¦–è¡Œå’Œæœ«è¡Œã€‚]]></content>
      <tags>
        <tag>Markdown</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity-Lua]]></title>
    <url>%2F2018%2F03%2F19%2FUnity-Lua-1%2F</url>
    <content type="text"><![CDATA[é€»è¾‘ä½¿ç”¨è„šæœ¬æ¥åšçš„å¥½å¤„ï¼š ä½¿ç”¨è„šæœ¬è¯­è¨€çš„åŠ¨æ€ç‰¹æ€§ï¼Œå®¢æˆ·ç«¯å¯ä»¥åšHotfix,æœåŠ¡å™¨å¯ä»¥åšRefreshï¼Œæ— è®ºåœ¨è¿è¥è¿˜æ˜¯å¼€å‘æœŸè¿™ä¸€ç‰¹æ€§éƒ½å¾ˆæœ‰ç”¨ï¼› è„šæœ¬è¯­è¨€åœ¨è™šæ‹Ÿæœºè¿è¡Œï¼Œæœ‰æ•ˆæ§åˆ¶å´©æºƒç‡ ä¸Šæ‰‹éš¾åº¦ä½ç¼ºç‚¹æ˜¯è¿è¡Œæ•ˆç‡ä½ï¼Œä½†æ˜¯ä¹‹å‰çœ‹çš„LuaJitçš„æ•ˆç‡åªæ˜¯ç•¥ä½äºcï¼ˆæœ‰å¾…éªŒè¯),åŠ¨æ€è¯­è¨€å®¹æ˜“å‡ºä¸€äº›è¿è¡Œæ—¶é”™è¯¯ï¼ˆä¸€èˆ¬æ˜¯è¯­æ³•é”™è¯¯ï¼‰ï¼Œä½†æ˜¯è°ƒè¯•éš¾åº¦åœ¨çœŸæœºä¸‹ç›¸å¯¹å®¹æ˜“ä¸€äº›luaçš„é›†æˆåœ¨ç›®å‰ç»´æŠ¤çš„è¿™ä¸ªé¡¹ç›®é›†æˆäº†uLua(æ„Ÿè§‰ç®—æ˜¯toLuaçš„å‰èº«å§)å’ŒsLua(è…¾è®¯çš„SDKé›†æˆçš„).å…·ä½“æ€§èƒ½å¯¹æ¯”è‡ªå·±å°±ä¸æµ‹è¯•äº†ï¼Œï¼ˆæ‡’ï¼‰åœ¨è¿™é‡Œå¯ä»¥çœ‹åˆ°http://link.zhihu.com/?target=http%3A//qiankanglai.me/2016/07/31/unity-lua/æ€§èƒ½å·®å¼‚çš„å¯èƒ½åŸå› ä¹‹ä¸€ä¸ªäººæ„Ÿè§‰ToLuaåœ¨å±æ€§æ“ä½œæ–¹é¢æ€§èƒ½è¾ƒå¥½ï¼Œè€ŒVectoreçš„å‘é‡æ“ä½œï¼Œå› ä¸ºå¯èƒ½ä¼šæœ‰Luaå±‚çš„ä¼˜åŒ–ï¼Œå³åœ¨Luaå±‚å®Œå…¨å®ç°äº†å¯¹åº”çš„æ“ä½œï¼ˆvector.bytes),å› æ­¤éœ€è¦é’ˆå¯¹æºç è¿›è¡Œè¯¦ç»†çš„å¯¹æ¯”ã€‚è‡³äºæ€§èƒ½å·®å¼‚çš„åŸå› ï¼Œæˆ‘æ²¡æœ‰ä»Luaè™šæ‹Ÿæœºçš„å®ç°éƒ¨åˆ†åˆ†æï¼Œåªæ˜¯æŸ¥çœ‹ä¸¤ç§ç”Ÿæˆçš„Warpåçš„æ¥å£è¿›è¡Œä¸€ä¸ªç®€å•çš„çŒœæƒ³ã€‚é€‰å–åŒä¸€ä¸ªæ¥å£è¿›è¡Œå¯¹æ¯”ï¼ŒUnityEngine.Animatorçš„GetFloatæ¥å£ï¼ŒToLuaçš„å®ç°å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526[MonoPInvokeCallbackAttribute(typeof(LuaCSFunction))]static int GetFloat(IntPtr L)&#123; try &#123; int count = LuaDLL.lua_gettop(L); if (count == 2 &amp;&amp; TypeChecker.CheckTypes(L, 1, typeof(UnityEngine.Animator), typeof(int))) &#123; UnityEngine.Animator obj = (UnityEngine.Animator)ToLua.ToObject(L, 1); int arg0 = (int)LuaDLL.lua_tonumber(L, 2); float o = obj.GetFloat(arg0); LuaDLL.lua_pushnumber(L, 0); return 1; &#125; //æ­¤å¤„çœç•¥å¦ä¸€ä¸ªé‡è½½æ¥å£ else &#123; return LuaDLL.luaL_throw(L, "invalid arguments to method: UnityEngine.Animator.GetFloat"); &#125; &#125; catch(Exception e) &#123; return LuaDLL.toluaL_exception(L, e); &#125;&#125; SLuaç”Ÿæˆçš„ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122[MonoPInvokeCallbackAttribute(typeof(LuaCSFunction))]static public int GetFloat(IntPtr l)&#123; try &#123; int argc = LuaDLL.lua_gettop(l); if(matchType(l, argc, 2, typeof(int))) &#123; UnityEngine.Animator self = (UnityEngine.Animator)checkSelf(l); System.Int32 a1; checkType(l, 2, out a1); var ret = self.GetFloat(a1); pushValue(1, true); pushValue(1, ret); return 2; &#125; catch(Exception e) &#123; return error(1,e); &#125; &#125;&#125; æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œè¿™ä¸€å‡½æ•°åªéœ€è¦ä¸€ä¸ªè¿”å›å€¼çš„ï¼Œä½†æ˜¯SLuaå¾€æ ˆé‡ŒpushValueäº†ä¸¤ä¸ªå€¼ï¼Œç„¶åè¿”å›2ã€‚SLuaä½¿ç”¨ä¸€ä¸ªå•ç‹¬çš„å€¼æ¥è¡¨ç¤ºå‡½æ•°è¿è¡Œçš„ç»“æœï¼Œè¿™å¯¹äºé”™è¯¯å¯ä»¥è¿›è¡Œæ›´å¥½çš„å¤„ç†ï¼Œä½†æ˜¯å¤šå‡ºçš„å‹æ ˆå’Œå‡ºæ ˆæ“ä½œæœ‰é¢å¤–çš„æ€§èƒ½æ¶ˆè€—ã€‚ å¯¼å‡ºæ–¹å¼å¯¹æ¯”ToLuaå¯¼å‡ºçš„ä½¿ç”¨çš„æ˜¯ç™½åå•çš„æ–¹å¼ï¼Œåœ¨CustomeSetting.csæ–‡ä»¶ä¸­å®šä¹‰çš„æ¥å£æ‰ä¼šå¯¼å‡ºï¼Œä¹Ÿæä¾›äº†å¯¼å‡ºå¼•æ“æ‰€æœ‰çš„æ¥å£åŠŸèƒ½ï¼›è€ŒSLuaæ˜¯ä»¥é»‘åå•çš„æ–¹å¼è¿›è¡Œï¼Œé»˜è®¤æä¾›çš„åŠŸèƒ½æ˜¯å¯¼å‡ºäº†é™¤äº†é»‘åå•ä¸­çš„æ‰€æœ‰æ¨¡å—æ¥å£ï¼Œä¹Ÿæ˜¯äº†ä¸€ä¸ªå¯¼å‡ºæœ€ç®€æ¥å£çš„æ–¹å¼ã€‚ä»ä½¿ç”¨è§’åº¦æ¥çœ‹ï¼ŒSLuaé»‘åå•çš„æ–¹å¼åœ¨å¼€å‘æœŸæ¯”è¾ƒæ–¹ä¾¿ï¼Œé»˜è®¤ä¼šå¯¼å‡ºæ‰€æœ‰æ¥å£ï¼Œå› æ­¤ä¸éœ€è¦æ¯æ¬¡æƒ³è¦å¢åŠ ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç±»Luaæ¥å£éƒ½è¦è‡ªå·±å®šä¹‰ç„¶åé‡æ–°å¯¼å‡ºï¼Œå‘å¸ƒçš„æ—¶å€™ä¹Ÿå¯ä»¥ä½¿ç”¨æœ€ç®€æ¥å£ã€‚ç»´æŠ¤èµ·æ¥ToLuaå› ä¸ºæ‰€æœ‰çš„å¯¼å‡ºç±»éƒ½æ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ï¼Œå› æ­¤æ›´åŠ æ¸…æ™°æ˜ç¡®ã€‚é‰´äºè¿™éƒ¨åˆ†å†…å®¹æœ‰æºç å¯ä»¥è¿›è¡Œä¿®æ”¹ ï¼Œå› æ­¤ä¸æ˜¯ä¸€ä¸ªæ ¸å¿ƒéœ€è¦è€ƒè™‘çš„å†…å®¹ï¼Œä¸¤ç§æ–¹å¼å„æœ‰åˆ©å¼Šã€‚ å¦‚ä½•ä½¿ç”¨Luaè¯­è¨€åœ¨è¿›è¡Œäº†åˆæ­¥é›†æˆåï¼Œæ€æ ·è®©å¼€å‘äººå‘˜å¯ä»¥æ›´å¥½åœ°ä½¿ç”¨Luaè¯­è¨€æ˜¯æ¥ä¸‹æ¥é¢ä¸´çš„é—®é¢˜ã€‚ToLuaå¯¹åº”æœ‰ä¸€å¥—ä¹‹å‰uLuaä½œè€…å¼€å‘çš„LuaFrameworkï¼Œè¿™ä¸€æ¡†æ¶é›†æˆäº†è„šæœ¬æ‰“åŒ…å’ŒäºŒè¿›åˆ¶è„šæœ¬è¯»å–ï¼ŒUIåˆ¶ä½œæµç¨‹ç­‰å¤šä¸ªåŠŸèƒ½ï¼Œä½†æ˜¯ä¹Ÿå¦‚ä½œè€…è‡ªå·±æ‰€æœ‰ï¼Œè¿™ä¸€æ¡†æ¶æœ€åˆæºè‡ªä¸€ä¸ªç¤ºä¾‹å½¢å¼çš„Demoï¼Œå› æ­¤å…¶ä¸­ä»£ç æœ‰å¾ˆå¤šéƒ¨åˆ†æ˜¯å’Œç¤ºä¾‹å†™æ­»çš„ç»‘å®šçš„é€»è¾‘ï¼Œæ¯”å¦‚å¯åŠ¨é€»è¾‘ï¼ŒLuaäºŒè¿›åˆ¶è„šæœ¬çš„åŠ è½½éœ€è¦æ‰‹åŠ¨æŒ‡å®šç­‰ç­‰ã€‚ç›¸å¯¹åº”çš„ï¼ŒSLuaä¹Ÿæœ‰å¤šå¥—å·²ç»å¼€æºçš„æ¡†æ¶ï¼Œå…¶ä¸­æœ€ä¸ºå®Œå–„çš„KSFramworkï¼Œè¿™å¥—æ¡†æ¶é›†æˆäº†èµ„æºæ‰“åŒ…ï¼Œå¯¼è¡¨ï¼ŒLuaçƒ­é‡è½½åœ¨å†…çš„å¤šä¸ªåŠŸèƒ½ï¼Œè€Œä¸”ä»£ç è´¨é‡åˆæ­¥å¼€èµ·æ¥è¿˜ä¸é”™ï¼Œå› æ­¤æœ€åæˆ‘ä»¬å†³å®šæŠŠKSFramworkä¸­çš„SLuaéƒ¨åˆ†æ›¿æ¢æˆToLuaçš„éƒ¨åˆ†æ¥ç»“åˆä½¿ç”¨ã€‚æ”¹é€ çš„è¿‡ç¨‹è¿˜æ¯”è¾ƒç®€å•ï¼Œç”±äºè¯¥éƒ¨åˆ†ä½¿ç”¨Luaè€¦åˆçš„åªæœ‰ä¸¤å—å†…å®¹ï¼Œä¸€æ˜¯UIControleréƒ¨åˆ†ï¼ŒäºŒæ˜¯LuaBehavioréƒ¨åˆ†ï¼Œæ‰€æœ‰çš„æ¥å£éƒ½ç”±LuaModuleæ¨¡å—æä¾›ã€‚å› æ­¤æ”¹é€ çš„è¿‡ç¨‹ä¹Ÿå°±æ¯”è¾ƒæ˜ç¡®äº†ï¼š1.åˆ é™¤æºä»£ç ä¸­çš„SLuaéƒ¨åˆ†ï¼Œæ¥å…¥ToLuaçš„éƒ¨åˆ†ï¼›2.ä½¿ç”¨ToLuaé‡å†™LuaModuleçš„å®ç°ï¼›3.æ”¹é€ LuaUIControllerï¼Œä½¿ç”¨æ–°çš„LuaModuleæ¥å£å®ç°ä¹‹å‰çš„åŠŸèƒ½ï¼›4.æ”¹é€ LuaBehavioræ¨¡å—ï¼›ä»£ç åˆ é™¤å’ŒLuaModuleæ¨¡å—çš„é‡æ–°å®ç°éƒ½æ¯”è¾ƒç®€å•ï¼Œç€é‡ä»‹ç»ä¸€ä¸‹LuaUIControllerå’ŒLuaBehavioræ¨¡å—çš„æ”¹é€ ã€‚ æ”¹é€ åˆè¡·ä¹‹å‰çš„KSFramworkè¿˜æ˜¯ä¸€ä¸ªæ ¸å¿ƒé€»è¾‘åœ¨C#ï¼ŒLuaåªæ‰¿è½½UIç­‰é€»è¾‘çš„æ¨¡å—ï¼Œå…¶å®ç›®å‰é€»è¾‘ä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œä½†æ˜¯ä¸ªäººæ¯”è¾ƒåŒæ„â€œè½»å¼•æ“ï¼Œé‡è„šæœ¬â€ï¼Œå¼•æ“å¯ä»¥çœ‹ä½œæ¸²æŸ“ï¼Œèµ„æºåŠ è½½ï¼ŒéŸ³æ•ˆç­‰åŠŸèƒ½çš„æä¾›è€…ï¼Œè„šæœ¬é€»è¾‘è´Ÿè´£ä½¿ç”¨è¿™äº›åŠŸèƒ½æ„å»ºæ¸¸æˆå†…å®¹ã€‚é‚£è¿™æ ·å¤§éƒ¨åˆ†ä¸é€»è¾‘ç›¸å…³çš„æ§åˆ¶æƒå°±åº”è¯¥ä»å¼•æ“äº¤ç»™è„šæœ¬æ¥è¿›è¡Œã€‚Unityä½œä¸ºä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„ä¾‹å­ï¼Œè™½ç„¶å¯¹äºå®ƒæ¥è¯´ï¼ŒC#éƒ¨åˆ†å·²ç»æ˜¯è„šæœ¬äº†ï¼Œä½†æ˜¯å¯¹äºå¸Œæœ›ç€é‡ä½¿ç”¨Luaè„šæœ¬çš„æˆ‘ä»¬æ¥è¯´ï¼Œå› ä¸ºC#ä¸å¯æ›´æ–°ï¼Œå› æ­¤è¢«è§†ä½œäº†å¼•æ“éƒ¨åˆ†ã€‚æœ€ä¸ºç®€å•çš„è®¾è®¡å°±æ˜¯å½“å¼•æ“åˆå§‹åŒ–å®Œæ¯•ä¹‹åï¼Œé€šè¿‡ä¸€ä¸ªæ¥å£è°ƒç”¨æŠŠåç»­çš„é€»è¾‘éƒ½äº¤ç”±è„šæœ¬æ¥æ§åˆ¶ï¼Œå¤§éƒ¨åˆ†ä¸æ¸¸æˆç©æ³•ç›¸å…³çš„æ¨¡å‹åŠ è½½ã€å£°éŸ³æ’­æ”¾ã€ç‰¹æ•ˆæ’­æ”¾ã€åŠ¨ç”»ç­‰ç”±è„šæœ¬æ§åˆ¶ã€‚tické€»è¾‘ä¸ºäº†å‡å°‘è°ƒç”¨æ¬¡æ•°ï¼Œæ²¡å¸§ä¹Ÿç”±å¼•æ“è°ƒç”¨æ³¨å†Œçš„ä¸€ä¸ªè„šæœ¬æ¥å£è¿›è¡Œç»Ÿä¸€è°ƒç”¨ï¼Œè„šæœ¬å±‚è‡ªå·±åšåˆ†å‘ã€‚ LuaUIControllerçš„æ”¹é€ LuaUIControlleråŸå§‹çš„æ–¹å¼æ˜¯åœ¨C#å±‚é€šè¿‡uiæ¨¡å—çš„åç§°åŠ è½½å¯¹åº”çš„ä¸€ä¸ªluaæ–‡ä»¶ï¼Œè·å–ä¸€ä¸ªlua table è¿›è¡Œç¼“å­˜ï¼Œåœ¨æ¯”å¦‚OnInitç­‰éœ€è¦æ¥å£è°ƒç”¨çš„åœ°æ–¹æŸ¥æ‰¾è¿™ä¸ªtableä¸­å¯¹åº”çš„å‡½æ•°è¿›è¡Œè°ƒç”¨ã€‚è¿™ç§æ–¹å¼çš„ç•Œé¢æ˜¯ç”±C#å±‚çš„é€»è¾‘æ¥é©±åŠ¨åŠ è½½å’Œæ˜¾ç¤ºçš„ï¼Œè€Œä¸”åœ¨åŠ è½½è¿‡ç¨‹è¦æœ‰æ–‡ä»¶çš„æœç´¢å’Œæ£€æŸ¥è¿‡ç¨‹ã€‚è¿™æ ·ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯è„šæœ¬å±‚çš„é€»è¾‘æ— æ³•æˆ–è€…å¾ˆéš¾æˆ–è€…å¾ˆéš¾å»æ§åˆ¶ç•Œé¢å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚é’ˆå¯¹èµ„æºçš„ç”Ÿå‘½å‘¨æœŸï¼Œâ€œè°åˆ›å»ºè°ç®¡ç†â€çš„ç­–ç•¥ä¸åœ¨å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ¥æ˜ç¡®è´£ä»»çš„åˆ’åˆ†ï¼Œå› æ­¤è¦è¿›è¡Œæ”¹é€ ã€‚æ”¹é€ çš„æ–¹å‘å¾ˆç®€å•ï¼Œè®²ç•Œé¢åœ¨å®¶å’Œæ˜¾ç¤ºçš„æ¥å£å¼€æ”¾åˆ°Luaå±‚ï¼Œç„¶ååœ¨åˆ›å»ºçš„æ—¶å€™ç”±luaå±‚ä¼ é€’ä¸€ä¸ªtableå¯¹è±¡è¿›æ¥ï¼ŒC#ä¸­è¿›è¡Œç¼“å­˜ï¼Œå½“ç•Œé¢èµ„æºå¼‚æ­¥åŠ è½½å®Œæ¯•ï¼Œéœ€è¦è¿›è¡Œæ¥å£è°ƒç”¨çš„åœ°æ–¹çš„å®ç°ä¸ä¹‹å‰ä¿å­˜ä¸€è‡´ã€‚è¿™æ ·ï¼Œç•Œé¢èµ„æºçš„ç”Ÿå‘½å‘¨æœŸå…¨éƒ¨äº¤ç”±è„šæœ¬å±‚æ¥ç®¡ç†ï¼Œåœ¨è„šæœ¬æ„å»ºä¸€ä¸ªç»“æ„åˆç†åŠŸèƒ½é½å…¨çš„UIManageræ¥è¿›è¡Œä¸€äº›åŠŸèƒ½çš„å°è£…ï¼Œå°±å¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†çš„éœ€æ±‚ã€‚ LuaBehaviorçš„æ”¹é€ MonoBehavioræ˜¯Unityä¸ºäº†æ–¹ä¾¿å¼€å‘è€Œæä¾›çš„ä¸€ä¸ªå¾ˆå¥½çš„åŠŸèƒ½ï¼Œè„šæœ¬ä»¥ç»„ä»¶çš„æ–¹å¼æŒ‚æ¥åœ¨GameObjectèº«ä¸Šï¼Œå°±å¯ä»¥åœ¨Awake,Start,Updateç­‰æ¥å£ä¸­å¤„ç†æƒ³è¦çš„é€»è¾‘ã€‚ä¸ºäº†èƒ½å¤Ÿç»§ç»­ä½¿ç”¨Unityçš„è¿™ä¸€ç‰¹æ€§ï¼Œåœ¨Luaå±‚ä¹Ÿå®ç°äº†ä¸€ä¸ªç®€å•çš„LuaBehaviorå°è£…ã€‚KSFramworkä¸­çš„æ€è·¯éå¸¸ç®€å•ï¼ŒåŒæ ·æ ¹æ®åç§°æ¥æŠŠä¸€ä¸ªLuaBehaviorå’Œä¸€ä¸ªLuaè„šæœ¬è¿›è¡Œç»‘å®šï¼Œåœ¨å¯¹åº”çš„é€»è¾‘ä¸­è°ƒç”¨ä¸ä¹‹å¯¹åº”çš„æ¥å£å°±å¯ä»¥äº†ï¼Œæ¯”å¦‚Awakeæ¥å£çš„å®ç°å¦‚ä¸‹ï¼š12345678protected virtual void Awake()&#123; if (!string.IsNullOrEmpty(LuaPath)) &#123; Init(); CallLuaFunction("Awake"); &#125;//else Null Lua Path, pass Awake!&#125; CallLuaFunctionçš„å®ç°ä¹Ÿå¾ˆæ˜ç¡®ï¼Œä»ç¼“å­˜çš„lua tableä¸­è·å–åç§°ä¸ºAwakeçš„functionè¿›è¡Œè°ƒç”¨ã€‚è¿™ç§æ–¹å¼æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å½“åœºæ™¯ä¸­æŒ‚åœ¨äº†LuaBehavior(é¡¹ç›®ä¸­æ˜¯LuaComponent)çš„GameObjectå¾ˆå¤šçš„æ—¶å€™ï¼Œæ¯ä¸€å¸§éƒ½ä¼šæœ‰éå¸¸å¤šæ¬¡çš„update(è¿™ä¸ªå‡½æ•°å°±ä¸è¦æš´éœ²äº†),è¿™ä¸ªè°ƒç”¨ä»C#å±‚ä¼ é€’åˆ°Luaå±‚ï¼Œæœ‰å¾ˆå¤šé¢å¤–çš„æ€§èƒ½æ¶ˆè€—ã€‚å‰æ–‡ä¹Ÿæåˆ°äº†ï¼Œæ¯”è¾ƒå¥½çš„æ–¹å¼æ˜¯æ²¡å¸§åªæœ‰ä¸€ä¸ªC#åˆ°Luaå±‚çš„Updateæ–¹æ³•è°ƒç”¨ï¼Œç„¶åè„šæœ¬å±‚è‡ªå·±åšåˆ†å‘ã€‚å› æ­¤ï¼Œé’ˆå¯¹è¿™ä¸€éœ€æ±‚ï¼Œæˆ‘ä»¬ä½¿ç”¨ToLua#è‡ªå¸¦çš„LuaLooperæ¥å®ç°çš„è¿™ä¸€åŠŸèƒ½ã€‚LuaLooper(é¡¹ç›®æ˜¯è‡ªå·±åŒ…è£…çš„ä¸€ä¸ªluatimer)æ˜¯å…¨å±€åªåˆ›å»ºä¸€ä¸ªçš„MonoBehaviour,æ³¨æ„è¿™é‡Œåªåˆ›å»ºä¸€ä¸ªåªç”±é€»è¾‘æ¥å†³å®šçš„ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå•ä¾‹æ¨¡å¼ã€‚è¿™é‡Œé’ˆå¯¹å•ä¾‹æ¨¡å¼é€‚åˆåœºåˆçš„è®¨è®ºä¸å†å±•å¼€ï¼Œæ­¤å¤„ç”±é€»è¾‘æ¥ä¿è¯åªæœ‰ä¸€ä¸ªLooperå­˜åœ¨æ˜¯ä¸€ä»¶æ¯”è¾ƒåˆç†çš„äº‹æƒ…ï¼Œé¢„ç•™äº†ä¸€äº›æ‰©å±•çš„å¯èƒ½ã€‚LuaLooperä»¥æ—¶é—´çš„æ–¹å¼è®²ä¸‰ç§Updateåˆ†å‘å‡ºå»ï¼šUpdate,LateUpdate,FixedUpdate,å®ƒåœ¨è‡ªå·±å¯¹åº”çš„å‡½æ•°ä¸­è°ƒç”¨luaStateçš„å¯¹åº”å‡½æ•°æ¥å°†äº‹ä»¶å‘ŠçŸ¥è„šæœ¬ï¼Œè„šæœ¬ä¸­éœ€è¦çš„æ¨¡å—å‘åˆ†å‘æ¨¡å—æ³¨å†Œå›è°ƒæ¥ç›‘å¬äº‹ä»¶,å°±å¯ä»¥åšåˆ°æ¯å¸§åªæœ‰ä¸€æ¬¡Updateè°ƒç”¨äº†ã€‚å…·ä½“çš„ä»£ç å®ç°å¯ä»¥å»çœ‹ToLua#ä¸­çš„LuaLooper.csçš„ç±»å®ç°ã€‚-æ³¨æ„ è¿™é‡Œæœ‰ä¸€ä¸ªå°å¿ƒçš„ç‚¹æ˜¯å½“äº‹ä»¶åœ¨è„šæœ¬å±‚åˆ†å‘çš„æ—¶å€™ï¼Œè¦æ³¨æ„æ‰§è¡Œæ—¶åºé—®é¢˜çš„å½±å“ï¼Œæœ€å¥½èƒ½å¤Ÿä¿è¯ä»»æ„çš„æ‰§è¡Œé¡ºåºéƒ½å¯ä»¥ä¸å½±å“æ¸¸æˆé€»è¾‘çš„ç»“æœï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°å¾ˆéš¾æŸ¥çš„è¯¡å¼‚bugã€‚å¯¹äºAwake,Startç­‰ä¸€æ¬¡æ€§è°ƒç”¨çš„å‡½æ•°ï¼Œç”±äºä¸æ˜¯é¢‘ç¹çš„é€»è¾‘ï¼Œå› æ­¤ä¿ç•™äº†åŸå§‹çš„å®ç°æ–¹å¼ï¼Œè¿™æ ·å¯ä»¥è®©Luaå±‚å¯¹åº”çš„ä»£ç å®ç°æ›´åŠ ç®€æ´ã€‚è€Œä½¿ç”¨äº‹ä»¶æ³¨å†Œçš„æ–¹å¼ï¼Œè®©ä¸éœ€è¦updateé€»è¾‘çš„è„šæœ¬æ²¡æœ‰ä»»ä½•é¢å¤–çš„æ€§èƒ½æ¶ˆè€—ã€‚]]></content>
      <tags>
        <tag>lua</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[XCAAFS]]></title>
    <url>%2F2018%2F03%2F18%2FXCAAFS%2F</url>
    <content type="text"><![CDATA[è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œåº”ç”¨åœ¨ç™»å½•æ¨¡å—ä¸Šï¼Œå¼€æ–°æœçš„æ—¶å€™å…¥å£æµé‡ä¼šå¢å¤§ï¼Œä¸€æ®µæ—¶é—´ä»¥åæµé‡ä¼šé€’å‡æˆ–è€…è¶‹äºå¹³ç¼“ï¼Œå¸‚é¢ä¸Šå·²ç»æœ‰äº†æˆç†Ÿçš„è§£å†³æ–¹æ¡ˆäº†ã€‚ä¸€èˆ¬æœ€å¸¸ç”¨ï¼Œæœ€ç®€å•çš„ä¹Ÿæ˜¯åŸºäºDNSçš„è´Ÿè½½å‡è¡¡ç³»ç»Ÿäº†]]></content>
      <tags>
        <tag>server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[http]]></title>
    <url>%2F2018%2F03%2F18%2Fhttp%2F</url>
    <content type="text"><![CDATA[ä»€ä¹ˆæ˜¯httpè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆHTTPï¼‰çš„è®¾è®¡ç›®çš„æ˜¯ä¿è¯å®¢æˆ·æœºä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ã€‚HTTPçš„å·¥ä½œæ–¹å¼å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹å‰çš„è¯·æ±‚-åº”ç­”åè®® ä¸¤ç§HTTPè¯·æ±‚æ–¹æ³•ï¼šGETå’ŒPOST GET - ä»æŒ‡å®šçš„èµ„æºè¯·æ±‚æ•°æ® POST - å‘æŒ‡å®šçš„èµ„æºæäº¤è¦è¢«å¤„ç†çš„æ•°æ® GETæ–¹æ³•è¯·æ³¨æ„ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆåç§°/å€¼å¯¹ï¼‰æ˜¯åœ¨GETè¯·æ±‚çš„URLä¸­å‘é€çš„ï¼š /test/deme_from.asp?name1=value1&amp;name2=value2 æœ‰å…³GETè¯·æ±‚çš„å…¶å®ƒä¸€äº›æ³¨é‡Šï¼š GETè¯·æ±‚å¯è¢«ç¼“å­˜ GETè¯·æ±‚ä¿ç•™åœ¨æµè§ˆå™¨å†å²çºªå½•ä¸­ GETè¯·æ±‚å¯æ‚²æ”¶è—ä¸ºä¹¦ç­¾]]></content>
      <tags>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[openresty]]></title>
    <url>%2F2018%2F03%2F18%2Fopenresty%2F</url>
    <content type="text"><![CDATA[/usr/local/openresty/luajit:luajitç¯å¢ƒï¼Œluajitç±»ä¼¼äºjavaçš„jit,å³å³æ—¶ç¼–è¯‘ï¼Œluaæ˜¯ä¸€ç§è§£é‡Šè¯­è¨€ï¼Œé€šè¿‡luajitå¯ä»¥å³æ—¶ç¼–è¯‘luaä»£ç åˆ°æœºå™¨ä»£ç ï¼Œå¾—åˆ°å¾ˆå¥½çš„æ€§èƒ½ã€‚/usr/local/openresty/lualib:è¦ä½¿ç”¨çš„luaåº“ï¼Œé‡Œè¾¹æä¾›äº†ä¸€äº›é»˜è®¤çš„luaåº“ï¼Œå¦‚redis,jsonåº“ç­‰ï¼Œä¹Ÿå¯ä»¥æŠŠè‡ªå·±å¼€å‘çš„æˆ–è€…ç¬¬ä¸‰æ–¹æ”¾åœ¨è¿™ï¼›/usr/local/openresty/nginx:å®‰è£…çš„nginx /usr/local/openresty/nginx/sbin/nginx -V æŸ¥çœ‹nginxç‰ˆæœ¬å’Œå®‰è£…çš„æ¨¡å— å¯åŠ¨ nginxnginx -p `pwd`/ -c conf/nginx.conf é‡å¯nginx/usr/local/openresty/nginx/sbin/nginx -s reload nginx.pid no filenginx -c /home/www/conf/nginx.conf add_header directive is not allowed here in]]></content>
      <tags>
        <tag>openresty</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unityæ‰“åŒ…è¯¦ç»†æµç¨‹]]></title>
    <url>%2F2018%2F03%2F13%2FUnity-PGK%2F</url>
    <content type="text"><![CDATA[æ‰“åŒ…ç­–ç•¥ï¼šæŒ‰ç…§ç›®å½•åˆ’åˆ†ç›®å½•è¿›è¡Œåˆ†ç±»é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159&#123; &quot;AssetBundleInfo&quot;: [ &#123; &quot;assetBundleName&quot;: &quot;ui.bytes&quot;, &quot;dirPrefix&quot;: [ &quot;Art/ResExport/GUI/&quot;, &quot;Art/GUI/Atlas/&quot;, &quot;res/GUI/res/&quot;, &quot;res/GUI/&quot; ] &#125;, &#123; &quot;assetBundleName&quot;: &quot;ui_font.bytes&quot;, &quot;dirPrefix&quot;: [ &quot;res/GUI/res/Font/&quot; ] &#125;, &#123; &quot;assetBundleName&quot;: &quot;particles.bytes&quot;, &quot;dirPrefix&quot;: [ &quot;res/Particles/&quot;, &quot;Art/Particles/&quot; ] &#125;, &#123; &quot;assetBundleName&quot;: &quot;gfx.bytes&quot;, &quot;dirPrefix&quot;: [ &quot;res/FX/&quot;, &quot;res/SkillWarning/&quot;, &quot;res/Shader/&quot;, &quot;PluginsScripts/NGUI/Resources/Shaders/&quot;, &quot;Art/Graphics/shader/&quot; ] &#125;, &#123; &quot;assetBundleName&quot;: &quot;misc.bytes&quot;, &quot;dirPrefix&quot;: [ &quot;Art/&quot;, &quot;res/&quot;, &quot;Resources/&quot;, &quot;Plugins/&quot;, &quot;PluginsScripts/&quot;, &quot;Models/&quot; ] &#125;, &#123; &quot;assetBundleName&quot;: .bytes&quot;, &quot;dirPrefix&quot;: [ &quot;Scenes/Assets Skyboxes/&quot; ] &#125;, &#123; &quot;assetBundleName&quot;: &quot;scenes.bytes&quot;, &quot;dirPrefix&quot;: [ &quot;res/Scenes/&quot;, &quot;Scenes/&quot; ] &#125; ], &quot;PackageInfo&quot;: [ &#123; &quot;pkgName&quot;: &quot;cfg&quot;, &quot;dirPrefix&quot;: [ &quot;cfg/&quot; ] &#125;, &#123; &quot;pkgName&quot;: &quot;lang&quot;, &quot;dirPrefix&quot;: [ &quot;Assets/Art/lang&quot; ] &#125;, &#123; &quot;pkgName&quot;: &quot;code&quot;, &quot;dirPrefix&quot;: [ &quot;cfg/&quot;, &quot;mb/&quot;, &quot;Lua/&quot; ] &#125;, &#123; &quot;pkgName&quot;: &quot;gfx&quot;, &quot;dirPrefix&quot;: [ &quot;FX/&quot;, &quot;MaterialEx/&quot;, &quot;Shader/&quot;, &quot;SkillWarning/&quot;, &quot;Textures/&quot;, &quot;Still/&quot;, &quot;bones/&quot;, &quot;weapons/&quot;, &quot;Equips/&quot; ] &#125;, &#123; &quot;pkgName&quot;: &quot;gui&quot;, &quot;dirPrefix&quot;: [ &quot;GUI/&quot; ] &#125;, &#123; &quot;pkgName&quot;: &quot;particles&quot;, &quot;dirPrefix&quot;: [ &quot;Particles/&quot;, &quot;Assets/Art/Particles/&quot; ] &#125;, &#123; &quot;pkgName&quot;: &quot;scenes&quot;, &quot;dirPrefix&quot;: [ &quot;Scenes/&quot;, &quot;scn/&quot; ] &#125;, &#123; &quot;pkgName&quot;: &quot;sounds&quot;, &quot;dirPrefix&quot;: [ &quot;Sounds/&quot;, &quot;Assets/Art/Sounds/&quot; ] &#125;, &#123; &quot;pkgName&quot;: &quot;animations&quot;, &quot;dirPrefix&quot;: [ &quot;Animations/&quot; ] &#125;, &#123; &quot;pkgName&quot;: &quot;scenes_mesh&quot;, &quot;dirPrefix&quot;: [ &quot;Assets/Art/Scene/_Mesh/&quot; ] &#125;, &#123; &quot;pkgName&quot;: &quot;scenes_assets&quot;, &quot;dirPrefix&quot;: [ &quot;Assets/Scenes/&quot; ] &#125;, &#123; &quot;pkgName&quot;: &quot;models&quot;, &quot;dirPrefix&quot;: [ &quot;Assets/Models/&quot; ] &#125;, &#123; &quot;pkgName&quot;: &quot;misc&quot;, &quot;dirPrefix&quot;: [ &quot;Assets/&quot; ] &#125;, &#123; &quot;pkgName&quot;: &quot;pandora&quot;, &quot;dirPrefix&quot;: [ &quot;pandora/&quot; ] &#125; ]&#125; ä¸ä½¿ç”¨Resourcesçš„åŸå› æ˜¯ï¼Œæ‰“åŒ…ç¨‹åºçš„æ—¶å€™ä¼šå°†Resourcesç›®å½•ä¸‹çš„å…¨éƒ¨æ–‡ä»¶éƒ½åŠ å¯†å‹ç¼©è¾¾åˆ°åŒ…å†…ï¼Œè¿™æ ·å¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨assetbundleæ–¹å¼æ‰“å°åŒ…å°±ä¸è¡Œäº†ï¼ˆæ¯”å¦‚æ›´æ–°åŒ…ï¼‰ã€‚1.å¤šè¯­è¨€æ–‡ä»¶å…ˆå¯¼å…¥2.æ ¹æ®é…ç½®æ–‡ä»¶ç”ŸæˆåŒ…ä¿¡æ¯ï¼ŒAssetBundleInfo,AssetBundleIndex3.å¤„ç†Resç›®å½•èµ„æº4.AssetDatabase.GetDependencies12345678910111213141516171819202122232425262728293031323334353637383940414243string nameParam = new string[1];string[] GetDirectDeps(string uri)&#123; DepInfo depInfo = new DepInfo(); nameParam[0] = uri; var deps = AssetDatabase.GetDependenices(nameParem, true);//æŸ¥æ‰¾è¿™ä¸ªèµ„æºå¼•ç”¨äº†å“ªäº›èµ„æº,cså’Œjsæ–‡ä»¶ä¸ç”¨å¤„ç† depInfos[uri] = depInfo;//global return deps;&#125;string[] MakeDepends(string uri)&#123; var deps = GetDirectDeps(uri);&#125;static void addPkgFile(string filePath, bool isCompress, string accessPath, byte fileType, byte loadType)&#123; accessPath = accessPath.ToLower(); PkgInfo.FileInfo fileInfo = NewPkgFileInfo(filePath, isCompress, accessPath, )&#125;public IEnumerator ProcessSounds()&#123; titleText = "å¤„ç†éŸ³é¢‘"; yield return null; string soundsDir = Application.dataPath + "/Art/Sounds"; if (System.IO.Exists(soundsDir)) &#123; int rootSize = Application.dataPath.Length - 6;//Assets string[] file = System.IO.Directory.GetFiles(soundsDir, "*.bank", SearchOption.AllDirectories); foreach (var file in files) &#123; string path = file.SubString(rootSize).ToLower().Replace('\\', '/'); addPkgFile(path, false, 0, 0); addFileProcessed.Add(path); &#125; &#125;&#125;public IEnumerator DoProcess()&#123; yield return ProcessRes(resUri); if (!isRuning) yield return; yield return ProcessSounds();//smod,å› ä¸ºunityè‡ªå¸¦çš„å®¹æ˜“å´©æºƒ&#125;]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Mono-1]]></title>
    <url>%2F2018%2F03%2F13%2FMono-1%2F</url>
    <content type="text"><![CDATA[Monoä¸»è¦åŒ…å«äº†C#çš„ç¼–è¯‘å™¨ï¼ŒCLI(Common Language Infrastructure)å®ç°å’Œä¸€ç³»åˆ—ç›¸å…³çš„å¼€å‘å·¥å…·ã€‚ æºç ç»“æ„msc: msc: Monoå®ç°çš„åŸºäºEcmaæ ‡å‡†çš„C#ç¼–è¯‘å™¨ã€‚ class:CLIçš„C#çš„å®ç°ã€‚ç±»ä¼¼äºAndroidä¸­çš„Javaè¹­ï¼Œåº”ç”¨ç¨‹åºçœ‹åˆ°çš„æ˜¯è¿™ä¸€å±‚æä¾›çš„æ¥å£ã€‚è¿™ä¸€å±‚æ˜¯å¹³å°æ— å…³çš„ã€‚ ilasm:åæ±‡ç¼–å™¨ï¼Œå°†Native codeåæ±‡ç¼–æˆbytecodeã€‚mono: mini:JITç¼–è¯‘å™¨ï¼Œå°†bytecodeç¼–è¯‘æˆnative codeã€‚ metadata:Monoçš„runtime,CLIçš„Nativeçº§çš„ä¸‹å®ç°ã€‚ io-layer:ä¸æ“ä½œç³»ç»Ÿçš„æ¥å£å®ç°ï¼Œåƒsocket,thread,mutexè¿™äº›ã€‚liggc:GCå®ç°çš„ä¸€éƒ¨åˆ†ã€‚ Monoä¸»è¦å·¥ä½œæ¡†æ¶12345678910111213141516171819202122232425262728293031mini/main.c:main() mono_main_with_options() mono_mian() mini_ini() mono_assembly_open() main_thread_handler()//assembly(ä¹Ÿå°±æ˜¯bytecode)çš„ç¼–è¯‘æ‰§è¡Œ mini_cleanup()main_thread_handler() mono_jit_exec() mono_assembly_get_image()//å¾—åˆ°imageä¿¡æ¯ï¼Œå¦‚&quot;test.ext&quot; mono_image_get_entry_point()//å¾—åˆ°ç±»ï¼Œæ–¹æ³•ä¿¡æ¯ mono_runtime_run_main(method,argc,argv,NULL) mono_thread_set_main(mono_thread_current());//æŠŠå½“å‰çº¿ç¨‹è®¾ä¸ºä¸»çº¿ç¨‹ mono_assembly_set_main() mono_runtime_exec_main() //ç¼–è¯‘åŠè°ƒç”¨ç›®æ ‡æ–¹æ³•mono_runtime_exec_main() mono_runtime_invoke(method, NULL, pa, exc)//è¦è°ƒç”¨çš„æ–¹æ³•ï¼Œå¦‚&quot;ClassName::Main()&quot; default_mono_runtime_invoke()//å®é™…ä¸Šæ˜¯è°ƒç”¨äº†mono_jit_runtime_invoke() info-&gt;compiled_method = mono_jit_compile_method_with_opt(method)//ç¼–è¯‘ç›®æ ‡å‡½æ•° info-&gt;runtime_invoke = mono_jit_compile_method()//ç¼–è¯‘ç›®æ ‡å‡½æ•°çš„runtime wrapper mono_jit_compile_method_with_opt(method,default_opt,&amp;ex) runtime_invoke=info-&gt;runtime_invoke runtime_invoke(obj,pararms,exc,info-&gt;compiled_method)//è°ƒç”¨wrapper,wrapperä¼šè°ƒç”¨ç›®æ ‡æ–¹æ³•mono_jit_compile_method_with_opt() mono_jit_compile_method_inner() mini_method_compile(method, opt, target_domain, TRUE, FALSE, 0)//é€šè¿‡JITç¼–è¯‘ç»™å®šæ–¹æ³• mono_runtime_class_init_full()//åˆå§‹åŒ–æ–¹æ³•æ‰€åœ¨å¯¹è±¡ method=mono_class_get_cctor()//å¾—åˆ°ç±»çš„æ„é€ å‡½æ•° if(do_initialization)//å¯¹è±¡éœ€è¦åˆå§‹åŒ– mono_runtime_invoke()//è°ƒç”¨ç›¸åº”æ„é€ å‡½æ•°æ¥æ„é€ å¯¹è±¡ï¼Œå¦‚&quot;System.console:.cctor()&quot; mono_jit_runtime_invoke() åƒåœ¾å›æ”¶åƒåœ¾å›æ”¶(GC)æ˜¯CLIä¸­å¾ˆé‡è¦çš„éƒ¨åˆ†ï¼Œ çº¿ç¨‹æ± åº”ç”¨ç¨‹åºæˆ–è€…Mono runtimeä¸­çš„ä¸€äº›å¼‚æ­¥æ©ç‰©å¯ä»¥äº¤ç”±å•ç‹¬çº¿ç¨‹å®Œæˆã€‚Monoä¸­æä¾›äº†ä¸¤ä¸ªçº¿ç¨‹æ± :async_tpå’Œasync_io_tpã€‚å¾€çº¿ç¨‹æ± åŠ çº¿ç¨‹å‡½æ•°ä¸ºthreadpool_append_jobs()ï¼Œå½“ç¬¬ä¸€æ¬¡è¯•å›¾å¾€é‡Œè¾¹åŠ çº¿ç¨‹æ—¶ï¼Œä¼šè¿›è¡Œåˆå§‹åŒ–ï¼Œèµ·ä¸€ä¸ªâ€Monitorâ€çº¿ç¨‹(è¯¥çº¿ç¨‹æ‰§è¡Œmonotor_thread())ã€‚ç°åœ¨å‡è®¾ Monoå†…å­˜å†…å­˜å ç”¨ï¼š åº“ä»£ç ï¼šUnityåº“ã€ç¬¬ä¸‰æ–¹åº“ Nativeå †ï¼šèµ„æºã€Unityé€»è¾‘ã€ç¬¬ä¸‰æ–¹é€»è¾‘ Monoå †ï¼šC#ä»£ç  Unityæ¸¸æˆé€»è¾‘ä»£ç æ‰€ä½¿ç”¨çš„è¯­è¨€ä¸ºC#ï¼Œæˆ‘ä»¬çŸ¥é“C#ä»£ç æ‰€å ç”¨çš„å†…å­˜åˆç§°ä¸ºmonoå†…å­˜ï¼Œç”±äºUnityå®ƒæ˜¯é€šè¿‡monoæ¥è·¨å¹³å°è§£æå¹¶è¿è¡ŒC#ä»£ç çš„ï¼Œå®ƒåœ¨Androidç³»ç»Ÿä¸Šé¢ï¼Œå› æ­¤æ¸¸æˆçš„libç›®å½•ä¸‹å­˜åœ¨çš„libmono.soæ–‡ä»¶ï¼Œå°±æ˜¯monoåœ¨Androidç³»ç»Ÿä¸Šçš„å®ç°ã€‚ C#çš„ä»£ç æ˜¯é€šè¿‡monoæ¥è§£ææ‰§è¡Œçš„ï¼Œæ‰€éœ€è¦çš„å†…å­˜å­—ç„¶ä¹Ÿæ˜¯ç”±monoæ¥è¿›è¡Œåˆ†é…ç®¡ç†ï¼Œä¸‹é¢æ¥ä»‹ç»ä¸€ä¸ªmonoçš„å†…å­˜ç®¡ç†ç­–ç•¥ä»¥åŠå†…å­˜æ³„æ¼åˆ†æã€‚ Monoå†…å­˜ç®¡ç†çš„åŸºæœ¬ç­–ç•¥Monoé€šè¿‡åƒåœ¾å›æ”¶æœºåˆ¶(GarbageCollectï¼Œç®€ç§°GC)å †å†…å­˜è¿›è¡Œç®¡ç†ã€‚Monoå†…å­˜åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå·²ç”¨å†…å­˜(used)å’Œå †å†…å­˜(heap)ï¼Œå·²ç”¨å†…å­˜å®ƒæŒ‡çš„æ˜¯monoå®é™…éœ€è¦ä½¿ç”¨çš„å†…å­˜ï¼Œå †å†…å­˜æŒ‡çš„æ˜¯monoå‘æ“ä½œç³»ç»Ÿç”³è¯·çš„å†…å­˜ï¼Œä¸¤è€…çš„å·®å€¼å°±æ˜¯monoçš„ç©ºé—²å†…å­˜ã€‚ å½“monoéœ€è¦åˆ†é…å†…å­˜æ—¶ï¼Œé¦–å…ˆæ˜¯ä¼šæŸ¥çœ‹ç©ºé—²å†…å­˜æ˜¯å¦è¶³å¤Ÿï¼Œè‹¥è¶³å¤Ÿçš„è¯ï¼Œåˆ™æ˜¯ç›´æ¥åœ¨ç©ºé—²å†…å­˜ä¸­åˆ†é…ï¼Œå¦åˆ™monoä¼šè¿›è¡Œä¸€æ¬¡GCä»¥é‡Šæ”¾æ›´å¤šçš„å†…å­˜ï¼Œå¦‚æœGCä¹‹åä»ç„¶æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—²å†…å­˜ï¼Œåˆ™monoä¼šå‘æ“ä½œç³»ç»Ÿç”³è¯·å†…å­˜ï¼Œå¹¶æ‰©å……å †å†…å­˜ã€‚ C/C++ Monoè¿è¡Œæ—¶ æ‰˜ç®¡ä»£ç (CIL) å°†Monoè¿è¡Œæ—¶æ½œå…¥åº”ç”¨ï¼Œå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š ç¼–è¯‘C++ç¨‹åºå’Œé“¾æ¥]]></content>
      <tags>
        <tag>Mono</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é¢è¯•ç»å†]]></title>
    <url>%2F2018%2F03%2F13%2Finterview-1%2F</url>
    <content type="text"><![CDATA[ç¨‹åºçš„ä¼˜åŒ–å¤„ç†ï¼Œè¿™ä¸ªæ˜¯é¢è¯•è€ƒå¯Ÿçš„é‡ç‚¹ï¼Œå†…å­˜çš„ç®¡ç†ä¹Ÿæ˜¯Unityå¼€å‘çš„é‡ä¸­ä¹‹é‡ã€‚å†…å­˜ç®¡ç†æ— éå°±æ˜¯å¯¹å†…å­˜çš„ä½¿ç”¨ï¼Œé’ˆå¯¹UIçš„å†…å­˜ç®¡ç†ä½¿ç”¨çš„å›¾é›†æ–¹å¼ï¼ŒUnityè‡ªèº«çš„å›¾é›†åŠŸèƒ½æµªè´¹å†…å­˜ï¼Œæ¯”å¦‚2048 * 2048çš„å›¾é›†å¤§å°ï¼Œå®ƒå çš„å†…å­˜æ˜¯4Mï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ç®¡å›¾é›†æ˜¯å¦å¡«æ»¡ï¼Œå®ƒéƒ½éœ€è¦åœ¨å†…å­˜ä¸­å¼€è¾Ÿ4Mçš„ç©ºé—´ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨Texture Packerå·¥å…·å°±å¯ä»¥èŠ‚çœæ²¡æœ‰å¡«æ»¡çš„ç©ºé—´ï¼Œé’ˆå¯¹å¤§é‡UIçš„åŠ è½½å¯ä»¥é‡‡ç”¨åˆ†ç±»æ‰“åŒ…å›¾é›†çš„æ–¹æ³•å¤„ç†ã€‚å½“ç„¶å†…å­˜æ± çš„ä½¿ç”¨ä¹Ÿæ˜¯å¯ä»¥åº”ç”¨åˆ°UIçš„ç®¡ç†ï¼Œå¦å¤–å°±æ˜¯3Dåœºæ™¯èµ„æºçš„ç®¡ç†ï¼Œéœ€è¦åœºæ™¯å›¾ç‰‡æœ‰è‡ªå·±çš„å›¾åº“ï¼Œè¿™æ ·å›¾ç‰‡å¯ä»¥é‡å¤åˆ©ç”¨ï¼Œå¦å¤–æ¨¡å‹çš„é¢ç†Ÿï¼Œéª¨éª¼æ•°é‡ï¼Œæè´¨æ•°é‡éƒ½æ˜¯éœ€è¦å»å…³æ³¨ã€‚ å†…å­˜ä¼˜åŒ–è¿˜éœ€è¦æ¶‰åŠåˆ°å›¾ç‰‡çš„æ ¼å¼ï¼Œä¸å¸¦Alphaé€šé“çš„å›¾ç‰‡é‡‡ç”¨jpgæ ¼å¼ï¼Œå¸¦æœ‰Alphaé€šè¿‡çš„é‡‡ç”¨pngæ ¼å¼ï¼Œè¿™æ˜¯ä¸€ç§å¤„ç†æ–¹å¼ï¼Œå¦å¤–ä¸€ç§å¤„ç†æ–¹å¼å°±æ˜¯å°†Alphaé€šé“å•ç‹¬æ‹¿å‡ºæ¥ï¼Œæ‰€æœ‰çš„å›¾ç‰‡éƒ½æ˜¯jpgæ ¼å¼ï¼Œç„¶åç”¨å¸¦æœ‰Alphaé€šé“çš„å›¾ç‰‡è·Ÿjpgæ ¼å¼æ–‡ä»¶è¿›è¡Œç»“åˆä½¿ç”¨ã€‚ åœ¨ç»“æ„æ¶‰åŠæ–¹é¢ï¼Œå°±è¦æ³¨æ„äº†ï¼Œä»£ç çš„ç¼–å†™ï¼Œæ¯”å¦‚å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ï¼Œå·¥å‚æ¨¡å¼ï¼Œå•ä¾‹æ¨¡å¼ï¼ŒMVCæ¨¡å¼ï¼ŒFSMæ¨¡å¼ï¼Œè§‚å¯Ÿè€…æ¨¡å¼ç­‰ï¼Œè¿™äº›æ¨¡å¼ä½œä¸ºå¼€å‘è€…å¿…é¡»è¦æŒæ¡çš„ã€‚ æ¥ä¸‹æ¥å°±æ˜¯Shaderçš„ç¼–å†™äº†ï¼Œå¯ä»¥ä½¿ç”¨Shader Forgeç¼–è¾‘å™¨ï¼Œå¯¹äºä¸€äº›æè´¨æ¸²æŸ“éå¸¸å¥½ç”¨ï¼Œè¿™ä¸ªå¯ä»¥ä½œä¸ºè¯»è€…å­¦ä¹ Shaderçš„å·¥å…·ã€‚ ä¹ã€å¦å¤–å¯¹äºC#ä¸­å®šä¹‰çš„Stringï¼ŒStringBuilderæˆ–è€…List,ArrayListç­‰å®ƒä»¬ä¹‹é—´çš„åŒºåˆ†è¦ææ¸…æ¥šã€‚ çƒ­æ›´æ–°æŠ€æœ¯çš„å®ç°ï¼Œå¸‚é¢ä¸Šåº”ç”¨æ¯”è¾ƒå¹¿çš„uluaä½œä¸ºè„šæœ¬è¯­è¨€æ¶æ„è®¾è®¡ã€‚ ä½œä¸ºå®¢æˆ·ç«¯å¼€å‘è€…ä¹Ÿéœ€è¦äº†è§£ç½‘ç»œæ–¹é¢çš„çŸ¥è¯†ï¼Œæ¯”å¦‚tcp,udp,httpè¿™äº›åè®®çš„å¤„ç†æ–¹å¼ã€‚ åœºæ™¯ã€å¯¼èˆªã€å¯»è·¯ ä½œä¸ºæ¸²æŸ“åœºæ™¯çš„åå¤„ç†æ–¹å¼ï¼Œæ¯”å¦‚Bloom,Blur,HDR,SSAO,PSSMç­‰ç­‰ã€‚ C#ä¸­çš„äº‹ä»¶ç›‘å¬ï¼Œå§”æ‰˜çš„ä½¿ç”¨ä¹Ÿè¦ç†Ÿç»ƒæŒæ¡ã€‚ åç¨‹ä¸å¤šçº¿ç¨‹çš„åŒºåˆ«ã€‚ æ–‡æœ¬æ–‡ä»¶çš„åŠ è½½ï¼Œæ¯”å¦‚json,xml,csv,äºŒè¿›åˆ¶ç­‰ç­‰ã€‚ GCæ˜¯Monoè¿è¡Œæ—¶çš„æœºæ™ºï¼Œè€ŒéUnity3Då¼•æ“çš„æœºåˆ¶ï¼Œæ‰€ä»¥GCä¹Ÿä¸»è¦æ˜¯é’ˆå¯¹Monoå¯¹è±¡æ¥è¯´çš„ã€‚ 1String s = new String("lyf"); åœ¨è¿è¡Œæ—¶æ¶‰åŠäº†å‡ ä¸ªString Objectä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯å­—ç¬¦ä¸²å­—é¢é‡â€lyfâ€æ‰€å¯¹åº”çš„ï¼Œé©»ç•™(intern)åœ¨ä¸€ä¸ªå…¨å±€å…±äº«çš„å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„å®ä¾‹ï¼Œiå¦ä¸€ä¸ªæ˜¯é€šè¿‡new String(String)åˆ›å»ºå¹¶åˆå§‹åŒ–çš„ã€å†…å®¹äºâ€lyfâ€ç›¸åŒçš„å®ä¾‹ OpenGLä¸­è¦ç”¨åˆ°å“ªå‡ ç§bufferå¸§ç¼“å†²(Frame Buffer)é¢œè‰²ç¼“å†²(Color Buffer)æ¨¡ç‰ˆç¼“å†²(Stencil Buffer)é¡¶ç‚¹ç¼“å†²(Vertice Buffer)æ·±åº¦ç¼“å†²(Depth Buffer) å†°å·ç½‘ç»œ1.å•¥å­æ˜¯æ³›å‹ï¼Ÿç»™ä½ ä¸€ä¸ªCBaseåŸºç±»ï¼Œå†™ä¸€ä¸ªç»§æ‰¿CBaseçš„æ³›å‹ã€‚ç™¾åº¦ç­”ï¼šæ‰€è°“æ³›å‹ï¼Œå³é€šè¿‡å‚æ•°åŒ–ç±»å‹æ¥å®ç°åœ¨åŒä¸€ä»½ä»£ç æ“ä½œå¤šç§æ•°æ®ç±»å‹ã€‚æˆ‘ç­”ï¼šç±»çš„æ•°æ®æˆå‘˜ä¸å›ºå®šï¼Œæˆå‘˜å‡½æ•°çš„è¿”å›å€¼å’Œä¼ å‚ç±»å‹ä¸å›ºå®šçš„ï¼Œè¿™æ ·çš„æ–¹å¼å«åšæ³›å‹ã€‚æœ¬æƒ³è¯´è¿™æ ·çš„ç±»å«åšæ³›å‹ç±»ï¼Œä½†æ˜¯äººå®¶é—®çš„æ˜¯æ³›å‹ï¼Œåªèƒ½è¯´è¿™æ ·çš„æ–¹å¼äº†ã€‚ æˆ‘ä¸çŸ¥é“å†™ä¸€ä¸ªç»§æ‰¿CBaseçš„æ³›å‹è€ƒç‚¹æ˜¯å•¥å­ï¼Œç„¶åæˆ‘å°±å¼€å§‹çå†™12345public class CDrive:public CBase // ä¸ºæ¯›è¿˜è¦åŠ publicï¼Œéš¾é“è¿˜æœ‰å…¬æœ‰ç»§æ‰¿ï¼Œä¿æŠ¤ç»§æ‰¿ï¼Œç§æœ‰ç»§æ‰¿ï¼Ÿï¼Ÿï¼Ÿ&#123; public void Do&lt;T&gt;(T t) // è¿™ä»–å¦ˆå†™çš„ä»€ä¹ˆç©æ„ã€‚ &#123;&#125;&#125; 3.å•¥å­æ˜¯åå°„ï¼Ÿå†™ä¸€æ®µåŠ è½½ç¨‹åºé›†ï¼Œç„¶åè·å–ç±»å‹Typeï¼Œç„¶åé€šè¿‡æ–¹æ³•åè°ƒç”¨ç½‘ä¸Šç­”æ¡ˆï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445using System;using System.Collections;using System.Collections.Generic;using System.Reflection;using UnityEngine;public class InvokeReflection : MonoBehaviour&#123; void Start() &#123; Learn00(); &#125; public void Learn00() &#123; /* * System.Reflection.Assemblyç±»æœ‰ä¸¤ä¸ªé™æ€æ–¹æ³•ï¼šAssembly.Load(string assemblyname)å’ŒAssembly.LoadFrom(string filename) ã€‚ * é€šå¸¸ç”¨è¿™ä¸¤ä¸ªæ–¹æ³•æŠŠç¨‹åºé›†åŠ è½½åˆ°åº”ç”¨ç¨‹åºåŸŸä¸­ã€‚ å¦‚æœä½ å¸Œæœ›åŠ è½½çš„ç¨‹åºé›†è¶…å‡ºäº†CLRçš„é¢„å®šæ¢æŸ¥èŒƒå›´ï¼Œä½ å¯ä»¥ç”¨Assembly.LoadFromç›´æ¥ä»ä¸€ä¸ªæ–‡ä»¶ä½ç½®åŠ è½½ç¨‹åºé›†ã€‚ * Assembly.LoadFrom()å’ŒAssembly.LoadFile()ï¼Œä¸¤è€…çš„ä¸»è¦åŒºåˆ«æœ‰ä¸¤ç‚¹ï¼š * ä¸€ï¼šAssembly.LoadFile()åªè½½å…¥æŒ‡å®šçš„dllæ–‡ä»¶ï¼Œè€Œä¸ä¼šè‡ªåŠ¨åŠ è½½ç›¸å…³çš„dllæ–‡ä»¶ã€‚å¦‚æœä¸‹æ–‡ä¾‹å­ä½¿ç”¨Assembly.LoadFile()åŠ è½½SayHello.dllï¼Œé‚£ä¹ˆç¨‹åºå°±åªä¼šåŠ è½½ * SayHello.dllè€Œä¸ä¼šå»åŠ è½½SayHello.dllå¼•ç”¨çš„BaseClass.dllæ–‡ä»¶ã€‚ * äºŒï¼šAssembly.LoadFrom()è½½å…¥ä¸€ä¸ªAssemblyæ—¶ï¼Œä¼šå…ˆæ£€æŸ¥å‰é¢æ˜¯å¦å·²ç»è½½å…¥è¿‡ç›¸åŒåå­—çš„Assemblyï¼›Assembly.LoadFile()åˆ™ä¸ä¼šåšç±»ä¼¼çš„æ£€æŸ¥ã€‚ */ //C:\Users\Administrator\Desktop\New Unity Project\Assets\DLL Assembly assemly2 = Assembly.LoadFrom(@"C:\Users\Administrator\Desktop\New Unity Project\Assets\Scripts\TestReflection.dll"); Assembly assemly1 = Assembly.LoadFile(@"C:\Users\Administrator\Desktop\New Unity Project\Assets\Scripts\TestReflection.dll"); Assembly assemly = Assembly.Load("TestReflection");//1å¡«åŠ DLL Type testType = assemly.GetType("HaiLan.TestReflection.TestReflectionDLL");//2è·å–å¯¹åº”çš„ç±»ä¿¡æ¯ï¼Œéœ€è¦å¡«åŠ å¯¹åº”çš„å‘½åç©ºé—´ object oTestReflectionDLL = Activator.CreateInstance(testType);//3 åˆ›å»ºå¯¹è±¡ IReflectionDLL iTestReflectionDLL = oTestReflectionDLL as IReflectionDLL;//4 ç±»å‹è½¬æ¢ iTestReflectionDLL.TestShow1();//5 æ–¹æ³•è°ƒç”¨ foreach (var item in assemly.GetModules()) &#123; Debug.Log(item.Name);//æ‰“å°ç»“æœ TestReflection.dll &#125; foreach (var type in assemly.GetTypes()) &#123; Debug.Log(type.Name); foreach (var item in type.GetMethods()) &#123; Debug.Log(item.Name); &#125; &#125; &#125;&#125; 4.avatarå¦‚ä½•æ¢è£…ï¼Ÿ5.å•¥å­æ˜¯Prefabï¼Œå¦‚ä½•è·å–ä¸€ä¸ªPrefabå®ä¾‹åŒ–çš„GameObjectçš„ç±»å‹ï¼ŸPrefabInstanceå’ŒPrefabModelInstanceæœ‰å•¥å­åŒºåˆ«ï¼ˆæˆ‘éƒ½ä¸çŸ¥é“ä»–åœ¨é—®å•¥å­ï¼‰6.è·å–ä¸€ä¸ªRenderçš„æè´¨ï¼Œç„¶åè®¾ç½®æµå…‰shaderçš„uniform/7.åœ°éœ‡äº†ï¼Œç‹—è·‘äº†ï¼Œæˆ¿å±‹å¡Œäº†ï¼Œäººæ…Œäº†ï¼Œè¿™æ˜¯å“ªä¸ªè®¾è®¡æ¨¡å¼ï¼Ÿå†™å‡ºä¼ªä»£ç æˆ–è€…ç”»å‡ºæµç¨‹å›¾ï¼›è¦æ±‚å¯æ‰©å±•8.ç»™ä½ ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œå†…å­˜è´¼é«˜ï¼ŒFPSè´¼ä½ï¼Œå’‹ä¼˜åŒ–ï¼Œæ˜¯Xluaå’ŒC#å†™çš„ã€‚ AssetBundleçš„æ‰“åŒ…å’ŒåŠ è½½ å¦‚ä½•åˆ¤æ–­çº¿æ®µå’Œå¤šè¾¹å½¢æ˜¯å¦ç›¸äº¤ï¼Ÿ æ·±åœ³æ˜“å‡¡äº’åŠ¨ NGUIçš„uvå’Œé¡¶ç‚¹æ˜¯æ€ä¹ˆç”Ÿæˆçš„ï¼Ÿ å®¢æˆ·ç«¯ç½‘ç»œæ˜¯å¦æœ‰ç”¨å¤šçº¿ç¨‹ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨ï¼Ÿ TCP IPV6æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ Unity5.6å’ŒUnity2018çš„å…‰ç…§å›¾æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œæµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ æ·±åœ³å¥‡å¦™èƒ½åŠ› TCPç²˜åŒ…å¯ä»¥æè¿°ä¸€ä¸‹å—ï¼Ÿ Shader Bloomæ³›å…‰æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ Bæ ‘ï¼ŒB+æ ‘æ˜¯å•¥å­ï¼Ÿ ä»ä¸€å †æ— åºçš„æ•°å­—ä¸­æ‰¾åˆ°ä¸é‡å¤çš„æ•°å­—ï¼Œé‡å¤çš„æ•°å­—æ˜¯éƒ½æ˜¯åŒæ•°ä¸ªã€‚ ç‰›è›™äº’åŠ¨ ç‚¹å’Œå¤šè¾¹å½¢ç›¸äº¤ï¼ˆæ›²çº¿å…ˆäº¤ï¼‰ï¼Ÿ è¾“å‡ºä¸‹åˆ—çš„ç»“æœï¼Ÿ 123456789101112public class Program&#123; readonly int b = a + 10; readonly int a = 10; static int d = c + 10; static int c = 10; static void Main(string[] args) &#123; Program p = new Program(); Console.WriteLine("a = &#123;0&#125;, b = &#123;1&#125;, c = &#123;2&#125;, d = &#123;3&#125;", p.a, p.b, c, d); &#125;&#125; è®¾è®¡ä¸€ç§å­˜å‚¨ç»“æ„å®ç°å­—å…¸æŸ¥æ‰¾ã€‚ 600ä¸ªä¸€Mçš„çº¹ç†ï¼Œç»™ä¸€ä¸ªUIä½¿ç”¨ï¼Œæ¯æ¬¡åªä¼šåŠ è½½ä¸€ä¸ªï¼Œæ˜¯æ‰“æˆä¸€ä¸ªABåŒ…å¥½ï¼Œè¿˜æ˜¯å¤šä¸ªå¥½ï¼Ÿ IGG TCPç²˜åŒ…å’Œä¸‰æ¬¡æ¡æ‰‹çš„è”ç³»? åŠ¨é™åˆ†ç¦»ï¼Ÿ Overdrawçš„ä¼˜åŒ–ï¼Ÿ åŠé€æ˜å’Œä¸é€æ˜ç‰©ä½“çš„æ¸²æŸ“æµç¨‹ï¼Ÿ ç æµ·è¥¿å±±å±… å·¥ä½œä¸­é‡åˆ°è¿‡ä»€ä¹ˆå›°éš¾ï¼Œå¦‚ä½•è§£å†³ï¼Œè·å¾—ä»€ä¹ˆæˆå°±ï¼Ÿ Arrayå’ŒListçš„åŒºåˆ«ï¼Ÿ é—­åŒ…æ˜¯ä»€ä¹ˆï¼Ÿ Lua Tableå¦‚ä½•å®ç°çš„ï¼ŒHashæ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•è§£å†³Hashå†²çªï¼Ÿ new Structå­˜æ”¾åœ¨å“ªé‡Œï¼Ÿå †å’Œæ ˆçš„åŒºåˆ«ï¼Ÿ ä»€ä¹ˆæ˜¯å…ƒè¡¨ï¼Ÿæœ‰ä»€ä¹ˆåº”ç”¨ï¼Ÿ å †å’Œæ ˆåœ¨C++ä¸­çš„è¿ç”¨ä»¥åŠå®ç°æ–¹å¼ä»¥åŠä¼˜ç¼ºç‚¹ï¼Ÿ UIçš„overdrawå¦‚ä½•è§£å†³ï¼Œå¼‚æ­¥åŠ è½½é€ æˆæ•°æ®ä¸åŒæ­¥å¦‚ä½•è§£å†³ï¼Ÿ å‰§æƒ…ç¼–è¾‘å™¨å¦‚ä½•ä¸æ ¹æ®åœ°å½¢åˆ¶ä½œå‰§æƒ…ï¼Ÿ åç¨‹çš„åŸç†ï¼Ÿ ä¹æ˜“ç½‘ç»œ NGUIå¦‚ä½•ä¼˜åŒ–ï¼Ÿ NGUIæ˜¯å¦‚ä½•ç»˜åˆ¶çš„ï¼Ÿ UIWidgetå¦‚ä½•æäº¤æ¸²æŸ“çš„ï¼Ÿ ä¸€ä¸ªå·²ç»æ’å¥½åºçš„é“¾è¡¨æ„æˆä¸€ä¸ªæ•°ç»„ï¼Œå¦‚ä½•åˆæˆä¸€ä¸ªæ–°çš„é“¾è¡¨ï¼Ÿï¼ˆæœºè¯•é¢˜ï¼‰ å››ç»´æ—¶ä»£ è¿›ç¨‹é—´æ˜¯å¦‚ä½•äº¤äº’çš„ï¼Ÿå„è‡ªæœ‰å•¥å¥½å¤„è¿˜åå¤„ï¼Ÿ æ¼«åå°„åŸç†ï¼Ÿ luaçš„åŠ è½½æµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ TCP/UDP/HTTPè¿ç”¨åœºæ™¯ï¼Œä¼˜ç¼ºç‚¹ï¼Ÿ çº¿ç¨‹å’Œåç¨‹çš„åŒºåˆ«ï¼Ÿ ä¹é€— TTFå­—ä½“ ä¼ è¾“å±‚è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆUDPåœ¨æ‰‹æœºä¸Šè¦ä¼˜äºTCP Luaçš„Hashæ˜¯å¦‚ä½•å®ç°çš„ çº¢é»‘æ ‘çš„æ—¶é—´å¤æ‚åº¦ æ¸²æŸ“æµç¨‹ç®¡çº¿ï¼Œç›¸æœºæŠ–åŠ¨æ˜¯å¦‚ä½•å‡ºç°çš„ new free malloc delete åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ å¹¿å·ç™¾ç”° ä»‹ç»è¿‡å¾€å·¥ä½œã€é¡¹ç›®ç»å† unityçš„åŸºæœ¬æ¡†æ¶æœ‰å“ªäº›ï¼Ÿè¯·æè¿°æˆ–è€…ç®€å•ç”»ä¸€ç”»é¡¹ç›®æ ¸å¿ƒçš„æ¶æ„åˆ†å±‚å›¾ï¼Œä»¥åŠæ ¸å¿ƒæ¨¡å—é—´çš„äº¤äº’æ—¶åºï¼ˆUnityæ¡†æ¶èŒƒå›´é—®é¢˜æ¯”è¾ƒæ³›ï¼Œæœ€å¥½èƒ½ç»“åˆä¸šåŠ¡è¯´ä¸‹æŸä¸ªä¸šåŠ¡çš„æ¡†æ¶ï¼‰ï¼Œå¦‚æœæ²¡ç”¨è¿‡unityï¼Œé‚£å°±ç”»ä¸€ä¸‹ç›®å‰é¡¹ç›®çš„ä¸šåŠ¡æ¡†æ¶ã€‚ æ˜¯å¦åšè¿‡å‘å¸ƒæ‰“åŒ…ç›¸å…³çš„å·¥ä½œï¼Ÿç”¨unityæ˜¯æ€ä¹ˆç®¡ç†å’ŒåŠ è½½èµ„æºçš„ï¼Ÿå¦‚ä½•çƒ­æ›´æ–°èµ„æºï¼Œå¯¹çƒ­æ›´èµ„æºå’Œæ”¾ç½®è·¯å¾„æœ‰ä»€ä¹ˆè¦æ±‚ï¼Ÿï¼ˆå¯ä»¥è¯´ä¸‹çƒ­æ›´æ–°åˆ†å“ªäº›å†…å®¹ï¼Œä»¥åŠå¯¹AssetBundleçš„ç†è§£ï¼‰ æ˜¯å¦å®Œæˆè¿‡å¤§å‹æ¨¡å—ï¼Œå¦‚æˆ˜æ–—ï¼Œåœºæ™¯ï¼Œå‰¯æœ¬ç­‰ï¼›ï¼ˆè¯´è®¾è®¡æ€è·¯ï¼‰ æ˜¯å¦åšè¿‡æ¸¸æˆç›¸å…³ä¼˜åŒ–ï¼Œå¦‚GPUï¼ŒCPUï¼ŒShaderç­‰ï¼›ï¼ˆä¼˜åŒ–å·¥ä½œçš„å…·ä½“æ–¹é¢ï¼š1.èµ„æºåŒ…å¤§å°çš„ä¼˜åŒ–ï¼Œ2.å†…å­˜å ç”¨ï¼Œå†…å­˜åˆ†é…å’Œç¢ç‰‡çš„ä¼˜åŒ–ï¼Œ3.cpuçƒ­ç‚¹å’Œæ¯›åˆºä¼˜åŒ–ï¼Œ4.gpuæ€§èƒ½å¼€é”€ä¼˜åŒ–ï¼‰ åŒæ­¥ã€å¼‚æ­¥ç›¸å…³é—®é¢˜ï¼›ï¼ˆæ‰§è¡Œæ—¶åºçš„æ¦‚å¿µï¼Œèµ„æºåŠ è½½ï¼Œç½‘ç»œé€šä¿¡ï¼Œé€»è¾‘è°ƒç”¨çš„å„ç§æ—¶åºæµç¨‹ï¼‰ AIæ¡†æ¶æœ‰å“ªäº›ï¼›ï¼ˆè¿™ä¸ªé—®é¢˜ï¼Œæˆç†Ÿçš„AIè§£å†³æ–¹æ¡ˆå°±æ˜¯è¡Œä¸ºæ ‘ï¼Œé¢è¯•å®˜ä¼šé—®ï¼Œå¯¹è¡Œä¸ºæ ‘çš„äº†è§£æƒ…å†µï¼Œæ˜¯æ€ä¹ˆç»„åˆå®Œæˆå¤æ‚AIçš„ï¼Œè¿™ä¸ªæ˜¯åŠ åˆ†é¢˜ï¼Œå¤§éƒ¨åˆ†é¢è¯•äººå…¶å®è¯´çš„ä¸å¤ªé€ï¼‰ åº•å±‚ç½‘ç»œç”¨å“ªäº›åè®®ï¼ˆè¡¥å……ï¼štcpï¼Œudpï¼ˆä»¥åŠå¯é ç‰ˆçš„udpï¼‰çš„åŒºåˆ«ï¼Œåˆ†åˆ«é€‚ç”¨äºå“ªäº›ä¸šåŠ¡åœºæ™¯ï¼‰ ç”¨è¿‡å“ªäº›å¼€æºåº“ï¼›ï¼ˆå•çº¯è€ƒå¯Ÿä½ å¯¹ä¸šå†…ç›¸å…³å¼€æºåº“çš„æ•æ„Ÿåº¦ï¼ŒçŸ¥è¯†å¹¿åº¦ï¼‰ äº†è§£å“ªäº›æ¯”è¾ƒå¥½çš„AIæ’ä»¶ï¼› NGUIç›¸å…³é—®é¢˜ï¼ˆè¡¥å……é—®é¢˜ï¼šNGUIç»˜åˆ¶å¼€é”€å¦‚ä½•ä¼˜åŒ–ï¼Œå‡å°‘drawcalléœ€è¦åœ¨åˆ¶ä½œUIå’Œå›¾é›†çš„æ—¶å€™æ³¨æ„ä»€ä¹ˆï¼‰ æ€ä¹ˆåšå†…å­˜ã€æ˜¾å­˜ä¼˜åŒ–ï¼› å›¾ç‰‡çš„å¤„ç†æ ¼å¼ï¼ˆè¡¥å……ï¼šæ€ä¹ˆé€‰æ‹©å›¾ç‰‡çš„æ ¼å¼ï¼Œå®‰å“å’ŒIOSå›¾ç‰‡å‹ç¼©åˆ†åˆ«æ˜¯ä»€ä¹ˆæ ¼å¼ï¼Œæœ‰ä»€ä¹ˆè¦æ±‚ï¼Œä¸åŒä¸šåŠ¡åœºæ™¯ä¸‹å›¾ç‰‡å°ºå¯¸ä½æ•°ï¼Œmipmapåˆåˆ†åˆ«æœ‰ä»€ä¹ˆè¦æ±‚å’ŒåŒºåˆ«ï¼‰ æœåŠ¡å™¨çš„æˆ˜æ–—åŒæ­¥æ–¹æ¡ˆï¼Œç»™å‡ºä¸€ä¸ªä¼˜è´¨çš„æ–¹æ¡ˆï¼›ï¼ˆä½ éœ€è¦é’ˆå¯¹ä¸é€šçš„æ¸¸æˆç±»å‹å’Œç©æ³•åšå‡ºä¸åŒçš„é’ˆå¯¹æ€§ä¼˜åŒ–ï¼Œä¼˜åŒ–ç­–ç•¥å’Œç½‘ç»œåŒæ­¥æ–¹æ¡ˆéƒ½ä¸åŒï¼Œå…¸å‹ä»£è¡¨2ç±»ï¼Œä¼ ç»ŸCSåŒæ­¥å’Œå¸§åŒæ­¥ï¼‰ æ¸²æŸ“ç®¡çº¿æµç¨‹æ˜¯ç”±å“ªäº›éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æœ‰ä»€ä¹ˆä½œç”¨ï¼Œèƒ½è®²é€å½»æ˜¯åŠ åˆ†é¢˜ï¼› vertexshaderå’Œpixel shaderä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•åä½œçš„ï¼› åå¤„ç†æ˜¯ä»€ä¹ˆï¼Ÿä½ æ‰€çŸ¥é“çš„åå¤„ç†æ•ˆæœæœ‰å“ªäº›ï¼Œå¤§æ¦‚è¯´è¯´è¿™äº›åå¤„ç†å®ç°çš„åŸç† å»¶è¿Ÿæ¸²æŸ“æ˜¯ä»€ä¹ˆï¼Ÿ å»¶è¿Ÿæ¸²æŸ“å’Œå»¶è¿Ÿå…‰ç…§çš„åŒºåˆ«ï¼Ÿ shadow mapçš„åŸç† ç®€å•æè¿°1ï¼Œ2ä¸ªä½ è®¤ä¸ºæœ€å…·æœ‰æŒ‘æˆ˜æ€§çš„åŠŸèƒ½ï¼Œä½ æ˜¯æ€ä¹ˆæ€è€ƒï¼Œè®¾è®¡ï¼Œä¼˜åŒ–çš„ï¼Œæ˜¯å¦è¿˜æœ‰ä¸è¶³ï¼Œè¿˜èƒ½å¦ç»§ç»­æ”¹è¿›ã€‚ ç»“æ„ä½“å’Œç±»çš„åŒºåˆ« ArrayListå’ŒListçš„åŒºåˆ« å¦‚æœæƒ³å°†ä¸€ä¸ªclassä½œä¸ºå­—å…¸è¡¨çš„Keyéœ€è¦å®ç°å“ªäº›å‡½æ•° å­—å…¸è¡¨çš„èµ‹å€¼ä¸keyçš„éå†éœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚ interfaceä¸æŠ½è±¡ç±»çš„åŒºåˆ« Unity monobehaviourçš„ç”Ÿå‘½å‘¨æœŸä¸­OnEnable() Awake() Start() Update()çš„é¡ºåºï¼Œä»¥åŠå“ªäº›ä¼šé‡å¤è°ƒç”¨ MipMapæ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒçš„ä½œç”¨ Rendereræ˜¯ä»€ä¹ˆï¼ŒMeshRendererä¸SkinnedMeshRendererçš„åŒºåˆ« AplhaBlendä¸AlphaTestçš„åŒºåˆ« Unityè‡ªå¸¦çš„Diffuseç€è‰²å™¨ï¼Œé‡Œé¢çš„ç¯å…‰è¿ç®—æ˜¯é¡¶ç‚¹ç¯å…‰è¿˜æ˜¯åƒç´ ç¯å…‰ï¼Œè¿™ä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ« åœ¨ä¸€ä¸ªå›ºå®šè§†è§’çš„åœºæ™¯ä¸­æœ‰ä¸€ä¸ªå›ºå®šæ–¹å‘çš„æ–¹å‘å…‰ï¼Œæ€æ ·ç»™æ¸²æŸ“ç‰©ä½“æ—¶åšä¼˜åŒ– ä»‹ç»é¡¹ç›®å®¢æˆ·ç«¯èµ„æºåˆ†åŒ…ç­–ç•¥ ä»‹ç»å®¢æˆ·ç«¯ä»£ç çƒ­æ›´æ–°çš„å®ç°æ–¹å¼ ä»‹ç»ZTEST ZWRITEçš„ä½œç”¨ æ¸²æŸ“å®ä½“å¯¹è±¡å’ŒåŠé€æ˜å¯¹è±¡ï¼Œæœ‰ä»€ä¹ˆä¼˜åŒ–æ‰‹æ®µ AlphaTestä¸ºä»€ä¹ˆåœ¨éƒ¨åˆ†ç§»åŠ¨è®¾å¤‡å­˜åœ¨æ€§èƒ½é—®é¢˜ï¼Œå¦‚ä½•è§„é¿ ä»‹ç»è¡Œä¸ºæ ‘çš„å„ç±»èŠ‚ç‚¹ï¼Œå„ç±»èŠ‚ç‚¹è¿”å›å€¼å¯¹äºçˆ¶èŠ‚ç‚¹çš„å½±å“ã€‚ å¦‚ä½•å®ç°é•œé¢æ•ˆæœ æ˜¯å¦ä½¿ç”¨è¿‡NGUIï¼ŒNGUIå¦‚ä½•ç®¡ç†Widgetå’Œç»„ç»‡drawcall åå¤„ç†ä¸­ï¼Œå¦‚ä½•æ ¹æ®æ·±åº¦ç¼“å­˜è¿˜åŸå‡ºä¸–ç•Œåæ ‡ï¼Ÿ ç®€è¿°Shadow Mapçš„åŸç†ï¼ŒShadow biasçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ çƒ­æ›´æ–°æ–­ç‚¹ç»­ä¼ ï¼Ÿ å›¾å½¢ç›¸å…³é¢è¯•é¢˜ è½¯è’™çš®å’Œç¡¬è’™çš®çš„åŒºåˆ«ï¼Œç¡¬è’™çš®çš„é™åˆ¶ é˜´å½±çš„å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Œä¼˜ç¼ºç‚¹å„æ˜¯ä»€ä¹ˆï¼Œæ–¹å‘å…‰ï¼Œç‚¹å…‰æºï¼Œèšå…‰ç¯çš„é˜´å½±å®ç°åˆæœ‰ä»€ä¹ˆåŒºåˆ« è‡ªé˜´å½±å¦‚ä½•å®ç° å»¶è¿Ÿæ¸²æŸ“çš„åŸç† HDRï¼Œbloomï¼Œå¾„å‘æ¨¡ç³Šè¿™å‡ ä¸ªåå¤„ç†çš„å®ç°åŸç† Unityé‡ŒShaderæ€ä¹ˆåšLOD OpenGL ES3.0ç›¸æ¯”2.0å¢åŠ äº†å“ªäº›ç‰¹æ€§ ç»ˆé¢æŠ€å·§æŠ€æœ¯ç»ˆé¢ å›é¡¾è‡ªå·±çš„ç®€å†ï¼Œå¯¹ç®€å†ä¸Šæ‰€æœ‰æåˆ°çš„æŠ€æœ¯è¦ç‚¹ä¸€å®šè¦éå¸¸ç†Ÿæ‚‰ï¼Œå› ä¸ºé¢è¯•å®˜ä¼šé’ˆå¯¹ç®€å†ä¸Šçš„æŠ€æœ¯é—®é¢˜è¿›è¡Œæ‰©å±•ï¼› é‡ç‚¹å‡†å¤‡é¡¹ç›®æŠ€æœ¯æ¡†æ¶ï¼ŒåŒ…æ‹¬å¦‚ä½•æ­å»ºï¼ŒæŠ€æœ¯é€‰å‹ï¼Œä¸ºä½•é€‰ç”¨è¿™ä¸ªæ¡†æ¶ï¼Œä¼˜åŠ£åŠ¿ï¼Œé¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸Šçº¿è¿‡ç¨‹ä¸­ï¼Œç»´æŠ¤è¿‡ç¨‹ä¸­æ‰€å‡ºç°çš„é—®é¢˜ï¼Œé’ˆå¯¹ä¸é€šçš„é—®é¢˜æœ‰å“ªäº›è§£å†³æ–¹æ¡ˆï¼Œä¸ºä½•é€‰ç”¨è¿™ç§è§£å†³æ–¹æ¡ˆï¼Œä¼˜åŠ£åŠ¿å¯¹æ¯”ç­‰ï¼› é‡ç‚¹é˜è¿°è‡ªå·±åœ¨é¡¹ç›®å¼€å‘ä¸­æ‰¿æ‹…çš„è§’è‰²ï¼Œå¯¹é¡¹ç›®å¼€å‘çš„å…±äº«ï¼Œè‡ªå·±åœ¨å·¥ä½œä¸­è§£å†³çš„é—®é¢˜ï¼› æ—¶åˆ»æ˜¾ç¤ºå‡ºè‡ªå·±å¯¹å·¥ä½œï¼Œå¯¹æŠ€æœ¯çš„çƒ­æƒ…ï¼Œå¯¹æ–°æŠ€æœ¯çš„å…³æ³¨ï¼ˆç‰¹åˆ«å…³æ³¨è¿‘æœŸæ–°æŠ€æœ¯ï¼Œæ–°é—»ç­‰ï¼‰ å¯ä»¥é‡ç‚¹é˜è¿°è‡ªå·±å·¥ä½œä¹‹ä½™å–œçˆ±ç ”ç©¶çš„åº•å±‚æŠ€æœ¯ ä½•å›ç­”å¯¹å¾…åŠ ç­çš„çœ‹æ³•ï¼šå¼ºè°ƒè‡ªå·±æ˜¯æ•ˆç‡æ€§å‘˜å·¥ï¼Œè‡ªå·±å¼€å‘æ‰€ç”¨æ—¶é—´æ®µï¼Œbugå°‘ï¼ˆæ­¤å¤„å¯ä¸¾ä¾‹è¯´æ˜ï¼‰ï¼Œä½†é¡¹ç›®ç´§æ€¥ä¼šèµ„æºåŠ ç­ï¼Œå’Œå›¢é˜Ÿä¸€èµ·å®Œæˆç´§æ€¥ä»»åŠ¡ã€‚ æ€åº¦é¢å¸¦å¾®ç¬‘ï¼Œä¸å‘ä¸äº¢ï¼Œæ— è®ºæ˜¯å¾…ä¼šHRè¿˜æ˜¯æŠ€æœ¯é¢è¯•éƒ½ç»™äºˆè¶³å¤Ÿå°Šé‡ï¼Œå½“ä¸æ‡‚æŠ€æœ¯çš„HRé—®åˆ°æŠ€æœ¯é—®é¢˜æ—¶ï¼Œä¸€å®šè¦å½“ä½œå¯¹æ–¹æ˜¯æ‡‚æŠ€æœ¯çš„äººå‘˜å»è®¤çœŸå›ç­”è¿™ä¸ªé—®é¢˜ã€‚è¶Šæ˜¯ç®€å•çš„é—®é¢˜ï¼Œè¶Šè€ƒå¯ŸåŸºç¡€ï¼Œé‡åˆ°ç®€å•é—®é¢˜è¦è®¤çœŸå›ç­”ã€‚ ç¦»èŒæ„æ„¿ å®¶é‡Œå’Œè‡ªå·±æ›´å–œæ¬¢æ·±åœ³è¿™ä¸ªåŸå¸‚ï¼Œä¹Ÿæ˜¯å®¶äººå¼ºçƒˆè¦æ±‚åˆ°æ·±åœ³é•¿æœŸå‘å±•ï¼Œå¹¿å·æ·±åœ³çš„æ¸¸æˆç¯å¢ƒä¹Ÿæ›´å¥½ ä»ä¸ªäººèŒä¸šå‘å±•ä¸Šæ¥è¯´ï¼Œå¾ˆå‘å¾€XXXè¿™æ ·çš„å¹³å°ï¼Œè‡ªå·±ä¹Ÿç§ä¸‹äº†è§£äº†ä¸€ä¸‹ç›¸å…³çš„ä¿¡æ¯ï¼Œè§‰å¾—XXXå°†æ¥ä¼šå‘å±•çš„å¾ˆå¥½ï¼Œå¸Œæœ›èƒ½è¿‡æ¥å­¦ä¹ æ›´å¤šçš„ä¸œè¥¿ï¼› æœ¬èº«XXXæ˜¯è€ç‰Œçš„ç ”å‘å…¬å¸ï¼Œç ”å‘å®åŠ›å¾ˆå¼ºï¼Œä½†æ˜¯å°±ç°é˜¶æ®µæ¥è¯´ï¼Œè‡ªå·±ä¸Šå‡åŠå‘å±•åˆ°è¾¾äº†ä¸€ä¸ªç“¶é¢ˆæœŸï¼ŒæœŸæœ›å‡ºæ¥å¯»æ±‚ç»™å¤šçš„æŠ€æœ¯ã€‚ 9130å®¢æˆ·ç«¯ Luaçš„Hashæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ Hashæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ ä»‹ç»ä¸€ä¸‹é¡¹ç›®ä¸­å¯¼èˆªï¼Ÿ ä»‹ç»ä¸€ä¸‹Mono Googleçš„Probufferä»‹ç» Luaçš„moduleæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ C++å’ŒLuaæ˜¯å¦‚ä½•äº¤äº’çš„ï¼Ÿ æœåŠ¡å™¨ æè¿°æœåŠ¡å™¨æ¶æ„ï¼Ÿ å…¨çƒæœä¸­å¦‚ä½•ç®¡ç†ç©å®¶è¿æ¥ï¼Œå½“æœ‰ä¸€ä¸ªé€»è¾‘æœå®•æœºä¹‹åå¦‚ä½•å¤„ç†ï¼Ÿ å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ï¼Ÿ TCP/IPçš„æ»‘åŠ¨çª—å£ æœç‹äºŒé¢ é’ˆå¯¹é¡¹ç›®æƒ…å†µé—®ä¸€äº›æŠ€æœ¯é—®é¢˜å§ï¼Œä¸è¿‡é—®äº†å¥½å‡ æ¬¡æœ‰é‡åˆ°ä»€ä¹ˆæŠ€æœ¯é—®é¢˜æˆ–è€…æŠ€æœ¯éš¾ç‚¹ä¹‹ç±»çš„ã€‚ é—®äº†ä¸€ä¸‹AssetBundleç®¡ç† è¿˜æœ‰èµ„æºç®¡ç† è¿˜æœ‰é—®äº†ä¸€ä¸‹å†…å­˜å ç”¨ï¼Œé¢æ•°ï¼Œdrawcallå ç”¨ï¼Œdrawcallå¦‚ä½•åˆç†åˆ†é…ã€‚æ¨¡å‹åˆ’åˆ†ã€‚15.2Kçš„ä¸‰è§’å½¢æ•°ï¼Œ14.6kçš„é¡¶ç‚¹æ•°ï¼ŒBatchesï¼š83ï¼ŒDraw Callsï¼š85 å¥½æ¸¸ç§‘æŠ€ è§’è‰²é®æŒ¡æ˜¾ç¤º æ¸²æŸ“ç®¡çº¿ Unityæ˜¯å·¦æ‰‹åæ ‡ç³»è¿˜æ˜¯å³æ‰‹åæ ‡ç³» å±å¹•åæ ‡å¦‚ä½•è½¬æ¢åˆ°ä¸–ç•Œåæ ‡ 1Camera.main.ScreenToWorldPoint(new vector3(x,y,0)) æ’­æ”¾åŠ¨ä½œåˆ°ä¸€å®šæ—¶é—´çš„æ—¶å€™å¦‚ä½•æ’­æ”¾ç²’å­ å¦‚ä½•å°†3DMAXçš„æ¨¡å‹å¯¼å…¥UNITYä¸­ï¼Œå¦‚ä½•æ’­æ”¾3DMAXåŠ¨ä½œæ–‡ä»¶ 2Dåœºæ™¯ï¼Œ3Däººç‰©å¦‚ä½•å®ç° å¦‚ä½•å®ç°çƒ­æ›´æ–° å¦‚ä½•è¯»å–StreamingAssetä¸‹é¢çš„èµ„æº GameObject.Findå’Œtransform.Findçš„åŒºåˆ«ç¬¬ä¸€ä¸ªè¿”å›GameObjectç±»å‹å¹¶ä¸”æœªæ¿€æ´»çš„å¯¹è±¡ä¸ä¼šè¢«æŸ¥æ‰¾åˆ°ï¼Œç¬¬äºŒä¸ªè¿”å›Transformç±»å‹ã€‚ ç»“æ„ä½“å’ŒClassçš„åŒºåˆ« Foreachéå†ç±»é‡Œé¢æ‰€æœ‰çš„æˆå‘˜ ä»€ä¹ˆæ˜¯åç¨‹ï¼Œä¸ºä»€ä¹ˆåç¨‹å¯ä»¥åˆ†å¸ƒæ‰§è¡Œ ç±»å†…åˆå§‹åŒ–å˜é‡å’Œæ„é€ å‡½æ•°åˆå§‹åŒ–å˜é‡çš„åŒºåˆ« ç½‘æ˜“TA åˆ¤æ–­ç‚¹åœ¨å¤šè¾¹å½¢å†…éƒ¨ ä¸ç”¨åˆ†æ”¯è¯­å¥æ¨å¯¼ä¸‰è§’æ³¢å‡½æ•°å›¾åƒçš„å‡½æ•° GPU instanceä¸­ï¼Œæ¸²æŸ“å¤§é‡è‰ç”¨ä»€ä¹ˆæ–¹å¼å­˜å‚¨è‰çš„é¢œè‰²ä½ç½®æ¯”è¾ƒå¥½ åŒçº¿æ€§è¿‡æ»¤ 4å€å„å‘å¼‚æ€§è¿‡æ»¤ é‚»è¿‘ç‚¹è¿‡æ»¤å’Œä¸‰æ¬¡æ’å€¼ï¼ŒåŒä¸‰æ¬¡æ’å€¼ï¼Œçº¿æ€§æ’å€¼ä¼˜åŒ–è¿‡åçš„é‡‡æ ·æ¬¡æ•° ç»™ä½ åœºæ™¯ç‰©ä½“çš„é¡ºåºå’Œæ··åˆå› å­è®©ä½ è®¡ç®—æœ€åçš„é¢œè‰²çš„rgba rgbè½¬hsvçš„å…¬å¼ ç¾æœ¯ç»™æ¨¡å‹åšç»†åˆ†å’ŒGPUæ›²é¢ç»†åˆ†çš„é€‚ç”¨åœºåˆå’Œä¼˜ç¼ºç‚¹ æ­£äº¤æŠ•å½±ä¸‹è®¡ç®—è‰¯å¥½æ•ˆæœè¾¹ç¼˜å…‰çš„æ–¹æ³• æè¿°ä¸€ä¸‹æ²™æ¼ çš„åœ°è²Œç‰¹å¾å’Œå½¢æˆåŸå›  è‰²ç›¸å·®çš„è¡¨ç°å’Œå®ç°æ–¹æ³•]]></content>
      <tags>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Real Time Rendering 3rd ç¬¬äºŒéƒ¨åˆ†]]></title>
    <url>%2F2018%2F03%2F13%2FReal-Time-Rendering-3rd-2%2F</url>
    <content type="text"><![CDATA[å›¾å½¢æ¸²æŸ“ä¸è§†è§‰å¤–è§‚æ¸²æŸ“ä¸è§†è§‰ç‰©ç†ç°è±¡]]></content>
      <tags>
        <tag>Real Time Rendering 3rd</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ€§èƒ½ä¼˜åŒ–ï¼Œæ°¸æ— æ­¢å¢ƒ---CPUç¯‡]]></title>
    <url>%2F2018%2F03%2F05%2Foptimzation-cpu%2F</url>
    <content type="text"><![CDATA[æ€§èƒ½ä¼˜åŒ–æ˜¯æ¸¸æˆé¡¹ç›®å¼€å‘å·¥ç¨‹ä¸­ä¸€ä¸ªæ°¸æ’çš„è¯é¢˜ã€‚ç©å®¶çš„éœ€æ±‚å’Œé¡¹ç›®çš„è¦æ±‚æ°¸è¿œéƒ½åœ¨ä¸åœå¢é•¿ï¼ŒåŒå±äººæ•°ã€å±å¹•ç‰¹æ•ˆå’Œåœºæ™¯å¤æ‚åº¦æ°¸è¿œåœ¨å‘ç€â€æ¦¨å¹²â€œç¡¬ä»¶çš„è¶‹åŠ¿æ¯•ç«Ÿã€‚æ‰€ä»¥ï¼Œæ— è®ºç¡¬ä»¶è®¾å¤‡å‘å±•åˆ°ä½•ç§æˆéƒ½ï¼Œæ— è®ºç ”å‘å›¢é˜Ÿæœ‰å¤šä¹ˆä¸°å¯Œçš„ç»éªŒç§¯ç´¯ï¼Œæ€§èƒ½ä¼˜åŒ–æ°¸è¿œæ˜¯ä¸€ä¸ªéå¸¸æ£˜æ‰‹è€Œåˆæ— æ³•ç»•å¼€çš„é—®é¢˜ã€‚ å°±å½“å‰æ¸¸æˆè€Œè¨€ï¼Œæ€§èƒ½ä¼˜åŒ–ä¸»è¦æ˜¯å›´ç€CPUã€GPUå’Œå†…å­˜ä¸‰å¤§æ–¹é¢è¿›è¡Œã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬å°±è¿™ä¸‰æ–¹é¢è¯´è¯´å½“å‰ç§»åŠ¨æ¸¸æˆé¡¹ç›®ä¸­å­˜åœ¨çš„æ™®éé—®é¢˜çš„ç›¸åº”çš„è§£å†³æ–¹æ¡ˆã€‚ CPUæ–¹é¢å°±ç›®å‰çš„Unityç§»åŠ¨æ¸¸æˆè€Œè¨€ï¼ŒCPUæ–¹é¢çš„æ€§èƒ½å¼€é”€ä¸»è¦å¯å½’ç»“ä¸ºä¸¤å¤§ç±»ï¼šå¼•æ“æ¨¡å—æ€§èƒ½å¼€é”€å’Œè‡ªèº«ä»£ç æ€§èƒ½å¼€é”€ã€‚å…¶ä¸­ï¼Œå¼•æ“æ¨¡å—ä¸­åˆå¯ç»†è‡´åˆ’åˆ†ä¸ºæ¸²æŸ“æ¨¡å—ã€åŠ¨ç”»æ¨¡å—ã€ç‰©ç†æ¨¡å—ã€UIæ¨¡å—ã€ç²’å­ç³»ç»Ÿã€åŠ è½½æ¨¡å—å’ŒGCè°ƒç”¨ç­‰ç­‰ã€‚æ­£å› å¦‚æ­¤ï¼Œæˆ‘ä»¬åœ¨UWAæµ‹è¯„æŠ¥å‘Šä¸­ï¼Œå°±è¿™äº›æ¨¡å—è¿›è¡Œè¯¦ç»†çš„æ€§èƒ½åˆ†æï¼Œä»¥æ–¹ä¾¿å¤§å®¶å¿«é€Ÿå®šä½é¡¹ç›®çš„æ€§èƒ½ç“¶é¢ˆï¼ŒåŒæ—¶ï¼Œæ ¹æ®æˆ‘ä»¬çš„åˆ†æå’Œå»ºè®®å¯¹é—®é¢˜è¿›è¡Œè¿…é€Ÿæ’æŸ¥å’Œè§£å†³ã€‚é€šè¿‡å¤§é‡çš„æ€§èƒ½æµ‹è¯„æ•°æ®ï¼Œæˆ‘ä»¬å‘ç°æ¸²æŸ“æ¨¡å—ã€UIæ¨¡å—å’ŒåŠ è½½æ¨¡å—ï¼Œå¾€å¾€å æ®äº†æ¸¸æˆCPUæ€§èƒ½å¼€é”€çš„Top3ã€‚ ä¸€ã€æ¸²æŸ“æ¨¡å—æ¸²æŸ“æ¨¡å—å¯ä»¥è¯´æ˜¯ä»»ä½•æ¸¸æˆä¸­æœ€ä¸ºæ¶ˆè€—CPUæ€§èƒ½çš„å¼•æ“æ¨¡å—ï¼Œå› ä¸ºå‡ ä¹æ‰€æœ‰çš„æ¸¸æˆéƒ½ç¦»ä¸å¼€åœºæ™¯ã€ç‰©ä½“å’Œç‰¹æ•ˆçš„æ¸²æŸ“ã€‚å¯¹äºæ¸²æŸ“æ¨¡å—çš„ä¼˜åŒ–ï¼Œä¸»è¦ä»ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢å…¥æ‰‹ï¼š ï¼ˆ1ï¼‰é™ä½Draw CallDraw Callæ˜¯æ¸²æŸ“æ¨¡å—ä¼˜åŒ–æ–¹é¢çš„é‡ä¸­ä¹‹é‡ï¼Œä¸€èˆ¬æ¥è¯´ï¼ŒDraw Callè¶Šé«˜ï¼Œåˆ™æ¸²æŸ“æ¨¡å—çš„CPUå¼€é”€è¶Šå¤§ã€‚ç©¶å…¶åŸå› ï¼Œè¦ä»åº•å±‚Driverå’ŒGPUçš„æ¸²æŸ“æµç¨‹è®²èµ·ï¼Œé™äºç¯‡å¹…æˆ‘ä»¬ä¸åœ¨è¿™é‡Œåšè¿‡çš„çš„ä»‹ç»ã€‚https://stackoverflow.com/questions/4853856/why-are-draw-calls-expensiveé™ä½Draw Callçš„æ–¹æ³•åˆ™ä¸»è¦æ˜¯å‡å°‘æ‰€æ¸²æŸ“ç‰©ä½“çš„æè´¨ç§ç±»ï¼Œå¹¶é€šè¿‡Draw Call Batchingæ¥å‡å°‘å…¶æ•°é‡ã€‚Unityæ–‡æ¡£å¯¹äºDraw Call Batchingçš„åŸç†å’Œæ³¨æ„äº‹é¡¹æœ‰éå¸¸è¯¦ç»†çš„è®²è§£ã€‚ ä½†æ˜¯ï¼Œéœ€è¦ä¸»è¦çš„æ˜¯ï¼Œæ¸¸æˆæ€§èƒ½å¹¶éDraw Callè¶Šå°è¶Šå¥½ã€‚è¿™æ˜¯å› ä¸ºï¼Œå†³å®šæ¸²æŸ“æ¨¡å—æ€§èƒ½çš„é™¤äº†Draw Callä¹‹å¤–ï¼Œè¿˜æœ‰ç”¨äºä¼ è¾“æ¸²æŸ“æ•°æ®çš„æ€»çº¿å¸¦å®½ã€‚å½“æˆ‘ä»¬ä½¿ç”¨Draw Call Batchingå°†åŒç§æè´¨çš„ç½‘æ ¼æ¨¡å—æ‹¼åˆåœ¨ä¸€èµ·ï¼Œå¯èƒ½ä¼šé€ æˆåŒä¸€æ—¶é—´éœ€è¦ä¼ è¾“çš„æ•°æ®(Textureã€VB/IBç­‰)å¤§å¤§å¢åŠ ï¼Œä»¥è‡³äºé€ æˆå¸¦å®½â€é˜»å¡â€ï¼Œåœ¨èµ„æºæ— æ³•åŠæ—¶ä¼ è¾“è¿‡å»çš„æƒ…å†µä¸‹ï¼ŒCPUåªèƒ½ç­‰å¾…ï¼Œä»è€Œåå€’é™ä½äº†æ¸¸æˆçš„è¿è¡Œå¸§ç‡ã€‚ Draw Callå’Œæ€»çº¿å¸¦å®½æ˜¯å¤©å¹³çš„ä¸¤ç«¯ï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯å°½å¯èƒ½ç»´æŒå¤©å¹³çš„å¹³è¡¡ï¼Œä»»ä½•ä¸€è¾¹è¿‡é«˜æˆ–è¿‡ä½ï¼Œå¯¹æ€§èƒ½æ¥è¯´éƒ½æ˜¯æ— ç›Šçš„ã€‚ ï¼ˆ2ï¼‰ç®€åŒ–èµ„æºç®€åŒ–èµ„æºæ˜¯éå¸¸è¡Œä¹‹æœ‰æ•ˆçš„ä¼˜åŒ–æ‰‹æ®µã€‚åœ¨å¤§é‡çš„ç§»åŠ¨ä¸­ï¼Œå…¶æ¸²æŸ“èµ„æºå…¶å®æ˜¯â€œè¿‡é‡â€çš„ï¼Œè¿‡é‡çš„ç½‘æ ¼èµ„æºã€ä¸åˆè§„çš„çº¹ç†èµ„æºç­‰ç­‰ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨UWAæµ‹è¯„æŠ¥å‘Šä¸­å¯¹èµ„æºçš„ä½¿ç”¨è¿›è¡Œäº†è¯¦ç»†çš„å±•ç¤ºï¼ˆæ¯å¸§çš„ä¸‰è§’å½¢ç‰‡æ•°ã€ç½‘æ ¼å’Œçº¹ç†èµ„æºçš„å…·ä½“ä½¿ç”¨æƒ…å†µç­‰ï¼‰ï¼Œä»¥å¸®åŠ©å¤§å®¶æŸ¥æ‰¾å’Œå®Œå–„å­˜åœ¨é—®é¢˜çš„èµ„æºã€‚ å…³äºæ¸²æŸ“æ¨¡å—åœ¨CPUæ–¹é¢çš„ä¼˜åŒ–æ–¹æ³•è¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚LODã€Occlusion Cullingå’ŒCulling Distanceç­‰ç­‰ã€‚æˆ‘ä»¬ä¼šåœ¨åç»­çš„æ¸²æŸ“æ¨¡å—æŠ€æœ¯ä¸“é¢˜ä¸­è¿›è¡Œæ›´ä¸ºè¯¦ç»†çš„è®²è§£ï¼Œæ•¬è¯·æœŸå¾…ã€‚ äºŒã€UIæ¨¡å—UIæ¨¡å—åŒæ ·ä¹Ÿæ˜¯å‡ ä¹æ‰€æœ‰çš„æ¸¸æˆé¡¹ç›®ä¸­å¿…å¤‡çš„æ¨¡å—ã€‚ä¸€ä¸ªæ€§èƒ½ä¼˜å¼‚çš„UIæ¨¡å—å¯ä»¥å°†ç”¨æˆ·ä½“éªŒåœ¨æŠ¬é«˜ä¸€ä¸ªæ¡£æ¬¡ã€‚åœ¨ç›®å‰å›½å†…çš„å¤§é‡é¡¹ç›®ä¸­ï¼ŒNGUIä½œä¸ºUIè§£å†³æ–¹æ¡ˆçš„å æ¯”ä»ç„¶éå¸¸é«˜ã€‚æ‰€ä»¥ï¼ŒUWAæµ‹è¯„æŠ¥å‘Šå¯¹NGUIçš„æ€§èƒ½åˆ†æè¿›è¡Œäº†æå¤§çš„æ”¯æŒï¼Œæˆ‘ä»¬ä¼šæ ¹æ®ç”¨æˆ·æ‰€ä½¿ç”¨çš„UIè§£å†³æ–¹æ¡ˆï¼ˆUGUIæˆ–NGUIï¼‰çš„ä¸åŒæä¾›ä¸åŒçš„æ€§èƒ½åˆ†æå’Œä¼˜åŒ–å»ºè®®ã€‚ åœ¨NGUIçš„ä¼˜åŒ–æ–¹é¢ï¼ŒUIPanel.LateUpdateä¸ºæ€§èƒ½ä¼˜åŒ–çš„é‡ä¸­ä¹‹é‡ï¼Œå®ƒæ˜¯NGUIä¸­CPUå¼€é”€æœ€å¤§çš„å‡½æ•°ï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚UIæ¨¡å—åˆ¶ä½œçš„éš¾ç‚¹å¹¶ä¸åœ¨äºå…¶è¡¨ç°ä¸Šï¼Œå› ä¸ºUIç•Œé¢çš„è¡¨ç°åŠ›æ˜¯ç”±è®¾è®¡å¸ˆæ¥å†³å®šçš„ï¼Œä½†ä¸¤å¥—è¡¨ç°å®Œå…¨ä¸€ç›´çš„UIç³»ç»Ÿï¼Œå…¶åº•å±‚çš„æ€§èƒ½å¼€é”€åˆ™å¯èƒ½åƒå·®ä¸‡åˆ«ã€‚å¦‚ä½•è®©UIç³»ç»Ÿä½¿ç”¨å°½å¯èƒ½å°çš„CPUå¼€é”€æ¥è¾¾åˆ°è®¾è®¡å¸ˆæ‰€è®¾è®¡çš„è¡¨ç°åŠ›ï¼Œåˆ™è¶³ä»¥è€ƒéªŒæ¯ä¸€ä½UIå¼€å‘äººå‘˜çš„åˆ¶ä½œåŠŸåº•ã€‚å¯¹äºUIPanel.LateUpdateçš„ä¼˜åŒ–ï¼Œä¸»è¦ç€çœ¼äºUIPanelçš„å¸ƒå±€ï¼Œå…¶åŸåˆ™å¦‚ä¸‹ï¼š å°½å¯èƒ½å°†åŠ¨æ€UIå…ƒç´ å’Œé™æ€UIå…ƒç´ åˆ†ç¦»åˆ°ä¸åŒçš„UIPanelä¸­(UIçš„é‡å»ºä»¥UIPanelä¸ºå•ä½)ï¼Œä»è€Œå°½å¯èƒ½å°†å› ä¸ºå˜åŠ¨çš„UIæ¨¡å—å¼•èµ·çš„é‡æ„æ§åˆ¶åœ¨è¾ƒå°çš„èŒƒå›´å†…ï¼› å°½å¯èƒ½è®©åŠ¨æ€UIå…ƒç´ æŒ‰ç…§åŒæ­¥æ€§è¿›è¡Œåˆ’åˆ†ï¼Œå³è¿åŠ¨é¢‘ç‡ä¸åŒçš„UIå…ƒç´ å°½å¯èƒ½åˆ†ç¦»æ”¾åœ¨ä¸åŒçš„UIPanelä¸­ï¼› æ§åˆ¶åŒä¸€ä¸ªUIPanelä¸­åŠ¨æ€UIå…ƒç´ çš„æ•°é‡ï¼Œæ•°é‡è¶Šå¤šï¼Œæ‰€åˆ›å»ºçš„Meshè¶Šå¤§ï¼Œä»è€Œä½¿å¾—é‡æ„çš„å¼€é”€æ˜¾è‘—å¢åŠ ï¼Œæ¯”å¦‚ï¼Œæˆ˜æ–—è¿‡ç¨‹ä¸­çš„HUDè¿åŠ¨è¡€æ¡å¯èƒ½ä¼šå‡ºç°è¾ƒå¤šï¼Œæ­¤æ—¶ï¼Œå»ºè®®ç ”å‘å›¢é˜Ÿå°†è¿åŠ¨è¡€æ¡åˆ†ç¦»æˆä¸åŒçš„UIPanelï¼Œæ¯ç»„UIPanelä¸‹5~10ä¸ªåŠ¨æ€UIä¸ºå®œï¼Œå…¶æœ¬è´¨æ˜¯ä»æ¦‚ç‡ä¸Šå°½å¯èƒ½é™ä½å•å¸§ä¸­UIPanelçš„é‡å»ºå¼€é”€ã€‚ ä¸‰ã€åŠ è½½æ¨¡å—åŠ è½½æ¨¡å—åŒæ ·ä¹Ÿæ˜¯ä»»ä½•æ¸¸æˆé¡¹ç›®ä¸­æ‰€ä¸å¯ç¼ºå°‘çš„ç»„æˆæˆåˆ†ã€‚ä¸ä¹‹å‰ä¸¤ä¸ªæ¨¡å—ä¸åŒçš„æ˜¯ï¼ŒåŠ è½½æ¨¡å—çš„æ€§èƒ½å¼€é”€æ¯”è¾ƒé›†ä¸­ï¼Œä¸»è¦å‡ºç°äºåœºæ™¯åˆ‡æ¢å¤„ï¼Œä¸”CPUå ç”¨å³°å€¼å‡è¾ƒé«˜ã€‚ åœºæ™¯åˆ‡æ¢æ—¶çš„ä¸»è¦æ€§èƒ½å¼€é”€æ¯”è¾ƒé›†ä¸­ï¼Œä¸»è¦å‡ºç°äºåœºæ™¯åˆ‡æ¢å¤„ï¼Œä¸”CPUå ç”¨å³°å€¼å‡è¾ƒé«˜ã€‚ 1.åœºæ™¯å¸è½½å¯¹äºUnityå¼•æ“è€Œè¨€ï¼Œåœºæ™¯å¸è½½æ˜¯ç”±å¼•æ“è‡ªåŠ¨å®Œæˆçš„ï¼Œå³å½“æˆ‘ä»¬è°ƒç”¨ç±»ä¼¼Application.LoadLevelçš„APIæ—¶ï¼Œå¼•æ“å³ä¼šå¼€å§‹å¯¹ä¸Šä¸€åœºæ™¯è¿›è¡Œå¤„ç†ï¼Œå…¶æ€§èƒ½å¼€é”€ä¸»è¦è¢«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†å æ®ï¼š Destroy å¼•æ“å†åˆ‡æ¢åœºæ™¯æ—¶ä¼šæ”¶é›†æœªæ ‡è¯†æˆâ€DontDestoryOnLoadâ€çš„GameObjectåŠå…¶Componentï¼Œç„¶åè¿›è¡ŒDestroyã€‚åŒæ—¶ï¼Œä»£ç ä¸­çš„OnDestroyè¢«è§¦å‘æ‰§è¡Œï¼Œè¿™é‡Œçš„æ€§èƒ½å¼€é”€ä¸»è¦å–å†³äºOnDestroyå›è°ƒå‡½æ•°ä¸­çš„ä»£ç é€»è¾‘ã€‚]]></content>
      <tags>
        <tag>uwa</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬å…­éƒ¨åˆ† GPUè®¡ç®—]]></title>
    <url>%2F2018%2F03%2F03%2Fnote6%2F</url>
    <content type="text"><![CDATA[ç¬¬å…­éƒ¨åˆ† GPUè®¡ç®—ç¬¬ä¸‰åäº”ç«  ä½¿ç”¨CPUè¿›è¡Œç—…æ¯’ç‰¹å¾çš„å¿«é€ŸåŒ¹é…35.1 ä»‹ç»35.2 æ¨¡å¼åŒ¹é…35.3 GPUå®ç°35.4 ç»“æœ35.5 ç»“è®ºå’Œåç»­å·¥ä½œ35.6 å‚è€ƒèµ„æ–™ç¬¬ä¸‰åå…­ç«  ç”¨CPUè¿›è¡ŒAESåŠ å¯†å’Œè§£å¯†ç¬¬ä¸‰åä¸ƒç«  ä½¿ç”¨CUDAè¿›è¡Œé«˜æ•ˆçš„éšæœºæ•°ç”ŸæˆåŠåº”ç”¨ç¬¬ä¸‰åå…«ç«  ä½¿ç”¨CUDAè¿›è¡Œåœ°çƒå†…éƒ¨æˆåƒç¬¬ä¸‰åä¹ç«  ä½¿ç”¨CUDAçš„å¹¶è¡Œå‰ç¼€å’Œï¼ˆæ‰«ææ–¹æ³•ï¼‰ç¬¬å››åç«  é«˜æ–¯å‡½æ•°çš„å¢é‡è®¡ç®—ç¬¬å››åä¸€ç«  ä½¿ç”¨å‡ ä½•ä½“ç€è‰²å™¨å¤„ç†ç´§å‡‘å’Œå¯å˜é•¿åº¦çš„GPUåé¦ˆ]]></content>
      <tags>
        <tag>GPU Gems[3]</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬äº”éƒ¨åˆ† ç‰©ç†ä»¿çœŸ]]></title>
    <url>%2F2018%2F03%2F03%2Fnote5%2F</url>
    <content type="text"><![CDATA[ç¬¬äº”éƒ¨åˆ† ç‰©ç†ä»¿çœŸç¬¬äºŒåä¹ç«  CPUä¸Šå®æ—¶åˆšä½“ä»¿çœŸç¬¬ä¸‰åç«  å®æ—¶ä»¿çœŸä¸3Dæµä½“æ¸²æŸ“ç¬¬ä¸‰åä¸€ç«  ä½¿ç”¨CUDAè¿›è¡Œå¿«é€ŸN-bodyä»¿çœŸç¬¬ä¸‰åäºŒç«  ä½¿ç”¨CUDAè¿›è¡Œå¿«é€Ÿå®½é˜¶æ®µç¢°æ’æ£€æµ‹ç¬¬ä¸‰åä¸‰ç«  ç”¨äºç¢°æ’æ£€æµ‹çš„LCPç®—æ³•çš„CUDAå®ç°ç¬¬ä¸‰åå››ç«  ä½¿ç”¨å•è¿‡ç¨‹çš„GPUæ‰«æå’Œå››é¢ä½“è½¬æ¢çš„æœ‰å‘è·ç¦»åœº]]></content>
      <tags>
        <tag>GPU Gems[3]</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬å››éƒ¨åˆ† å›¾åƒæ•ˆæœ]]></title>
    <url>%2F2018%2F03%2F03%2Fnote4%2F</url>
    <content type="text"><![CDATA[ç¬¬å››éƒ¨åˆ† å›¾åƒæ•ˆæœç¬¬äºŒåä¸€ç«  çœŸæ­£çš„Impostorç¬¬äºŒåäºŒç«  åœ¨GPUä¸Šå¤„ç†å‘ç°è´´å›¾ç¬¬äºŒåä¸‰ç«  é«˜é€Ÿçš„ç¦»å±ç²’å­ç¬¬äºŒåå››ç«  ä¿æŒçº¿æ€§çš„é‡è¦æ€§ç¬¬äºŒåäº”ç«  åœ¨CPUä¸Šæ¸²æŸ“å‘é‡å›¾ç¬¬äºŒåå…­ç«  é€šè¿‡é¢œè‰²è¿›è¡Œå¯¹è±¡æ¢æµ‹ï¼šä½¿ç”¨CPU è¿›è¡Œå®æ—¶è§†é¢‘å›¾åƒå¤„ç†ç¬¬äºŒåä¸ƒç«  ä½œä¸ºåç½®å¤„ç†æ•ˆæœçš„è¿åŠ¨æ¨¡ç³Šç¬¬äºŒåå…«ç«  ä½¿ç”¨æ™¯æ·±åæœŸå¤„ç†]]></content>
      <tags>
        <tag>GPU Gems[3]</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬ä¸‰éƒ¨åˆ† æ¸²æŸ“]]></title>
    <url>%2F2018%2F03%2F03%2Fnote3%2F</url>
    <content type="text"><![CDATA[ç¬¬ä¸‰éƒ¨åˆ† æ¸²æŸ“ç¬¬åå››ç«  ç”¨äºçœŸå®æ„Ÿå®æ—¶çš®è‚¤æ¸²æŸ“çš„é«˜çº§æŠ€æœ¯ç¬¬åäº”ç«  å¯æ’­æ”¾çš„å…¨æ–¹ä½æ•æ‰ç¬¬åå…­ç«  Crysis ä¸­æ¤è¢«çš„è¿‡ç¨‹åŒ–åŠ¨ç”»å’Œç€è‰²ç¬¬åä¸ƒç«  é²æ£’çš„å¤šé•œé¢åå°„å’ŒæŠ˜å°„ç¬¬åå…«ç«  ç”¨äºæµ®é›•æ˜ å°„çš„æ¾æ•£å¼é”¥å½¢æ­¥è¿›ç¬¬åä¹ç«  Tabula Rasaä¸­çš„å»¶è¿Ÿç€è‰²ç¬¬äºŒåç«  åŸºäºGPUçš„é‡è¦æ€§é‡‡æ ·]]></content>
      <tags>
        <tag>GPU Gems[3]</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬äºŒéƒ¨åˆ† å…‰ç…§å’Œé˜´å½±]]></title>
    <url>%2F2018%2F03%2F03%2Fnote2%2F</url>
    <content type="text"><![CDATA[ç¬¬äºŒéƒ¨åˆ† å…‰ç…§å’Œé˜´å½±ç¬¬å…«ç«  åŒºåŸŸæ±‚å’Œçš„å·®å€¼é˜´å½±è´´å›¾8.1 ä»‹ç»8.2 ç›¸å…³å·¥ä½œ8.3 percentage-closer è¿‡æ»¤8.4 æ’å€¼é˜´å½±è´´å›¾8.5 åŒºåŸŸæ±‚å’Œæ’å€¼é˜´å½±è´´å›¾8.6 percentage-closer è½¯é˜´å½±8.7 ç»“è®º8.8 å‚è€ƒèµ„æ–™ç¬¬ä¹ç«  ä½¿ç”¨å…¨å±€ç…§æ˜å®ç°äº’åŠ¨çš„ç”µå½±çº§é‡å…‰ç…§9.1 ä»‹ç»9.2 ç®—æ³•æ€»è§ˆ9.3 èšé›†æ ·æœ¬9.4 ä¸€æ¬¡åå°„çš„é—´æ¥ç…§æ˜9.5 ç”¨äºå‹ç¼©çš„å°æ³¢9.6 å¢åŠ å¤šæ¬¡åå°„9.7 å¯¹ç¨€ç–çŸ©é˜µè¿›è¡Œå‹ç¼©9.8 åŸºäºGPUçš„é‡å…‰ç…§å¼•æ“9.9 ç»“æœ9.10 ç»“è®º9.11 å‚è€ƒèµ„æ–™ç¬¬åç«  åœ¨å¯ç¼–ç¨‹çš„GPUä¸­å®ç°å¹¶è¡Œåˆ†å‰²çš„é˜´å½±è´´å›¾ç¬¬åä¸€ç«  ä½¿ç”¨å±‚æ¬¡åŒ–çš„é®æŒ¡å‰”é™¤å’Œå‡ ä½•ä½“ç€è‰²å™¨å¾—åˆ°é«˜æ•ˆé²æ£’çš„é˜´å½±ä½“ç¬¬åäºŒç«  é«˜è´¨é‡çš„ç¯å¢ƒé®æŒ¡ç¬¬åä¸‰ç«  ä½œä¸ºåç½®å¤„ç†çš„ä½“ç§¯å…‰ç…§æ•£å°„]]></content>
      <tags>
        <tag>GPU Gems[3]</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç¬¬ä¸€éƒ¨åˆ† å‡ ä½•ä½“]]></title>
    <url>%2F2018%2F03%2F03%2FGPU-Gems-3-note%2F</url>
    <content type="text"><![CDATA[ç¬¬ä¸€éƒ¨åˆ† å‡ ä½•ä½“å°½ç®¡åƒç´ å’Œåƒç´ ç€è‰²å™¨æ›´åŠ å¸å¼•äººä»¬çš„ç›®å…‰ï¼Œä½†å‡ ä½•ä½“æ‰æ˜¯ä¸€åˆ‡çš„æ ¹æºæ‰€åœ¨ã€‚æ²¡æœ‰äº†å‡ ä½•ä½“ï¼Œæˆ‘ä»¬å°†å‘ç°å…‰ç…§ã€é˜´å½±å’Œåå°„æ¯«æ— æ„ä¹‰ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæé«˜åº•å±‚å‡ ä½•ä½“çš„å¤æ‚åº¦ï¼Œå°†åŒæ—¶åƒç´ çš„è´¨é‡ã€‚è¯¥ä¹¦æœ¬éƒ¨åˆ†æè¿°çš„ä¸»é¢˜æ­£å¼â€œå¤æ‚æ€§â€ï¼Œä»¥å‰éœ€è¦ä½¿ç”¨CPUæ¥å¢å¼ºåœºæ™¯å¤æ‚åº¦çš„æ–¹æ³•ï¼Œç°åœ¨å·²ç»èƒ½åœ¨GPUä¸Šå®ç°ã€‚å¾ˆå¤šè§£å†³æ–¹æ¡ˆç”±äºå›¾å½¢ç¡¬ä»¶çš„æ–°åŠŸèƒ½å’ŒDirectX 10çš„é—®ä¸–å˜å¾—å¯èƒ½ï¼Œè¿™äº›æ–°åŠŸèƒ½åŒ…æ‹¬å‡ ä½•ä½“ç€è‰²å™¨ï¼ˆgeometry shaderï¼‰ã€æµè¾“å‡ºï¼ˆstream outï¼‰å’Œç¼“å­˜è·å–ï¼ˆbuffer fetchesï¼‰ã€‚å½“ç„¶ï¼Œå¾ˆå¤šæ–‡ç« ä¹Ÿæ”¹è¿›äº†é‚£äº›æ›¾ç»é€‚ç”¨äºä»¥å‰ç¡¬ä»¶çš„æŠ€æœ¯ã€‚ç¬¬1ç« ï¼Œâ€œä½¿ç”¨GPUç”Ÿæˆå¤æ‚çš„ç¨‹åºåŒ–åœ°å½¢â€ï¼Œç”¨ç¨‹åºåŒ–æ–¹æ³•ç”Ÿæˆå¤æ‚å‡ ä½•ä½“ï¼ŒNVIDIAå…¬å¸çš„Ryan Geissé˜è¿°äº†å¦‚ä½•ä½¿ç”¨è®¸å¤šç¡¬ä»¶çš„æ–°åŠŸèƒ½æ¥ç”Ÿæˆå¸¦æœ‰ä¸€äº›ç‰¹æ€§çš„åœ°æ ‡ï¼Œè€Œè¿™äº›ç‰¹æ€§åœ¨ä½¿ç”¨é€šå¸¸çš„ç¨‹åºåŒ–åˆæˆæ—¶å¾ˆå°‘è§åˆ°ã€‚ç‰¹åˆ«å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒGeissæè®®å¯¹ç¨‹åºåŒ–åœ°å½¢è¿›è¡Œæ§åˆ¶ï¼Œä»è€Œå¯ä»¥imianç¨‹åºåŒ–æ–¹æ³•çš„æœ€å¤§å¼Šç«¯ã€‚ç¬¬4ç« ï¼Œâ€œä¸‹ä¸€ä»£SpeedTreeæ¸²æŸ“â€ï¼Œä»‹ç»äº†å¦ä¸€ä¸ªå®¤å¤–ç¯å¢ƒå‡ ä½•ä½“çš„æ¸²æŸ“ï¼šæ ‘ã€‚NVIDIAçš„Alexander Kharlaovã€lain Cantlayå’ŒYury Stepanenkoå…±åŒåˆä½œï¼Œæä¾›äº†é‚£äº›ç›¸å¯¹é è¿‘è§‚å¯Ÿè€…çš„æ ‘æœ¨çš„ç»†èŠ‚è¡¨ç°ã€‚æœ¬ç« æ¶‰åŠäº†æ¸²æŸ“çš„æ‰€æœ‰æ–¹é¢ï¼Œä»å¢å¼ºå‡ ä½•ä½“åˆ°æ”¹è¿›å…‰ç…§å’Œé˜´å½±ã€‚ä½œä¸ºæ ‘ä¸»é¢˜çš„æ‰©å±•ï¼Œç¬¬6ç« ï¼Œå³Electronic Arts/Digital lllusions CE çš„Renaldas Ziomaæ‰€å†™çš„â€œGPUç”Ÿæˆçš„æ ‘çš„è¿‡ç¨‹å¼é£å¹åŠ¨ç”»â€ï¼Œé˜è¿°äº†å¦‚ä½•æ”¹è¿›æ ‘çš„åŠ¨ç”»æ•ˆæœã€‚è¿‡ç¨‹å¼çš„é£æ•ˆæœå…è®¸å¼€å‘è€…è¶…è¶Šç›®å‰ç®€å•çš„è®¸å¤šåº”ç”¨çš„é™åˆ¶ã€‚å¤„ç†å¤§é‡ç®€å•åŠ¨ç”»çš„åŠŸèƒ½åŒæ ·å¯¹äºæ”¹è¿›å¤æ‚åº¦æ„ä¹‰é‡å¤§ã€‚ç¬¬2ç« ä¸­â€œç¾¤ä½“åŠ¨ç”»æ¸²æŸ“â€ ç¬¬ä¸€ç«  ä½¿ç”¨CPUç”Ÿæˆå¤æ‚çš„ç¨‹åºåŒ–åœ°å½¢1.1ä»‹ç»ä¼ ç»Ÿä¸Šï¼Œç¨‹åºåŒ–åœ°å½¢(procedural terrains)å—é™äºCPUç”Ÿæˆçš„å¹¶ç”¨GPUè¿›è¡Œæ¸²æŸ“çš„é«˜åº¦é•¿(height fields)ã€‚ç„¶è€Œï¼Œç”Ÿæˆå¤æ‚çš„åœ°å½¢æ˜¯ä¸€é¡¹é«˜åº¦å¹¶è¡ŒåŒ–çš„ä»»åŠ¡ï¼ŒCPUçš„ä¸²è¡Œå¤„ç†æœ¬è´¨å¹¶ä¸é€‚åˆå®Œæˆè¿™é¡¹å·¥ä½œã€‚æ­¤å¤–ï¼ŒCPUç”Ÿæˆé«˜åº¦åœºçš„æ–¹æ³•ä¹Ÿæ— æ³•æä¾›å¸å¼•äººçš„åœ°å½¢ç‰¹å¾ï¼ˆå¦‚å‡¹æ´å’Œå‡¸èµ·ç‰©ï¼‰ã€‚ ä¸ºäº†åœ¨äº¤äº’çº§çš„å¸§é€Ÿç‡ä¸‹ï¼Œç”Ÿæˆé«˜åº¦å¤æ‚çš„ç¨‹åºåŒ–åœ°å½¢ï¼Œæˆ‘ä»¬è½¬è€Œä½¿ç”¨GPUã€‚é€šè¿‡ä½¿ç”¨DirectX 10çš„æ–°ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿç”Ÿæˆå¤§å—çš„å¤æ‚ç¨‹åºåŒ–åœ°å½¢ã€‚æœ€ç»ˆï¼Œè¿™äº›å—å…±åŒåˆ›å»ºä¸€ä¸ªå¤§å‹çš„ã€å…·æœ‰ç»†èŠ‚çš„å¤šè¾¹å½¢ç½‘æ ¼ï¼Œä»¥è¡¨ç¤ºå½“å‰è§†é”¥è§‚å¯Ÿåˆ°çš„åœ°å½¢ã€‚ 1.2 Marching Cubesç®—æ³•å’Œå¯†åº¦å‡½æ•°ç†è®ºä¸Šï¼Œåœ°å½¢è¡¨é¢å¯ä»¥ç”¨å•ä¸ªå‡½æ•°å®Œæ•´çš„æè¿°ï¼Œè¿™ä¸ªå‡½æ•°è¢«ç§°ä¸ºå¯†åº¦å‡½æ•°(density function)ã€‚å¯¹äº3Dç©ºé—´çš„ä»»æ„ä¸€ç‚¹(x,y,z)ï¼Œå¯†åº¦å‡½æ•°äº§ç”Ÿä¸€ä¸ªå•ç²¾åº¦æµ®ç‚¹å€¼ã€‚è¿™äº›å€¼ 1.3 åœ°å½¢ç”Ÿæˆç³»ç»Ÿæ¦‚è¿°1.4 åœ¨åœ°å½¢å—ä¸­ç”Ÿæˆå¤šè¾¹å½¢1.5 çº¹ç†å’Œå…‰å½±1.6 å¯¹å®é™…åº”ç”¨çš„è€ƒè™‘1.7 ç»“è®º1.8 å‚è€ƒèµ„æºç¬¬äºŒç«  ç¾¤ä½“åŠ¨ç”»æ¸²æŸ“2.1 ç›®çš„2.2 å®ä¾‹åŒ–çš„ç®€å•å›é¡¾2.3 æŠ€æœ¯ç»†èŠ‚2.4 å…¶å®ƒè€ƒè™‘å› ç´ ç»“è®ºå‚è€ƒèµ„æ–™ç¬¬ä¸‰ç«  DirectX 10 æ··åˆå½¢çŠ¶ï¼šæ‰“ç ´é™åˆ¶3.1 ä»‹ç»Dawnä¾‹å­çš„å®ç°è¿è¡Œä¾‹å­æ€§èƒ½å‚è€ƒèµ„æ–™ç¬¬å››ç«  ä¸‹ä¸€ä»£SpeedTree æ¸²æŸ“4.1 ä»‹ç»4.2 è½®å»“è£å‡4.3 é˜´å½±4.4 æ ‘å¶å…‰ç…§4.5 é«˜åŠ¨æ€èŒƒå›´å’Œåé”¯é½¿4.6 åŠé€æ˜è¦†ç›–4.7 ç»“è®º4.8 å‚è€ƒèµ„æ–™ç¬¬äº”ç«  æ™®éè‡ªé€‚åº”çš„ç½‘æ ¼ä¼˜åŒ–5.1 ä»‹ç»5.2 æ€»è§ˆ5.3 è‡ªé€‚åº”ä¼˜åŒ–æ¨¡å¼5.4 æ¸²æŸ“å·¥ä½œæµ5.5 ç»“æœ5.6 ç»“è®ºå’Œæ”¹è¿›5.7 å‚è€ƒèµ„æ–™ç¬¬å…­ç«  GPUç”Ÿæˆçš„æ ‘çš„è¿‡ç¨‹å¼é£åŠ¨ç”»6.1 ä»‹ç»6.2 GPUä¸Šçš„è¿‡ç¨‹å¼åŠ¨ç”»6.3 ç°è±¡å­¦æ–¹æ³•6.4 æ¨¡æ‹Ÿæ­¥éª¤6.5 æ¸²æŸ“æ ‘6.6 åˆ†æå’Œæ¯”è¾ƒ6.7 ç»“è®º6.8 å‚è€ƒèµ„æ–™ç¬¬ä¸ƒç«  GPUä¸ŠåŸºäºç‚¹çš„å˜å½¢çƒå¯è§†åŒ–7.1 å˜å½¢çƒã€å…‰æ»‘ç²’å­æµä½“åŠ›å­¦å’Œè¡¨é¢ç²’å­7.2 é™åˆ¶ç²’å­7.3 å±€éƒ¨ç²’å­æ–¥åŠ›7.4 å…¨å±€ç²’å­ä¼ æ’­7.5 æ€§èƒ½7.6 æ¸²æŸ“7.7 ç»“è®º7.8 å‚è€ƒèµ„æ–™]]></content>
      <tags>
        <tag>GPU Gems</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è™šå¹»å¼•æ“å­¦ä¹ ä¹‹è·¯ï¼šæ¸²æŸ“æ¨¡å—ä¹‹å…‰ç…§ç³»ç»Ÿ]]></title>
    <url>%2F2017%2F12%2F10%2FStudy_unreal4_Rendering_1%2F</url>
    <content type="text"><![CDATA[æˆ‘ä»¬å‡†å¤‡ä»ä¸‰æ–¹é¢æ¥ä»‹ç»Unreal 4å¼•æ“çš„æ¸²æŸ“æ¨¡å—ï¼Œä¸»è¦åŒ…æ‹¬ï¼šå…‰ç…§ç³»ç»Ÿï¼Œæè´¨ç³»ç»Ÿå–å›¾åƒåå¤„ç†ã€‚æœ¬ç¯‡æ–‡ç« é‡ç‚¹è®²è§£ç¬¬ä¸€éƒ¨åˆ†ï¼šå…‰ç…§ç³»ç»Ÿã€‚åœ¨å¯¹æ¯”Unreal 4ä¸Unityä¸¤è€…å¼•æ“æ—¶ï¼Œæœ¬æ–‡åˆ†åˆ«é‡‡ç”¨çš„ç‰ˆæœ¬æ˜¯Unreal 4.18.1å’ŒUnity 5.3.8.f1ã€‚ æœ¬èŠ‚å°†ä»‹ç»Unreal 4å¼•æ“çš„å…‰ç…§ç³»ç»Ÿã€‚åœ¨ä»‹ç»åŸºç¡€åŠŸèƒ½æ—¶ï¼Œæœ¬æ–‡å°†åˆ†å››å—è¿›è¡Œä»‹ç»ï¼Œä¸»è¦åŒ…æ‹¬ï¼šå…‰æºã€å…¨å±€å…‰ç…§ã€é˜´å½±ä»¥åŠåå°„æ•ˆæœã€‚åŒæ—¶ï¼Œæœ¬æ–‡å°†ä¸Unityå¼•æ“ä¸­çš„è¿™äº›åŠŸèƒ½è¿›è¡Œå¯¹æ¯”ã€‚å¦å¤–ï¼Œå¯¹äºUnreal 4å¼•æ“ä¸­çš„ç‰¹æ®ŠåŠŸèƒ½ï¼Œæœ¬æ–‡å°†å•ç‹¬ä»‹ç»ã€‚ ä¸€ã€å…‰æºå…‰æºå¯¹äºæ¸¸æˆå¼•æ“çš„å…‰ç…§ç³»ç»Ÿæ¥è¯´æ—¶æœ€ä¸ºåŸºç¡€çš„åŠŸèƒ½æ¨¡å—ã€‚æ¸¸æˆæ¸²æŸ“ä¸­å…‰ç…§è®¡ç®—çš„æ¯ä¸€éƒ¨åˆ†éƒ½ç¦»ä¸å¼€å…‰æºã€‚é€šå¸¸æ¸¸æˆå¼•æ“é€šè¿‡ä¸‰ä¸ªé‡è¦å±æ€§å¯¹å‘˜å…‰æºè¿›è¡Œäº†åˆ†ç±»ï¼šå…‰æºç±»å‹ã€å®æ—¶æ€§ä»¥åŠæ¸²æŸ“ç®¡çº¿ã€‚å¯¹äºä¸åŒå±æ€§çš„å…‰æºï¼Œå…¶å…‰ç…§è®¡ç®—æ–¹å¼å’Œå¤æ‚ç¨‹åº¦éƒ½æœ‰æ‰€ä¸åŒã€‚åœ¨æ¥ä¸‹æ¥çš„å†…å®¹ä¸­ï¼Œæœ¬æ–‡å°†å¯¹Unreal 5å’ŒUnityå¼•æ“çš„å…‰æºåœ¨è¿™ä¸‰ä¸ªæ–¹é¢è¿›è¡Œæ¯”è¾ƒã€‚ 1ã€å…‰æºç±»å‹Unreal 4å¼•æ“ä¸­ï¼Œå¯åœ¨åœºæ™¯ä¸­åˆ›å»ºçš„å…‰æºç±»å‹æœ‰å››ç§ï¼šæ–¹å‘å…‰ã€ç‚¹å…‰æºã€èšå…‰ç¯å’Œå¤©ç©ºå…‰ã€‚ åˆ›å»ºæ–¹å¼è·ŸUnityç±»ä¼¼ï¼Œåªéœ€é€šè¿‡åœ¨Unreal 4åœ°å›¾ç¼–è¾‘å™¨ä¸­ç‚¹å‡»å·¦ä¸Šè§’çš„â€Modesâ€é¡µé¢ï¼Œé€‰æ‹©â€Lightsâ€æ ‡ç­¾ï¼Œå³å¯åœ¨å…¶å­èœå•é€‰æ‹©éœ€è¦çš„å…‰æºæ‹–æ”¾çš„åœºæ™¯ä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šUnreal 4å¼•æ“ä¸­çš„å¤©ç©ºå…‰å…¶ä½œç”¨æ˜¯ï¼šè‡ªåŠ¨è·å–è¿œå¤„çš„å…¥å°„å…‰ä¿¡æ¯ï¼Œç„¶åç”¨äºåœºæ™¯ä¸­ç‰©ä½“çš„å…‰ç…§è®¡ç®—ã€‚è¿œå¤„çš„å…¥å°„å…‰ä¿¡æ¯æ¶µç›–äº†â€Sky Distance Thresholdâ€è®¾ç½®çš„è·ç¦»ä»¥å¤–çš„æ‰€æœ‰å…¥å°„å…‰æ¥æºï¼ŒåŒ…æ‹¬è¿œæ™¯=å¤©ç©ºç›’=äº‘é›¾ç­‰ã€‚å®ƒçš„å®ç°æ–¹å¼æ˜¯å…ˆå°†è¿œå¤„çš„å…¥å°„å…‰ä¿¡æ¯æ¸²æŸ“åˆ°Cube Mapä¸­ï¼Œç„¶åä½¿ç”¨è¿™å¼ Cube Mapæ¥è®¡ç®—å…‰ç…§ã€‚åœ¨Unityä¸­ä¹Ÿå¯ä»¥åœ¨Lightingè®¾ç½®ä¸­é‡‡ç”¨Sky Boxä½œä¸ºç¯å¢ƒå…‰çš„è¾“å…¥ï¼Œä½†æ˜¯Unityæ²¡æœ‰å°†å…¶ä½œä¸ºå•ç‹¬å¯æ”¾å…¥åœºæ™¯çš„å…‰æºã€‚ 2ã€å®æ—¶æ€§åœ¨Unreal 4çš„å…‰æºå±æ€§ä¸­ï¼Œæœ‰ä¸€é¡¹Mobilityè¡¨ç¤ºå…‰æºçš„å¯ç§»åŠ¨æ€§ä»¥åŠå…‰ç…§è®¡ç®—å®æ—¶æ€§ã€‚å®ƒåŒ…å«äº†ä¸‰ç§ç±»å‹ï¼šStaticã€Stationaryä»¥åŠMovableã€‚å®ƒä¸Unityä¸­å…‰æºç±»å‹çš„Staticã€Mixedã€Realtimeå…·æœ‰ç±»ä¼¼å«ä¹‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š]]></content>
      <tags>
        <tag>Unreal</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸–ç•Œbossè®¾è®¡]]></title>
    <url>%2F2017%2F11%2F07%2Fword-boss%2F</url>
    <content type="text"><![CDATA[è®¾è®¡ç›®çš„ï¬ä½œä¸ºä¸»è¦çš„é‡‘é’±é¢å¤–å‘æ”¾é€šé“ï¼Œé©±åŠ¨å°½å¯èƒ½å¤šçš„ç©å®¶å‚ä¸ã€‚ï¬å°†ä¸–ç•Œbossåˆ†ä¸ºå¤§å°ä¸¤ä¸ªç±»å‹ï¼Œé˜¶æ¢¯æ€§çš„å­¦ä¹ ï¼Œé¼“åŠ±ä½çº§ç”¨æˆ·å‚ä¸ï¼Œé™ä½æŒ«æŠ˜æ„Ÿï¬åœ¨ä¸–ç•Œbosså’Œæ½œåœ¨çš„ç«äº‰å¯¹æ‰‹çš„å‹åŠ›ä¸‹ï¼Œè®©ç©å®¶å¼€å§‹è‡ªå‘çš„ç»„ç»‡ï¼Œé€æ­¥å½¢æˆç¤¾ä¼šå…³ç³»ã€‚ç”±äºå°bosséœ€è¦çš„ç»„ç»‡éš¾åº¦è¾ƒä½ï¼Œç©å®¶å¾ˆå®¹æ˜“å½¢æˆç»„ç»‡ã€‚è€Œå¤§bossæ™®é€šç©å®¶åªéœ€è¦ä¾æ‰˜å…¬ä¼šï¼Œè€Œå…¬ä¼šçš„ç»„ç»‡ä¸»è¦æ¥æºäºé«˜ç«¯ç©å®¶ï¼Œæ™®é€šç©å®¶åªéœ€è¦å‚ä¸åˆ°è¿™ç§ç¤¾ä¼šå…³ç³»ä¸­ï¼Œè€Œä¸éœ€è¦è€—è´¹é¢å¤–çš„ç²¾åŠ›å»ç»„ç»‡ï¬åŒæ—¶ï¼Œä¸–ç•Œbossè¿˜æ˜¯ä¸€ä¸ªç©å®¶å°è¯è‡ªæˆ‘ä»·å€¼ï¼ˆå’Œå…¶ä»–ç©å®¶åŒæ¯”ï¼‰çš„æ–¹å¼ï¼Œé€šè¿‡PVEå’Œpvpçš„æ¯”æ‹¼æ¥ä½œä¸ºæˆé•¿å‹åŠ›çš„å®£æ³„ã€‚ å¤§æ¦‚æè¿°ï¬ä¸–ç•Œä¸Šæ•£è½ç€å¾ˆå¤šä¸ªä¼é­”é˜µçš„é˜µçœ¼ï¬é€šè¿‡å„ç§æ–¹å¼æ¿€æ´»é˜µçœ¼ï¼Œå¹¶å‡»ç ´é˜µçœ¼åï¼Œç©å®¶å°±ä¼šè¢«ä¼ å…¥åˆ°å°å°ä¸–ç•Œbossçš„ç¦é˜µä¸­ï¬å¤šä¸ªé˜Ÿä¼ï¼ˆå…¬ä¼šï¼‰æ”»å‡»bossï¼Œå½“é™æ—¶ç»“æŸæˆ–è€…æˆåŠŸå‡»æ€åï¼Œä¼¤å®³ååˆ—å‰èŒ…çš„é˜Ÿä¼è·å¾—é¢å¤–å¥–åŠ±ï¬æ¯ä¸ªè¢«ä¼ å…¥ç¦é˜µä¸­çš„ç©å®¶ï¼Œæ¯å¯¹bossé€ æˆä¸€æ¬¡ä¼¤å®³ï¼Œéƒ½ä¼šè·å¾—å’Œä¼¤å®³æˆæ­£æ¯”çš„é‡‘é’±æ•°ï¼ŒåŒæ—¶åœ¨é˜µä¸­çš„è¿™æ®µæ—¶é—´å†…ï¼Œéƒ½ä¼šæºæºä¸æ–­çš„è·å¾—ç»éªŒ åŸºç¡€åŸåˆ™ï¬ä¸–ç•Œbossåˆ†ä¸ºå¤§å°ä¸¤ç§ï¬ç”±äºä¸€ä¸ªåœºæ™¯å¯èƒ½å­˜åœ¨næ¡çº¿å¹¶è¡Œçš„åŸå› ï¼Œè€Œè¿™ä¸ªnå¹¶ä¸ç¡®å®šï¼Œä¸–ç•Œbosså¦‚æœå†å•ç‹¬åˆ·åœ¨å¤§ä¸–ç•Œçš„åœºä¸­ï¼Œåˆ™åˆ·å¤šå°‘ä¸ªbosså®Œå…¨æ— æ³•ç¡®å®šï¼Œä½œä¸ºä¸€ä¸ªé‡è¦å’Œæ•æ„Ÿçš„å‘æ”¾æ¸ é“ï¼Œè¿™ç§æ–¹å¼å°†æ˜¯å®Œå…¨ä¸å¯æ¥å—çš„ã€‚å› æ­¤éœ€è¦æ›´æ”¹ä¸–ç•Œbossçš„å½¢å¼ã€‚ï¬ä¸–ç•Œbosså•ç‹¬åˆ·åœ¨ä¸€ä¸ªç‰¹å®šåœºæ™¯ï¼ˆæš‚ä¸”ç§°ä¹‹ä¸ºç¦é˜µï¼‰ä¸­ï¼Œè¯¥åœºæ™¯é™¤äº†bossä»¥å¤–å‡ ä¹æ²¡æœ‰å…¶ä»–NPCå’Œå…¶ä»–é€»è¾‘ï¼Œå› æ­¤è¯¥åœºæ™¯å¯ä»¥å®¹çº³æ›´å¤šçš„ç©å®¶ï¼Œç¼“è§£äº†æœåŠ¡å™¨çš„é€»è¾‘å‹åŠ›ï¬å¿…é¡»ç”±å‡»ç ´é˜µçœ¼æ¥è·å¾—è¿›å…¥bossæˆ˜åœºæ™¯çš„èµ„æ ¼ è¯¦ç»†è®¾è®¡ä¸–ç•Œbossåˆ†ä¸ºå¤§å°ä¸¤ç§ ä½çº§bossï¬è®¾è®¡åŸºç¡€æ€è·¯ ä»¥å°é˜Ÿä¸ºå•ä½ï¼Œå¼ºè°ƒé˜Ÿä¼ä¹‹é—´çš„å¯¹æŠ—å’Œåšå¼ˆï®è¿‡ç¨‹åˆ†ä¸ºã€å¤§ä¸–ç•Œå‡»ç ´é˜µçœ¼ã€‘ã€ç¦é˜µå†…å‡»æ€bossã€‘ä¸¤ä¸ªé˜¶æ®µã€‚ï®åœ¨å¤§ä¸–ç•Œä¸Špvpæ¨¡å¼ä¸åšæ›´æ”¹ï¼Œç”±ç©å®¶æ§åˆ¶ã€‚é»˜è®¤ä¸ºå’Œå¹³ï¼Œç©å®¶å¯ä»¥é€šè¿‡å¼€çº¢æ¥å‘åŠ¨pkï®åœ¨ç¦é˜µå†…ï¼Œæ˜¯å¦pkä»ç„¶äº¤ç»™ç©å®¶å†³å®šï¼Œæƒ³ä¸»åŠ¨å‘èµ·pkçš„ä¸€æ–¹å¯ä»¥å…ˆå¼€å¯ã€æ€æˆ®ã€‘å’Œã€å…¬ä¼šæ€æˆ®æ¨¡å¼ã€‘â€”â€”ã€å…¬ä¼šæ€æˆ®æ¨¡å¼ã€‘ç°åœ¨è¿˜æ²¡å®ç°ï¼Œéœ€è¦è´Ÿè´£äººè‹åšè·Ÿè¿›å®ç°ï¬å¼€å¯ç¦é˜µï®æ— è§„å®šæ—¶é—´ï¼Œæ— å›ºå®šæ—¶é—´å¼€å¯ï®ç©å®¶åœ¨ä¸–ç•Œæ¢ç´¢ä¸­ä¼šè·å¾—ã€ä½çº§bosså¬å”¤ç¬¦ã€‘ï¼Œåœ¨ä¼é­”é˜µçš„é˜µçœ¼é™„è¿‘ä½¿ç”¨è¯¥é“å…·ï¼Œå¯ä»¥æ‰“å¼€ä¼é­”é˜µã€‚ï®åªè¦æ‹¥æœ‰é“å…·ã€å¬å”¤ç¬¦ã€‘ï¼Œå°±å¯ä»¥éšæ—¶ï¼ˆä¸–ç•Œå¤§bossæ´»åŠ¨æ—¶é—´å†…ä¸å…è®¸ï¼‰å¼€å¯ç¦é˜µï®å¬å”¤ç¬¦æœ‰Nç§ï¼Œä¸€ä¸€å¯¹åº”Nä¸ªä¸–ç•Œå°bossï¼Œä¾‹å¦‚ï¼šç„é»„å¤é¾™å¬å”¤ç¬¦å°±åªèƒ½å¬å”¤ç„é»„å¤é¾™ï¼Œå§¥å§¥å¬å”¤ç¬¦å°±åªèƒ½å¬å”¤å§¥å§¥ã€‚ï®æ¯ä¸ªå¬å”¤ç¬¦åªèƒ½åœ¨å”¯ä¸€å¯¹åº”çš„åœºæ™¯ä½¿ç”¨ï¼ˆé“å…·tipsä¸Šæœ‰è¯´æ˜ï¼Œä¾‹å¦‚ç„é»„å¤é¾™å¬å”¤ç¬¦ï¼Œtipsä¸Šå†™ç€â€œè¯¥å¬å”¤ç¬¦åªèƒ½åœ¨æµ·åº•çš„ä¼é­”é˜µå‘¨å›´ä½¿ç”¨â€ï¼‰ï®æœ‰äº›åœºæ™¯æœ‰ä¼é­”é˜µï¼Œæœ‰äº›åœºæ™¯æ²¡æœ‰ã€‚ï®æ‹¥æœ‰ä¼é­”é˜µçš„åœºæ™¯éƒ½å¯¹åº”æœ‰5ä¸ªé˜µçœ¼ï¼Œæƒ³è¦å¬å”¤çš„ç©å®¶å¿…é¡»èµ°åˆ°ä¸€ä¸ªé˜µçœ¼é™„è¿‘ä½¿ç”¨é“å…·ã€‚ïµå¬å”¤è€…èº«è¾¹ä¸€å®šä¼šç”Ÿæˆä¸€ä¸ªé˜µçœ¼ïµåœ°å›¾ä¸Šå…¶ä»–çš„4ä¸ªé˜µçœ¼ä½ç½®ä¼šéšæœºç”Ÿæˆ2ä¸ªé˜µçœ¼ïµé˜µçœ¼ç”Ÿæˆçš„æ—¶é—´ä¸º30ç§’ï¼ˆæœŸé—´ä¼šæœ‰é˜µçœ¼é€æ¸ç”Ÿæˆçš„ç‰¹æ•ˆè¡¨ç°ï¼‰ïµé˜µçœ¼ç”Ÿæˆçš„é˜¶æ®µï¼Œä¼šæœ‰è·‘é©¬ç¯å’Œä¸–ç•ŒèŠå¤©æå‡â€”-ç±»ä¼¼ï¼šç©å®¶xxxæ­£åœ¨ã€æŸä¸ªåœºæ™¯ã€‘æ‰“å¼€ä¼é­”é˜µé˜µçœ¼ã€‚ï¼ˆæ–¹æ‹¬å·çš„ä¸ºé“¾æ¥ï¼Œç‚¹å‡»åå¯ä»¥ç›´æ¥ä¼ é€åˆ°è¯¥åœºæ™¯ï¼‰ï®å¦‚æœè¯¥å¬å”¤åœºæ™¯å­˜åœ¨ç€å¤šæ¡åˆ†çº¿ï¼Œä¹Ÿåªèƒ½åœ¨ä½¿ç”¨å¬å”¤ç¬¦çš„æœ¬çº¿æ‰“å¼€é˜µçœ¼ï¼Œå…¶ä»–çš„åˆ†çº¿æ— åŠ¨é™ï®é˜µçœ¼æŒç»­2åˆ†é’Ÿï¼Œ2åˆ†é’Ÿå†…æ¯30ç§’é€šçŸ¥ä¸€æ¬¡å…¨æœï¼Œ2åˆ†é’Ÿåé˜µçœ¼æ¶ˆå¤±ã€‚ï®é˜µçœ¼ç”Ÿæˆå’ŒæŒç»­æ—¶é—´å†…ï¼Œè·‘é©¬ç¯å’Œä¸–ç•ŒèŠå¤©é€šçŸ¥å…¨æœï¼Œä¼šæœ‰ä»¥ä¸‹çš„å¤„ç†ïµç‚¹å‡»æç¤ºä¸Šçš„é“¾æ¥ï¼Œä¼šè‡ªåŠ¨å¯»è·¯èµ°åˆ°é˜µçœ¼æ‰€åœ¨çš„åœºæ™¯ïµå¦‚æœå’Œå¬å”¤è€…ä¸åœ¨åŒä¸€ä¸ªåœºæ™¯ï¼Œè‡ªåŠ¨å¯»è·¯åˆ°åˆ‡åœºæ™¯æ—¶ï¼Œè‡ªåŠ¨è¿›å…¥é˜µçœ¼æ‰€åœ¨çš„åœºæ™¯çº¿ï¼ˆå¦‚æœå¤šçº¿ï¼‰ïµåœ¨åŒä¸€ä¸ªåœºæ™¯ä¸åœ¨åŒä¸€æ¡çº¿çš„ï¼Œè‡ªåŠ¨åˆ‡çº¿åˆ°é˜µçœ¼æ‰€åœ¨çº¿ïµåˆ°è¾¾å¬å”¤åœºæ™¯åï¼Œè‡ªåŠ¨å¯»è·¯ä¸­æ­¢ï¼Œæ¥ä¸‹æ¥éœ€è¦ç©å®¶æ‰‹åŠ¨å»å¯»æ‰¾æ‰“å¼€çš„é˜µçœ¼ï¬å¦‚ä½•è¿›å…¥ç¦é˜µï®æ¯ä¸ªé˜µçœ¼è¢«å‡»ç ´ï¼Œéƒ½ä¼šä¼ é€ä¸€é˜Ÿäººè¿›å…¥bossåœºæ™¯ï®é˜µçœ¼å‡»ç ´åï¼Œéƒ½ä¼šåœ¨é˜µçœ¼åˆ·å‡ºçš„ä½ç½®å‡ºç°ä¸€ä¸ªä¼ é€é—¨ï¼Œè¯¥é—¨å­˜åœ¨æ—¶é—´ç”±ç­–åˆ’å¡«è¡¨è°ƒæ•´æ§åˆ¶ï®å¦‚ä½•æŒ‘é€‰è¿›å…¥bossåœºæ™¯çš„äººïµä¼¤å®³æœ€é«˜çš„é˜Ÿä¼è¿›å…¥bossåœºæ™¯1.ä¸€ä¸ªé˜µçœ¼è¢«æ”»å‡»æ—¶å€™ï¼Œè®°å½•å¯¹å…¶é€ æˆçš„ä¼¤å®³ï¼Œå¯¹åº”çš„ç©å®¶ï¼Œå¹¶è¿›è¡Œæ’å2.æ¯æ¬¡è®°å½•çš„æ—¶å€™ï¼Œæ˜¯ä»¥é˜Ÿä¼ä¸ºåŸºç¡€å•ä½è¿›è¡Œè®°å½•ï¼Œä¸è®°å½•ç©å®¶çš„ä¸ªäººä¼¤å®³3.æ”»å‡»é˜µçœ¼çš„è¿‡ç¨‹ä¸­ï¼Œä¼šåœ¨å®¢æˆ·ç«¯å‡ºç°ä¼¤å®³æ’è¡Œæ¦œA.åªæœ‰èµ°åˆ°é˜µçœ¼é™„è¿‘20ç±³çš„èŒƒå›´å†…ä¸”å½“æ—¶æ­£å¤„äºå¼€å¯çŠ¶æ€ä¸‹ï¼Œè¯¥æ’è¡Œæ¦œæ‰ä¼šåœ¨å®¢æˆ·ç«¯ä¸Šæ˜¾ç¤ºï¼ˆä¸ºä»€ä¹ˆæ˜¯20ç±³ï¼Œ20ç±³æ˜¯ç©å®¶æœ‰å¯èƒ½å¯¹é˜µçœ¼é€ æˆä¼¤å®³çš„æœ€å¤§æ”»å‡»è·ç¦»ï¼‰B.è¯¥æ’è¡Œæ¦œå‡ºç°åœ¨ä»»åŠ¡æ çš„ä½ç½®ï¼Œä¸´æ—¶é¡¶æ›¿æ‰ä»»åŠ¡æ C.è¯¥æ’è¡Œæ¦œæœ‰ä¸”åªæœ‰3è¡ŒD.å¦‚æœè‡ªå·±çš„é˜Ÿä¼æ’åç¬¬ä¸€ï¼Œåˆ™åœ¨ä¸‹æ–¹æ˜¾ç¤ºä¼¤å®³æœ€æ¥è¿‘è‡ªå·±çš„ä¸¤ä¸ªç»„E.å¦‚æœä¸æ’åç¬¬ä¸€ï¼Œåˆ™æ˜¾ç¤ºä¼¤å®³æ’åæ¯”è‡ªå·±é«˜ä¸€åå’Œä½ä¸€åçš„é˜Ÿä¼F.è¯¥æ’è¡Œæ¦œæ¯1ç§’åŠ¨æ€æ›´æ–°ä¸€æ¬¡G.ä¼¤å®³æ’è¡Œçš„ä¸Šä»…ä»…æ˜¾ç¤ºåæ¬¡å’Œé€ æˆçš„ä¼¤å®³æ•°å€¼H.è‡ªå·±é˜Ÿä¼åœ¨æ’è¡Œæ¦œä¸Šæ‰€åœ¨è¡Œä¼šå‡¸èµ·æ˜¾ç¤ºï¼Œè®©äººç›´è§‚ä¸Šä¸€çœ¼å°±èƒ½çœ‹å‡ºè¿™è¡Œæ˜¯è‡ªå·±é˜Ÿä¼çš„æ•°æ®ïµæ¯ä¸ªé˜µçœ¼ä»…ä»…åªæŒ‘é€‰ä¸€ä¸ªé˜Ÿä¼è¿›å…¥1.æœ€å¤§åªå¼€å¯3ä¸ªé˜µçœ¼ï¼Œä¹Ÿå°±æ˜¯è¯´æœ€å¤šæœ‰3ä¸ªé˜Ÿå¯ä»¥è¢«ä¼ å…¥bossåœºæ™¯2.é‚£äº›ç©å®¶å¯ä»¥è¿›å…¥ï¼ŸA.å½“é˜µçœ¼è¢«å‡»ç ´çš„æ—¶å€™ï¼Œç³»ç»Ÿæ‰å¼€å§‹æŒ‘äººB.æ­¤æ—¶ï¼Œå…ˆç¡®å®šä¼¤å®³æœ€é«˜çš„é˜Ÿä¼C.å†ç¡®å®šå½“å‰é˜Ÿä¼é‡Œçš„ç©å®¶ï¼Œå¹¶è®°å½•è¿™äº›ç©å®¶D.æŠŠè¿™äº›ç©å®¶éƒ½ä¼ å…¥åˆ°bossåœºæ™¯é‡Œïµé˜µçœ¼å­˜åœ¨2åˆ†é’Ÿï¼Œé˜µçœ¼æ¶ˆå¤±å‰å¦‚æœé˜µçœ¼æ²¡æœ‰è¢«å‡»ç ´ï¼Œè¯¥é˜µçœ¼ä¸ä¼šä¼ é€ä»»ä½•ä¸€ä¸ªç©å®¶è¿›å…¥bossåœºæ™¯ïµç‰¹åˆ«æ³¨æ„1.å½“é˜µçœ¼ä¼ é€äººä¹‹å‰ï¼Œéœ€è¦åˆ¤æ–­ç©å®¶æ˜¯å¦åœ¨é˜µçœ¼æ‰€åœ¨çš„åœºæ™¯ï¼Œåªæœ‰ç©å®¶å¤„äºé˜µçœ¼æ‰€åœ¨çš„åœºæ™¯ï¼Œæ‰æŠŠç©å®¶ä¼ é€ã€‚2.é˜µçœ¼è¢«å‡»ç¢åçš„2åˆ†é’Ÿå†…ï¼ˆä¹Ÿå°±æ˜¯ä¼ é€é—¨ç©¿åœ¨çš„2åˆ†é’Ÿå†…ï¼‰ï¼Œæ¯ç§’éƒ½ä¼šæ£€æµ‹æ‹¥æœ‰è¿›å…¥èµ„æ ¼çš„ç©å®¶æ˜¯å¦å‡ºç°åœ¨é˜µçœ¼é™„è¿‘20ç±³åŒºåŸŸï¼Œå¦‚æœå‡ºç°ï¼Œåˆ™æŠŠç©å®¶ä¼ é€è¿›å…¥bossåœºæ™¯ï¼ˆé¢„é˜²é˜µçœ¼å¼€å¯å‰æ‰çº¿ï¼Œé¢„é˜²é˜µçœ¼å¼€å¯å‰åˆ‡äº†åœºæ™¯ï¼‰[åé¢ä¼šå¼•ç”¨]3.ç©å®¶å¦‚æœæ­»åœ¨é™„è¿‘ï¼Œä¹Ÿå¯ä»¥è¢«ä¼ é€ï¼Œä¼ é€åå¤æ´» ï¬Bossæˆ˜æ€ä¹ˆç©ï®åœºæ™¯1.ä½¿ç”¨å¤©åŠ«å‰¯æœ¬åœºæ™¯ä¿®æ”¹A.è¯¥åœºæ™¯ç”±ä¸­å¤®çš„å¤§åœ†å½¢å¹³å°å’Œå‘¨å›´çš„3ä¸ªæµ®ç©ºé˜æ¥¼ç»„æˆB.å¤§å¹³å°å’Œé˜æ¥¼ä¹‹é—´æ²¡æœ‰å¯¼èˆªè¿æ¥ï¼Œæ²¡æ³•é€šè¿‡èµ°è·¯äº’é€šC.éœ€è¦é€šè¿‡å¯¹è¯ï¼Œè§¦å‘é£è¡Œå¯»è·¯é£åˆ°ä¸­é—´çš„æˆ˜æ–—åŒºåŸŸD.è¯¥åœºæ™¯ç¦æ­¢ç©å®¶æ‰‹åŠ¨çš„é£è¡Œ2.å‡ºç”Ÿç‚¹å’Œå¤æ´»ç‚¹A.å‡ºç”Ÿç‚¹å’Œå¤æ´»ç‚¹åœ¨3ä¸ªå°å¹³å°ä¸ŠB.ç©å®¶éšæœºå‡ºç”Ÿå’Œå¤æ´»åœ¨3ä¸ªç‚¹ä¸ŠC.æ€ä¹ˆä»å‡ºç”Ÿç‚¹åˆ°è¾¾æˆ˜æ–—åœºæ™¯ï®å¯¹è¯ï¼Œç¡®å®šåéšæœºé€‰ä¸€æ¡è¯¥å‡ºç”Ÿç‚¹è¿æ¥åˆ°bosså¹³å°çš„é£è¡Œè·¯çº¿è¿›è¡Œè‡ªåŠ¨å¯»è·¯é£è¡Œïµä½¿ç”¨tx01-85å¸§çš„åŠ¨ç”»ï¼Œå¤§ä¸–ç•Œæ¢ç´¢åŠ¨ç”»ïµç­–åˆ’åœ¨æŠ€èƒ½ç¼–è¾‘è°ƒæ•´ä¸º5ç§’ï¼Œ300å¸§ïµéœ€è¦ä¸€ä¸ªè¿æ°”èšæ•›äº‘æœµçš„ç²’å­æ•ˆæœïµ5ç§’ååŸå”±ç»“æŸï¼Œè„šåº•é©¾äº‘ï®é£è¡Œè·¯å¾„ç›¸å…³ïµåœ¨æ¯ä¸ªå¤æ´»ç‚¹ç§å¤šæ¡é£è¡Œå¯»è·¯è·¯å¾„ï¼Œè®©ä¸€å †äººä¸€èµ·é£å‡ºæ¥çš„æ—¶å€™ä¸é‡åˆï¼Œæ„Ÿè§‰æ›´æœ‰ä»ªå¼æ„Ÿïµé£è¡Œå¯»è·¯èŠ±è´¹5-10ç§’é£åˆ°åœºæ™¯ä¸­å¤®ïµé£è¡Œå¯»è·¯è¿‡ç¨‹ä¸­ä¸èƒ½ä½¿ç”¨æŠ€èƒ½ï¼Œä¸èƒ½é©¾äº‘ï¼Œåéª‘ç­‰æ‰€æœ‰äº’åŠ¨åŠŸèƒ½ï¼ˆæœ€å¥½å®¢æˆ·ç«¯æ‰€æœ‰ç›¸å…³äº’åŠ¨æŒ‰é’®éƒ½éšå»ï¼‰ï®çŠ¶æ€å¤„ç†ïµå¤æ´»åæ— æ•Œï¼Œåˆæ¬¡ä¼ å…¥æ—¶æ— æ•Œï¼Œæ— æ•Œæ—¶é—´æ— é™é•¿ï¼Œè·¨åœºæ™¯åˆ é™¤ï¼Œïµé£è¡Œå¯»è·¯å®Œæ¯•åï¼Œåˆ é™¤æ— æ•Œ3.æˆ˜æ–—åœºæ™¯A.ä¸­é—´çš„å¤§åœ†å½¢åŒºåŸŸä¸ºbossåœºæ™¯B.æˆ˜æ–—åªèƒ½å‘ç”Ÿåœ¨è¿™é‡Œï®è§„åˆ™1.åœºæ™¯å†…ç©å®¶å…³ç³»A.å¯ä»¥è‡ªç”±ç»„é˜Ÿå’Œé€€é˜ŸB.é»˜è®¤pkæ¨¡å¼ä¸ºå–„æ¶C.å¯ä»¥å¼€å„ç§æ€æˆ®æ¨¡å¼pk2.ç‰¹æ®Šç©æ³•ï¼ˆäºŒæœŸåˆ¶ä½œï¼Ÿï¼Ÿï¼‰A.é˜¶æ®µæ€§å‡ºç°ç‰¹æ®Šç©æ³•B.ç‰¹æ®Šç©æ³•1ï¼šPKé¼“åŠ±å‘ï¼Œbossè¡€é‡åˆ°æŸä¸ªé˜¶æ®µåå¼€å¯ï¼Œè¯¥é˜¶æ®µä¸€æ—¦å‡»æ€äº†å…¶ä»–ç©å®¶ï¼Œæ¯æ€ä¸€ä¸ªç©å®¶è·å¾—ä¸€å±‚çŠ¶æ€ï¼Œæå‡æ”»å‡»10%3.æˆ˜æ–—é™æ—¶A.3-4åˆ†é’Ÿçš„æ—¶é—´ä¸ºå®œï¼ˆç­–åˆ’å¡«è¡¨ï¼‰B.æ—¶é—´é•¿äº†ç–²æƒ«C.æ—¶é—´çŸ­äº†æ‹‰ä¸å¼€å·®è·ï®Bossæˆ˜æ–—å±æ€§1.æ¯ä¸€ä¸ªbosséƒ½æœ‰å…¶å›ºå®šçš„å±æ€§ã€‚2.å¯¹åº”è¯¥bossåˆ·å‡ºæ¥çš„é˜µçœ¼çš„å±æ€§ä¹Ÿå›ºè®¢ã€‚ä¹Ÿå°±æ˜¯ä¸€ä¸ªbosså¯¹åº”ä¸€ä¸ªé˜µçœ¼ï¼Œbossçš„é˜µçœ¼çš„å±æ€§éƒ½æ˜¯å›ºå®šä¸å˜çš„ã€‚æ¯”å¦‚ï¼šå§¥å§¥çš„å±æ€§å°±æ˜¯npcgrowupé‡Œçš„1101ï¼Œå¯¹åº”çš„é˜µçœ¼cha_list idä¸º11001ï¼Œå±æ€§ä¹Ÿå¯¹åº”ä¸º1102.3.Bossçš„ç­‰çº§ç”±ç©å®¶å†³å®šA.Bossçš„ç­‰çº§å–å†³ç”±æœ‰èµ„æ ¼ä¼ é€è¿›å…¥bossæˆ˜çš„ç©å®¶ä¸­ç­‰çº§æœ€é«˜çš„ç©å®¶ï¼Œbossçš„ç­‰çº§ç­‰äºè¯¥ç©å®¶çš„ç­‰çº§B.ç©å®¶ä¼ é€è¿›å…¥bossåœºæ™¯åï¼Œbossåœºæ™¯æ‰åˆ·å‡ºboss4.Bossæœ€åˆçš„1çº§å±æ€§ç¡®å®šï¼Œä¹‹åçš„æ¯çº§å±æ€§æœ‰npcâ€”â€”growupå†³å®šï¼ˆå¦‚æœbosså±æ€§æ®æ­¤æ§åˆ¶ä¸åŠ›ï¼Œåˆ™å¯ä»¥ä½¿ç”¨åˆ†æ®µæ§åˆ¶æ³•ï¼Œæ¯ä¸ªå…³é”®ç­‰çº§ç‚¹å•ç‹¬å–ä¸€æ¡å±æ€§ï¼Œè¯¥å±æ€§åŒ…æ‹¬äº†bossçš„åŸºç¡€å±æ€§å’Œæˆé•¿å±æ€§ï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªç­‰çº§å…³é”®ç‚¹ä¹‹å‰çš„æ‰€æœ‰ç­‰çº§éƒ½ä½¿ç”¨è¯¥å±æ€§ï¼Œåˆ°è¾¾ä¸‹ä¸ªå…³é”®ç‚¹åï¼Œå–æ–°çš„å…³é”®ç‚¹çš„æˆ˜æ–—å±æ€§åŒ¹é…ç»™bossï¼ˆæ¯”å¦‚30-39ä½¿ç”¨npcæˆé•¿è¡¨å±æ€§ID1000,40-45ä½¿ç”¨1001,45-50ä½¿ç”¨1002ï¼‰5.æ³¨æ„ï¼šé˜µçœ¼çš„ç­‰çº§ç­‰äºå¼€å¯ä¼é­”é˜µé˜Ÿä¼é‡Œç­‰çº§æœ€é«˜çš„ç©å®¶çš„ç­‰çº§ï¼Œå…¶å±æ€§ç”±å…¶ç­‰çº§åŒ¹é…åˆ°ç›¸åº”çš„è¡¨å¾—åˆ°ï¼‰ï¬å¥–åŠ±ç›¸å…³ï®é¦–å…ˆéœ€è¦ä¼¤å®³ç»Ÿè®¡ïµBossæˆ˜çš„æ—¶å€™ï¼Œç±»ä¼¼é˜µçœ¼å‡»ç ´ï¼Œå¯¹æ‰€æœ‰å¯¹bossé€ æˆçš„ä¼¤å®³è¿›è¡Œè®°å½•å’Œç»Ÿè®¡ïµä¼¤å®³ç»Ÿè®¡æ è¿˜æ˜¯å‡ºç°åœ¨ä»»åŠ¡æ ï¼Œéšå»ä»»åŠ¡æ ïµè¿˜æ˜¯åªä»¥é˜Ÿä¼ä¸ºå•ä½è¿›è¡Œæ’è¡Œå’Œç»Ÿè®¡ï®å‚ä¸å°±æœ‰å¥–åŠ±ïµåªè¦è¿›å…¥æˆ˜æ–—çŠ¶æ€ï¼Œæ¯ç§’è·å¾—ä¸€å®šç»éªŒï¼ˆç­–åˆ’å¡«è¡¨ï¼‰ï¼Œæ ¹æ®ç©å®¶ç­‰çº§è·å¾—ç»éªŒïµåªè¦å¯¹bossé€ æˆä¼¤å®³ï¼Œå°±èƒ½è·å¾—é‡‘é’±å¥–åŠ±ï¬æ¯ä¸ªbosså¯¹åº”ä¸åŒç­‰çº§éƒ½æœ‰ä¸€ä¸ªæ€»é‡‘é’±æ‰è½ä¹¦ï¬æ¯æ¬¡é€ æˆçš„ä¼¤å®³å¯¹åº”bossæ€»è¡€é‡çš„å¿…çƒˆå†³å®šå•æ¬¡è·å¾—åŸºç¡€é‡‘é’±æ•°1.Bossç­‰çº§è¶Šé«˜ï¼Œæ€»é‡‘é’±æ•°è¶Šå¤š2.ç©å®¶ä¼¤å®³è¶Šé«˜ï¼Œå•æ¬¡è·å¾—é‡‘é’±è¶Šå¤š3.å¯èƒ½ä¼šä¸€ç§’åˆ¤å®šå¾ˆå¤šæ¬¡ï¼Œè·å¾—é‡‘é’±çš„é—´éš”å°±è®¾å®šä¸ºä¸€ç§’ï¬å¦‚æœæœ‰ç©å®¶å®Œæˆäº†æœ€ç»ˆä¸€å‡»çš„å‡»æ€ï¼Œåˆ™é¢å¤–å¥–åŠ±è¯¥ç©å®¶3%bossæ‰è½é‡‘é’±çš„å¥–åŠ±ï¬ä¸åŒçš„èŒä¸šåœ¨åŸºç¡€é‡‘é’±æ•°ä¸Šè¿˜æœ‰ä¸ªç³»æ•°åŠ æˆï¼ˆç³»æ•°ç­–åˆ’å¡«è¡¨ï¼‰ï¼Œç”¨æ¥å¹³è¡¡ä¸åŒèŒä¸šå®šä½ä¸‹ï¼ŒèŒä¸šä¹‹é—´çš„ä¼¤å®³æœ‰å·®è·çš„é—®é¢˜ï¬æ¯ä¸ªç©å®¶é€ æˆçš„ä¼¤å®³éƒ½è®°å½•ä¸‹æ¥ï¼Œåˆ°æœ€åbossæˆ˜ç»“æŸçš„æ—¶å€™ç»Ÿä¸€ç»“ç®—ï¼Œé€šè¿‡é‚®ä»¶å‘æ”¾ï®é¢å¤–çš„æ’åå¥–åŠ±ïµä»¥é˜Ÿä¼ä¼¤å®³æ’åä¸ºæ ‡æ†ïµé€‰æ‹©ä¼¤å®³æœ€é«˜çš„é˜Ÿä¼å‘å¥–ïµå‘å¥–ä»¥é“å…·ä¸ºåŸºç¡€å½¢å¼ï¼Œé€šè¿‡é‚®ä»¶å‘é€ã€‚ï¬å¦‚ä½•é€€å‡ºï®å‰¯æœ¬æˆ˜æ–—æ—¶é—´å€’è®¡æ—¶ç»“æŸåè¿›è¡Œç»“ç®—ã€‚å› æ­¤å±å¹•ä¸­å¤®ä¸Šæ–¹ä½ç½®æœ‰æœ¬æ¬¡æŒ‘æˆ˜çš„é™æ—¶å€’è®¡æ—¶æ˜¾ç¤ºï¼Œå€’è®¡æ—¶æ˜¯ä»bossåˆ·å‡ºå¼€å§‹è®¡æ—¶ã€‚ï®ç»“ç®—æ—¶å¼¹å‡ºç»“ç®—ç•Œé¢ï¼ˆç»“ç®—ç•Œé¢è§ç•Œé¢è®¾è®¡ï¼‰ïµç•Œé¢ä¸Šè¡¨æ˜è°çš„é˜Ÿä¼è·å¾—äº†é¢å¤–å¥–åŠ±ï¼Œå¹¶æ˜¾ç¤ºå¥–åŠ±ç¤¼åŒ…ï¼Œç‚¹å‡»ç¤¼åŒ…å¯ä»¥çœ‹åˆ°tipsïµæ˜¾ç¤ºè‡ªå·±è·å¾—çš„é‡‘é’±å’Œç»éªŒå¥–åŠ±ïµç‚¹å‡»ç¡®å®šç¦»å¼€bossåœºæ™¯ï¼Œè¯¥ç•Œé¢ä»…ä»…æœ‰ç¡®å®šæŒ‰é’®ï®Bossæˆ˜ç»“æŸåï¼Œä¼šç”¨è·‘é©¬ç¯å®£å¸ƒã€xxxï¼ˆé˜Ÿé•¿ï¼‰å’Œä»–çš„é˜Ÿå‹å‡»è´¥äº†xxbossï¼Œè·å–äº†ä¸°åšçš„å›æŠ¥ã€‘ï¬æ‰çº¿é—®é¢˜çš„å¤„ç†ï®å¤§ä¸–ç•Œæ‰çº¿ïµé˜µçœ¼å‡»ç ´å‰å°±é‡æ–°ä¸Šçº¿äº†1.é˜Ÿä¼è¿˜å­˜åœ¨ï¼Œæ— éœ€ç‰¹æ®Šå¤„ç†ï¼Œå› ä¸ºè®°å½•çš„æ˜¯é˜Ÿä¼ä¼¤å®³å’Œé˜Ÿä¼ä¿¡æ¯2.å…¨é˜Ÿéƒ½æ‰çº¿ï¼Œé˜Ÿä¼åªè¦ä¸åˆ é™¤ï¼Œè¿˜è®°å½•æœ‰é˜Ÿä¼ä¿¡æ¯å³å¯ïµé˜µçœ¼å¼€å¯åæ‰é‡æ–°ä¸Šçº¿1.å‚è€ƒã€å¦‚ä½•è¿›å…¥ç¦é˜µã€‘é‡Œçš„ã€ç‰¹åˆ«æ³¨æ„ã€‘ç¬¬äºŒæ¡ ï¼šé“¾æ¥åœ¨æ­¤ï®BossæŒ‘æˆ˜æ—¶æ‰çº¿ïµæˆ˜æ–—ç»“æŸå‰å°±é‡æ–°ä¸Šçº¿1.å•äººæ‰çº¿ï¼Œé˜Ÿä¼è¿˜åœ¨å°±å‡ºç°åœ¨æ‰çº¿å‰ä½ç½®ï¼Œä¼¤å®³å’Œé˜Ÿä¼ä¿¡æ¯ç»§æ‰¿2.é˜Ÿä¼è§£æ•£ï¼Œä¸Šçº¿è¿˜æ˜¯å‡ºç°åœ¨æ‰çº¿å‰ä½ç½®ï¼Œä½†ä¼¤å®³ä¿¡æ¯æ¸…é›¶3.å…¨é˜Ÿæ‰çº¿ï¼Œä¿ç•™ä¼¤å®³ç»Ÿè®¡å’Œé˜Ÿä¼ä¿¡æ¯ï¼Œç­‰ä¸Šçº¿åç»§ç»­ïµæˆ˜æ–—ç»“æŸåæ‰ä¸Šçº¿1.ç»“æŸå‰æ²¡æœ‰æ•£é˜Ÿï¼Œå¥–åŠ±ç…§å‘ï¼Œä»é‚®ä»¶è·å¾—2.æ•£é˜Ÿäº†ï¼Œæ²¡æœ‰å¥–åŠ± é«˜é˜¶bossï¬ç©çš„æ˜¯ä»€ä¹ˆï®å…¬ä¼šé—´çš„ç«äº‰ï¼ŒåŒæ—¶å°é˜Ÿä¸ºåŸºç¡€çš„ç«äº‰å•å…ƒïµé˜µçœ¼ä¼šå¼€å¯å¤šæ¬¡ï¼Œä¸€ä¸ªå…¬ä¼šæ€ä¹ˆä¿è¯è‡ªå·±çš„äººå°½å¯èƒ½å¤šçš„åœ¨å‰ä¸¤è½®è¿›å…¥ï¼Œæ˜¯å¾ˆé‡è¦çš„ç«äº‰å’Œåšå¼ˆïµBossæˆ˜æ—¶å€™çš„ç«äº‰å’Œåšå¼ˆï¼Œä¸»è¦ä½“ç°åœ¨pveä¼¤å®³çš„ç«äº‰ï¼Œä»¥åŠå¤šä¸ªå…¬ä¼šé—´å› ä¸ºPKç­–ç•¥çš„é€‰æ‹©å±•å¼€çš„åšå¼ˆï®Pkè§„åˆ™ïµå¤§ä¸–ç•Œä¸Šé»˜è®¤ç»„é˜Ÿå‰çš„pkæ¨¡å¼ï¼Œpkè‡ªç”±äº¤ç»™ç©å®¶ï¼Œç©å®¶å¯ä»¥æ‰‹æ®µé€‰æ‹©å¼€å¯ã€‚åŸºæœ¬ä»¥å…¬ä¼šæ€æˆ®ä¸ºä¸»ï¼Œä¸æ’æ–¥å…¶ä»–pvpæ¨¡å¼ïµBossåœºæ™¯çš„pkå†³å®šæƒåŒä¸Šï¼Œäº¤ç»™ç©å®¶ï¬æ€ä¹ˆå¼€å¯ï®ç³»ç»Ÿä¸ŠæŒ‡å®šæ—¶é—´ç‚¹ä¸Šè‡ªåŠ¨æ‰“å¼€åœ°å›¾ä¸Šçš„å¤§ä¼é­”é˜µé˜µçœ¼ï¼Œéœ€è¦æ‰“ç ´é˜µçœ¼ï¼Œè¯¥é˜µçœ¼æ‰ä¼šæŒ‘é€‰å‚ä¸è¿‡å‡»ç ´è‡ªå·±çš„ç©å®¶ï¼Œç¬¦åˆè§„åˆ™è¢«é€‰ä¸­çš„äººæ‰èƒ½è¢«ä¼ é€åˆ°ä¸–ç•Œbossèº«è¾¹ï®è§„å®šæ—¶é—´å¼€å¯ïµæ¯å¤©éƒ½ä¼šå¼€å¯ïµæ¯å¤©å¼€å¯2æ¬¡ï¼Œåˆ†åˆ«æ˜¯ä¸­åˆ12:00-12:30,æ™šä¸Š20:00-20:30ïµå¼€å¯æ—¶é—´å†…å’Œå¼€å¯å‰10åˆ†é’Ÿå†…ï¼Œæ‰€æœ‰ä¼é­”é˜µæ— æ³•ä½¿ç”¨å¬å”¤ç¬¦å¬å”¤å°ä¸–ç•Œbossï¼Œï¼ˆè¡¨ç°ä¸ºè¿™æ®µæ—¶é—´å†…ï¼Œä¼é­”é˜µçš„ç¬¦å’’çº¹ç†æ˜¾ç¤ºä¸ºçº¢è‰²ï¼Œè¡¨æ˜å¤§ä¼é­”é˜µæ¿€æ´»ï¼Œå°ä¼é­”é˜µæ— æ³•å¼€å¯â€”-å°ä¼é­”é˜µçš„çº¹ç†é‡‡ç”¨è“è‰²æˆ–è€…å…¶ä»–åšåŒºåˆ«ï¼‰ïµå¼€å¯æ—¶é—´ç­–åˆ’å¡«è¡¨å†³å®šï¼ŒåŸåˆ™å°±æ˜¯å’Œå…¶ä»–æ´»åŠ¨ä¸å†²çªï¼Œå¹¶å®‰æ’åœ¨å¤§éƒ¨åˆ†ç©å®¶æœ‰é—²çš„æ—¶é—´æ®µã€‚ï®æŒ‡å®šåœ°ç‚¹å¼€å¯ïµå¼€å¯åœ°ç‚¹1.åªèƒ½åœ¨æŒ‡å®šåœ°ç‚¹ç”Ÿæˆé˜µçœ¼2.æŒ‡å®šç‚¹è§„åˆ™A.è¦ç´ 1ï¼šä¸åŒbosså¯¹åº”çš„åœºæ™¯ç»„ä¸ä¸€æ ·ï‚²ä¾‹å¦‚åœºæ™¯IDæœ‰1åˆ°10ï‚²1å·bosså¯¹åº”ï¼š135ï‚²2å·bosså¯¹åº”ï¼š246ï‚²å¦‚æœæ˜¯æ‰“1å·bossï¼Œåˆ™åªä¼šåœ¨1 3 5åœºæ™¯åˆ·å‡ºé˜µçœ¼B.è¦ç´ 2ï¼šä¸€ä¸ªåœºæ™¯åŒ…å«äº†5ä¸ªé˜µçœ¼ï‚²å¦‚æœè¯¥åœºæ™¯å¯ä»¥å¬å”¤å°bossï¼Œè¯¥åœºæ™¯çš„å¤§å°bossé˜µçœ¼ç‚¹ç›¸åŒï‚²ä¸–ç•Œbosså®šæ—¶æ´»åŠ¨å¼€å¯åï¼Œä¸€å®šæ˜¯5ä¸ªé˜µçœ¼ä¸€èµ·æ‰“å¼€C.è¦ç´ 3ï¼šå…è®¸ä¸€ä¸ªåœºæ™¯å¤šæ¡çº¿ï¼šå¦‚æœä¸€ä¸ªåœºæ™¯å¼€äº†å¤šæ¡çº¿ï¼Œåˆ™æ¯æ¡çº¿çš„æŒ‡å®šç‚¹éƒ½ä¼šç”Ÿæˆé˜µçœ¼D.è¦ç´ 4ï¼šPVEå’ŒPVPåœºæ™¯éƒ½ä¼šæœ‰æŒ‡å®šç‚¹ï‚²PVEåœºæ™¯é€‰æ‹©ç­‰çº§ç•¥é«˜çš„åœ°æ–¹ï‚²Pvpçš„åœºæ™¯ä¹Ÿå°½é‡é€‰æ‹©ç­‰çº§æ¯”è¾ƒé«˜çš„åœ°æ–¹ï¼Œä½†è€ƒè™‘ç©å®¶å‚ä¸æƒ…å†µï¼Œå¯ä»¥é€‰æ‹©ä¸ªåˆ«å¯¹åº”ç­‰çº§æ¯”è¾ƒä½çš„åœºæ™¯ã€‚ïµé˜µçœ¼å¼€å¯é€šçŸ¥1.é˜µçœ¼å¼€å¯å‰5åˆ†é’Ÿï¼Œæ¯20ç§’è·‘é©¬ç¯æé†’ä¸€æ¬¡å…¨æœç©å®¶2.é˜µçœ¼å¼€å¯åï¼Œè·‘é©¬ç¯é€šçŸ¥å…¨æœï¼ˆå®Œå…¨å’Œå°bossç›¸åŒï¼‰A.ç‚¹å‡»è·‘é©¬ç¯å’Œä¸–ç•ŒèŠå¤©çš„é“¾æ¥ï¼Œè‡ªåŠ¨å¯»è·¯èµ°åˆ°é˜µçœ¼æ‰€åœ¨çš„åœºæ™¯B.ã€‚ã€‚ã€‚ï¬æ€ä¹ˆè¿›å…¥ï®æ¯æ¬¡é˜µçœ¼è¢«å‡»ç ´ï¼Œéƒ½ä¼šä¼ é€ä¸€å®šæ•°é‡çš„ç©å®¶è¿›å…¥bossåœºæ™¯ï®æ¯ä¸ªé˜µçœ¼å¯ä»¥è¢«å‡»ç ´3æ¬¡ï¼Œéšç€è¢«å‡»ç ´çš„æ¬¡æ•°å¢åŠ ï¼Œé˜µçœ¼æ‰©å¤§ï¼Œä¸‹ä¸€æ¬¡å¯ä»¥è¢«ä¼ é€çš„ç©å®¶æ•°é‡éšä¹‹å¢åŠ ï®æŒ‘é€‰è¿›å…¥bossåœºæ™¯çš„è§„åˆ™ïµé˜µçœ¼æ¯æ¬¡è¢«å‡»ç¢åï¼ŒæŒ‘é€‰ç©å®¶è¿›å…¥bossç¦é˜µïµé˜µçœ¼å¯ä»¥è¢«å‡»ç¢ä¸‰æ¬¡ï¼Œä¸‰æ¬¡åï¼Œé˜µçœ¼ä¸å†ç”Ÿæˆïµé˜µçœ¼æœ‰å­˜æ´»æ—¶é—´ï¼Œè¯¥æ—¶é—´ç­–åˆ’å¡«è¡¨å†³å®šï¼Œæ—¶é—´ä¸€åˆ°ï¼Œè¯¥é˜µçœ¼å¦‚æœè¿˜æœªè¢«å‡»ç ´ï¼Œé˜µçœ¼æ¶ˆå¤±ï¼Œæœ¬æ¬¡ä¸ä¼ é€ïµæ”»å‡»é˜µçœ¼çš„è¿‡ç¨‹ä¸­ï¼Œä¼šç»Ÿè®¡ä¼¤å®³å¹¶æ’è¡Œï¼Œå¹¶æ˜¾ç¤ºåœ¨å®¢æˆ·ç«¯1.è¯¥æ’è¡Œæ¦œæœ€å¤šå‡ºç°3è¡Œ2.å®Œå…¨ç±»ä¼¼å°bossçš„å¤§ä¸–ç•Œä¼¤å®³ç»Ÿè®¡ï¼ˆç•¥è¿‡ä¸è¡¨ï¼‰ïµç¬¬ä¸€æ¬¡ä¼ é€1.ç²¾è‹±ä¼ é€ï¼šåªä¼ æœ€å‰å®³çš„ä¸€ç»„äººè¿›å…¥A.å½“é˜µçœ¼è¢«å‡»ç ´æ—¶ï¼Œæ‰å¼€å§‹æŒ‘äººB.ç¡®å®šä¼¤å®³æœ€é«˜çš„é˜Ÿä¼C.ç¡®å®šå½“å‰è¿™ä¸ªé˜Ÿä¼çš„ç©å®¶ï¼Œè®°å½•D.æŠŠè¿™äº›ç©å®¶ä¼ å…¥bosså‰¯æœ¬E.å¦‚æœæœ‰æ‰çº¿ï¼Œä¸åœ¨é˜µçœ¼åŒä¸€åœºæ™¯ï¼Œå‚è€ƒç‰¹æ®Šå¤„ç†2.ä¼ é€å®Œæ¯•åï¼Œæœ‰ä¸ªé˜µçœ¼é‡æ–°æ‰“å¼€è¿‡ç¨‹ï¼Œè¯¥è¿‡ç¨‹æŒç»­æ—¶é—´ç­–åˆ’å¡«è¡¨å†³å®šï¼ˆæ”¹å¥½ç­‰äºbossåœºæ™¯ä¸­å¤æ´»ç‚¹åˆ°æˆ˜æ–—åœºæ™¯æ—¶é—´æˆ–æ›´å¤§ï¼‰3.å±å¹•æç¤ºï¼šé˜µçœ¼è¢«å‡»ç¢åï¼Œæ˜¾ç¤ºã€é˜µçœ¼å—åˆ°æ”»å‡»ï¼Œç¦åˆ¶æ¾åŠ¨ï¼Œä¸‹ä¸€æ¬¡é˜µçœ¼ä¼šç¨åæ‰“å¼€ã€‘ïµç¬¬äºŒæ¬¡ä¼ é€1.é«˜çº§ä¼ é€ï¼šä¼ é€æœ€å‰å®³çš„1ç»„äººè¿›å…¥A.ç±»ä¼¼ç¬¬ä¸€æ¬¡ä¼ é€B.è¿™æ¬¡ä»ç„¶åªä¼ é€1é˜Ÿäºº2.ä¼ é€å®Œæ¯•åï¼Œç±»ä¼¼ç¬¬ä¸€æ¬¡ä¼ é€ï¼Œä»ç„¶æœ‰ä¸ªé˜µçœ¼é‡æ–°æ‰“å¼€è¿‡ç¨‹è¯¥è¿‡ç¨‹æŒç»­æ—¶é—´ç­–åˆ’å¡«è¡¨å†³å®šï¼ˆæ”¹å¥½ç­‰äºbossåœºæ™¯ä¸­å¤æ´»ç‚¹åˆ°æˆ˜æ–—åœºæ™¯æ—¶é—´æˆ–æ›´å¤§ï¼‰3.å±å¹•æç¤ºï¼šé˜µçœ¼è¢«å‡»ç¢åï¼Œæ˜¾ç¤ºã€é˜µçœ¼å—åˆ°çŒ›çƒˆæ”»å‡»ï¼Œç¦åˆ¶å—æŸä¸¥é‡ï¼Œç¨åå°†ä¼šæ‰“å¼€æœ€åä¸€æ¬¡é˜µçœ¼ã€‘ïµç¬¬ä¸‰æ¬¡ä¼ é€1.æ™®ä¸–ä¼ é€ï¼šä»ç„¶åªä¼ é€ä¸€é˜ŸäººA.å½“é˜µçœ¼è¢«å‡»ç¢ï¼Œæ‰€æœ‰å‚ä¸çš„æœ‰ä¼¤å®³çš„äººéƒ½è¢«ä¼ å…¥B.é˜µçœ¼æœ‰ä¸ªå­˜æ´»æ—¶é—´ï¼Œæ—¶é—´åˆ°è¿˜æ²¡è¢«å‡»ç ´ï¼Œä¼é­”é˜µå…³é—­ï¼Œç¬¦æ–‡ç†„ç­ï¼Œé˜µçœ¼æ¶ˆå¤±ï¼Œæœ¨æœ‰ä¼ é€é—¨2.è¯¥æ¬¡ä¼ é€åï¼Œé˜µçœ¼ä¸å†ç”Ÿæˆï¼Œä½†ä¼š æœ‰ä¼ é€é—¨å­˜åœ¨2åˆ†é’Ÿï®åˆæ­¥è®¡ç®—å’Œé¢„ä¼°ïµä¸€ä¸ªbosså¯¹åº”3ä¸ªåœºæ™¯ïµæ¯ä¸ªåœºæ™¯2æ¡çº¿ïµä¸€ä¸ªåœºæ™¯5é˜µçœ¼ïµæ¯ä¸ªç€çœ¼å‰ä¸¤è½®ä¼ 2åªé˜Ÿïµæ¯é˜Ÿ6ä¸ªç©å®¶ïµç¬¬ä¸€è½®æœ€å¤š30ä¸ªé˜µçœ¼ï¼Œå¯ä¼ 180ä¸ªç©å®¶ï¼Œå®é™…æ™®éæƒ…å†µå¯èƒ½æœ€å¤š15ä¸ªé˜µçœ¼ä¼ å…¥90ä¸ªç©å®¶ï¼ˆå‚è€ƒå¦ä¸ªæƒ…å†µï¼šä¸€ä¸ªå¤§å…¬ä¼š100äººæ»¡å‘˜ï¼‰ïµç¬¬äºŒè½®ç¬¬ä¸‰è½®åŒç†ïµä¸€å…±540ï¼Œå…¶å®æœ€å¤§ä¼°è®¡270ã€‚ï¬Bossæˆ˜ç©æ³•ï®Bossæˆ˜åœºæ™¯ïµåœºæ™¯å†…å®¹å®Œå…¨ç»§æ‰¿å°bossïµå‡ºç”Ÿç‚¹å’Œå¤æ´»ç‚¹å‡ ä¹ç­‰åŒäºå°bossï¼Œä¸åŒç‚¹åœ¨äºï¼šå‡ºç”Ÿç‚¹å’Œå¤æ´»ç‚¹éšæœºåœ¨é¢„è®¾çš„3ä¸ªç‚¹ï¼Œ3ä¸ªç‚¹åˆšå¥½å¹³å‡åˆ†åœ¨3ä¸ªå°é˜æ¥¼ä¸Šã€‚ïµæˆ˜æ–—åœºæ™¯å°±æ˜¯ä¸­é—´çš„å¤§åœ†åœˆï®Bossæˆ˜è§„åˆ™ïµåœºæ™¯å†…å¯ä»¥è‡ªç”±ç»„é˜Ÿå’Œé€€é˜Ÿïµé»˜è®¤pkæ¨¡å¼ä¸ºå–„æ¶ï¼Œæ˜¯å¦å¼€çº¢ï¼Œè‡ªä¸»æƒç»™ç©å®¶ïµé˜¶æ®µæ€§ç©æ³•ï¼ˆäºŒæœŸï¼‰1.ä¾‹å¦‚å°bossä¹Ÿæœ‰çš„é˜¶æ®µæ€§å¼ºåŒ–pkç©æ³•ïµæˆ˜æ–—é™æ—¶1.ç­–åˆ’å¡«è¡¨å†³å®šé™æ—¶ã€‚15-20åˆ†é’Ÿé€‚å®œ2.æ—¶é—´å¤ªé•¿ç–²æƒ«3.æ—¶é—´çŸ­äº†æ‹‰ä¸å¼€ä¼¤å®³å·®è·4.å¦‚æœéœ€è¦è¿›ä¸€æ­¥å¼ºåŒ–bossæˆ˜çš„äº¤äº’å’Œäº’åŠ¨ï¼Œé‚£å¯ä»¥é€‚å½“å¢åŠ å†™æ—¶é—´ï¼Œåæ­£ç”±ç­–åˆ’æ‰‹åŠ¨å¡«è¡¨æ§åˆ¶ï®Bossçš„æˆ˜æ–—å±æ€§ïµBossçš„å±æ€§æ˜¯å¯ä»¥å‡çº§å’Œé™çº§çš„ïµä¸–ç•Œbossçš„ç­‰çº§æ˜¯å›ºå®šçš„æœåŠ¡å™¨ç©å®¶å°é¡¶ç­‰çº§ï¼ˆç­–åˆ’å¡«è¡¨ï¼‰ïµæ¯ä¸€çº§çš„å±æ€§ä»è¡¨é‡ŒåŒ¹é…ï¼ŒåŒ¹é…æ–¹å¼ç±»ä¼¼å°bossïµBosså¦‚æœå½“æ¬¡è¢«å‡»æ€ï¼Œåˆ™bossä¼šè‡ªåŠ¨å‡ä¸€çº§ï¼Œé‚£ä¹ˆbossçš„å±æ€§ä¹Ÿä¼šå‡çº§ïµå¦‚æœå½“æ¬¡æ²¡æœ‰è¢«å‡»æ€ï¼Œåˆ™bossä¼šè‡ªåŠ¨é™ä¸€çº§ï¼Œé‚£ä¹ˆbossçš„å±æ€§ä¹Ÿä¼šé™ä½ïµåŠ¨æ€çš„è°ƒæ•´bossç­‰çº§ï¼Œç­‰äºåŠ¨æ€çš„è°ƒæ•´äº†bossçš„å±æ€§ï¼Œä¿è¯äº†bossçš„å±æ€§æ€»æ˜¯è¶‹å‘äºè´´åˆæœ¬æœåŠ¡å™¨ç©å®¶çš„å½“å‰æˆ˜æ–—åŠ›æ°´å¹³é¢„æœŸçš„ïµå¦å¤–æ³¨æ„ï¼šé˜µçœ¼çš„ç­‰çº§ç­‰äºbossçš„ç­‰çº§ï¼Œå…¶å±æ€§ä¹Ÿæ˜¯åŠ¨æ€å‡çº§å’Œé™çº§çš„ï¼ˆä¹Ÿç”±ç­–åˆ’å¡«è¡¨æ§åˆ¶ï¼‰ï¬å¥–åŠ±å‘æ”¾ï®é¦–å…ˆéœ€è¦ä¼¤å®³ç»Ÿè®¡ä¸ºä¾æ®ïµBossæˆ˜çš„æ—¶å€™ï¼Œç±»ä¼¼é˜µçœ¼ï¼Œä¼šå¯¹æ‰€æœ‰é€ æˆçš„ä¼¤å®³è®°æ€§è®°å½•å’Œç»Ÿè®¡ïµé˜Ÿä¼ä¼¤å®³ç»Ÿè®¡1.éšå»ä»»åŠ¡æ ï¼Œåœ¨è¯¥å¤„å‡ºç°ä¼¤å®³ç»Ÿè®¡2.ä»¥é˜Ÿä¼ä¸ºå•ä½è¿›è¡Œç»Ÿè®¡å’Œæ’è¡Œïµå…¬ä¼šä¼¤å®³ç»Ÿè®¡1.åœ¨é˜Ÿä¼ä¼¤å®³ç»Ÿè®¡ä¸‹æ–¹ï¼Œå®¢æˆ·å•æ˜¾ç¤ºå…¬ä¼šä¼¤å®³ç»Ÿè®¡2.ä»¥å…¬ä¼šä¸ºå•ä½è¿›è¡Œæ’è¡Œå’Œç»Ÿè®¡3.æ ·å¼å®Œå…¨ç±»ä¼¼é˜Ÿä¼çš„4.è¯¥ä¼¤å®³ç»Ÿè®¡å’Œæ’è¡Œåªèƒ½å‡ºç°åœ¨bossæˆ˜é˜¶æ®µï®å‚ä¸å°±å‘å¥–åŠ±ïµåªè¦è¿›å…¥æˆ˜æ–—çŠ¶æ€ï¼Œæ¯ç§’è·å¾—ä¸€å®šç»éªŒï¼ˆç­–åˆ’å¡«è¡¨ï¼‰ï¼Œæ ¹æ®ç©å®¶ç­‰çº§è·å¾—ç»éªŒïµåªè¦å¯¹bossé€ æˆä¼¤å®³ï¼Œå°±èƒ½è·å¾—é‡‘é’±å¥–åŠ±1.æ¯ä¸ªbosså¯¹åº”ä¸åŒç­‰çº§éƒ½æœ‰ä¸€ä¸ªæ€»é‡‘é’±æ‰è½ä¹¦2.æ¯æ¬¡é€ æˆçš„ä¼¤å®³å¯¹åº”bossæ€»è¡€é‡çš„å¿…çƒˆå†³å®šå•æ¬¡è·å¾—åŸºç¡€é‡‘é’±æ•°A.Bossç­‰çº§è¶Šé«˜ï¼Œæ€»é‡‘é’±æ•°è¶Šå¤šB.ç©å®¶ä¼¤å®³è¶Šé«˜ï¼Œå•æ¬¡è·å¾—é‡‘é’±è¶Šå¤šC.å¯èƒ½ä¼šä¸€ç§’åˆ¤å®šå¾ˆå¤šæ¬¡ï¼Œè·å¾—é‡‘é’±çš„é—´éš”å°±è®¾å®šä¸ºä¸€ç§’3.ä¸åŒçš„èŒä¸šåœ¨åŸºç¡€é‡‘é’±æ•°ä¸Šè¿˜æœ‰ä¸ªç³»æ•°åŠ æˆï¼ˆç³»æ•°ç­–åˆ’å¡«è¡¨ï¼‰ï¼Œç”¨æ¥å¹³è¡¡ä¸åŒèŒä¸šå®šä½ä¸‹ï¼ŒèŒä¸šä¹‹é—´çš„ä¼¤å®³æœ‰å·®è·çš„é—®é¢˜4.å¦‚æœæœ‰ç©å®¶å®Œæˆäº†æœ€ç»ˆä¸€å‡»çš„å‡»æ€ï¼Œåˆ™é¢å¤–å¥–åŠ±è¯¥ç©å®¶3%bossæ‰è½é‡‘é’±çš„å¥–åŠ±5.æ¯ä¸ªç©å®¶é€ æˆçš„ä¼¤å®³éƒ½å•ç‹¬è®°å½•ï¼Œç›´åˆ°æ´»åŠ¨å®Œæ¯•æ—¶ä¸€å¹¶ç»“ç®—æˆé‡‘é’±ï¼Œå¹¶é€šè¿‡é‚®ä»¶å‘æ”¾ç»™ç©å®¶ï®æ’åçš„é¢å¤–å¥–åŠ±ïµåˆ†ä¸ºé˜Ÿä¼å’Œå…¬ä¼šä¸¤éƒ¨åˆ†å¥–åŠ±ïµé˜Ÿä¼1.ä»¥é˜Ÿä¼ä¼¤å®³ä¸ºæ ‡æ†2.é€‰æ‹©ä¼¤å®³æœ€é«˜çš„é˜Ÿä¼å‘å¥–ïµå…¬ä¼š1.æ’åå‰3åçš„å…¬ä¼šä¼šçš„é¢å¤–å¥–åŠ±ï¼Œå‰å‡ åå¯ä»¥è·å¥–ï¼Œå¥–åŠ±ä»€ä¹ˆéƒ½ç”±ç­–åˆ’å¡«è¡¨æ§åˆ¶2.å‰Nåå¯ä»¥è·å¾—ä¸–ç•Œbosså¦–ä¸¹ï¼Œè¯¥å¦–ä¸¹æ˜¯ä¸ªç›´æ¥å‘æ”¾ç»™å…¬ä¼šä»“åº“çš„é“å…·ï¼ˆNæš‚æ—¶å–5ï¼‰3.å¦–ä¸¹çš„é“å…·åªå†³å®šäº†å¬å”¤å‡ºæ¥çš„bossçš„ç±»å‹4.å¦–ä¸¹çš„ç­‰çº§ç­‰äºæœ¬æ¬¡æ´»åŠ¨çš„ä¸–ç•Œbossçš„ç­‰çº§ï¼Œä¸åŒç­‰çº§çš„å¦–ä¸¹å¬å”¤å‡ºæ¥çš„é—¨æ´¾bossçš„ç­‰çº§ä¹Ÿä¸ç›¸åŒ5.æ’åç¬¬ä¸€åçš„å…¬ä¼šå¾—åˆ°çš„å¦–ä¸¹ç­‰çº§ç­‰äºä¸–ç•Œbossçš„ç­‰çº§ï¼Œè€Œåçš„2-5åå¾—åˆ°çš„å¦–ä¸¹éƒ½ä¼šæœ‰ä¸ªç­‰çº§ä¿®æ­£ï¼ˆç­–åˆ’å¡«è¡¨ï¼‰ï¼Œä»–ä»¬å¾—åˆ°çš„å¦–ä¸¹çš„ç­‰çº§éœ€è¦ç”¨ä¸–ç•Œbossçš„ç­‰çº§å‡å»ä¿®æ­£å€¼å¾—åˆ°ã€‚ï¬æ€ä¹ˆé€€å‡ºï®æˆ˜æ–—è¿‡ç¨‹ä¸­æ— æ³•ä¸»åŠ¨é€€å‡ºï®æ´»åŠ¨å€’è®¡æ—¶ä¸º0æ—¶ï¼Œç»“æŸæˆ˜æ–—ï¼Œå¼€å§‹ç»“ç®—ï®ç»“ç®—æ—¶å¼¹å‡ºç»“ç®—ç•Œé¢ïµè¡¨æ˜é‚£ä¸ªå…¬ä¼šæ‹”å¾—å¤´ç­¹ï¼ˆä¼¤å®³æœ€é«˜çš„å…¬ä¼šï¼‰ïµè¡¨æ˜é‚£åªé˜Ÿä¼è´¡çŒ®æœ€å¤§ïµè¡¨æ˜æœ¬å…¬ä¼šè·å¾—å¥–åŠ±ïµè¡¨æ˜è‡ªå·±é˜Ÿä¼è·å¾—çš„å¥–åŠ±ïµç‚¹å‡»ç¡®å®šç¦»å¼€bossåœºæ™¯ïµBossæˆ˜ç»“æŸåï¼Œä¼šç”¨è·‘é©¬ç¯å®£å¸ƒã€xxxå…¬ä¼šæ˜¯é™ä¼ä¸–ç•Œboss xxxçš„ä¸­æµç ¥æŸ±ï¼Œè·å–äº†ä¸°åšçš„å›æŠ¥ã€‘ ï¬æ‰çº¿å¤„ç†ï®ç±»ä¼¼å°bossç‰¹åˆ«æ³¨æ„ï®å½“é˜µçœ¼ä¼ é€äººä¹‹å‰ï¼Œéœ€è¦åˆ¤æ–­ç©å®¶æ˜¯å¦åœ¨é˜µçœ¼æ‰€åœ¨çš„åœºæ™¯ï¼Œåªæœ‰ç©å®¶å¤„äºé˜µçœ¼æ‰€åœ¨çš„åœºæ™¯ï¼Œæ‰æŠŠç©å®¶ä¼ é€ã€‚ï®é˜µçœ¼å‰ä¸¤æ¬¡è¢«å‡»ç¢åï¼Œä¼šæœ‰1-2åˆ†é’ŸèšåŠ›é‡å¡‘çš„æ—¶é—´ï¼Œï¼ˆæ—¶é—´ç­–åˆ’å¡«è¡¨ï¼‰è¯¥æ—¶é—´å†…æ¯ç§’éƒ½ä¼šæ£€æµ‹æ‹¥æœ‰è¿›å…¥èµ„æ ¼çš„ç©å®¶æ˜¯å¦å‡ºç°åœ¨é˜µçœ¼20ç±³åŒºåŸŸï¼Œå¦‚æœå‡ºç°ï¼Œåˆ™æŠŠç©å®¶ä¼ é€è¿›å…¥bossåœºæ™¯ï¼ˆé¢„é˜²é˜µçœ¼å¼€å¯å‰æ‰çº¿ï¼Œé¢„é˜²é˜µçœ¼å¼€å¯å‰åˆ‡äº†åœºæ™¯ï¼‰ï®å½“ç¬¬ä¸‰æ¬¡é˜µçœ¼å‡»ç¢åï¼Œé˜µçœ¼ä½ç½®ç”Ÿæˆä¸€ä¸ªç¼éš™ï¼Œå­˜åœ¨2åˆ†é’Ÿï¼Œ2åˆ†é’Ÿå†…æœ‰èµ„æ ¼è¿›å…¥çš„ç©å®¶èµ°åˆ°ç¼éš™é™„è¿‘20ç±³ï¼Œè¢«ä¼ å…¥ï®ç©å®¶å¦‚æœæ­»åœ¨é™„è¿‘ï¼Œä¹Ÿå¯ä»¥è¢«ä¼ é€ï¼Œä¼ é€åå¤æ´»]]></content>
  </entry>
  <entry>
    <title><![CDATA[Shell]]></title>
    <url>%2F2017%2F11%2F02%2Fshell%2F</url>
    <content type="text"><![CDATA[${}ç”¨æ¥åšå˜é‡æ›¿æ¢ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ$varä¸${var}å¹¶æ²¡å•¥ä¸ä¸€æ ·ä½†æ˜¯ç”¨${}ä¼šæ¯”è¾ƒç²¾ç¡®çš„ç•Œå®šå˜é‡åç§°çš„èŒƒå›´ï¼Œæ¯”æ–¹è¯´ï¼š$ A=B$ echo $ABg++ -DLINUX -D_FILE_OFFSET_BITS=64 -D_LARGEFILE64_SOURCE -D_LARGEFILE_SOURCE -Wall -Wno-multichar -g -D_DEBUG -DPG_MEMORY_DISABLE_POOL -march=core2 -m32 -rdynamic -std=c++0x -o ../../bin/debug/xxsy/ScnSvr_AllInOne/ScnSvr_AllInOne_d ../../temp/debug/xxsy/ScnSvr_AllInOne/ScnSvr_AllInOne.o_d /root/work_code/src/lib/libGSDB_Lib_d.a /root/work_code/src/lib/libScnSvr_d.a /root/work_code/src/lib/libGZSGamePlay_Lib_d.a /root/work_code/src/lib/libMCE4Chat_d.a /root/work_code/src/lib/libMCE_d.a /root/work_code/src/lib/libDIA4DBI_d.a /root/work_code/src/lib/libDIA_d.a /root/work_code/src/lib/libPNGS_d.a /root/work_code/src/lib/libWHNET_d.a /root/work_code/src/lib/libWHCMN_d.a /root/work_code/src/lib/libxxsy_cmn_d.a /root/work_code/src/lib/libpgcmn_d.a -lpathfind_d -lcJSON_d -lcryptlib_d -llua_d -lzlib_d -ltss_sdk_d /root/work_code/3rd/lib/libqos_client.a -lz -ldl -lssl -lpthread -ldl -lrt -march=prescott -L/root/work_code/3rd/lib -L/root/work_code/src/lib -pthread/usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-redhat-linux/4.8.5/../../../../lib/libm.so when searching for -lm #0 è¿™ä¸ªæ˜¯shellçš„æ‰§è¡Œåå­— #n è¿™ä¸ªæ˜¯shellçš„ç¬¬nä¸ªå‚æ•°å€¼ï¼Œn=1..9 $* è¿™ä¸ªæ˜¯shellçš„æ‰€æœ‰å‚æ•° $# è¡¨ç¤ºå‚æ•°çš„ä¸ªæ•° $$ shellçš„PID $! æ‰§è¡Œä¸Šä¸€ä¸ªçš„PID $? æ‰§è¡Œä¸Šä¸€ä¸ªæŒ‡ä»¤çš„è¿”å›å€¼ï¼ˆæ˜¾ç¤ºæœ€åçš„é€€å‡ºçŠ¶æ€ï¼Œ0è¡¨ç¤ºæ²¡æœ‰é”™è¯¯ï¼Œå…¶å®ƒä»»ä½•å€¼è¡¨æ˜æœ‰é”™è¯¯ï¼‰ $- æ˜¾ç¤ºshellä½¿ç”¨çš„å½“å‰é€‰é¡¹ï¼Œä¸setå‘½ä»¤åŠŸèƒ½ç›¸åŒ $@ è·Ÿ$* ç±»ä¼¼ï¼Œä½†æ˜¯å¯ä»¥å½“ä½œæ•°ç»„ç”¨ -eq ç­‰äº -ne ä¸ç­‰äº -le å°äºç­‰äº -ge å¤§äºç­‰äº -lt å°äº -gt å¤§äº = å°±æ˜¯èµ‹å€¼è¿ç®—:= å°±æ˜¯å½“å†’å·å‰é¢çš„å˜é‡ä¸å­˜åœ¨æˆ–è€…å€¼ä¸ºç©ºæ—¶ï¼Œå°±æŠŠç­‰å·åçš„å€¼èµ‹å€¼ç»™å˜é‡ åˆ é™¤åå¤©å‰çš„æ–‡ä»¶ltfind ./ -mtime +10 -name &quot;*.*&quot; -exec rm -rf {} \; æ–‡ä»¶ä¼ è¾“ï¼ˆWindowså‘Linuxä¼ è¾“ï¼‰å®‰è£…yum install openssh-clients -y ä¼ è¾“æ–‡ä»¶scp -p ./file/yum.log root@192.168.199.150:/tmp/yum.log ä¼ è¾“ç›®å½•scp -rp ./file/ root@192.168.199.150:/tmp/ æŸ¥çœ‹é‚£ä¸ªå…±äº«å†…å­˜è¢«å“ªäº›è¿›ç¨‹ä½¿ç”¨ç€ lsof | grep &quot;shmid&quot; å°†é™æ€åº“æ–‡ä»¶è§£ææˆ.oæ–‡ä»¶ ar -x libexpat.a æŸ¥çœ‹å½’æ¡£æ–‡ä»¶çš„å‡½æ•°å nm -s xmltok.o æŸ¥çœ‹æ±‡ç¼–ä»£ç  objdump -j .text -Sl tbus.o | more]]></content>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ—¥è®°]]></title>
    <url>%2F2017%2F10%2F30%2Fzentia-note1%2F</url>
    <content type="text"><![CDATA[SetUseAuthç”±äºä¸ªäººå–œæ¬¢sublimeä¹Ÿåœ¨ä½¿ç”¨ï¼Œé‡åˆ°ä¸æ”¯æŒANSIç¼–ç ï¼Œç‰¹æ ‡æ³¨ï¼šConvertToUtf8 import urllib.request,os; pf = â€˜Package Control.sublime-packageâ€™; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); open(os.path.join(ipp, pf), â€˜wbâ€™).write(urllib.request.urlopen( â€˜http://sublime.wbond.net/â€˜ + pf.replace(â€˜ â€˜,â€™%20â€™)).read())ä¸Šé¢çš„æ˜¯å®‰è£…package controls grep key1 * | grep key2 å¹¶æ‰€æœ‰æ–‡ä»¶ find ./ -name &quot;*.ext&quot; | xargs -i rm -rf {} # æŸ¥è¯¢æŸä¸ªåç¼€åçš„æ‰€æœ‰æ–‡ä»¶ï¼Œç„¶åç§»é™¤ï¼Œ-iè¡¨ç¤ºå¯¹æ–‡ä»¶æ“ä½œ è§£å†³æ ‘å†²çªï¼š svn resolve --accept working dir https://github.com/Unity-Technologies/UnityCsReference README.mdUnity 2018.1.0b12 C# reference source code The C# part of the Unity engine and editor source code.May be used for reference purposes only. https://github.com/duanjiahao/UnityDecompiled https://github.com/MattRix/UnityDecompiled https://github.com/jameslinden/unity-decompiled IP Username Password Environment 106.12.98.12 root lyf8068353A@ Outter net]]></content>
      <tags>
        <tag>æ—¥è®°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[port-security]]></title>
    <url>%2F2017%2F10%2F30%2Fport-security-1%2F</url>
    <content type="text"></content>
  </entry>
  <entry>
    <title><![CDATA[ç«¯å£æ˜ å°„]]></title>
    <url>%2F2017%2F10%2F30%2Fport-security%2F</url>
    <content type="text"><![CDATA[ç«¯å£å®‰å…¨ï¼ˆPort Securityï¼‰ï¼Œä»åŸºæœ¬åŸç†ä¸Šè®²ï¼ŒPort Securityç‰¹æ€§ä¼šé€šè¿‡MACåœ°å€è¡¨è®°å½•è¿æ¥åˆ°äº¤æ¢æœºç«¯å£çš„ä»¥å¤ªç½‘MACåœ°å€ï¼ˆå³ç½‘å¡å·ï¼‰ï¼Œå¹¶åªå…è®¸æŸä¸ªMACåœ°å€é€šè¿‡æœ¬ç«¯å£é€šä¿¡ã€‚å…¶å®ƒMACåœ°å€å‘é€çš„æ•°æ®åŒ…é€šè¿‡æ­¤ç«¯å£æ˜¯ï¼Œç«¯å£å®‰å…¨ç‰¹æ€§ä¼šç»„ç»‡å®ƒã€‚ä½¿ç”¨ç«¯å£å®‰å…¨ç‰¹æ€§å¯ä»¥é˜²æ­¢æœªç»å…è®¸çš„è®¾å¤‡è®¿é—®ç½‘ç»œï¼Œå¹¶å¢å¼ºå®‰å…¨æ€§ã€‚]]></content>
      <tags>
        <tag>server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ps]]></title>
    <url>%2F2017%2F10%2F30%2Fps%2F</url>
    <content type="text"><![CDATA[USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMANDroot 44936 99.1 1.4 148660 14340 ? R 10æœˆ28 2004:47 ./XGMS_d gms_cfg.txt]]></content>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[poll]]></title>
    <url>%2F2017%2F10%2F28%2Fpoll%2F</url>
    <content type="text"><![CDATA[Pollå°±æ˜¯ç›‘æ§æ–‡ä»¶æ˜¯å¦å¯è¯»çš„ä¸€ç§æœºåˆ¶ï¼Œä½œç”¨ä¸selectä¸€æ ·ã€‚åº”ç”¨ç¨‹åºçš„è°ƒç”¨å¦‚ä¸‹ï¼š int poll(struct pollfd *fds, nfds_t nfds, int timeout) Pollæœºåˆ¶ä¼šåˆ¤æ–­fdsä¸­çš„æ–‡ä»¶æ˜¯å¦å¯è¯»ï¼Œå¦‚æœå¯è¯»åˆ™ç«‹å³è¿”å›ï¼Œè¿”å›çš„å°±æ˜¯å¯è¯»fdçš„æ•°é‡ï¼Œå¦‚æœä¸å¯è¯»ï¼Œé‚£ä¹ˆè¿›ç¨‹å°±ä¼šä¼‘çœ ã€‚ å†…æ ¸å®ç°æµç¨‹ï¼šå½“åº”ç”¨ç¨‹åºè°ƒç”¨pollå‡½æ•°çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šè°ƒç”¨sys_pollå‡½æ•°ï¼Œè¯¥å‡½æ•°æœ€ç»ˆè°ƒç”¨do_pollå‡½æ•°ï¼Œdo_pollå‡½æ•°ä¸­æœ‰ä¸€ä¸ªæ­»å¾ªç¯ï¼Œåœ¨é‡Œé¢åˆä¼šåˆ©ç”¨]]></content>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[XXSYæœåŠ¡å™¨æ¸¸æˆæ¶æ„]]></title>
    <url>%2F2017%2F10%2F27%2Fgame-framework%2F</url>
    <content type="text"><![CDATA[æ€»ä½“æ¶æ„å›¾ å¤§åŒºæ¶æ„å›¾ é€»è¾‘æœåŠ¡å™¨æ¶æ„å›¾]]></content>
      <tags>
        <tag>server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Apache]]></title>
    <url>%2F2017%2F10%2F27%2FApache%2F</url>
    <content type="text"><![CDATA[1234567891011121314151617181920212223242526272829303132333435[1] å®‰è£… httpd.[root@linuxprobe ~]# yum -y install httpd# åˆ é™¤é»˜è®¤æ¬¢è¿é¡µé¢[root@linuxprobe ~]# rm -f /etc/httpd/conf.d/welcome.conf[2] é…ç½®httpdï¼Œå°†æœåŠ¡å™¨åç§°æ›¿æ¢ä¸ºæ‚¨è‡ªå·±çš„ç¯å¢ƒ[root@linuxprobe ~]# vim /etc/httpd/conf/httpd.conf# line 86: æ”¹å˜ç®¡ç†å‘˜çš„é‚®ç®±åœ°å€ServerAdmin root@linuxprobe.org# line 95: æ”¹å˜åŸŸåä¿¡æ¯ServerName www.linuxprobe.org:80# line 151: noneå˜æˆAllAllowOverride All# line 164: æ·»åŠ åªèƒ½ä½¿ç”¨ç›®å½•åç§°è®¿é—®çš„æ–‡ä»¶åDirectoryIndex index.html index.cgi index.php# add follows to the end# server&apos;s response headerï¼ˆå®‰å…¨æ€§ï¼‰ServerTokens Prod# keepalive is ONKeepAlive On[root@linuxprobe ~]# systemctl start httpd[root@linuxprobe ~]# systemctl enable httpd[3] å¦‚æœFirewalldæ­£åœ¨è¿è¡Œï¼Œè¯·å…è®¸HTTPæœåŠ¡ã€‚ï¼ŒHTTPä½¿ç”¨80 / TCP[root@linuxprobe ~]# firewall-cmd --add-service=http --permanentsuccess[root@linuxprobe ~]# firewall-cmd --reloadsuccess[4] åˆ›å»ºä¸€ä¸ªHTMLæµ‹è¯•é¡µï¼Œå¹¶ä½¿ç”¨Webæµè§ˆå™¨ä»å®¢æˆ·ç«¯PCè®¿é—®å®ƒã€‚å¦‚æœæ˜¾ç¤ºä»¥ä¸‹é¡µé¢ï¼Œæ˜¯æ­£ç¡®çš„[root@linuxprobe ~]# vi /var/www/html/index.html&lt;html&gt;&lt;body&gt;&lt;div style=&quot;width: 100%; font-size: 40px; font-weight: bold; text-align: center;&quot;&gt;Welcome access LinuxProbe.org,This is Test Page!&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; http://blog.csdn.net/wh211212/article/details/52982917]]></content>
      <tags>
        <tag>server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vs]]></title>
    <url>%2F2017%2F10%2F26%2Fvs%2F</url>
    <content type="text"><![CDATA[$(TargetDir)\XGZS_d.exe../data/cfg/network/cfg_relation.txt]]></content>
      <tags>
        <tag>server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[netstat]]></title>
    <url>%2F2017%2F10%2F26%2Fnetstat%2F</url>
    <content type="text"><![CDATA[netstat -tln æŸ¥çœ‹ç«¯å£å ç”¨æƒ…å†µ\p å¯ä»¥æ˜¾ç¤ºè¿›ç¨‹æ¯ä¸€åˆ—å«ä¹‰åè®®ç±»å‹ æ¥å—æµé‡ å‘é€æµé‡ æœ¬æœºåœ°å€ ç›®çš„åœ°å€ çŠ¶æ€è‡ªå·±çš„IPåœ°å€å°±æ˜¯æœ¬åœ°åœ°å€ï¼Œéœ€è¦è¿æ¥çš„åœ°å€çš„å°±æ˜¯ç›®çš„åœ°å€ nmap 127.0.0.1 æŸ¥çœ‹æœ¬æœºå¼€æ”¾çš„ç«¯å£0.0.0.0 è¡¨ç¤ºç½‘ç»œçš„æ‰€æœ‰ä¸»æœº[{â€œtypeâ€:0,â€pidâ€:-1,â€Attr1â€:0,â€idâ€:1,â€Attr2â€:0,â€nameâ€:â€PCä¸»æ”¯â€,â€tagâ€:0},{â€œtypeâ€:0,â€pidâ€:1,â€Attr1â€:0,â€idâ€:2,â€Attr2â€:0,â€nameâ€:â€ç­–åˆ’å¤§åŒºâ€,â€tagâ€:1},{â€œtypeâ€:0,â€pidâ€:1,â€Attr1â€:0,â€idâ€:3,â€Attr2â€:0,â€nameâ€:â€ç¨‹åºå¤§åŒºâ€,â€tagâ€:1},{â€œtypeâ€:0,â€pidâ€:1,â€Attr1â€:0,â€idâ€:4,â€Attr2â€:0,â€nameâ€:â€3.0.90.0â€,â€tagâ€:1},{â€œtypeâ€:0,â€pidâ€:1,â€Attr1â€:0,â€idâ€:22,â€Attr2â€:0,â€nameâ€:â€4.0.30.0â€,â€tagâ€:1},{â€œtypeâ€:0,â€pidâ€:1,â€Attr1â€:0,â€idâ€:28,â€Attr2â€:0,â€nameâ€:â€äº‘æœåŠ¡å™¨â€,â€tagâ€:1},{â€œtypeâ€:0,â€pidâ€:1,â€Attr1â€:0,â€idâ€:34,â€Attr2â€:0,â€nameâ€:â€4.0.0.0â€,â€tagâ€:1},{â€œtypeâ€:0,â€pidâ€:1,â€Attr1â€:0,â€idâ€:35,â€Attr2â€:0,â€nameâ€:â€3.0.60.0â€,â€tagâ€:1},{â€œtypeâ€:0,â€pidâ€:1,â€Attr1â€:0,â€idâ€:41,â€Attr2â€:0,â€nameâ€:â€åˆæœâ€,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:2,â€idâ€:381,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€[1]ç­–åˆ’ä¸»æ”¯â€,â€Attr1â€:4,â€Flagâ€:64,â€Urlâ€:â€192.168.3.6:16400â€,â€Attr2â€:0,â€tagâ€:3},{â€œtypeâ€:1,â€pidâ€:2,â€idâ€:382,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€[2]ç­–åˆ’ä¸»æ”¯â€,â€Attr1â€:3,â€Flagâ€:64,â€Urlâ€:â€192.168.6.113:16400â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:3,â€idâ€:256,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€[1]ç¨‹åºä¸»æ”¯â€,â€Attr1â€:2,â€Flagâ€:64,â€Urlâ€:â€192.168.3.6:26400â€,â€Attr2â€:0,â€tagâ€:3},{â€œtypeâ€:1,â€pidâ€:3,â€idâ€:257,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€[2]ç¨‹åºä¸»æ”¯â€,â€Attr1â€:1,â€Flagâ€:64,â€Urlâ€:â€192.168.6.113:26400â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:3,â€idâ€:259,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€yhy-1â€,â€Attr1â€:0,â€Flagâ€:32,â€Urlâ€:â€192.168.7.13:3100 192.168.7.13:3110â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:3,â€idâ€:53,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€yhy-2â€,â€Attr1â€:0,â€Flagâ€:32,â€Urlâ€:â€192.168.7.13:13100â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:3,â€idâ€:19,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€218(zy)â€,â€Attr1â€:0,â€Flagâ€:32,â€Urlâ€:â€192.168.5.106:3100â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:3,â€idâ€:20,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€190(zmq)â€,â€Attr1â€:0,â€Flagâ€:32,â€Urlâ€:â€192.168.5.228:26400â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:3,â€idâ€:21,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€230(hjz)â€,â€Attr1â€:0,â€Flagâ€:32,â€Urlâ€:â€10.96.205.230:26400â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:3,â€idâ€:310,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€æµ‹è¯•ä¸“æœâ€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€192.168.6.113:7100â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:3,â€idâ€:268,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€ä¸»æ”¯è·¨æœå¤§åŒºâ€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€192.168.3.6:10010â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:4,â€idâ€:93,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€[1]3.0.90.0â€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€192.168.3.6:51100â€,â€Attr2â€:0,â€tagâ€:3},{â€œtypeâ€:1,â€pidâ€:4,â€idâ€:94,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€[2]3.0.90.0â€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€192.168.6.113:51100â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:22,â€idâ€:95,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€[1]4.0.30.0â€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€192.168.3.6:43100â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:22,â€idâ€:96,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€[2]4.0.30.0â€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€192.168.6.113:43100â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:28,â€idâ€:5999,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€IOSæ¸¸å®¢â€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€139.199.37.182:48100â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:28,â€idâ€:4999,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€IOSå¾®ä¿¡â€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€139.199.37.182:53100â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:28,â€idâ€:3999,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€IOSæ‰‹Qâ€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€139.199.37.182:33100â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:28,â€idâ€:1999,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€å®‰å“æ‰‹Qâ€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€139.199.37.182:23100â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:28,â€idâ€:2999,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€å®‰å“å¾®ä¿¡â€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€139.199.37.182:28100â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:34,â€idâ€:97,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€[1]4.0.0.0â€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€192.168.3.6:20400â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:34,â€idâ€:98,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€[2]4.0.0.0â€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€1921.68.6.113:20400â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:35,â€idâ€:90,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€[1]3.0.60.0â€,â€Attr1â€:6,â€Flagâ€:64,â€Urlâ€:â€192.168.3.6:6400â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:35,â€idâ€:91,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€[2]3.0.60.0â€,â€Attr1â€:5,â€Flagâ€:64,â€Urlâ€:â€192.168.6.113:6400â€,â€Attr2â€:0,â€tagâ€:1},{â€œtypeâ€:1,â€pidâ€:41,â€idâ€:311,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€åˆæœå(3014+3016)â€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€192.168.6.113:7100â€,â€Attr2â€:0,â€tagâ€:9},{â€œtypeâ€:1,â€pidâ€:41,â€idâ€:312,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€3014â€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€192.168.6.113:23100â€,â€Attr2â€:0,â€tagâ€:9},{â€œtypeâ€:1,â€pidâ€:41,â€idâ€:313,â€RoleCountâ€:0,â€RoleInfosâ€:{},â€nameâ€:â€3016â€,â€Attr1â€:0,â€Flagâ€:64,â€Urlâ€:â€192.168.6.113:37100â€,â€Attr2â€:0,â€tagâ€:9}]]]></content>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¤šè¯­è¨€è§„èŒƒ]]></title>
    <url>%2F2017%2F10%2F25%2Flang%2F</url>
    <content type="text"><![CDATA[æ¦‚è¿°éƒ¨åˆ†å¤šè¯­è¨€èµ„æºï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ”¾åœ¨ä¸åŒç›®å½•é‡Œï¼Œå…¬ç”¨çš„éƒ¨åˆ†ä½¿ç”¨å¤–é“¾ã€‚ å®¢æˆ·ç«¯å¤šè¯­è¨€æ ¹ç›®å½•ï¼šAssets\Art\langäºŒçº§ç›®å½•mbï¼šå­˜æ”¾mbçš„å¤šè¯­è¨€æ•°æ®äºŒçº§ç›®å½•res: å­˜æ”¾ç•Œé¢æ–‡æœ¬ï¼Œä»¥åŠå…¶å®ƒèµ„æºçš„å¤šè¯­è¨€æ•°æ®ï¼ˆæ¯”å¦‚å›¾ç‰‡å’Œprefabç­‰ï¼‰ä¸‰çº§ç›®å½•ï¼šç”¨å„ç§è¯­è¨€åå­—æ¥å‘½ä»¤çš„ç›®å½•config.txtï¼šä¿å­˜å½“å‰è¯­è¨€çš„åå­— æœåŠ¡å™¨å¤šè¯­è¨€æ ¹ç›®å½•ï¼šbin\data\langäºŒçº§ç›®å½•mbï¼šå­˜æ”¾mbçš„å¤šè¯­è¨€æ•°æ®ï¼ˆè¿™ä¸ªæ˜¯ä¸Šé¢çš„å®¢æˆ·ç«¯äºŒçº§mbçš„å¤–é“¾ï¼‰äºŒçº§ç›®å½•mbsï¼šå­˜æ”¾mbså¤šè¯­è¨€æ•°æ®ä¸‰çº§ç›®å½•ï¼šç”¨å„ç§è¯­è¨€åå­—æ¥å‘½åçš„ç›®å½•config.txtï¼šä¿å­˜å½“å‰è¯­è¨€çš„åå­—ï¼ˆæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯éœ€è¦åˆ†åˆ«é…ç½®ï¼‰ ç¨‹åºéœ€è¦åšçš„äº‹æƒ…:ï¼š å¤„ç†è¡¨æ ¼é…ç½®ï¼Œåˆç†è®¾ç½®ç¿»è¯‘åˆ—ï¼› åœ¨ç•Œé¢prefabé‡Œï¼Œç»™UILabelç­‰æ§ä»¶å¡«å†™langIdï¼Œéœ€è¦åŒæ—¶åˆ›å»ºå¯¹åº”çš„æ–‡å­—èµ„æºæ–‡ä»¶ï¼› ç•Œé¢ç”¨åˆ°çš„Lua/texté‡Œçš„jsonæ–‡ä»¶ï¼Œéœ€è¦è½¬æ¢æˆtxtæ–‡ä»¶èµ„æºï¼› è„šæœ¬é‡Œçš„ä¸­æ–‡ï¼Œéœ€è¦æ”¾åˆ°æ–‡æœ¬èµ„æºé‡Œï¼› å›¾ç‰‡æ–‡å­—ï¼Œéœ€è¦æ•´ç†æ”¾åˆ°å•ç‹¬ç›®å½•é‡Œï¼Œä¾¿äºæä¾›æµ·å¤–è¿è¥å•†ï¼› resç›®å½•è§„èŒƒæ­¤ç›®å½•æ˜¯ç•Œé¢æ–‡æœ¬èµ„æºè¡¨æ ¼ï¼Œè¡¨æ ¼æ— æ ‡é¢˜è¡Œï¼Œåˆ†ä¸‰åˆ—ï¼šåå­—ï¼Œæ–‡æœ¬ï¼Œè‹±æ–‡é•¿åº¦ï¼ŒæŸäº›æŒ‰é’®ç±»çš„ç©ºé—´ï¼Œå¦‚æœéœ€è¦é™åˆ¶æ–‡æœ¬é•¿åº¦ï¼Œé‚£ä¹ˆéœ€è¦å¡«å†™è‹±æ–‡é•¿åº¦åˆ—ã€‚ä¸è¦æœ‰ä»»ä½•å­ç›®å½•ï¼Œå­ç›®å½•æ˜¯æ— æ•ˆçš„ã€‚éç¿»è¯‘æ–‡æœ¬ï¼ˆæ¯”å¦‚ç›®å½•é…ç½®æ–‡æœ¬ï¼‰ï¼Œæ”¾åˆ°luaé‡Œå°±å¥½ï¼Œä¸è¦æ”¾åœ¨txté‡Œã€‚æ­¤ç›®å½•é‡Œçš„æ‰€æœ‰æ–‡ä»¶ï¼Œéƒ½æ˜¯ç”¨åˆ°çš„æ—¶å€™åŠ è½½çš„æ–‡æœ¬èµ„æºä½¿ç”¨æ–¹å¼ï¼š C#ä»£ç è®¿é—®æ–¹å¼ï¼šLangMgr.Find(â€œlogin.Usernameâ€),æ­¤å‡½æ•°æ— GC prefabè®¿é—®æ–¹å¼ï¼šå¡«å†™UILabelçš„langId,æ ¼å¼åŒä¸Šï¼Œæ‰€æœ‰ä¸­æ–‡æ ‡ç­¾éƒ½è¦åšä¿®æ”¹ã€‚ luaè„šæœ¬è®¿é—®æ–¹å¼ï¼šlua_core.LoadLangFile(â€œloginâ€).Usernameç›®å½•fileï¼šå¯æ›¿æ¢æ‰ç›¸åŒè·¯å¾„çš„èµ„æºï¼Œæ¯”å¦‚å­—ä½“æ›¿æ¢ï¼Œæ–‡å­—å›¾ç‰‡æ›¿æ¢ç­‰ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨è¿™ä¸ªæ›¿æ¢æ•´ä¸ªç•Œé¢çš„prefabï¼Œä½†æ˜¯è½»æ˜“ä¸è¦è¿™æ ·ç”¨ã€‚ Jsonè½¬Textå·¥å…·åœ¨Unityé‡Œï¼Œé€‰ä¸­Lua/text/ç›®å½•é‡Œçš„æŸä¸ªæ–‡ä»¶ç‚¹å‡»èœå•é¡¹Pangmei/Translate/jsonè½¬textï¼Œè¿™æ ·å¯ä»¥å°†åŸæœ¬çš„jsonæ–‡ä»¶è½¬txtè¡¨æ ¼ã€‚è½¬æ¢åçš„æ–‡ä»¶æ”¾åœ¨äº†Assets\Art\lang\res\zh_cn\text\tempé‡Œï¼Œéœ€è¦é‡æ–°å‘½ååæŒªå‡ºæ¥ã€‚åŸæœ¬çš„å­ç›®å½•éƒ½ä¸è¦æœ‰äº†ï¼Œå¦‚æœæœ‰é‡å‘½åï¼Œå°±è‡ªå·±æ”¹ä¸ªåå­—ã€‚å»ºè®®æ–‡ä»¶åˆ«å¤ªå¤šï¼Œå¤ªå°çš„æ–‡ä»¶è‡ªå·±åˆå¹¶ä¸€ä¸‹ï¼Œæ–‡ä»¶å°‘ä¼šæ›´å®¹æ˜“ç®¡ç†ã€‚ æ–°æ–‡æœ¬mergeæ–¹å¼å¯ä»¥ä½¿ç”¨string.merge()æ¥æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªæ˜¯ä»¿é€ C#çš„Formatæ¥è®¾è®¡åŠŸèƒ½ã€‚ç”¨{0}å¼•ç”¨é¦–ä¸ªå‚æ•°ï¼Œå…¶ä½™å‚æ•°ç±»æ¨ã€‚è¿™ä¸ªå‡½æ•°åœ¨å®¢æˆ·ç«¯æ²¡æœ‰C#çº§åˆ«çš„GCAllocï¼Œå¤§é‡ä½¿ç”¨çš„æ—¶å€™æ¨èè¿™ä¸ªï¼Œä¸è¦ç”¨CSFormatç³»åˆ—äº†ã€‚éƒ¨åˆ†å¸¦%sçš„æ–‡æœ¬ï¼Œå»ºè®®éƒ½æ£€æŸ¥ä¸€ä¸‹ï¼Œå¤šä¸ª%sçš„æ–‡æœ¬æœ‰å¯èƒ½ä¼šå¯¼è‡´æŸäº›è¯­è¨€ç¿»è¯‘é”™è¯¯ï¼ˆä¸»è°“å®¾å’Œæ±‰è¯­æ¬¡åºä¸åŒå¯¼è‡´ï¼‰ mbç›®å½•è§„èŒƒç¿»è¯‘åˆ—é…ç½®è¡¨æ ¼çš„jsoné…ç½®æ–‡ä»¶ï¼Œæ¯åˆ—å¯ä»¥åŠ é˜²ç–«é…ç½®â€translateâ€:trueæŒ‡å®šç¿»è¯‘çš„åˆ—ï¼šä¼šè¢«ç¿»è¯‘å·¥å…·æ£€ç´¢å‡ºæ¥ç”Ÿæˆç¿»è¯‘è¯æ¡ã€‚ ç›®å½•textæœ‰å·¥å…·ç”Ÿæˆçš„è¡¨æ ¼ç¿»è¯‘æ–‡æœ¬ï¼Œè¿è¡ŒæœŸåŠ¨æ€æ›¿æ¢æ‰ä¸­æ–‡è¡¨æ ¼æ–‡æœ¬ã€‚ ç›®å½•cellæ›¿æ¢æ‰åŒåè¡¨æ ¼æŒ‡å®šå•å…ƒæ ¼çš„å†…å®¹ï¼Œä¸éœ€è¦å†™å­ç›®å½•ã€‚å¤šä¸ªæ–‡ä»¶å¯ä»¥åŒåï¼Œä»¥äºŒçº§æ‰©å±•ååŒºåˆ†ï¼Œæ¯”å¦‚ï¼šitem_list.a.txt,item_list.b.txtåŒåæ–‡ä»¶æŒ‰ç…§äºŒçº§æ‰©å±•åæ’åºä¾æ¬¡æ‰§è¡Œï¼Œé‡å¤é…ç½®çš„å•å…ƒæ ¼ï¼Œä»¥æœ€åçš„ä¸ºå‡†ã€‚é¦–è¡Œæ˜¯æ ‡é¢˜ï¼Œç¬¬äºŒè¡Œæ˜¯jsoné…ç½®é‡Œçš„è¡¨æ ¼åˆ—çš„åå­—ï¼Œåç»­èˆªæ˜¯æ›¿æ¢çš„å†…å®¹ã€‚ç¬¬äºŒè¡Œçš„åå­—ï¼Œå¯ä»¥ä¸å¡«å†™ï¼Œå°±è¡¨ç¤ºå¿½ç•¥è¯¥åˆ—ã€‚æ­¤ç‰¹æ€§é€šå¸¸ç”¨äºæ³¨é‡Šæˆ–è€…åå­—ä¹‹ç±»çš„ã€‚ç©ºå•å…ƒæ ¼è¡¨ç¤ºä¸éœ€è¦æ›¿æ¢ï¼Œå¦‚æœéœ€è¦æ›¿æ¢ä¸ºç©ºï¼Œé‚£ä¹ˆå¡«å†™â€œ##â€ ç›®å½•fileæ•´æ–‡ä»¶æ›¿æ¢è¡¨æ ¼ï¼Œå¯¹åº”çš„å‚ç…§ç›®å½•æ˜¯mbç›®å½•ã€‚è¿™ä¸ªåŠŸèƒ½å°½é‡åˆ«ç”¨ï¼Œä½¿ç”¨cellæ¥ç²¾ç¡®æ›¿æ¢æŸä¸ªå•å…ƒæ ¼æ›´å¯æ§ã€‚ mbsç›®å½•è§„èŒƒç¿»è¯‘åˆ—é…ç½®ï¼šè§„åˆ™åŒmb ç›®å½•textè§„åˆ™åŒmb ç›®å½•cellåŸºæœ¬è§„åˆ™åŒmbæœ‰å­ç›®å½•npc_refreshå’Œflagï¼Œåˆ†åˆ«å¯¹åº”é‚£ä¸¤ç»„è¡¨ï¼Œç›®å½•å†…çš„è§„åˆ™ä¹ŸåŒmb ç›®å½•fileè§„åˆ™åŒmb ç¿»è¯‘å·¥å…·æµ·å¤–ä¸“å‘˜ç¿»è¯‘å·¥å…·è·¯å¾„ï¼šsvn://zentia/welcome/LangToolæµ·å¤–ä¸“å‘˜ä¸€èˆ¬æ˜¯å¸‚åœºéƒ¨åŒå­¦ã€‚è´Ÿè´£å°†å¾…ç¿»è¯‘çš„æ–‡æœ¬åˆ°å¤„ï¼Œç„¶åå‘ç»™æµ·å¤–è¿è¥å•†ç¿»è¯‘ï¼Œå¹¶ä¸”å°†è¯‘æ–‡å¯¼å…¥å…¬ç”¨è¯æ¡åº“é‡Œã€‚ é¡¹ç›®åˆ†æ”¯ç¿»è¯‘å·¥å…·è·¯å¾„ï¼šsvn://zentia/trunk/xxpub/LangToolï¼ˆå…¶ä½™åˆ†æ”¯è·¯å¾„ç±»ä¼¼ï¼‰é¡¹ç›®çš„å¯¼å…¥èŒèƒ½ç”±äº§å“è´Ÿè´£éœ€è¦åœ¨æ¯ä¸ªæµ·å¤–ç‰ˆæœ¬å‘å¸ƒå‰ï¼Œå°†ç‰¹å®šåˆ†æ”¯ç”Ÿæˆæµ·å¤–æ–‡æœ¬èµ„æºå¹¶ä¸”ä¸Šä¼ ã€‚ å¤šè¯­è¨€åå­—å‚ç…§å¾®è½¯çš„å¤šè¯­è¨€åç§°å‚è€ƒç½‘ç«™ï¼šhttps://www.microsoft.com/en-us/locale.aspx]]></content>
      <tags>
        <tag>sy</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[fork]]></title>
    <url>%2F2017%2F10%2F25%2Ffork%2F</url>
    <content type="text"><![CDATA[é€šè¿‡ç³»ç»Ÿè°ƒç”¨åˆ›å»ºä¸€ä¸ªä¸åŸæ¥è¿›ç¨‹å‡ ä¹å®Œå…¨ç›¸åŒçš„è¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤ä¸ªè¿›ç¨‹å¯ä»¥åšå®Œå…¨ç›¸åŒçš„äº‹æƒ…ï¼Œä½†å¦‚æœåˆå§‹å‚æ•°æˆ–è€…ä¼ å…¥çš„å˜é‡ä¸åŒï¼Œä¸¤ä¸ªè¿›ç¨‹ä¹Ÿå¯ä»¥åšä¸åŒçš„äº‹ã€‚ä¸€ä¸ªè¿›ç¨‹è°ƒç”¨fork()å‡½æ•°ä¹‹åï¼Œç³»ç»Ÿå…ˆç»™æ–°çš„è¿›ç¨‹åˆ†é…èµ„æºï¼Œä¾‹å¦‚å­˜å‚¨æ•°æ®å’Œä»£ç çš„ç©ºé—´ã€‚ç„¶åå§åŸæ¥çš„è¿›ç¨‹çš„æ‰€æœ‰å€¼éƒ½å¤åˆ¶åˆ°æ–°çš„è¿›ç¨‹ä¸­ï¼Œåªæœ‰å°‘æ•°å€¼ä¸åŸæ¥è¿›ç¨‹çš„å€¼ä¸åŒã€‚ç›¸å½“äºå…‹éš†äº†ä¸€ä¸ªè‡ªå·±ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849int whdaemon_init(bool bAutoCloseFD)&#123; printf("Transform to daemon ... "); pid_t pid; if( (pid=fork()) &lt; 0) &#123; printf("Failed!%s", WHINEED); return -1; &#125; else if(pid !=0) &#123; //parent goes bye-bye printf("SUCCESS, pid might be:%d!%s", pid+1, WHLINEEND); exit(0); &#125; // å…³é—­æ‰€æœ‰å¥æŸ„ if (bAutoCloseFD) &#123; for (int i =0; i &lt; MAXFD; i++) &#123; close(i); &#125; &#125; else &#123; // å¦åˆ™è‡³å°‘å…³é—­æ ‡å‡†çš„è¾“å…¥è¾“å‡º close(0); close(1); close(2); &#125; // å˜æˆseeion leader setsid(); signal(SIGHUP, SIG_IGN); // ç»“æŸç¬¬ä¸€ä¸ªç´«ç¦åŸ if ((pid=for() != 0)) &#123; exit(0); &#125; umask(0); return 0;&#125;]]></content>
      <tags>
        <tag>linux</tag>
        <tag>gcc</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[time]]></title>
    <url>%2F2017%2F10%2F24%2Ftime%2F</url>
    <content type="text"><![CDATA[è®¾ç½®æ—¶é—´åŒæ­¥timedatectl set-ntp yes]]></content>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[systemctl]]></title>
    <url>%2F2017%2F10%2F24%2Fsystemctl%2F</url>
    <content type="text"><![CDATA[æ˜¾ç¤ºé˜²ç«å¢™çŠ¶æ€ï¼šsystemctl status firewalld.serviceå…³é—­é˜²ç«å¢™ï¼šsystemctl stop firewalld.serviceå¼€å¯é˜²ç«å¢™ï¼šsystemctl start firewalld.serviceä¸Šé¢çš„firewalldçš„ï¼Œä¸è¿‡æˆ‘åæ¥å®‰è£…äº†iptablesæ¢ä¸€ä¸‹å°±å¥½äº†]]></content>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æœåŠ¡å™¨æ­å»ºå’Œæ—¥å¸¸ç»´æŠ¤]]></title>
    <url>%2F2017%2F10%2F24%2Fserver-set%2F</url>
    <content type="text"><![CDATA[1 æ¦‚è¿°2 ç³»ç»Ÿè½¯ç¡¬ä»¶è¦æ±‚è½¯ä»¶ï¼šæ‰€æœ‰çš„æœåŠ¡å™¨ç¨‹åºéƒ½å¯ä»¥åœ¨linuxå’Œwindowsç³»ç»Ÿä¸Šã€‚æ¨èä½¿ç”¨linuxç³»ç»Ÿã€‚æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨çš„ç³»ç»Ÿæ˜¯suse10.1ï¼Œä¸è¿‡æŒ‰è¦æ±‚ï¼Œæˆ‘ä»¬åœ¨tlinuxçš„æœåŠ¡å™¨ä¸Šå®éªŒç¼–è¯‘å¹¶è¿è¡Œäº†æˆ‘ä»¬çš„æ‰€æœ‰æœåŠ¡å™¨æˆã€‚Gccç‰ˆæœ¬ï¼šgcc(GCC)4.8.5æ•°æ®åº“ä½¿ç”¨MYSQLã€‚ç‰ˆæœ¬ï¼š5.6.38ç¡¬ä»¶ï¼šå‚è€ƒå…ˆå‰æä¾›çš„ç¡¬ä»¶é…ç½®èµ„æ–™å¦å¤–ï¼Œè¯·åœ¨å¯åŠ¨æ–‡ä»¶/etc/rc.d/rc.localä¸­è®¾ç½®å…±äº«å†…å­˜ã€ç½‘ç»œå‚æ•°ä»¥åŠcoreæ–‡ä»¶æ¨¡å¼123456789101112131415#increase Linux SHM maxecho 300000000 &gt; /proc/sys/kernel/shmmax#increase Linux TCP buffer limitsecho 8388608&gt;/proc/sys/net/core/rmem_maxecho 8388608&gt;/proc/sys/net/core/wmem_maxecho 262114&gt;/proc/sys/net/core/rmem_defaultecho 262114&gt;/proc/sys/net/core/wmem_default#increase Linux autotruning TCP buffer limitsecho &quot;4096 87380 8388608&quot;&gt;/proc/sys/net/ipv4/tcp_rmemecho &quot;4096 65536 8388608&quot;&gt;/proc/sys/net/ipv4/tcp_wmemecho &quot;8388608 8388608 8388608&quot;&gt;/proc/sys/net/ipv4/tcp_memecho &quot;840&quot;&gt;/proc/sys/net/ipv4/echo &quot;core-%e-%p-%s&quot;&gt;/proc/sys/kernel/core_pattern 3 ç»´æŠ¤äººå‘˜è´¦å·é…ç½®ä¸ºäº†å®‰å…¨çš„åŸå› ï¼Œè¯·ä¸è¦ä½¿ç”¨rootè´¦å·è¿›è¡ŒæœåŠ¡å™¨çš„ç»´æŠ¤å·¥ä½œã€‚ 4 MySQLçš„é…ç½®5 æœåŠ¡ç¨‹åºç®€ä»‹6 æœåŠ¡ç¨‹åºçš„ç‰ˆæœ¬è¾¨è®¤7 æ—¥å¿—æœåŠ¡ç¨‹åºå¯åŠ¨è¿‡ç¨‹7.1 å¯åŠ¨æ—¥å¿—æœåŠ¡7.2 æ£€æŸ¥8 æ¸¸æˆæœåŠ¡å™¨å¯åŠ¨è¿‡ç¨‹8.1 å¯åŠ¨æ—¥å¿—æœåŠ¡8.2 å¯åŠ¨æ¸¸æˆæ€»æ§æ¡†æ¶8.3 å¯åŠ¨æ¸¸æˆåœºæ™¯çº¿8.4 æ£€æŸ¥9 æœåŠ¡ç»„å…³é—­è¿‡ç¨‹10 YYCGZSçš„ç»´æŠ¤]]></content>
      <tags>
        <tag>server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æœåŠ¡å™¨å®‰è£…è¯´æ˜]]></title>
    <url>%2F2017%2F10%2F24%2Fserver-install%2F</url>
    <content type="text"><![CDATA[è§£å‹æœåŠ¡å™¨æ‰§è¡Œæ–‡ä»¶xx_svr_binfull_XXXX.tgzåˆ°æŒ‡å®šæ–‡ä»¶å¤¹ã€‚ è§£å‹é…ç½®æ–‡ä»¶xx_svr_cfgfull_XXXX.tgzåˆ°ç›¸åŒçš„æ–‡ä»¶å¤¹ã€‚ è§£å‹é…ç½®æ–‡ä»¶xx_svr_resfull_XXXX.tgzåˆ°ç›¸åŒçš„æ–‡ä»¶å¤¹ã€‚ å°†æˆ‘ä»¬æä¾›çš„keyæ–‡ä»¶ä¿®æ”¹æ–‡ä»¶åä¸ºauth-info.keyæ”¾åœ¨XCAAFSå’ŒXCLSæ–‡ä»¶å¤¹ä¸‹ XGMSç›®å½•ä¸‹åˆ›å»ºfilecacheç›®å½•ï¼Œå¹¶ç»™äºˆæ‰§è¡ŒæœåŠ¡å™¨å¸å·å†™æƒé™ã€‚ XLBAç›®å½•ä¸‹åˆ›å»ºsiglogç›®å½•ï¼Œå¹¶ç»™äºˆæ‰§è¡ŒæœåŠ¡å™¨å¸å·å†™æƒé™ã€‚ ç¡®è®¤pidæ–‡ä»¶ç›®å½•/tmpæœ‰å†™æƒé™ï¼Œç¡®è®¤/dataæ—¥å¿—ç›®å½•æœ‰å†™æƒé™ã€‚ åˆ›å»ºæ•°æ®åº“ï¼Œæ‰§è¡ŒSQLä¸‹ca.shï¼Œå‘½ä»¤ä¸ºï¼š./ca.sh ç‰ˆæœ¬åç¼€ åœ°å€å¦‚ï¼š./ca.sh sy xxsy.cxebfhyvgemb.us-east-2.rds.amazonaws.com ä¿®æ”¹é…ç½®æ–‡ä»¶cmncfg.txtï¼Œä¸»è¦ä¿®æ”¹å¦‚ä¸‹ï¼šSVRGRPID å¤§åŒºIDï¼Œå¦‚æœéœ€è¦åœ¨ä¸€ä¸ªé›†ç¾¤å»ºç«‹å¤šä¸ªå¤§åŒºï¼Œåˆ™å¤§åŒºIDä¸å¯é‡å¤VER_EXT ç‰ˆæœ¬åç¼€ï¼ŒåŒä¸€å°æœºå™¨é…ç½®å¤šç»„å¤§åŒºçš„æ—¶å€™å¿…é¡»ä¸åŒONEOUTERIP å¯¹å¤–IPï¼Œå®¢æˆ·ç«¯ä¸»è¦ä»æ­¤IPè¿æ¥æœåŠ¡å™¨ONEINNERIP æœåŠ¡å™¨ç»„å†…éƒ¨IPï¼ŒæœåŠ¡å™¨é—´é€šä¿¡é€šè¿‡æ­¤IPMYSQLIP æ•°æ®åº“IPGDB_PORT æ•°æ®åº“ç«¯å£DB_USER æ•°æ®åº“å¸å·DB_PASSWORD æ•°æ®åº“å¯†ç PORTSHIFT åŒä¸€å°æœºå™¨ä¸Šå¯åŠ¨å¤šç»„æœåŠ¡å™¨å¿…é¡»ä¸åŒSHMSHIFT åŒä¸Šæ³¨ï¼šå¦‚åˆ†å¼€å¤šå°æœåŠ¡å™¨æ¶è®¾è¿˜éœ€è¦ä¿®æ”¹æŒ‡å®šæœåŠ¡å™¨åœ°å€ æŒ‰ç…§ã€ŠæœåŠ¡å™¨æ­å»ºå’Œæ—¥å¸¸ç»´æŠ¤ã€‹æ–‡æ¡£ç¬¬2èŠ‚ä¿®æ”¹å…±äº«å†…å­˜é™åˆ¶å’Œtcpç›¸å…³é…ç½®ã€‚ runGlog.shå¯åŠ¨æ—¥å¿—æœåŠ¡å™¨ï¼Œä¸€å…±15ä¸ªè¿›ç¨‹ã€‚ æ‰§è¡Œrun.shå¯åŠ¨æœåŠ¡å™¨ç»„ã€‚ å…±æœ‰IP:18.219.246.109ç§æœ‰IP:172.31.29.118]]></content>
      <tags>
        <tag>server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[uwa]]></title>
    <url>%2F2017%2F10%2F23%2Fuwa%2F</url>
    <content type="text"><![CDATA[AssetBundle lockpersistentmanagerå¼€é”€è§‚å¯Ÿæ€§èƒ½æ›²çº¿ï¼Œå‘ç°æŸä¸€å¸§AssetBundleåŠ è½½ä¸­ï¼Œlockpersistentmanagerè€—æ—¶æ¯”è¾ƒå¤§ã€‚è¯·é—®è¿™å—æ˜¯å¦èƒ½å¤Ÿä¼˜åŒ–ï¼Ÿè¿™è¯´æ˜å½“å‰å¸§æˆ–å‰å‡ å¸§ä¸­å­˜åœ¨è¾ƒå¤§é‡çš„èµ„æºåœ¨é€šè¿‡LoadAsyncæ¥è¿›è¡ŒåŠ è½½ï¼Œå…¶æœ¬è´¨æ˜¯æ‰€åŠ è½½çš„èµ„æºè¿‡å¤§æ‰€è‡´ï¼Œå¯¹è‡ªèº«èµ„æºè¿›è¡Œåˆç†ä¼˜åŒ–å¯é™ä½Loading.LockPersistentManagerçš„å¼€é”€ã€‚å¦å¤–ï¼Œå°†å¼‚æ­¥åŠ è½½æ¢æˆåŒæ­¥åŠ è½½ï¼ŒLockPersistentManagerå°±ä¸ä¼šå‡ºç°äº†ï¼Œä½†å…¶æ€»åŠ è½½è€—æ—¶æ˜¯æ²¡æœ‰å˜åŒ–çš„ï¼Œå› ä¸ºæ€»åŠ è½½é‡æ²¡å˜ã€‚å…³äºä¸»è¦èµ„æºçš„åŠ è½½ä¼˜åŒ–ï¼Œå¯å‚è€ƒå¦‚ä¸‹é“¾æ¥ï¼šhttps://blog.uwa4d.com/archives/LoadingPerformance_Texture.htmlhttps://blog.uwa4d.com/archives/LoadingPerformance_Mesh.htmlhttps://blog.uwa4d.com/archives/LoadingPerformance_Shader.htmlhttps://blog.uwa4d.com/archives/Loading_AnimationClip.htmlhttps://blog.uwa4d.com/archives/livebroadcast6-8.html ** IN DIR:3rd, make dep with Makefile_debug.mk dep ** make[1]: è¿›å…¥ç›®å½•â€œ/root/work_code/3rdâ€ ** IN DIR:cryptlib, make dep with Makefile_debug.mk dep ** make[2]: è¿›å…¥ç›®å½•â€œ/root/work_code/3rd/cryptlibâ€ g++ -DLINUX -D_FILE_OFFSET_BITS=64 -D_LARGEFILE64_SOURCE -D_LARGEFILE_SOURCE -march=core2 -m32 -MM -MT &quot;../temp/debug/cryptlib/cpu.o_d&quot; -MF ../temp/debug/cryptlib/cpu.d_d cpu.cpp -I/usr/include/mysql -I/root/work_code/3rd -I/root/work_code/3rd/freetype221 -I/root/work_code/src/engine -I/root/work_code/src/svr -I/root/work_code/src/xxsy -I/root/work_code/src/svr/glogger/tlog/linux &lt;built-in&gt;:0:0: è‡´å‘½é”™è¯¯ï¼šæ‰“å¼€ä¾èµ–æ–‡ä»¶ ../temp/debug/cryptlib/cpu.d_dï¼šæ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½• -DLINUX #define LINUX -D_FILE_OFFSET_BITS #define _FILE_OFFSET_BITS -D_LARGFEFILE64_SOURCEmarchæŒ‡å®šçš„æ˜¯å½“å‰cpuçš„æ¶æ„ï¼Œè€Œmtuneæ˜¯çœŸæ­£ä½œç”¨äºæŸä¸€å‹å·cpuçš„é€‰é¡¹ã€‚ -M ç”Ÿæˆæ–‡ä»¶å…³è”çš„ä¿¡æ¯ã€‚ -MM å¿½ç•¥ç”±#includeé€ æˆçš„ä¾èµ–å…³ç³» -MF æŒ‡ä¸€ä¸ªæ–‡ä»¶ç”¨äºå­˜æ”¾ç”Ÿæˆæ–‡ä»¶çš„å…³è”ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ä¸-Mæˆ–-MMæ˜¯ä¸€æ ·çš„ï¼Œ -MT æŒ‡å®šç›®æ ‡æ–‡ä»¶å Camera.Renderé‡Œé¢Animation.RebuildInternalStateè€—æ—¶è¾ƒå¤šä¹‹æ‰€ä»¥å‡ºç°è¿™ä¸€é¡¹ï¼Œä¸»è¦å¯ä»¥è¯´ä»¥ä¸‹ä¸¤ç‚¹ï¼šï¼ˆ1ï¼‰é¡¹ç›®ç”¨çš„æ˜¯Animationè€ç‰ˆåŠ¨ç”»ç³»ç»Ÿï¼›ï¼ˆ2ï¼‰å¯¹å«æœ‰Animationç»„ä»¶çš„GameObjectè¿›è¡Œäº†å¤§é‡é¢‘ç¹çš„Activeæˆ–è€…Instantiateæ“ä½œï¼Œä¸€èˆ¬è¿™ç§æƒ…å†µæ¯”è¾ƒå¸¸è§äºç‰¹æ•ˆã€UI HUDã€è§’è‰²/æ€ªç‰©ç­‰ã€‚ æ˜¯å¦å¯ä»¥é’ˆå¯¹ç‰¹å®šGameObjectæå‡å®ƒçš„ç‰©ç†æ¨¡æ‹Ÿæ¬¡æ•°æˆ‘ä»¬åœ¨åšä¸€ä¸ªå°½é€Ÿé¡¹ç›®ï¼Œå‘ç°æœ‰æ—¶å€™ç‰©ç†çš„è®¡ç®—å¹¶ä¸æ˜¯éå¸¸å‡†ç¡®ï¼Œåœ¨è¿åŠ¨é€Ÿåº¦è¾ƒå¿«æ—¶ï¼Œä¾ç„¶ä¼šå’Œå¢™ä½“é€ æˆéƒ¨åˆ†ç©¿æ’ï¼Œè¿™ç»™æˆ‘ä»¬çš„æ¸¸æˆå¸¦æ¥äº†å¾ˆä¸å¥½çš„ä½“éªŒï¼Œæˆ‘çŸ¥é“å¯ä»¥é€šè¿‡Fixed TimeStepæ¥æå‡ç‰©ç†ç³»ç»Ÿçš„æ¯å¸§çš„è®¡ç®—é€Ÿåº¦ï¼Œç›®å‰è¯¥å€¼ä¸º0.02ï¼Œä¹Ÿå°±æ˜¯1ç§’è®¡ç®—50æ¬¡ï¼ŒEdit&gt;Project Settings&gt;Time&gt;Fixed TimeStep=0.02ã€‚æˆ‘ä»¬æ›¾å°†å…¶è®¾ç½®ä¸º0.005ï¼Œç©¿æ’é—®é¢˜æ˜æ˜¾å¥½è½¬ï¼Œä½†æ˜¯çœ‹ä¸Šå»è¯¥å€¼æ˜¯å¯¹æ‰€æœ‰GameObjectå‡ä½¿ç”¨çš„ï¼Œæ‰€ä»¥æˆ‘æƒ³é—®é—®èƒ½å¦ä»…é’ˆå¯¹æŸä¸€ä¸ªGameObjectæ¥è¿›è¡Œæå‡å®ƒçš„ç‰©ç†è®¡ç®—é¢‘ç‡ï¼Ÿè¿™æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºFixed TimeStepæ˜¯Unityå¼•æ“ç‰©ç†æ¨¡å—çš„å…¨å±€å‚æ•°ã€‚å»ºè®®é¢˜ä¸»å¯ä»¥è€ƒè™‘å°†ç¢°æ’æ£€æµ‹çš„æ¨¡å¼æ”¹ä¸ºâ€Continuous Dynamicâ€ï¼Œçœ‹çœ‹æ˜¯å¦æ»¡è¶³éœ€æ±‚ã€‚ä½†æ˜¯ï¼Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå¦‚æœç‰©ä½“çš„é€Ÿåº¦ç¡®å®éå¸¸å¿«ï¼Œé‚£ä¹ˆä»»ä½•ä¸€ç§ç¢°æ’æ¨¡å¼éƒ½ä¸èƒ½100%è¾¾åˆ°ä¸ç©¿æ’çš„æ•ˆæœã€‚å»ºè®®é¢˜ä¸»å¯ä»¥è€ƒè™‘å¢å¤§ç¢°æ’ä½“çš„Sizeæˆ–è€…é€šè¿‡å°„çº¿æ±‚äº¤çš„æ–¹å¼æ¥å°†å‡ºç°ç©¿æ’é—®é¢˜çš„æ¦‚ç‡é™åˆ°æœ€ä½ã€‚ è¯·æ•™AssetBundle Diff Patch æ–¹æ¡ˆæ˜¯å¦å¯è¡Œæˆ‘åŸå…ˆçš„æ›´æ–°æ–¹æ¡ˆæ˜¯æ¯”å¯¹AssetBundleæ–‡ä»¶çš„hashå€¼ç›´æ¥æ›¿æ¢æ•´ä¸ªAssetBundleå’Œmanifestæ¥è¾¾åˆ°æ›´æ–°æ•ˆæœçš„ï¼Œæœ‰æ²¡æœ‰å…¶å®ƒæ–¹æ¡ˆç±»ä¼¼diff patch,å¯ä»¥å‡å°‘æ›´æ–°åŒ…ä½“ï¼Œå¦‚æœå¯ä»¥åšdiff patchï¼Œèµ„æºé¢—ç²’åº¦æ˜¯ä¸æ˜¯ä¹å¯ä»¥å¿½ç•¥äº†åŸºäºABçš„ç›´æ¥Diffæ›´æ–°ç›®å‰æ²¡æœ‰æˆç†Ÿçš„æ–¹æ¡ˆï¼Œä¸è¿‡åªæŠŠå®Œæ•´çš„Resourcesåº“ä¸­çš„éƒ¨åˆ†èµ„æºæ›´æ–°çš„é¡¹ç›®ï¼Œå·²ç»åšäº†2ä¸ªäº†ã€‚æ€è·¯å…¶å®å¾ˆç®€å•ï¼š1ã€å‡ºæ•´åŒ…çš„æ—¶å€™ï¼Œç”¨ScriptableObjectè®°å½•ä¸‹AssetsDataBaseä¸­æ‰€æœ‰è¢«å‘å¸ƒèµ„æºçš„MD5ç ï¼ˆä¸èƒ½ç”¨Unityè‡ªå·±çš„hashç ï¼‰ã€‚2ã€ç”¨å·¥å…·è°ƒå‡ºå“ªäº›assetsæ˜¯ä»£ç åŠ¨æ€Loadçš„ï¼Œåˆ†ä¸€ä¸ªResåŒ…ä¸­ï¼›æ‰¾å‡ºè¿™äº›èµ„æºçš„ä¾èµ–èµ„æºï¼Œåˆ†å…¥ä¸€ä¸ªShareåŒ…ä¸­ï¼Œå¹¶è®°å½•æ¯ä¸ªAssetæ‰€å±çš„ABåŒ…ã€‚3ã€å‡ºè¡¥ä¸æ—¶ï¼Œå¯¹æ¯”å½“å‰AssetsDataBaseä¸­å“ªäº›ä»£ç ä¸­åŠ¨æ€Loadçš„èµ„æºå‡ºç°äº†å¢åŠ å’Œæ”¹åŠ¨ï¼ˆåˆ é™¤å¯ä»¥æ— è§†ï¼‰ï¼ŒåŒ…æ‹¬ä»–ä»¬ä¾èµ–çš„èµ„æºã€‚ä»ç„¶æŠŠä»£ç ä¸­åŠ¨æ€Loadçš„èµ„æºResPatchä¸­ï¼Œä¾èµ–æ”¾å…¥SharePatchä¸­ã€‚å¯¹äºæ²¡æœ‰å˜åŒ–çš„èµ„æºï¼Œä»ç„¶ç»´æŒåŸæ¥ABåå­—ã€‚4ã€è®°å½•ä¸‹æ¬¡è¡¥ä¸ä¹‹åï¼Œæ›´æ–°æ¯ä¸ªAssetæ‰€å±çš„ABåŒ…ã€‚5ã€ä¸‹ä¸€æ¬¡è¡¥ä¸æ—¶çš„Reså’ŒShareå¯èƒ½ä¼šä¾èµ–ä¸Šä¸€æ¬¡çš„è¡¥ä¸çš„Shareã€‚6ã€è¿è¡Œæ—¶ï¼Œå¯¹æ‰€æœ‰è¡¥ä¸å…¥çš„Reså»ºç«‹ä¸€ä¸ªå­—å…¸ç´¢å¼•ã€‚Loadçš„æ—¶å€™ï¼Œæœ‰é™åˆ¤æ–­è¿™ä¸ªAssetæ˜¯å¦åœ¨è¡¥ä¸çš„ResåŒ…ä¸­ï¼Œå¦‚æœæ˜¯åˆ™è¯»è¡¥ä¸çš„ABåŒ…ï¼Œå¹¶æŒ‰å¥—è·¯å¤„ç†ä¾èµ–åŒ…ã€‚å¦åˆ™å°±ç”¨äºŒè¿›åˆ¶ç‰ˆæœ¬å†…å»ºçš„åŒ… è¿™ç§åšæ³•çš„å¥½å¤„æ˜¯ï¼š1ã€å……åˆ†åˆ©ç”¨ç‰ˆæœ¬ä¸­çš„å·²ç»å‘å¸ƒçš„èµ„æºï¼Œä»¥å‡å°è¡¥ä¸åŒ…çš„ä½“ç§¯2ã€è¡¥ä¸åŒ…çš„æ‰“åŒ…è§„åˆ™å¯ä»¥å‡ ä¹æ— è§†å®Œæ•´åŒ…çš„åˆ†åŒ…è§„åˆ™ï¼Œæ–¹ä¾¿åç»­æŠ˜è…¾ å½“ç„¶ç¼ºç‚¹ä¹Ÿæ˜¯å¾ˆä¸¥é‡çš„ï¼š Reserved Total - Unityå¼•æ“åœ¨å†…å­˜æ–¹é¢çš„æ€»ä½“åˆ†é…é‡ã€‚Unityå¼•æ“çš„å†…å­˜å¹¶ä¸æ˜¯éšç”¨éšå–ï¼Œè€Œæ˜¯é¢„å…ˆä»æ“ä½œç³»ç»Ÿä¸­ç”³è¯·ä¸€å—ï¼Œç„¶åå†è¿›è¡Œä½¿ç”¨ã€‚ Uesd Total - Unityå¼•æ“å†å†…å­˜æ–¹é¢çš„æ€»ä½“ä½¿ç”¨é‡ã€‚ Reserved Unity &amp; Used Unity - Unityå¼•æ“è‡ªèº«å„ä¸ªæ¨¡å—å†…éƒ¨çš„å†…å­˜åˆ†é…ï¼Œå®åº“å¶å„ä¸ªManagerçš„å†…å­˜å ç”¨ã€åºåˆ—åŒ–ä¿¡æ¯çš„å†…å­˜ç«™å“Ÿä¸ªï¼ŒWebStream/SerializedFileå†…å­˜å ç”¨å’Œéƒ¨åˆ†èµ„æºçš„å†…å­˜æš‚ç”¨ç­‰ç­‰ã€‚]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[gcc]]></title>
    <url>%2F2017%2F10%2F23%2Fgcc%2F</url>
    <content type="text"><![CDATA[extern staticextern æŒ‡ä¸ºå¯¼å‡ºåˆ°å…¶å®ƒæ–‡ä»¶æ‰€ä½¿ç”¨çš„éstaticeå˜é‡staticæ˜¯å½“å‰æ–‡ä»¶çš„é™æ€å˜é‡äºŒè€…ä¸èƒ½åŒæ—¶å®šä¹‰setarch i386 ./config -m32ç¼–è¯‘32ä½çš„opensshç¼ºå°‘ gnu/stubs-32.h yum install glibc-devel.i686 gccæ²¡æœ‰æ‰¾åˆ° yum install libstdc++-devel.i686 yum install -y gcc gcc+ gcc-c++]]></content>
      <tags>
        <tag>Linux</tag>
        <tag>gcc</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity Shader PBR]]></title>
    <url>%2F2017%2F10%2F23%2FShaderLab%2F</url>
    <content type="text"><![CDATA[è§‚å¯Ÿä¸¤ä¸ªç©ºé—´é˜´å½±æ˜ å°„(Shadow Mapping)ç‰µæ¶‰åˆ°ä¸¤ä¸ªç©ºé—´çš„Zæ·±åº¦æ¯”è¾ƒ,ä¸€ä¸ªæ˜¯ç¯å…‰ç©ºé—´,ä¸€ä¸ªæ˜¯ç›¸æœºç©ºé—´,é¦–å…ˆæ‰“å¼€ShadowMapping_2ä¸‹çš„åœºæ™¯,åœºæ™¯æ˜¯é»˜è®¤çš„ç›¸æœºè§†è§’,å•å‡»ä¸‹é¢çš„Light ViewæŒ‰é’®,å¯ä»¥åˆ‡æ¢åˆ°ç¯å…‰è§†è§’,13.1.2 ä¸¤ä¸ªè§†è§’çš„Zæ·±åº¦åˆ†åˆ«å•æœºLightView Depthå’ŒCamView Depth,ç„¶ååˆ°Shadow/ShadowMappingå·¥ç¨‹æ–‡ä»¶å¤¹ä¸‹é¢æ‰¾åˆ°_CamViewZDepthå’Œ_LightViewZDepthä¸¤å¼ Render Texture,æŸ¥çœ‹ä¸€ä¸‹æ¸²æŸ“è¾“å‡ºçš„ZDepth13.1.3 æ¸²æŸ“Zæ·±åº¦çš„æè´¨è¿™ä¸¤å¼ ZDepthæ˜¯åˆ†åˆ«åœ¨ç¯å…‰è§†è§’å’Œç›¸æœºä½¿ç”¨Replacement Shader æ¸²æŸ“å‡ºæ¥çš„åœ¨vertexå‡½æ•°vertä¸­,ä¸»è¦æ“ä½œé™¤äº†å¯¹ç‰©ä½“å½¢ä½“çš„å¿…è¦è¾“å‡ºå¤–,å°±æ˜¯UNITY_TRANSFERDEPTH(o.depth),æ‰“å¼€UnityCG.cgincæ–‡ä»¶,ä¼šå‘ç°å®ƒä¸€èˆ¬æƒ…å†µä¸‹çš„æ“ä½œå°±æ˜¯o.depth = o.pos.zw,æŠŠç‰©ä½“åœ¨æŠ•å½±ç©ºé—´åšçš„zwå€¼èµ‹ç»™o.depth,å†å°†å®ƒçš„å€¼è¾“å‡ºåˆ°ä¸€å¼ Render Texture ä¹‹å‰,é€šè¿‡Linear01Depth(d)å‡½æ•°æŠŠZçš„å€¼å˜æ¢åˆ°01ç©ºé—´,è¿™æ ·æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€å¼ å¯¹æ¯”åº¦æ›´å¼ºçš„Zæ·±åº¦å›¾,å°±åƒåœ¨ä¸Šé¢æ‰€çœ‹åˆ°çš„é‚£æ ·,è€Œä¸æ˜¯ä¸€å¼ å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æœ¦æœ¦èƒ§èƒ§çš„Zæ·±åº¦å›¾13.2 æŠ•å°„Zæ·±åº¦13.2.1 å‡†å¤‡ç¯å…‰è§†è§’çš„æŠ•å½±çŸ©é˜µ åœ¨è¿›è¡Œæ˜ å°„é˜´å½±ç»å…¸çš„Zæ·±åº¦æ¯”è¾ƒä¹‹å‰,æˆ‘ä»¬éœ€è¦æŠŠç¯å…‰è§†è§’ZDepthæ·±åº¦å›¾æŠ•å°„åˆ°ç›¸æœºè§†è§’.æ‰“å¼€ShadowMapping_3ä¸‹çš„åœºæ™¯.å’Œä¸Šä¸€ä¸ªåœºæ™¯ç³»ç›¸æ¯”,é™„åŠ åœ¨Main Cameraç‰©ä½“ä¸Šçš„ShadowMapping_3.cs13.3.4 å¯¹Zå€¼è¿›è¡Œåç§»æ˜¾ç„¶,Zçš„ç²¾åº¦æ˜¯ä¸ªé—®é¢˜,è€Œä¸”é€šè¿‡ä¸Šè¿°ç¼–ç æ“ä½œæˆ‘ä»¬å·²ç»è§£å†³äº†Shadow anceçš„é—®é¢˜,ä½†æ˜¯ä¸»è¦é—®é¢˜ä¾ç„¶,è¿™ä¸ªç°è±¡å«Peter Panning,æºè‡ªè¿ªå°¼æ–¯çš„ä¸€éƒ¨åŠ¨ç”»ä¸»è§’Peter Pan,ä»–çš„å½±å­å¯ä»¥è„±ç¦»è‡ªèº«æ´»åŠ¨èµ·æ¥,æ‰“å¼€ åˆ†å¼€å¤„ç†åå°„é¢çš„ç»ç¼˜ä½“ç‰¹æ€§å’Œé‡‘å±å±æ€§ï¼Œæœ€åå…‰ç…§åº”è¯¥æ˜¯Diffuse+Specular çº¯é‡‘å±æ²¡æœ‰Diffuseï¼Œéé‡‘å±ä¸»è¦æ˜¯Diffuseï¼Œæœ‰ä¸€ç‚¹åå°„ å…‰éƒ¨åˆ†ä¸»è¦æœ‰3ä¸ªä¸œè¥¿å½±å“ï¼šå¾®è¡¨é¢çš„æ³•çº¿åˆ†å¸ƒï¼ˆNDFï¼‰ï¼Œå¾®è¡¨é¢çš„å…¥å°„å’Œåå°„é®æŒ¡ï¼ˆGeometry Functionï¼‰ï¼Œåå°„ç‡å’Œå…¥å°„è§’çš„å…³ç³»ï¼ˆFresnelåå°„ï¼‰ã€‚]]></content>
      <tags>
        <tag>Shader</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[__index,__newindex,rawset,rawget,setmetatable]]></title>
    <url>%2F2017%2F10%2F23%2Fnewindex%2F</url>
    <content type="text"><![CDATA[__indexå¯ä»¥å½“ä½œgetæ–¹æ³•ï¼Œè·å–ä¸€ä¸ªvalueå€¼ï¼Œä¸åœ¨å½“å‰è¡¨çš„æ—¶å€™å°±ä¼šå»å…ƒè¡¨æŸ¥è¯¢ï¼Œå…ƒè¡¨é¦–å…ˆè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¦‚æœè¿™ä¸ªå‡½æ•°æ²¡æœ‰é‡å†™ï¼Œé‚£ä¹ˆç›´æ¥ä»å…ƒè¡¨ä¸­æŸ¥æ‰¾keyå¯¹åº”çš„valueï¼Œå¦‚æœå‡½æ•°è¢«é‡å†™äº†ï¼Œä»»ä½•ä»å…ƒè¡¨çš„getæ–¹æ³•éƒ½åªèµ°è¿™é‡Œï¼Œè€Œä¸ä»å…ƒè¡¨æŸ¥æ‰¾ï¼Œè§„åˆ™å¦‚ä¸‹ï¼š å¦‚æœ__indexæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™è¯»å–tableä¸å­˜åœ¨çš„å­—æ®µæ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚ å¦‚æœ__indexæ˜¯ä¸€ä¸ªtableï¼Œåˆ™è¯»å–tableä¸å­˜åœ¨çš„å­—æ®µæ—¶ï¼Œä¼šç›´æ¥è¯»å–__indexçš„tableå€¼ã€‚ __newindexå¯ä»¥å½“ä½œsetæ–¹æ³•ï¼Œè®¾ç½®ä¸€ä¸ªkey,valueå€¼ï¼Œå¦‚æœå½“å‰è¡¨æ²¡æœ‰è¿™ä¸ªå€¼ï¼Œé‚£ä¹ˆä¼šè°ƒå…ƒè¡¨ä¸­çš„__newindexæ–¹æ³•ï¼Œè§„åˆ™å¦‚ä¸‹ï¼š å¦‚æœ__newindexæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™åœ¨ç»™tableä¸å­˜åœ¨çš„å­—æ®µèµ‹å€¼æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚ å¦‚æœ__newindexæ˜¯ä¸€ä¸ªtableï¼Œåˆ™åœ¨ç»™tableä¸å­˜åœ¨çš„å­—æ®µèµ‹å€¼æ—¶ï¼Œä¼šç›´æ¥ç»™__newindexçš„tableèµ‹å€¼ã€‚ rawsetä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œç›´æ¥è®¾ç½®å½“å‰è¡¨çš„key,valueå€¼ï¼Œä¸ç®¡æ˜¯å¦æœ‰__newindexæ–¹æ³•ã€‚ rawgetä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œä»…èƒ½ä»å½“å‰è¡¨è·å–å€¼ï¼Œå³ä½¿å½“å‰è¡¨æ²¡æœ‰å€¼ï¼Œå…ƒè¡¨æœ‰å€¼ï¼Œä¹Ÿä¸ä¼šè¿”å›å…ƒè¡¨çš„å€¼ï¼Œè€Œæ˜¯è¿”å›nilã€‚ setmetatableä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥ç»™å½“å‰è¡¨è®¾ç½®ä¸€ä¸ªå…ƒè¡¨ã€‚ 12345678910111213141516local smartMan = &#123; name = "lyf", money = 900, sayHello = function() print("hello,Iâ€™m lyf"); end&#125;local t1 = &#123;&#125;local mt = &#123; __index = smartMan,&#125;setmetatable(t1, mt);t1.sayHello = function() print("en");endt1.sayHello() è¿™æ˜¯ä¸€ä¸ªæ¨¡ä»¿ç»§æ‰¿ç»“æ„çš„ä¾‹å­mtä½œä¸ºt1çš„å…ƒè¡¨,è®¾ç½®__indexä¸ºsmartManï¼Œäºæ˜¯ï¼Œå½“æˆ‘ä»¬è°ƒç”¨t1ä¸­ä¸å­˜åœ¨çš„å­—æ®µæ—¶ï¼Œå°±ä¼šè‡ªåŠ¨å»smartManä¸­æŸ¥æ‰¾ï¼Œæ¯”å¦‚æˆ‘ä»¬è°ƒç”¨äº†t1.sayHello()ï¼Œè‡ªç„¶å°±èƒ½æ‰¾åˆ°å¯¹åº”çš„å‡½æ•°ã€‚12345678910111213141516171819local smartMan = &#123; name = "none", money = 9000000, sayHello = function() print("Hello world!"); end&#125;local t1 = &#123;&#125;;local mt = &#123; __index = smartMan, __newindex = function(table, key, value) print(key .. "å­—æ®µæ˜¯ä¸å­˜åœ¨çš„ï¼Œä¸è¦è¯•å›¾ç»™å®ƒèµ‹å€¼ï¼"); end&#125;setmetatable(t1, mt);t1.sayHello = function() print("en");endt1.sayHello() ç•™æ„mtå…ƒè¡¨,æˆ‘ä»¬ç»™ä»–åŠ äº†ä¸€ä¸ª__newindexï¼Œå¯¼è‡´sayHelloå­—æ®µèµ‹å€¼å¤±è´¥ï¼Œå› ä¸ºç»™sayHelloå­—æ®µèµ‹å€¼çš„æ—¶å€™ï¼Œè°ƒç”¨äº†__indexå…ƒæ–¹æ³•ï¼Œä»£æ›¿äº†èµ‹å€¼æ“ä½œï¼Œå’Œ__indexä¸€æ ·ï¼Œ__newindexå…ƒæ–¹æ³•ä¹Ÿå¯ä»¥èµ‹å€¼ä¸€ä¸ªtableã€‚ Luaç±»å’Œç»§æ‰¿å®ç°Luaæœ¬èº«ä¸èƒ½åƒC++é‚£æ ·ç›´æ¥å®ç°ç»§æ‰¿ï¼Œä½†æ˜¯å¯ä»¥ç”¨tableæ¥å®ç°1234567Object = &#123;class_id = 0&#125;funtion Object:New(o) o = o or &#123;&#125; setmetatable(o, self) -- å¯¹è±¡oè°ƒç”¨ä¸å­˜åœ¨çš„æˆå‘˜æ—¶ä¼šå»selfä¸­æŸ¥æ‰¾ï¼Œè€Œè¿™é‡Œçš„selfæŒ‡çš„å°±æ˜¯Object self.__index = self return oend]]></content>
      <tags>
        <tag>Lua</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Cè¯­è¨€é«˜çº§éƒ¨åˆ†æ€»ç»“]]></title>
    <url>%2F2017%2F10%2F22%2Fc%2F</url>
    <content type="text"><![CDATA[å…ˆè¢«å£°æ˜ä¸ºâ€˜externâ€™ååˆè¢«å£°æ˜ä¸ºâ€˜staticâ€™In file included from src/mt_mysql_connector.cpp:14:0:/usr/include/mysql/my_global.h: åœ¨å‡½æ•°â€˜double log2(double)â€™ä¸­:/usr/include/mysql/my_global.h:823:35: é”™è¯¯ï¼šâ€˜double log2(double)â€™å…ˆè¢«å£°æ˜ä¸ºâ€˜externâ€™ååˆè¢«å£°æ˜ä¸ºâ€˜staticâ€™ [-fpermissive] static inline double log2(double x)static å£°æ˜çš„å…¨å±€å˜é‡åªèƒ½åœ¨å½“å‰æºæ–‡ä»¶ä¸­ä½¿ç”¨ã€‚externä¸æ˜¯å®šä¹‰ï¼Œæ˜¯å¼•å…¥ï¼ˆå£°æ˜ï¼‰åœ¨å…¶å®ƒæºæ–‡ä»¶ä¸­å®šä¹‰çš„éstaticå…¨å±€å˜é‡ å†…å­˜å¤§è¯é¢˜å†…å­˜å°±æ˜¯ç¨‹åºçš„ç«‹è¶³ä¹‹åœ°ï¼Œä½“ç°å†…å­˜é‡è¦æ€§ã€‚å†…å­˜ç†è§£:å†…å­˜ç‰©ç†çœ‹æ˜¯æœ‰å¾ˆå¤šä¸ªBankï¼ˆå°±æ˜¯è¡Œåˆ—çå¼çš„å­˜å‚¨èŠ¯ç‰‡ï¼‰ï¼Œæ¯ä¸€ä¸ªBankçš„åˆ—å°±æ˜¯ä½å®½ï¼Œæ¯ä¸€è¡Œå°±æ˜¯Wordsï¼Œåˆ™å­˜å‚¨å•å…ƒæ•°é‡=è¡Œæ•°ï¼ˆwordsï¼‰xåˆ—æ•°ï¼ˆä½å®½ï¼‰xBankçš„æ•°é‡ï¼›é€šå¸¸ä¹Ÿç”¨MxWçš„æ–¹å¼æ¥è¡¨ç¤ºèŠ¯ç‰‡çš„å®¹é‡ï¼ˆæˆ–è€…è¯´æ˜¯èŠ¯ç‰‡çš„è§„æ ¼/ç»„ç»‡ç»“æ„ï¼‰ã€‚Mæ˜¯ä»¥ä½å®½ä¸ºå•ä½çš„æ€»å®¹é‡ï¼Œå•ä½æ˜¯å…†ï¼ŒWä»£è¡¨ä½å®½ï¼Œå•ä½æ˜¯bitã€‚è®¡ç®—å‡ºæ¥çš„èŠ¯ç‰‡å®¹é‡ä¹Ÿæ˜¯ä»¥bitä¸ºå•ä½ï¼Œä½†ç”¨æˆ·å¯ä»¥é‡‡ç”¨é™¤ä»¥8çš„æ–¹æ³•æ¢ç®—ä¸ºå­—èŠ‚ï¼ˆByteï¼‰ã€‚æ¯”å¦‚8Mx8ï¼Œè¿™æ˜¯ä¸€ä¸ª8bitä½å®½èŠ¯ç‰‡ï¼Œæœ‰8Mä¸ªå­˜å‚¨å•å…ƒï¼Œæ€»å®¹é‡æ˜¯64Mbitï¼ˆ8MBï¼‰ã€‚ cè¯­è¨€ä¸­å…¶å®æ²¡æœ‰boolç±»å‹:ä»¥0è¡¨ç¤ºå‡ï¼Œé0è¡¨ç¤ºçœŸï¼Œåˆ™åœ¨å†…å­˜å­˜å‚¨æ˜¯ä»¥intå‹å­˜æ”¾çš„ã€‚å¦‚æœæƒ³è¦è¡¨ç¤ºçœŸå‡ï¼Œå¯ä»¥ç”¨int/charå‹åšæ›¿æ¢ï¼Œåœ¨c++ä¸­å°±æœ‰bool x=true/falseã€‚ å†…å­˜å¯¹é½:æé«˜å†…å­˜è®¿é—®æ•ˆç‡ï¼Œç¼–è¯‘å™¨ä¸€èˆ¬é»˜è®¤æ˜¯4å­—èŠ‚ char/int/short/long/float/doubleç±»å‹æ”¾åœ¨å†…å­˜çš„é•¿åº¦å’Œè§£æä½œç”¨ã€‚(int*)0ï¼Œä½¿ç”¨0åœ°å€æŒ‡å‘ä¸€ä¸ªintè¡Œã€‚åˆå¦‚0000111010101å¯ä»¥è§£ææˆintå‹ä¹Ÿå¯ä»¥è§£ææˆfloatå‹ã€‚ Linuxå†…æ ¸æ˜¯é¢å‘å¯¹è±¡çš„ï¼Œè€Œcè¯­è¨€æ˜¯é¢å‘è¿‡ç¨‹çš„ï¼Œä½†å¯ä»¥ç”¨ç»“æ„ä½“å†…åµŒæŒ‡é’ˆå˜æˆé¢å‘å¯¹è±¡ã€‚å¦‚ 1234567struct student&#123; int age; int length; char *name; void (*eat)(void); // å®ç°å¤šæ€&#125;; æ ˆçš„ç†è§£ï¼š è¿è¡Œæ—¶è‡ªåŠ¨åˆ†é…&amp;è‡ªåŠ¨å›æ”¶ï¼šæ ˆæ˜¯è‡ªåŠ¨ç®¡ç†çš„ï¼Œä»£ç æ— éœ€å¹²é¢„ã€‚ï¼ˆè¡¨ç°åœ¨æ±‡ç¼–ä»£ç ï¼Œç¼–è¯‘æ—¶ï¼Œä¼šè‡ªåŠ¨ç¼–è¯‘æˆæ±‡ç¼–å®ç°å‡½æ•°è°ƒç”¨å®Œç«‹å³æ”¹å˜æ ˆé¡¶ï¼‰ åå¤ä½¿ç”¨ï¼šæ ˆå†…å­˜åœ¨ç¨‹åºä¸­å…¶å®å°±æ˜¯é‚£ä¸€å—ç©ºé—´ï¼Œç¨‹åºåå¤ä½¿ç”¨è¿™ä¸€å—ç©ºé—´ï¼ˆç¡¬ä»¶ä¸Šæœ‰ä¸ªå¯„å­˜å™¨ï¼Œç”¨æ¥å­˜æ”¾æ ˆçš„æ ˆé¡¶åœ°å€ï¼Œæ ˆæ˜¯æœ‰å¤§å°çš„ç©ºé—´ï¼‰ è„å†…å­˜ï¼šæ ˆå†…å­˜ç”±äºåå¤ä½¿ç”¨ï¼Œæ¯æ¬¡ä½¿ç”¨åç¨‹åºä¸ä¼šå»æ¸…ç†ï¼Œå› æ­¤åˆ†é…åˆ°åŸæ¥ä¿ç•™çš„å€¼ã€‚ ä¸´æ—¶æ€§ï¼šå‡½æ•°ä¸èƒ½è¿”å›æ ˆå˜é‡çš„æŒ‡é’ˆï¼Œå› ä¸ºè¿™ä¸ªç©ºé—´æ˜¯ä¸´æ—¶çš„ã€‚ æ ˆä¼šæº¢å‡ºï¼šå› ä¸ºæ“ä½œç³»ç»Ÿäº‹å…ˆç»™å®šäº†æ ˆçš„å¤§å°ï¼Œå¦‚æœåœ¨å‡½æ•°ä¸­æ— ç©·å°½çš„åˆ†é…æ ˆå†…å­˜æ€»èƒ½ç”¨å®Œã€‚æ ˆçš„æ“ä½œæ˜¯ç”±å…·ä½“ç¡¬ä»¶å¹²é¢„çš„ï¼Œæˆ‘ä»¬åªè¦æ˜ç™½åŸç†å°±å¯ä»¥äº†ï¼Œä½†æ˜¯è¦ç»™ç›¸åº”çš„æ ˆå¯„å­˜å™¨èµ‹å€¼ã€‚å½“è°ƒç”¨å‡½æ•°æ—¶ï¼Œå˜é‡ä¼šè‡ªåŠ¨æ”¾åœ¨æ ˆä¸­ï¼ˆå…¥æ ˆï¼‰å½“å‡½æ•°è°ƒç”¨å®Œåï¼Œæ ˆä¼šè‡ªåŠ¨å‡ºæ ˆã€‚ æ ˆçš„â€œå‘å±•â€æœ‰å››ç§æƒ…å†µï¼Œæ»¡å¢æ ˆï¼Œæ»¡å‡æ ˆï¼Œç©ºå¢æ ˆï¼Œç©ºå‡æ ˆï¼Œè‡³äºæ˜¯å“ªç§è¦æ ¹æ®ç¼–è¯‘å™¨å†³å®šï¼Œè€Œs5pv32æ˜¯æ»¡å‡æ ˆã€‚ å †çš„ç†è§£ æ“ä½œç³»ç»Ÿå †ç®¡ç†å™¨ç®¡ç†ï¼Œå †ç®¡ç†å™¨æ˜¯æ“ä½œç³»ç»Ÿçš„ä¸€ä¸ªæ¨¡å—ï¼Œå †ç®¡ç†å™¨å†…å­˜åˆ†é…çµæ´»ï¼ŒæŒ‰éœ€åˆ†é…ã€‚ å¤§å—å†…å­˜ï¼šå †å†…å­˜ç®¡ç†è€…æ€»é‡å¾ˆå¤§çš„æ“ä½œç³»ç»Ÿå†…å­˜å—ï¼Œå„è¿›ç¨‹å¯ä»¥æŒ‰éœ€ç”³è¯·ä½¿ç”¨ï¼Œä½¿ç”¨å®Œé‡Šæ”¾ã€‚ è„å†…å­˜ï¼šå †å†…å­˜ä¹Ÿæ˜¯åå¤ä½¿ç”¨çš„ï¼Œè€Œä¸”ä½¿ç”¨è€…ç”¨å®Œé‡Šæ”¾å‰ä¸ä¼šæ¸…é™¤ï¼Œå› æ­¤ä¹Ÿæ˜¯è„çš„ã€‚ ä¸´æ—¶æ€§ï¼šå †å†…å­˜åªåœ¨mallocå’Œfreeä¹‹é—´å±äºå½“å‰è¿›ç¨‹ï¼Œå¯ä»¥è®¿é—®ï¼Œåœ¨mallocå’Œfreeä¹‹åéƒ½ä¸èƒ½åœ¨è®¿é—®ï¼Œå¦åˆ™ä¼šæœ‰ä¸å¯é¢„æ–™çš„åæœã€‚ ç¨‹åºæ‰‹ç”³è¯·é‡Šæ”¾]]></content>
      <tags>
        <tag>c</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[lua-select]]></title>
    <url>%2F2017%2F10%2F20%2Flua-select%2F</url>
    <content type="text"></content>
  </entry>
  <entry>
    <title><![CDATA[Lua]]></title>
    <url>%2F2017%2F10%2F20%2Flua%2F</url>
    <content type="text"><![CDATA[è®©luaç¼–è¯‘æ—¶è®¡ç®—ç”±äºluaçš„ç¼–è¯‘é€Ÿåº¦ç›¸å½“å¿«ï¼Œè€Œä¸”è¿™ç§è¿­ä»£ç¼–è¯‘çš„è¿‡ç¨‹ä»…ä»…åœ¨ç¨‹åºåŠ è½½çš„æ—¶å€™è¿›è¡Œä¸€æ¬¡ï¼Œæ•…è€Œå¯ä»¥å¸¦æ¥æ€§èƒ½çš„æé«˜ï¼›ä¸€äº›åœ¨ç³»ç»Ÿåˆå§‹åŒ–å¯ä»¥å†³å®šçš„å‚æ•°ï¼ˆæ¯”å¦‚ä»é…ç½®æ–‡ä»¶ä¸­è¯»å‡ºæ¥çš„æ•°æ®ç›´æ¥ç¼–è¯‘ä¸ºå¸¸é‡ç½®å…¥ç¨‹åºä¸­ã€‚ 1234567891011121314151617local select = selectlocal setmetatable = setmetatablelocal getfenv = getfenvlocal setfenc = setfenvlocal loadstring = loadstringlocal type = typelocal tostring = tostringlocal next = nextlocal unpack = unpacklocal assert = assertlocal string = stringlocal table = tablelocal io = iolocal function result(...) return select("#", ...), select(1, ...) -- å‚æ•°çš„ä¸ªæ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°end Luaçš„upvalueå’Œé—­åŒ…Luaå‡½æ•°å¯ä»¥è¢«å½“æˆå‚æ•°ä¼ é€’ï¼Œä¹Ÿå¯ä»¥è¢«å½“æˆç»“æœè¿”å›ï¼Œåœ¨å‡½æ•°ä½“ä¸­ä»ç„¶å¯ä»¥å®šä¹‰å†…åµŒå‡½æ•°ï¼ŒLuaé—­åŒ…æ˜¯Luaå‡½æ•°ç”Ÿæˆçš„æ•°æ®å¯¹è±¡ã€‚æ¯ä¸ªé—­åŒ…å¯ä»¥æœ‰ä¸€ä¸ªupvalueå€¼ï¼Œæˆ–è€…å¤šä¸ªé—­åŒ…å…±äº«ä¸€ä¸ªupvalueå€¼ã€‚ ä»€ä¹ˆæ˜¯JITJIT=Just In Timeå³æ—¶ç¼–è¯‘ï¼Œæ˜¯åŠ¨æ€ç¼–è¯‘çš„ä¸€ç§å½¢å¼ï¼Œæ˜¯ä¸€ç§ä¼˜åŒ–è™šæ‹Ÿæœºè¿è¡Œçš„æŠ€æœ¯ã€‚ç¨‹åºè¿è¡Œé€šå¸¸æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯é™æ€ç¼–è¯‘ï¼Œä¸€ç§æ˜¯åŠ¨æ€ç¼–è¯‘ï¼Œå³ä½¿ç¼–è¯‘æ··åˆäº†è¿™äºŒè€…ã€‚Javaå’Œ.Net/monoä¸­éƒ½ä½¿ç”¨äº†è¿™ç§æŠ€æœ¯ã€‚ç„¶è€ŒIOSä¸­ç¦æ­¢ä½¿ç”¨ï¼ˆä¸æ˜¯é’ˆå¯¹JITï¼Œè€Œæ˜¯æ‰€æœ‰çš„åŠ¨æ€ç¼–è¯‘éƒ½ä¸æ”¯æŒï¼‰ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨JITè§£é‡Šæ‰§è¡Œï¼š æ•ˆç‡ä½ ä»£ç æš´éœ² é™æ€ç¼–è¯‘ï¼š ä¸å¤Ÿçµæ´»ï¼Œæ— æ³•çƒ­æ›´æ–° å¹³å°å…¼å®¹æ€§å·®ã€‚ JITï¼š æ•ˆç‡ï¼šé«˜äºè§£é‡Šæ‰§è¡Œï¼Œä½äºé™æ€ç¼–è¯‘ã€‚ å®‰å…¨æ€§ï¼šä¸€èˆ¬éƒ½ä¼šå…ˆè½¬æ¢æˆå­—èŠ‚ç ã€‚ çƒ­æ›´æ–°ï¼šæ— è®ºæºç è¿˜æ˜¯å­—èŠ‚ç æœ¬è´¨éƒ½æ˜¯èµ„æºæ–‡ä»¶ã€‚ å…¼å®¹æ€§ï¼šè™šæ‹Ÿæœºä¼šå¤„ç†å¹³å°å·®å¼‚ï¼Œå¯¹ç”¨æˆ·é€æ˜ã€‚ JITæ˜¯å¦‚ä½•å®ç°çš„è¿™é‡Œè®²çš„å®é™…ä¸Šæ˜¯JITçš„ä¸€ä¸ªå˜ç§ï¼šè‡ªé€‚åº”åŠ¨æ€ç¼–è¯‘(adaptive dynamic compilation)ã€‚å®ƒåˆ†ä¸ºä¸¤ç§ï¼šMethod JITå’ŒTrace JITã€‚ç®€å•æ¥è®²ï¼š è·Ÿè¸ªçƒ­ç‚¹å‡½æ•°æˆ–traceï¼Œç¼–è¯‘æˆæœºå™¨ç æ‰§è¡Œï¼Œå¹¶ç¼“å­˜èµ·æ¥ä¾›ä»¥åä½¿ç”¨ã€‚ éçƒ­ç‚¹å‡½æ•°è§£é‡Šæ‰§è¡Œã€‚ ä¸ºä»€ä¹ˆåªç¼–è¯‘çƒ­ç‚¹å‡½æ•°ï¼Ÿå¯¹åªæ‰§è¡Œä¸€æ¬¡çš„ä»£ç è€Œè¨€ï¼Œè§£é‡Šæ‰§è¡Œå…¶å®æ€»æ˜¯æ¯”JITç¼–è¯‘è¦å¿«ã€‚å¯¹è¿™äº›ä»£ç åšJITç¼–è¯‘åœ¨æ‰§è¡Œï¼Œå¯ä»¥è¯´æ˜¯å¾—è¡¥å¿å¼ã€‚è€Œå¯¹äºåªæ‰§è¡Œå°‘é‡æ¬¡æ•°çš„ä»£ç ï¼ŒJITç¼–è¯‘å¸¦æ¥çš„æ‰§è¡Œé€Ÿåº¦çš„æå‡ä¹Ÿæœªå¿…å¿…èƒ½æŠµæ¶ˆæ‰æœ€åˆç¼–è¯‘å¸¦æ¥çš„å¼€é”€ã€‚åªæœ‰å¯¹é¢‘ç¹æ‰§è¡Œçš„ä»£ç ï¼ŒJITç¼–è¯‘æ‰èƒ½ä¿è¯æœ‰æ­£é¢çš„æ”¶ç›Šã€‚ Luaå…ƒç´ (Metatable)1.å®šä¹‰ç®—æœ¯æ“ä½œç¬¦å’Œå…³ç³»æ“ä½œç¬¦çš„è¡Œä¸º + __add * __mul - __sub / __div - __unm(for negation) è‡ªå‡ % __mod ^ __pow å…³ç³»æ“ä½œç¬¦ == __eq &lt; __lt &lt;= __le å½“æˆ‘ä»¬è®¿é—®æŸä¸ªä¸å­˜åœ¨çš„å­—æ®µçš„æ—¶å€™ï¼Œå°±ä¼šè°ƒç”¨__indexå…ƒæ–¹æ³•ã€‚ æºæ–‡ä»¶åˆ’åˆ†1.è™šæ‹Ÿæœºè¿è½¬æ ¸å¿ƒåŠŸèƒ½|æºæ–‡ä»¶å |åŠŸèƒ½ |å‰ç¼€||â€”â€”â€”â€”â€”â€”â€”:|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”:|â€”-:||lapi.c |Cè¯­è¨€æ¥å£ |luaC||lctype.c |Cæ ‡å‡†åº“ä¸­ctypeç›¸å…³å®ç° |||ldebug.c |Debug æ¥å£ |||ldo.c |å‡½æ•°è°ƒç”¨ä»¥åŠæ ˆç®¡ç† |luaD||lfunc.c |å‡½æ•°åŸå‹åŠé—­åŒ…ç®¡ç† |||lgc.c |åƒåœ¾å›æ”¶ |||lmem.c |å†…å­˜ç®¡ç†æ¥å£ |||lobject.c |å¯¹è±¡æ“ä½œçš„ä¸€äº›å‡½æ•° |||lopcodes.c |è™šæ‹Ÿæœºçš„å­—èŠ‚ç å®šä¹‰ |||lstate.c |å…¨å±€çŠ¶æ€æœº |||lstring.c |å­—ç¬¦ä¸²æ±  |||ltable.c |è¡¨ç±»å‹çš„ç›¸å…³æ“ä½œ |luaH||ltm.c |å…ƒæ–¹æ³• |||lvm.c |è™šæ‹Ÿæœº |||lzio.c |è¾“å…¥æµæ¥å£ |luaZ| 2.æºä»£ç è§£æä»¥åŠé¢„ç¼–è¯‘å­—èŠ‚ç |æºæ–‡ä»¶å |åŠŸèƒ½ |å‰ç¼€||â€”â€”â€”â€”â€”â€”â€”:|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”:|â€”-:||lcode.c |ä»£ç ç”Ÿæˆå™¨|||ldump.c |åºåˆ—åŒ–é¢„ç¼–è¯‘çš„Luaå­—èŠ‚ç |||llex.c |è¯æ³•åˆ†æå™¨|||lparser.c |è§£æå™¨|||lundump.c |è¿˜åŸé¢„ç¼–è¯‘çš„å­—èŠ‚ç || 3.å†…åµŒåº“|æºæ–‡ä»¶å |åŠŸèƒ½ |å‰ç¼€||â€”â€”â€”â€”â€”â€”â€”:|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”:|â€”-:||lauxlib.c |åº“ç¼–å†™ç”¨åˆ°çš„è¾…åŠ©å‡½æ•°åº“|||lbaselib.c |åŸºç¡€åº“|||lbitlib.c |ä½æ“ä½œåº“|||ldblib.c |Debugåº“|||lini.c | å†…åµŒåº“çš„åˆå§‹åŒ–|||liolib.c |IOåº“|||lstrlib.c |å­—ç¬¦ä¸²åº“|||ltablib.c |è¡¨å¤„ç†åº“|| 4.å¯æ‰§è¡Œçš„è§£æå™¨ï¼Œå­—èŠ‚ç ç¼–è¯‘å™¨|æºæ–‡ä»¶å |åŠŸèƒ½ |å‰ç¼€||â€”â€”â€”â€”â€”â€”â€”:|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”:|â€”-:||lua.c |è§£é‡Šå™¨|||luac.c |å­—èŠ‚ç ç¼–è¯‘å™¨|| Luaæ ¸å¿ƒLuaæ ¸å¿ƒéƒ¨åˆ†ä»…åŒ…æ‹¬Luaè™šæ‹Ÿæœºçš„è¿è½¬ã€‚Luaè™šæ‹Ÿæœºçš„è¡Œä¸ºæ˜¯ç”±ä¸€ç»„ç»„opcodeæ§åˆ¶çš„ã€‚è¿™äº›opcodeå®šä¹‰åœ¨lopcodes.håŠlopcodes.cä¸­ã€‚è€Œè™šæ‹Ÿæœºå¯¹opcodeçš„è§£æå’Œè¿ä½œåœ¨lvm.cä¸­ï¼Œå…¶APIä»¥luaVä¸ºå‰ç¼€ã€‚ Luaè™šæ‹Ÿæœºçš„å¤–åœ¨æ•°æ®å½¢å¼æ˜¯ä¸€ä¸ªlua_Stateç»“æ„ä½“ï¼Œå–åStateå¤§æ¦‚æ„ä¸ºLuaè™šæ‹Ÿæœºçš„å½“å‰çŠ¶æ€ã€‚å…¨å±€Stateå¼•ç”¨äº†æ•´ä¸ªè™šæ‹Ÿæœºçš„æ‰€æœ‰æ•°æ®ã€‚è¿™ä¸ªå…¨å±€Stateçš„ç›¸å…³ä»£ç æ”¾åœ¨lstate.cä¸­ï¼ŒAPIä½¿ç”¨luaEä¸ºå‰ç¼€ã€‚ å‡½æ•°çš„è¿è¡Œæµç¨‹ï¼šå‡½æ•°è°ƒç”¨åŠè¿”å›åˆ™æ”¾åœ¨ldo.cä¸­ï¼Œç›¸å…³APIä»¥luaDä¸ºå‰ç¼€ã€‚ Luaä¸­æœ€å¤æ‚å’Œé‡è¦çš„ä¸‰ç§æ•°æ®ç±»å‹functionã€tableã€stringçš„å®ç°åˆ†å±åœ¨lfunc.cã€ltable.cã€lstring.cä¸­ã€‚è¿™ä¸‰ç»„å†…éƒ¨APIåˆ†åˆ«ä»¥luaFã€luaHã€luaSä¸ºå‰ç¼€å‘½åã€‚ä¸åŒçš„æ•°æ®ç±»å‹æœ€ç»ˆå‘—ç»Ÿä¸€å®šä¹‰ä¸ºLuaObjectï¼Œç›¸å…³æ“ä½œåœ¨lobject.cä¸­ï¼ŒAPIä»¥luaOä¸ºå‰ç¼€ã€‚ Luaä»ç¬¬äº”ç‰ˆåå¢åŠ äº†å…ƒè¡¨ï¼Œå…ƒè¡¨çš„å¤„ç†åœ¨ltm.cä¸­ï¼ŒAPIä»¥luaTä¸ºå‰ç¼€ã€‚ å¦å¤–ï¼Œæ ¸å¿ƒç³»ç»Ÿè¿˜ç”¨åˆ°ä¸¤ä¸ªåŸºç¡€è®¾æ–½ï¼šå†…å­˜ç®¡ç†lmem.cï¼ŒAPIä»¥luaMä¸ºå‰ç¼€ï¼›å¸¦ç¼“å­˜çš„æµå¤„ç†lzio.cï¼ŒAPIä»¥luaZä¸ºå‰ç¼€ã€‚ æœ€åæ˜¯æ ¸å¿ƒç³»ç»Ÿé‡Œæœ€ä¸ºå¤æ‚çš„éƒ¨åˆ†ï¼Œåƒåœ¾å›æ”¶éƒ¨åˆ†ï¼Œåœ¨lgc.cä¸­å®ç°ï¼ŒAPIä»¥luaCä¸ºå‰ç¼€ã€‚ Luaè®¾è®¡çš„åˆè¡·ä¹‹ä¸€å°±ä¸ºäº†æœ€å¥½çš„å’Œå®¿ä¸»ç³»ç»Ÿç›¸ç»“åˆã€‚å®ƒæ˜¯ä¸€é—¨åµŒå…¥å¼è¯­è¨€ï¼Œæ‰€ä»¥å¿…é¡»æä¾›å’Œå®¿ä¸»ç³»ç»Ÿäº¤äº’APIã€‚è¿™äº›APIä»¥Cå‡½æ•°çš„å½¢å¼æä¾›ï¼Œå¤§å¤šæ•°å®ç°åœ¨lapi.cä¸­ã€‚APIç›´æ¥ä»¥luaä¸ºå‰ç¼€ï¼Œå¯ä¾›Cç¼–å†™çš„ç¨‹åºåº“ç›´æ¥è°ƒç”¨ã€‚ ä»£ç ç¿»è¯‘åŠé¢„ç¼–è¯‘å­—èŠ‚ç å…‰æœ‰æ ¸å¿ƒä»£ç å’Œä¸€ä¸ªè™šæ‹Ÿæœºè¿˜æ— æ³•è®©Luaç¨‹åºè¿è¡Œèµ·æ¥ã€‚å› ä¸ºå¿…é¡»ä»å¤–éƒ¨è¾“å…¥å°†Luaè¿è¡Œèµ·æ¥ã€‚Luaçš„è„šæœ¬éœ€è¦ç»è¿‡è§£æå¾—åˆ°å†…éƒ¨çš„æ•°æ®ç»“æ„ï¼ˆå¸¸é‡å’Œopcodeçš„é›†åˆï¼‰ã€‚è¿™ä¸ªæ˜¯ç”¨parser:lparser.c ï¼ˆluaY:è¯­æ³•è§£æ)åŠè¯æ³•åˆ†ællex.c(luaX) è§£æå®Œè„šæœ¬ä»£ç ï¼Œè¿˜éœ€è¦æœ€ç»ˆç”Ÿæˆcodeç ï¼Œåœ¨lcode.cä¸­å®ç°ã€‚luaK ä¸ºäº†æ»¡è¶³æŸäº›éœ€æ±‚ï¼ŒåŠ å¿«ä»£ç ç¿»è¯‘çš„æµç¨‹ã€‚è¿˜å¯ä»¥é‡‡ç”¨é¢„ç¼–è¯‘çš„è¿‡ç¨‹ã€‚æŠŠè¿è¡Œæ—¶ç¼–è¯‘çš„ç»“æœï¼Œç”Ÿæˆä¸ºå­—èŠ‚ç ã€‚è¿™ä¸ªè¿‡ç¨‹ä»¥åŠé€†è¿‡ç¨‹ç”±ldump.cå’Œlundump.cå®ç°ã€‚luaU å†…åµŒåº“ä½œä¸ºåµŒå…¥å¼è¯­è¨€ï¼Œå…¶å®å®Œå…¨å¯ä»¥ä¸æä¾›ä»»ä½•åº“åŠå‡½æ•°ã€‚å…¨éƒ¨ç”±å®¿ä¸»ç³»ç»Ÿæ³¨å…¥åˆ°Stateä¸­å³å¯ã€‚ä¹Ÿçš„ç¡®æœ‰è®¸å¤šç³»ç»Ÿæ˜¯è¿™ä¹ˆç”¨çš„ã€‚ä½†Luaçš„å®˜æ–¹ç‰ˆæœ¬è¿˜æ˜¯æä¾›äº†å°‘é‡å¿…è¦çš„åº“ã€‚å°¤å…¶æ˜¯ä¸€äº›åŸºç¡€å‡½æ•°parisã€errorã€setmetatableã€typeç­‰ç­‰ï¼Œå®Œæˆäº†è¯­è¨€çš„ä¸€äº›åŸºæœ¬ç‰¹æ€§ï¼Œå‡ ä¹å¾ˆéš¾ä¸ä½¿ç”¨ã€‚ è€Œcoroutineã€stringã€tableã€mathç­‰ç­‰åº“ï¼Œä¹Ÿå¾ˆå¸¸ç”¨ã€‚Luaæä¾›äº†ä¸€å¥—ç®€æ´çš„æ–¹æ¡ˆï¼Œå…è®¸ä½ è‡ªç”±åŠ è½½ä½ éœ€è¦çš„éƒ¨åˆ†ï¼Œä»¥æ§åˆ¶æœ€ç»ˆæ‰§è¡Œæ–‡ä»¶çš„ä½“ç§¯å’Œå†…å­˜çš„å ç”¨é‡ã€‚ä¸»åŠ¨åŠ è½½è¿™äº›å†…å»ºåº“è¿›å…¥lua_Stateï¼Œæ˜¯ç”±åœ¨lualib.hä¸­çš„APIå®ç°çš„ã€‚ 1234567891011121314static TValue *index2addr (lua_State *L, int idx) &#123; CallInfo *ci = L-&gt;ci; if (idx &gt; 0) &#123; TValue *o = ci-&gt;func + idx; api_check(L, idx &lt;= ci-&gt;top - (ci-&gt;func + 1), "unacceptable index"); if (o &gt;= L-&gt;top) return NONVALIDVALUE; else return o; &#125; else if (!ispseudo(idx)) &#123; /* nagative index */ api_check(L, idx != 0 &amp;&amp; -idx &lt;= L-&gt;top - (ci-&gt;func + 1), "invalid index"); return L-&gt;top + idx; &#125; ...&#125; 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465public class LuaMgr&#123; public static Module GetModule(string name) &#123; Module m = m_modules.PG_TryGetValue(name); if (m == null) &#123; ... &#125; // repeat if (m.m_state != Module.State.None) &#123; if (m.m_state == Module.State.Failed) return null; return m; &#125; var L = m_L;//lua_State string[] names = name.Split(m_dotSep); // mulit file LuaDLL.lua_pushvalue(L, LuaIndexes.LUA_GLOBALSINDEX); // 0 for (int i = 0; i &lt; names.Length; ++ i) &#123; LuaDLL.lua_pushstring(L, names[i]); LuaDLL.lua_rawget(L, -2); // var t = LuaDLL.lua_type(L, -1); // 1 switch (t) &#123; case LuaTypes.LUA_TNIL: LuaDLL.lua_pop(L, 1); luaDLL.lua_newtable(L); luaDLL.lua_pushstring(L, names[i]); luaDLL.lua_pushvalue(L, -2); LuaDLL.lua_rawset(L, -4); // _G.name = module LuaDLL.lua_rawgeti(L, LuaIndexes.LUA_REGISTRYINDEX, m_ref_globalMeta); LuaDLL.lua_setmetatable(L, -2); LuaDLL.lua_pushvalue(L, -1); LuaDLL.lua_setfield(L, -2, "_M"); // module._M = module break; case LuaTypes.LUA_TTABLE: break; default: m.m_state = Module.State.Failed; LuaDLL.lua_pop(L, 2); return null; &#125; LuaDLL.lua_remove(L, -2); &#125; m.m_index = ++m_moduleIndex; m.m_ref_module = LuaDLL.luaL_ref(L, luaIndexes.LUA_REGISTRYINDEX); ReloadModule(m); return m; &#125;&#125;public static int LoadModule()&#123; var L = LuaMgr.m_L; string name = LuaDLL.lua_tosting(L, 1); var m = LuaMgr.GetModule(name); LuaDLL.lua_pushboolean(L, m != null); return 1;&#125; é˜…è¯»æºä»£ç çš„æ¬¡åºé¦–å…ˆã€é˜…è¯»å¤–å›´çš„åº“æ˜¯å¦‚ä½•å®ç°åŠŸèƒ½æ‰©å±•çš„ï¼Œè¿™æ ·å¯ä»¥ç†Ÿæ‚‰Luaå…¬å¼€APIï¼Œä¸å¿…é™·å…¥åŠŸèƒ½ç»†èŠ‚ã€‚ç„¶åã€é˜…è¯»APIçš„å…·ä½“å®ç°ã€‚Luaå¯¹å¤–æš´éœ²çš„APIå¯ä»¥è¯´æ˜¯ä¸€ä¸ªå¯¹å†…éƒ¨æ¨¡å—çš„ä¸€å±‚å°è£…ï¼Œè¿™ä¸ªå±‚æ¬¡å°šæœªè§¦åŠæ ¸å¿ƒï¼Œä½†å¯ä»¥å¯¹æ ¸å¿ƒä»£ç æœ‰ä¸ªåˆæ­¥çš„äº†è§£ã€‚ä¹‹åã€å¯ä»¥å¼€å§‹äº†è§£Lua VMçš„å®ç°ã€‚æ¥ä¸‹æ¥å°±æ˜¯åˆ†åˆ«ç†è§£å‡½æ•°è°ƒç”¨ã€è¿”å›ï¼Œstring,table,metatableç­‰å¦‚ä½•å®ç°ã€‚debugæ¨¡å—æ˜¯ä¸€ä¸ªé¢å¤–çš„è®¾æ–½ï¼Œä½†å¯ä»¥å¸®åŠ©ä½ ç†è§£Luaå†…éƒ¨ç»†èŠ‚ã€‚æœ€åæ˜¯parserç­‰ç¼–è¯‘ç›¸å…³çš„éƒ¨åˆ†ã€‚åƒåœ¾å›æ”¶æ˜¯æœ€éš¾çš„éƒ¨åˆ†ï¼Œå¯èƒ½ä¼šèŠ±æ‰æœ€å¤šçš„æ—¶é—´å»ç†è§£ç»†èŠ‚ã€‚ Luaæ¨¡å—ä¸åŒ…æ¨¡å—ç±»ä¼¼äºä¸€ä¸ªå°è£…åº“ï¼Œä»Lua5.1å¼€å§‹ï¼ŒLuaåŠ å…¥äº†æ ‡å‡†çš„æ¨¡å—ç®¡ç†æœºåˆ¶ï¼Œå¯ä»¥æŠŠä¸€äº›å…¬ç”¨çš„ä»£ç æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œä»¥APIæ¥å£çš„å½¢å¼åœ¨å…¶ä»–åœ°æ–¹è°ƒç”¨ï¼Œæœ‰åˆ©äºä»£ç çš„é‡ç”¨å’Œé™ä½ä»£ç è€¦åˆåº¦ã€‚Luaçš„æ¨¡å—æ˜¯ç”±å˜é‡ã€å‡½æ•°ç­‰å·²çŸ¥å…ƒç´ ç»„æˆçš„tableï¼Œå› æ­¤åˆ›å»ºä¸€ä¸ªæ¨¡å—å¾ˆç®€å•ï¼Œå°±æ˜¯åˆ›å»ºä¸€ä¸ªtableï¼Œç„¶åæŠŠéœ€è¦å¯¼å‡ºçš„å¸¸é‡ã€å‡½æ•°æ”¾å…¥å…¶ä¸­ï¼Œæœ€åè¿”å›è¿™ä¸ªtableå°±è¡Œã€‚ä»¥ä¸‹ä¸ºåˆ›å»ºè‡ªå®šä¹‰æ¨¡å—module.luaï¼Œæ–‡ä»¶ä»£ç æ ¼å¼å¦‚ä¸‹ï¼š1234567891011121314151617-- æ–‡ä»¶åmodule.lua-- å®šä¹‰ä¸€ä¸ªåä¸ºmoduleçš„æ¨¡å—module = &#123;&#125;-- å®šä¹‰ä¸€ä¸ªå¸¸é‡module.constant = "è¿™æ˜¯ä¸€ä¸ªå¸¸é‡"-- å®šä¹‰ä¸€ä¸ªå‡½æ•°function module.func1() io.write("è¿™æ˜¯ä¸€ä¸ªå…¬æœ‰å‡½æ•°ï¼\n")endlocal function func2() print("è¿™æ˜¯ä¸€ä¸ªç§æœ‰å‡½æ•°ï¼")endfunction module.func3() func2()endreturn module ç”±ä¸Šå¯çŸ¥ï¼Œæ¨¡å—çš„ç»“æ„å°±æ˜¯ä¸€ä¸ªtableçš„ç»“æ„ï¼Œå› æ­¤å¯ä»¥åƒæ“ä½œtableé‡Œçš„å…ƒç´ é‚£æ ·æ¥æ“ä½œè°ƒç”¨æ¨¡å—é‡Œçš„å¸¸é‡æˆ–å‡½æ•°ã€‚ä¸Šé¢çš„funcå£°æ˜ä¸ºç¨‹åºå—çš„å±€éƒ¨å˜é‡ï¼Œå³è¡¨ç¤ºä¸€ä¸ªç§æœ‰å‡½æ•°ï¼Œå› æ­¤æ˜¯ä¸èƒ½ä»å¤–éƒ¨è®¿é—®æ¨¡å—é‡Œçš„è¿™ä¸ªç§æœ‰å‡½æ•°ï¼Œå¿…é¡»é€šè¿‡æ¨¡å—çš„å…¬æœ‰å‡½æ•°æ¥è°ƒç”¨ã€‚ require å‡½æ•°Luaæä¾›äº†ä¸€ä¸ªåä¸ºrequireçš„å‡½æ•°ç”¨æ¥åŠ è½½æ¨¡å—ã€‚è¦åŠ è½½ä¸€ä¸ªæ¨¡å—ï¼Œåªéœ€è¦ç®€å•åœ°è°ƒç”¨å°±å¯ä»¥äº†ã€‚ä¾‹å¦‚ï¼š require(&quot;&lt;æ¨¡å—å&gt;&quot;) æˆ–è€… require &quot;&lt;æ¨¡å—å&gt;&quot; æ‰§è¡Œrequireåä¼šè¿”å›ä¸€ä¸ªç”±æ¨¡å—å¸¸é‡æˆ–å‡½æ•°ç»„æˆçš„tableï¼Œå¹¶ä¸”è¿˜ä¼šå®šä¹‰ä¸€ä¸ªåŒ…å«è¯¥tableçš„å…¨å±€å˜é‡ã€‚ åŠ è½½æœºåˆ¶å¯¹äºè‡ªå®šä¹‰çš„æ¨¡å—ï¼Œæ¨¡å—æ–‡ä»¶ä¸æ˜¯æ”¾åœ¨å“ªä¸ªç›®å½•éƒ½è¡Œï¼Œå‡½æ•°requireæœ‰å®ƒè‡ªå·±çš„æ–‡ä»¶è·¯åŠ²åŠ è½½ç­–ç•¥ï¼Œå®ƒä¼šå°è¯•ä»Luaæ–‡ä»¶æˆ–Cç¨‹åºåº“ä¸­åŠ è½½æ¨¡å—ã€‚requireç”¨äºæœç´¢Luaæ–‡ä»¶çš„è·¯å¾„æ˜¯å­˜æ”¾åœ¨å…¨å±€å˜é‡package.pathä¸­ï¼Œå½“Luaå¯åŠ¨åï¼Œä¼šä»¥ç¯å¢ƒå˜é‡LUA_PATHçš„å€¼æ¥åˆå§‹è¿™ä¸ªç¯å¢ƒå˜é‡ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°è¯¥ç¯å¢ƒå˜é‡ï¼Œåˆ™ä½¿ç”¨ä¸€ä¸ªç¼–è¯‘æ—¶å®šä¹‰çš„é»˜è®¤è·¯å¾„æ¥åˆå§‹åŒ–ã€‚å½“å‰ç›®å½•ä¹Ÿä¼šåŠ è½½]]></content>
      <tags>
        <tag>Lua</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[expect]]></title>
    <url>%2F2017%2F10%2F19%2Fexpect%2F</url>
    <content type="text"><![CDATA[å®‰è£… yum install -y tcl tclx tcl-develExpectæ˜¯ä¸€ä¸ªå…è´¹çš„å…è´¹çš„ç¼–ç¨‹å·¥å…·è¯­è¨€ï¼Œç”¨æ¥å®ç°è‡ªåŠ¨å’Œäº¤äº’ä»»åŠ¡è¿›è¡Œé€šä¿¡ï¼Œè€Œæ— éœ€äººçš„å¹²é¢„ã€‚expectæ˜¯äº¤äº’æ€§å¾ˆå¼ºçš„è„šæœ¬è¯­è¨€ï¼Œå¯ä»¥å¸®åŠ©è¿ç»´äººå‘˜å®ç°æ‰¹é‡ç®¡ç†æˆåƒä¸Šç™¾å°æœåŠ¡å™¨æ“ä½œï¼Œæ˜¯ä¸€æ¬¾å¾ˆå®ç”¨çš„æ‰¹é‡éƒ¨ç½²å·¥å…·ï¼ä¸‹è½½ï¼šexpect-5.43.0.tarå’Œtcl8.4.11-src.tar]]></content>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ“ä½œè®°å½•]]></title>
    <url>%2F2017%2F10%2F19%2Fserver%2F</url>
    <content type="text"><![CDATA[pwd: ~/work_codemkdbg_allvim src/ini/Jenkins_Script/compile.sh IN DIR:BNMSGamePlay, make all with Makefile_debug.mk all 115 make[3]: è¿›å…¥ç›®å½•â€œ/root/work_code/src/svr/BNMSGamePlayâ€116 ==== making DLL file â€¦ ====117 g++ -DLINUX -D_FILE_OFFSET_BITS=64 -D_LARGEFILE64_SOURCE -D_LARGEFILE_SOURCE -Wall -Wno-multichar -g -D_DEBUG -DPG_MEMORY_DISABLE_POOL -march=core2 -m32 -rdynamic -std=c++0x -o ../../bin/debug/svr/BNMSGamePlay/BNMSGamePlay_d.so ../../temp/debug/svr/BNMSGamePlay/BNMSGamePlay.s.o_d /root/work_code/src/lib/libBNMSGamePlay_Lib_d.s.a /root/work_code/src/lib/lib PNGS_d.s.a /root/work_code/src/lib/libWHNET_d.s.a /root/work_code/src/lib/libWHCMN_d.s.a -lpthread -ldl -lrt -march=prescott -shared -L/root/work_code/3rd/lib -L/root/work_code/src/lib118 /usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-redhat-linux/4.8.5/libstdc++.so when searching for -lstdc++119 /usr/bin/ld: cannot find -lstdc++120 /usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-redhat-linux/4.8.5/libgcc_s.so when searching for -lgcc_s121 /usr/bin/ld: cannot find -lgcc_s122 collect2: é”™è¯¯ï¼šld è¿”å› 1123 make[3]: * [../../bin/debug/svr/BNMSGamePlay/BNMSGamePlay_d.so] é”™è¯¯ 1124 make[3]: ç¦»å¼€ç›®å½•â€œ/root/work_code/src/svr/BNMSGamePlayâ€ 1ldconfig #æ›´æ–°ç¼“å†² g++ -DLINUX -D_FILE_OFFSET_BITS=64 -D_LARGEFILE64_SOURCE -D_LARGEFILE_SOURCE -Wall -Wno-multichar -g -D_DEBUG -DPG_MEMORY_DISABLE_POOL -march=core2 -m32 -rdynamic -std=c++0x -o ../../bin/debug/xxsy/ScnSvr_AllInOne/ScnSvr_AllInOne_d ../../temp/debug/xxsy/ScnSvr_AllInOne/ScnSvr_AllInOne.o_d /root/work_code/src/lib/libGSDB_Lib_d.a /root/work_code/src/lib/li bScnSvr_d.a /root/work_code/src/lib/libGZSGamePlay_Lib_d.a /root/work_code/src/lib/libMCE4Chat_d.a /root/work_code/src/lib/libMCE_d.a /root/work_code/src/lib/libDIA4DBI_d.a /root/work_code/src/lib/libDIA_d.a /root/work_code/src/lib/libPNGS_d.a /root/work_code/src/lib/libWHNET_d.a /root/work_code/src/lib/libWHCMN_d.a /root/work_code/src/lib/libxxsy_cmn_d.a /root/work_code/src/lib/libpgcmn_d.a -lpathfind_d -lcJSON_d -lcryptlib_d -llua_d -lzlib_d -ltss_sdk_d -lz -ldl -lssl -lpthread -ldl -lrt -march=prescott -L/root/work_code/3rd/lib -L/root/work_code/src/libg++ -DLINUX -D_FILE_OFFSET_BITS=64 -D_LARGEFILE64_SOURCE -D_LARGEFILE_SOURCE -Wall -Wno-multichar -g -D_DEBUG -DPG_MEMORY_DISABLE_POOL -march=core2 -m32 -rdynamic -std=c++0x -o ../../bin/debug/xxsy/ScnSvr_AllInOne/ScnSvr_AllInOne_d ../../temp/debug/xxsy/ScnSvr_AllInOne/ScnSvr_AllInOne.o_d /root/work_code/src/lib/libGSDB_Lib_d.a /root/work_code/src/lib/libScnSvr_d.a /root/work_code/src/lib/libGZSGamePlay_Lib_d.a /root/work_code/src/lib/libMCE4Chat_d.a /root/work_code/src/lib/libMCE_d.a /root/work_code/src/lib/libDIA4DBI_d.a /root/work_code/src/lib/libDIA_d.a /root/work_code/src/lib/libPNGS_d.a /root/work_code/src/lib/libWHNET_d.a /root/work_code/src/lib/libWHCMN_d.a /root/work_code/src/lib/libxxsy_cmn_d.a /root/work_code/src/lib/libpgcmn_d.a -lpathfind_d -lcJSON_d -lcryptlib_d -llua_d -lzlib_d -ltss_sdk_d -lz -ldl -lssl -lpthread -ldl -lrt -march=prescott -L/root/work_code/3rd/lib -L/root/work_code/src/lib -pthread/root/work_code/3rd/lib/liblua_d.a(core_profiler.o_d)ï¼šåœ¨å‡½æ•°â€˜lprofP_init_core_profilerâ€™ä¸­ï¼š/root/work_code/3rd/lua/profiler/core_profiler.c:154: è­¦å‘Šï¼šthe use of tmpnam&#39; is dangerous, better usemkstempâ€™/usr/bin/ld: /root/work_code/src/lib/libScnSvr_d.a(RegScn.o_d): undefined reference to symbol â€˜EVP_sha256@@libcrypto.so.10â€™/lib/libcrypto.so.10: error adding symbols: DSO missing from command line]]></content>
      <tags>
        <tag>server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[VMware12ä¸­CentOS7ç½‘ç»œè®¾ç½®]]></title>
    <url>%2F2017%2F10%2F18%2FVm%2F</url>
    <content type="text"><![CDATA[VMwareæä¾›äº†ä¸‰ç§å°†è™šæ‹Ÿç½‘å¡å’Œç‰©ç†ç½‘å¡æ†ç»‘èµ·æ¥çš„æ–¹å¼ï¼Œå³æ¡¥æ¥(Bridgeï¼‰æ¨¡å¼ï¼Œç½‘ç»œåœ°å€è½¬æ¢(Network Address Transformation, NAT)æ¨¡å¼å’Œä¸»æœº(Host Only)æ¨¡å¼ã€‚ä¸‰ç§æ¨¡å¼åŒºåˆ«ï¼Œå‚è§å…³äºä¸‰ç§æ¨¡å¼çš„åŒºåˆ«ï¼Œç®€å•è€Œè¨€ï¼ŒBridgeæ¨¡å¼ç›´æ¥å°†è™šæ‹Ÿæœºæ·»åŠ åˆ°å±€åŸŸç½‘ä¸­ï¼Œä½¿è™šæ‹Ÿæœºçœ‹èµ·æ¥åƒç½‘å†…çš„ä¸€å°çœŸå®è®¡ç®—æœºï¼Œè™šæ‹Ÿç½‘å¡å’Œå®¿ä¸»ç‰©ç†ç½‘å¡ä¹‹é—´ä¸å­˜åœ¨åä¹‰ä¸Šçš„ä»å±å…³ç³»ï¼Œå› è€Œéœ€è¦å±€åŸŸç½‘å†…å…·æœ‰å¤šä½™çš„IPåœ°å€èƒ½å¤Ÿæä¾›ç»™è™šæ‹Ÿæœºç½‘å¡ï¼Œå¦‚æœå±€åŸŸç½‘å†…ä¸¥æ ¼ç»™æ¯å°è®¡ç®—æœºåˆ†é…å›ºå®šçš„IPï¼Œé‚£è¿™ç§Bridgeæ¨¡å¼å°±åŸºæœ¬å¤±æ•ˆã€‚åœ¨Bridgeæ¨¡å¼ä¸‹è™šæ‹Ÿæœºæ—¢å¯ä»¥è®¿é—®åˆ°Internetä¹Ÿå¯ä»¥åŒå±€åŸŸç½‘å†…çš„å…¶ä»–çœŸå®è®¡ç®—æœºé€šä¿¡ï¼›NATæ¨¡å¼ä¸‹å®¿ä¸»çš„ç‰©ç†ç½‘å¡å°±å……å½“äº†è·¯ç”±å™¨æˆ–äº¤æ¢æœºçš„è§’è‰²ï¼Œè¿™æ—¶VMwareä¼šæ ¹æ®å®¿ä¸»çš„çœŸå®IPæä¾›å¾ˆå¤šSubset IPä¾›è™šæ‹Ÿæœºä½¿ç”¨ï¼Œè¿™æ ·æ‰€æœ‰çš„è™šæ‹Ÿæœºéƒ½æ˜¯é€šè¿‡å®¿ä¸»çš„ç½‘ç»œç«¯å£è¿›è¡Œå¯¹Internetçš„è®¿é—®ï¼Œä½†çœ‹èµ·æ¥è¿™äº›è™šæ‹Ÿè®¡ç®—æœºéƒ½åˆæ³•åœ°è®¿é—®åˆ°äº†å±€åŸŸç½‘æˆ–è€…Internetï¼Œå› ä¸ºä»–ä»¬çš„IPåœ°å€é€šè¿‡NATæŠ€æœ¯ä¹‹åçœ‹èµ·æ¥æ˜¯åˆæ³•çš„ã€‚Host Onlyæ¨¡å¼ä¸‹è™šæ‹Ÿæœºä¹‹é—´å¯ä»¥ç›¸äº’é€šä¿¡ï¼Œä½†è™šæ‹Ÿæœºå¹¶ä¸èƒ½åŒå±€åŸŸç½‘å†…çš„å…¶ä»–çœŸå®è®¡ç®—æœºç›´æ¥é€šä¿¡ï¼Œä½†è¯¥æ¨¡å¼ä¸‹é€šè¿‡å®¿ä¸»è®¿é—®Internetè¿˜æ˜¯å¯ä»¥çš„ã€‚VMçš„è™šæ‹Ÿç½‘å¡å¯ä»¥è¢«è®¾ç½®æˆä¸Šè¿°çš„ä¸‰ç§ç½‘ç»œè¿æ¥æ¨¡å¼ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒVMnet0è¢«è®¾ç½®æˆä¸ºBridgeæ¨¡å¼ï¼ŒVMnet1è¢«è®¾ç½®ä¸ºHost Onlyæ¨¡å¼ï¼Œè€ŒVMnet8çš„é»˜è®¤è¿æ¥æ–¹å¼ä¸ºNATæ¨¡å¼ã€‚VMnet2-VMnet7å’ŒVMnet9è¿™ä¸ƒå—è™šæ‹Ÿç½‘å¡ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ï¼Œä½†æ˜¯åœ¨æ‰€æœ‰çš„è™šæ‹Ÿç½‘å¡ä¸­ä»…æœ‰ä¸€å—èƒ½è¢«è®¾ç½®ä¸ºNATæ¨¡å¼ï¼Œé»˜è®¤æƒ…å†µå°±æ˜¯VMnet8ã€‚ç”¨æˆ·å¯ä»¥åœ¨VMware workstation-&gt;ç¼–è¾‘-&gt;è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨ ä¸­æŸ¥çœ‹è¿™äº›ä¿¡æ¯ã€‚è¿™é‡Œå·²NATæ¨¡å¼é…ç½® æ‰“å¼€â€œç½‘ç»œå’Œå…±äº«ä¸­å¿ƒâ€é€‰æ‹©â€œVMware Virtual Ethernet Adapter for VMnet8â€ç½‘å¡å³é”®å±æ€§ï¼Œé€‰æ‹©VMware Bridge Protocol,åŒæ—¶è®¾ç½®ipè‡ªåŠ¨è·å– å°†ç‰©ç†ç½‘å¡ç½‘ç»œåˆ†äº«ç»™VMware Virtual Ethernet Adapter for VMnet8 è™šæ‹Ÿæœºç½‘ç»œè¿æ¥è®¾ç½®ä¸ºNATæ¨¡å¼ï¼Œé€‰æ‹©è™šæ‹Ÿæœºï¼Œå³é”®ã€‹è®¾ç½®ã€‹ç½‘ç»œé€‚é…å™¨ã€‹NAT æ¨¡å¼ æ£€éªŒç½‘ç»œæ˜¯å¦æ­£å¸¸ï¼Œä¸æ­£å¸¸ï¼Œæ£€æµ‹ifcfg-e**(æ¯å°å¯èƒ½ä¸ä¸€æ ·)ä¸­çš„bootprotoæ˜¯ä¸æ˜¯dhcpï¼Œå¦‚æœä¸æ˜¯åˆ™ä¿®æ”¹ä¸ºdhcpï¼Œæ­¤å¤–è¿˜éœ€è¦è®¾ç½®onboot = yes; ç„¶åç”¨å‘½ä»¤service network restarté‡å¯ç½‘ç»œè¿æ¥ï¼Œå°±å¯ä»¥è¿ä¸Šç½‘ç»œäº†]]></content>
      <tags>
        <tag>VMware</tag>
        <tag>CentOS7</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[www]]></title>
    <url>%2F2017%2F10%2F16%2Fwww%2F</url>
    <content type="text"><![CDATA[StartCoroutineå¼€å¯ä¸€ä¸ªåç¨‹ï¼Œyield returnæ˜¯è¿­ä»£å™¨è¿”å›è°ƒç”¨è¿­ä»£çš„åœ°æ–¹ã€‚åç¨‹è‡³å°‘äº§ç”Ÿåå‡ è¿˜æ˜¯å¤šå°‘Bçš„GCå…·ä½“æ˜¯å¤šå°‘æˆ‘å¿˜è®°äº†ï¼Œè‡³å°‘åœ¨5.3.8f2ä¹‹å‰çš„ç‰ˆæœ¬æ˜¯ï¼Œæœªæ¥å¦‚æœæœ‰æ—¶é—´å’Œæœ‰æœºä¼šæˆ‘ä¼šè®²è§£ä¸€ä¸ªå¯ä»¥é¿å…æ‰GCçš„åŠæ³•ã€‚CoroutineToolï¼Œæœ¬ç¯‡ä¸å†ä»‹ç»èŒƒå›´å†…ã€‚ä¸€ä¸ªåç¨‹çš„æ‰§è¡Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ç”¨yieldè¯­å¥æ¥æš‚åœï¼Œyield returnçš„å€¼å†³å®šäº†ä»€ä¹ˆæ—¶å€™åç¨‹æ¢å¤æ‰§è¡Œã€‚WWWçš„åŠ è½½æ–¹å¼ï¼Œæœ¬èº«ä¼šå¢åŠ FileSystemçš„å´©æºƒç‡ï¼Œç„¶åè¿˜å¢åŠ æ˜¾å­˜å ç”¨æé«˜äº†Presentçš„å´©æºƒç‡ã€‚]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Jenkins]]></title>
    <url>%2F2017%2F10%2F16%2FJenkins%2F</url>
    <content type="text"><![CDATA[æ·»åŠ Jenkinsçš„æºï¼ˆrepositoryï¼‰ sudo wget -O /etc/yum.repos.d/jenkins.repo http://jenkins-ci.org/redhat/jenkins.repo sudo rpm â€”import http://pkg.jenkins-ci.org/redhat/jenkins-ci.org.key å®‰è£…/æ£€æŸ¥JDK java â€”version # è¿™ä¸ªå¿…é¡»å®‰è£…æˆåŠŸ sudo yum install java-1.6.0-openjdk # æˆ‘ç”¨çš„1.8 å®‰è£…Jenkins: sudo yum install jenkins å®‰è£…å®Œæˆåï¼Œæœ‰å¦‚ä¸‹ç›¸å…³ç›®å½•ï¼š/usr/lib/jenkins/ :jenkinså®‰è£…ç›®å½•ï¼ŒWARåŒ…ä¼šæ”¾åœ¨è¿™é‡Œã€‚ cd /usr/lib/jenkins ll å¯åŠ¨Jenkins echo &amp;JAVA_HOME /usr/java/â€¦(æ‡’çš„å¤åˆ¶äº†)æ˜¨å¤©è¿˜å¥½å¥½çš„ï¼Œä»Šå¤©ä¸çŸ¥é“ä¸ºä»€ä¹ˆè®¿é—®ä¸äº†ï¼Œå„ç§æŸ¥æœ€åé€šè¿‡ service jenkins startæå®šäº†ï¼Œä½†æ˜¯æ˜¨å¤©ä¸€ç›´æ²¡å…³ï¼Œps -aux | grep â€œjenkinsâ€ ä¹Ÿèƒ½æ‰¾åˆ°ã€‚å¥‡æ€ªã€‚ä¸è¿‡ä½¿ç”¨service jenkins startä¹‹åå¤šäº†ä¸€ä¸ªã€‚]]></content>
      <tags>
        <tag>Jenkins</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[makefile]]></title>
    <url>%2F2017%2F10%2F15%2Fmakefile%2F</url>
    <content type="text"><![CDATA[make: Nothing to be done for xxxxä¸­é—´æ–‡ä»¶ã€é“¾æ¥æ–‡ä»¶Cã€C++è¦æŠŠæºæ–‡ä»¶ç¼–è¯‘æˆä¸­é—´ä»£ç æ–‡ä»¶ï¼Œåœ¨Windowsæ˜¯.objæ–‡ä»¶ï¼Œåœ¨Linuxæ˜¯.oæ–‡ä»¶ï¼Œå³Object Fileï¼Œè¿™ä¸€æ­¥å«åšç¼–è¯‘ã€‚ç„¶åæŠŠè¿™äº›Object Fileåˆæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿™ä¸€æ­¥å«åšé“¾æ¥(link)ã€‚ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨éœ€è¦çš„æ˜¯è¯­æ³•æ­£ç¡®ï¼Œå‡½æ•°å’Œå˜é‡å£°æ˜æ­£ç¡®ï¼Œç„¶åç¼–è¯‘ä¸­ä¸­é—´ç›®æ ‡æ–‡ä»¶ã€‚ä¸€èˆ¬æ¥è¯´æ¯ä¸ªæºæ–‡ä»¶éƒ½å¯¹åº”ä¸€ä¸ªä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼ˆOæ–‡ä»¶æˆ–è€…OBJæ–‡ä»¶ï¼‰ã€‚é“¾æ¥ä¸»è¦æ˜¯é“¾æ¥å‡½æ•°å’Œå…¨å±€å˜é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›ä¸­é—´ç›®æ ‡æ–‡ä»¶æ¥é“¾æ¥æˆ‘ä»¬çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚é“¾æ¥å™¨å¹¶ä¸è€ƒè™‘æºæ–‡ä»¶ï¼Œåªè€ƒè™‘ä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼ˆOBJæ–‡ä»¶ï¼‰ï¼Œå¤§ç‚¹çš„é¡¹ç›®æ–‡ä»¶æˆåƒä¸Šç™¾ï¼Œå¯¼è‡´ä¼šå˜æˆç”Ÿæˆå¤ªå¤šçš„ä¸­é—´æ–‡ä»¶ï¼Œè€Œé“¾æ¥æ—¶éœ€è¦æ˜ç¡®æŒ‡å‡ºä¸­é—´ç›®æ ‡æ–‡ä»¶åï¼Œè¿™å¯¹äºç¼–è¯‘å¾ˆä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥å‡ºç°äº†åº“æ–‡ä»¶æ¥åˆå¹¶è¿™äº›ç›®æ ‡æ–‡ä»¶windowsä¸‹â€œåº“æ–‡ä»¶â€ï¼ˆLibrary Fileï¼‰.libæ–‡ä»¶ï¼Œåœ¨Liunxä¸‹å«Archive Fileï¼ˆ.aï¼‰æ–‡ä»¶ï¼Œæ‰€ä»¥ä¸€èˆ¬åŒ…Link é”™è¯¯å°±æ˜¯æŒ‡æ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªä¸­é—´æ–‡ä»¶ï¼Œå³æ²¡æœ‰æ‰¾åˆ°è¯¥å£°æ˜çš„å®ç°ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ï¼‰ã€‚ Makefilemakeå‘½ä»¤æ‰§è¡Œæ—¶ï¼Œéœ€è¦ä¸€ä¸ªMakefileï¼ˆä¸€èˆ¬æ˜¯.mk ç¼ºçœMakefileæˆ–è€…makefileï¼Œä½œè€…ä¹ æƒ¯Makefile.mkï¼‰æ–‡ä»¶ï¼Œå‘Šè¯‰makeå‘½ä»¤å¦‚ä½•ç¼–è¯‘å’Œé“¾æ¥ç¨‹åºã€‚è§„åˆ™ï¼š1234target ... : prerequisites ... command ... ... targetä¹Ÿå°±æ˜¯ä¸€ä¸ªç›®æ ‡æ–‡ä»¶ï¼Œå¯æ˜¯æ˜¯Object Fileï¼Œä¹Ÿå¯ä»¥æ˜¯æ‰§è¡Œæ–‡ä»¶ã€‚è¿˜å¯ä»¥æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼ˆLabelï¼‰ã€‚prerequisiteså°±æ˜¯ï¼Œè¦ç”Ÿæˆé‚£ä¸ªtargetæ‰€éœ€è¦çš„æ–‡ä»¶æˆ–ç›®æ ‡ã€‚commandæ˜¯makeéœ€è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚ï¼ˆShellå‘½ä»¤ï¼‰è¿™æ˜¯ä¸€ä¸ªä¾èµ–å…³ç³»ï¼Œå°±æ˜¯è¯´ï¼Œtargetè¿™ä¸€ä¸ªæˆ–å¤šä¸ªç›®æ ‡æ–‡ä»¶ä¾èµ–äºprerequistiesä¸­çš„æ–‡ä»¶ï¼Œè€Œè§„åˆ™æ˜¯ç”±commandå†³å®šçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œprerequisitesä¸­å¦‚æœæœ‰ä¸€ä¸ªä»¥ä¸Šçš„æ–‡ä»¶æ¯”targetæ–‡ä»¶è¦æ–°çš„è¯ï¼Œcommandæ‰€å®šä¹‰çš„å‘½ä»¤å°±ä¼šè¢«æ‰§è¡Œã€‚è¿™å°±æ˜¯Makefileçš„è§„åˆ™ã€‚ ifeqçš„ç”¨æ³• ifeq($(SRCFILE),) else ifeq() endifå¦‚æœæ²¡æœ‰å˜é‡å€¼ï¼Œåˆ™åˆ¤æ–­æ˜¯å¦å®šä¹‰ï¼Œæœ‰åˆ™åˆ¤æ–­æ˜¯å¦ç›¸ç­‰./test.sh -f config.conf -v â€”prefix=/homeæˆ‘ä»¬ç§°-fä¸ºé€‰é¡¹ï¼Œå®ƒéœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œå³config.confï¼Œ-vä¹Ÿæ˜¯ä¸€ä¸ªé€‰é¡¹ï¼Œä½†å®ƒä¸éœ€è¦å‚æ•°ã€‚â€”prefixæˆ‘ä»¬ç§°ä¹‹ä¸ºé•¿é€‰é¡¹ï¼Œå³é€‰é¡¹æœ¬èº«å¤šä½™ä¸€ä¸ªå­—ç¬¦ï¼Œå®ƒä¹Ÿéœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œç”¨ç­‰å·è¿æ¥ï¼Œå½“ç„¶ç­‰å·ä¸æ˜¯å¿…é¡»çš„ï¼Œ/homeå¯ä»¥ç›´æ¥å¸è½½â€”prefixåé¢ï¼Œå³â€”prefix/homeã€‚ä¼ªç›®æ ‡ã€è™šç›®æ ‡ä¼ªç›®æ ‡ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ–‡ä»¶åï¼Œåœ¨æ‰§è¡Œmakeæ—¶å¯ä»¥æŒ‡å®šè¿™ä¸ªç›®æ ‡æ‰§è¡Œ å¦‚æœæˆ‘ä»¬éœ€è¦ä¹¦å†™è¿™æ ·ä¸€ä¸ªè§„åˆ™ï¼šè§„åˆ™æ‰€å®šä¹‰çš„å‘½ä»¤ä¸æ˜¯å»åˆ›å»ºç›®æ ‡æ–‡ä»¶ï¼Œè€Œæ˜¯ä½¿ç”¨makeæŒ‡å®šå…·ä½“çš„ç›®æ ‡æ¥æ‰§è¡Œä¸€äº›ç‰¹å®šçš„å‘½ä»¤ã€‚åƒä¸‹è¾¹é‚£æ ·ï¼š clean: rm .o tempè§„åˆ™ä¸­â€rmâ€ä¸æ˜¯åˆ›å»ºæ–‡ä»¶â€cleanâ€çš„å‘½ä»¤ï¼Œåªæ˜¯åˆ é™¤å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰.Oæ–‡ä»¶å’Œtempæ–‡ä»¶ã€‚åœ¨å·¥ä½œç›®å½•ä¸‹ä¸å­˜åœ¨â€cleanâ€è¿™ä¸ªæ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬è¾“å…¥â€make cleanâ€åï¼Œâ€rm .o tempâ€æ€»ä¼šè¢«æ‰§è¡Œã€‚è¿™æ˜¯æˆ‘ä»¬çš„åˆè¡·ã€‚ä½†å½“å‰å·¥ä½œç›®å½•ä¸‹å­˜åœ¨â€cleanâ€æ—¶æƒ…å†µå°±ä¸ä¸€æ ·äº†ï¼Œåœ¨æˆ‘ä»¬è¾“å…¥â€make cleanâ€æ—¶ã€‚è§„åˆ™æ²¡æœ‰ä¾èµ–æ–‡ä»¶ï¼Œæ‰€ä»¥ç›®æ ‡è¢«è®¤ä¸ºæ˜¯æœ€æ–°çš„è€Œä¸å»æ‰§è¡Œè§„åˆ™æ‰€å®šä¹‰çš„å‘½ä»¤ï¼Œå‘½ä»¤â€rmâ€å°†ä¸ä¼šè¢«æ‰§è¡Œã€‚è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬çš„åˆè¡·ã€‚ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç›®æ ‡â€cleanâ€æ˜ç¡®å£°æ˜ä¸ºä¼ªç›®æ ‡ã€‚è®²ä¸€ä¸ªç›®æ ‡å£°æ˜ä¸ºä¼ªç›®æ ‡éœ€è¦å°†å®ƒä½œä¸ºç‰¹æ®Šç›®æ ‡.PHONYçš„ä¾èµ–ã€‚å¦‚ä¸‹ï¼š .PHONY: dummy_help all dep obj cleanobj cleanint cleanout clean veryclean verycleanint install dirint dirout dirs pch cleanpchè¿™æ ·dummy_helpç­‰å°±æ˜¯ä¸€äº›ä¼ªç›®æ ‡æˆ–è€…è¯´æ˜¯è™šç›®æ ‡ï¼Œæ— è®ºå½“å‰ç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨â€cleanâ€è¿™ä¸ªæ–‡ä»¶ã€‚æˆ‘ä»¬è¾“å…¥â€make cleanâ€ä¹‹åï¼Œâ€rmâ€å‘½ä»¤éƒ½ä¼šè¢«æ‰§è¡Œã€‚è€Œä¸”å½“ä¸€ä¸ªç›®æ ‡è¢«å£°æ˜ä¸ºä¼ªç›®æ ‡åï¼Œmakeåœ¨æ‰§è¡Œè§„åˆ™æ—¶ä¸ä¼šè¯•å›¾å»æŸ¥æ‰¾éšå«è§„åˆ™æ¥åˆ›å»ºè¿™ä¸ªç›®æ ‡ã€‚è¿™æ ·ä¹Ÿæé«˜äº†makeçš„æ‰§è¡Œæ•ˆç‡ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿä¸ç”¨æ‹…å¿ƒç”±äºç›®æ ‡å’Œæ–‡ä»¶åé‡åè€Œä½¿æˆ‘ä»¬çš„æœŸæœ›å¤±è´¥ã€‚åœ¨ä¹¦å†™ä¼ªç›®æ ‡è§„åˆ™æ—¶ï¼Œé¦–å…ˆéœ€è¦å£°æ˜ç›®æ ‡æ˜¯ä¸€ä¸ªä¼ªç›®æ ‡ï¼Œä¹‹åæ‰æ˜¯ä¼ªç›®æ ‡çš„è§„åˆ™å®šä¹‰ã€‚ç›®æ ‡â€cleanâ€ä¹¦å†™æ ¼å¼åº”è¯¥å¦‚ä¸‹ï¼š .PHONY: clean cleanint: cleanobj ç§»é™¤æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶(ç›®æ ‡æ–‡ä»¶ã€ä¾èµ–æ–‡ä»¶) $(RM) -f $(DEPFILE_TO_DEL) cleanout: ifeq ($(ISWHAT),LIB) åº“ $(RM) -f $(TargetOutFile).* else ifeq ($(ISWHAT),EXE) EXEæ–‡ä»¶ $(RM) -f $(TargetOutFile) else DLLæˆ–å…¶ä»– $(RM) -f $(TargetOutFile).* ifneq ($(OutDirLib),) $(RM) -f $(TargetOutFileLib).* endif endif endif cleanpch: $(RM) -f $(PchFile) clean: cleanint cleanout cleanpch @echo ==== clean now ==== é€šé…ç¬¦é€šé…ç¬¦æ˜¯ä¸€ç§ç‰¹æ®Šè¯­å¥ï¼Œä¸»è¦æœ‰æ˜Ÿå·(*)å’Œé—®å·(?)ï¼Œç”¨æ¥æ¨¡ç³Šæœç´¢æ–‡ä»¶ Makefileä¸­çš„wildcardç”¨æ³•åœ¨Makefileè§„åˆ™ä¸­ï¼Œé€šé…ç¬¦ä¼šè¢«è‡ªåŠ¨å±•å¼€ã€‚ä½†åœ¨å˜é‡çš„å®šä¹‰å’Œå‡½æ•°å¼•ç”¨æ—¶ï¼Œé€šé…ç¬¦å°†å¤±æ•ˆã€‚è¿™ç§æƒ…å†µä¸‹å¦‚æœéœ€è¦é€šé…ç¬¦æœ‰æ•ˆï¼Œå°±éœ€è¦ä½¿ç”¨å‡½æ•°â€wildcardâ€ï¼Œå®ƒçš„ç”¨æ³•æ˜¯ï¼š$(wildcard PATTERNâ€¦)ã€‚åœ¨Makefileä¸­ï¼Œå®ƒè¢«å±•å¼€ä¸ºå·²ç»å­˜åœ¨çš„ã€ä½¿ç”¨ç©ºæ ¼åˆ†å¼€çš„ã€åŒ¹é…æ­¤æ¨¡å¼çš„æ‰€æœ‰æ–‡ä»¶åˆ—è¡¨ã€‚å¦‚æœä¸å­˜åœ¨ä»»ä½•ç¬¦åˆæ­¤æ¨¡å¼çš„æ–‡ä»¶ï¼Œå‡½æ•°ä¼šå¿½ç•¥æ¨¡å¼å­—ç¬¦å¹¶è¿”å›ç©ºã€‚éœ€è¦ Linux make ä¿å­˜é”™è¯¯æ—¥å¿—$mkdbg all 2&gt;&amp;1|tee xxx.logè¿™æ¡å‘½ä»¤æ˜¯ç¼–è¯‘å¹¶ä¿å­˜æ‰“å°ä¿¡æ¯ã€‚åœ¨Linux Shellçš„è®¾å¤‡å®šä¹‰ä¸­ï¼Œâ€œ0â€è¡¨ç¤ºæ ‡å‡†è¾“å…¥ï¼Œâ€œ1â€è¡¨ç¤ºæ ‡å‡†è¾“å‡ºï¼Œâ€œ2â€è¡¨ç¤ºæ ‡å‡†å‡ºé”™ä¿¡æ¯è¾“å‡ºã€‚2&gt;&amp;1è¡¨ç¤ºæŠŠ2è®¾å¤‡çš„ä¿¡æ¯é‡å®šå‘åˆ°1è®¾ å¤‡ï¼›â€œ|â€æ˜¯ç®¡é“ç¬¦å·ï¼ŒæŠŠæ ‡å‡†è¾“å‡ºçš„ä¿¡æ¯ç›´æ¥ä¼ é€’ç»™åé¢çš„å‘½ä»¤ï¼›teeæ˜¯åˆ›å»ºæ–‡ä»¶å¹¶ä¿å­˜ä¿¡æ¯çš„å·¥å…·ï¼›xxx.logæ˜¯æ–‡ä»¶åã€‚è¿™ç§ç®¡é“çš„ç”¨æ³•åœ¨Linux Shellå‘½ä»¤ä¸­ä½¿ç”¨éå¸¸æ™®éã€‚ç¼–è¯‘è¿‡ç¨‹ä¸­éƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œç”Ÿæˆæ—¥å¿—æ–‡ä»¶ï¼Œä¿å­˜åˆ°buildlogsç›®å½•ä¸‹ã€‚ 1 # ç¼–è¯‘æ¨¡å¼å 2 ConfigurationName := debug 3 # ç”¨äºä½“ç°è¯¥ç¼–è¯‘æ¨¡å¼çš„æ–‡ä»¶æ ‡è®° 4 # (å¯¹äºdebugç‰ˆæ¥è¯´ï¼Œæ¯”å¦‚ç›®æ ‡æ–‡ä»¶åç¼€å°±ä¼šå˜æˆ._do) 5 CfgFileTag := _d 6 # ç¼–è¯‘é€‰é¡¹ 7 #CCFlag := -Wall -g -D_DEBUG -march=native 8 CFlag := -Wall -Wno-multichar -g -D_DEBUG -DPG_MEMORY_DISABLE_POOL -march=core2 -m32 -rdynamic 9 CCFlag := $(CFlag) -std=c++0x 10 11 #CCFlag := -finput-charset=gb2312 -Wall -g -D_DEBUG 12 # è¿æ¥é€‰é¡¹ 13 #LNFlag := -lpthread -march=native 14 LNFlag := -lpthread -ldl -lrt -march=prescott]]></content>
      <tags>
        <tag>makefile</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[gdb]]></title>
    <url>%2F2017%2F10%2F15%2Fgdb%2F</url>
    <content type="text"><![CDATA[æ–­ç‚¹ break filename:linenum åœ¨æºæ–‡ä»¶filenameçš„linenumè¡Œå¤„åœä½ã€‚d æ¸…é™¤æ‰€æœ‰æ–­ç‚¹|â€”|â€”||step(s)|æ‰§è¡Œä¸‹ä¸€å¥ï¼Œå¦‚æœæœ‰å‡½æ•°åˆ™è¿›å…¥å‡½æ•°é‡Œé¢æ‰§è¡Œ|set follow-fork-mode parentglibc-2.17-196.el7.i686 libgcc-4.8.5-16.el7.i686 libstdc++-4.8.5-16.el7.i686gdb debugme pidclear åˆ é™¤æ‰€åœ¨è¡Œçš„æ‰€æœ‰æ–­ç‚¹clear 12 //åˆ é™¤12è¡Œçš„æ‰€æœ‰æ–­ç‚¹clear list.c:12 //åˆ é™¤è¯¥æ–‡ä»¶è¯¥è¡Œå·çš„æ‰€æœ‰æ–­ç‚¹b list.c:12 // åœ¨è¯¥æ–‡ä»¶è¯¥è¡Œå·æ·»åŠ æ–­ç‚¹backtrace\bt æ‰“å°å…¨éƒ¨æ ˆå¸§çš„ç®€è¦ä¿¡æ¯ï¼ŒæŒ‰Ctrl-cå¯ç»ˆæ­¢æ‰“å°ã€‚finish è·³å‡ºå½“å‰å‡½æ•°ã€‚ è°ƒè¯•å®ˆæŠ¤è¿›ç¨‹å¦‚æœéœ€è¦è°ƒè¯•å­è¿›ç¨‹ï¼Œåœ¨å¯åŠ¨gbdåï¼šset follow-fork-mode childå¹¶åœ¨å­è¿›ç¨‹ä»£ç è®¾ç½®æ–­ç‚¹æ­¤å¤–è¿˜æœ‰detach-on-forkå‚æ•°ï¼Œåªæ˜¯gdbåœ¨forkä¹‹åæ˜¯å¦æ–­å¼€(detach)æŸä¸ªè¿›ç¨‹çš„è°ƒè¯•ï¼Œæˆ–è€…éƒ½äº¤ç”±GDBæ§åˆ¶ã€‚ è§‚å¯Ÿç‚¹(WatchPoint)åœ¨å˜é‡è¯»ã€å†™æˆ–å˜åŒ–æ—¶ä¸­æ–­ï¼Œè¿™ç±»æ–¹å¼å¸¸ç”¨æ¥å®šä½bugã€‚ watch å˜é‡å‘ç”Ÿå˜åŒ–æ—¶ä¸­æ–­ rwatch å˜é‡è¢«è¯»æ—¶ä¸­æ–­ awatch å˜é‡å€¼è¢«è¯»æˆ–å†™æ—¶ä¸­æ–­ æ¡ä»¶æ–­ç‚¹(gdb) b 13 if i == 8 ç¨‹åºè¿è¡Œå‚æ•°set args å¯æŒ‡å®šè¿è¡Œæ—¶çš„å‚æ•°ã€‚(å¦‚ï¼šset args 10 20 30 40 50show args å‘½ä»¤å¯ä»¥æŸ¥çœ‹è®¾ç½®å¥½çš„è¿è¡Œå‚æ•° æ‰“å°å †æ ˆbtæ˜¾ç¤ºæ‰€æœ‰çš„å‡½æ•°è°ƒç”¨çš„æ ˆå¸§ä¿¡æ¯ï¼Œæ¯ä¸ªå¸§ä¸€è¡Œã€‚]]></content>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linux]]></title>
    <url>%2F2017%2F10%2F15%2Flinux%2F</url>
    <content type="text"><![CDATA[ä¾‹å­ï¼šå°†ç›®å½•Aé‡å‘½åä¸ºB mv A B ä¾‹å­ï¼šå°†/aç›®å½•ç§»åŠ¨åˆ°/bä¸‹ï¼Œå¹¶é‡å‘½åä¸ºc mv /a /b/c yum install wget yum install gcc yum install gcc-c++ wget http://ftp.gnu.org/pub/gnu/ncurses/ncurses-5.6.tar.gz tar -zxvf ./configure -prefix=/usr/local -with-shared-without-debug make &gt; t.log make install no termcap library foundwget http://ftp.gnu.org/gnu/termcap/termcap-1.3.1.tar.gztar -zxvf termcap-1.3.1.tar.gzcd termcap./configure â€”helpset t.logvim t.log/MACHTYPE=x86_64-redhat-linux-gnuyum install gdb (è¿™å°¼ç›å‘çˆ¹å‘€) duæŸ¥çœ‹æŸä¸ªæ–‡ä»¶æˆ–ç›®å½•å ç©ºé—´å¤§å°du -ah du -sh linuxä¸‹ä¿®æ”¹.bash_profileç«‹å³ç”Ÿæ•ˆçš„æ–¹æ³• source .bash_profile exec bash â€”login linuxä¸­æ–‡ä¹±ç æŸ¥çœ‹å½“å‰ç³»ç»Ÿé»˜è®¤çš„å­—ç¬¦é›†localeå®‰è£…ä¸­æ–‡åŒ…yum -y groupinstall chinese-support ç”Ÿæ•ˆexport LANG=â€zh_CN.UTF-8â€é‡æ–°è½½å…¥. /etc/profile è§£å†³ä¸­æ–‡ä¹±ç export LC_ALL=â€zh_CN.utf8â€ Linuxä¸­å®‰è£…gcc g++ yumæ–¹å¼123yum -y install gccyum -y install gcc-c++yum intall make Linuxæ³¨é”€ç”¨æˆ·who åˆ—å‡ºç™»é™†çš„ç”¨æˆ·åˆ—è¡¨ whoroot@localhost:~/work_code/src/svr&gt; whoroot pts/0 2017-10-20 06:33 (192.168.171.1)root@localhost:~/work_code/src/svr&gt; pkill -kill -t pts/0 cannot find -lgcc_såœ¨64ä½Centos7ä¸Šç¼–è¯‘32ä½Cç¨‹åºï¼Œå› ä¸ºæ˜¯ç¼–è¯‘32ä½çš„ç›®æ ‡ç¨‹åºï¼Œæ‰€ä»¥ä½¿ç”¨gccç¼–è¯‘çš„æ—¶å€™éœ€è¦åŠ ä¸Š-m32é€‰é¡¹ï¼Œä½†æ˜¯ç¼–è¯‘çš„è¯ä¼šæŠ¥é”™ï¼Œå¦‚ä¸‹ï¼š1234root@localhost:~/work_code&gt; gcc -g -m32 -o hello hello.c/usr/bin/ld: skipping incompatible /usr/lib/gcc/x86_64-redhat-linux/4.8.5/libgcc_s.so when searching for -lgcc_s/usr/bin/ld: cannot find -lgcc_scollect2: é”™è¯¯ï¼šld è¿”å› 1 getconf LONG_BIT #æŸ¥çœ‹è‡ªå·±ç‰ˆæœ¬æ˜¯32ä½è¿˜æ˜¯64ä½32ä½çš„åº“yum install glibc-devel.i686yum install libstdc++-devel.i686 kill -2 å’Œ kill -9çš„åŒºåˆ«-2ç±»ä¼¼Ctrl + C æ˜¯ç¨‹åºåœ¨ç»“æŸä¹‹å‰ï¼Œèƒ½å¤Ÿä¿å­˜ç›¸å…³æ•°æ®ï¼Œç„¶ååœ¨é€€å‡ºã€‚-9ç›´æ¥å¼ºåˆ¶ç»“æŸç¨‹åºã€‚ ç¡¬é“¾æ¥(hard link)å’Œè½¯é“¾æ¥(ç¬¦å·é“¾æ¥ï¼Œfsoft linkæˆ–symbolic link)æˆ‘ä»¬çŸ¥é“æ–‡ä»¶éƒ½æœ‰æ–‡ä»¶åå’Œæ•°æ®ï¼Œåœ¨Linuxä¸Šè¢«åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼šç”¨æˆ·æ•°æ®(user data)å’Œå…ƒæ•°æ®(metadata)ã€‚ç”¨æˆ·æ•°æ®ï¼Œå³æ–‡ä»¶æ•°æ®å—(data block)ï¼Œæ•°æ®å—æ—¶è®°å½•æ–‡ä»¶çœŸå®å†…å®¹çš„åœ°æ–¹ï¼›è€Œå…ƒæ•°æ®åˆ™æ˜¯æ–‡ä»¶çš„é™„åŠ å±æ€§ï¼Œå¦‚æ–‡ä»¶å¤§å°ã€åˆ›å»ºæ—¶é—´ã€æ‰€æœ‰è€…ç­‰ä¿¡æ¯ã€‚åœ¨Linuxä¸­ï¼Œå…ƒæ•°æ®ä¸­çš„inodeå·(inodeæ˜¯æ–‡ä»¶å…ƒæ•°æ®çš„ä¸€éƒ¨åˆ†ä½†å…¶å¹¶ä¸åŒ…å«æ–‡ä»¶åï¼Œinodeå·å³ç´¢å¼•èŠ‚ç‚¹å·)æ‰æ˜¯æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†è€Œéæ–‡ä»¶åã€‚æ–‡ä»¶åä»…æ˜¯ä¸ºäº†æ–¹ä¾¿äººä»¬çš„è®°å¿†å’Œä½¿ç”¨ï¼Œç³»ç»Ÿæˆ–ç¨‹åºé€šè¿‡inodeå·å¯»æ‰¾æ­£ç¡®çš„æ–‡ä»¶æ•°æ®å—ã€‚è‹¥ä¸€ä¸ªinodeå·å¯¹åº”å¤šä¸ªæ–‡ä»¶åï¼Œåˆ™ç§°è¿™äº›æ–‡ä»¶ä¸ºç¡¬é“¾æ¥ã€‚æ¢è¨€ä¹‹ï¼Œç¡¬é“¾æ¥å°±æ˜¯åŒä¸€ä¸ªæ–‡ä»¶ä½¿ç”¨äº†å¤šä¸ªåˆ«åã€‚ç¡¬é“¾æ¥å¯ç”±å‘½ä»¤linkæˆ–lnåˆ›å»ºã€‚ link oldfile newfile ln oldfile newfileç”±äºç¡¬é“¾æ¥æœ‰ç€ç›¸åŒinodeå·ä»…æ–‡ä»¶åä¸åŒçš„æ–‡ä»¶ï¼Œå› æ­¤ç¡¬é“¾æ¥å­˜åœ¨ä»¥ä¸‹å‡ ç‚¹ç‰¹æ€§ï¼š æ–‡ä»¶æœ‰ç›¸åŒçš„inodeåŠdata blockï¼› åªèƒ½å¯¹å·²å­˜åœ¨çš„æ–‡ä»¶è¿›è¡Œåˆ›å»ºï¼› ä¸èƒ½äº¤å‰æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œç¡¬é“¾æ¥çš„åˆ›å»ºï¼› ä¸èƒ½å¯¹ç›®å½•è¿›è¡Œåˆ›å»ºï¼Œåªå¯å¯¹æ–‡ä»¶åˆ›å»ºï¼› åˆ é™¤ä¸€ä¸ªç¡¬é“¾æ¥æ–‡ä»¶å¹¶ä¸å½±å“å…¶å®ƒæœ‰ç›¸åŒinodeå·çš„æ–‡ä»¶ã€‚è½¯è¿æ¥ä¸ç¡¬é“¾æ¥ä¸åŒï¼Œè‹¥æ–‡ä»¶ç”¨æˆ·æ•°æ®å—å­˜æ”¾çš„å†…å®¹æ˜¯å¦ä¸€æ–‡ä»¶çš„è·¯å¾„åçš„æŒ‡å‘ï¼Œåˆ™è¯¥æ–‡ä»¶å°±æ˜¯è½¯è¿æ¥ã€‚è½¯é“¾æ¥å°±æ˜¯æ™®é€šæ–‡ä»¶ï¼Œåªæ˜¯æ•°æ®å—å†…å®¹æœ‰ç‚¹ç‰¹æ®Šã€‚è½¯é“¾æ¥æœ‰ç€è‡ªå·±çš„inodeå·ä»¥åŠç”¨æˆ·æ•°æ®å—usage: ln -s æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ sshç™»å½•æ–¹æ³•ssh -l username ip æ°¸ä¹…æ€§è·å–ROOTæƒé™sudo passwd su 64ä½linuxæœºå™¨ä¸Šç¼–è¯‘32ä½opensslåº“setarch i386 ./config -m32 wget http://zlib.net/zlib-1.2.11.tar.gz tar -zxvf zlib-1.2.111.tar.gz cd zlib-1.2.11 ./configure --prefix=/usr/local make &amp;&amp; make install find ./ -name &quot;*.o&quot; -exec rm {} \; make: ***[install_docs] Error 1 vim /usr/bin/pod2man æ³¨é‡Š69è¡Œ# i386 å‡ ä¹æ‰€æœ‰çš„X86å¹³å°i686 åªæ˜¯i386çš„ä¸€ä¸ªå­é›† åœ¨EC2ä¸Šåˆ›å»ºrootç”¨æˆ·ï¼Œå¹¶ä½¿ç”¨rootç”¨æˆ·ç™»å½•su vim /etc/ssh/sshd_config æ‰¾åˆ°PasswordAuthentication noï¼ŒæŠŠnoæ”¹æˆyes PermitRootLogin yes sudo /sbin/service sshd restart su root Linuxå†…å­˜ç®¡ç†&lt;% img asset_img Linux1.webp %&gt;åœ¨linuxä¸­ï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹éƒ½è¢«æŠ½è±¡ä¸ºtask_structç»“æ„ä½“ä¸­ï¼Œæˆä¸ºè¿›ç¨‹æè¿°ç¬¦ï¼Œå­˜å‚¨ç€è¿›ç¨‹å„æ–¹é¢çš„ä¿¡æ¯ï¼›ä¾‹å¦‚æ‰“å¼€çš„æ–‡ä»¶ï¼Œä¿¡å·ä»¥åŠå†…å­˜ç­‰ç­‰ï¼›ç„¶åtask_structä¸­çš„ä¸€ä¸ªå±æ€§mm_structç®¡ç†ç€è¿›ç¨‹çš„æ‰€æœ‰è™šæ‹Ÿå†…å­˜ï¼Œæˆä¸ºå†…å­˜æè¿°ç¬¦ã€‚åœ¨mm_structç»“æ„ä½“ä¸­ï¼Œå­˜å‚¨ç€è¿›ç¨‹å„ä¸ªå†…å­˜æ®µçš„å¼€å§‹ä»¥åŠç»“å°¾ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºï¼›è¿›ç¨‹ä½¿ç”¨çš„ç‰©ç†å†…å­˜ï¼Œå³å¸¸é©»å†…å­˜RSSé¡µæ•°ï¼Œè¿™ä¸ªå†…å­˜ä½¿ç”¨çš„è™šæ‹Ÿåœ°å€ç©ºé—´VSZé¡µæ•°ï¼Œè¿˜æœ‰è¿›ç¨‹è™šæ‹Ÿå†…å­˜åŒºåŸŸé›†åˆå’Œé¡µè¡¨ã€‚ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œè¿›ç¨‹æœ‰ä»£ç æ®µText segment,æ•°æ®æ®µï¼ˆå·²åˆå§‹åŒ–çš„å…¨å±€ï¼Œé™æ€å˜é‡ï¼‰ï¼ŒBSSæ®µï¼ˆæœªåˆå§‹åŒ–çš„å…¨å±€ï¼Œé™æ€å˜é‡ï¼‰ï¼Œå †ï¼Œå†…å­˜æ˜ å°„åŒºä»¥åŠæ ˆï¼›æ¯ä¸€å—è™šæ‹Ÿå†…å­˜åŒºï¼ˆVMAï¼‰éƒ½æ˜¯ç”±ä¸€å—è¿ç»­çš„è™šæ‹Ÿåœ°å€ç»„æˆï¼Œè¿™äº›åœ°å€ä»ä¸è¦†ç›–ã€‚ä¸€ä¸ªvm_area_structå®ä¾‹æè¿°äº†ä¸€å—å†…å­˜åŒºåŸŸï¼ŒåŒ…æ‹¬è¿™å—å†…å­˜åŒºåŸŸå¼€å§‹ä»¥åŠç»“å°¾åœ°å€ï¼›flagsæ ‡å¿—å†³å®šäº†è¿™å—å†…å­˜çš„è®¿é—®æƒé™å’Œè¡Œä¸ºï¼›vm_fileå†³å®šè¿™å—å†…å­˜æ˜¯ç”±å“ªä¸ªæ–‡ä»¶æ˜ å°„çš„ï¼Œå¦‚æœæ²¡æœ‰æ–‡ä»¶æ˜ å°„ï¼Œåˆ™è¿™å—å†…å­˜ä¸ºåŒ¿åçš„(anonymous)ã€‚ä¸Šå›¾ä¸­æåˆ°çš„æ¯ä¸ªå†…å­˜æ®µï¼Œéƒ½å¯¹åº”ä¸€ä¸ªvm_area_structç»“æ„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º&lt;% asset_img Linux2.webp %&gt;ä¸Šå›¾å³ä¸º/bin/gonzoè¿›ç¨‹çš„å†…å­˜å¸ƒå±€ã€‚ç¨‹åºçš„äºŒè¿›åˆ¶æ–‡ä»¶æ˜ å°„åˆ°ä»£ç æ®µå’Œæ•°æ®æ®µï¼Œä»£ç æ®µä¸ºåªè¯»åªæ‰§è¡Œï¼Œä¸å¯æ›´æ”¹ï¼›å…¨å±€ä»¥åŠé™æ€çš„æœªåˆå§‹åŒ–çš„å˜é‡æ˜ å°„åˆ°BSSæ®µï¼Œä¸ºåŒ¿åæ˜ å°„ï¼Œå †å’Œæ ˆä¹Ÿæ˜¯åŒ¿åæ˜ å°„ï¼Œå› ä¸ºæ²¡æœ‰ç›¸å¯¹åº”çš„æ–‡ä»¶æ˜ å°„ï¼›å†…å­˜æ˜ å°„åŒºå¯ä»¥æ˜ å°„å…±äº«åº“ï¼Œæ˜ å°„æ–‡ä»¶ä»¥åŠåŒ¿åæ˜ å°„ï¼Œæ‰€ä»¥è¿™å—å†…å­˜æ®µå¯ä»¥ä½¿æ–‡ä»¶æ˜ å°„ä¹Ÿå¯ä»¥æ˜¯åŒ¿åæ˜ å°„ã€‚è€Œä¸”ä¸åŒçš„æ–‡ä»¶ï¼Œæ˜ å°„åˆ°ä¸åŒçš„vm_area_structåŒºã€‚è¿™äº›vm_area_structé›†åˆå­˜å‚¨åœ¨mm_structä¸­çš„ä¸€ä¸ªå•å‘é“¾è¡¨å’Œçº¢é»‘æ ‘ä¸­ï¼›å½“è¾“å‡º/proc/pid/mapsæ–‡ä»¶æ—¶ï¼Œåªéœ€è¦éå†è¿™ä¸ªé“¾è¡¨å³å¯ã€‚çº¢é»‘æ ‘ä¸»è¦æ˜¯ä¸ºäº†å¿«é€Ÿå®šä½åˆ°æŸä¸€ä¸ªå†…å­˜å—ï¼Œçº¢é»‘æ ‘çš„è·Ÿå­˜å‚¨åœ¨mm_rbåŸŸã€‚çº¿æ€§åœ°å€éœ€è¦é€šè¿‡é¡µè¡¨æ‰èƒ½è½¬æ¢ä¸ºç‰©ç†åœ°å€ã€‚æ¯ä¸ªè¿›ç¨‹çš„å†…å­˜æè¿°ç¬¦ä¹Ÿä¿å­˜äº†è¿™ä¸ªè¿›ç¨‹é¡µè¡¨æŒ‡é’ˆpgd,æ¯ä¸€å—è™šæ‹Ÿå†…å­˜é¡µéƒ½å’Œé¡µè¡¨çš„æŸä¸€é¡¹å¯¹åº”ã€‚è™šæ‹Ÿå†…å­˜æ˜¯ä¸å­˜å‚¨ä»»ä½•æ•°æ®çš„ï¼Œå®ƒåªæ˜¯å°†åœ°å€ç©ºé—´æ˜ å°„åˆ°ç‰©ç†å†…å­˜ã€‚ç‰©ç†å†…å­˜æœ‰å†…æ ¸ä¼™ä¼´ç³»ç»Ÿåˆ†é…ï¼Œå¦‚æœä¸€å—ç‰©ç†å†…å­˜æ²¡æœ‰è¢«æ˜ å°„ï¼Œå°±å¯ä»¥è¢«ä¼™ä¼´ç³»ç»Ÿåˆ†é…ç»™è™šæ‹Ÿå†…å­˜ã€‚åˆšåˆ†é…çš„ç‰©ç†å†…å­˜å¯èƒ½æ˜¯åŒ¿åçš„ï¼Œå­˜å‚¨è¿›ç¨‹æ•°æ®ï¼Œä¹Ÿå¯èƒ½æ˜¯ç¼“å­˜ï¼Œå­˜å‚¨æ–‡ä»¶æˆ–å—è®¾å¤‡çš„æ•°æ®ã€‚ä¸€å—è™šæ‹Ÿå†…å­˜vm_area_structå—æ˜¯ç”±è¿ç»­çš„è™šæ‹Ÿå†…å­˜ä¹Ÿç»„æˆçš„ï¼Œè€Œè¿™äº›è™šæ‹Ÿå†…å­˜å—æ˜ å°„çš„ç‰©ç†å†…å­˜å´ä¸ä¸€å®šè¿ç»­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;% asset_img Linux3.webp %&gt;]]></content>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[svn]]></title>
    <url>%2F2017%2F10%2F15%2Fsvn%2F</url>
    <content type="text"><![CDATA[svn: E200002: line 19: Option expectedé”™è¯¯è§£å†³è¿™æ˜¯å› ä¸ºä¿®æ”¹svnserve.confæ—¶ï¼Œæ‰“å¼€æ³¨é‡Šæ—¶ï¼Œé…ç½®çš„å‰é¢æœ‰ç©ºæ ¼ï¼Œåº”è¯¥é¡¶æ ¼å†™ã€‚ä¿®æ”¹åå³å¯ã€‚ è§£å†³svn Authorization failedé”™è¯¯å‡ºç°è¯¥é—®é¢˜åŸºæœ¬éƒ½æ˜¯ä¸‰ä¸ªé…ç½®æ–‡ä»¶çš„é—®é¢˜ï¼Œä¸‹é¢æŠŠè¿™ä¸ªæ–‡ä»¶åˆ—å‡ºæ¥svnserve.conf:[general]anon-access = readauth-access = writepassword-db = passwdauthz-db = authzpasswd:[users]admin=123authz:[groups][/]admin= rwå‡ºç°authorization failedå¼‚å¸¸ï¼Œä¸€èˆ¬éƒ½æ˜¯authzæ–‡ä»¶é‡Œï¼Œç”¨æˆ·ç»„æˆ–è€…ç”¨æˆ·æƒé™æ²¡æœ‰é…ç½®å¥½ï¼Œåªè¦è®¾ç½®[/]å°±å¯ä»¥ï¼Œä»£è¡¨æ ¹ç›®å½•ä¸‹æ‰€æœ‰çš„èµ„æºï¼Œå¦‚æœè¦é™å®šèµ„æºï¼Œå¯ä»¥åŠ ä¸Š å­ç›®å½•å³å¯ã€‚ checkoutsvn checkout pathï¼ˆpathæ˜¯æœåŠ¡å™¨ä¸Šçš„ç›®å½•ï¼‰ ä¾‹å¦‚ï¼šsvn checkout svn://192.168.171.128/zentia/trunk/xxprj/server revertsvn revert [-R] dir CentOSä¸‹svnè¿ç§»å¤‡ä»½çš„ä¸‰ç§æ–¹æ³•ä¸€èˆ¬é‡‡ç”¨ä¸‰ç§æ–¹å¼ï¼š svnadmin dump svnadmin hotcopy svnsyncæ³¨æ„ï¼Œsvnå¤‡ä»½ä¸å®œé‡‡ç”¨æ™®é€šçš„æ–‡ä»¶æ‹·è´æ–¹å¼ï¼ˆé™¤éä½ å¾ˆæ‡‚svnï¼Œå¹¶ä¸”å°†åº“æš‚åœï¼‰ï¼Œå¦‚copyã€rsyncå‘½ä»¤ã€‚svnadmin dumpæ˜¯å®˜æ–¹æ¨èçš„å¤‡ä»½æ–¹å¼ï¼Œä¼˜ç‚¹æ˜¯æ¯”è¾ƒçµæ´»ï¼Œå¯ä»¥å…¨é‡å¤‡ä»½ä¹Ÿå¯ä»¥å¢é‡å¤‡ä»½ï¼Œå¹¶æä¾›äº†ç‰ˆæœ¬æ¢å¤æœºåˆ¶ã€‚ç¼ºç‚¹ï¼šå¦‚æœç‰ˆæœ¬æ¯”è¾ƒå¤§ï¼Œå¦‚ç‰ˆæœ¬æ•°å¢é•¿åˆ°æ•°ä¸‡ã€æ•°åä¸‡ï¼Œé‚£ä¹ˆdumpçš„è¿‡ç¨‹å°†éå¸¸æ…¢ï¼›å¤‡ä»½è€—æ—¶ï¼Œæ¢å¤æ›´è€—æ—¶ï¼›ä¸åˆ©äºå¿«é€Ÿè¿›è¡Œç¾éš¾æ¢å¤ã€‚ä¸ªäººå»ºè®®åœ¨ç‰ˆæœ¬æ•°æ¯”è¾ƒå°çš„æƒ…å†µä¸‹ä½¿ç”¨è¿™ç§å¤‡ä»½æ–¹å¼ã€‚svnadmin hotcopyåŸè®¾è®¡ç›®çš„ä¼°è®¡ä¸æ˜¯ç”¨æ¥å¤‡ä»½çš„ï¼Œåªèƒ½è¿›è¡Œå…¨é‡æ‹·è´ï¼Œä¸èƒ½è¿›è¡Œå¢é‡å¤‡ä»½ï¼›ä¼˜ç‚¹æ˜¯ï¼šå¤‡ä»½è¿‡ç¨‹è¾ƒå¿«ï¼Œç¾éš¾æ¢å¤ä¹Ÿå¾ˆå¿«ï¼›å¦‚æœå¤‡ä»½æœºä¸Šå·²ç»æ­å»ºäº†svnæœåŠ¡ï¼Œç”šè‡³ä¸éœ€è¦æ¢å¤ï¼Œåªéœ€è¦è¿›è¡Œç®€å•é…ç½®å³å¯åˆ‡æ¢åˆ°å¤‡ä»½åº“ä¸Šå·¥ä½œã€‚ç¼ºç‚¹æ˜¯ï¼šæ¯”è¾ƒæ¶ˆè€—ç¡¬ç›˜ï¼Œéœ€è¦æœ‰è¾ƒå¤§çš„ç¡¬ç›˜æ”¯æŒã€‚svnsyncå®é™…ä¸Šæ˜¯CentOSä¸‹SVNæœåŠ¡çš„å¯åŠ¨è¯­å…³é—­svnserve -d -r /home/svn/home/svn ä¸ºç‰ˆæœ¬çš„æ ¹ç›®å½•å…³é—­SVNæœåŠ¡ï¼šps aux | grep svnkill -s 9 6443464434ä¸ºè¿›ç¨‹ID æˆ–è€… killall svnserve linuxä¸‹SVNä¸­æ”¹å˜æ‰§è¡Œæƒé™æœ¬åœ°æ–‡ä»¶åœ¨commitåˆ°ä»“åº“ä¹‹å‰è‹¥æ²¡æœ‰chmod+xæƒé™çš„è¯ï¼Œæ‹¿åœ¨svnä»“åº“é‡Œçš„æ–‡ä»¶å°†ä¼šä¿æŒå½“å‰æ— å¯æ‰§è¡Œå±æ€§çŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥åšsvnå‘½ä»¤ä¿®æ”¹ã€‚SVNä¸­ï¼Œå¦‚æœæˆ‘ä»¬åœ¨linuxä¸‹æäº¤æƒé™ä¸º755æ–‡ä»¶ï¼Œå°±ä¼šåœ¨svnçš„å±æ€§ä¸­å­˜åœ¨ä¸€ä¸ªsvn:executableã€‚åªåœ¨æœ¬åœ°chmod 644 ï¼Œæ˜¯ä¸èƒ½é€ æˆä¿®æ”¹çš„ã€‚svn propset svn:executable on * ï¼ˆæ³¨æ„ï¼Œå¦‚æœåŒ…å«ç›®å½•ä¼šæ‰§è¡Œå¤±è´¥ï¼‰svn commit å‰ä¸€ä¸ªæ“ä½œè¢«å¡ä½çš„é—®é¢˜å»å®˜ç½‘ä¸‹è½½win32é‚£ä¸ªåŒ…å°±å¯ä»¥äº†ã€‚sqlite3.exe .svn/wc.db â€œdelete from wc_lockâ€sqlite3.exe .svn/wc.db â€œdelete from work_queueâ€/OUT:â€F:\zentia\server\bin\vc120debugs\glogger_d.exeâ€ /MANIFEST /NXCOMPAT /PDB:â€F:\zentia\server\bin\vc120debugs\glogger_d.pdbâ€ /DYNAMICBASE:NO â€œWHCMN_d.libâ€ â€œWHNET_d.libâ€ â€œPNGS_d.libâ€ â€œcryptlib_d.libâ€ â€œzlib_d.libâ€ â€œkernel32.libâ€ â€œuser32.libâ€ â€œgdi32.libâ€ â€œwinspool.libâ€ â€œcomdlg32.libâ€ â€œadvapi32.libâ€ â€œshell32.libâ€ â€œole32.libâ€ â€œoleaut32.libâ€ â€œuuid.libâ€ â€œodbc32.libâ€ â€œodbccp32.libâ€ /FIXED /LARGEADDRESSAWARE /IMPLIB:â€F:\zentia\server\bin\vc120debugs\glogger_d.libâ€ /DEBUG /MACHINE:X86 /OPT:NOREF /SAFESEH:NO /INCREMENTAL /PGD:â€F:\zentia\server\bin\vc120debugs\glogger_d.pgdâ€ /SUBSYSTEM:CONSOLEâ€,5.01â€ /MANIFESTUAC:â€level=â€™asInvokerâ€™ uiAccess=â€™falseâ€™â€ /ManifestFile:â€F:\zentia\server\temp\vc120\glogger2010\debug\glogger_d.exe.intermediate.manifestâ€ /OPT:NOICF /ERRORREPORT:PROMPT /NOLOGO /LIBPATH:â€F:\zentia\server\src\svr\glogger\/lib/win32â€ /LIBPATH:â€F:\zentia\server\lib\vc120lib\â€ /LIBPATH:â€F:\zentia\server\3rd\lib\vc120\â€ /LIBPATH:â€F:\zentia\server\3rd\libâ€ /LIBPATH:â€%(AdditionalLibraryDirectories)â€ /TLBID:1g++ -DLINUX -D_FILE_OFFSET_BITS=64 -D_LARGEFILE64_SOURCE -D_LARGEFILE_SOURCE -Wall -Wno-multichar -g -D_DEBUG -DPG_MEMORY_DISABLE_POOL -march=core2 -m32 -rdynamic -std=c++0x -o ../../bin/debug/svr/GBNMS/GBNMS_d.so ../../temp/debug/svr/GBNMS/GBNMS.s.o_d /root/work_code/src/lib/libGBNMS_Lib_d.s.a /root/work_code/src/lib/libDIA_d.s.a /root/work_code/src/lib/libPNGS_d.s.a /root/work_code/src/lib/lib WHNET_d.s.a /root/work_code/src/lib/libWHCMN_d.s.a /usr/lib64/mysql/libmysqlclient_r.a -lz -lpthread -ldl -lrt -march=prescott -shared -L/root/work_code/3rd/lib -L/root/work_code/src/lib æ‹‰åˆ†æ”¯svnserve -d -r /var/svnå¯åŠ¨svnæœåŠ¡å™¨ï¼Œä½†æ˜¯å®¢æˆ·ç«¯è¿˜æ˜¯ä¸€ç›´è¿æ¥ä¸ä¸Š svn info æŸ¥çœ‹åº“ç‰ˆæœ¬è·¯å¾„ å®¢æˆ·ç«¯ä¸€ç›´è¿æ¥ä¸ä¸ŠæœåŠ¡å™¨ï¼Œæœ€åå‘ç°æ˜¯é˜²ç«å¢™çš„é—®é¢˜ï¼Œæœ€æš´åŠ›ç›´æ¥å…³æ‰é˜²ç«å¢™å°±å¥½å•¦ã€‚ post-commit.tmplå®ƒåœ¨äº‹åŠ¡å¤–åŸåè¿è¡Œï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ä¿®è®¢ç‰ˆæœ¬ã€‚å¤§å¤šæ•°äººç”¨è¿™ä¸ªé’©å­æ¥å‘é€å…³äºæäº¤çš„æè¿°æ€§é‚®ä»¶ï¼Œæˆ–è€…ä½œä¸ºç‰ˆæœ¬åº“çš„å¤‡ä»½ã€‚ç‰ˆæœ¬åº“ä¼ ç»™ç¨‹åºä¸¤ä¸ªå‚æ•°ï¼šåˆ°ç‰ˆæœ¬åº“çš„è·¯å¾„å’Œè¢«åˆ›å»ºçš„æ–°çš„ä¿®è®¢ç‰ˆæœ¬å·ã€‚é€€å‡ºç¨‹åºæ—¶è¢«å¿½ç•¥ã€‚ å…³é—­é˜²ç«å¢™é‡å¯åç”Ÿæ•ˆå¼€å¯: chkconfig iptables onå…³é—­: chkconfig iptables offå³æ—¶ç”Ÿæ•ˆï¼Œé‡å¯åå¤±æ•ˆå¼€å¯ï¼šservice iptables startå…³é—­ï¼šservice iptables stop æŸ¥çœ‹ç£ç›˜ç©ºé—´df -h åˆ›å»ºç‰ˆæœ¬åº“12345678mkdir /var/svn# è¿›å…¥svnç›®å½•cd /var/svn # ç”¨svnç®¡ç†å‘˜åˆ›å»ºbigsvrsvnadmin create /var/svn/bigsvr# è¿›å…¥åº“cd bigsvr subversionç›®å½•è¯´æ˜db æ‰€æœ‰ç‰ˆæœ¬æ§åˆ¶çš„æ•°æ®å­˜æ”¾ç›®å½•hooks æ”¾ç½®hookè„šæœ¬locks ç”¨æˆ·æ“ä½œçš„é”æ–‡ä»¶format è®°å½•å½“å‰æ–‡ä»¶åº“çš„ç‰ˆæœ¬å·conf é…ç½®æ–‡ä»¶ Svnå‘½ä»¤è¡Œæ€»ç»“ ä¸Šä¼ é¡¹ç›®åˆ°SVNæœåŠ¡å™¨ä¸Š svn import project_dir(æœ¬åœ°é¡¹ç›®å…¨è·¯å¾„) ä¸‹è½½checkout svné¡¹ç›®åˆ°æœ¬åœ° svn checkout ç®€å†™ï¼šsvn co æ·»åŠ æ–°æ–‡ä»¶ svn add file(æ–‡ä»¶å) svn add *.php(æ·»åŠ å½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„phpæ–‡ä»¶) æäº¤åˆ°ç‰ˆæœ¬åº“ svn commit -m â€œLogMessageâ€ [-N] [â€”no-unlock] PATH(å¦‚æœé€‰æ‹©äº†ä¿æŒé”ï¼Œå°±ä½¿ç”¨â€”no-unlockå¼€å…³) æ›´æ–°æ–‡ä»¶ svn update svn update -r ä¿®æ­£ç‰ˆæœ¬ æ–‡ä»¶å svn update (åé¢æ²¡æœ‰ç›®å½•ï¼Œé»˜è®¤å°†å½“å‰ç›®å½•ä»¥åŠå­ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬) svn update -r 200 test.cpp (å°†ç‰ˆæœ¬åº“ä¸­çš„æ–‡ä»¶test.cppè¿˜åŸåˆ°ä¿®æ­£ç‰ˆæœ¬(revision)200) svn update test.php (æ›´æ–°äºç‰ˆæœ¬åº“åŒæ­¥) è®¾ç½®å¿½ç•¥ svn propset svn:ignore Temp . relocate svn switch â€”relocate svn://18.223.184.177/project/ss/ss/bin/data svn://18.223.184.177/project/ss/ss/bin/data]]></content>
      <tags>
        <tag>svn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Centos7ä¸‹ vim]]></title>
    <url>%2F2017%2F10%2F14%2Fvi%2F</url>
    <content type="text"><![CDATA[1yum -y install vim ç¯å¢ƒé…ç½® /etc/vimrc å…¨å±€ vim ~/.vimrc æ–°å»º1234567set nu // è¡Œå·set showmode //æ˜¾ç¤ºå½“å‰æ¨¡å¼set ruler //æ˜¾ç¤ºè¡Œæ•°ä¿¡æ¯set autoindent //å›è½¦å¯¹é½syntax on //è¯­æ³•æ£€æµ‹set encoding=urf-8 fileencodings=ucs-born,utf-8,cp936 //è‡ªåŠ¨è¯†åˆ«ç¼–ç ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œç”¨latin-1(ASCII)ç¼–ç æ‰“å¼€(è§£å†³ä¹±ç é—®é¢˜)set ts=4 //å››ä¸ªç©ºæ ¼ viæŸ¥çœ‹æ–‡ä»¶ç¼–ç æ ¼å¼ :set fileencoding:edit ++enc=utf-8 æœ€åæ¥çœ‹çœ‹å¤„ç†ä¸­æ–‡æ–‡æ¡£æœ€å…¸å‹çš„å‡ ç§æƒ…å†µå’Œè®¾ç½®æ–¹å¼ï¼š 1ï¼Œç³»ç»Ÿlocaleæ˜¯utf-8ï¼ˆå¾ˆå¤šlinuxç³»ç»Ÿé»˜è®¤çš„localeå½¢å¼ï¼‰ï¼Œç¼–è¾‘çš„æ–‡æ¡£æ˜¯GB2312æˆ–GBKå½¢å¼çš„ï¼ˆWindowsè®°äº‹æœ¬ é»˜è®¤ä¿å­˜å½¢å¼ï¼Œå¤§éƒ¨åˆ†ç¼–è¾‘å™¨ä¹Ÿé»˜è®¤ä¿å­˜ä¸ºè¿™ä¸ªå½¢å¼ï¼Œæ‰€ä»¥æœ€å¸¸è§ï¼‰ï¼Œç»ˆç«¯ç±»å‹utf-8ï¼ˆä¹Ÿå°±æ˜¯å‡å®šå®¢æˆ·ç«¯æ˜¯puttyç±»çš„unicodeè½¯ä»¶ï¼‰ åˆ™vimæ‰“å¼€æ–‡æ¡£åï¼Œencoding=utf-8ï¼ˆlocaleå†³å®šçš„ï¼‰ï¼Œfileencoding=latin1ï¼ˆè‡ªåŠ¨ç¼–ç åˆ¤æ–­æœºåˆ¶ä¸å‡†å¯¼è‡´çš„ï¼‰ï¼Œtermencoding=ç©ºï¼ˆé»˜è®¤æ— éœ€è½¬æ¢termç¼–ç ï¼‰ï¼Œæ˜¾ç¤ºæ–‡ä»¶ä¸ºä¹±ç ã€‚ è§£å†³æ–¹æ¡ˆ1ï¼šé¦–å…ˆè¦ä¿®æ­£fileencodingä¸ºcp936æˆ–è€…euc-cnï¼ˆäºŒè€…ä¸€æ ·çš„ï¼Œåªä¸è¿‡å«æ³•ä¸åŒï¼‰ï¼Œæ³¨æ„ä¿®æ­£çš„æ–¹æ³•ä¸æ˜¯:set fileencoding=cp936ï¼Œè¿™åªæ˜¯å°†æ–‡ä»¶ä¿å­˜ä¸ºcp936ï¼Œæ­£ç¡®çš„æ–¹æ³•æ˜¯é‡æ–°ä»¥cp936çš„ç¼–ç æ–¹å¼åŠ è½½æ–‡ä»¶ä¸º:edit ++enc=cp936ï¼Œå¯ä»¥ç®€å†™ä¸º:e ++enc=cp936ã€‚ è§£å†³æ–¹æ¡ˆ2ï¼šä¸´æ—¶æ”¹å˜vimè¿è¡Œçš„localeç¯å¢ƒï¼Œæ–¹æ³•æ˜¯ä»¥LANG=zh_CN vim abc.txtçš„æ–¹å¼æ¥å¯åŠ¨vimï¼Œåˆ™æ­¤æ—¶encoding=euc-cnï¼ˆlocaleå†³å®šçš„ï¼‰ï¼Œfileencoding=ç©ºï¼ˆæ­¤localeä¸‹æ–‡ä»¶ ç¼–ç è‡ªåŠ¨åˆ¤åˆ«åŠŸèƒ½ä¸å¯ç”¨ï¼Œæ‰€ä»¥fileencodingä¸ºæ–‡ä»¶æœ¬èº«ç¼–ç æ–¹å¼ä¸å˜ï¼Œä¹Ÿå°±æ˜¯euc-cnï¼‰ï¼Œtermencoding=ç©ºï¼ˆé»˜è®¤å€¼ï¼Œä¸ºç©ºåˆ™ç­‰ äºencodingï¼‰æ­¤æ—¶è¿˜æ˜¯ä¹±ç çš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„sshç»ˆç«¯è®¤ä¸ºæ¥å—çš„æ•°æ®ä¸ºutf-8ï¼Œä½†vimå‘é€æ•°æ®ä¸ºeuc-cnï¼Œæ‰€ä»¥è¿˜æ˜¯ä¸å¯¹ã€‚æ­¤æ—¶å†ç”¨å‘½ä»¤: set termencoding=utf-8å°†ç»ˆç«¯æ•°æ®è¾“å‡ºä¸ºutf-8ï¼Œåˆ™æ˜¾ç¤ºæ­£å¸¸ã€‚ 2ï¼Œæƒ…å†µä¸1åŸºæœ¬ç›¸åŒï¼Œåªæ˜¯ä½¿ç”¨çš„sshè½¯ä»¶ä¸ºsecure CRTç±»ansiç±»è½¯ä»¶ã€‚ vimæ‰“å¼€æ–‡æ¡£åï¼Œencoding=utf-8ï¼ˆlocaleå†³å®šçš„ï¼‰ï¼Œfileencoding=latin1ï¼ˆè‡ªåŠ¨ç¼–ç åˆ¤æ–­æœºåˆ¶ä¸å‡†å¯¼è‡´çš„ï¼‰ï¼Œtermencoding=ç©ºï¼ˆé»˜è®¤æ— éœ€è½¬æ¢termç¼–ç ï¼‰ï¼Œæ˜¾ç¤ºæ–‡ä»¶ä¸ºä¹±ç ã€‚ è§£å†³æ–¹æ¡ˆ1ï¼šé¦–å…ˆè¦ä¿è¯è¿è¡Œsecure CRTçš„windowsæœºå™¨çš„é»˜è®¤ä»£ç é¡µä¸ºCP936ï¼Œè¿™ä¸€ç‚¹ä¸­æ–‡windowså·²ç»æ˜¯é»˜è®¤è®¾ç½®äº†ã€‚å…¶ä»–çš„ä¸ä¸Šé¢æ–¹æ¡ˆ1ç›¸åŒï¼Œåªæ˜¯è¦å¢åŠ ä¸€æ­¥ï¼Œ:set termencoding=cp936 è§£å†³æ–¹æ¡ˆ2ï¼šä¸ä¸Šé¢æ–¹æ¡ˆ2ç±»ä¼¼ï¼Œä¸è¿‡æœ€åä¸€æ­¥ä¿®æ”¹termencodingçœç•¥å³å¯ï¼Œåœ¨æ­¤æƒ…å†µä¸‹éœ€è¦çš„ä¿®æ”¹æœ€å°‘ï¼Œåªè¦ä»¥localeä¸ºzh_CNå¼€ å¯vimï¼Œåˆ™encoding=euc-cnï¼Œfileencodingå’Œtermencodingéƒ½ä¸ºç©ºå³ä¸ºencodingçš„å€¼ï¼Œæ˜¯æœ€ç†æƒ³çš„ä¸€ç§æƒ… å†µã€‚ å¯è§ç†è§£è¿™3ä¸ªå…³é”®ç‚¹å’Œ3ä¸ªå‚æ•°çš„æ„ä¹‰ï¼Œå¯¹äºç¼–ç é—®é¢˜æœ‰å¾ˆå¤§åŠ©åŠ›ï¼Œä»¥åå°±å¯ä»¥éšå¿ƒæ‰€æ¬²çš„å¤„ç†æ–‡æ¡£äº†ï¼ŒåŒæ—¶ä¸ä»…ä»…æ˜¯åº”ç”¨äºvimï¼Œåœ¨å…¶ä»–éœ€è¦ç¼–ç è½¬æ¢çš„ç¯å¢ƒé‡Œï¼Œéƒ½å¯ä»¥åº”ç”¨ç±»ä¼¼çš„æ€è·¯æ¥å¤„ç†é—®é¢˜è§£å†³é—®é¢˜ã€‚ è¡Œè·³è½¬ 12gg / 12G :12 æ‰“å¼€æ–‡ä»¶æ—¶è¾“å…¥vim +12 filename vim ç²¾ç¡®åŒ¹é…æŸ¥æ‰¾å•è¯ç²¾ç¡®åŒ¹é…æŸ¥æ‰¾å•è¯å¦‚æœä½ è¾“å…¥ â€œ/theâ€ï¼Œä½ ä¹Ÿå¯èƒ½æ‰¾åˆ°â€thereâ€ã€‚è¦æ‰¾åˆ°ä»¥â€theâ€ç»“å°¾çš„å•æ¬¡ï¼Œå¯ä»¥ç”¨: /the> â€œ>â€œæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è®°å·ï¼Œè¡¨ç¤ºåªåŒ¹é…å•è¯æœ«å°¾ã€‚ç±»ä¼¼çš„ï¼Œâ€\&lt;â€ åªåŒ¹é…å•è¯çš„å¼€å¤´ã€‚è¿™æ ·è¦åŒ¹é…ä¸€ä¸ªå®Œæ•´çš„å•è¯â€theâ€ï¼Œåªéœ€è¦: /\ :e åˆ·æ–°æ–‡ä»¶å†…å®¹]]></content>
      <tags>
        <tag>vi</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Mysql]]></title>
    <url>%2F2017%2F10%2F14%2Fmysql%2F</url>
    <content type="text"><![CDATA[ä¿®æ”¹mysqlå¯†ç 12345mysql -uroot -puse mysql;UPDATE user SET password=password(&quot;123456&quot;) WHERE user=&apos;root&apos;; flush privileges;exit; 1SHOW DATABASES; é¦–å…ˆCentOS7 å·²ç»ä¸æ”¯æŒmysqlï¼Œå› ä¸ºæ”¶è´¹äº†ä½ æ‡‚å¾—ï¼Œæ‰€ä»¥å†…éƒ¨é›†æˆäº†mariadbï¼Œè€Œå®‰è£…mysqlçš„è¯ä¼šå’Œmariadbçš„æ–‡ä»¶å†²çªï¼Œæ‰€ä»¥éœ€è¦å…ˆå¸è½½æ‰mariadbï¼Œä»¥ä¸‹ä¸ºå¸è½½mariadbï¼Œå®‰è£…mysqlçš„æ­¥éª¤ã€‚ åˆ—å‡ºæ‰€æœ‰è¢«å®‰è£…çš„rpm packagerpm -qa | grep mariadb å¸è½½rpm -e mariadb-libs-5.5.37-1.el7_0.x86_64é”™è¯¯ï¼šä¾èµ–æ£€æµ‹å¤±è´¥ï¼šlibmysqlclient.so.18()(64bit) è¢« (å·²å®‰è£) postfix-2:2.10.1-6.el7.x86_64 éœ€è¦libmysqlclient.so.18(libmysqlclient_18)(64bit) è¢« (å·²å®‰è£) postfix-2:2.10.1-6.el7.x86_64 éœ€è¦ å¼ºåˆ¶å¸è½½ï¼Œå› ä¸ºæ²¡æœ‰â€”nodepsrpm -e â€”nodeps mariadb-libs-5.5.37-1.el7_0.x86_64 å®‰è£…mysqlä¾èµ–yum install vim libaio net-tools å…¶ä»–æƒ…å†µï¼š 1ã€centosä¸‹yumæš‚æ—¶æ²¡æœ‰mysql-serverç›´æ¥å®‰è£…åŒ…ï¼›MariaDBæ˜¯MySQLç¤¾åŒºå¼€å‘çš„åˆ†æ”¯ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¢å¼ºå‹çš„æ›¿ä»£å“; 2ã€å®‰è£…MariaDBï¼ˆç›®å‰è¿˜æ˜¯å…ˆä¸è¦å®‰è£…äº†ï¼‰yum -y install mariadb-server mariadb mariadb-develsystemctl start mariadbsystemctl enable mariadbmysql_secure_installationfirewall-cmd â€”permanent â€”add-service mysqlsystemctl restart firewalld.serviceiptables -L -n|grep 3306 CentOS7çš„yumæºä¸­é»˜è®¤å¥½åƒæ˜¯æ²¡æœ‰mysqlçš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è¦å…ˆä¸‹è½½mysqlçš„repoæºã€‚ ä¸‹è½½mysqlçš„repoæº $ wget http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm å®‰è£…mysql-community-release-el7-5.noarch.rpmåŒ… $ sudo rpm -ivh mysql-community-release-el7-5.noarch.rpm å®‰è£…è¿™ä¸ªåŒ…åï¼Œä¼šè·å¾—ä¸¤ä¸ªmysqlçš„yum repoæºï¼š/etc/yum.repos.d/mysql-community.repoï¼Œ/etc/yum.repos.d/mysql-community-source.repoã€‚ å®‰è£…mysql $ sudo yum install mysql-serveræ ¹æ®æ­¥éª¤å®‰è£…å°±å¯ä»¥äº†ï¼Œä¸è¿‡å®‰è£…å®Œæˆåï¼Œæ²¡æœ‰å¯†ç ï¼Œéœ€è¦é‡ç½®å¯†ç ã€‚ é‡ç½®å¯†ç é‡ç½®å¯†ç å‰ï¼Œé¦–å…ˆè¦ç™»å½•$ mysql -u rootç™»å½•æ—¶æœ‰å¯èƒ½æŠ¥è¿™æ ·çš„é”™ï¼šERROR 2002 (HY000): Canâ€˜t connect to local MySQL server through socket â€˜/var/lib/mysql/mysql.sockâ€˜ (2)ï¼ŒåŸå› æ˜¯/var/lib/mysqlçš„è®¿é—®æƒé™é—®é¢˜ã€‚ä¸‹é¢çš„å‘½ä»¤æŠŠ/var/lib/mysqlçš„æ‹¥æœ‰è€…æ”¹ä¸ºå½“å‰ç”¨æˆ·ï¼š$ sudo chown -R openscanner:openscanner /var/lib/mysqlç„¶åï¼Œé‡å¯æœåŠ¡ï¼š$ service mysqld restart å¼€æ”¾3306ç«¯å£$ sudo vim /etc/sysconfig/iptablesæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š-A INPUT -p tcp -m state â€”state NEW -m tcp â€”dport 3306 -j ACCEPTä¿å­˜åé‡å¯é˜²ç«å¢™ï¼š$ sudo service iptables restartè¿™æ ·ä»å…¶å®ƒå®¢æˆ·æœºä¹Ÿå¯ä»¥è¿æ¥ä¸ŠmysqlæœåŠ¡äº†ã€‚MYSQLå¯åŠ¨åæŠ¥ï¼šERROR! The server quit without updating PID fileé”™è¯¯çš„é—®é¢˜è§£å†³MYSQLæ—¥å¿—ï¼šCanâ€™t find file: â€˜./mysql/plugin.frmâ€™ (errno: 13 - Permission denied) æƒé™ä¸å¤Ÿï¼šchown -R mysql:mysql /home/mysql/dataâ€ chmod -R 755 /home/mysql/data centos7çš„selinuxé—®é¢˜ï¼šæ‰“å¼€/etc/selinux/configï¼ŒæŠŠSELINUX=enforcingæ”¹ä¸ºSELINUX=disabledåå­˜ç›˜é€€å‡ºé‡å¯æœºå™¨ã€‚æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹çš„åˆ›å»ºä»£ç show create procedure proc_name; ERROR 1728 (HY000): Cannot load from mysql.proc. The table is probably corruptedã€é”™è¯¯è¿‡ç¨‹ã€‘ï¼šMySQLä»5.1å‡çº§è‡³5.5ååœ¨è°ƒç”¨å­˜å‚¨è¿‡ç¨‹æ—¶æŠ¥å‡ºâ€œCannot load from mysql.proc. The table is probably corruptedã€‚â€ã€é€ æˆåŸå› ã€‘ï¼šMySQLå‡çº§å®Œæˆåæœªå¯¹ç›¸å…³æ•°æ®åº“æ‰§è¡Œå‡çº§.ã€è§£å†³åŠæ³•ã€‘ï¼šåœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œmysql_upgrade -uroot -p å³å¯~ æŸ¥çœ‹Mysqlç«¯å£show global variables like &#39;port&#39;; å­—ç¬¦é›†ç³»ç»Ÿå˜é‡ character_set_server é»˜è®¤çš„å†…éƒ¨æ“ä½œå­—ç¬¦é›† character_set_client å®¢æˆ·ç«¯æ¥æºæ•°æ®ä½¿ç”¨çš„å­—ç¬¦é›† character_set_connection è¿æ¥å±‚å­—ç¬¦é›† character_set_results æŸ¥è¯¢ç»“æœå­—ç¬¦é›† character_set_database å½“å‰é€‰ä¸­æ•°æ®åº“çš„é»˜è®¤å­—ç¬¦é›† character_set_system ç³»ç»Ÿå…ƒæ•°æ®ï¼ˆå­—æ®µåç­‰ï¼‰å­—ç¬¦é›† æŸ¥çœ‹show variables like &#39;character_set_database&#39;; show variables like &#39;%character%&#39;; show variables like &#39;collation%&#39;; ä¿®æ”¹ä¸´æ—¶ä¿®æ”¹alter database xxx CHARACTER SET gb2312; // ä¿®æ”¹åº“çš„å­—ç¬¦é›† SET character_set_client = utf8; æ°¸ä¹…ä¿®æ”¹ä¿®æ”¹my.cnf ä½ç½®åœ¨/etc/my.cnfåœ¨[mysqld]ä¸Šé¢åŠ ä¸‹é¢ä¸¤å¥è¯ [client] default-character-set=utf8 åœ¨[mysqld]æœ€ä¸‹é¢åŠ å…¥ä¸‹é¢å‡ å¥è¯ default-storage-engine=INNODB character-set-server=utf8 collation-server=utf8_general_ci ç„¶åä¿å­˜ é‡å¯Mysql service mysqld restart æŸ¥çœ‹MYSQLæ‰€æ”¯æŒçš„å­—ç¬¦é›†show charset; æŸ¥çœ‹åº“çš„å­—ç¬¦é›†show create database db_xxsy_game_1004\G; æŸ¥çœ‹è¡¨çš„å­—ç¬¦é›†show table status from db_xxsy_game_1004 like &#39;common_accounts&#39;; CentOS7 å¼€æ”¾3306ç«¯å£è®¿é—®CentOS 7.0é»˜è®¤ä½¿ç”¨çš„æ˜¯firewallä½œä¸ºé˜²ç«å¢™ï¼Œè¿™é‡Œæ”¹ä¸ºiptablesé˜²ç«å¢™ã€‚1ã€å…³é—­firewallï¼šsystemctl stop firewalld.servicesystemctl disable firewalld.servicesystemctl mask firewalld.service 2ã€å®‰è£…iptablesé˜²ç«å¢™yum install iptables-services -y 3.å¯åŠ¨è®¾ç½®é˜²ç«å¢™ # systemctl enable iptables # systemctl start iptables 4.æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ systemctl status iptables 5ç¼–è¾‘é˜²ç«å¢™ï¼Œå¢åŠ ç«¯å£vi /etc/sysconfig/iptables #ç¼–è¾‘é˜²ç«å¢™é…ç½®æ–‡ä»¶-A INPUT -m state â€”state NEW -m tcp -p tcp â€”dport 22 -j ACCEPT-A INPUT -m state â€”state NEW -m tcp -p tcp â€”dport 80 -j ACCEPT-A INPUT -m state â€”state NEW -m tcp -p tcp â€”dport 3306 -j ACCEPT:wq! #ä¿å­˜é€€å‡º 3.é‡å¯é…ç½®ï¼Œé‡å¯ç³»ç»Ÿsystemctl restart iptables.service #é‡å¯é˜²ç«å¢™ä½¿é…ç½®ç”Ÿæ•ˆsystemctl enable iptables.service #è®¾ç½®é˜²ç«å¢™å¼€æœºå¯åŠ¨ Host â€˜192.168.171.128â€™ is not allowed to connect to this MySQL serverERROR 1044 (42000):Access denied for user â€˜â€™@â€™localhostâ€™ to database â€˜mysqlâ€™åœ¨mysqlæ•°æ®åº“çš„userè¡¨é‡Œï¼Œå­˜åœ¨ç”¨æˆ·åä¸ºç©ºçš„è´¦æˆ·å³ä¸ºåŒ¿åè´¦æˆ·ï¼Œå¯¼è‡´ç™»é™†çš„æ—¶å€™è™½ç„¶ç”¨çš„æ—¶rootï¼Œä½†å®é™…æ—¶åŒ¿åç™»é™†çš„ã€‚è§£å†³åŠæ³•ï¼š å…³é—­mysqlservice mysqld stop å±è”½æƒé™mysqld_safe â€”skip-grant-table æ–°å¼€ä¸€ä¸ªç»ˆç«¯mysql -u root mysqldelete from user where user=â€™â€™;flush privileges; mysql.h no found file or directoryyum install mysql-devel æ•°æ®ç±»å‹ è§£é‡Š å­˜å‚¨èŒƒå›´ å­—èŠ‚ TINYINT æœ‰ç¬¦å·å€¼:-128åˆ°127unsigned : [0 255] 1 SMALLINT signed[-32768,32767]unsigned [0,65535] 2 BINARY ç”¨æ¥è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ® VARBINARY å¤§å°å†™å¿½ç•¥ CHARå’ŒVARCHARç±»å‹éƒ½ç”¨æ¥å­˜å‚¨å­—ç¬¦ä¸²VARCHAR å¯ä»¥å­˜å‚¨å¯å˜é•¿åº¦çš„å­—ç¬¦ä¸²CHAR å­˜å‚¨å®šé•¿å­—ç¬¦ä¸²å®šä¹‰å¦‚ä¸‹CHAR(M)æˆ–è€…VARCHAR(M)MæŒ‡çš„æ˜¯å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦æ¯”å¦‚æ’å…¥å€¼â€™abâ€™CHAR(4) éœ€è¦4ä¸ªå­—èŠ‚VARCHAR(4) éœ€è¦3ä¸ªå­—èŠ‚å½“æ•°æ®ä¸ºCHAR(M)ç±»å‹æ—¶ï¼Œä¸ç®¡æ’å…¥å€¼çš„é•¿åº¦æ˜¯å¤šå°‘ï¼Œæ‰€å ç”¨çš„å­˜å‚¨ç©ºé—´éƒ½æ˜¯Mä¸ªå­—èŠ‚ã€‚å½“ä¸ºVARCHAR(M)ç±»å‹æ—¶ï¼Œæ‰€å ç”¨çš„å­—èŠ‚æ•°ä¸ºå®é™…é•¿åº¦åŠ 1ã€‚ BINARYå’ŒVARBINARYç±»å‹ç±»ä¼¼äºCHARå’ŒVARCHARç”¨æ¥è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®å®šä¹‰å¦‚ä¸‹BINARY(M)æˆ–è€…VARBINARY(M)MæŒ‡çš„æ˜¯äºŒè¿›åˆ¶æ•°æ®çš„æœ€å¤§å­—èŠ‚é•¿åº¦æ³¨æ„BINARYç±»å‹çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œå¦‚æœæ•°æ®çš„é•¿åº¦ä¸è¶³æœ€å¤§é•¿åº¦ï¼Œåœ¨åé¢ç”¨â€\0â€è¡¥é½ã€‚æ¯”å¦‚ï¼Œæ•°æ®ç±»å‹ä¸ºBINARY(3)ï¼Œå½“æ’å…¥aæ—¶ï¼Œå®é™…å­˜å‚¨çš„æ—¶â€a\0\0â€ Centos7å®‰è£…Mysqlyum install mysql yum install mysql-devel yum install mariadb-server mariadb systemctl start mariadb]]></content>
      <tags>
        <tag>Mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[äº‘ä¸»æœºCentOS7.2å¯†é’¥ä¸¢å¤±é‡æ–°æ³¨å…¥å¯†é’¥æ–¹æ³•]]></title>
    <url>%2F2017%2F10%2F13%2Fcentos%2F</url>
    <content type="text"><![CDATA[ä¸€ã€å•ç”¨æˆ·æ¨¡å¼é‡ç½®ROOTå¯†ç ï¼ˆå¦‚æœ‰rootå¯†ç ï¼Œåˆ™è·³è¿‡è¯¥æ­¥éª¤ï¼‰ ç™»å½•æ§åˆ¶å°ï¼Œè¾“å…¥VNCå¯†ç å¹¶å›è½¦ ç‚¹å‡»ã€Send CtrlAltDelã€‘é‡å¯linuxç³»ç»Ÿï¼› åœ¨å¼¹å‡ºç•Œé¢ï¼ŒæŒ‰é”®ç›˜â€˜eâ€™ï¼›4ã€å¦‚å›¾ä¿®æ”¹å‰/ä¿®æ”¹åï¼Œå°†roä¿®æ”¹æˆrw init=/sysroot/bin/sh å»é™¤console=ttyS0 115200ï¼Œç¡®è®¤ä¿®æ”¹å®Œæˆåï¼Œé”®ç›˜è¾“å…¥CtrlåŠ xã€‚ 5ã€ä¾æ¬¡è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼šchroot /sysroot/ passwd root touch /.autorelabelè¿›è¡Œrootå¯†ç ä¿®æ”¹6ã€è¿”å›äº‘ä¸»æœºä¾§ç‚¹å‡»ã€é‡å¯ã€‘ä½¿å¾—å¯†ç ä¿®æ”¹ç”Ÿæ•ˆ7ã€å¾…äº‘ä¸»æœºé‡å¯å®Œæˆåï¼Œè¿›å…¥VNCè¾“å…¥ç”¨æˆ·årootï¼Œä¿®æ”¹åçš„å¯†ç è¿›å…¥ç³»ç»Ÿ]]></content>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Git æœåŠ¡å™¨æ­å»º]]></title>
    <url>%2F2017%2F10%2F13%2Fgit-server%2F</url>
    <content type="text"><![CDATA[é¦–å…ˆè¦æ˜ç¡®ç°åœ¨ä»£ç çš„åˆ†å¸ƒæƒ…å†µï¼Œå¼€å‘è€…ç”µè„‘ä¸Šçš„æœ¬åœ°ä»“åº“ï¼ŒgitæœåŠ¡å™¨ä¸Šçš„è¿œç«¯ä»“åº“ï¼ŒwebæœåŠ¡å™¨ä¸Šçš„å¦ä¸€ä¸ªæœ¬åœ°ä»“åº“ï¼Œæˆ‘ä»¬æµè§ˆå™¨è®¿é—®çš„å°±æ˜¯è¿™é‡Œçš„ä»£ç ã€‚å…¶å®è‡ªåŠ¨éƒ¨ç½²å°±æ˜¯è¦å½“å¼€å‘è€…æœ¬åœ°ä»“åº“æäº¤ä»£ç åˆ°è¿œç«¯ä»“åº“çš„æ—¶å€™ï¼Œè‡ªåŠ¨æŠŠä»£ç éƒ¨ç½²åˆ°webæœåŠ¡å™¨çš„æœ¬åœ°ä»“åº“ï¼Œå®ç°å¼€å‘ç€æœ¬åœ°ä»“åº“å’ŒwebæœåŠ¡å™¨çš„æœ¬åœ°ä»“åº“åŒæ­¥ã€‚ï¼ˆå³é€šè¿‡GitHookä¸­çš„post-receiveè„šæœ¬æ–‡ä»¶ï¼‰ 1ã€å®‰è£…Git12yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel perl-develyum install git æ¥ä¸‹æ¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªgitç”¨æˆ·ç»„å’Œç”¨æˆ·ï¼Œç”¨æ¥è¿è¡ŒgitæœåŠ¡ï¼š12groupadd gitadduser git -g git 3ã€åˆå§‹åŒ–Gitä»“åº“12$ git init --bare runoob.gitInitialized empty Git repository in /home/gitrepo/ git init ä½¿ç”¨å½“å‰ç›®å½•ä½œä¸ºGitä»“åº“,è¯¥å‘½ä»¤æ‰§è¡Œå®Œåå›ç”Ÿæˆä¸€ä¸ª.gitç›®å½•git init zentia æŒ‡å®šç›®å½•åˆ›å»ºGitä»“åº“ ä¿®æ”¹/etc/ssh/sshd_configæ–‡ä»¶ï¼Œå°†å…¶ä¸­çš„PermitRootLogin noä¿®æ”¹ä¸ºyes,PublicAuthentication yesä¿®æ”¹ä¸ºno,AuthorizedKeysFile .ssh/authorized_keyså‰é¢åŠ ä¸Šçš„#å±è”½æ‰,PasswordAuthentication noä¿®æ”¹ä¸ºyeså°±å¯ä»¥äº†ssh -l username hostname åœ¨æœåŠ¡å™¨checkoutå‡ºä¸€ä»½ä»£ç 123# In remote servercd ~git clone sample.git/ my_repo è¿™ä¸ªæ—¶å€™å°±ä¼šå‡ºç°my_repoæ–‡ä»¶å¤¹ï¼Œé‡Œé¢å°±ä¼šæœ‰ä½ çš„ä»£ç ã€‚åŒæ—¶ï¼Œè¿™ä¸ªä»£ç æ–‡ä»¶å¤¹çš„é»˜è®¤originè¿œç«¯ï¼ˆremoteï¼‰å°±ä¼šå˜æˆmy_repoæ–‡ä»¶å¤¹ã€‚å½“ä½ åšgit fetch git pullç­‰åŠ¨ä½œçš„æ—¶å€™å°±ä¼šä»my_repoå–ä¿¡æ¯ã€‚3.é…ç½®Git Hookè¿›å…¥åˆ°/home/gitrepo/sample.gitæ–‡ä»¶å¤¹ï¼Œä½¿ç”¨vi post-receiveåˆ›å»ºä¸€ä¸ªè„šæœ¬ï¼Œå½“ä½ åœ¨æœ¬åœ°ä»“åº“æ‰§è¡Œgit pushåå°±ä¼šè§¦å‘post-receiveã€‚ /usr/games/project.git/git clone git@ec2-18-191-158-223.us-east-2.compute.amazonaws.com:/usr/games/project.git/æ·»åŠ åˆ°æœ¬åœ°ä»“åº“ git add . æ·»åŠ æäº¤æè¿° git commit -m â€˜å†…å®¹â€™ æäº¤å‰å…ˆä»è¿œç¨‹ä»“åº“ğŸ–åˆ†æ”¯ä¸­æ‹‰å–è¯·æ±‚ git pull origin master æŠŠæœ¬åœ°ä»“åº“ä»£ç æäº¤ git push -u origin master æŸ¥çœ‹è¿œç¨‹ä»“åº“åœ°å€ git remote -v]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[git clone å‘½ä»¤]]></title>
    <url>%2F2017%2F10%2F13%2Fgit-clone%2F</url>
    <content type="text"><![CDATA[git clone å‘½ä»¤å°†å­˜å‚¨åº“å…‹éš†åˆ°æ–°ç›®å½•ä¸­ã€‚]]></content>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ssh]]></title>
    <url>%2F2017%2F10%2F13%2Fssh-key%2F</url>
    <content type="text"><![CDATA[sshä¸­ï¼Œæœ‰ä¸¤ä¸ªé’¥åŒ™ï¼šå…¬é’¥ã€ç§é’¥ï¼Œå…¬é’¥ä¸»è¦æ˜¯ç”¨äºå¯¹ä¸€äº›æ•æ„Ÿä¿¡æ¯è¿›è¡ŒåŠ å¯†ï¼Œç§é’¥é€‚ç”¨äºè§£å¯†ã€‚sshçš„æ–‡ä»¶éƒ½å­˜åœ¨äºæœºå™¨~/.sshä¸­ã€‚ å®¢æˆ·ç«¯ï¼šid_rsa(ç§é’¥)ã€id_rsa.pub(å…¬é’¥)ã€known_hosts(å·²çŸ¥è¿œç¨‹ä¸»æœº) æœåŠ¡ç«¯: authorized_keys(éªŒè¯è¿‡çš„å…¬é’¥åˆ—è¡¨)ã€sshd_config(sshé…ç½®æ–‡ä»¶) è®¾ç½®sshè¿æ¥ä¸æ–­å¼€vim /etc/ssh/sshd_config # å®¢æˆ·ç«¯æ¯éš”å¤šå°‘ç§’å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªå¿ƒè·³æ•°æ® ClientAliveInterval 30 # å®¢æˆ·ç«¯å¤šå°‘ç§’æ²¡æœ‰å“åº”ï¼ŒæœåŠ¡å™¨è‡ªåŠ¨æ–­æ‰è¿æ¥ ClientAliveCountMax 1800 service sshd restart]]></content>
      <tags>
        <tag>ssh</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç½‘ç«™éƒ¨ç½²è§„åˆ™]]></title>
    <url>%2F2017%2F10%2F13%2Fsite-dealy-role%2F</url>
    <content type="text"><![CDATA[ç½‘ç«™å‘å¸ƒåªåœ¨è‡ªå·±ç¬”è®°æœ¬ç”µè„‘å‘å¸ƒï¼Œå…¬å¸ç”µè„‘åªèƒ½hexo s â€”debug,ä¸èƒ½ hexo d -gæœ¬åœ°å†…å®¹ä¿®æ”¹å®Œæˆä¹‹åè®°å¾—123git add . git commit -am "m"git push origin master]]></content>
  </entry>
  <entry>
    <title><![CDATA[fatal:remote error You can't push to git çš„è§£å†³åŠæ³•]]></title>
    <url>%2F2017%2F10%2F13%2Fgithub-remote-error%2F</url>
    <content type="text"><![CDATA[branchæ­£ç¡®çš„æƒ…å†µä¸‹ï¼Œä¸çŸ¥ä¸ºä»€ä¹ˆï¼Œåœ¨pushçš„æ—¶å€™å‡ºç°:123fatal: remote error:You can't push to git://github.com/zentia/hexo.gitUse git@github.com:zentia/hexo.git è§£å†³åŠæ³•:123git remote rm origingit remote add origin git@github.com:zentia/hexo.gitgit push origin master]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[wm]]></title>
    <url>%2F2017%2F10%2F13%2Fwm%2F</url>
    <content type="text"><![CDATA[ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šæ˜¨å¤©ä¸€ç›´æç¤ºhexo command no foundï¼Œç„¶åæœ¬åœ°çš„hexo/node_moduleä¸‹æ‰¾åˆ°ä¸€ä¸ª.binç›®å½•ï¼Œé‡Œé¢è¿˜æœ‰hexoçš„æ‰§è¡Œæ–‡ä»¶ï¼Œå¤©çœŸçš„ä»¥ä¸ºè¿™ä¸ªå°±æ˜¯æ‰§è¡Œè·¯å¾„ï¼Œç„¶åæäº†ä¸€å¤©ï¼Œæ— æœã€‚ä»Šå¤©å»program files(x86)æ‰¾åˆ°å…¨å±€çš„npmä¸‹çš„hexoç„¶åä¿®æ”¹ç¯å¢ƒå˜é‡è§£å†³ã€‚ç¬¬äºŒä¸ªé—®é¢˜ï¼šhexo new _post æ–‡ç« çš„æ—¶å€™æç¤ºfatalï¼šadmin-heyï¼ˆä¸€ä¸ªç®¡ç†å‘˜æ§åˆ¶çš„ï¼‰module no found ï¼Œä»¥å‰é…ç½®è¿™ä¸ªè¿‡ï¼Œåæ¥æ„Ÿè§‰æ²¡å•¥ç”¨ï¼Œå°±ä¸ç”¨äº†ï¼Œå¼€å§‹ä¸‹è½½è¿™ä¸ªmoduleï¼Œä½†æ˜¯å¯èƒ½æ˜¯ä»Šå¤©çš„ç½‘ç»œé—®é¢˜è¿˜æ˜¯æ€ä¹ˆå›äº‹ï¼Œgithubä¸€ç›´å¾ˆæ…¢ï¼Œç„¶åå»node_moduleé‡Œé¢çœ‹çš„æ—¶å€™å‘ç°æœ‰hexo-heyï¼Œä½†æ˜¯å‘ç°é‡Œé¢æ–‡ä»¶ç›®å½•ç»“æ„ä¸å¯¹ï¼Œç„¶ååˆ æ‰å°±å¥½äº†ã€‚æœ¬æ¥æƒ³åšä¸€ä¸ªå•çº¯çš„æŠ€æœ¯åšå®¢ï¼Œä½†æ˜¯ç‹è‹—å–œæ¬¢è¿™ä¸ªè§†é¢‘ï¼Œå°±æ”¾ä¸Šå»å§ã€‚]]></content>
  </entry>
  <entry>
    <title><![CDATA[Unity Shader]]></title>
    <url>%2F2017%2F10%2F12%2Fshader%2F</url>
    <content type="text"><![CDATA[CGPROGRAMå’ŒENDCGåŒ…è£¹çš„éƒ¨åˆ†å°±æ˜¯CG\HLSLè¯­è¨€éƒ¨åˆ†ã€‚ Vertex &amp; Fragment Shader: é¡¶ç‚¹/ç‰‡å…ƒç€è‰²å™¨ã€‚å®ƒæ˜¯æœ€åŸºæœ¬ï¼Œä¹Ÿæ˜¯éå¸¸å¼ºå¤§çš„ç€è‰²å™¨ç±»å‹ã€‚ä¸€èˆ¬ç”¨äº2Dåœºæ™¯ã€ç‰¹æ•ˆä¹‹ç±»çš„ã€‚Unlit Shader(æ— å…‰ç…§ç€è‰²å™¨ï¼Œä¸åŒ…å«æ— æ•ˆ)åœ¨ä¸–ç•Œä¸‰ç»´ç©ºé—´ä¸­ï¼Œä¸€å¼€å§‹ä¼ å…¥Shaderå¤„ç†çš„æ•°æ®å…¶å®å°±æ˜¯ç½‘æ ¼æ•°æ®(Mesh Data)ä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå…‰æ˜¯ç½‘æ ¼æ•°æ®ä¸èƒ½æ»¡è¶³æˆ‘ä»¬å¤„ç†ç”»é¢çš„éœ€æ±‚ï¼Œè¿™æ—¶å°±éœ€è¦å¼•å…¥ä¸€äº›å¸¸æ•°å±æ€§æ•°æ®(Properties)å±æ€§çš„å£°æ˜è§„åˆ™å¦‚ä¸‹ï¼š 1_Name("Display Name", type)=defaultValue[&#123;options&#125;] _Nameæ˜¯å±æ€§çš„åå­—ï¼Œä¹Ÿå°±æ˜¯å˜é‡åï¼Œåœ¨ä¹‹åæ•´ä¸ªShaderä»£ç ä¸­å°†ä½¿ç”¨è¿™ä¸ªåå­—æ¥è·å–è¯¥å±æ€§çš„å†…å®¹ï¼Œåˆ‡è®°è¦æ·»åŠ ä¸‹åˆ’çº¿ã€‚ Displayer Name è¿™ä¸ªå­—ç¬¦ä¸²å°†æ˜¾ç¤ºåœ¨Unityçš„Inspectorä¸­ä½œä¸ºShaderçš„ä½¿ç”¨è€…å¯è¯»çš„å†…å®¹ï¼Œå³æ˜¾ç¤ºçš„åç§°ã€‚ typeå±æ€§çš„ç±»å‹ã€‚å¸¸ç”¨çš„æœ‰å‡ ç§ï¼šColoré¢œè‰²ï¼Œä¸€èˆ¬ä¸ºRGBAçš„æ•°ç»„ï¼›2Dçº¹ç†ï¼Œå®½é«˜ä¸º2çš„å¹‚æ¬¡å°ºå¯¸ï¼›Rectçº¹ç†ï¼Œå¯¹åº”é2çš„å¹‚æ¬¡å°ºå¯¸ï¼›Cubeç«‹æ–¹ä½“ï¼Œå³6å¼ 2Dçº¹ç†ç»„æˆï¼›Floatå’ŒRangeï¼Œéƒ½æ˜¯æµ®ç‚¹æ•°ï¼Œä½†æ˜¯Rangeè¦æ±‚å®šä¹‰æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œä»¥Range(min,max)å½¢å¼æ˜¾ç¤ºï¼›Vectorå››ä½æ•°ã€‚ defauleValueé»˜è®¤å€¼ï¼Œä¸ç±»å‹ç›´æ¥æŒ‚é’©ã€‚ä¸€å¼€å§‹èµ‹äºˆè¯¥å±æ€§çš„åˆå§‹å€¼ï¼Œä½†æ˜¯åœ¨æ£€è§†çª—å£è°ƒæ•´è¿‡å±æ€§å€¼ä¹‹åï¼Œä¸å†æœ‰æ•ˆã€‚Colorä»¥0~1å®šä¹‰rgbaé¢œè‰²ï¼Œæ¯”å¦‚(1,1,1,1)ï¼›2D/Rect/Cubeï¼Œå¯¹äºçº¹ç†æ¥è¯´ï¼Œé»˜è®¤å¯ä»¥ä¸ºä¸€ä¸ªä»£è¡¨é»˜è®¤tinté¢œè‰²å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç©ºå­—ç¬¦ä¸²æˆ–è€…â€whiteâ€ï¼Œâ€blackâ€ç­‰ä¸­çš„ä¸€ä¸ªï¼›Floatå’ŒRangeä¸ºæŸä¸ªæŒ‡å®šçš„æµ®ç‚¹æ•°ï¼›åŒæ ·ï¼ŒVectorçš„æ˜¯ä¸€ä¸ªå››ç»´æ•°å€¼ï¼Œ(x,y,z,w)çš„å½¢å¼ã€‚ Optionså¯é€‰é¡¹ï¼Œå®ƒåªå¯¹2Dï¼ŒRectæˆ–è€…Cubeçº¹ç†æœ‰å…³ï¼Œä¸€èˆ¬å¡«å…¥OpenGLä¸­TexGençš„æ¨¡å¼ã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥å°è¯•è§£è¯»ä¸Šå›¾ä¸­çš„é‚£äº›å±æ€§å£°æ˜çš„æ˜¯å£°æ˜äº†ã€‚æ¯”å¦‚_MainTex(â€œA Textureâ€, 2D)=â€â€{},å°±æ˜¯å£°æ˜äº†ä¸€ä¸ªå˜é‡åä¸º_MainTexçš„2æ¬¡å¹‚å°ºå¯¸çº¹ç†ï¼Œå®ƒåœ¨æ£€è§†çª—å£ä¸­æ˜¾ç¤ºçš„åç§°æ˜¯A Textureï¼Œé»˜è®¤æ˜¯ç©ºçš„ã€‚ è¯­ä¹‰è¯­ä¹‰ï¼ˆSemanticsï¼‰æ˜¯é™„åŠ åˆ°ç€è‰²å™¨è¾“å…¥æˆ–è¾“å‡ºçš„å­—ç¬¦ä¸²ï¼Œå…¶ä¼ è¾¾å…³äºå‚æ•°çš„é¢„æœŸä½¿ç”¨çš„ä¿¡æ¯ã€‚å¯¹äºåœ¨ç€è‰²å™¨çº§ä¹‹é—´ä¼ é€’çš„æ‰€æœ‰å˜é‡éƒ½éœ€è¦è¯­ä¹‰ï¼Œé€šå¸¸ï¼Œåœ¨æµæ°´çº¿çº§ä¹‹é—´ä¼ é€’çš„æ•°æ®æ˜¯å®Œå…¨é€šç”¨çš„ï¼Œå¹¶ä¸”ä¸è¢«ç³»ç»Ÿå”¯ä¸€åœ°è§£é‡Šï¼›å…è®¸ä»»æ„è¯­ä¹‰æ²¡æœ‰ç‰¹æ®Šæ„ä¹‰ã€‚ Surface Shader: è¡¨é¢ç€è‰²å™¨ã€‚å®ƒæ‹¥æœ‰æ›´å¤šçš„å…‰ç…§è¿ç®—ï¼Œå…¶å®åœ¨ç³»ç»Ÿå†…éƒ¨å®ƒä¼šè¢«ç¼–è¯‘æˆä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„é¡¶ç‚¹/ç‰‡å…ƒç€è‰²å™¨ã€‚Standard Surface Shader(æ ‡å‡†å…‰ç…§æ¨¡å‹è¡¨é¢ç€è‰²å™¨) Standard Shader: æ ‡å‡†ç€è‰²ã€‚å®ƒæ˜¯è¡¨é¢ç€è‰²å™¨å‡çº§ç‰ˆï¼Œå› ä¸ºå®ƒä½¿ç”¨äº†Physically Based Renderingï¼ˆç®€ç§°PBRï¼‰æŠ€æœ¯ï¼Œå³åŸºäºç‰©ç†çš„æ¸²æŸ“æŠ€æœ¯ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªç€è‰²å™¨ä¸­å¼€æ”¾äº†æ›´å¤šå¤„ç†å…‰ç…§ä¸æè´¨çš„å‚æ•°ã€‚ Tagè¡¨é¢ç€è‰²å™¨å¯ä»¥è¢«è‹¥å¹²çš„æ ‡ç­¾(tags)æ‰€ä¿®é¥°ï¼Œè€Œç¡¬ä»¶å°†é€šè¿‡åˆ¤å®šè¿™äº›æ ‡ç­¾æ¥å†³å®šä»€ä¹ˆæ—¶å€™è°ƒç”¨è¯¥ç€è‰²å™¨ã€‚æ¯”å¦‚æˆ‘ä»¬çš„ç²’å­ä¸­SubShaderçš„ç¬¬ä¸€å¥Tags{â€œRenderTypeâ€=â€Opaqueâ€}å‘Šè¯‰äº†ç³»ç»Ÿåº”è¯¥åœ¨æ¸²æŸ“éé€æ˜ç‰©ä½“çš„æ—¶è°ƒç”¨æˆ‘ä»¬ã€‚Unityå®šä¹‰äº†ä¸€ç³»åˆ—è¿™æ ·çš„æ¸²æŸ“è¿‡ç¨‹ï¼Œä¸RenderTypeæ˜¯Opaqueç›¸å¯¹åº”çš„æ˜¾è€Œæ˜“è§çš„æ˜¯â€RenderTypeâ€=â€Transparentâ€ï¼Œè¡¨æ˜æ¸²æŸ“å«æœ‰é€æ˜æ•ˆæœçš„ç‰©ä½“æ—¶è°ƒç”¨å®ƒã€‚åœ¨è¿™é‡ŒTagså…¶å®æš—ç¤ºäº†ä½ çš„Shaderè¾“å‡ºçš„æ˜¯ä»€ä¹ˆï¼Œå¦‚æœæ˜¯æ¸²æŸ“éé€æ˜ç‰©ä½“ï¼Œé‚£æ·»åŠ â€Queueâ€=â€Opaqueâ€æ ‡ç­¾ï¼›å¦‚æœæ¸²æŸ“é€æ˜æˆ–è€…åŠé€æ˜çš„åƒç´ ï¼Œé‚£æ·»åŠ â€Queueâ€=â€Transparentâ€ã€‚å¦å¤–æ¯”è¾ƒæœ‰ç”¨çš„æ ‡ç­¾â€IgnoreProjectâ€=â€Trueâ€(ä¸èƒŒProjectorså½±å“)ï¼Œâ€ForceNoShadowCastingâ€=â€Trueâ€(ä»ä¸äº§ç”Ÿé˜´å½±)ä»¥åŠâ€Queueâ€=â€xxxâ€(æŒ‡å®šæ¸²æŸ“é¡ºåºé˜Ÿåˆ—)ã€‚è¿™é‡Œæƒ³è¦èµµå¿ è¯´ä¸€ä¸‹çš„æ˜¯Queueè¿™ä¸ªæ ‡ç­¾ï¼Œå¦‚æœä½ ä½¿ç”¨Unityåšè¿‡ä¸€äº›é€æ˜å’Œä¸é€æ˜ç‰©ä½“çš„æ··åˆçš„è¯ï¼Œå¾ˆå¯èƒ½å·²ç»é‡åˆ°è¿‡ä¸é€æ˜ç‰©ä½“æ— æ³•å‘ˆç°åœ¨é€æ˜ç‰©ä½“ä¹‹åçš„æƒ…å†µã€‚è¿™ç§æƒ…å†µå¾ˆå¯èƒ½æ˜¯ç”±äºShaderçš„æ¸²æŸ“é¡ºåºä¸æ­£ç¡®å¯¼è‡´çš„ã€‚QueueæŒ‡å®šäº†ç‰©ä½“çš„æ¸²æŸ“é¡ºåºï¼Œé¢„å®šä¹‰çš„Queueæœ‰ï¼š Background - æœ€æ—©è¢«è°ƒç”¨çš„æ¸²æŸ“ï¼Œç”¨æ¥æ¸²æŸ“å¤©ç©ºç›’æˆ–è€…èƒŒæ™¯ Geometry - è¿™æ˜¯é»˜è®¤å€¼ï¼Œç”¨æ¥æ¸²æŸ“éé€æ˜çš„ç‰©ä½“ï¼ˆæ™®é€šæƒ…å†µä¸‹ï¼Œåœºæ™¯ä¸­çš„ç»å¤§å¤šæ•°ç‰©ä½“åº”è¯¥æ˜¯éé€æ˜çš„ï¼‰ AlphaTest - ç”¨æ¥æ¸²æŸ“ç»è¿‡Alpha Testçš„åƒç´ ï¼Œå•ç‹¬ä¸ºAlphaTestè®¾å®šä¸€ä¸ªQueueæ˜¯å‡ºäºå¯¹æ•ˆç‡çš„è€ƒè™‘ Overlay - ç”¨æ¥æ¸²æŸ“æ•ˆæœçš„å åŠ ï¼Œæ˜¯æ¸²æŸ“çš„æœ€åé˜¶æ®µï¼ˆæ¯”å¦‚é•œå¤´å…‰æ™•ç­‰æ•ˆæœï¼‰ è¿™äº›é¢„è®¾å€¼æœ¬è´¨æ˜¯ä¸€ç»„æ•´æ•°ï¼ŒBackground = 1000(èƒŒæ™¯), Geometry = 2000(å‡ ä½•ä½“), AlphaTest = 2450(alphaæµ‹è¯•), Transparent = 3000(é€æ˜),æœ€åOverlay = 4000ã€‚åœ¨æˆ‘ä»¬å®é™…è®¾ç½®Queueå€¼æ—¶ï¼Œä¸ä»…èƒ½ä½¿ç”¨ä¸Šé¢çš„å‡ ä¸ªé¢„å®šä¹‰å€¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šè‡ªå·±çš„Queueå€¼ï¼Œå†™æˆç±»ä¼¼è¿™æ ·ï¼šâ€Queueâ€=â€Transparent+100â€,è¡¨ç¤ºä¸€ä¸ªåœ¨Transparentä¹‹å100çš„Queueä¸Šè¿›è¡Œè°ƒç”¨ã€‚é€šè¿‡è°ƒæ•´Queueå€¼ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿æŸäº›ç‰©ä½“ä¸€å®šåœ¨å¦ä¸€äº›ç‰©ä½“ä¹‹å‰æˆ–è€…ä¹‹åæ¸²æŸ“ã€‚ LODLODå¾ˆç®€å•ï¼Œå®ƒæ˜¯Level of Detailçš„ç¼©å†™ï¼Œåœ¨è¿™é‡Œä¾‹å­é‡Œæˆ‘ä»¬æŒ‡å®šäº†å…¶ä¸º200ï¼ˆå…¶å®è¿™æ˜¯Unityçš„å†…å»ºDiffuseç€è‰²å™¨çš„è®¾å®šå€¼ï¼‰ã€‚è¿™ä¸ªæ•°å€¼å†³å®šäº†æˆ‘ä»¬èƒ½ç”¨ä¸Šé¢æ ·çš„Shaderã€‚åœ¨Unityçš„Quality Settingsä¸­æˆ‘ä»¬å¯ä»¥è®¾å®šå…è®¸æœ€å¤§LODï¼Œå½“è®¾å®šçš„LODå°äºSubShaderæ‰€æŒ‡å®šçš„LODæ—¶ï¼Œè¿™ä¸ªSubShaderå°†ä¸å¯ç”¨ã€‚Unityå†…å»ºShaderå®šä¹‰äº†ä¸€ç»„LODçš„æ•°å€¼ï¼Œæˆ‘ä»¬åœ¨å®ç°è‡ªå·±çš„Shaderçš„æ—¶å€™å¯ä»¥å°†å…¶ä½œä¸ºå‚è€ƒæ¥è®¾å®šè‡ªå·±çš„LODæ•°å€¼ï¼Œè¿™æ ·åœ¨ä¹‹åè°ƒæ•´æ ¹æ®è®¾å¤‡å›¾å½¢æ€§èƒ½æ¥è°ƒæ•´ç”»è´¨æ—¶å¯ä»¥ç´§æ€¥æ€§æ¯”è¾ƒç²¾ç¡®çš„æ§åˆ¶ã€‚ VertexLitåŠå…¶ç³»åˆ— = 100 Decal,Reflective VertexLit = 150 Diffuse = 200 Diffuse Detail,Reflective Bumped Unlit,Reflective Bumped VertexLit = 250 Bumped,Specular = 300 Bumped Specular = 400 Parallax = 500 Parallax Specular = 600 Shaderæœ¬ä½“123456789101112131415CGPROGRAM#pragma surface surf Lambertsampler2D _MainTex;struct Input &#123; float2 uv_MainTex;&#125;;void surf(Input IN, inout SurfaceOutput o)&#123; half4 c = tex2D(_MainTex, IN.uv_MainTex); o.Albedo = c.rgb; o.Alpha = c.a;&#125;ENDCG è¿˜æ˜¯é€è¡Œæ¥çœ‹ï¼Œé¦–å…ˆæ˜¯CGPROGRAMã€‚è¿™æ˜¯ä¸€ä¸ªå¼€å§‹æ ‡è®°ï¼Œè¡¨æ˜ä»è¿™é‡Œå¼€å§‹æ˜¯ä¸€æ®µCGç¨‹åºï¼ˆæˆ‘ä»¬åœ¨å†™Unityçš„Shaderæ—¶ç”¨çš„æ˜¯Cg/HLSLè¯­è¨€ï¼‰ã€‚æœ€åä¸€è¡Œçš„ENDCGä¸CGPROGRAMæ˜¯å¯¹åº”çš„ï¼Œè¡¨æ˜CGç¨‹åºåˆ°æ­¤ç»“æŸã€‚æ¥ä¸‹æ¥æ˜¯ä¸€ä¸ªç¼–è¯‘æŒ‡ä»¤ï¼š#program surface surf Lambert,å®ƒè¡¨æ˜äº†æˆ‘ä»¬è¦å†™ä¸€ä¸ªè¡¨é¢Shaderï¼Œå¹¶æŒ‡æ˜äº†å…‰ç…§æ¨¡å‹ã€‚å®ƒçš„å†™æ³•æ˜¯è¿™æ ·çš„ #pragma surface surfaceFunction lightModel [optionalparams] surface -è¡¨æ˜çš„æ˜¯ä¸€ä¸ªè¡¨æ˜ç€è‰²å™¨ surfaceFunction -ç€è‰²å™¨ä»£ç çš„æ–¹æ³•çš„åå­— lightModel -ä½¿ç”¨çš„å…‰ç…§æ¨¡å‹æˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªè¡¨é¢ç€è‰²å™¨ï¼Œå®é™…çš„ä»£ç åœ¨surfå‡½æ•°ï¼Œä½¿ç”¨Lambert(ä¹Ÿå°±æ˜¯æ™®é€šçš„diffuse)ä½œä¸ºå…‰ç…§æ¨¡å‹ã€‚æ¥ä¸‹æ¥ä¸€å¥sampler2D MainTex,sampler2Dæ˜¯ä¸ªå•¥ï¼Ÿå…¶å®åœ¨CGä¸­ï¼Œsampler2Då°±æ˜¯å’ŒTextureæ‰€ç»‘å®šçš„ä¸€ä¸ªæ•°æ®å®¹å™¨æ¥å£ã€‚ç­‰ç­‰..è¿™ä¸ªè¯´æ³•è¿˜æ˜¯å¤ªå¤æ‚äº†ï¼Œç®€å•ç†è§£çš„è¯ï¼Œæ‰€è°“åŠ è½½ä»¥åçš„texture(è´´å›¾)è¯´ç™½äº†ä¸è¿‡æ˜¯ä¸€å—å†…å­˜å­˜å‚¨çš„ï¼Œä½¿ç”¨äº†RGB(ä¹Ÿè®¸è¿˜æœ‰A)é€šé“ï¼Œä¸”æ¯ä¸ªé€šé“8bitsçš„æ•°æ®ã€‚è€Œå…·ä½“æƒ³çŸ¥é“åƒç´ ä¸åæ ‡çš„å¯¹åº”å…³ç³»ï¼Œä»¥åŠè·å–è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬æ€»ä¸èƒ½ä¸€æ¬¡æ¬¡å»è‡ªå·±è®¡ç®—å†…å­˜åœ°å€æˆ–è€…åç§»ï¼Œå› æ­¤å¯èƒ½é€šè¿‡sampler2Dæ¥å¯¹è´´å›¾è¿›è¡Œæ“ä½œã€‚æ›´ç®€å•ç†è§£ï¼Œsampler2Då°±æ˜¯GLSLä¸­çš„2Dè´´å›¾ç±»å‹ï¼Œç›¸åº”çš„ï¼Œè¿˜æœ‰smapler1D,sampler2D,samplerCubeç­‰ç­‰æ ¼å¼ã€‚è§£é‡Šé€šäº†sampler2Dæ˜¯ä»€ä¹ˆä¹‹åï¼Œè¿˜éœ€è¦è§£é‡Šä¸‹ä¸ºä»€ä¹ˆåœ¨è¿™é‡Œéœ€è¦ä¸€å¥å¯¹_MainTexçš„å£°æ˜ï¼Œä¹‹å‰æˆ‘ä»¬ä¸æ˜¯å·²ç»åœ¨Propertiesé‡Œå£°æ˜è¿‡å®ƒæ˜¯è´´å›¾äº†ä¹ˆã€‚ç­”æ¡ˆæ˜¯æˆ‘ä»¬ç”¨æ¥å®åŠ›çš„è¿™ä¸ªshaderå…¶å®æ˜¯ç”±ä¸¤ä¸ªç›¸å¯¹ç‹¬ç«‹çš„å—ç»„æˆçš„ï¼Œå¤–å±‚çš„å±æ€§å£°æ˜ï¼Œå›æ»šç­‰ç­‰æ˜¯Unityå¯ä»¥ç›´æ¥ä½¿ç”¨å’Œç¼–è¯‘çš„ShaderLab;è€Œç°åœ¨æˆ‘ä»¬æ˜¯CGPROGRAM..ENDCGè¿™æ ·ä¸€ä¸ªä»£ç å—ä¸­ï¼Œè¿™æ˜¯ä¸€æ®µCGç¨‹åºã€‚å¯¹äºè¿™æ®µCGç¨‹åºï¼Œè¦æƒ³è®¿é—®åœ¨Propertiesä¸­æ‰€å®šä¹‰çš„å˜é‡çš„è¯ï¼Œå¿…é¡»ä½¿ç”¨å’Œä¹‹å‰å˜é‡å½¢åŒçš„åå­—è¿›è¡Œå£°æ˜ã€‚äºæ˜¯å…¶å®sampler2D _MainTex;åšçš„äº‹æƒ…å°±æ˜¯å†æ¬¡å£°æ˜å¹¶é“¾æ¥äº†_MainTex,ä½¿æ¥ä¸‹æ¥çš„CGç¨‹åºèƒ½å¤Ÿä½¿ç”¨è¿™ä¸ªå˜é‡ã€‚è§£é‡Šé€šäº†sampler2Dæ˜¯ä»€ä¹ˆä¹‹åï¼Œè¿˜éœ€è¦è§£é‡Šä¸ºä»€ä¹ˆåœ¨è¿™é‡Œéœ€è¦ä¸€å¥å¯¹_MainTexçš„å£°æ˜ï¼Œä¹‹å‰æˆ‘ä»¬ä¸æ˜¯å·²ç»åœ¨Propertiesé‡Œå£°æ˜è¿‡å®ƒæ˜¯è´´å›¾äº†å—ã€‚ç­”æ¡ˆæ˜¯æˆ‘ä»¬ç”¨æ¥å®åŠ›çš„è¿™ä¸ªshaderå…¶å®æ˜¯ç”±ä¸¤ä¸ªç‹¬ç«‹çš„å¿«ç»„æˆçš„ï¼Œå¤–å±‚çš„å±æ€§å£°æ˜ï¼Œä¼šã€‚- åœ¨CGä¸­ï¼Œå‡½æ•°å°±åƒCä¸­é‚£æ ·å£°æ˜ã€‚ä½ å¯ä»¥éšæ„çš„æŒ‡å®šä¼ é€’ç»™å‡½æ•°çš„å‚æ•°ï¼Œä»¥åŠå°†è¢«å‡½æ•°å•Šå‘ä½ ä¼šçš„å€¼ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„å‡½æ•°å£°æ˜ï¼š1234float getX(float3 v)&#123; return v.x;&#125; è¿™ä¸ªå‡½æ•°é‡‡ç”¨äº†ä¸€ä¸ªä¸‰å…ƒå‘é‡vä½œä¸ºä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”å°†vçš„xåˆ†é‡ä½œä¸ºè¿”å›å€¼ï¼Œå…¶ç±»å‹ä¸ºfloatã€‚å…³é”®å­—returnè¢«ç”¨æ¥è¿”å›å‡½æ•°çš„ç»“æœã€‚ä½ å¯ä»¥åƒè°ƒç”¨ä»»ä½•å…¶å®ƒCgå‡½æ•°é‚£æ ·è°ƒç”¨getXå‡½æ•°ï¼š123456//å£°æ˜ä¸€ä¸ªä¸´æ—¶ä½¿ç”¨çš„å‘é‡float3 myVector = float3(0.5,1.0,-1.0);//å–å¾—myVectorçš„xåˆ†é‡float x = getX(myVector);//ç°åœ¨ x=0.5 æœ‰äº›æ—¶å€™ï¼Œä½ æƒ³è¦ä¸€ä¸ªå‡½æ•°è¿”å›å‡ ä¸ªç»“æœè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªç»“æœã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ èƒ½å¤Ÿä½¿ç”¨outä¿®é¥°ç¬¦æ¥æŒ‡å®šä¸€ä¸ªç¨‹åºçš„æŸä¸ªç‰¹å®šçš„å‚æ•°åªç”¨äºè¾“å‡ºã€‚ä¸‹é¢çš„ä¾‹å­ç”¨ä¸€ä¸ªå‘é‡ä½œä¸ºè¾“å…¥ï¼Œç„¶åè¿”å›å®ƒçš„xã€yå’Œzåˆ†é‡ã€‚123456void getComponents(float3 vector, out float x, out float y, out float z)&#123; x = vector.x; y = vector.y; z = vector.z;&#125; æ³¨æ„è¿™ä¸ªå‡½æ•°è¢«å£°æ˜ä¸ºvoidç±»å‹ï¼Œå› ä¸ºå®ƒé€šè¿‡å‚æ•°æ¥è¿”å›æ‰€æœ‰çš„å€¼ã€‚ä¸‹é¢çš„ä»£ç ç¤ºä¾‹æ˜¾ç¤ºäº†getComponentsæ˜¯å¦‚ä½•è¢«ä½¿ç”¨çš„ï¼š12345678//å£°æ˜ä¸€ä¸ªä¸´æ—¶ä½¿ç”¨çš„å‘é‡float3 myVector = float3(0.5,1.0,-1.0);//å£°æ˜ä¸€ä¸ªä¸´æ—¶ä½¿ç”¨çš„å˜é‡flaot x,y,z;//è·å¾—myVectorçš„xã€yå’Œzåˆ†é‡getComponents(myVector, x,y,z);//ç°åœ¨x=0.5,y=1.0,z=-1.0 ä¸€ä¸ªå…‰ç…§å‡½æ•°å› ä¸ºå…‰ç…§æ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ï¼Œä½ èƒ½å¤Ÿç¼–å†™è®¸å¤šä¸åŒç±»å‹çš„å…‰ç…§å‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°éƒ½èƒ½æ¥å—ä¸åŒçš„å‚æ•°ã€‚ç°åœ¨ï¼Œä½ åªéœ€è¦é‡‡ç”¨ä½ å®ç°çš„ç®€å•æ¨¡å‹ï¼Œå¹¶ä¸ºå®ƒåˆ›å»ºä¸€ä¸ªå‡½æ•°ã€‚ä¸‹é¢æ˜¯è¿™ä¸ªå‡½æ•°çš„æœ€åŸºæœ¬çš„æ ·å­ï¼š1234float3 lighting(float Ke, float3 Ka, float3 Kd,float3 Ks,float shininess,float3 lightPosition,float3 lightColor,float3 globalAmbient,float3 P,float3 N,float3 eyePosition)&#123; //åœ¨è¿™é‡Œè®¡ç®—å…‰ç…§&#125; è¿™ä¸ªæ–¹æ³•çš„ä¸€ä¸ªä¸»è¦é—®é¢˜æ˜¯è¿™ä¸ªå‡½æ•°éœ€è¦å¾ˆå¤šå‚æ•°ã€‚æŠŠè¿™äº›å‚æ•°ç»„æˆâ€œæè´¨å‚æ•°â€å’Œâ€œå…‰å‚æ•°â€ï¼Œç„¶åæŠŠæ¯ä¸ªå‚æ•°é›†å½“æˆä¸€ä¸ªå•ç‹¬å˜é‡æ¥ä¼ é€’ï¼Œè¿™å°†ä½¿å¾—æ•´ä¸ªå‡½æ•°æ•´æ´è®¸å¤šã€‚å¹¸è¿çš„æ˜¯Cgæ”¯æŒè¿™ç§ç»“æ„ï¼Œæ°å¥½èƒ½å¤Ÿæä¾›è¿™ç§åŠŸèƒ½ã€‚ ç»“æ„Cgçš„ç»“æ„ä½¿ç”¨ä¸Cå’ŒC++åŒæ ·çš„æ–¹æ³•æ¥å£°æ˜ã€‚structå…³é”®å­—è¢«ç”¨æ¥å£°æ˜ç»“æ„ï¼Œå®ƒåé¢è·Ÿéšçš„æ˜¯ç»“æ„çš„æˆå‘˜ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç»“æ„çš„ä¾‹å­ï¼Œå®ƒåˆ†å°è£…äº†åŸºäºåŸºæœ¬å…‰ç…§æ¨¡å‹çš„æŸä¸ªæè´¨çš„æ‰€æœ‰æ€§è´¨ï¼š Fogè¯­æ³•: Fog {Fog Commands} Mode Off | Global | Linear | Exp | Exp2(é›¾çš„æ¨¡å¼ï¼Œç¼ºçœå€¼æ˜¯Global) Color ColorValue(é›¾çš„é¢œè‰²) Density FloatValue(é›¾çš„æµ“åº¦ï¼Œå½±å“Exp/Exp2) Range FloatValue,FloatValue(é›¾çš„å¼€å§‹å’Œç»“æŸè·ç¦»ï¼Œå½±å“Linear) æ³¨æ„å¦‚æœä½¿ç”¨äº†ç‰‡æ®µç€è‰²å™¨çš„è¯ï¼Œç€è‰²å™¨ç§çš„é›¾è®¾å®šä»ç„¶æ˜¯æœ‰æ•ˆçš„ã€‚å¦å¤–å¯ä»¥é€šè¿‡èœå•Edit-&gt;Render Settingså¯ä»¥æ‰“å¼€æ¸²æŸ“è®¾ç½® Alpha Testå’ŒAlpha BlendingAlpha Testæ˜¯ä¸éœ€è¦å…³é—­ZWriteçš„ã€‚Alpha Testè¦ä¹ˆå®Œå…¨é€æ˜ï¼Œè¦ä¹ˆå®Œå…¨ä¸é€æ˜ Alpha Blending éœ€è¦å…³é—­ZWriteï¼Œå¦‚æœä¸å…³é—­ZWriteï¼Œé‚£ä¹ˆåœ¨è¿›è¡Œæ·±åº¦æ£€æµ‹çš„æ—¶å€™ï¼Œå®ƒèƒŒåçš„ç‰©ä½“æœ¬æ¥å¯ä»¥è¢«å¤–é¢çœ‹åˆ°çš„ï¼Œä½†ç”±äºæ·±åº¦æ£€æµ‹æ—¶å¤§äºå®ƒçš„æ·±åº¦å°±è¢«å‰”é™¤äº†ï¼Œä»è€Œæˆ‘ä»¬å°±çœ‹ä¸åˆ°å®ƒåé¢çš„ç‰©ä½“äº†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯ç‰©ä½“çš„æ¸²æŸ“é¡ºåºæ˜¯ä»åå¾€å‰ï¼Œå¹¶ä¸”å…³é—­è¯¥åŠé€æ˜å¯¹è±¡çš„ZWriteã€‚ Appha Blending åªæ˜¯å…³é—­ZWriteï¼Œä½†æ˜¯ä¸ä¼šå…³é—­ZTestã€‚è¿™æ„å‘³ç€ï¼Œåœ¨è¾“å‡ºä¸€ä¸ªAlpha Blendingçš„fragmentæ—¶ï¼Œå®ƒè¿˜æ˜¯ä¼šåˆ¤æ–­å’Œå½“å‰Color Bufferç§çš„fragmentçš„æ·±åº¦å…³é—­ï¼Œå¦‚æœå®ƒæ¯”å½“å‰çš„fragementæ·±åº¦æ›´è¿œï¼Œé‚£ä¹ˆå®ƒå°±ä¸ä¼šå†åšåç»­çš„æ··åˆæ“ä½œäº†ï¼› ColorMaskColorMaskå¯è®©æˆ‘ä»¬æŒ‡å®šæ¸²æŸ“ç»“æœçš„è¾“å‡ºé€šé“ï¼Œè€Œä¸æ˜¯é€šå¸¸æƒ…å†µä¸‹çš„RGBAè¿™4ä¸ªé€šé“çš†ä¼šè¢«å†™å…¥ã€‚å¯é€‰å‚æ•°æ˜¯RGBAçš„ä»»æ„ç»„åˆä»¥åŠ0ï¼Œè¿™å°†æ„å‘³ç€ä¸ä¼šå†™å…¥åˆ°ä»»ä½•é€šé“ï¼Œå¯ä»¥ç”¨æ¥å•ç‹¬åšä¸€æ¬¡Z Testï¼Œè€Œä¸å°†ç»“æœå†™å…¥é¢œè‰²é€šé“ã€‚ _Time_Timeæ˜¯ä¸ª4ç»´å‘é‡ï¼Œè·ŸUnity3Dä¸­çš„deltaTimeï¼ˆè¿™ä¸ªæ˜¯ä¸€ç»´çš„ï¼Œæ•°å€¼ï¼‰ä¸åŒã€‚ åç§° ç±»å‹ è¯´æ˜ _Time float4 tæ˜¯è‡ªè¯¥åœºæ™¯åŠ è½½å¼€å§‹æ‰€ç»è¿‡çš„æ—¶é—´ï¼Œ4ä¸ªåˆ†é‡åˆ†åˆ«æ˜¯(t/20,t,t2,t3) _SinTime float4 tæ˜¯æ—¶é—´çš„æ­£å¼¦å€¼ï¼Œ4ä¸ªåˆ†é‡åˆ†åˆ«æ˜¯(t/8,t/4,t/2,t) _CosTime float4 tæ˜¯æ—¶é—´çš„ä½™å¼¦å€¼ï¼Œ4ä¸ªåˆ†é‡åˆ†åˆ«æ˜¯(t/8,t/4,t/2,t) unity_DeltaTime float4 dtæ˜¯æ—¶é—´å¢é‡ï¼Œ4ä¸ªåˆ†é‡åˆ†åˆ«æ˜¯(dt,1/dt,smoothDt,1/smoothDt)]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æœåŠ¡å™¨é…ç½®æ–‡ä»¶è¯´æ˜]]></title>
    <url>%2F2017%2F10%2F12%2Fservercfg%2F</url>
    <content type="text"><![CDATA[æ‘˜è¦ï¼šæœ¬æ–‡æ¡£æè¿°æ‰‹æ¸¸æœåŠ¡å™¨çš„å„ä¸ªé…ç½®æ–‡ä»¶çš„ä½¿ç”¨å’Œé…ç½®å‚æ•°è¯´æ˜ã€‚å…³é”®å­—ï¼šæœåŠ¡å™¨ ç»´æŠ¤ é…ç½® 1.æ¦‚è¿°è¯·å…ˆå‚è€ƒã€Šæ¸¸æˆç³»ç»Ÿæ¶æ„ã€‹ä»¥äº†è§£æ‰‹æ¸¸çš„æœåŠ¡å™¨æ¶æ„çŠ¶å†µã€‚æ‰‹æ¸¸çš„æ‰€æœ‰é…ç½®æ–‡ä»¶éƒ½é‡‡ç”¨ç›¸åŒçš„æ ¼å¼ã€‚è¿ç»´äººå‘˜ä¼šç»å¸¸ç”¨åˆ°çš„é…ç½®æ–‡ä»¶ç‰¹æ€§æœ‰ï¼šæ³¨é‡Šï¼Œæ–‡ä»¶åŒ…å«includeã€å®å®šä¹‰ã€æ¡ä»¶è¯»å–ã€‚ 2.å„ä¸ªæœåŠ¡å™¨ä¸»è¦é…ç½®å‚æ•°è¯´æ˜2.1 å…¬å…±é…ç½®æ–‡ä»¶æ–‡ä»¶åï¼šcmncfg.txtè¯¥æ–‡ä»¶ä¸»è¦ç”¨æ¥è¢«æ‰€æœ‰çš„é…ç½®æ–‡ä»¶åŒ…å«ï¼Œå¯ä»¥å®šä¹‰ä¸€äº›å…¨å±€æ€§çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚åœ¨ä¸åŒçš„æœåŠ¡å™¨é…ç½®ä¿¡æ¯ä¸åŒçš„åœ°æ–¹å°±å¯ä»¥æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œï¼Œè¿™æ ·ä¸åŒçš„æœåŠ¡å™¨åªè¦ä¿®æ”¹è¿™ä¸€ä¸ªæ–‡ä»¶å³å¯ã€‚ï¼‰å®ƒä¸€èˆ¬æ”¾åœ¨æ‰€æœ‰æœåŠ¡å™¨ç¨‹åºç›®å½•çš„ä¸Šå±‚ç›®å½•ï¼Œå‘½åä¸ºcmncfg.txtå…¸å‹å†…å®¹å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788////////////////////////////////////////////// ç»å¸¸è¦å˜çš„éƒ¨åˆ†////////////////////////////////////////////// å¤§åŒºçš„IDï¼ˆè¿™ä¸ªé…ç½®å¾ˆé‡è¦ï¼Œå¦‚æœé…ç½®é”™è¯¯ä¼šå¯¼è‡´æ‰€æœ‰çš„è§’è‰²å’Œç‰©å“IDé”™è¯¯ï¼Œå½±å“åˆæœï¼‰#defene SVRGRPID 2// ä»£è¡¨ç‰ˆæœ¬å­—ä¸²#define VERMAIN 0.7100// å„ç±»æœåŠ¡å™¨IPå®šä¹‰// æ—¥å¿—æœåŠ¡å™¨çš„åœ°å€#define LOGSVR 192.168.0.49// GMS4Chat#define GMS4CHATINNERIP 192.168.0.49// CAAFS4CHAT#define CAAFS4CHATOUTTERIP 192.168.0.49// GMS4Game#define GMS4GAMEINNERIP 192.168.0.49// DBS#define DBSINNERIP 192.168.0.49// P2PSERVER#define P2POUTTERIP 192.168.0.49// XGMS#define XGMSINNERIP 192.168.0.49// TTYGZS#define TTYGZSINNERIP 192.168.0.49// XCAAFS#define XCAAFSOUTTERIP 192.168.0.49// XCLS#define XCLSOUTERIP 192.168.0.49// æœ¬ç»„é…ç½®çš„ç«¯å£å¢é‡ï¼ˆä¸»è¦ç”¨äºåœ¨åŒä¸€å°æœºå™¨ä¸Šå¯åŠ¨å¤šç»„æœåŠ¡å™¨ï¼‰#define PORTSHIEF 0// å…±äº«å†…å­˜å¢é‡#define SHMSHIFT 0// æ—¥å¿—çš„è·Ÿè·¯å¾„ï¼ˆæ³¨æ„è¿™ä¸ªé…ç½®ï¼Œå¦‚æœåœ¨åé¢åŠ ä¸Šäº†"/"åˆ™ä¼šå¯¼è‡´ç›®å½•åˆ›å»ºå¤±è´¥ï¼Œå› ä¸ºå­—ä¸²ä¸­åæ¥å½¢æˆçš„//ä¼šè¢«å½“æˆæ³¨é‡Šï¼‰#define LOGPATH /ITC/LOG// æ•°æ®åº“ç›¸å…³çš„å®šä¹‰#define DB_HOST localhost// å¦‚æœDB_HOSTæ˜¯localhoståˆ™éœ€è¦å¡«å†™è¿™ä¸ªï¼Œé»˜è®¤å€¼æ˜¯/tmp/mysql.sock#define DB_SOCKET /TMP/mysql.sock#define DB__USER root#define DB_PASSWORD zentiadb2017#define DB_CHARSET utf8// ç”¨æˆ·æ•°æ®åº“#define PLAYERDB zentia0// å…¨å±€æ€»æ§ç›¸å…³æ•°æ®åº“ï¼ˆGMS4Gameä½¿ç”¨çš„ï¼‰#define IMSDB ims0////////////////////////////////////////////////////// ä¸ç»å¸¸å˜çš„éƒ¨åˆ†////////////////////////////////////////////////////// è¡¨é¢è¿™æ˜¯debugç‰ˆæœ¬#define DEBUG// è¡¨æ˜è¿™æ˜¯å†…éƒ¨è°ƒè¯•ç”¨çš„ï¼Œå¯ä»¥æ”¾å®½ä¸€äº›é™åˆ¶ï¼ˆæ­£å¸¸è¿è¥æ—¶åº”è¯¥æ³¨è§†æ‰ï¼‰// #define INNERDEBUG// è¡¨æ˜å®¢æˆ·ç«¯è¶…æ—¶ä¸è¦å¤ªé•¿ï¼ˆåœ¨å†…éƒ¨æµ‹è¯•çš„æ—¶å€™å¯èƒ½æœ‰ç”¨ï¼Œå› ä¸ºæœ‰æ—¶å€™éœ€è¦é•¿æ—¶é—´ä¸æ–­ï¼Œæœ‰æ—¶å€™éœ€è¦æ­£å¸¸è¶…æ—¶æ–­ï¼‰// define QUICKDROP/////////////////////////////////////////////////////// æ—¥å¿—æœåŠ¡å®šä¹‰/////////////////////////////////////////////////////// æ—¥å¿—æœåŠ¡çš„æè¿°ä¸²ï¼ˆæ ¹æ®å„ä¸ªæœåŠ¡å™¨éœ€æ±‚çš„ä¸åŒåˆ†ä¸ºä¸‹é¢ä¸‰ä¸ªç­‰çº§ï¼‰#define LOGADDRSTR_0 0,$(LOGSVR):2000+$(PORTSHIFT), 1,$(LOGSVR):2001+$(PORTSHIFT), 2,$(LOGSVR):2002+$(PORTSHIFT)#define LOGADDRSTR_1 0,$(LOGSVR):2000+$(PORTSHIFT), 1,$(LOGSVR):2001+$(PORTSHIFT), 2,$(LOGSVR):2002+$(PORTSHIFT), 3,$(LOGSVR):2003+$(PORTSHIFT), 4,$(LOGSVR):2004+$(PORTSHIFT), 5.$(LOGSVR):2005+$(PORTSHIFT), 6,$(LOGSVR):2006+$(PORTSHIFT)#define LOGADDRSTR_1 0,$(LOGSVR):2000+$(PORTSHIFT), 1,$(LOGSVR):2001+$(PORTSHIFT), 2,$(LOGSVR):2002+$(PORTSHIFT), 3,$(LOGSVR):2003+$(PORTSHIFT), 4,$(LOGSVR):2004+$(PORTSHIFT), 5.$(LOGSVR):2005+$(PORTSHIFT), 6,$(LOGSVR):2006+$(PORTSHIFT), 7,$(LOGSVR):2007+$(PORTSHIFT), 8,$(LOGSVR):2008+$(PORTSHIFT), 9,$(LOGSVR):2009+$(PORTSHIFT), 10,$(LOGSVR):2010+$(PORTSHIFT), 11,$(LOGSVR):2011+$(PORTSHIFT), 12.$(LOGSVR):2012+$(PORTSHIFT), 13,$(LOGSVR):2013$(PORTSHIFT), 14,$(LOGSVR):2014$(PORTSHIFT)// æœ¬å¤§åŒºæœ€å¤šæ”¯æŒçš„åŒæ—¶åœ¨çº¿ç”¨æˆ·æ•°é‡#define MAXPLAYER 16000// æœåŠ¡å™¨é—´tcpé€šè®¯çš„æ¶ˆæ¯ç¼“å†²è®¾ç½®#define MSGBUFFLEN 10*1024*1024// debugç‰ˆçš„æ–‡ä»¶åç¼€#ifdef DEBUG#define CFGEXT#else#define CFGEXT#endif// è¿™ä¸ªåªæœ‰é…ç½®caafs4chatçš„æ—¶å€™æ‰éœ€è¦ï¼Œæ­£å¸¸çš„é…ç½®ä¸éœ€è¦ï¼Œè¿™ä¸ªä¸€èˆ¬ä¸å˜çš„ï¼Œå› ä¸ºCAAFS4Chatä¸€èˆ¬å°±èµ·ä¸€ä¸ªå³å¯#define CAAFS4CHATID 1// æ˜¯å¦åœ¨GSZå®•æ‰ä¹‹åé‡æ–°æ‹‰èµ·è‡ªåŠ¨è½½å…¥ç”¨æˆ·#define GZSDOWNRESTOREPLAYER true// CNLç½‘ç»œè¶…æ—¶ï¼ˆå’Œå®¢æˆ·ç«¯çš„æ–­çº¿è¶…æ—¶ï¼‰#ifdef INNERDEBUG#define DROPTIMEOUT 2000000#else#define DROPTIMEOUT 100000#endif#ifdef QUICKDROP#define DROPTIMEOUT 600000#endif 2.2 GMS4Gameé…ç½®æ–‡ä»¶ï¼šgms4game_cfg.txtå…¸å‹å†…å®¹å¦‚ä¸‹ï¼š123456789101112131415161718192021#include ../cmncfg.txtCMN&#123; stream_size = $(MSGBUFFLEN) // æœ¬åœ°ç›‘å¬çš„åœ°å€å’Œç«¯å£ï¼ˆä¾›å…¶ä»–æœåŠ¡å™¨è¿æ¥ï¼‰ tcp_listen_host = $(MYOUTERIP):5000+$(PORTSHIFT) // å’Œå…¶ä»–æœåŠ¡å™¨TCPè¿æ¥çš„è¶…æ—¶è®¾ç½® keepalive_idle = 60000 keepalive_interval = 2000 // MySQLé…ç½® db_host = $(DB_HOST) db_user = $(DB_USER) db_password = $(DB_PASSWORD) db_database = $(IMSDB) db_charset = $(DB_CHARSET) db_socket = $(DB_SOCKET) // æ—¥å¿—æœåŠ¡ï¼ˆè¿™ä¸ªåªéœ€è¦æ¯”è¾ƒå°‘çš„æ—¥å¿—ç§ç±»ï¼‰ logger_addr = $(LOGADDRSTR_0) // szPIDFile = /tmp/GMS4Game-$(SVRGRPID).pid&#125; 2.3 XLBAé…ç½®æ–‡ä»¶ï¼šlba_cfg.txtå…¸å‹å†…å®¹å¦‚ä¸‹ï¼ˆåŸºäºXCMNSVRçš„é…ç½®ï¼‰:gzs_cfg1.txt12 é™„å½•1.åŸºäºXCMNSVRçš„é…ç½® XCMNSVRæ˜¯PNGSæ¡†æ¶ä¸­çš„ä¸€ç§æ ‡å‡†æœåŠ¡å™¨ç¨‹åºç»“æ„ã€‚ é€šè¿‡è¯¥ç»“æ„é…ç½®çš„æœåŠ¡å™¨ç”±ä¸€ä¸ªä¸»ç¨‹åºæ¡†æ¶ï¼šXCMNSVRå’Œä¸€ç³»åˆ—çš„åŠ¨æ€è¿æ¥åº“æ’ä»¶æ„æˆã€‚ å…¶é…ç½®æ–‡ä»¶ä¸€èˆ¬éƒ½æ˜¯ä¸‹é¢çš„æ ·å­ï¼š12345678910111213141516171819CMN&#123; // ç”¨äºè®°å½•æ—¥å¿—ä¸­è¡¨ç¤ºç¨‹åºåå’Œåœ¨windowsä¸‹æ˜¾ç¤ºçª—å£æ ‡é¢˜æ ä¸Š szSvrName = æœåŠ¡å™¨å // æ˜¯å¦è¿è¡Œä¸ºåå°å®ˆæŠ¤è¿›ç¨‹ï¼ˆè¿™ä¸ªé€‰é¡¹ä¸€èˆ¬åœ¨GDBå¯åŠ¨ç¨‹åºè¿›è¡Œè°ƒè¯•æ¯”è¾ƒæœ‰ç”¨ï¼‰ bDaemon = true // æ—¥å¿—æœåŠ¡åœ°å€ szLoggerAddr = $(LOGADDRSTR) // æ¯ä¸ªé€»è¾‘å¾ªç¯çš„æœ€å¤§æ—¶é—´ï¼ˆå…¶å¤§å°ä¼šå½±å“æœåŠ¡å™¨åœ¨æ²¡æœ‰ç½‘ç»œè¾“å…¥è¾“å‡ºçš„æƒ…å†µä¸‹çš„é€»è¾‘tickç²¾åº¦ï¼‰ nSelectInterval = 50&#125;PlugIn&#123; // å„ä¸ªæ’ä»¶çš„è½½å…¥å’Œåˆ›å»ºå‚æ•° // æ³¨æ„ï¼šæ’ä»¶çš„æ–‡ä»¶åå¿…é¡»æ˜¯å¸¦è·¯å¾„çš„ã€‚å³ä¾¿æ˜¯å½“å‰è·¯å¾„ä¸‹ä¹Ÿéœ€è¦å†™&quot;./&quot;å‰ç¼€ DLL = 0,/TCPReceiver$(CFGEXT).so,TCPReceiver_Create DLL = 0,/TCPReceiver$(CFGEXT).so,LBACDTest_Create&#125;// åé¢è·Ÿç€å„ä¸ªæ’ä»¶è‡ªå·±éœ€è¦çš„å‚æ•°é…ç½® é™„å½•2.CNTRSVRçš„é…ç½®é™„å½•3.GSMEMçš„é…ç½®é™„å½•4.IPçš„å…è®¸ç¦æ­¢æ–‡ä»¶çš„é…ç½®]]></content>
      <tags>
        <tag>server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexo Manual]]></title>
    <url>%2F2017%2F10%2F12%2Fhexo%2F</url>
    <content type="text"><![CDATA[å®‰è£…npm install -g hexo-cli å¦‚æœæç¤ºtimeoutçš„è¯ï¼Œä½¿ç”¨ä¸‹é¢æŒ‡ä»¤ npm config delete proxy å…³é—­èƒŒæ™¯åŠ¨ç”»èƒŒæ™¯åŠ¨ç”»åŸºäºcanvasï¼Œä¸ªäººæ„Ÿè§‰æ¯”è¾ƒè€—ï¼Œæ¯•ç«Ÿi3ï¼Œæ‰€ä»¥å…³é—­ï¼Œåœ¨\themes\next_config.ymlä¸­ä¿®æ”¹å­—æ®µ1three_waves: false åµŒå…¥PDFnpm install â€”save hexo-pdfæ·»åŠ  hexo deploy -- å‘å¸ƒ ç¼–è¾‘ä¸»é¢˜çš„ source/css/_variables/custom.styl æ–‡ä»¶ï¼Œæ–°å¢å˜é‡ï¼š12345// ä¿®æ”¹æˆä½ æœŸæœ›çš„å®½åº¦$content-desktop = 700px// å½“è§†çª—è¶…è¿‡ 1600px åçš„å®½åº¦$content-desktop-large = 900px å‘å¸ƒhexo d -g å¦‚æœå‘å¸ƒå¤±è´¥çš„è¯ï¼Œå°†sshæ¢æˆhttps://github.com/zentia/zentia.github.io.git Insert Image1&#123;% asset_img example.jpg This is an example image %&#125; Font1&lt;font size = 4 color=red&gt;&lt;/font&gt; # å­—ä½“å¤§å°é¢œè‰²è®¾ç½® åˆ—è¡¨åµŒå¥— ä¸Šä¸€çº§å’Œä¸‹ä¸€çº§ä¹‹é—´æ•²ä¸‰ä¸ªç©ºæ ¼å³å¯ ç”¨pass-by-refrence-to-constæ›¿æ¢pass-by-valueå†…ç½®ç±»å‹ï¼ŒSTLè¿­ä»£å™¨ï¼Œå’Œå‡½æ•°å¯¹è±¡é‡‡ç”¨pass-by-valueä¸è¦è¿”å›pointeræˆ–è€…referenceæŒ‡å‘ä¸€ä¸ªon stackå¯¹è±¡ï¼ˆè¢«ææ„ï¼‰ä¸è¦è¿”å›pointeræˆ–è€…referenceæŒ‡å‘ä¸€ä¸ªon heapå¯¹è±¡ï¼ˆéœ€è¦ç”¨æˆ·deleteï¼‰ä¸è¦è¿”å›pointeræˆ–è€…referenceæŒ‡å‘local staticå¯¹è±¡åˆ‡è®°å°†æˆå‘˜å˜é‡å£°æ˜ä¸ºprivateprotectedå¹¶ä¸æ¯”publicæ›´æœ‰å°è£…æ€§ï¼ˆå…¶å®æˆ‘ä¸æ˜¯å¾ˆå–œæ¬¢å°è£…è¿™ä¸ªä¸œè¥¿ï¼‰å¤šä¸€ä¸ªæˆå‘˜å‡½æ•°ï¼Œå°±å¤šä¸€åˆ†ç ´åå°è£…æ€§è‹¥æ‰€æœ‰å‚æ•°éƒ½éœ€è¦ç±»å‹è½¬æ¢ï¼Œé‡‡ç”¨non-memberå‡½æ•°ï¼ˆmemberç±»å‹è½¬æ¢ä¸è¡Œå—ï¼Ÿï¼‰ è…¾è®¯å¼€å‘è€…å¹³å° http://zentia.coding.me git@git.dev.tencent.com:Zentia/Hexo.git github http://zentia.github.io git@github.com:zentia/zentia.github.io.git ç äº‘ http://zentia.gitee.io git@gitee.com:zentia/zentia.git ä¿®å¤å›¾ç‰‡å±•ç¤ºæ–°å»ºåšæ–‡ï¼Œè®¾ç½®type: â€œpictureâ€ï¼Œä½¿ç”¨{\% gp x-x \%} â€¦ {\% endgp \%}æ ‡ç­¾å¼•ç”¨è¦å±•ç¤ºçš„å›¾ç‰‡åœ°å€ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213141516---title: Naruto-Picturescategories: [å›¾ç‰‡]tags: [picture,naruto]date: 2016-09-02 14:36:04keywords: picture,narutotype: &quot;picture&quot;top: 999---&#123;% gp 5-3 %&#125;![](https://cdn.ehlxr.top/post/18210.jpg)![](https://cdn.ehlxr.top/post/196232.jpg)![](https://cdn.ehlxr.top/post/224147.jpg)![](https://cdn.ehlxr.top/post/199301.jpg)![](https://cdn.ehlxr.top/post/213318.jpg)&#123;% endgp %&#125; {\% gp 5-3 \%}ï¼šè®¾ç½®å›¾ç‰‡å±•ç¤ºæ•ˆæœï¼Œå‚è€ƒ theme/next/scripts/tags/group-pictures.js æ³¨é‡Šç¤ºæ„å›¾ã€‚ä¸»é¢˜ç›®å‰é¦–é¡µå¯ä»¥æ­£å¸¸æ˜¾ç¤ºæ­¥éª¤ 8.2 è®¾ç½®çš„å›¾ç‰‡æ•ˆæœï¼Œä½†æ˜¯ç‚¹å‡»è¿›å…¥åæ˜¾ç¤ºæ•ˆæœä¸¢å¤±ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ä¸€ä¸‹æ–‡ä»¶ themes\next\source\css_common\components\tags\group-pictures.styl ä¸­çš„ä»¥ä¸‹æ ·å¼ï¼š123456.page-post-detail .post-body .group-picture-column &#123; // float: none; margin-top: 10px; // width: auto !important; img &#123; margin: 0 auto; &#125;&#125; algoliaç”±äºzentia.siteè¿™ä¸ªåŸŸåæ²¡æœ‰å¤‡æ¡ˆï¼Œå¯¼è‡´ä¸€ç›´æ— æ³•ä½¿ç”¨ï¼Œç„¶ååªèƒ½ä½¿ç”¨zentia.github.ioã€‚ç„¶åä¸€ç›´æ²¡æœ‰æ›´æ–°algoliaå¯¼è‡´æœç´¢è¿˜æ˜¯è®¿é—®ä¹‹å‰çš„æºï¼Œè¿™ä¸ªé—®é¢˜ç—›è‹¦äº†å¥½ä¹…ã€‚ç„¶åä»Šå¤©è§£å†³ hexo algolia å¯èƒ½ä¼šæç¤ºâ€ERROR [hexo-algolia] Please set an HEXO_ALGOLIA_INDEXING_KEY environment variaâ€è¿™ä¸ªé—®é¢˜ï¼Œç„¶åâ€export HEXO_ALGOLIA_INDEXING_KEY=â€™f4ca7ae2408d2e27ffc8269ad8d34273â€™â€è¿™æ ·å°±è§£å†³äº†ã€‚]]></content>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[gitç¬”è®°]]></title>
    <url>%2F2017%2F10%2F12%2Fgit-question%2F</url>
    <content type="text"><![CDATA[warning:LF will be replaced by CRLFé—®é¢˜è§£å†³æ–¹æ³•CRLF â€” Carriage-Return Line-Feedå›è½¦(ASCLL 13, \r)æ¢è¡Œ(LF, ASCLL 10, \n)ã€‚è§£å†³æ–¹æ³•1git config --global core.autocrlf false åˆ‡æ¢httpgit remote set-url origin https://github.com/zentia/blog.git]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[The following untracked working tree files would be overwritten by merge]]></title>
    <url>%2F2017%2F10%2F12%2FThe-following-untracked%2F</url>
    <content type="text"><![CDATA[git pullçš„æ—¶å€™é‡åˆ°çš„é—®é¢˜ã€‚è§£å†³åŠæ³•ï¼šgit clean -d -fxnote:ä¼šåˆ é™¤æ²¡æœ‰addåˆ°ä»“åº“çš„æ–‡ä»¶ï¼Œæ“ä½œè®°å¾—æ…é‡ï¼Œä»¥å…æ”¹åŠ¨æ–‡ä»¶çš„ä¸¢å¤±ã€‚]]></content>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆå§‹åŒ–äº‘æœåŠ¡å™¨]]></title>
    <url>%2F2017%2F10%2F11%2Finit-server%2F</url>
    <content type="text"><![CDATA[æ­å»ºgitæœåŠ¡å™¨yum install -y gitadduser git //åˆ›å»ºç”¨æˆ·gitgit clone git@10.173.32.7:/home/git/sample.git //å…‹éš†è¿œç¨‹ä»“åº“ clone gitä»“åº“ä¸Šä¼ ä»£ç git commit -am â€œâ€œ, å°†æ‰€æœ‰ä¿®æ”¹ï¼Œä½†æœªè¿›stageçš„æ”¹åŠ¨åŠ å…¥stage,å¹¶è®°å½•commitä¿¡æ¯ï¼ˆæŸç§ç¨‹åº¦ä¸Šç›¸å½“äºgit add å’Œ git commit -mçš„ç»„åˆ,å‰ææ˜¯è¢«æ”¹åŠ¨æ–‡ä»¶å·²ç»æ˜¯tracked)1find ./ -type d -name "del_dir" -exec rm -r &#123;&#125; \; æ³¨æ„ä¸­é—´çš„ç©ºæ ¼]]></content>
      <tags>
        <tag>Server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity 2Dæè¾¹å®ç°ä»‹ç»]]></title>
    <url>%2F2017%2F10%2F05%2F2d-outline%2F</url>
    <content type="text"><![CDATA[åƒç´ ç€è‰²å™¨æè¾¹ï¼šé¦–å…ˆæœ€ç›´è§‚çš„æƒ³æ³•ï¼Œå°±æ˜¯ä½¿ç”¨fragment shaderæ‰¾å‡º2Dè§’è‰²è´´å›¾é€æ˜åƒç´ å’Œéé€æ˜åƒç´ çš„è¾¹ç•Œï¼Œç„¶åé€šè¿‡è¾¹ç•Œå‘¨è¾¹Alphaå€¼Blurçš„æ–¹å¼ï¼Œç»™è¾¹ç•Œä¸Šæè¾¹è‰²ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869Shader &quot;Hidden/NewImageEffectShader&quot;&#123; Properties &#123; _MainTex (&quot;Texture&quot;, 2D) = &quot;white&quot; &#123;&#125; _Offset (&quot;Offset&quot;, Range(0,1)) = 0.1 // åç§» _Color (&quot;Color&quot;, Color) = (1,0,0,1) // è¾¹ç¼˜è‰² _AlphaThreshold(&quot;Alpha Threshold&quot;, Range(0,1)) = 0.5 &#125; SubShader &#123; Tags &#123;&quot;Queue&quot;=&quot;Transparent&quot;&#125; Blend SrcAlpha OneMinusSrcAlpha Pass &#123; CGPROGRAM #pragma vertex vert #pragma fragment frag #include &quot;UnityCG.cginc&quot; struct appdata &#123; float4 vertex : POSITION; float2 uv : TEXCOORD0; &#125;; struct v2f &#123; float2 uv[5] : TEXCOORD0; float4 vertex : SV_POSITION; &#125;; sampler2D _MainTex; float4 _MainTex_ST; fixed _Offset; // åç§» fixed4 _Color; // è¾¹ç¼˜è‰² fixed _AlphaThreshold; // Alpha é˜€å€¼ v2f vert (appdata v) &#123; v2f o; o.vertex = UnityObjectToClipPos(v.vertex); o.uv[0] = v.uv; o.uv[1] = v.uv + float2(0, _Offset);// ä¸Š o.uv[2] = v.uv + float2(0, -_Offset); // ä¸‹ o.uv[3] = v.uv + float2(-_Offset, 0); // å·¦ o.uv[4] = v.uv + float2(_Offset, 0); // å³ return o; &#125; fixed4 frag (v2f i) : SV_Target &#123; fixed4 col = tex2D(_MainTex, i.uv[0]); fixed alpha = col.a; fixed p1 = tex2D(_MainTex, i.uv[1]).a; fixed p2 = tex2D(_MainTex, i.uv[2]).a; fixed p3 = tex2D(_MainTex, i.uv[3]).a; fixed p4 = tex2D(_MainTex, i.uv[4]).a; alpha = (alpha + p1 + p2 + p3 + p4) / 5; fixed ret = step(alpha, _AlphaThreshold); col.rgb = ret * _Color.rgb + col.rgb * (1-ret); return col; &#125; ENDCG &#125; &#125;&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566Shader &quot;Hidden/NewImageEffectShader&quot;&#123; Properties &#123; _Edge (&quot;Edge&quot;, Range(0,0.5)) = 0.1 // è¾¹ç¼˜ _EdgeColor (&quot;Edge Color&quot;, Color) = (1,0,0,1) // è¾¹ç¼˜è‰² _FlowColor (&quot;Flow Color&quot;, Color) = (0,1,0,1) // æµåŠ¨è‰² _Speed (&quot;Speed&quot;, Range(0, 2)) = 1 // æ—‹è½¬é€Ÿåº¦ _MainTex(&quot;MainTex&quot;, 2D) = &quot;white&quot; &#123;&#125; // ä¸»çº¹ç† &#125; SubShader &#123; Tags &#123;&quot;Queue&quot; = &quot;Transparent&quot;&#125; Blend SrcAlpha OneMinusSrcAlpha Pass &#123; CGPROGRAM #pragma vertex vert #pragma fragment frag #include &quot;UnityCG.cginc&quot; struct appdata &#123; float4 vertex : POSITION; float2 uv : TEXCOORD0; // çº¹ç†uvåæ ‡ &#125;; struct v2f &#123; float4 vertex : SV_POSITION; float2 uv : TEXCOORD0; &#125;; sampler2D _MainTex; float4 _MainTex_ST; fixed _Edge; // è¾¹ç¼˜é˜€å€¼ fixed4 _EdgeColor; // è¾¹ç¼˜è‰² fixed4 _FlowColor; // æµåŠ¨è‰² fixed _Speed; // æ—‹è½¬é€Ÿåº¦ v2f vert (appdata v) &#123; v2f o; o.vertex = UnityObjectToClipPos(v.vertex); o.uv = v.uv; return o; &#125; fixed4 frag (v2f i) : SV_Target &#123; fixed x = i.uv.x; fixed y = i.uv.y; if (x &lt; _Edge || abs(1 - x) &lt; _Edge || y &lt; _Edge || abs(1 - y) &lt; _Edge) // æ±‚è¾¹ç¼˜ &#123; x -= 0.5; y -= 0.5; fixed w = _Speed * _Time.y; fixed temp = saturate(x* cos(w) - y* sin(w)); return (temp )* _EdgeColor + (1-temp)*_FlowColor; &#125; return tex2D(_MainTex, i.uv); &#125; ENDCG &#125; &#125;&#125; åå¤„ç†+åƒç´ ç€è‰²å™¨æè¾¹ï¼š äºæ˜¯ï¼Œå¾ˆè‡ªç„¶çš„æƒ³åˆ°ï¼Œä½¿ç”¨Postprocessing çš„æ–¹å¼æ¥å¤„ç†å±å¹•æœ€ç»ˆæ¸²æŸ“å‡ºæ¥çš„ä»…åŒ…å«æœ‰éœ€è¦æè¾¹çš„è§’è‰²çš„å›¾ç‰‡ï¼Œç„¶åè¿›è¡Œä¸Šè¿°çš„fragmentæè¾¹å¤„ç†ã€‚ é¦–å…ˆï¼Œåœ¨åœºæ™¯ä¸­æ·»åŠ ä¸€ä¸ªä¸“ç”¨çš„æè¾¹ç›¸æœºï¼ŒDepthè®¾ä¸ºæ¯”é»˜è®¤ç›¸æœºé«˜ä¸€çº§ï¼Œè§†å£å¤§å°ã€ä½ç½®å…¨éƒ¨å’Œé»˜è®¤ç›¸æœºä¸€è‡´ã€‚å¦å¤–ç»™åœºæ™¯ç‰©ä½“æ·»åŠ ä¸€ä¸ªâ€Outline1â€layerï¼Œè®¾ç½®åˆ°ä¸“ç”¨ç›¸æœºçš„cullingmaskï¼Œéœ€è¦æè¾¹çš„è§’è‰²çš„layeréƒ½è®¾ç½®ä¸ºâ€Outline1â€ã€‚ è¿™ä¸ªæ—¶å€™ä¸“ç”¨ç›¸æœºåªæ¸²æŸ“æè¾¹ç‰©ä½“ï¼Œç„¶åç»™ç›¸æœºæ·»åŠ Monobehaviorè„šæœ¬ï¼Œåœ¨OnRenderImageé‡Œå¯¹ç›¸æœºæ¸²æŸ“çš„å›¾åƒè¿›è¡Œåƒç´ ç€è‰²å™¨çš„æè¾¹å¤„ç†ï¼Œå¾—åˆ°å¦‚ä¸‹æ•ˆæœï¼š æè¾¹æ•ˆæœçš„ç¡®æ˜¯é¢„æœŸçš„æ•ˆæœï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š ä¸€ä¸ªæ˜¯ï¼šç”±äºæˆ‘ä»¬æ¸¸æˆUIæ˜¯ä½¿ç”¨Screen space - cameraçš„æ–¹å¼ï¼Œå®ƒå’Œæ¸¸æˆä¸­å¯¹è±¡éƒ½æ˜¯åœ¨é»˜è®¤ç›¸æœºæ¸²æŸ“çš„ï¼Œä¸“ç”¨ç›¸æœºçš„depthæ¯”é»˜è®¤ç›¸æœºé«˜ä¸€çº§ï¼Œæ‰€ä»¥æ‰€æœ‰æ¸²æŸ“å†…å®¹éƒ½ä¼šåœ¨UIå±‚æ¬¡ä¹‹ä¸Šï¼Œè¿™æ˜¾ç„¶ä¹Ÿä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚ å¦ä¸€ä¸ªæ˜¯ï¼šè§’è‰²çš„ä¸åŒè¡ŒåŠ¨çŠ¶æ€éœ€è¦ç”¨ä¸åŒçš„æè¾¹é¢œè‰²æ¥åŒºåˆ†ï¼Œä¸Šè¿°æ–¹å¼åªæ”¯æŒä¸€ç§æè¾¹é¢œè‰²ã€‚ ä¸‰ã€RenderTarget + åƒç´ ç€è‰²å™¨æè¾¹ï¼š ç°åœ¨æˆ‘ä»¬ç€é‡æ¥è§£å†³ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜ï¼šç¬¬ä¸€ä¸ªé®æŒ¡UIçš„é—®é¢˜ï¼š æè¾¹æ•ˆæœéœ€è¦åœ¨é»˜è®¤ç›¸æœºä¸­è¿›è¡Œzè½´æ’åºï¼Œè®©å…¶æ¸²æŸ“åœ¨UIä¹‹åï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦è®©æè¾¹æ•ˆæœä½œä¸ºä¸€ä¸ªé»˜è®¤ç›¸æœºæ¸²æŸ“çš„å¸¸è§„æ¸¸æˆå¯¹è±¡æ”¾åˆ°æ¸¸æˆä¸­ã€‚äºæ˜¯ï¼Œæˆ‘æƒ³åˆ°çš„æ˜¯ç»™å®ƒåˆ›å»ºä¸€ä¸ªå’Œå±å¹•å°ºå¯¸åŒå¤§å°çš„Meshï¼Œå†å°†æè¾¹æ¸²æŸ“çš„å›¾ç‰‡æ”¾åˆ°Meshä¸Šï¼Œæ‰€ä»¥ï¼Œåšæ³•æ˜¯ç»™ä¸“ç”¨ç›¸æœºåˆ†é…ä¸€ä¸ªå±å¹•å°ºå¯¸åŒå¤§å°çš„RenderTargetï¼Œç„¶åå°†RenderTargetæ¸²æŸ“åˆ°åˆ›å»ºçš„Meshä¸Šã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¯¥Meshåœ¨éª¨éª¼åŠ¨ç”»å’Œç›¸æœºä¹‹é—´åˆ›å»ºã€‚ ç¬¬äºŒä¸ªé¢œè‰²åŒºåˆ†çš„é—®é¢˜ï¼š æŸ¥è¯¢Unity Cameraçš„APIæœ‰ä¸¤ä¸ªå›è°ƒæ¥å£å¯ä»¥ç”¨ï¼š OnPreRender åœ¨ç›¸æœºæ¸²æŸ“åœºæ™¯ä¹‹å‰è¢«è°ƒç”¨ã€‚ OnPostRender åœ¨ç›¸æœºå®Œæˆåœºæ™¯æ¸²æŸ“ä¹‹åè¢«è°ƒç”¨ã€‚ æˆ‘ä»¬ç»™ä¸“ç”¨ç›¸æœºæ·»åŠ è¿™ä¸¤ä¸ªå›è°ƒï¼Œåœ¨OnPreRenderé‡Œï¼š ç»™æ‰€æœ‰éœ€è¦æè¾¹çš„ç‰©ä½“æ›´æ¢Materialï¼Œè¯¥Materialè´Ÿè´£ç»˜åˆ¶è¯¥ç‰©ä½“çš„çŠ¶æ€çº¯é¢œè‰²åˆ°RenderTargetä¸Šï¼Œå¹¶ä¿å­˜åŸæœ‰Materialã€‚åœ¨OnPostRenderé‡Œï¼š å°†åŸæœ‰Materialåˆç½®æ¢å›æ¥ä¾›é»˜è®¤ç›¸æœºæ­£å¸¸æ¸²æŸ“ã€‚å¾—åˆ°çš„RenderTargetå¦‚ä¸‹ï¼Œ è¿™ä¸ªæ—¶å€™ï¼Œå†ç”¨åƒç´ ç€è‰²å™¨å¯¹åº”ç”¨äº†RenderTargetçš„Meshè¿›è¡Œæè¾¹ï¼Œå¾—åˆ°å¦‚ä¸‹æ•ˆæœ]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pixel-and-voxel]]></title>
    <url>%2F2017%2F10%2F05%2Fpixel-and-voxel%2F</url>
    <content type="text"><![CDATA[åŸæ–‡åœ°å€: https://medium.com/retronator-magazine/pixels-and-voxels-the-long-answer-5889ecc18190#.8gf6zy8mc ä¼ª3Dç­‰è½´æ¸¸æˆ èµ›è¾¾å°”, Sir Carma, 2016 åƒç´ å’Œä½“ç´ ï¼Œä¸€ä¸ªè¯¦ç»†çš„ç­”æ¡ˆRetronator Stray Pixels åƒç´ å’Œä½“ç´ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ æˆ‘å¾ˆæ¸…æ¥šä»–çš„é—®é¢˜ã€‚ä½ ä¼šåœ¨ç”Ÿæ´»ä¸­çœ‹åˆ°ç±»ä¼¼åƒç´ å¤§æˆ˜ç”µå½±æµ·æŠ¥è¿™æ ·çš„ä¸œè¥¿ï¼Œè€Œä½ ä¼šå¯¹æ­¤äº§ç”Ÿå›°æƒ‘ã€‚å®ƒæ˜¯åƒç´ å—ï¼Ÿè¿˜æ˜¯ä½“ç´ ï¼Ÿå®ƒæ˜¯ä¸€åªé¸Ÿï¼Ÿè¿˜æ˜¯ä¸€æ¶é£æœºï¼Ÿè¿™ä¸ªä¸œè¥¿ä¸€å®šä¸ç®€å•ã€‚ä¸å¿…å®³æ€•ï¼Œæˆ‘æ¥è§£é‡Šè¿™ä¸ªé—®é¢˜ã€‚å½“ä½ é˜…è¯»å®Œè¿™ç¯‡æ–‡ç« åä½ ä¼šçŸ¥é“æ‰€æœ‰å…³äºåƒç´ å’Œä½“ç´ çš„çŸ¥è¯†ä»¥åŠå®ƒä»¬ä¹‹é—´çš„è”ç³»ã€‚ é¦–å…ˆæˆ‘å…ˆä»‹ç»ä¸€ç‚¹èƒŒæ™¯çŸ¥è¯†ä»¥ä¾¿ä½ æ›´å¥½çš„äº†è§£è¯¥é¢†åŸŸçš„å…¨è²Œã€‚åœ¨è®¡ç®—æœºä¸­æœ‰ä¸¤ç§è¡¨ç¤ºå›¾åƒçš„æ–¹æ³•ï¼šå‘é‡å’Œæ …æ ¼ï¼ˆrasterï¼‰ã€‚ å‘é‡å›¾åƒï¼ˆå·¦ï¼‰çš„æ•°å­¦å‡†ç¡®æ€§å’Œæ …æ ¼å›¾åƒï¼ˆå³ï¼‰çš„ç¦»æ•£æ€§å‘é‡å›¾åƒä½¿ç”¨å„ç§è¡¨ç¤ºç›´çº¿ï¼Œæ›²çº¿å’Œä¸åŒå½¢çŠ¶çš„æ•°å­¦æ–¹ç¨‹æè¿°å›¾åƒã€‚ç›¸åï¼Œæ …æ ¼å›¾åƒå°†å›¾åƒæè¿°ä¸ºä¸€ä¸ªå«æœ‰é¢œè‰²å€¼çš„æ•°ç»„ï¼Œè¯¥æ•°ç»„ä¸­çš„é¢œè‰²å€¼ä¾æ¬¡è¢«æ”¾ç½®åœ¨ä¸€ä¸ªç½‘æ ¼ç³»ç»Ÿä¸­ã€‚ è®¡ç®—æœºå›¾åƒå­¦ä¸­çš„ç¬¬äºŒä¸ªåŒºåˆ«åœ¨äº2Då’Œ3Dç©ºé—´ä¹‹é—´çš„å·®åˆ«ã€‚ç®—ä¸Šå‘é‡/æ …æ ¼çš„åŒºåˆ«æ€»å…±æœ‰å››ç§æƒ…å†µï¼š å¤§å®¶éƒ½å–œæ¬¢è±¡é™ï¼å‘é‡å›¾åƒåœ¨2Då‘é‡å›¾åƒä¸­ï¼Œç›´çº¿æˆ–ä¸åŒå½¢çŠ¶ä¸Šçš„æ¯ä¸ªç‚¹éƒ½ç”±å…·æœ‰ä¸¤ä¸ªåˆ†é‡ï¼ˆxå’Œyï¼‰çš„å‘é‡æ¥è¡¨ç¤ºã€‚è¿™å°±æ˜¯å®ƒè¢«ç§°ä¸º2Dçš„åŸå› ï¼ˆä¸¤ä¸ªåˆ†é‡â€”â€”ä¸¤ä¸ªç»´åº¦ï¼‰ã€‚ 2Då‘é‡æ˜¯è¿™æ ·è¡¨ç¤º2Då‘é‡å›¾åƒä¸­æ¯ä¸ªç‚¹çš„ä»¥ä¸‹æ˜¯ä¸€å¼ æ‰€è°“çš„ä½å¤šè¾¹å½¢2Då‘é‡å›¾åƒ ä¼Ÿå¤§æ¢¦æƒ³ç€ä¹Œé²é²ï¼ˆUluru the Mighty Dreamerï¼‰, Anh Tran, 2015å®ƒå®Œå…¨ä½¿ç”¨äº†2Då¤šè¾¹å½¢ï¼ˆåœ¨è¿™ä¸ªæƒ…å†µä¸­ä¸ºä¸‰è§’å½¢ï¼‰ã€‚ä½å¤šè¾¹å½¢è¿™ä¸ªæœ¯è¯­æ„å‘³ç€åˆ¶æˆå›¾åƒæ‰€éœ€çš„å¤šè¾¹å½¢æ•°é‡ç›¸å¯¹è¾ƒå°‘ã€‚è¿™ä½¿å¾—ä¸‰è§’å½¢å®¹æ˜“è¢«è¯†åˆ«å‡ºæ¥ã€‚æˆ‘ä»¬åŠ å…¥ä¸€ä¸ªç»´åº¦ã€‚åœ¨3Då‘é‡å›¾åƒä¸­æƒ…å†µç›¸åŒï¼Œä½†æ˜¯æ¯ä¸ªå‘é‡ä½¿ç”¨äº†ä¸‰ä¸ªåˆ†é‡ï¼ˆxï¼Œyï¼Œzï¼‰ã€‚ä¸‰ä¸ªåˆ†é‡â€”â€”ä¸‰ä¸ªç»´åº¦ã€‚æˆ‘ä»¬çœ‹ä¸€å¼ 3Dä½å¤šè¾¹å½¢çš„ä½œå“ã€‚ iOSæ¦‚å¿µæ¸¸æˆ èµ›é“, Timothy J. Reynolds, 2013 ä¹‹å‰çš„Ayers Rockçš„2Då›¾åƒå’Œè¿™é‡Œçš„3Dè·‘é“ä¹‹é—´çš„åŒºåˆ«åœ¨äºæˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬æƒ³è¦çš„ä»»æ„ä½ç½®çœ‹è¿™ä¸ªè·‘é“ã€‚ iOSæ¦‚å¿µæ¸¸æˆ èµ›é“ (å¦å¤–è§†è§’), Timothy J. Reynolds, 2013ä¸ºäº†åœ¨ä½ çš„å±å¹•ï¼ˆä¸€ä¸ª2Då¹³é¢ï¼‰ä¸Šæ˜¾ç¤ºè·‘é“ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç‰¹å®šçš„è§†ç‚¹ï¼ˆviewpointï¼‰ç„¶åä»é‚£ä¸€ç‚¹å°†3Då‡ ä½•ä½“æŠ•å½±åˆ°2Dä¸­ã€‚ ä»3Då‘2Dçš„å˜æ¢å«åšæŠ•å½±è¿™æ˜¯æˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªç‰¹å®š2Då›¾ç‰‡çš„æ–¹æ³•ã€‚ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå°æŠ€å·§æ¥åœ¨2Dä¸­æ˜¾ç¤º3Då‡ ä½•ä½“çš„ä½“ç§¯ç‰¹å¾â€”â€”æˆ‘ä»¬å¯ä»¥åˆ¶ä½œä¸€ä¸ªåŠ¨ç”»ï¼Œå°†æˆ‘ä»¬çš„è§†ç‚¹è®¾ç½®ä¸ºç»•ç‰©ä½“æ—‹è½¬ï¼ˆæˆ–è€…å›ºå®šè§†ç‚¹ï¼Œæ—‹è½¬ç‰©ä½“ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ æ—…è¡Œè½¦, Timothy J. Reynolds, 2013è€¶ï¼æˆ‘ä»¬çœŸçš„çœ‹åˆ°äº†3Dï¼Œä¸éœ€è¦3Dçœ¼é•œï¼ æ …æ ¼å›¾åƒè¿™åªæ˜¯çƒ­èº«ã€‚å‘é‡æš‚å‘Šä¸€æ®µè½ï¼Œæˆ‘ä»¬ç»§ç»­çœ‹çœ‹æ …æ ¼å›¾åƒå¦‚ä½•å¤„ç†2Då’Œ3Dã€‚åœ¨2Dæ …æ ¼å›¾åƒä¸­ï¼Œå›¾ç‰‡è¢«åˆ†ä¸ºè‹¥å¹²è¡Œåˆ—çš„å°æ–¹æ ¼ï¼Œè¿™äº›å°æ–¹æ ¼å¤§å°ç›¸ç­‰ã€‚ Turbo Esprit Sprite, Matej â€˜Retroâ€™ Jan, 2014æ¯ä¸ªå•å…ƒè¢«ç§°ä½œä¸€ä¸ªåƒç´ ï¼ˆæ¥è‡ªå›¾ç‰‡çš„å…ƒç´ ï¼‰ã€‚é™¤äº†ç½‘æ ¼ä¸­çš„2Dåæ ‡ï¼ˆxï¼Œyï¼‰å®ƒçš„ä¸»è¦æ€§è´¨è¿˜æœ‰é‚£ä¸ªåæ ‡çš„é¢œè‰²ã€‚ æˆ‘ä»¬å·²ç»è§è¿‡ä½å¤šè¾¹å½¢å‘é‡æ–¹æ³•å¦‚ä½•ä½¿ç”¨æ˜“äºè¾¨è®¤çš„å¤§å¤šè¾¹å½¢ã€‚å¦‚æœæˆ‘ä»¬åœ¨æ …æ ¼å›¾åƒä¸­ä¹Ÿè¿™æ ·åšï¼ˆä½¿ç”¨æ˜æ˜¾çš„å¤§åƒç´ ï¼‰æˆ‘ä»¬å¾—åˆ°äº†åƒç´ è‰ºæœ¯ã€‚ Tribute (ä¿®æ­£ç‰ˆ), Matej â€˜Retroâ€™ Jan, 2005, 2012å¯¹äº2Dåƒç´ å›¾ç‰‡æ¥è¯´ï¼Œå°½ç®¡å®ƒä»¬æƒ³è¦è¡¨ç¤ºä¸‰ç»´ç‰©ä½“ï¼ˆä¸€ä¸ªLotus Esprit æˆ–è€…ä¸€ä¸ªX-wingï¼‰ï¼Œä½†æ˜¯å®ƒä»¬è¢«ç›´æ¥ç”»åˆ°äº†2Dåƒç´ ç½‘æ ¼ä¸Šã€‚ä½ ä¸èƒ½åƒå‰é¢æ—‹è½¬3Då‘é‡å°æ±½è½¦é‚£æ ·æ—‹è½¬è¿™å¼ å›¾ç‰‡ã€‚åŒæ ·ï¼Œæ–‡ç« å¼€å§‹çš„é‚£å¼ Ayers Rockå›¾ç‰‡ä¹Ÿä¸èƒ½è¢«æ—‹è½¬ã€‚å°½ç®¡æ˜¯ç”±å¤šè¾¹å½¢æ„æˆçš„ï¼Œå®ƒä»¬æ²¡æœ‰è¢«æ”¾ç½®åœ¨3Dç©ºé—´å†…ï¼Œè€Œæ˜¯ç›´æ¥è¢«æ”¾åœ¨2Dä¸­ã€‚ ç›®å‰æˆ‘ä»¬å·²ç»ä»‹ç»å®Œäº†2Då’Œ3Då‘é‡å›¾åƒä»¥åŠ2Dæ …æ ¼å›¾åƒã€‚æœ€åæˆ‘ä»¬ä»‹ç»3Dæ …æ ¼å›¾åƒã€‚ å³å°†ä»‹ç»æ¿€åŠ¨äººå¿ƒçš„ä¸œè¥¿ï¼åœ¨3Dæ …æ ¼å›¾åƒä¸­ï¼Œä½“ç§¯è¢«å‡åŒ€åˆ†åˆ°è¡Œå’Œåˆ—ä¸­ï¼Œè¦†ç›–äº†å…¨éƒ¨ä¸‰ä¸ªä¸åŒçš„æ–¹å‘ï¼ˆä¸Šä¸‹ï¼Œå·¦å³ï¼Œé‡Œå¤–ï¼‰ã€‚è¿™æ ·3Dç©ºé—´è¢«åˆ†ä¸ºè®¸å¤šå°ç«‹æ–¹ä½“ï¼Œç§°ä¸ºä½“ç´ ï¼ˆä½“ç§¯å…ƒç´ æˆ–è€…ä½“ç§¯åƒç´ ï¼‰ã€‚æ¯ä¸ªä½“ç´ ç”±ä¸€ä¸ª3Dåæ ‡å’Œä½äºè¯¥åæ ‡çš„é¢œè‰²å®šä¹‰ã€‚ å’Œåƒç´ è‰ºæœ¯ï¼ˆæŒ‡çš„æ˜¯ç²¾å¿ƒå®‰æ’åƒç´ ä½ç½®çš„è‰ºæœ¯ï¼‰ä¸€æ ·ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰äº†ä½“ç´ è‰ºæœ¯ï¼Œå…¶ä¸­æ¯ä¸ªå°æ–¹å—éƒ½éœ€ä»”ç»†å®‰æ’ã€‚ æ˜Ÿçƒå¤§æˆ˜åœºæ™¯, Sir Carma, 2015å¤ªåƒä¹é«˜äº†ï¼Œä½ ä¸è¿™ä¹ˆè®¤ä¸ºå—ï¼Ÿæ³¨æ„ç”±äºæˆ‘ä»¬åœ¨3Dåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä»å„ç§æ–¹å‘è§‚å¯Ÿä½“ç´ ã€‚è¿™æ˜¯ä»å¦ä¸€ä¸ªè§’åº¦çœ‹Tatooineçš„ä½“ç´ ã€‚ æ˜Ÿçƒå¤§æˆ˜åœºæ™¯ (ä»å¦ä¸€è§†ç‚¹è§‚æµ‹), Sir Carma, 2015 æˆ‘ä»¬ç”šè‡³å¯ä»¥åšåŠ¨ç”»ï¼è¿™æ˜¯Sir Carmaçš„åŠ¨ç”»ä½“ç´ è§’è‰²ä¸­çš„ä¸€ä¸ªä¾‹å­ï¼š éª‘å£«å¿«è·‘ï¼ˆKnight Runï¼‰, Sir Carma, 2015å°†å®ƒå’Œ2Dåƒç´ è‰ºæœ¯è§’è‰²ä½œæ¯”è¾ƒï¼š æœ€åå…ƒç´ ï¼ˆLast Elementï¼‰ä¸­çš„ç²¾çµ, Glauber Kotaki, 2015ä½ å¯ä»¥çœ‹å‡ºåœ¨ä½“ç´ è‰ºæœ¯ä¸­ï¼ŒåŠ¨ç”»æ˜¯å¦‚ä½•æ”¹å˜å°æ–¹å—â€”â€”ä¹Ÿå°±æ˜¯ä½“ç´ â€”â€”çš„å¤–è¡¨ï¼ˆé¢œè‰²ï¼‰çš„ï¼Œä»¥åŠåœ¨åƒç´ è‰ºæœ¯ä¸­é¢œè‰²çš„æ”¹å˜æ˜¯å¦‚ä½•å‘ç”Ÿåœ¨å°æ–¹å—â€”â€”åƒç´ ä¸Šçš„ã€‚ç°åœ¨ä½ çŸ¥é“äº†åƒç´ å’Œä½“ç´ ä¹‹é—´çš„å·®åˆ«ï¼ˆä»¥åŠæ›´å¤šâ€¦â€¦å“ˆå“ˆï¼Œå¯¹äºè¿™ä¸€ç‚¹å¾ˆæŠ±æ­‰ï¼‰ã€‚ä½†æ˜¯è¿˜æ²¡å®Œã€‚ç§ï¼Œæˆ‘ä¹‹æ‰€ä»¥è§£é‡Šå‘é‡/æ …æ ¼ï¼Œä»¥åŠ2D/3Dæ˜¯å› ä¸ºåœ¨ç°ä»£æ˜¾ç¤ºè®¾å¤‡ä¸Šï¼Œæ¯ç§å›¾åƒç±»å‹æœ€åéƒ½ä¼šè¢«æ˜¾ç¤ºä¸º2Dæ …æ ¼å›¾ç‰‡ã€‚ æˆ‘ä»¬åœ¨ä¸€æœ¬åƒç´ è‰ºæœ¯æ‚å¿—ä¸­æåŠè¿™ä¸ªçš„åŸå› æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ç±»å˜æ¢æ¥åˆ›é€ å‡ºç°ä»£åƒç´ è‰ºæœ¯çš„é£æ ¼ï¼Œæ­¤é£æ ¼ä½¿ç”¨éåƒç´ è‰ºæœ¯è±¡é™ä¸­çš„è‰ºæœ¯èµ„æºã€‚â€œæˆ‘å¯ä»¥ä½¿ç”¨ä½“ç´ æˆ–3Dæ¨¡å‹åˆ¶ä½œåƒç´ å›¾åƒï¼Ÿâ€ä½ è§‰å¾—å‘¢ï¼Ÿæ²¡é”™å°±æ˜¯è¿™æ ·ï¼å·§å¦™åœ°è¿ç”¨ç€è‰²å’Œæ¸²æŸ“æŠ€æœ¯å¯ä»¥ä½¿æˆ‘ä»¬åˆ›é€ å‡ºç‹¬ç‰¹çš„è§†è§‰é£æ ¼ï¼Œå°†åƒç´ è‰ºæœ¯å¸¦å…¥åˆ°æœªæ¥ã€‚å‘é‡çš„æ˜¾ç¤ºå’ŒæŠ•å½±ä¸Šé¢çš„å›¾ç¤ºå¹¶ä¸å…¨éƒ¨æ­£ç¡®ã€‚æœ‰ä¸€ç§ç›´æ¥æ˜¾ç¤º2Då‘é‡å›¾åƒçš„æ–¹æ³•ï¼Œå®ƒä½¿ç”¨äº†ä¸€ä¸ªå°æŠ€å·§ã€‚ ä¸€å¼ 2Då‘é‡å›¾åƒåªèƒ½ç›´æ¥æ˜¾ç¤ºåœ¨ä¸€ä¸ªå‘é‡æ˜¾ç¤ºå™¨ä¸Šï¼Œå’ŒAtariçš„è¡—æœºæ¸¸æˆå¤ªç©ºå°„å‡»ä½¿ç”¨çš„é‚£äº›ä¸€æ ·ã€‚ å¤ªç©ºå°„å‡», Atari, 1979è¿™æ˜¯å®ƒå®é™…çœ‹ä¸Šå»çš„æ ·å­ï¼ˆç¤ºæ³¢å™¨ä¸Šæ˜¾ç¤ºçš„æ˜¯ä¸€æ¬¾ç±»ä¼¼äºå¤ªç©ºå°„å‡»çš„æ¸¸æˆï¼‰ å¤ªç©ºå²©çŸ³(æ¸¸æˆ), Autopilot, è§ Wikimedia Commons [CC BY-SA 3.0]æˆ‘ä»¬è¿˜å¯ä»¥è¿™æ ·æ˜¾ç¤º3Då‘é‡å›¾åƒï¼ˆé€šå¸¸è¢«ç§°ä¸º3Dæ¨¡å‹ï¼‰ã€‚ä¸ä¹‹å‰æåˆ°çš„ä¸€æ ·ï¼Œ3Dæ¨¡å‹é¦–å…ˆéœ€è¦è¢«æŠ•å½±åˆ°ä¸¤ä¸ªç»´åº¦ä¸Šï¼Œäº§ç”Ÿä¸€å¼ å¯ä»¥æ˜¾ç¤ºåœ¨å‘é‡æ˜¾ç¤ºå™¨ä¸Šçš„2Då‘é‡å›¾åƒã€‚ VEC9, Andrew Reitano &amp; Todd Bailey, 2013æˆ‘æåº¦æ¨èè§‚çœ‹VEC9å®£ä¼ ç‰‡ä»¥åŠ80å¹´ä»£çš„ç¡¬æ±‰ç‰‡ï¼šhttps://youtu.be/rSPixmsLfn4 VEC9, Andrew Reitano &amp; Todd Bailey, 2013 æ …æ ¼åŒ–å¤„ç†å¦‚ä»Šä½ å¾ˆéš¾åœ¨åšç‰©é¦†ä»¥å¤–çš„åœ°æ–¹æ‰¾åˆ°ä¸€ä¸ªå‘é‡æ˜¾ç¤ºå™¨ã€‚ç›¸åï¼Œæˆ‘ä»¬ä½¿ç”¨åƒç´ è¿›è¡Œæ˜¾ç¤ºï¼ RGB LCD, LuÃ­s FlÃ¡vio Loureiro dos Santos, è§ Wikimedia Commons [CC BY 3.0]ä¸€ä¸ªç°ä»£LCDæ˜¾ç¤ºå™¨é€šè¿‡å¼€å¯å’Œå…³é—­ï¼ˆæˆ–åŠå¼€åŠå…³ï¼‰å°çš„çº¢ç»¿è“LCDï¼ˆæ¶²æ™¶æ˜¾ç¤ºå™¨ï¼‰åˆ›é€ å‡ºä¸åŒçš„é¢œè‰²ã€‚ä»¥å…ä½ æœ‰ç–‘é—®ï¼ŒCRTï¼ˆé˜´æå°„çº¿ç®¡ï¼‰åŸç†ç±»ä¼¼ï¼Œåªä¸è¿‡å®ƒä»¬ä½¿ç”¨ä¸‰ç§è§å…‰ä½“è¿›è¡Œæ­é…ä»¥ä¾¿ç”µå­æŸæ’å‡»çš„æ—¶å€™äº§ç”Ÿçº¢ç»¿è“ä¸‰ç§é¢œè‰²ã€‚ CRT è§å…‰ç‚¹, è§ Wikipedia [CC-SA] é‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•å°†ä¸€å¼ å‘é‡å›¾ç‰‡æ˜¾ç¤ºåœ¨ä¸€ä¸ªæ …æ ¼æ˜¾ç¤ºå™¨ä¸Šå‘¢ï¼Ÿå—¯ï¼Œä»2Då‘é‡å›¾ç‰‡åˆ°2Dæ …æ ¼å›¾ç‰‡ï¼Œå›¾ç‰‡éœ€è¦è¢«æ¸²æŸ“æˆ–è€…è¢«æ …æ ¼åŒ–å¤„ç†ã€‚æ¯ä¸ªå¤šè¾¹å½¢ï¼ˆé€šå¸¸ä¸€ä¸ªä¸‰è§’å½¢ï¼‰è¢«æ¸²æŸ“ä¸ºç½‘æ ¼ä¸­çš„ä¸€ä¸ªåƒç´ ã€‚ ä½¿ç”¨æŠ½æ ·æ³•è¿›è¡Œæ …æ ¼åŒ–å¤„ç†, Making WebGL Danceçš„ä¸€å¼ å¹»ç¯ç‰‡, Steven Wittens, 2013 è¿™å¯ä»¥è¢«æ‹“å±•åˆ°åœ¨æ …æ ¼æ˜¾ç¤ºå™¨ä¸Šæ¸²æŸ“3Dæ¨¡å‹ã€‚é¦–å…ˆï¼Œ3Dä¸‰è§’å½¢è¢«æŠ•å½±ä¸º2Dä¸‰è§’å½¢ã€‚ç„¶å2Då‘é‡ä¸‰è§’å½¢è¢«æ …æ ¼åŒ–å¤„ç†ä¸ºåƒç´ ã€‚ æ˜Ÿé™…ç«ç‹, Nintendo, 1993 ä¸‰è§’åŒ–é‚£ä¹ˆä½“ç´ å‘¢ï¼Ÿç°åœ¨ä½“ç´ è‰ºæœ¯ä½¿ç”¨çš„æœ€å¸¸è§æ–¹æ³•æ˜¯å°†æ¯ä¸ªä½“ç´ è¡¨ç¤ºä¸ºä¸€ä¸ª3Då‘é‡æ–¹å—ï¼Œä¸ºæ­¤æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ²¿ä½“ç´ æ–¹å—è¾¹ç¼˜æ‘†æ”¾ä¸‰è§’å½¢çš„3Dæ¨¡å‹ ä¸–ç•Œä¸Šæœ€æ¿€åŠ¨äººå¿ƒçš„3Dæ¨¡å‹, Matej â€˜Retroâ€™ Jan, 2016 å’Œä¹‹å‰ä¸€æ ·ï¼Œ3Dä¸‰è§’å½¢æ¥ç€è¢«æŠ•å½±åˆ°2Då›¾åƒç©ºé—´ä¸­æœ€åè¢«æ …æ ¼åŒ–å¤„ç†æ¥æ˜¾ç¤ºä¸€å¼ 2Dæ …æ ¼å›¾åƒã€‚ æ—‹è½¬çš„æ–¹å— (æŠ€æœ¯æ¼”ç¤º), Matej â€˜Retroâ€™ Jan, 2016è¿™æ˜¯æˆ‘ä»¬ç°åœ¨å¾—åˆ°æœ€å¸¸è§çš„ä½“ç´ è‰ºæœ¯é£æ ¼çš„æ–¹æ³•ï¼Œå‡ ä¹å®Œå…¨ä½¿ç”¨å…è´¹å»ºæ¨¡å·¥å…·MagicaVoxelå®Œæˆã€‚ é•¿å‘å…¬ä¸»çš„å¡”ï¼ˆRapunzel towerï¼‰, Thibault Simar, 2016 æ— é¢˜, Argo San, 2016 å£è¢‹å¦–æ€ªçš„ä½“ç´ , Playiku, 2016 çŒ«å’ª vs ä½“ç´ , Stefan Smiljkovic, 2016 æˆ˜å£•å¥”è·‘ï¼ˆTrench Runï¼‰, Gabriel de Laubier, 2015 ä½“ç´ æ°”çƒ, Gabriel de Laubier, 2015 ç©ºä¸­è¿½å‡», Sir Carma, 2015 å¡”æ‹‰å…‹æ‘åº„ï¼ˆTalaak villageï¼‰, Sir Carma, 2016 Laticaæ‚¬å´–, Sir Carma, 2015 å…‰çº¿æŠ•å°„å…¶å®æˆ‘ä»¬å¯ä»¥ä¸é‡‡ç”¨ç«‹æ–¹ä½“æ–¹æ³•ã€‚æ¯ä¸ªä½“ç´ éƒ½å¯ä»¥è¢«è®¤ä¸ºæ˜¯3Dç©ºé—´ä¸­çš„ä¸€ä¸ªç‚¹ï¼Œé‚£ä¸ªä½ç½®çš„ä¸€ä¸ªblobï¼ˆäºŒè¿›åˆ¶å¤§å¯¹è±¡ï¼‰ä½“ç§¯ã€‚ä½ å¯ä»¥é€šè¿‡åœ¨2Dç©ºé—´ä¸­çš„ä¸€ä¸ªä½ç½®æ”¾ç½®ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰åƒç´ æ¥ç›´æ¥åœ¨2Dç©ºé—´ä¸­ç”»å‡ºæ¯ä¸ªä½“ç´ ã€‚æˆ–è€…ç›¸åâ€”â€”ä½ å¯ä»¥é€‰æ‹©å±å¹•ä¸­çš„ä¸€ä¸ªåƒç´ ç„¶åæ‰¾å‡ºåœºæ™¯ä¸­å‡ºç°åœ¨é‚£ä¸ªä½ç½®çš„ä½“ç´ ã€‚ è¯¥é€†å‘æ–¹æ³•è¢«ç§°ä¸ºå…‰çº¿æŠ•å°„ã€‚ä½ å¯ä»¥ä»è§†ç‚¹å‘åœºæ™¯å†…æŠ•å°„ä¸€æŸå…‰çº¿ç„¶åæ‰¾å‡ºå‡»ä¸­çš„ä½“ç´ ã€‚äº‹å®ä¸Šï¼Œä½ å¯ä»¥å°„å‡ºå¤šä¸ªå°„çº¿æ¥æ‰«è¿‡å…¨éƒ¨çš„è§†ç•Œã€‚ ä½¿ç”¨é±¼çœ¼çŸ«æ­£çš„ç®€å•å…‰çº¿æŠ•å°„, Kieff, è§ Wikimedia Commons [public domain] è¿™ä¸ªæŠ€å·§è¢«é¦–æ¬¡ä½¿ç”¨åœ¨å¾·å†›å¸ä»¤éƒ¨ä¸­ï¼Œå…¶ä¸­å®ƒçš„ä½“ç´ å…¨éƒ¨æ˜¯æˆ¿é—´ä¸­çš„å°æ–¹å—ï¼Œæ‰€ä»¥è¿™åªæ˜¯å¦ä¸€ç§å°†ä½“ç´ ä½œä¸ºå°æ–¹å—è¿›è¡Œæ¸²æŸ“çš„æ–¹æ³•ã€‚ä¸è¿‡å®ƒçš„é€Ÿåº¦å¾ˆå¿«ï¼Œå› ä¸ºä½ åªéœ€å°†ä¸€æ•´åˆ—çš„åƒç´ æŠ•å°„åˆ°å±å¹•ä¸­ã€‚è¿™æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª2Dè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æœ‰æ—¶å°†è¿™ç±»3Då›¾åƒç§°ä¸º2.5Dï¼ˆæŸç§ç¨‹åº¦ä¸Šè®²ç¬¬ä¸‰ä¸ªç»´åº¦æ˜¯å‡çš„ï¼Œå› ä¸ºå®ƒæ˜¯æ²¿ç€çªå‡ºçš„2Då¹³é¢çš„ï¼‰ã€‚ å¾·å†›å¸ä»¤éƒ¨, id Software, 1992 ä¸è¿‡é€šå¸¸æˆ‘ä»¬ä¸è®¤ä¸ºWolfensteinä½¿ç”¨äº†ä½“ç´ ã€‚æˆ‘ä»¬å¿…é¡»è®©å•å…ƒè¶³å¤Ÿå°å¹¶è®©å®ƒä»¬æœ‰ä¸åŒçš„é«˜åº¦ã€‚äºæ˜¯åˆ°äº†90å¹´ä»£æˆ‘ä»¬æœ‰äº†ç»å…¸ä½“ç´ å›¾åƒå¼•æ“ã€‚ è¶…çº§ç§‘æ›¼å¥‡, NovaLogic, 1992 ä¸€å¼€å§‹ä½“ç´ åªè¢«ç”¨äºåœ°å½¢åˆ¶ä½œã€‚å®ƒä»¬å¿…é¡»ç®€åŒ–ç‰©ä½“ä½¿å¾—å…¨éƒ¨çš„ä½“ç§¯ä¿¡æ¯åªæœ‰å­˜å‚¨åœ¨2Då›¾åƒï¼ˆåˆè¢«ç§°ä¸ºé«˜åº¦è´´å›¾ï¼‰ä¸­çš„åœ°å½¢é«˜åº¦ã€‚ ä¸€ä¸ªé«˜åº¦è´´å›¾ï¼ˆå·¦ï¼‰å‘Šè¯‰æˆ‘ä»¬ä½“ç´ çš„å‚ç›´é«˜åº¦æœ‰å¤šå°‘ï¼ˆé»‘ä»£è¡¨ä½ï¼Œç™½ä»£è¡¨é«˜ï¼‰ å°†ä½“ç´ ä¿¡æ¯é™åˆ¶åœ¨é«˜åº¦è´´å›¾ä¸­æ„å‘³ç€ä¸èƒ½æœ‰ç±»ä¼¼äºçªå‡ºçš„æ‚¬å´–çš„ä¸œè¥¿ã€‚ä½†æ˜¯å·²ç»å¾ˆå¥½äº†ï¼Œåœ°å½¢å«æœ‰çš„çš„ç»†èŠ‚æ•°é‡æ˜¯æ‰€æœ‰ä¹‹å‰æ¸¸æˆä¸èƒ½ä¼åŠçš„ã€‚ ä¸‰è§’æ´²ç‰¹ç§éƒ¨é˜Ÿ, NovaLogic, 1998 æ—¶ç©ºè‹±è±ª, Appeal, 1999 ä½“ç´ çš„ç»“æŸå…‰çº¿æŠ•å½±ä¸æ˜¯90å¹´ä»£çš„æ¸¸æˆæ¸²æŸ“ä½“ç´ ä¿¡æ¯æ‰€ç”¨çš„å”¯ä¸€æ–¹æ³•ã€‚å…¶å®ƒçš„æ–¹æ³•å„æœ‰ä¼˜åŠ¿ï¼Œä¾‹å¦‚æ”¯æŒå¯ä»¥æ¯åçš„åœ°å½¢æˆ–è€…å¯ä»¥æ¸²æŸ“æ±½è½¦æˆ–è€…äººç‰©ã€‚è¿™äº›åœ¨å½“æ—¶éƒ½æ˜¯æœ€å…ˆè¿›çš„æ–¹æ³•äº†ï¼è®½åˆºçš„æ˜¯ï¼Œè¿™ç§å¯Œæœ‰åˆ›é€ çš„å¤šæ ·æ€§ä¹Ÿé¢„ç¤ºç€è¿™é¡¹æŠ€æœ¯è¿æ¥è¿Ÿæš®ã€‚ ä¸‡æ°èµ›è½¦, K-D Lab, 1998é—®é¢˜æ˜¯ï¼Œç›´åˆ°2000å¹´åº•å›¾å½¢åŠ é€Ÿå¡è¯ç”Ÿäº†ã€‚è¿™äº›ç¡¬ä»¶ä¸“é—¨å¤„ç†æŠ•å½±å’Œæ …æ ¼åŒ–3Då¤šè¾¹å½¢ï¼ˆç°åœ¨æˆ‘ä»¬ç®¡è¿™äº›èŠ¯ç‰‡å«åšå›¾åƒå¤„ç†å•å…ƒæˆ–GPUï¼‰ã€‚å®ƒä»¬æ¸²æŸ“ä¸‰è§’å½¢çš„é€Ÿåº¦é£å¿«ï¼Œä¸è¿‡è¿™ä¹Ÿæ˜¯å®ƒä»¬æ‰€èƒ½åšçš„å…¨éƒ¨å·¥ä½œäº†ã€‚è‡ªå®šä¹‰ä½“ç´ æ¸²æŸ“ç®—æ³•ï¼ŒåŒ…æ‹¬å…‰çº¿æŠ•å°„ï¼Œåœ¨å®ƒä»¬çš„èƒ½åŠ›ä¹‹å¤–ã€‚ Hexplore, Doki Denki Studio, 1998ä½“ç´ å¼•æ“ç»§ç»­åœ¨CPUï¼ˆä¸­å¤®å¤„ç†å•å…ƒï¼‰ä¸Šå®ç°ï¼Œä½†æ˜¯CPUå¦å¤–è¿˜è¦æ¥ç®¡å‰©ä½™çš„å·¥ä½œï¼ŒåŒ…æ‹¬ç‰©ç†æ¨¡æ‹Ÿï¼Œæ¸¸æˆæµç¨‹å’Œäººå·¥æ™ºèƒ½ã€‚åœ¨GPUä¸Šå¤„ç†å›¾åƒçš„ä¸»è¦åŸå› æ˜¯å°†æ¸²æŸ“æ”¾åœ¨ä¸€å¼ å•ç‹¬çš„èŠ¯ç‰‡ä¸Šå®Œæˆï¼Œæé«˜æ¸²æŸ“é€Ÿåº¦çš„åŒæ—¶è¿˜ç»™äºˆäº†CPUæ›´å¤šçš„ç©ºé—´åšæ›´å¤æ‚çš„æ¨¡æ‹Ÿã€‚ä½“ç´ å¼•æ“è·Ÿä¸ä¸Šå¤šè¾¹å½¢å›¾åƒçš„æ€§èƒ½æ‰€ä»¥æ­»ç¿˜ç¿˜äº†â€¦â€¦ â€¦â€¦ç›´åˆ°å¤§çº¦åå¹´åæœ‰ä¸€æ¬¾æ¸¸æˆå°†å®ƒä»¬å¸¦åˆ°äº†ä¸€ä¸ªæ–°çš„å—æ¬¢è¿ç¨‹åº¦ã€‚å®ƒæ‘’å¼ƒäº†æ—§çš„æ–¹æ³•ï¼Œä¸ºâ€œå°†ä½“ç´ ä½œä¸ºå°æ–¹å—â€æ–¹æ³•é“ºå¹³äº†é“è·¯ã€‚ç°åœ¨è¿™å¯ä»¥æœ‰æ•ˆåœ°ä½¿ç”¨GPUè¿›è¡Œæ¸²æŸ“è€Œå…¶å®ƒçš„çš†æˆä¸ºå†å²ã€‚ æˆ‘çš„ä¸–ç•Œ, Mojang, 2009â€“ä»Š å®šä¹‰æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬å­¦åˆ°çš„å†…å®¹ï¼Œç„¶åä½¿ç”¨ä¸€ç‚¹æ•°å­¦çŸ¥è¯†å›ç­”ä¸€å¼€å§‹çš„å…³äºä»€ä¹ˆæ˜¯åƒç´ å’Œä½“ç´ çš„é—®é¢˜ã€‚ ä¸€ä¸ªåƒç´ æ˜¯å°†2Dç©ºé—´åˆ†å‰²ä¸ºç¦»æ•£çš„ï¼Œå‡åŒ€çš„ï¼ˆå¤§å°ç›¸åŒçš„ï¼‰åŒºåŸŸæ—¶å¾—åˆ°çš„æœ€å°å•ä½ã€‚ æ¯ä¸ªåƒç´ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªä¸¤ä¸ªåˆ†é‡å‡ä¸ºæ•´æ•°çš„å‘é‡æ¥è¡¨ç¤ºã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆåƒç´ ç©ºé—´æ˜¯ç¦»æ•£çš„ï¼Œè€Œä¸æ˜¯åƒè¿ç»­çš„å‘é‡å›¾åƒé‚£æ ·æ¯ä¸ªåæ ‡éƒ½æ˜¯ä¸€ä¸ªå®æ•°ï¼ˆä½¿ç”¨æµ®ç‚¹æ•°è¡¨ç¤ºï¼‰ã€‚ ç›¸ä¼¼åœ°ï¼Œä¸€ä¸ªä½“ç´ æ˜¯å°†3Dç©ºé—´åˆ†å‰²ä¸ºç¦»æ•£çš„ï¼Œå‡åŒ€çš„åŒºåŸŸæ—¶å¾—åˆ°çš„æœ€å°å•ä½ã€‚è¿™ä¸‹ä½ æ˜ç™½äº†ã€‚ æˆ‘è¯´å®Œäº†å—ï¼Ÿè¿˜æ²¡æœ‰ï¼Œæˆ‘è¿˜æ²¡è¯´å®Œã€‚ è¢«å®šä¹‰å¾—å¦‚æ­¤å®½æ³›ï¼Œåƒç´ å’Œä½“ç´ å¯ä»¥ä»¥è®¸å¤šä¸åŒçš„æ–¹å¼å‡ºç°ï¼Œè€Œæˆ‘ä»¬å¯ä»¥åˆ›é€ æ€§åœ°å°†æ¦‚å¿µä»¥å„ç§å½¢å¼è¡¨è¾¾å‡ºæ¥ã€‚å°¤å…¶ï¼Œæˆ‘ä»¬è€ƒè™‘ç»¼åˆäº†4è±¡é™çš„æ …æ ¼/å‘é‡ï¼Œ2D/3Dã€‚ çº¯2Då›¾åƒ åœ¨æ—©äº›æ—¶å€™å¦‚æœä½ æƒ³å°†2D ç²¾çµï¼ˆspriteï¼‰ç”»åˆ°å±å¹•ä¸Šä½ å¿…é¡»å°†ä¸€å—å‚¨å­˜ç²¾çµé¢œè‰²çš„å†…å­˜ç›´æ¥å¤åˆ¶åˆ°å¦ä¸€å—å‚¨å­˜å±å¹•æ˜¾ç¤ºé¢œè‰²çš„å†…å­˜ä¸­ï¼ˆè¿™ä¸ªå¤åˆ¶è¿‡ç¨‹ä¹Ÿè¢«ç§°ä¸ºä½å—è½¬æ¢ï¼Œæˆ–è€…å«bit BLTï¼‰ã€‚å¦‚ä»Šå‡ ä¹æ²¡äººå•çº¯ä½¿ç”¨è¿™ç§æ–¹æ³•è¿›è¡Œ2Dæ¸²æŸ“äº†ã€‚å¹»æƒ³ä¸»æœºPICO-8ä½œä¸ºç°ä»£çš„èŒƒæœ¬å‘è¿‡å»é‚£ä¸ªä½å—è½¬ç§»ä½œä¸ºå”¯ä¸€æ–¹æ³•çš„æ—¶ä»£è‡´æ•¬ã€‚ PICO-8, Lexallofle Games (ä»¥åŠå„è‡ªç‰¹å¾å°è½¦çš„ä½œè€…), 2014â€“ä»Š 3Då›¾åƒä¸­çš„çº¹ç† å¦‚ä»Šå¤§å¤šå›¾åƒå¼•æ“åœ¨åŸºç¡€å±‚æ¬¡ä½¿ç”¨å‘é‡ï¼Œå› ä¸ºGPUå°±æ˜¯è¿™æ ·å·¥ä½œçš„ã€‚åœ¨è¿™ä¸ªç³»ç»Ÿä¸­ä½¿2Då›¾åƒå‡ºç°åœ¨å±å¹•ä¸Šçš„ä¸»è¦æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ç§å«åšçº¹ç†æ˜ å°„çš„æ–¹æ³•å°†å®ƒä»¬ç”»åœ¨å¤šè¾¹å½¢ä¸Šã€‚ çº¹ç†æ˜¯2Dæ …æ ¼å›¾ç‰‡ï¼Œå¯ä»¥è¢«æ”¾ç½®åœ¨ï¼ˆæˆ–è¢«æ˜ å°„åˆ°ï¼‰3Då¤šè¾¹å½¢ä¸Šã€‚ è¿™æ˜¯å¤§å¤šæ•°3Dè§†é¢‘æ¸¸æˆï¼ˆå¹¿æ³›ä¸Šè®²è¿˜æœ‰3Då›¾åƒï¼‰åœ¨åˆ¶ä½œä¸­æ‰€é‡‡ç”¨çš„æœ€ç®€å•çš„æ–¹æ³•ã€‚ ä¾‹å¦‚ï¼Œè¿™æ˜¯ä¸€ä¸ªé«˜å¤šè¾¹å½¢çš„3Dæ¨¡å‹ï¼Œæˆ‘ä»¬åŠ å…¥ä¸€å¼ é«˜åˆ†è¾¨ç‡çš„çº¹ç†ï¼š é•œä¹‹è¾¹ç¼˜ï¼šå‚¬åŒ–å‰‚ Keyart, Per Haagensen, 2016 ç”±äºæˆ‘ä»¬ä½¿ç”¨å¹³æ»‘çš„å¤šè¾¹å½¢ç€è‰²å’Œçº¹ç†æ˜ å°„æˆ‘ä»¬ç”šè‡³ä¸éœ€è¦é‚£ä¹ˆå¤šçš„ä¸‰è§’å½¢æ¥åˆ›é€ å‡ºäººç‰©å¥½çœ‹çš„å¤–è¡¨ã€‚è¿™æ˜¯ä¸€ä¸ªä½å¤šè¾¹å½¢3Dæ¨¡å‹å¤–åŠ ä¸€ä¸ªé«˜åˆ†è¾¨ç‡çš„çº¹ç†ã€‚ ä½å¤šè¾¹å½¢çš„å·¥åŒ , Mark Henriksen, 2015å½“æˆ‘ä»¬ä¹Ÿå°†é«˜åˆ†è¾¨ç‡çº¹ç†è½¬æ¢ä¸ºä½åˆ†è¾¨ç‡æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ç±»ä¼¼äºä¸‹é¢è¿™ä¸ªä½å¤šè¾¹å½¢3Dæ¨¡å‹å’Œä¸€ä¸ªåƒç´ è‰ºæœ¯çº¹ç†ï¼š æ¼‚ç§»é˜¶æ®µ, 2014â€“ä»Š (æ­£åœ¨åˆ¶ä½œä¸­)è¿™ä¸ªæƒ…å†µæœ€å‡ºè‰²çš„ä¾‹å­å½“ç„¶æ˜¯æˆ‘çš„ä¸–ç•Œäº†ã€‚å°½ç®¡æˆ‘çš„ä¸–ç•Œçš„å—æ ¹æ®å®šä¹‰æ˜¯ä½“ç´ ï¼ˆå®ƒä»¬æ˜¯æ¸¸æˆä¸­æœ€å°çš„ç¦»æ•£ä½“ç§¯å•ä½ï¼‰ï¼Œä½†æ˜¯å®ƒä»¬ä»¥å„ç§ä½å¤šè¾¹å½¢æ¨¡å‹å’Œåƒç´ è‰ºæœ¯çº¹ç†ä»£è¡¨çš„ç±»å‹å‡ºç°ã€‚å°½ç®¡å®ƒä»¬æ˜¯ä¸€ä¸ªä¸ªçš„å°å—ï¼Œå®ƒä»¬ä¸­çš„è®¸å¤šéƒ½ä¸æ˜¯ç®€å•çš„ç«‹æ–¹ä½“ã€‚ æˆ‘çš„ä¸–ç•Œ, Mojang, 2009â€“ä»Š è¿™æ ·æ‰€æœ‰çš„3Dæ¨¡å‹æƒ…å†µå°±éƒ½è®²å®Œäº†ï¼ˆé«˜å¤šè¾¹å½¢3Dæ¨¡å‹å’Œä½åˆ†è¾¨ç‡çº¹ç†çš„ç»„åˆå¹¶ä¸æ˜¯å¾ˆå¸¸è§ï¼Œä½†æ˜¯å¦‚æœé”™äº†è¯·çº æ­£æˆ‘ï¼‰ é•œä¹‹è¾¹ç¼˜(å·¦ä¸Š), é©¬å…‹æ€ä½©æ©(å·¦ä¸‹) å’Œæˆ‘çš„ä¸–ç•Œ (å³ä¸‹) 2Då›¾åƒä¸­çš„çº¹ç† å›åˆ°2Dï¼å½“æˆ‘ä»¬å°†çº¹ç†æŠ•å½±åº”ç”¨åˆ°2DçŸ©å½¢ä¸Šæ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ç°åœ¨å¸¸è§çš„2Dæ¸¸æˆã€‚ä½¿ç”¨å½“ä»Šçš„ç¡¬ä»¶ï¼Œæ¯å¼ 2Då›¾åƒï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹å¸¸è¢«ç§°ä¸ºç²¾çµï¼‰è¢«æ”¾åœ¨ä¸€ä¸ªç”±ä¸¤ä¸ªä¸‰è§’å½¢ç»„æˆçš„çŸ©å½¢ä¸­è¿›è¡Œæ˜¾ç¤ºã€‚ä¸¤ä¸ªä¸‰è§’å½¢ï¼ˆåŠ èµ·æ¥ä¹Ÿè¢«ç§°ä¸ºä¸€ä¸ªå››è¾¹å½¢ï¼‰é€šè¿‡æ˜ å°„åˆ°å®ƒä»¬ä¸Šé¢çš„ç²¾çµè¿›è¡Œæ¸²æŸ“ï¼Œä½¿å¾—å›¾åƒå‡ºç°åœ¨æ­£ç¡®çš„ä½ç½®ã€‚ äººç‰©å›¾åƒçš„ä¸€éƒ¨åˆ†(å·¦) è¢«çº¹ç†æ˜ å°„åˆ°åŠ¨ç”»å››è¾¹å½¢ä¸­(å³)ã€‚ç¾½æ¯›çƒ, Matej â€˜Retroâ€™ Jan, 2006 é«˜åˆ†è¾¨ç‡å›¾åƒå°±å¾ˆç›´æ¥äº†â€¦â€¦ æ—¶ç©ºå¹»å¢ƒ, Number None, 2008 åœ°ç‹±è¾¹å¢ƒ, Playdead, 2010â€¦â€¦ä½†æ˜¯ä½åˆ†è¾¨ç‡ï¼Œåƒç´ è‰ºæœ¯çº¹ç†å°±ç¨å¾®å¤æ‚ä¸€äº›äº†ã€‚å®ƒå®Œå…¨å–å†³äºæˆ‘ä»¬é‡‡ç”¨ä»€ä¹ˆæ˜¾ç¤ºåˆ†è¾¨ç‡æ¥æ¸²æŸ“ç²¾çµã€‚ æ—¶ç©ºå¹»å¢ƒ(å·¦ä¸Š), é€šå¾€å¤©ç©ºçš„è·¯(å³ä¸Š), ç‹å›½(å³ä¸‹) æˆ‘ä»¬å·²ç»è§è¯†åˆ°äº†å¯ä»¥å°†åƒç´ è‰ºæœ¯çº¹ç†åº”ç”¨åˆ°ä¸€ä¸ªä½å¤šè¾¹å½¢3Dæ¨¡å‹ä¸Šï¼Œä½†æ˜¯ä»ä½¿ç”¨é«˜åˆ†è¾¨ç‡è¿›è¡Œæ¸²æŸ“ã€‚è€ƒè™‘ä¸€ä¸‹æˆ‘çš„ä¸–ç•Œã€‚ä½å¤šè¾¹å½¢æ¨¡å‹ï¼Œä½åˆ†è¾¨ç‡16x16åƒç´ çº¹ç†ï¼Œæ”¾åœ¨ä¸€ä¸ªæ˜¾ç¤ºåˆ†è¾¨ç‡ä¸º1920x1080çš„åœºæ™¯ä¸­ã€‚ æˆ‘çš„ä¸–ç•Œ, Mojang, 2009â€“ä»Š åŒæ ·2Då¤šè¾¹å½¢ä¹Ÿå¯ä»¥è¿™æ ·åšã€‚æˆ‘ä»¬ä½¿ç”¨ä¸€å¼ åƒç´ è‰ºæœ¯å›¾ç‰‡ï¼Œå°†å®ƒæ”¾åœ¨ä¸€ä¸ª2Då››è¾¹å½¢ä¸Šï¼Œç„¶åå°†å®ƒæ¸²æŸ“åˆ°é«˜åˆ†è¾¨ç‡å±å¹•ä¸Šï¼Œè¿™æ ·ä¸€æ¥æºå›¾åƒä¸­çš„æ¯ä¸ªåƒç´ éƒ½åŒ…å«äº†æ˜¾ç¤ºä¸­çš„å¤šä¸ªåƒç´ ã€‚ è¿ˆé˜¿å¯†çƒ­çº¿, Dennaton Games, 2012 æˆ‘ä»¬å°†æ­¤é£æ ¼ç§°ä¸ºå¤§åƒç´ è‰ºæœ¯é£æ ¼ã€‚æ¯ä¸ªç²¾çµåƒç´ æŒ‰ç…§å¤§äºæ˜¾ç¤ºåƒç´ è¿›è¡Œæ¸²æŸ“ï¼Œä»¥ä¾¿å®ƒåœ¨å›¾åƒä¸­ä½œä¸ºä¸€ä¸ªå¤§æ–¹å—å‡ºç°ã€‚ æ¯ä¸ªæºç²¾çµåƒç´ è¢«æ¸²æŸ“ä¸º3x3æ˜¾ç¤ºåƒç´ ï¼Œ ç™»æœˆè€…, Ben Porter, 2011â€“ä»Š ï¼ˆæ­£åœ¨åˆ¶ä½œä¸­) å¤§åƒç´ é£æ ¼åœ¨ç²¾çµè¢«æ—‹è½¬æˆ–å€¾æ–œæ—¶å˜å¾—æ˜æ˜¾ï¼š é€šå¾€å¤©ç©ºçš„è·¯, Johannes â€˜Dekâ€™ MÃ¤rtterer, 2011â€“ä»Š (æ­£åœ¨åˆ¶ä½œä¸­) çœ‹çœ‹ä¸Šå›¾ä¸­çš„æ ‘å¶ï¼Œç„¶åå°†å®ƒå’Œä½åˆ†è¾¨ç‡æ¸²æŸ“ä¸‹çš„æ—‹è½¬ç²¾çµè¿›è¡Œå¯¹æ¯”ã€‚ ç‹å›½, Noio &amp; Licorice, 2015 ä½ çœ‹åˆ°æ°´è½®çš„åƒç´ æ˜¯å¦‚ä½•æ°´å¹³/å‚ç›´æ’åˆ—å¼€æ¥çš„ï¼Œè€Œåœ¨é€šå¾€å¤©ç©ºçš„è·¯ä¸­æ ‘å¶ï¼Œå°é¸Ÿï¼Œå’Œæ¡¥æ¢çš„å¤§åƒç´ éƒ½è¢«è°ƒæ•´äº†è§’åº¦å’Œåšäº†å˜æ¢å—ï¼Ÿ ç‹å›½åœ¨ä½åˆ†è¾¨ç‡ä¸‹æ¸²æŸ“æ•´ä¸ªæ¸¸æˆç„¶ååªå°†ç»“æœå›¾åƒæ”¾å¤§ï¼ˆè°ƒå¤§å°ºåº¦ï¼‰åˆ°æ˜¾ç¤ºåˆ†è¾¨ç‡ã€‚å¦ä¸€æ–¹é¢ï¼Œé€šå¾€å¤©ç©ºçš„è·¯ï¼Œè¿ˆé˜¿å¯†çƒ­çº¿å’Œç™»æœˆè€…ç›´æ¥å°†ç²¾çµæ¸²æŸ“åˆ°é«˜åˆ†è¾¨ç‡æ˜¾ç¤ºã€‚ å›åˆ°3Dç‹å›½æ˜¯ä¸€æ¬¾2Dæ¸¸æˆï¼Œä½†æ˜¯å®ƒæ‰€é‡‡ç”¨çš„æ–¹æ³•ä¹Ÿèƒ½æ”¾åˆ°3Dä¸­ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åƒç´ è‰ºæœ¯çº¹ç†çš„3Dæ¨¡å‹ï¼Œä½†æ˜¯åœ¨ä½åˆ†è¾¨ç‡ä¸­æ¸²æŸ“å®ƒä»¬ï¼Œæˆ‘ä»¬å¾—åˆ°å¦‚ä¸‹ï¼š åƒç´ è‰ºæœ¯å­¦é™¢æŠ€æœ¯æ¼”ç¤º, Matej â€˜Retroâ€™ Jan, 2016ä½ ä¼šå‘ç°æˆ‘ä»¬æ­£ç¡®åœ°å¾—åˆ°äº†å¸¦æœ‰æŠ•å°„é˜´å½±çš„3Dç€è‰²ã€‚å°½ç®¡ç»“æœçœ‹ä¸Šå»åƒ2Dåƒç´ è‰ºæœ¯ï¼Œä½†å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªä½¿ç”¨åƒç´ è‰ºæœ¯çº¹ç†åœ¨ä½åˆ†è¾¨ç‡ä¸‹è¿›è¡Œæ¸²æŸ“å¾—åˆ°çš„3Dåœºæ™¯ã€‚ åƒç´ è‰ºæœ¯å­¦é™¢æŠ€æœ¯æ¼”ç¤º (åœºæ™¯è§†è§‰), Matej â€˜Retroâ€™ Jan, 2016 åŸºäºå‘é‡ï¼ˆä½¿ç”¨éª¨éª¼ç»‘å®šï¼‰çš„åŠ¨ç”»ä¹Ÿå¯ä»¥åˆ©ç”¨è¿™ä¸ªä¼˜åŠ¿ã€‚è¿™æ˜¯å®ƒä»¬åœ¨å¤§åƒç´ é£æ ¼ä¸­çš„æ ·å­ï¼š åŠ¨ç”»ç»‘å®š, Matej â€˜Retroâ€™ Jan, 2016 ä½†æ˜¯å½“åœ¨ä½åˆ†è¾¨ç‡ä¸‹æ¸²æŸ“æ—¶ï¼Œå®ƒä»¬æ˜¾å¾—æ›´åƒåƒç´ è‰ºæœ¯ï¼Œæ’æˆä¸€åˆ—çš„åƒç´ å’Œä¸Šé¢çš„ç‹å›½ç›¸ä¼¼ã€‚ åƒç´ è‰ºæœ¯å­¦é™¢åŠ¨ç”»æµ‹è¯•, Matej â€˜Retroâ€™ Jan, 2016 è¿™å’Œæ‰‹ç»˜çš„ã€ä¸€å¸§ä¸€å¸§çš„åŠ¨ç”»ç›¸å·®ç”šè¿œï¼Œä½†æ˜¯å…·æœ‰ä¸€å®šçš„ç¾æ„Ÿï¼Œè®©äººæƒ³èµ·äº†90å¹´ä»£çš„rotoscopeï¼ˆåŠ¨æ€é®ç½©ï¼‰åŠ¨ç”»ã€‚ æ³¢æ–¯ç‹å­, Jordan Mechner, 1989 3Dæ•ˆæœå›åˆ°é«˜åˆ†è¾¨ç‡ï¼Œä¸€ä¸ªå……åˆ†åˆ©ç”¨3Dä¼˜åŠ¿çš„æ¸¸æˆæ˜¯Odd Talesçš„Last Night æœ€åä¸€å¤œä¸­çš„WIPåœºæ™¯, Tim Soret, 2016 è¿™æ ·ä»–ä»¬æ„å»ºäº†ä¸€ä¸ªå¯ä»¥ä»ä¸åŒè§’åº¦è§‚å¯Ÿçš„ä¸‰ç»´ä¸–ç•Œã€‚ æœ€åä¸€å¤œä¸­çš„3Dåœºæ™¯æ„å»º, Tim Soret, 2016 å¦ä¸€ä¸ªåŠ¨æ€3Då…‰ç…§çš„ä¾‹å­æ˜¯æ‹¥æœ‰ä¼˜ç§€åœºæ™¯ä½†æ˜¯å‘½è¿ä¸ä½³çš„æ¸¸æˆè‡´å‘½å¿«é€’ã€‚ è‡´å‘½å¿«é€’, Maksym Pashanin, 2013â€“2014 (æœªå‘å¸ƒ) è™½ç„¶ç¾æœ¯èµ„æºä»æ˜¯2Dçš„ï¼Œä½†æ˜¯å®ƒä»¬è¿˜åŒ…æ‹¬äº†ä»å¤šä¸ªæ–¹å‘çš„ç€è‰²çš„å›¾ç‰‡ã€‚è¿™äº›æ˜¯ä½¿ç”¨ç±»ä¼¼äºSprite Lampè¿™æ ·çš„å·¥å…·è¿›è¡Œå¤„ç†çš„ï¼Œå¹¶ä¸”ä»»ä½•ä½ç½®çš„å…‰æºéƒ½ä¼šäº§ç”Ÿç²¾çµçš„å¹³æ»‘ç…§æ˜ã€‚ æ¥è‡ªäºä½“ç´ çš„åƒç´ è‰ºæœ¯ä»¥ä¸Šæ–¹æ³•çš„é—®é¢˜åœ¨äºåªæœ‰ç²¾çµçš„ç€è‰²å¯ä»¥å‡†ç¡®å®Œæˆï¼Œè€Œå®ƒä»¬æŠ•å°„çš„é˜´å½±ç¼ºå°‘æ‰€éœ€çš„3Då‡ ä½•å› æ­¤ä¸èƒ½æ­£ç¡®ç”Ÿæˆã€‚ä¸ºæ­¤ä½ è¿˜æ˜¯éœ€è¦ä½“ç§¯ä¿¡æ¯ã€‚åˆåˆ°ä½“ç´ äº†ï¼ è¿™ç§æ–¹æ³•ä¸€ä¸ªå¾ˆæ£’çš„ä¾‹å­æ˜¯æœ€è¿‘å®£å¸ƒçš„Pathwayï¼š é“è·¯ï¼ˆPathwayï¼‰, Robotality, 2016 (æ­£åœ¨åˆ¶ä½œä¸­) å›¾åƒçœ‹ä¸Šå»å®Œå…¨åƒæ˜¯åœ¨ä½¿ç”¨åƒç´ è‰ºæœ¯ç²¾çµï¼Œä½†æ˜¯å…¶èƒŒåçš„ä¿¡æ¯å´æ˜¯ä½“ç§¯çš„ã€‚å’Œ90å¹´ä»£è¯•å›¾çœ‹ä¸Šå»æ›´ç°ä»£å’Œæ›´ç°å®çš„ä½“ç´ å¼•æ“ä¸åŒï¼ŒRobotalityçš„å¼€å‘è€…æœ€å¤šåªå°†ä½“ç´ å’Œæ˜¾ç¤ºåƒç´ çš„å¤§å°ç›¸åŒ¹é…ã€‚è¿™åˆ¶é€ äº†ä¸€ä¸ªå·§å¦™çš„ä¼ªè£…ï¼Œä½¿å®ƒçœ‹ä¸Šå»åƒåƒç´ è‰ºæœ¯ï¼Œä½†æ˜¯å®é™…ä¸Šå®ƒä»¬æ‹¥æœ‰æ‰€æœ‰çš„3Dä¿¡æ¯æ¥åˆ›é€ å‡ºå®Œå…¨æ­£ç¡®çš„åŠ¨æ€å…‰ç…§ã€‚ ä¸è¿‡ä½¿ç”¨ä½“ç´ å‡ ä½•äº§ç”Ÿåƒç´ è‰ºæœ¯å¹¶ä¸å®Œå…¨æ˜¯ä¸ªæ–°æ–¹æ³•ã€‚ä¹‹å‰FEZä½¿ç”¨äº†è¢«å…¶ç§°ä¹‹ä¸ºä¸‰åƒç´ ï¼ˆ3d åƒç´ ï¼‰çš„æ–¹æ³•ã€‚ä¸‰åƒç´ å°±æ˜¯è¢«ç»¼åˆä¸º16x16x16æ–¹æ ¼ï¼ˆ3dæ–¹æ ¼ï¼‰çš„ä½“ç´ ã€‚ FEZçš„æ¸¸æˆå¼€å‘æˆªå›¾, Polytron, 2007 å½“ä¸€ä¸ªFEZåœºæ™¯åœ¨æ¸¸æˆä¸­è¢«æ¸²æŸ“æ—¶æˆ‘ä»¬åŸºæœ¬ä¸Šçœ‹åˆ°çš„æ˜¯ä¸€ä¸ª2Dæ­£äº¤æŠ•å½±ï¼Œè¿™æ ·ä»–ä»¬æ—¢è¾¾åˆ°äº†ä¼ ç»Ÿåƒç´ è‰ºæœ¯çš„å¤–è§‚åˆåŠ å…¥äº†FEZæ ‡å¿—æ€§çš„è§†è§’æ—‹è½¬åŠŸèƒ½ã€‚ FEZ GDC â€™09å¹´å®£ä¼ ç‰‡, Polytron Corporation, 2009 FEZ, Polytron Corporation, 2012 çº¯ä½“ç´ æœ€ç»ˆï¼Œç”±äºæˆ‘ä»¬ç»•äº†ä¸€å¤§åœˆç»ˆäºå›åˆ°äº†ä½“ç´ å‡ ä½•ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å®Œå…¨ä¸ç®¡åƒç´ ï¼Œä»…åœ¨3Dç©ºé—´ä¸­æ¸²æŸ“çº¯ç¦»æ•£ä½“ç´ ï¼ˆä½¿ç”¨ä¸å¸¦ä»»ä½•çº¹ç†çš„ç«‹æ–¹ä½“æ–¹æ³•ï¼‰ã€‚ Lexallofleâ€™s Voxatron æ˜¯è¿™ä¸ªç©ºé—´å†…çš„æ¸¸æˆåå­—. Voxatron, Lexallofle Games, 2010â€“ä»Š(æ­£åœ¨åˆ¶ä½œä¸­) ä½ æ³¨æ„åˆ°Lexallofleè™šæ‹Ÿä¸»æœºä¸­çš„ä¸€ä¸ªä¸»é¢˜äº†å—ï¼ŸPico-8æœ‰ä¸€ä¸ªçº¯2Då›¾åƒå¼•æ“è€ŒVoxatronåˆ™æœ‰ä¸€ä¸ª3Dä½“ç´ çš„ã€‚å®ƒä»¬æ˜¯å®Œç¾çš„æ­æ¡£ã€‚ Voxatron, Lexallofle Games, 2010â€“ä»Š (æ­£åœ¨åˆ¶ä½œä¸­)Voxatronæ˜¯å°‘æ•°å‡ ä¸ªï¼ˆå¦‚æœä¸æ˜¯å”¯ä¸€çš„è¯ï¼‰çœŸæ­£ä½¿ç”¨3Dç©ºé—´çš„çº¯ç¦»æ•£åˆ†å‰²çš„æ¸¸æˆã€‚ä½†æ˜¯ä¸ä¹‹ç›¸ä¼¼çš„å¤§åƒç´ é£æ ¼å´åº”ç”¨äºè®¸å¤šæ¸¸æˆä¸­ï¼Œå°¤å…¶åœ¨ç§»åŠ¨è®¾å¤‡ä¸­ã€‚ å¤©å¤©è¿‡é©¬è·¯, Hipster Whale, 2014 Shooty Skies, Mighty Games, 2016 åƒè±†äºº256, Hipster Whale, 2015æˆ‘ä»¬ç»•äº†ä¸€æ•´åœˆå›åˆ°äº†Sir Carmaã€‚åœ¨æˆä¸ºæœ€è‘—åçš„ä½“ç´ è‰ºæœ¯å¸ˆåï¼Œä»–ç°åœ¨åœ¨ä½¿ç”¨Unityå°†ä»…å«ä½“ç´ çš„ç¾å­¦æ¨å‘æ›´é«˜çš„é«˜åº¦ï¼Œå¾—åˆ°å„ç§è§†è§‰æ•ˆæœï¼Œå’ŒOdd Taleså¯¹äºåƒç´ è‰ºæœ¯åšå‡ºçš„è´¡çŒ®ä¸€æ ·ã€‚ è¿”å›ä¹‹è·¯, Sir Carma, 2016 (æ­£åœ¨åˆ¶ä½œä¸­) è¿”å›ä¹‹è·¯, Sir Carma, 2016 (æ­£åœ¨åˆ¶ä½œä¸­)æœ‰äººçŸ¥é“Voxel Zelda/Atic Atacå—? è¿”å›ä¹‹è·¯, Sir Carma, 2016 (æ­£åœ¨åˆ¶ä½œä¸­)å¥½äº†ï¼Œæˆ‘ä»¬ä»‹ç»äº†2D/3D/æ …æ ¼/å‘é‡/ä½åˆ†è¾¨ç‡/é«˜åˆ†è¾¨æ‰€æœ‰æˆ‘èƒ½æƒ³åˆ°çš„ç»„åˆã€‚æˆ‘ç¡®å®šæˆ‘å¿˜è®°äº†ä¸€äº›å†…å®¹ï¼Œä½†æ˜¯æˆ‘æ›´ç¡®å®šæœªæ¥ä¼šæœ‰æ›´å¤šæœ‰è¶£çš„æ–¹æ³•ï¼Œä½†æ˜¯ç›®å‰è¿™æ ·å°±ä¸é”™äº†ã€‚ æˆ‘å¸Œæœ›ä½ ä»¬é˜…è¯»æ„‰å¿«â€”â€”ä¸ºæˆ‘ä»¬ä¸€è·¯åˆ°å°¾æ¬¢å‘¼ï¼æˆ‘å¸Œæœ›ä½ æ›´æ·±åˆ»åœ°äº†è§£äº†åƒç´ å’Œä½“ç´ å›¾åƒï¼Œä»¥åŠå¯¹å®ƒä»¬ä¸‹ä¸€æ­¥å¦‚ä½•å‘å±•æœ‰äº†ä¸€äº›åˆ›é€ æ€§çš„æƒ³æ³•ã€‚æƒ³è¦æ›´å¤šæœ‰å…³åƒç´ è‰ºæœ¯ç‰¹å¾çš„ä¿¡æ¯ä½ å¯ä»¥åœ¨Tumblrï¼ŒTwitterï¼Œå’ŒFacebookä¸Šå…³æ³¨Retronatorã€‚æ¯å¤©éƒ½æœ‰æ–°å‘ç°å“¦ï¼â€”Retro]]></content>
      <tags>
        <tag>æ¸²æŸ“</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¤§è§„æ¨¡åœºæ™¯çš„èµ„æºæ‹†åˆ†åˆåŠ¨æ€åŠ è½½]]></title>
    <url>%2F2017%2F10%2F04%2FassetSplit-dynamicLoad%2F</url>
    <content type="text"><![CDATA[æ¦‚è¦ èµ„æºæ‹†åˆ† åœ°å½¢ï¼Œåœ°è¡¨ åŠ¨æ€åŠ è½½/å¸è½½ æ‰“åŒ…ç­–ç•¥èµ„æºæ‹†åˆ† åœ°å½¢èµ„æºæ‹†åˆ† UnityåŸå§‹åœ°å½¢æœ‰ç½‘æ ¼å°ºå¯¸çš„é™åˆ¶ï¼ˆ4096ï¼‰ Meshåœ°å½¢æœ‰é¢ç‰‡æ•°é™åˆ¶ é™ä½å†…å­˜å ç”¨ï¼Œä»…éœ€è½½å…¥éƒ¨åˆ†åœ°å½¢æ•°æ® é™ä½æ¸²æŸ“é¢ç‰‡æ•°ï¼Œè§†åŸŸä½“å‰”é™¤ åˆ¶ä½œå¤§è§„æ¨¡åœ°å½¢ Terrain Composer 2 T4M å»ºæ¨¡è½¯ä»¶â€¦ æ‹†åˆ†ç°æœ‰åœ°å½¢ Terrain Slicing &amp; Dynamic Loading Kit åœ°å½¢æ•°æ® filed meaning basemapDistance Heightmap patches beyond basemap distance will use a preomputed low res basemap. castShadows Should terrain cast shadows? ollectDetailPatches Collect Detail patches from memory. detailObjectDensity Density of detail objects. detailObjectDistance Detail objets will be displayed up to this distance. heightmapMaxmumLOD Lets you essentially lower the heightmap resolution used for rendering. heightmapPixelError An approximation of how many pixels the terrain will pop in the worst case when switching lod. lightmapindex The index of the lightmap applied to this renderer. terrainData The Terrain Data that stres htightmaps,terrain textures,detail meshes and trees. treeBillboardDistance Distance from the camera where trees will be rendered as billboards only. terrCrossFadeLength Total distance delta that trees will use to transition from billboard orientation to to mesh orientation. treeDistance The maximum distance at which trees are rendered. treeMaximumFullLODCount Maximum number of trees rendered at full LOD. Lightmap æ‹†åˆ†åé‡æ–°çƒ˜åŸ¹ åˆ‡åˆ†çƒ˜åŸ¹å¥½çš„Lightmap exr æ ¼å¼ï¼ŒFreeImage åˆ‡å‰²è·¨åœ°å½¢çš„å¤§æ¨¡å‹ æŒ‰åœ°å½¢å—åˆ†ç»„åŠ¨æ€åŠ è½½ å…³é”®åœ¨äºï¼šæµç•… å¡é¡¿åˆ†æ Instantiate å‰è‡ªåŠ¨åŠ è½½æœªåŠ è½½çš„å¼•ç”¨èµ„æº Shader(Fallback) Texture Mesh AnimationClip é¢„åŠ è½½èµ„æº Shader(Fallback) Texture é¢„åŠ è½½èµ„æºå¼‚æ­¥åŠ è½½ Resources.LoadAsync AssetBundle.LoadAsync å®ä¾‹åŒ–å¼•èµ·çš„åºåˆ—åŒ–æ“ä½œ(Loading.LoadFileHeaders) é¿å…ä¸€æ¬¡æ€§å®ä¾‹åŒ–è¿‡å¤šçš„ç²’å­ç³»ç»Ÿï¼ˆé¢„åŠ è½½ï¼‰ é¿å…å±‚çº§å¤æ‚ï¼Œç»„ä»¶Awakeè¿‡å¤š å°è¯•æ‹†åˆ†Prefabï¼Œæµå¤±Instantiate åŠ è½½ç­–ç•¥(Assetbundle) SharedåŒ…å¸¸é©»å†…å­˜ å¤§çº¹ç†ç­‰èµ„æºé‡‡ç”¨LoadFromCacheOrDownload Material/Meshç­‰å¯é‡‡ç”¨new WWW å¸è½½ç­–ç•¥ï¼ˆAssetBundleï¼‰ Prefab åŒ… GameObjectå¯é€šè¿‡Destroyæ¥é”€æ¯ TerrainData,Objectç­‰å¯é€šè¿‡Resources.UnloadAssetæ¥è¿›è¡Œå¸è½½ SharedåŒ… å»ºè®®åœ¨ç¡®è®¤ä¸é€‚ç”¨æˆ–åˆ‡æ¢åœºæ™¯æ—¶è¿›è¡Œå¸è½½ åˆ‡æ¢åœºæ™¯æ—¶è°ƒç”¨UnloadUnusedAssetsæ¥å¸è½½Textureï¼ŒMeshç­‰åŠ è½½çš„å…±äº«èµ„æº æ³¨æ„äº‹é¡¹ åŠ è½½æ–¹å¼ ä¹å®«æ ¼ é€‚ç”¨äºéè‡ªç”±è§†è§’ å»ºç«‹ç¼“å†²æ± ï¼Œé˜²æ­¢åå¤å®ä¾‹åŒ–ã€‚ Load vs LoadAsync è¿›åœºæ™¯é¢„åŠ è½½ï¼Œæ¨èLoad æ¸¸æˆä¸­ï¼Œæ¨èLoadAsync LightmapåŠ¨æ€åŠ è½½ LightmapSettings lightmapindex/lightmapScaleOffset Shader Stripping TerrainåŠ¨æ€åŠ è½½ Lightmapld Terrain.SetNeighbors åŠ¨æ€ Static Batching (StaticBatchingUtility) è¿è¡Œæ—¶CPU/å †å†…å­˜å¼€é”€è¾ƒå¤§ ä¼˜å…ˆæ¨èæ‰‹åŠ¨æ‹¼åˆ æ¨èåˆ†ç»„æ‹¼åˆ é˜²æ­¢èµ„æºæ³„éœ² è¿è¡Œæ—¶åˆ›å»º new Material,Mesh Material set AssetBundleé‡å¤åŠ è½½ å…±äº«èµ„æº Texture,Mesh,Font Prefab éšå½¢èµ„æº TerrainData/AlphaMapæ‰“åŒ…ç­–ç•¥ åœ°å½¢èµ„æº 12345List&lt;Object&gt; groundObjs = new List&lt;Object&gt;();groundObjs.AddRange(Resources.LoadAll(BundleConfig.GroundObjectsPath, typeof(Texture2D)));groundObjs.AddRange(Resources.LoadAll(BundleConfig.GroundObjectsPath, typeof(GameObject)));BuildPipeline.PushAssetDependencies(); åœ°è¡¨èµ„æº å¤æ‚èµ„æºæ‹†åˆ† â€œæµå¤±â€å®ä¾‹åŒ– æŒ‰åœ°å½¢å—åˆ†ç»„æ‰“åŒ…]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity5.xåœºæ™¯ä¼˜åŒ–ä¹‹åŠ¨æ€è®¾ç½®å…‰ç…§è´´å›¾lightmap]]></title>
    <url>%2F2017%2F10%2F03%2Flightmap%2F</url>
    <content type="text"><![CDATA[åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸ºäº†æé«˜æ¸²æŸ“æ•ˆç‡ï¼Œä¸€èˆ¬éƒ½ä¼šè®©ç¾æœ¯åŒå­¦åœ¨åˆ¶ä½œåœºæ™¯æ—¶ï¼Œè®¾ç½®åœºæ™¯ç›¸å…³èŠ‚ç‚¹çš„lightmap staticå±æ€§ï¼Œæå‰ç»™æ•´ä¸ªåœºæ™¯çƒ˜åŸ¹å‡ºé™æ€çš„å…‰ç…§è´´å›¾lightmapï¼Œçƒ˜åŸ¹çš„æ•°æ®ä¿å­˜åœ¨åœºæ™¯ç›®å½•ä¸‹çš„LightmapSnapshotæ–‡ä»¶ä¸­ï¼Œä¸»è¦åŒ…æ‹¬çš„æ•°æ®æœ‰ï¼šlightmapsï¼šçƒ˜åŸ¹å‡ºçš„å…‰ç…§è´´å›¾æ•°ç»„ï¼›gameobject uidï¼šè¢«çƒ˜ç„™çš„gameobjectçš„å”¯ä¸€æ ‡è¯†ï¼›rendererçš„lightmapIndexï¼šè¢«çƒ˜åŸ¹çš„gameobjectçš„rendererç»„ä»¶æ‰€æŒ‡å‘çš„å…‰ç…§è´´å›¾ç”¨äºé‡‡æ ·çš„åŒºåŸŸåæ ‡å’Œå®½é«˜ã€‚è¿™ä¸ªæ–‡ä»¶ç›®å‰æ²¡æœ‰ç›¸å…³apiè¯»å†™ï¼Œå¦‚æœä½ æƒ³çƒ˜åŸ¹å®Œåœºæ™¯ä¹‹åï¼ŒæŠŠåœºæ™¯é‡Œé¢çš„gameobjectæŠ½å‡ºæ¥åšprefabï¼Œç­‰åˆ‡æ¢ç©åœºæ™¯ä¹‹åå†ç”¨äºåŠ¨æ€åŠ è½½æ˜¯ä¸å¯è¡Œçš„ï¼Œå› ä¸ºæŠ½å‡ºæ¥çš„prefabå’‹Instantiateä¹‹åå°†ä¼šæ˜¯ä¸€ä¸ªæ–°çš„gameobjectï¼Œuidè‡ªç„¶å’ŒLightmapSnapshotæ–‡ä»¶é‡Œé¢è®°å½•çš„ä¸ä¸€æ ·ï¼Œå¯¼è‡´æ‰¾ä¸åˆ°å¯¹åº”çš„å…‰ç…§æ•°æ®è€Œé€ æˆæ¨¡å¼æ²¡å…‰ç…§å˜æš—æˆ–æ¸²æŸ“é”™ä¹±ã€‚è¿˜æœ‰ä¸€ç§æ¯”è¾ƒå¸¸è§çš„éœ€æ±‚æ˜¯ï¼Œåœ¨æ¸¸æˆè¿è¡Œæ—¶ï¼Œé€šè¿‡æ›´æ¢å…‰ç…§è´´å›¾æ•°æ®ï¼Œè¥é€ åœºæ™¯åœ¨ä¸åŒæ—¶é—´æˆ–å­£èŠ‚çš„å…‰ç…§æ°›å›´ï¼Œä¾‹å¦‚ç™½å¤©å’Œé»‘å¤œã€‚]]></content>
  </entry>
  <entry>
    <title><![CDATA[AssetBundleç®¡ç†æœºåˆ¶]]></title>
    <url>%2F2017%2F10%2F02%2FABTheory%2F</url>
    <content type="text"><![CDATA[ä»€ä¹ˆæ˜¯AssetBundleAssetBundleå°±åƒä¸€ä¸ªZipå‹ç¼©æ–‡ä»¶ï¼Œé‡Œé¢å­˜æ”¾ç€ä¸€äº›æ•°æ®å¯¹è±¡ã€‚å®ƒåŒ…å«ä¸€äº›å¹³å°ç›¸å…³çš„è¿è¡Œæ—¶åºåˆ—åŒ–å¯¹è±¡ã€‚ Bundleä¹‹é—´ä¹Ÿå­˜åœ¨ç€ä¾èµ–ã€‚AssetBundleå¸¦æœ‰ä¸‰ç§å‹ç¼©é€‰é¡¹ï¼šä¸å‹ç¼©ï¼ŒLZMAï¼ŒLZ4ã€‚é»˜è®¤çš„å°±æ˜¯LZMAï¼Œè€ŒBuildAssetBundleOptions.ChunkBasedCompressionå°±æ˜¯LZ4çš„å‹ç¼©å½¢å¼ã€‚å¦å¤–æˆ‘ä»¬æœ‰ä¸¤ç§ç±»å‹çš„Bundleï¼Œä¸€ç§æ˜¯æˆ‘ä»¬åœºæ™¯çš„Bundleï¼ˆ*.unityæ‰“åŒ…çš„å¸¸åŠ¡ï¼‰ï¼Œå¦ä¸€ç§æ˜¯æ¾æ•£çš„Bundleã€‚ WebExtract &amp; Binary2TextAssetBundleå¯¹äºå¤§å®¶æ¥è¯´ä¼šæ˜¯ä¸€ä¸ªé»‘ç›’å­ï¼Œå…¶å®åœ¨Unityçš„å®‰è£…ç›®å½•ä¸‹ï¼ˆData/Toolsï¼‰æœ‰WebExtract &amp; Binary2Textè¿™ä¸¤ä¸ªå·¥å…·ï¼Œå¯ä»¥å¸®ä½ æŠŠAssetBundleè¿™ä¸ªé»‘ç›’å­æ‰“å¼€ã€‚ä¾‹å¦‚ï¼šå‡çº§ç‰ˆæœ¬AssetBundleå˜å¤§äº†ï¼ŒäºŒæ¬¡æ„å»ºAssetBundleå‡ºç°å·®å¼‚äº†ï¼ŒAssetBundleå†…åˆ°åº•åŒ…å«äº†é‚£äº›èµ„æºç­‰ã€‚ å¯¹äºæ„å»ºå‡ºæ¥çš„AssetBundleï¼Œæˆ‘ä»¬å…ˆé€šè¿‡WebExtractæ¥è§£å¼€ï¼Œè¿™æ—¶å€™å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢åŒ…å«ä¸€äº›æ–‡ä»¶ã€‚ Usage: WebExtractor &lt;unitywebfile&gt; AssetBundleåŠ è½½åŸºç¡€é€šè¿‡AssetBundleåŠ è½½èµ„æºï¼Œåˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥è·å–AssetBundleå¯¹è±¡ï¼Œç¬¬äºŒæ­¥æ˜¯é€šè¿‡è¯¥å¯¹è±¡åŠ è½½éœ€è¦çš„èµ„æºã€‚è€Œç¬¬ä¸€æ­¥åˆåˆ†ä¸ºä¸¤ç§æ–¹å¼ï¼Œä¸‹æ–‡ä¸­å°†ç»“åˆå¸¸ç”¨çš„APIè¿›è¡Œè¯¦ç»†çš„æè¿°ã€‚ è·å–AssetBundleå¯¹è±¡å¸¸ç”¨çš„APIç›´æ¥è·å–AssetBundle: public static AssetBundle CreateFromFile(string path);é€šè¿‡æœªå‹ç¼©çš„Bundleæ–‡ä»¶ï¼ŒåŒæ­¥åˆ›å»ºAssetBundleå¯¹è±¡ï¼Œè¿™æ˜¯æœ€å¿«çš„åˆ›å»ºæ–¹å¼ã€‚åˆ›å»ºå®Œæˆååªä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºè¾ƒå°çš„SerializedFileï¼Œè€Œåç»­çš„AssetBundle.Loadéœ€è¦é€šè¿‡IOä»ç£ç›˜ä¸­è¿‡å»ã€‚ public static AssetBundleCreateRequest CreateFromMemory(byte[] binary);é€šè¿‡Bundleçš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå¼‚æ­¥åˆ›å»ºAssetBundleå¯¹è±¡ã€‚å®Œæˆåä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºè¾ƒå¤§çš„WebStreamã€‚è°ƒç”¨æ—¶ï¼ŒBundleçš„è§£å‹æ—¶å¼‚æ­¥è¿›è¡Œçš„ï¼Œå› æ­¤å¯¹äºæœªå‹ç¼©çš„Bundleæ–‡ä»¶ï¼Œè¯¥æ¥å£ä¸CreateFromMemoryImmediateç­‰ä»·ã€‚ public static AssetBundle CreateFromMemoryImmediate(byte[] binary);è¯¥æ¥å£æ˜¯CreateFromMemoryçš„åŒæ­¥ç‰ˆæœ¬ã€‚ æ³¨ï¼š5.3ä¸‹åˆ†åˆ«æ”¹åä¸ºLoadFromFile,LoadFromMemory,LoadFromMemoryAsyncå¹¶å¢åŠ äº†LoadFromFileAsyncï¼Œä¸”æœºåˆ¶ä¹Ÿæœ‰ä¸€å®šçš„å˜åŒ–ï¼Œå¯è¯¦è§Unityå®˜æ–¹æ–‡æ¡£ã€‚ ä»AssetBundleåŠ è½½èµ„æºçš„å¸¸ç”¨API public ObjectLoad(string name, Type type);é€šè¿‡ç»™å®šçš„åå­—å’Œèµ„æºç±»å‹ï¼ŒåŠ è½½èµ„æºã€‚åŠ è½½æ—¶ä¼šè‡ªåŠ¨åœ¨å®¶å…¶ä¾èµ–çš„èµ„æºï¼Œå³Loadä¸€ä¸ªPrefabæ—¶ï¼Œä¼šè‡ªåŠ¨Loadå…¶å¼•ç”¨çš„Textureèµ„æºã€‚ public Object[] LoadAll(Type type);ä¸€æ¬¡æ€§åŠ è½½Bundleä¸­ç»™å®šèµ„æºç±»å‹çš„æ‰€æœ‰èµ„æºã€‚ public AssetBundleRequest LoadAsync(string name, Type type);è¯¥æ¥å£æ˜¯Loadçš„å¼‚æ­¥ç‰ˆæœ¬ã€‚ æ³¨ï¼š5.xä¸‹åˆ†åˆ«æ”¹åä¸ºLoadAsset,LoadAllAssets,LoadAssetAsyncï¼Œå¹¶å¢åŠ äº†LoadAllAssetsAsyncã€‚ AssetBundleåŠ è½½è¿›é˜¶æ³¨æ„ç‚¹ CreateFromFileåªèƒ½é€‚ç”¨äºæœªå‹ç¼©çš„AssetBundle,è€ŒAndroidç³»ç»Ÿä¸‹StreamingAssetsæ˜¯åœ¨å‹ç¼©ç›®å½•(.jar)ä¸­ï¼Œå› æ­¤éœ€è¦å…ˆå°†æœªå‹ç¼©çš„AssetBundleæ”¾åˆ°SDå¡ä¸­å›½æ‰èƒ½å¯¹å…¶ä½¿ç”¨CreateFromFileã€‚ iOSç³»ç»Ÿæœ‰256ä¸ªå¼€å¯æ–‡ä»¶çš„ä¸Šé™ï¼Œå› æ­¤ï¼Œå†…å­˜ä¸­é€šè¿‡CreateFromFileåŠ è½½çš„AssetBundleå¯¹è±¡ä¹Ÿä¼šä½äºè¯¥å€¼ã€‚ CreateFromFileçš„è°ƒç”¨ä¼šå¢åŠ ResistenManager.Remapperçš„å¤§å°ï¼Œè€ŒPersistentManagerè´Ÿè´£ç»´æŠ¤èµ„æºçš„æŒä¹…åŒ–å­˜å‚¨ï¼ŒRemapperä¿å­˜çš„æ˜¯åŠ è½½åˆ°å†…å­˜çš„èµ„æºHeapIDä¸æºæ•°æ®FileIDçš„æ˜ å°„å…³ç³»ï¼Œå®ƒæ˜¯ä¸€ä¸ªMemoryPool,å…¶è¡Œä¸ºç±»ä¼¼Monoå †å†…å­˜ï¼Œåªå¢ä¸å‡ï¼Œå› æ­¤éœ€è¦å¯¹ä¸¤ä¸ªæ¥å£çš„ä½¿ç”¨åšåˆç†çš„è§„åˆ’ã€‚ å¯¹äºå­˜åœ¨ä¾èµ–å…³ç³»çš„BundleåŒ…ï¼Œåœ¨åŠ è½½æ—¶ä¸»è¦æ³¨æ„é¡ºåºï¼Œä¸¾ä¾‹æ¥è¯´ï¼Œå‡è®¾CanvasAåœ¨BundleAä¸­ï¼Œæ‰€ä¾èµ–çš„AtlasBåœ¨BundleBä¸­ï¼Œä¸ºäº†ç¡®ä¿èµ„æºæ­£ç¡®å¼•ç”¨ï¼Œé‚£ä¹ˆæœ€æ™šåˆ›å»ºBundleBçš„AssetBundleå¯¹è±¡çš„æ—¶é—´ç‚¹æ˜¯åœ¨å®ä¾‹åŒ–CanvasAä¹‹å‰ï¼Œå³ï¼Œåˆ›å»ºBundleAçš„AssetBundleå¯¹è±¡æ—¶ï¼ŒLoad(â€œCanvasAâ€)æ—¶ï¼ŒBundleBçš„AssetBundleå¯¹è±¡éƒ½å¯ä»¥ä¸åœ¨å†…å­˜ä¸­ã€‚ æ ¹æ®ç»éªŒï¼Œå»ºè®®AssetBundleæ–‡ä»¶çš„å¤§å°ä¸è¶…è¿‡1MBï¼Œå› ä¸ºåœ¨æ™®éæƒ…å†µä¸‹Bundleçš„åŠ è½½æ—¶é—´ä¸å…¶å¤§å°å¹¶éå‘ˆçº¿æ€§å…³ç³»ï¼Œè¿‡å¤§çš„Bundleå¯èƒ½å¼•èµ·è¾ƒå¤§çš„åŠ è½½å¼€é”€ã€‚ ç”±äºWWWå¯¹è±¡çš„åŠ è½½æ˜¯å¼‚æ­¥çš„ï¼Œå› æ­¤é€ä¸ªåŠ è½½å®¹æ˜“å‡ºç°ä¸‹å›¾ä¸­CPUç©ºé—´çš„æƒ…å†µï¼ˆé€‰ä¸­å¸§å¤„Vsyncå äº†å¤§éƒ¨åˆ†ï¼‰æ­¤æ—¶å»ºè®®é€‚å½“çš„åŒæ—¶åŠ è½½å¤šä¸ªå¯¹è±¡ï¼Œä»¥å¢åŠ CPUçš„ä½¿ç”¨ç‡ï¼ŒåŒæ—¶åŠ å¿«åŠ è½½çš„å®Œæˆã€‚ AssetBundleå¸è½½å‰æ–‡æåˆ°äº†é€šè¿‡AssetBundleåŠ è½½èµ„æºæ—¶çš„å†…å­˜åˆ†é…æƒ…å†µï¼Œä¸‹é¢ï¼Œæˆ‘ä»¬ç»“åˆå¸¸ç”¨çš„APIä»‹ç»å¦‚ä½•å°†å·²åˆ†é…çš„å†…å­˜è¿›è¡Œå¸è½½ï¼Œæœ€ç»ˆè¾¾åˆ°æ¸…ç©ºæ‰€æœ‰ç›¸å…³å†…å­˜çš„ç›®çš„ã€‚ ä¸€Â·å†…å­˜åˆ†æ åœ¨ä¸Šå›¾ä¸­çš„å³ä¾§ï¼Œæˆ‘ä»¬åˆ—å‡ºäº†å„ç§å†…å­˜ç‰©ä»¶çš„å¸è½½æ–¹å¼ï¼š åœºæ™¯ç‰©ä»¶(GameObject):è¿™ç±»ç‰©ä»¶å¯é€šè¿‡Destroyå‡½æ•°è¿›è¡Œå¸è½½ï¼› èµ„æº(åŒ…æ‹¬Prefab):é™¤äº†Prefabä»¥å¤–ï¼Œèµ„æºæ–‡ä»¶å¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼æ¥å¸è½½1ï¼‰é€šè¿‡Resources.UnloadAssetå¸è½½æŒ‡å®šçš„èµ„æºï¼ŒCPUå¼€é”€å°ï¼›2ï¼‰é€šè¿‡Resources.UnloadUnusedAssetsä¸€æ¬¡æ€§å¸è½½æ‰€æœ‰æœªè¢«å¼•ç”¨çš„èµ„æºï¼ŒCPUå¼€é”€å¤§ï¼›3ï¼‰é€šè¿‡Resources.Unload(true)åœ¨å¸è½½AssetBundleå¯¹è±¡æ—¶ï¼Œå°†åŠ è½½å‡ºæ¥çš„èµ„æºä¸€èµ·å¸è½½ã€‚è€Œå¯¹äºPrefab,ç›®å‰ä»…èƒ½é€šè¿‡DestroyImmediateæ¥å¸è½½ï¼Œä¸”å¸è½½åï¼Œå¿…é¡»é‡æ–°åŠ è½½AssetBundleæ‰èƒ½é‡æ–°åŠ è½½è¯¥Prefabã€‚ç”±äºå†…å­˜å¼€é”€è¾ƒå°ï¼Œé€šå¸¸ä¸å»ºè®®è¿›è¡Œé’ˆå¯¹æ€§çš„å¸è½½ã€‚ WWWå¯¹è±¡ï¼šè°ƒç”¨å¯¹è±¡çš„Disposeå‡½æ•°æˆ–å°†å…¶ç½®ä¸ºnullå³å¯ï¼› WebStream:åœ¨å¸è½½WWWå¯¹è±¡ä»¥åŠå¯¹åº”çš„AssetBundleå¯¹è±¡åï¼Œè¿™éƒ¨åˆ†å†…å­˜å³ä¼šè¢«å¼•æ“è‡ªåŠ¨å¸è½½ï¼› SerializedFile:å¸è½½AssetBundleåï¼Œè¿™éƒ¨åˆ†å†…å­˜ä¼šè¢«å¼•æ“è‡ªåŠ¨å¸è½½; AssetBundleå¯¹è±¡ï¼šAssetBundleçš„å¸è½½æ–¹å¼æœ‰ä¸¤ç§ï¼š1ï¼‰é€šè¿‡AssetBundle.Unload(false),å¸è½½AssetBundleå¯¹è±¡æ—¶ä¿ç•™å†…å­˜ä¸­å·²åŠ è½½çš„èµ„æºï¼›2)é€šè¿‡AssetBundle.Unload(true),å¸è½½AssetBundleå¯¹è±¡æ—¶å¸è½½å†…å­˜ä¸­å·²åŠ è½½çš„èµ„æºï¼Œç”±äºè¯¥æ–¹æ³•å®¹æ˜“å¼•èµ·èµ„æºå¼•ç”¨ä¸¢å¤±ï¼Œå› æ­¤å¹¶ä¸å»ºè®®ç»å¸¸ä½¿ç”¨ï¼›äºŒÂ·æ³¨æ„ç‚¹åœ¨é€šè¿‡AssetBundle.Unload(false)å¸è½½AssetBundleå¯¹è±¡åï¼Œå¦‚æœé‡æ–°åˆ›å»ºè¯¥å¯¹è±¡å¹¶åŠ è½½ä¹‹å‰åŠ è½½è¿‡çš„èµ„æºçš„æ—¶å€™ï¼Œä¼šå‡ºç°å†—ä½™ï¼Œå³ä¸¤ä»½ç›¸åŒçš„èµ„æºã€‚ è¢«è„šæœ¬é™æ€å˜é‡å¼•ç”¨çš„èµ„æºï¼Œåœ¨è°ƒç”¨Resources.UnloadUnusedAssetsæ—¶ï¼Œå¹¶ä¸ä¼šè¢«å¸è½½ï¼Œåœ¨Profilerä¸­èƒ½å¤Ÿçœ‹åˆ°å…¶å¼•ç”¨æƒ…å†µã€‚ æ¨èæ–¹æ¡ˆé€šè¿‡ä»¥ä¸Šçš„è®²è§£ï¼Œç›¸ä¿¡æ‚¨å¯¹AssetBundleçš„åŠ è½½å’Œå¸è½½æœ‰äº†æ˜ç¡®çš„äº†è§£ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬ç®€å•åœ°åšä¸€ä¸‹APIé€‰æ‹©ä¸Šçš„æ¨èï¼š å¯¹äºåŠ è½½å®Œåå³å¸è½½çš„Bundleæ–‡ä»¶ï¼Œåˆ™åˆ†ä¸¤ç§æƒ…å†µï¼šä¼˜å…ˆè€ƒè™‘é€Ÿåº¦ï¼ˆåŠ è½½åœºæ™¯æ—¶ï¼‰å’Œä¼˜å…ˆè€ƒè™‘æµç•…åº¦ï¼ˆæ¸¸æˆè¿›è¡Œæ—¶ï¼‰ã€‚1ï¼‰åŠ è½½åœºæ™¯çš„æƒ…å†µä¸‹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯é¿å…WWWå¯¹è±¡çš„é€ä¸ªåŠ è½½å¯¼è‡´çš„CPUç©ºé—´ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨åŠ è½½é€Ÿåº¦è¾ƒå¿«çš„WWW.LoadFromCacheOrDownloadæˆ–AssetBundle.CreateFromFileï¼Œä½†éœ€è¦é¿å…åç»­å¤§é‡åœ°è¿›è¡ŒLoadèµ„æºçš„æ“ä½œï¼Œå¼•èµ·IOå¼€é”€ï¼ˆå¯ä»¥å°è¯•ç›´æ¥LoadAllï¼‰ã€‚2ï¼‰æ¸¸æˆè¿›è¡Œçš„æƒ…å†µä¸‹ï¼Œåˆ™éœ€è¦é¿å…ä½¿ç”¨åŒæ­¥æ“ä½œå¼•èµ·å¡é¡¿ï¼Œå› æ­¤å¯ä»¥è€ƒè™‘ä½¿ç”¨new WWWé…åˆAssetBundle.LoadAsyncæ¥è¿›è¡Œå¹³æ»‘çš„èµ„æºåŠ è½½ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºShaderï¼Œè¾ƒå¤§çš„Textureç­‰èµ„æºï¼Œå…¶åˆå§‹åŒ–æ“ä½œé€šå¸¸å¾ˆè€—æ—¶ï¼Œå®¹æ˜“å¼•èµ·å¡é¡¿ï¼Œå› æ­¤å»ºè®®å°†è¿™ç±»èµ„æºåœ¨åŠ è½½åœºæ™¯æ—¶è¿›è¡Œé¢„åŠ è½½ã€‚ åªåœ¨Bundleéœ€è¦åŠ å¯†çš„æƒ…å†µä¸‹ï¼Œè€ƒè™‘ä½¿ç”¨CreateFromMemoryï¼Œå› ä¸ºè¯¥æ¥å£åŠ è½½é€Ÿåº¦è¾ƒæ…¢ã€‚ å°½é‡é¿å…åœ¨æ¸¸æˆè¿›è¡Œä¸­è°ƒç”¨Resources.UnloadUnusedAssets(),å› ä¸ºè¯¥æ¥å£å¼€é”€è¾ƒå¤§ï¼Œå®¹æ˜“å¼•èµ·å¡é¡¿ï¼Œå¯å°è¯•ä½¿ç”¨Resources.Unload(obj)æ¥é€ä¸ªè¿›è¡Œå¸è½½ï¼Œä»¥ä¿è¯æ¸¸æˆçš„æµç•…åº¦ã€‚ éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œä»¥ä¸Šå†…å­˜ç®¡ç†äº¤é€‚åˆäºUnity5.3ä¹‹å‰çš„ç‰ˆæœ¬ã€‚Unityå¼•æ“åœ¨5.3ä¸­å¯¹AssetBundleçš„å†…å­˜å ç”¨è¿›è¡Œäº†ä¸€å®šçš„è°ƒæ•´ï¼Œç›®å‰æˆ‘ä»¬ä¹Ÿåœ¨è¿›ä¸€æ­¥çš„å­¦ä¹ å’Œç ”ç©¶ä¸­ã€‚ åŸæ–‡é“¾æ¥ï¼šhttps://blog.uwa4d.com/archives/ABTheory.html]]></content>
      <categories>
        <category>Unity</category>
      </categories>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AI]]></title>
    <url>%2F2017%2F09%2F29%2FAI%2F</url>
    <content type="text"><![CDATA[MLï¼ˆæœºå™¨å­¦ä¹ ï¼‰ä¸AI(äººå·¥æ™ºèƒ½ï¼‰é¦–å…ˆæ¥ä»‹ç»ä¸‹Machine Learning(æœºå™¨å­¦ä¹ ï¼Œä¸‹æ–‡ç®€ç§°MLï¼‰å’Œæ¸¸æˆArtificial Intelligence(äººå·¥æ™ºèƒ½ï¼Œä¸‹æ–‡ç®€ç§°AIï¼‰é—´çš„å…³ç³»ã€‚ç°å­˜çš„å¤§éƒ¨åˆ†æ¸¸æˆAIéƒ½æ˜¯æ‰‹å·¥æºç ï¼Œç”±å¤§é‡å†³ç­–æ ‘ç»„æˆï¼Œæœ‰æ—¶ä¼šåŒ…å«å¤šè¾¾æ•°åƒæ¡è§„åˆ™ã€‚è€Œä¸”å¿…é¡»ç”±æ‰‹å·¥ç»´æŠ¤å’Œæµ‹è¯•ã€‚è€ŒMLæ‰€ä¾èµ–çš„ç®—æ³•å¯ä»¥è‡ªåŠ¨ä»åŸå§‹æ•°æ®å¯»æ‰¾è§„å¾‹ï¼Œæ— éœ€ä¸“å®¶é¢„å…ˆå®šä¹‰æ•°æ®çš„è§£è¯»æ–¹å¼ã€‚ ä»¥å›¾ç‰‡å†…å®¹åˆ†ç±»è¿™ä¸ªè®¡ç®—æœºè§†è§‰é—®é¢˜ä¸ºä¾‹ã€‚ç›´åˆ°å‡ å¹´å‰ï¼Œä¸“å®¶ä»¬ä»ç„¶é€šè¿‡æ‰‹å·¥ç¼–å†™è¿‡æ»¤å™¨ï¼Œæå–å›¾åƒçš„æœ‰ç”¨ç‰¹å¾ï¼Œç”¨äºåˆ†è¾¨æŸä¸ªå›¾åƒä¸­åŒ…å«çš„æ˜¯çŒ«è¿˜æ˜¯ç‹—ã€‚è€ŒMLï¼Œç‰¹åˆ«æ˜¯iæœ€æ–°çš„æ·±åº¦å­¦ä¹ æ–¹æ³•ï¼Œä»…éœ€å›¾åƒå’Œç±»å‹æ ‡ç­¾ï¼Œå°±å¯ä»¥è‡ªåŠ¨å­¦ä¹ æœ‰ç”¨çš„ç‰¹å¾ã€‚æˆ‘ä»¬ç›¸ä¿¡è¿™ç§è‡ªåŠ¨åŒ–å­¦ä¹ ä¸ä»…å¯ä»¥æ‰©å±•Unityå¹³å°çš„åº”ç”¨èŒƒå›´ï¼Œä¾‹å¦‚ç”¨äºMLåœºæ™¯æ¨¡æ‹Ÿï¼Œè¿˜å¯ä»¥å¸®åŠ©æ‰€æœ‰å¼€å‘è€…ç®€åŒ–å’ŒåŠ é€Ÿæ¸¸æˆçš„å¼€å‘è¿‡ç¨‹ã€‚ è¿™ç§è‡ªåŠ¨åŒ–å­¦ä¹ å°¤å…¶å¯ä»¥åº”ç”¨äºæ¸¸æˆä»£ç†ï¼ˆå³NPCï¼‰çš„è¡Œä¸ºæ–¹é¢ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Reinforcement Learning(å¢å¼ºå­¦ä¹ ï¼Œç®€ç§°RLï¼‰æ¥è®­ç»ƒä»£ç†ï¼Œé¢„ä¼°æŸä¸€ç¯å¢ƒä¸­æ–½è¡Œç‰¹å®šè¡Œä¸ºçš„ä»·å€¼ã€‚ä¸€æ—¦è®­ç»ƒå®Œæˆï¼Œä»£ç†å³å¯ä»¥æœ€ä½³è¡Œä¸ºæ¨¡å¼åšå‡ºååº”ï¼Œæ— éœ€é€šè¿‡ç¨‹åºå¯¹è¡Œä¸ºè¿›è¡Œæ˜¾ç¤ºçš„ç¼–ç ã€‚ é‡‡ç”¨è€è™æœºç®—æ³•çš„å¢å¼ºå­¦ä¹ RLèƒŒåçš„ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µæ˜¯ä»·å€¼ä¼°è®¡ï¼Œå¹¶æ®æ­¤è¿›è¡Œç›¸åº”åŠ¨ä½œã€‚åœ¨ç»§ç»­æ·±å…¥ä¹‹å‰ï¼Œæœ€å¥½å…ˆäº†è§£ä¸€äº›æœ¯è¯­ã€‚ åœ¨RLä¸­ï¼Œå®æ–½åŠ¨ä½œçš„ä¸ªä½“è¢«ç§°ä¸ºagent(ä»£ç†),å®ƒä½¿ç”¨policy(ç­–ç•¥)è¿›è¡ŒåŠ¨ä½œå†³ç­–ã€‚ä¸€ä¸ªä»£ç†é€šå¸¸åµŒå…¥ä¸€ä¸ªenvironmentä¸­ï¼Œå¹¶åœ¨ä»»æ„ç»™å®šçš„æ—¶åˆ»éƒ½å¤„äºæŸä¸ªç‰¹å®šçš„state(çŠ¶æ€).ä»å“ªä¸ªçŠ¶æ€ï¼Œå®ƒå¯ä»¥è¿›è¡Œä¸€ç³»åˆ—actions(åŠ¨ä½œï¼‰ã€‚æŸä¸ªç»™å®šçŠ¶æ€çš„value(å€¼)æŒ‡çš„æ˜¯å¤„äºè¯¥çŠ¶æ€çš„æœ€ç»ˆå›æŠ¥ä»·å€¼ã€‚åœ¨æŸä¸ªçŠ¶æ€çš„value(å€¼)æŒ‡çš„æ˜¯å¤„äºè¯¥çŠ¶æ€çš„æœ€ç»ˆå›æŠ¥å€¼ã€‚åœ¨æŸä¸ªçŠ¶æ€æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œå¯ä»¥è®©ä»£ç†è¿›å…¥å¦ä¸€ä¸ªæ–°çš„çŠ¶æ€ï¼Œè·å¾—ä¸€ä¸ªreward(å›æŠ¥),æˆ–è€…åŒäº‹æ‹¥æœ‰ä¸¤è€…ã€‚æ‰€æœ‰çš„RLä»£ç†éƒ½åœ¨å°½å¯èƒ½æœ€å¤§åŒ–ç´¯è®¡å›æŠ¥ã€‚]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Real Time Rendering 3rd]]></title>
    <url>%2F2017%2F09%2F29%2FReal-Time-Rendering-3rd%2F</url>
    <content type="text"><![CDATA[Overviewurl: www.realtimerendering.com The Graphics Rendering Pipeline æ ¸å¿ƒå†…å®¹åˆ†èŠ‚æç‚¼å›¾åƒæ¸²æŸ“ç®¡çº¿æ¶æ„æ¦‚è¿° Architectureæ¸²æŸ“ç®¡çº¿çš„ä¸»è¦åŠŸèƒ½å°±æ˜¯å†³å®šåœ¨ç»™è™šæ‹Ÿç›¸æœºï¼Œä¸‰ç»´ç‰©ä½“ï¼Œå…‰æºï¼Œç…§æ˜æ¨¡å¼ï¼Œä»¥åŠçº¹ç†ç­‰è¯¸å¤šæ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œç”Ÿæˆæˆ–ç»˜åˆ¶ä¸€å¹…äºŒç»´å›¾åƒçš„è¿‡ç¨‹ã€‚å¯¹äºå®æ—¶æ¸²æŸ“æ¥è¯´ï¼Œæ¸²æŸ“ç®¡çº¿å°±æ˜¯åŸºç¡€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ï¼Œæ¸²æŸ“ç®¡çº¿æ˜¯å®æ—¶æ¸²æŸ“çš„åº•å±‚å·¥å…·ã€‚ ä¸Šå›¾ï¼Œç›¸æœºæ”¾åœ¨æ£±é”¥çš„é¡¶ç«¯ï¼ˆå››æ¡çº¿æ®µçš„äº¤æ±‡ç‚¹ï¼‰ï¼Œåªæœ‰å¯è§†ä½“å†…éƒ¨çš„å›¾å…ƒä¼šè¢«æ¸²æŸ“ã€‚åœ¨æ¦‚å¿µä¸Šå¯ä»¥å°†å›¾å½¢æ¸²æŸ“ç®¡çº¿åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š åº”ç”¨ç¨‹åºé˜¶æ®µï¼ˆThe Application Stage) å‡ ä½•é˜¶æ®µ(The Geometry Stage) å…‰æ …åŒ–é˜¶æ®µ(The Rasterizer Stage) ç»˜åˆ¶ç®¡çº¿çš„åŸºæœ¬ç»“æ„åŒ…æ‹¬3ä¸ªé˜¶æ®µï¼šåº”ç”¨ç¨‹åºï¼Œå‡ ä½•ï¼Œå…‰æ …åŒ–ã€‚ å‡ ä¸ªè¦ç‚¹ï¼š æ¯ä¸ªé˜¶æ®µæœ¬èº«ä¹Ÿå¯èƒ½æ˜¯ä¸€æ¡ç®¡çº¿ï¼Œå¦‚å›¾ä¸­çš„å‡ ä½•é˜¶æ®µæ‰€ç¤ºã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥å¯¹æœ‰çš„é˜¶æ®µè¿›è¡Œå…¨éƒ¨æˆ–è€…éƒ¨åˆ†çš„å¹¶è¡ŒåŒ–å¤„ç†ï¼Œå¦‚å›¾ä¸­çš„å…‰æ …åŒ–é˜¶æ®µã€‚åº”ç”¨ç¨‹åºé˜¶æ®µè™½ç„¶æ˜¯ä¸€ä¸ªå•ç‹¬çš„è¿‡ç¨‹ï¼Œä½†æ˜¯ä¾ç„¶å¯ä»¥å¯¹ä¹‹è¿›è¡Œç®¡çº¿åŒ–æˆ–è€…å¹¶è¡ŒåŒ–å¤„ç†ã€‚ æœ€æ…¢çš„ç®¡çº¿é˜¶æ®µå†³å®šç»˜åˆ¶é€Ÿåº¦ï¼Œå³å›¾åƒçš„æ›´æ–°é€Ÿåº¦ï¼Œè¿™ç§é€Ÿåº¦ä¸€èˆ¬ç”¨FPSè¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯å¸§ç‡ã€‚ åº”ç”¨ç¨‹åºé˜¶æ®µï¼ˆThe Application Stageï¼‰ åº”ç”¨ç¨‹åºé˜¶æ®µä¸€èˆ¬æ˜¯å›¾å½¢æ¸²æŸ“ç®¡çº¿æ¦‚å¿µä¸Šçš„ç¬¬ä¸€ä¸ªé˜¶æ®µã€‚åº”ç”¨ç¨‹åºé˜¶æ®µæ˜¯é€šè¿‡è½¯ä»¶æ–¹å¼æ¥å®ç°çš„é˜¶æ®µï¼Œå¼€å‘è€…èƒ½å¤Ÿå¯¹è¯¥é˜¶æ®µå‘ç”Ÿçš„æƒ…å†µè¿›è¡Œå®Œå…¨æ§åˆ¶ï¼Œå¯ä»¥é€šè¿‡æ”¹å˜å®ç°æ–¹æ³•æ¥æ”¹å˜å®é™…æ€§èƒ½ã€‚å…¶ä»–é˜¶æ®µï¼Œä»–ä»¬å…¨éƒ¨æˆ–è€…éƒ¨åˆ†å»ºç«‹åœ¨ç¡¬ä»¶çš„åŸºç¡€ä¸Šï¼Œå› æ­¤è¦æ”¹å˜å®ç°è¿‡ç¨‹ä¼šéå¸¸å›°éš¾ã€‚ æ­£å› åº”ç”¨ç¨‹åºé˜¶æ®µæ˜¯è½¯ä»¶æ–¹å¼å®ç°ï¼Œå› æ­¤ä¸èƒ½åƒé›†åˆå’Œå…‰æ …åŒ–é˜¶æ®µé‚£æ ·ç»§ç»­åˆ†ä¸ºè¯ºå¹²ä¸ªå­é˜¶æ®µã€‚ä½†ä¸ºäº†æé«˜æ€§èƒ½ï¼Œè¯¥é˜¶æ®µè¿˜æ˜¯å¯ä»¥åœ¨å‡ ä¸ªå¹¶è¡Œå¤„ç†å™¨ä¸ŠåŒæ—¶æ‰§è¡Œã€‚åœ¨CPUè®¾è®¡å•†ï¼Œç§°è¿™ç§å½¢å¼ä¸ºè¶…æ ‡é‡ä½“ç³»(superscalar)ç»“æ„ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨åŒä¸€ä¸ªé˜¶æ®µåŒä¸€ä¸ªæ—¶é—´åšä¸åŒçš„å‡ ä»¶äº‹æƒ…ã€‚ åº”ç”¨ç¨‹åºé˜¶æ®µé€šå¸¸å®ç°çš„æ–¹æ³•æœ‰ç¢°æ’æ£€æµ‹ï¼ŒåŠ é€Ÿç®—æ³•ï¼Œè¾“å…¥æ£€æµ‹ï¼ŒåŠ¨ç”»ï¼ŒåŠ›åé¦ˆä»¥åŠçº¹ç†åŠ¨ç”»ï¼Œå˜åŒ–ä»¿çœŸï¼Œå‡ ä½•å˜å½¢ï¼Œä»¥åŠä¸€äº›ä¸åœ¨å…¶ä»–é˜¶æ®µæ‰§è¡Œçš„è®¡ç®—ï¼Œå¦‚å±‚æ¬¡å †è£å‰ªç­‰åŠ é€Ÿç®—æ³•å°±å¯ä»¥åœ¨è¿™é‡Œå®ç°ã€‚ åº”ç”¨ç¨‹åºé˜¶æ®µçš„ä¸»è¦ä»»åŠ¡ï¼šåœ¨åº”ç”¨ç¨‹åºé˜¶æ®µçš„æœ«ç«¯ï¼Œå°†éœ€è¦åœ¨å±å¹•(å…·ä½“å½¢å¼å–å†³äºå…·ä½“è¾“å…¥è®¾å¤‡)æ˜¾ç¤ºå‡ºæ¥ç»˜åˆ¶çš„å‡ ä½•ä½“(ä¹Ÿå°±æ˜¯ç»˜åˆ¶å›¾å…ƒ,rendering primitives,å¦‚ç‚¹ï¼Œçº¿ï¼ŒçŸ©å½¢ç­‰)è¾“å…¥åˆ°ç»˜åˆ¶ç®¡çº¿çš„ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚ å¯¹äºè¢«æ¸²æŸ“çš„æ¯ä¸€å¸§ï¼Œåº”ç”¨ç¨‹åºé˜¶æ®µå°†æ‘„åƒæœºä½ç½®ï¼Œå…‰ç…§å’Œæ¨¡å‹çš„å›¾å…ƒè¾“å‡ºåˆ°ç®¡çº¿çš„ä¸‹ä¸€ä¸ªä¸»è¦é˜¶æ®µ-å‡ ä½•é˜¶æ®µã€‚å‡ ä½•é˜¶æ®µ The Geometry Stage å‡ ä½•é˜¶æ®µä¸»è¦è´Ÿè´£å¤§éƒ¨åˆ†å¤šè¾¹å½¢æ“ä½œå’Œé¡¶ç‚¹æ“ä½œã€‚ GPUæ¸²æŸ“ç®¡çº¿å’Œå¯ç¼–ç¨‹ç€è‰²å™¨GPUæ¸²æŸ“ç®¡çº¿æµç¨‹å›¾ å…¶ä¸­ï¼š ç»¿è‰²çš„é˜¶æ®µéƒ½æ˜¯å®Œå…¨å¯ä»¥ç¼–ç¨‹çš„ã€‚ é»„è‰²çš„é˜¶æ®µå¯é…ç½®ï¼Œä½†ä¸å¯ç¼–ç¨‹ã€‚ è“è‰²çš„é˜¶æ®µå®Œå…¨å›ºå®šã€‚ é¡¶ç‚¹ç€è‰²å™¨é¡¶ç‚¹ç€è‰²å™¨ï¼ˆThe Vertex Shaderï¼‰æ˜¯å®Œå…¨å¯ç¼–ç¨‹çš„é˜¶æ®µï¼Œé¡¶ç‚¹ç€è‰²å™¨å¯ä»¥å¯¹æ¯ä¸ªé¡¶ç‚¹è¿›è¡Œè¯¸å¦‚å˜æ¢å’Œå˜å½¢åœ¨å†…çš„å¾ˆå¤šæ“ä½œï¼Œæä¾›äº†ä¿®æ”¹/åˆ›å»º/å¿½ç•¥é¡¶ç‚¹ç›¸å…³å±æ€§çš„åŠŸèƒ½ï¼Œè¿™äº›é¡¶ç‚¹å±æ€§åŒ…æ‹¬é¢œè‰²ã€æ³•çº¿ã€çº¹ç†åæ ‡å’Œä½ç½®ã€‚é¡¶ç‚¹ç€è‰²å™¨çš„å¿…é¡»å®Œæˆçš„ä»»åŠ¡æ˜¯å°†é¡¶ç‚¹ä»æ¨¡å‹ç©ºé—´è½¬æ¢åˆ°é½æ¬¡è£å‰ªç©ºé—´ã€‚ å‡ ä½•ç€è‰²å™¨å‡ ä½•ç€è‰²å™¨ï¼ˆThe Geometry Shaderï¼‰ä½äºé¡¶ç‚¹ç€è‰²å™¨ä¹‹åï¼Œå…è®¸GPUé«˜æ•ˆçš„åˆ›å»ºå’Œé”€æ¯å‡ ä½•å›¾å…ƒã€‚å‡ ä½•ç€è‰²å™¨æ˜¯å¯é€‰çš„ï¼Œå®Œå…¨å¯ç¼–ç¨‹çš„é˜¶æ®µï¼Œä¸»è¦å¯¹å›¾å…ƒï¼ˆç‚¹ã€çº¿ã€ä¸‰è§’å½¢ï¼‰çš„é¡¶ç‚¹è¿›è¡Œæ“ä½œã€‚å‡ ä½•ç€è‰²å™¨æ¥å—é¡¶ç‚¹ç€è‰²å™¨çš„è¾“å‡ºä½œä¸ºè¾“å…¥ï¼Œé€šè¿‡é«˜æ•ˆçš„å‡ ä½•è¿ç®—ï¼Œå°†æ•°æ®è¾“å‡ºï¼Œæ•°æ®éšåç»è¿‡å‡ ä½•é˜¶æ®µå’Œå…‰æ …åŒ–çš„å…¶ä»–å¤„ç†åï¼Œä¼šå‘é€ç»™ç‰‡æ®µç€è‰²å™¨ã€‚å‡ ä½•ç€è‰²å™¨å¯ä»¥æ”¹å˜ä¿¡æ–°ä¼ é€’è¿›æ¥çš„å›¾å…ƒçš„æ‹“æ‰‘ç»“æ„ï¼Œä¸”å‡ ä½•ç€è‰²å™¨å¯ä»¥æ¥å—ä»»ä½•æ‹“æ‰‘ç±»å‹çš„å›¾å…ƒï¼Œä½†æ˜¯åªèƒ½è¾“å‡ºç‚¹ã€æŠ˜çº¿ï¼ˆline stripï¼‰å’Œä¸‰è§’å½¢æ¡ï¼ˆtriangle stripsï¼‰ã€‚ è£å‰ªè£å‰ªï¼ˆClippingï¼‰å±äºå¯é…ç½®çš„åŠŸèƒ½é˜¶æ®µï¼Œåœ¨æ­¤é˜¶æ®µå¯é€‰è¿è¡Œçš„è£å‰ªæ–¹å¼ï¼Œä»¥åŠæ·»åŠ è‡ªå®šä¹‰çš„è£å‰ªé¢ã€‚ å±å¹•æ˜ å°„å±å¹•æ˜ å°„ï¼ˆScreen Mappingï¼‰ã€ä¸‰è§’å½¢è®¾ç½®ï¼ˆTriangle Setupï¼‰å’Œä¸‰è§’å½¢éå†ï¼ˆTriangle Traversalï¼‰é˜¶æ®µæ˜¯å›ºå®šåŠŸèƒ½é˜¶æ®µã€‚ åƒç´ ç€è‰²å™¨åƒç´ ç€è‰²å™¨ï¼ˆPixel Shaderï¼ŒDirect3Dä¸­çš„å«æ³•ï¼‰å¸¸å¸¸åˆç§°ä¸ºç‰‡æ®µç€è‰²å™¨ï¼Œç‰‡å…ƒç€è‰²å™¨ï¼ˆFragment Shaderï¼ŒOpenGLä¸­çš„å«æ³•ï¼‰ï¼Œæ˜¯å®Œå…¨å¯ç¼–ç¨‹çš„é˜¶æ®µï¼Œä¸»è¦ä½œç”¨æ˜¯è¿›è¡Œåƒç´ çš„å¤„ç†ï¼Œè®©å¤æ‚çš„ç€è‰²æ–¹ç¨‹åœ¨æ¯ä¸€ä¸ªåƒç´ ä¸Šæ‰§è¡Œã€‚åƒç´ ç€è‰²å™¨å¸¸ç”¨æ¥å¤„ç†åœºæ™¯å…‰ç…§å’Œä¸ä¹‹ç›¸å…³çš„æ•ˆæœï¼Œå¦‚å‡¹å‡¸çº¹ç†æ˜ å°„å’Œè°ƒè‰²ã€‚ç§°ä¹‹ä¸ºç‰‡æ®µç€è‰²å™¨ä¼¼ä¹æ›´åŠ å‡†ç¡®ï¼Œå› ä¸ºå¯¹äºç€è‰²å™¨çš„è°ƒç”¨å’Œå±å¹•ä¸Šçš„åƒç´ å¹¶éæ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚æ¯”å¦‚ï¼Œå¯¹äºä¸€ä¸ªåƒç´ ï¼Œç‰‡æ®µç€è‰²å™¨å¯èƒ½ä¼šè¢«è°ƒç”¨è‹¥å¹²æ¬¡æ¥å†³å®šå®ƒæœ€ç»ˆçš„é¢œè‰²ï¼Œé‚£äº›è¢«é®æŒ¡çš„ç‰©ä½“ä¹Ÿä¼šè¢«è®¡ç®—ï¼Œç›´åˆ°æœ€åçš„æ·±åº¦ç¼“å†²æ‰å°†å„ç‰©ä½“å‰åæ’åºã€‚éœ€è¦æ³¨æ„ï¼Œåƒç´ ç€è‰²å™¨é€šå¸¸åœ¨æœ€ç»ˆåˆå¹¶é˜¶æ®µè®¾ç½®ç‰‡æ®µé¢œè‰²ä»¥è¿›è¡Œåˆå¹¶ï¼Œè€Œæ·±åº¦å€¼ä¹Ÿå¯ä»¥ç”±åƒç´ ç€è‰²å™¨ä¿®æ”¹ã€‚æ¨¡ç‰ˆç¼“å†²ï¼ˆstencil bufferï¼‰å€¼æ˜¯ä¸æ˜¯ä¿®æ”¹çš„ï¼Œè€Œæ˜¯å°†å…¶ä¼ é€’ç»™åˆå¹¶é˜¶æ®µï¼ˆMerge Stageï¼‰ã€‚åœ¨SM 2.0ä»¥åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œåƒç´ ç€è‰²å™¨ä¹Ÿå¯ä»¥ä¸¢å¼ƒï¼ˆdiscardï¼‰ä¼ å…¥çš„ç‰‡æ®µæ•°æ®ï¼Œå³ä¸äº§ç”Ÿè¾“å‡ºã€‚è¿™æ ·çš„æ“ä½œä¼šæ¶ˆè€—æ€§èƒ½ï¼Œå› ä¸ºé€šå¸¸åœ¨è¿™ç§æƒ…å†µä¸‹ä¸èƒ½ä½¿ç”¨ç”±GPUæ‰§è¡Œçš„ä¼˜åŒ–ã€‚è¯¸å¦‚é›¾è®¡ç®—å’Œalphaæµ‹è¯•çš„æ“ä½œå·²ç»ä»åˆå¹¶æ“ä½œè½¬ç§»åˆ°SM 4.0ä¸­çš„åƒç´ ç€è‰²å™¨é‡Œè®¡ç®—ã€‚å¯ä»¥å‘ç°ï¼Œé¡¶ç‚¹ç€è‰²ç¨‹åºçš„è¾“å‡ºï¼Œåœ¨ç»å†è£å‰ªã€å±å¹•æ˜ å°„ã€ä¸‰è§’å½¢è®¾å®šã€ä¸‰è§’å½¢éå†åï¼Œå®é™…ä¸Šå˜æˆäº†åƒç´ ç€è‰²ç¨‹åºçš„è¾“å…¥ã€‚åœ¨Shader Model 4.0ä¸­ï¼Œå…±æœ‰16ä¸ªå‘é‡ï¼ˆæ¯ä¸ªå‘é‡å«æœ‰4ä¸ªå€¼ï¼‰å¯ä»¥ä»é¡¶ç‚¹ç€è‰²å™¨ä¼ åˆ°åƒç´ ç€è‰²å™¨ã€‚å½“ä½¿ç”¨å‡ ä½•ç€è‰²å™¨æ—¶ï¼Œå¯ä»¥è¾“å‡º32ä¸ªå‘é‡åˆ°åƒç´ ç€è‰²å™¨ä¸­ã€‚åƒç´ ç€è‰²å™¨çš„è¿½åŠ è¾“å…¥æ˜¯Shader Model 3.0ä¸­å¼•å…¥çš„ã€‚ä¾‹å¦‚ï¼Œä¸‰è§’å½¢çš„å“ªä¸€é¢æ˜¯å¯è§çš„é€šè¿‡è¾“å…¥æ ‡å¿—æ¥å‡å¦‚çš„ã€‚è¿™ä¸ªå€¼å¯¹äºåœ¨å•ä¸ªé€šé“ä¸­çš„æ­£é¢å’ŒèƒŒé¢æ¸²æŸ“ä¸åŒæè´¨ååˆ†é‡è¦ã€‚è€Œä¸”åƒç´ ç€è‰²å™¨ä¹Ÿå¯ä»¥è·å¾—ç‰‡æ®µçš„å±å¹•ä½ç½®ã€‚ åˆå¹¶åˆå¹¶é˜¶æ®µï¼ˆThe Merger Stageï¼‰å¤„äºå®Œå…¨å¯ç¼–ç¨‹å’Œå›ºå®šåŠŸèƒ½ä¹‹é—´ï¼Œå°½ç®¡ä¸èƒ½ç¼–ç¨‹ï¼Œä½†æ˜¯é«˜åº¦å¯é…ç½®ï¼Œå¯ä»¥è¿›è¡Œä¸€ç³»åˆ—çš„å•Šå“¦åšã€‚å…¶é™¤äº†è¿›è¡Œåˆå¹¶æ“ä½œï¼Œè¿˜åˆ†ç®¡é¢œè‰²ä¿®æ”¹ï¼ˆColor Modifyingï¼‰ï¼ŒZç¼“å†²ï¼ˆZ-Bufferï¼‰ï¼Œæ··åˆï¼ˆBlendï¼‰ï¼Œæ¨¡ç‰ˆï¼ˆStencilï¼‰å’Œç›¸å…³ç¼“å­˜çš„å¤„ç†ã€‚ å¯ç¼–ç¨‹ç€è‰²æ¨¡å‹ ç°ä»£ç€è‰²é˜¶æ®µï¼ˆæ¯”å¦‚æ”¯æŒShader Model 4.0ï¼ŒDirectX 10ä»¥åŠä¹‹åï¼‰ä½¿ç”¨äº†é€šç”¨ç€è‰²æ ¸å¿ƒï¼ˆcommon-shader coreï¼‰ï¼Œè¿™å°±è¡¨æ˜é¡¶ç‚¹ï¼Œç‰‡æ®µï¼Œå‡ ä½•ç€è‰²å™¨å…±äº«ä¸€å¥—ç¼–ç¨‹æ¨¡å‹ã€‚ æ—©èµ·çš„ç€è‰²æ¨¡å‹å¯ä»¥ç”¨æ±‡ç¼–è¯­è¨€ç›´æ¥ç¼–ç¨‹ï¼Œä½†DX10ä¹‹åï¼Œæ±‡ç¼–å°±åªåœ¨è°ƒè¯•è¾“å‡ºé˜¶æ®µå¯è§ï¼Œæ”¹ç”¨é«˜çº§ç€è‰²è¯­è¨€ã€‚ ç›®å‰çš„ç€è‰²è¯­è¨€éƒ½æ˜¯C-likeçš„ç€è‰²è¯­è¨€ï¼Œæ¯”å¦‚HLSLï¼ŒCGå’ŒGLSLï¼Œå…¶è¢«ç¼–è¯‘æˆç‹¬ç«‹äºæœºå™¨çš„æ±‡ç¼–è¯­è¨€ï¼Œä¹Ÿç§°ä¸ºä¸­é—´è¯­è¨€ï¼ˆILï¼‰ã€‚è¿™äº›æ±‡ç¼–è¯­è¨€åœ¨å•ç‹¬çš„é˜¶æ®µï¼Œé€šå¸¸å®åœ¨é©±åŠ¨ä¸­ï¼Œè¢«è½¬åŒ–æˆå®é™…çš„æœºå™¨è¯­è¨€ã€‚è¿™æ ·çš„å®‰æ’å¯ä»¥å…¼å®¹ä¸åŒçš„ç¡¬ä»¶å®ç°ã€‚è¿™äº›æ±‡ç¼–è¯­è¨€å¯ä»¥è¢«çœ‹åšæ˜¯å®šä¹‰ä¸€ä¸ªä½œä¸ºç€è‰²è¯­è¨€ç¼–è¯‘å™¨çš„è™šæ‹Ÿæœºã€‚è¿™ä¸ªè™šæ‹Ÿæœºæ˜¯ä¸€ä¸ªå¤„ç†å¤šç§ç±»å‹å¯„å­˜å™¨å’Œæ•°æ®æºã€é¢„ç¼–äº†ä¸€ç³»åˆ—æŒ‡ä»¤çš„å¤„ç†å™¨ã€‚ ç€è‰²è¯­è¨€è™šæ‹Ÿæœºå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå¤„ç†å¤šç§ç±»å‹å¯„å­˜å™¨å’Œæ•°æ®æºã€é¢„ç¼–è¯‘ä¸€ç³»åˆ—æŒ‡ä»¤çš„å¤„ç†å™¨ã€‚è€ƒè™‘åˆ°å¾ˆå¤šå›¾å½¢æ“ä½œéƒ½ä½¿ç”¨çŸ­çŸ¢é‡ï¼ˆæœ€é«˜å››ä½ï¼‰ï¼Œå¤„ç†å™¨æ‹¥æœ‰4è·¯SIMDï¼ˆsingle-instruction multiple-dataï¼Œå•æŒ‡ä»¤å¤šæ•°æ®ï¼‰å…¼å®¹æ€§ã€‚æ¯ä¸ªå¯„å­˜å™¨åŒ…å«å››ä¸ªç‹¬ç«‹çš„å€¼ã€‚32ä½å•ç²¾åº¦æµ®ç‚¹çš„æ ‡é‡å’ŒçŸ¢é‡æ˜¯å…¶åŸºæœ¬æ•°æ®ç±»å‹ï¼›ä¹Ÿéšåæ”¯æŒ32ä½æ•´å‹ã€‚æµ®ç‚¹çŸ¢é‡é€šå¸¸åŒ…å«æ•°æ®å¦‚ä½ç½®ï¼ˆxyzwï¼‰ï¼Œæ³•çº¿ï¼ŒçŸ©é˜µè¡Œï¼Œé¢œè‰²ï¼ˆrgbaï¼‰ï¼Œæˆ–è€…çº¹ç†åæ ‡ï¼ˆuvwqï¼‰ã€‚è€Œæ•´å‹é€šå¸¸ç”¨æ¥è¡¨ç¤ºï¼Œè®¡æ•°å™¨ï¼Œç´¢å¼•ï¼Œæˆ–è€…ä½æ©ç ã€‚ä¹Ÿæ”¯æŒç»¼åˆæ•°æ®ç±»å‹æ¯”å¦‚ç»“æ„ä½“ï¼Œæ•°ç»„ï¼Œå’ŒçŸ©é˜µã€‚è€Œä¸ºäº†ä¾¿äºä½¿ç”¨å‘é‡ï¼Œå‘é‡æ“ä½œå¦‚è°ƒå’Œï¼ˆswizzlingï¼Œä¹Ÿå°±æ˜¯å‘é‡åˆ†é‡å’Œé‡æ–°æ’åºæˆ–å¤åˆ¶ï¼‰ï¼Œå’Œå±è”½ï¼ˆmaskingï¼Œåªæ˜¯ç”¨æŒ‡å®šçš„çŸ¢é‡å…ƒç´ ï¼‰ï¼Œä¹Ÿèƒ½å¤Ÿæ”¯æŒã€‚ ä¸Šå›¾ä¸ºDX10ä¸‹çš„é€šç”¨Shaderæ ¸å¿ƒè™šæ‹Ÿæœºæ¶æ„ä»¥åŠå¯„å­˜å™¨å¸ƒå±€ã€‚æ¯ä¸ªèµ„æºæ—è¾¹æ˜¾ç¤ºæœ€å¤§å¯ç”¨ç¼–å·ã€‚å…¶ä¸­ï¼Œç”¨ä¸¤ä¸ªæ–œæ åˆ†å¼€çš„ä¸‰ä¸ªæ•°å€¼ï¼Œåˆ†åˆ«æ˜¯é¡¶ç‚¹ã€å‡ ä½•ã€åƒç´ ç€è‰²å™¨å¯¹åº”çš„å¯ç”¨æœ€å¤§æ•°é‡ã€‚ ä¸€ä¸ªç»˜åˆ¶è°ƒç”¨ï¼ˆDraw Callï¼‰ä¼šè°ƒç”¨å›¾å½¢APIæ¥ç»˜åˆ¶ä¸€ç³»åˆ—çš„å›¾å…ƒï¼Œä¼šé©±ä½¿å›¾å½¢ç®¡çº¿çš„è¿è¡Œã€‚ æ¯ä¸ªå¯ç¼–ç¨‹ç€è‰²é˜¶æ®µæ‹¥æœ‰ä¸¤ç§ç±»å‹çš„è¾“å…¥ï¼š uniformè¾“å…¥ï¼Œåœ¨ä¸€ä¸ªdraw callä¸­ä¿æŒä¸å˜çš„å€¼ï¼ˆä½†åœ¨ä¸åŒdraw callä¹‹é—´å¯ä»¥æ”¹å˜ï¼‰ varyingè¾“å…¥ï¼Œshaderé‡Œå¯¹æ¯ä¸ªé¡¶ç‚¹å’Œåƒç´ çš„å¤„ç†éƒ½ä¸åŒçš„å€¼ã€‚çº¹ç†æ˜¯ç‰¹æ®Šçš„uniformè¾“å…¥ï¼Œæ›¾ç»ä¸€ç›´æ˜¯ä¸€å¼ åº”ç”¨åˆ°è¡¨é¢çš„å½©è‰²å›¾ç‰‡ï¼Œä½†ç°åœ¨å¯ä»¥è®¤ä¸ºæ˜¯å­˜å‚¨ç€å¤§é‡æ•°æ®çš„æ•°ç»„ã€‚ åœ¨ç°ä»£GPUä¸Šï¼Œå›¾å½¢è¿ç®—ä¸­å¸¸è§çš„è¿ç®—æ“ä½œæ‰§è¡Œé€Ÿåº¦éå¸¸å¿«ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæœ€å¿«çš„æ“ä½œæ˜¯æ ‡é‡å’Œå‘é‡çš„ä¹˜æ³•å’ŒåŠ æ³•ï¼Œä»¥åŠä»–ä»¬çš„ç»„åˆï¼Œå¦‚ä¹˜åŠ è¿ç®—ï¼ˆmultiply-addï¼‰å’Œç‚¹ä¹˜ï¼ˆdot-productï¼‰è¿ç®—ã€‚å…¶å®ƒæ“ä½œï¼Œæ¯”å¦‚å€’æ•°ï¼ˆreciprocalï¼‰ï¼Œå¹³æ–¹æ ¹ï¼ˆsquare rootï¼‰ï¼Œæ­£å¼¦ï¼ˆsineï¼‰ï¼Œä½™å¼¦ï¼ˆcosineï¼‰ï¼ŒæŒ‡æ•°ï¼ˆexponentiationï¼‰ï¼Œå¯¹æ•°ï¼ˆlogarithmï¼‰è¿ç®—ï¼Œå¾€å¾€ä¼šç¨å¾®æ›´åŠ æ˜‚è´µï¼Œä½†ä¾ç„¶ç›¸å½“å¿«æ·ã€‚çº¹ç†æ“ä½œéå¸¸é«˜æ•ˆï¼Œä½†ä»–ä»¬çš„æ€§èƒ½å¯èƒ½å—åˆ°è¯¸å¦‚ç­‰å¾…æ£€ç´¢ç»“æœçš„æ—¶é—´ç­‰å› ç´ çš„é™åˆ¶ã€‚ ç€è‰²è¯­è¨€è¡¨ç¤ºå‡ºäº†å¤§å¤šæ•°å¸¸è§çš„æ“ä½œï¼ˆæ¯”å¦‚åŠ æ³•å’Œä¹˜æ³•é€šè¿‡è¿ç®—ç¬¦+å’Œ*æ¥è¡¨ç¤ºï¼‰ã€‚å…¶ä½™çš„æ“ä½œç”¨å›ºæœ‰çš„å‡½æ•°ï¼Œæ¯”å¦‚atan()ï¼Œdot()ï¼Œlog()ç­‰ã€‚æ›´å¤æ‚çš„æ“ä½œä¹Ÿå­˜åœ¨å†…å»ºå‡½æ•°ï¼Œæ¯”å¦‚çŸ¢é‡å½’ä¸€åŒ–ï¼ˆvector normalizationï¼‰ï¼Œåå°„ï¼ˆreflectionï¼‰ã€å‰ä¹˜ï¼ˆcross productsï¼‰ã€çŸ©é˜µçš„è½¬ç½®ï¼ˆmatrix transposeï¼‰å’Œè¡Œåˆ—å¼ï¼ˆdeterminantï¼‰ç­‰ã€‚ æµæ§åˆ¶ï¼ˆflow controlï¼‰æ˜¯æŒ‡ä½¿ç”¨åˆ†æ”¯æŒ‡ä»¤æ¥æ”¹å˜ä»£ç æ‰§è¡Œæµç¨‹çš„æ“ä½œã€‚è¿™äº›æŒ‡ä»¤ç”¨äºå®ç°é«˜çº§è¯­è¨€ç»“æ„ï¼Œå¦‚â€œifâ€å’Œâ€œcaseâ€è¯­å¥ï¼Œä»¥åŠå„ç§ç±»å‹çš„å¾ªç¯ã€‚Shaderæ”¯æŒä¸¤ç§ç±»å‹çš„æµæ§åˆ¶ã€‚é™æ€æµæ§åˆ¶ï¼ˆStatic flow controlï¼‰æ˜¯åŸºäºç»Ÿä¸€è¾“å…¥çš„å€¼ã€‚è¿™æ„å‘³ç€ä»£ç çš„æµåœ¨è°ƒç”¨æ—¶æ˜¯æ’å®šçš„ã€‚é™æ€æµæ§åˆ¶çš„ä¸»è¦å¥½å¤„æ˜¯å…è®¸åœ¨ä¸åŒçš„æƒ…å†µä¸‹ä½¿ç”¨ç›¸åŒçš„ç€è‰²å™¨ï¼ˆä¾‹å¦‚ï¼Œä¸åŒæ•°é‡çš„å…‰æºï¼‰ã€‚åŠ¨æ€æµæ§åˆ¶ï¼ˆDynamic flow controlï¼‰åŸºäºä¸åŒçš„è¾“å…¥å€¼ã€‚ä½†åŠ¨æ€æµæ§åˆ¶è¿œæ¯”é™æ€æµé‡æ§åˆ¶æ›´å¼ºå¤§ä½†åŒæ—¶ä¹Ÿéœ€è¦æ›´é«˜çš„å¼€é”€ï¼Œç‰¹åˆ«æ˜¯åœ¨è°ƒç”¨shaderä¹‹é—´ï¼Œä»£ç æµä¸è§„å¾‹æ”¹å˜çš„æ—¶å€™ã€‚è€Œè¯„ä¼°ä¸€ä¸ªshaderçš„æ€§èƒ½ï¼Œæ˜¯è¯„ä¼°å…¶åœ¨ä¸€æ®µæ—¶é—´å†…å¤„ç†é¡¶ç‚¹æˆ–åƒç´ çš„ä¸ªæ•°ã€‚å¦‚æœæµå¯¹æŸäº›å…ƒç´ é€‰æ‹©â€œifâ€åˆ†æ”¯ï¼Œè€Œå¯¹å…¶ä»–å…ƒç´ é€‰æ‹©â€œelseâ€åˆ†æ”¯ï¼Œè¿™ä¸¤ä¸ªåˆ†æ”¯å¿…é¡»å¯¹æ‰€æœ‰å…ƒç´ è¿›è¡Œè¯„ä¼°ï¼ˆå¹¶ä¸”æ¯ä¸ªå…ƒç´ çš„æœªä½¿ç”¨åˆ†æ”¯å°†è¢«ä¸¢å¼ƒï¼‰ã€‚ Shaderç¨‹åºå¯ä»¥åœ¨ç¨‹åºåŠ è½½æˆ–è¿è¡Œæ—¶ç¦»çº¿ç¼–è¯‘ã€‚å’Œä»»ä½•ç¼–è¾‘å™¨ä¸€æ ·ï¼Œæœ‰ç”Ÿæˆä¸åŒè¾“å‡ºæ–‡ä»¶å’Œä½¿ç”¨ä¸åŒä¼˜å…ˆçº§åˆ«çš„é€‰é¡¹ã€‚ä¸€ä¸ªç¼–è¯‘è¿‡çš„Shaderä½œä¸ºå­—ç¬¦ä¸²æˆ–è€…æ–‡æœ¬æ¥å­˜å‚¨ï¼Œå¹¶é€šè¿‡é©±åŠ¨ç¨‹åºä¼ é€’ç»™GPUã€‚ SM 2.0/2.X SM 3.0 SM 4.0 å¼•å…¥ç‰ˆæœ¬ DX 9.0,2002 DX 9.0c,2004 DX 10,2007 VSæŒ‡ä»¤æ§½ä½ 256 â‰¥512 4096 VSæœ€å¤§æ‰§è¡Œæ­¥é•¿ 65536 65536 âˆ PSæŒ‡ä»¤æ§½ä½ â‰¥96 â‰¥512 â‰¥65536 PSæœ€å¤§æ‰§è¡Œæ­¥é•¿ â‰¥96 65536 âˆ ä¸´æ—¶å¯„å­˜å™¨ â‰¥12 32 4096 VSå¸¸é‡å¯„å­˜å™¨ â‰¥256 â‰¥256 14Ã—4096 PSå¸¸é‡å¯„å­˜å™¨ 32 224 14Ã—4096 æµç¨‹æ§åˆ¶ï¼Œåˆ¤æ–­ Optional Yes Yes VSçº¹ç†è´´å›¾ None 4 128Ã—512 PSçº¹ç†è´´å›¾ 16 16 128Ã—512 æ•´æ•°æ”¯æŒ No No Yes VSè¾“å…¥å¯„å­˜å™¨ 16 16 16 æ’å€¼å¯„å­˜å™¨ 8 10 16/32 PSè¾“å‡ºå¯„å­˜å™¨ 4 4 8]]></content>
      <tags>
        <tag>è®¡ç®—æœºå›¾å½¢å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Unity-Weather]]></title>
    <url>%2F2017%2F09%2F26%2FUnity-Weather%2F</url>
    <content type="text"><![CDATA[æŠ„ï¼šhttps://zhuanlan.zhihu.com/p/29668925]]></content>
  </entry>
  <entry>
    <title><![CDATA[UGUI vs NGUI]]></title>
    <url>%2F2017%2F09%2F24%2FUGUIvsNGUI%2F</url>
    <content type="text"><![CDATA[Tables NGUI UGUI é”šç‚¹ Anchor RectTransform Anchor å›¾ç‰‡ Sprite Image æ–‡å­— Label Text æ ¹èŠ‚ç‚¹ UIRoot Canvas UIé¢æ¿ Panel Canvas UIå®¹å™¨ Lets you essentially lower the heightmap resolution used for rendering. heightmapPixelError An approximation of how many pixels the terrain will pop in the worst case when switching lod. lightmapindex The index of the lightmap applied to this renderer. terrainData The Terrain Data that stres htightmaps,terrain textures,detail meshes and trees. treeBillboardDistance Distance from the camera where trees will be rendered as billboards only. terrCrossFadeLength Total distance delta that trees will use to transition from billboard orientation to to mesh orientation. treeDistance The maximum distance at which trees are rendered. treeMaximumFullLODCount Maximum number of trees rendered at full LOD. NGUI ä¸Šå›¾æ˜¯UIWidgetï¼ŒUIGeometryå’ŒUIDrawCallçš„å…³ç³»å›¾UIPanelç”¨æ¥æ”¶é›†å’Œç®¡ç†å®ƒä¸‹é¢æ‰€æœ‰çš„widgetçš„ç»„ä»¶ã€‚é€šè¿‡widgetçš„geometryåˆ›å»ºå®é™…çš„draw callã€‚æ²¡æœ‰panelæ‰€æœ‰ä¸œè¥¿éƒ½ä¸èƒ½è¢«æ¸²æŸ“å‡ºæ¥ã€‚å¯ä»¥æŠŠUIPanelå½“ä½œRendererã€‚ æ¯ä¸€ä¸ªUIWidgetéƒ½æœ‰ä¸€ä¸ªUIGeometryï¼Œä½†æ˜¯å¹¶ä¸éƒ½æœ‰ä¸€ä¸ªUIDrawCallï¼Œè€Œæ˜¯è¦é€šè¿‡Batchåˆå¹¶è¾¾åˆ°å‡å°‘DrawCallçš„æ•°é‡ã€‚æ‰€æœ‰Paneléƒ½æœ‰ä¸€ä¸ªDepthå€¼ï¼Œä¼šå½±å“æ‰€æœ‰å®ƒåŒ…å«çš„widgetã€‚Panelçš„depthæƒé‡è¦é«˜äºwidgetçš„depthæƒé‡ï¼Œä½†æ˜¯ä½äºrender queueã€‚ å½“å‹¾é€‰staticçš„æ—¶å€™ï¼Œè¯¥panelä¸‹é¢æ‰€æœ‰çš„widgetéƒ½ä¸ä¼šè¢«ç§»åŠ¨ï¼Œè¿™æ ·å¯ä»¥æé«˜æ€§èƒ½ã€‚æ­¤æ—¶ï¼ŒNGUIä¼šå¿½ç•¥æ‰€æœ‰çš„position/rotation/scaleæ”¹å˜ã€‚æ‰€ä»¥åœ¨è¿è¡Œæ—¶ç§»åŠ¨widgetä¸ä¼šæœ‰æ•ˆã€‚ UIDrawCall1.æˆå‘˜å˜é‡a) List mActiveListå’ŒmInactiveListï¼ŒmActiveListä¿æŒå½“å‰æ¿€æ´»çš„UIDrawCallï¼ŒmInactiveListä¸»è¦æ˜¯ç”¨äºå›æ”¶UIDrawCall.Destroy()çš„UIDrawCallï¼Œä»¥è¾¾åˆ°å¾ªç¯åˆ©ç”¨é¿å…å†…å­˜çš„åå¤ç”³è¯·å’Œé‡Šæ”¾ï¼Œå‡å°‘GCçš„æ¬¡æ•°ã€‚b) Material mMaterialå’ŒmDynamicMatï¼ŒmMaterialæ˜¯å›¾é›†çš„Materialï¼ŒmDynamicMatæ˜¯å®é™…é‡‡ç”¨çš„Materialï¼Œå› ä¸ºUIPanelçš„Clippingæœ‰AlphaClipå’ŒSoftClipè¿™ä¸¤ä¸ªæ˜¯è¦é€šè¿‡åˆ‡æ¢Shaderå®ç°çš„ï¼Œæ‰€ä»¥éœ€è¦å¯¹åº”åŠ¨æ€åˆ›å»ºä¸€ä¸ªMaterialï¼Œè¿™ä¸ªå°±æ˜¯mDynamicMatçš„å­˜åœ¨ã€‚c) bool mRebuildMatå’ŒisDirtyï¼Œè¿™ä¸¤è€…è¡¨ç¤ºUIDrawCallæ‰€å¤„çš„çŠ¶æ€ï¼Œå½“æ”¹å˜UIDrawCallçš„Materialå’ŒShaderï¼ŒmRebuildMatå°±å˜æˆtrueï¼Œå°±ä¼šå¼•èµ·RebuildMaterial()çš„è°ƒç”¨ã€‚isDirtyè‹¥ä¸ºtrueï¼Œè¡¨ç¤ºUIDrawCallè¦è¿›è¡Œé‡å†™â€œå¡«å……â€ï¼Œè°ƒç”¨Setå‡½æ•°ã€‚ è´Ÿè´£å°†uvã€é¡¶ç‚¹ã€colorç­‰ä¿¡æ¯è¾“å…¥åˆ°meshä¸­ï¼Œç»§è€Œç»˜åˆ¶å›¾å½¢ã€‚ 1234567891011121314151617void UpdateGeometry()&#123; if (mFilter == null) &#123; mFilter = gameObject.AddComponent&lt;MeshFilter&gt;(); mMesh = new Mesh(); mTriangles = (verts.size &gt;&gt; 2); mMesh.verticess = verts.buffer; mMesh.uv = uvs.buffer; mFilter.mesh = mMesh; &#125; if (mRenderer == null) &#123; mRenderer = gameObject.AddComponent&lt;MeshRenderer&gt;(); &#125; UpdateMaterial();&#125; ä»¥ä¸Šæ‰€æœ‰çš„bufferéƒ½æ˜¯ç”¨BetterListæ¥å­˜å‚¨çš„ã€‚ 1234567891011121314151617void UpdateMaterial()&#123; if (mDynamicMat == null || mRebuildMat || mClipCount != panel.clipCount) &#123; RebuildMaterial(); mRebuildMat = false; &#125; else if (mSharedMat != mDynamicMat) &#123; mSharedMaterials = new Material[]&#123;mDynamicMat&#125;; &#125;&#125;void RebuildMaterial()&#123; CreateMaterial();&#125; ä¼˜åŒ–DrawCallä½¿ç”¨ç›¸åŒmaterialçš„è¿ç»­UIWidget(UILbale,UISprite)å…±ç”¨ä¸€ä¸ªUIDrawCallã€‚å¯¹UIWidget.listè¿›è¡Œæ’åºï¼Œä½¿å¾—ç›¸åŒçš„materialçš„UIWidgetåœ¨UIWidget.listç›¸è¿ï¼Œè€ŒUIWidget.listæ˜¯æ ¹æ®UIWidgetçš„depthè¿›è¡Œæ’åºã€‚ï¼ˆä½†æ˜¯è¿™æ ·ä¸ä¼šæ”¹å˜æ¸²æŸ“é¡ºåºå—ï¼Ÿï¼‰1) ä¿®æ”¹UIWidget(UILabel,UISprite)çš„depthï¼Œé™å®šå¥½UIWidget.listçš„æ’åº2) é‡å†™UIWidgetçš„CompareFuncæ–¹æ³•ã€‚å¤¹å±‚é—®é¢˜ UIRootUIRootçš„ä½œç”¨æ˜¯ç¼©æ”¾UI PixelPerfect ä¿æŒåŸåˆ†è¾¨ç‡FiexedSize æ ¹æ®æ¯”ä¾‹ç¼©æ”¾FixedSizeOnMobile PCä¿æŒåŸåˆ†è¾¨ç‡ï¼ŒMobileç¼©æ”¾ UICamera å¸¦æœ‰è¿™ä¸ªç»„ä»¶æ¸²æŸ“å‡ºæ¥çš„ç‰©ä½“å¯ä»¥æ¥å—NGUIäº‹ä»¶ UIPanelPanelçš„é›†åˆï¼Œä¸€ä¸ªPanelä¸­åŒ…å«å¤šä¸ªWidgetï¼Œè´Ÿè´£æ›´æ–°ä¼šå†³å®šä½•æ—¶ç»˜åˆ¶Widgetã€‚ 123456789101112131415static public List&lt;UIPanel&gt; list = new List&lt;UIPanel&gt;();public RenderQueue renderQueue = RenderQueue.Automatic; //æ¸²æŸ“æ¬¡åºç±»å‹public int startingRenderQueue = 3000;public List&lt;UIWidget&gt; widgets = new List&lt;UIWidget&gt;();public List&lt;UIDrawCall&gt; drawcalls = new List&lt;UIDrawCall&gt;();int mDepth = 0; // æ·±åº¦int mSortingOrder; // é˜Ÿåˆ—æ’åºå€¼bool mRebuild = false;//å¦‚æœä¸ºtrueï¼Œéœ€è¦é‡æ„æ‰€æœ‰çš„Drawcallï¼ŒPanelä¸­çš„OnEnableã€RemoveWidgetã€AddWidgetç­‰å’Œæ”¹å˜depthä¼šå°†è¯¥å€¼è®¾ç½®ä¸ºtrueã€‚void LateUpdate()&#123; if (mUpdateFrame != Time.frameCount) &#123; &#125;&#125;]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[UE3çš„3Dæ¸²æŸ“æµæ°´çº¿å¤„ç†æµç¨‹]]></title>
    <url>%2F2017%2F09%2F24%2F3%E7%9A%843D%E6%B5%81%E6%B0%B4%E7%BA%BF%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[æµæ°´çº¿3Dæ¸²æŸ“æµæ°´çº¿ä¹Ÿç±»ä¼¼ä¸€ä¸ªå·¥å‚çš„æµæ°´çº¿ï¼Œå®ƒçš„åŸææ–™æ˜¯ä¸€ç³»åˆ—çš„3Dç½‘æ ¼æ•°æ®ï¼Œæœ€ç»ˆäº§å“å°±æ˜¯æ˜¾ç¤ºåœ¨2Då±å¹•çš„3Dåœºæ™¯ã€‚3Dæ¸²æŸ“æµæ°´çº¿çš„å¤„ç†å’Œç…§ç›¸æœºçš„åŸç†å¾ˆåƒï¼Œå®ƒä»¬éƒ½åŒæ ·æ˜¯é€šè¿‡å°†3Dä¸–ç•Œçš„å†…å®¹æ”¾ç½®åˆ°2Då¹³é¢ä¸Šï¼Œé€šè¿‡2Dçš„æ–¹å¼æ¥å±•ç¤º3Dä¸–ç•Œï¼Œé¡¶ç‚¹ç®¡çº¿ä¸­æœ‰è¿™ä¹ˆå‡ ä¸ªåæ ‡ç©ºé—´ï¼šå±€éƒ¨ç©ºé—´-&gt;ä¸–ç•Œç©ºé—´-&gt;ç›¸æœºç©ºé—´-&gt;æŠ•å½±ç©ºé—´-&gt;å±å¹•ç©ºé—´(è§†å£ç©ºé—´),åˆå§‹çš„ç½‘æ ¼æ•°æ®æ˜¯åœ¨å±€éƒ¨ç©ºé—´ä¸­çš„ï¼Œé¡¶ç‚¹ç®¡çº¿å°†å…¶ä»å±€éƒ¨ç©ºé—´å˜æ¢åˆ°å±å¹•ç©ºé—´ä½œä¸ºè¾“å…¥ä¾›â€åƒç´ ç®¡çº¿â€å¤„ç†ã€‚æ¯”å¦‚å±€éƒ¨ç©ºé—´å†…ï¼Œä¸€ä¸ªäººç‰©çš„éª¨éª¼æ¨¡å‹ï¼Œå®ƒçš„ä¸­å¿ƒç‚¹å°±æ˜¯æ ¹éª¨éª¼çš„ä½ç½®ï¼Œåœ¨è¿›è¡Œéª¨éª¼å±‚æ¬¡è®¡ç®—çš„æ—¶å€™ï¼Œæ ¹è°·æ­Œæ”¾åœ¨ä¸­å¿ƒä½ç½®æ˜¯æ˜“äºè®¡ç®—çš„ï¼Œå¦‚æœå°†å…¶æ”¾ç½®åˆ°ä¸–ç•Œç©ºé—´ä¸­è¿›è¡Œéª¨éª¼è®¡ç®—ï¼Œé‚£ä¹ˆæ ¹éª¨éª¼çš„ä½ç½®ä¸åœ¨åŸç‚¹ä¸”æœå‘ä¹Ÿä¸ä¸º0ï¼Œè®¡ç®—èµ·æ¥ç›¸å½“å¤æ‚ã€‚è€Œä¸–ç•Œç©ºé—´ä¸­ï¼Œæ˜“äºæè¿°åœºæ™¯ä¸­å„ä¸ªç‰©ä½“é—´çš„å…³ç³»ï¼Œæ˜“äºä½œç¢°æ’å¤„ç†ï¼Œä¼¤å®³è®¡ç®—ï¼Œé¡¶ç‚¹å…‰ç…§è®¡ç®—ç­‰ã€‚åœ¨ç›¸æœºç©ºé—´ä¸­ï¼Œå®¹æ˜“æè¿°è¢«è§‚å¯Ÿç‰©ä½“ä¸è§‚å¯Ÿè€…ä¹‹é—´çš„å…³ç³»ï¼Œåˆ©ç”¨ç›¸æœºè§†é”¥ä½“å¯¹ç‰©ä½“è¿›è¡Œè£å‰ªï¼ŒæŠŠè§‚å¯Ÿä¸åˆ°çš„ç‰©ä½“å‰”é™¤æ‰ã€‚ VertexShaderâ€”é¡¶ç‚¹ç€è‰²å™¨æ˜¯ç”¨æ¥æ›¿æ¢è¿™ä¸ªé˜¶æ®µä¸­å›ºå®šç®¡çº¿çš„å®šç‚¹å˜æ¢åŠå…‰ç…§è®¡ç®—çš„ï¼Œä¼ ç»Ÿç®¡çº¿å¤„ç†é¡¶ç‚¹åŠå…‰ç…§çš„æ–¹å¼éƒ½æ˜¯å›ºå®šæµç¨‹çš„ï¼Œæ‰€ä»¥å›ºå®šç®¡çº¿ä¸‹çš„3Dç¨‹åºç‰¹æ•ˆéƒ½æœ‰å¾ˆå¤§çš„å±€é™æ€§ï¼Œå¼•å…¥é¡¶ç‚¹ç€è‰²å™¨ä¹‹åï¼Œé¡¶ç‚¹åœ¨ç©ºé—´ä¸­çš„å˜æ¢ä»¥åŠå…‰ç…§å¤„ç†éƒ½å¯ä»¥å¯ç¼–ç¨‹åŒ–äº†ã€‚é¡¶ç‚¹ç€è‰²å™¨ä¸»è¦æ˜¯ç”¨æ¥æ”¹å˜é¡¶ç‚¹å›ºå®šæµç¨‹ä¸­çš„å˜æ¢è¿‡ç¨‹ï¼Œæ‰€ä»¥ä½¿ç”¨é¡¶ç‚¹ç€è‰²å™¨è¡¨ç°å‡ºæ¥çš„å¤§å¤šæ˜¯å‡ ä½•å¤–å½¢çš„å˜åŒ–ä»¥åŠé¡¶ç‚¹çš„å…‰ç…§ï¼Œçº¹ç†ç­‰æ•°æ®çš„å˜åŒ–ã€‚ åœ¨UE3ä¸­ï¼Œæ˜¯ä¸èƒ½ç›´æ¥ç¼–å†™Shaderè¯­è¨€çš„ï¼ŒUE3ä¸­æŠŠæ‰€æœ‰çš„Shaderç‰¹æ•ˆéƒ½ç»‘å®šåˆ°æè´¨ä¸­ï¼Œåªèƒ½é€šè¿‡æè´¨ç¼–è¾‘å™¨æ¥é—´æ¥çš„ç¼–è¾‘é¡¶ç‚¹ç€è‰²å™¨å’Œåƒç´ ç€è‰²å™¨å†…å®¹ã€‚UE3ä¸­ä¿®æ”¹é¡¶ç‚¹ç€è‰²å™¨çš„æ–¹å¼ä¹Ÿæ˜¯åœ¨æè´¨ç¼–è¾‘å™¨ä¸­è¿›è¡Œçš„ï¼Œå…¶ä¸­æ¯”è¾ƒå…¸å‹çš„ä¸€ä¸ªè¾“å…¥èŠ‚ç‚¹å«åšWorldPositionOffsetï¼Œå®ƒå°±æ˜¯åœ¨é¡¶ç‚¹ç®¡é“é˜¶æ®µå¯¹æè´¨å¯¹åº”çš„ç½‘ç»œç‰©ä½“é¡¶ç‚¹è¿›è¡Œç¼–è¾‘çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¯¹åº”åˆ°åº•å±‚æ˜¯ä¿®æ”¹äº†è¯¥æè´¨å¯¹åº”çš„é¡¶ç‚¹ç€è‰²å™¨ä»£ç (é€šè¿‡HLSLæŒ‰é’®èƒ½å¤Ÿçœ‹åˆ°è¯¥æè´¨å¯¹åº”çš„Shaderä»£ç  è¿™ä¸ªé˜¶æ®µä¼šé€åƒç´ åœ°å¤„ç†è¯¥åƒç´ çš„çº¹ç†æ˜ å°„ï¼Œå…‰ç…§é¢œè‰²ï¼Œalphaèåˆï¼Œæ·±åº¦æµ‹è¯•ï¼Œæ¨¡æ¿æµ‹è¯•ç­‰ï¼Œå¹¶ä¸”æ ¹æ®è¯¥åƒç´ çš„è·ç¦»ä¿¡æ¯è¿›è¡Œé›¾åŒ–å…¬å¼çš„åº”ç”¨ï¼Œæ‰€ä»¥ï¼Œé¡¾åæ€ä¹‰ï¼Œåƒç´ ç®¡é“ä¸»è¦å¤„ç†çš„æ˜¯åƒç´ ä¿¡æ¯ï¼Œæœ€ç»ˆè¾“å‡ºåƒç´ æœ€ç»ˆçš„é¢œè‰²ã€‚ ä¼ ç»Ÿçš„3Dç®¡çº¿åªèƒ½é€šè¿‡æœ‰é™å‡ ä¸ªå›¾å½¢APIæ¥å£æ¥æ“ä½œåƒç´ ï¼Œæ¯”å¦‚DXä¸­è®¾ç½®å¤šçº¹ç†çš„ä¸€äº›æ¥å£ä»¥åŠAlphaèåˆçš„æ¥å£ï¼Œèƒ½å¤Ÿæ“ä½œçš„èŒƒå›´å¾ˆæœ‰é™ã€‚ åƒç´ ç€è‰²å™¨æ‰€æ›¿æ¢å›ºå®šæµæ°´çº¿çš„åŠŸèƒ½å°±æ˜¯åœ¨è¿™ä¸ªé˜¶æ®µï¼Œåœ¨å¼•å…¥åƒç´ ç€è‰²å™¨ä¹‹åï¼Œå°±å¯ä»¥æ ¹æ®éœ€è¦å¯¹åƒç´ åšè®¸å¤šè‡ªç”±çš„å¤„ç†ï¼Œå› ä¸ºå¸§ç¼“å­˜å†…çš„åƒç´ ä¿¡æ¯ä¸æ­¢åŒ…å«è¯¥åƒç´ çš„é¢œè‰²ã€Alphaå€¼ã€æ·±åº¦ä¿¡æ¯å’Œæ¨¡ç‰ˆä¿¡æ¯ï¼Œè¿˜å¯ä»¥åŒ…å«è¯¥åƒç´ å¯¹åº”çš„æ³•çº¿è´´å›¾ä¿¡æ¯ã€é«˜å…‰è´´å›¾ä¿¡æ¯ã€å‡¹å‡¸è´´å›¾ä¿¡æ¯ç­‰ï¼ˆè¿™äº›è´´å›¾å®é™…ä¸Šä¿å­˜çš„æ˜¯ä¸€ç³»åˆ—å‘é‡ä¿¡æ¯ï¼‰ï¼Œé€šè¿‡ä¼ å…¥ä¸€å®šçš„å‚æ•°ï¼Œæ¯”å¦‚æ—¶é—´ä¿¡æ¯ã€ç‰©ç†é‡ç­‰ï¼Œå°±èƒ½åˆ¶ä½œå‡ºå„ç§è´´è¿‘ç°å®çš„ç²¾ç¾ç‰¹æ•ˆã€‚ UE3ä¸­çš„åƒç´ ç€è‰²å™¨ä¹Ÿæ˜¯é€šè¿‡æè´¨ç¼–è¾‘å™¨ä¸­çš„è¡¨è¾¾å¼æ¥å¤„ç†çš„ï¼ŒUE3æè´¨ç¼–è¾‘å™¨ä¸­çš„å¤§éƒ¨åˆ†è¾“å…¥èŠ‚ç‚¹éƒ½æ˜¯ç”¨äºå¤„ç†åƒç´ ç€è‰²çš„ï¼Œå¦‚å›¾æ‰€ç¤º]]></content>
      <categories>
        <category>è™šå¹»å¼•æ“</category>
      </categories>
      <tags>
        <tag>è®¡ç®—æœºå›¾å½¢å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ¸¸æˆå¯¹è±¡å’Œè„šæœ¬]]></title>
    <url>%2F2017%2F09%2F20%2F%E6%B8%B8%E6%88%8F%E5%AF%B9%E8%B1%A1%E5%92%8C%E8%84%9A%E6%9C%AC%2F</url>
    <content type="text"><![CDATA[åŸæ–‡ï¼šhttp://catlikecoding.com/unity/tutorials/basics/game-objects-and-scripts/ ç”¨ç®€å•çš„è„šæœ¬æ„å»ºä¸€ä¸ªæ—¶é’Ÿ ç”¨C#å†™è„šæœ¬ è®©æ—¶é’Ÿè½¬åŠ¨èµ·æ¥ å®Œæˆ è¿™è¾¹æ–‡ç« é€šè¿‡åˆ›å»ºç®€å•çš„ç»„ä»¶è„šæœ¬æ¥å®ç°ä¸€ä¸ªæ—¶é’Ÿã€‚æ‚¨ä»…éœ€å‡ åˆ†é’Ÿæ¥ç†Ÿæ‚‰Unityç¼–è¾‘å™¨ï¼Œå¦‚æœæ‚¨å·²ç»ç†Ÿæ‚‰æ­¤éƒ¨åˆ†ï¼Œå¯ä»¥è·³è¿‡æœ¬ç¯‡æ–‡ç« ã€‚ æ„å»ºä¸€ä¸ªç®€å•çš„æ—¶é’Ÿæ‰“å¼€Unityåˆ›å»ºä¸€ä¸ª3Då¯¹è±¡ï¼Œä½ ä¸éœ€è¦ä»»ä½•é¢å¤–çš„èµ„æºåŒ…. 1.1 åˆ›å»ºä¸€ä¸ªæ¸¸æˆå¯¹è±¡é»˜è®¤çš„åœºæ™¯åŒ…å«ä¸¤ä¸ªæ¸¸æˆå¯¹è±¡ï¼Œä»–ä»¬åœ¨å±‚æ¬¡çª—å£ä¸­è€Œä¸”ä½ èƒ½çœ‹åˆ°ä»–ä»¬çš„å›¾æ ‡åœ¨åœºæ™¯çª—å£ä¸­ï¼Œç¬¬ä¸€ä¸ªæ˜¯ä¸»ç›¸æœºï¼Œå®ƒæ˜¯ç”¨æ¥æ¸²æŸ“çš„ï¼Œç¬¬äºŒä¸ªæ˜¯æ–¹å‘å…‰ï¼Œç…§æ˜åœºæ™¯çš„ã€‚ä½¿ç”¨GameObject-&gt;Create Empty é€‰é¡¹ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å±‚çº§çª—å£æ·»åŠ ä¸€ä¸ªæ–°çš„å¯¹è±¡åœ¨sceneä¸Šã€‚ ç›‘è§†çª—å£(Inspector window)å±•ç¤ºæ¸¸æˆå¯¹è±¡çš„ç»†èŠ‚ï¼Œå½“é€‰æ‹©æ—¶é’Ÿå¯¹è±¡çš„æ—¶å€™ï¼ŒInspectorä¼šå±•ç¤ºä»–çš„nameå’Œä¸€äº›é¢å¤–çš„å±æ€§,é»˜è®¤ä¸ºå¯ç”¨ï¼Œéé™æ€ï¼Œæ²¡æœ‰æ ‡ç­¾å±äºä¸€ä¸ªé»˜è®¤çš„å±‚ã€‚å¹¶ä¸”å±•ç¤ºäº†æ‰€æœ‰çš„ç»„ä»¶ï¼Œtransformç»„ä»¶æ˜¯ä¸€å®šæœ‰çš„ã€‚ transformç»„ä»¶åŒ…æ‹¬ä½ç½®ï¼Œæ—‹è½¬å’Œç¼©æ”¾åœ¨3Dç©ºé—´ï¼Œç¡®ä¿positionå’Œrotationæ˜¯0ï¼Œscaleæ˜¯1ï¼ˆè¿™é‡ŒæŒ‡çš„éƒ½æ˜¯æœ¬åœ°åæ ‡) 1.2 åˆ›å»ºä¸€ä¸ªæ—¶é’Ÿè™½ç„¶æˆ‘ä»¬æœ‰äº†clock object,ä½†æ˜¯æˆ‘ä»¬ä»€ä¹ˆä¹Ÿåšä¸äº†,æˆ‘ä»¬è¿˜å¾—åˆ›å»º3Dæ¨¡å‹æ¥æ¸²æŸ“ï¼ŒUnityåŒ…å«ä¸€äº›åŸå§‹çš„å¯¹è±¡ï¼Œç”¨è¿™äº›æˆ‘ä»¬èƒ½æ„å»ºä¸€ä¸ªç®€å•çš„æ—¶é’Ÿï¼Œsé¦–å…ˆæ·»åŠ ä¸€ä¸ªcylinder(åœ†æŸ±Gameobject-&gt;3D Object-&gt;Cylinder) åœ†æŸ±ä½“æœ‰ä¸€ä¸ªMesh FilteråŒ…å«ä¸€ä¸ªåœ†æŸ±ä½“çš„meshï¼Œç¬¬äºŒä¸ªæ˜¯Capsule Collider(èƒ¶å›Šç¢°æ’ä½“)ç”¨æ¥æç‰©ç†çš„ï¼Œç¬¬ä¸‰æ˜¯Mesh Rendererç¡®ä¿å¯ä»¥å¾—åˆ°æ¸²æŸ“çš„ï¼Œä¹Ÿç”¨æ¥æ§åˆ¶ç”¨é‚£ä¸ªæè´¨æ¥æ¸²æŸ“ï¼Œæœ€åä¸€ä¸ªå°±æ˜¯æè´¨(Material). è™½ç„¶å¯¹è±¡æ˜¯ä¸€ä¸ªåœ†æŸ±ä½“ï¼Œä½†æ˜¯å®ƒç”¨äº†capsule collider,å› ä¸ºunityæ²¡æœ‰åŸç”Ÿçš„cylinder collider,æˆ‘ä»¬ä¸éœ€è¦å®ƒï¼Œå¹²æ‰ï¼å¦‚æœä½ ä¸éœ€è¦ç‰©ç†çš„è¯ï¼Œä½ å¯ä»¥é€‰æ‹©Mesh Collider ç»„ä»¶,ç»„ä»¶èƒ½è¢«å¹²æ‰ã€‚ ä¸ºäº†æä¸€ä¸ªæ—¶é’Ÿçš„è„¸ï¼Œæˆ‘ä»¬å¿…é¡»æŠŠè¿™ç©æ„æå¹³ï¼Œç¼©å‡scaleçš„yå€¼ï¼Œ å°†åœ†æŸ±ä½“çš„åå­—æ”¹ä¸ºFace,è¡¨ç¤ºclockçš„è„¸, 1.3 åˆ›å»ºæ—¶é’Ÿåˆ»åº¦æ—¶é’Ÿæœ‰ä¸€åœˆåˆ»åº¦æ¥å‘Šè¯‰ä½ ç°åœ¨å‡ ç‚¹äº†ã€‚æ·»åŠ ä¸€ä¸ªç«‹æ–¹ä½“å¯¹è±¡é€šè¿‡Gameobject-&gt;3D Object-&gt;Cube,æ”¹å˜ç¼©æ”¾(0.5,0.2,1)åˆ»åº¦æ˜¯éš¾ä»¥çœ‹åˆ°çš„ï¼Œå› ä¸ºä»–å’Œè¡¨ç›˜çš„é¢œè‰²ç›¸åŒï¼Œè®©æˆ‘ä»¬é€šè¿‡æè´¨æ¥åŒºåˆ†å§ï¼ŒAssets-&gt;Create-&gt;Materialï¼Œæˆ–è€…Proect Windowéƒ½å¯ä»¥çš„ï¼Œè¿™ä¸ªæè´¨æ˜¯å¤åˆ¶é»˜è®¤çš„æè´¨çš„ï¼Œ]]></content>
  </entry>
  <entry>
    <title><![CDATA[Unityæ¸²æŸ“1 æè´¨]]></title>
    <url>%2F2017%2F09%2F20%2FUnity%E6%B8%B2%E6%9F%931-%E6%9D%90%E8%B4%A8%2F</url>
    <content type="text"><![CDATA[PSï¼šç¿»è¯‘Catlikeçš„æ–‡ç«  åˆ›å»ºä¸€ä¸ªç«‹æ–¹ä½“æ ¼å­ æ”¯æŒç¼©æ”¾ï¼Œä½ç§»ï¼Œæ—‹è½¬ åˆ›å»ºç®€å•çš„ç›¸æœºæŠ•å½± è¿™æ˜¯å…³äºæ¸²æŸ“çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œ]]></content>
  </entry>
  <entry>
    <title><![CDATA[sceneå’Œprefabçš„åŒºåˆ«]]></title>
    <url>%2F2017%2F09%2F17%2Farticle-title%2F</url>
    <content type="text"><![CDATA[å¦‚æœä¸€ä¸ªåœºæ™¯æœ‰å¤šä¸ªç›¸åŒçš„pfb(æŒ‡å¼•ç”¨ç›¸åŒçš„pfbï¼Œå…·ä½“æ¯ä¸ªpfbå¯èƒ½æœ‰å‚æ•°ä¸åŒï¼‰ï¼Œé‚£ä¹ˆSceneé‡Œæ¯ä¸ªpfbéƒ½æ˜¯ç‹¬ç«‹çš„å¯¹è±¡ï¼ŒåŠ è½½æ—¶æ¯ä¸ªå¯¹è±¡éƒ½è¦èµ°å…¨å¥—çš„æµç¨‹: æ–‡ä»¶I/O -&gt;ååºåˆ—åŒ– (è§£æï¼Œnew obj + ctor) -&gt; awake -&gt; shader\texture\vbo create\uploadï¼Œå¦‚æœèµ°pfb+Instantiateï¼Œé‚£ä¹ˆå‰é¢çš„æµç¨‹(æ–‡ä»¶I/Oï¼Œååºåˆ—åŒ–ï¼‰åªç”¨èµ°ä¸€éï¼Œç›´æ¥Instantiateå¤åˆ¶å†…å­˜ä¸­ç°æœ‰çš„å¯¹è±¡å°±è¡Œ.å¦å¤–pfbå¯ä»¥åœ¨åˆé€‚çš„æ—¶å€™æå‰å¼‚æ­¥é¢„åŠ è½½ï¼Œè¿™æ ·åˆ‡åœºæ™¯çš„æ—¶å€™å°±æ›´å¿«äº†ï¼ˆåœºæ™¯ä¹Ÿå¯ä»¥å¼‚æ­¥é¢„åŠ è½½ï¼Œä¸è¿‡awake\upload to gpuè¿™äº›å¿…é¡»åœ¨ä¸»çº¿ç¨‹åšï¼Œæ‰€ä»¥ä¼šå¡ä¸€ä¸‹ï¼‰ï¼Œpfbä¹Ÿä¾¿äºåšç»†ç²’åº¦çš„çƒ­æ›´. ä½†pfbå¯¹ç¾æœ¯æ—¥å¸¸è°ƒæ•´åœºæ™¯ä¸å‹å¥½ï¼Œé™¤éæœ‰ä¸ªä¸€é”®ç”Ÿæˆåœºæ™¯+ä¸€é”®å­˜pfb.å•è®ºåˆ‡æ¢é€Ÿåº¦ï¼Œä»€ä¹ˆéƒ½æ¯”ä¸è¿‡é¢„åŠ è½½ + å¤§å†…å­˜æ°¸é©» CentOS1.yum install subversion2.åˆ›å»ºsvnç‰ˆæœ¬ç›®å½•: mkdir -p /var/svn/svnrepos3.åˆ›å»ºç‰ˆæœ¬åº“: svnadmin create /var/svn/svnrepos4.cd /var/svn/svnrepos/conf (authzæ–‡ä»¶æ˜¯æƒé™æ§åˆ¶æ–‡ä»¶;passwdæ˜¯å¸å·å¯†ç æ–‡ä»¶;svnserve.conf SVNæœåŠ¡å™¨é…ç½®æ–‡ä»¶)5.è®¾ç½®å¸å·å¯†ç  vi passwd åœ¨[users]å—ä¸­æ·»åŠ ç”¨æˆ·å’Œå¯†ç ï¼Œæ ¼å¼ï¼šå¸å·=å¯†ç ï¼Œå¦‚zentia=zentia6.è®¾ç½®æƒé™vi authzåœ¨æœ«å°¾æ·»åŠ å¦‚ä¸‹ä»£ç [/]zentia=rwliyanfeng=ræ„æ€æ˜¯ç‰ˆæœ¬åº“çš„æ ¹ç›®å½•zentiaå¯¹å…¶æœ‰è¯»å†™æƒé™ï¼Œliyanfengåªæœ‰è¯»æƒé™ã€‚7.ä¿®æ”¹svnserve.confæ–‡ä»¶æ‰“å¼€ä¸‹é¢å‡ ä¸ªæ³¨é‡Šï¼šanon-access=read #åŒ¿åç”¨æˆ·å¯è¯»auth-access = write #æˆæƒç”¨æˆ·å¯å†™password-db = passwd #ä½¿ç”¨å“ªä¸ªæ–‡ä»¶ä½œä¸ºå¸å·æ–‡ä»¶authz-db = authz #ä½¿ç”¨å“ªä¸ªæ–‡ä»¶ä½œä¸ºæƒé™æ–‡ä»¶realm = /var/svn/svnrepos #è®¤è¯ç©ºé—´åï¼Œç‰ˆæœ¬åº“æ‰€åœ¨ç›®å½•8.å¯åŠ¨svnç‰ˆæœ¬åº“svnserve -d -r /var/svn/svnreposps aux | grep svnserve #æŸ¥çœ‹æœåŠ¡æ˜¯å¦å¯åŠ¨ SVNå®¢æˆ·ç«¯æ­å»º1.ä¿®æ”¹hostæ–‡ä»¶ 10.173.32.4 zentiasvr]]></content>
      <tags>
        <tag>Unity</tag>
      </tags>
  </entry>
</search>
